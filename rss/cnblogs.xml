<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>博客园_首页</title>
<link></link>
<description>代码改变世界</description>
<item>
<title>洛谷 P2391 白雪皑皑 线段树+优化 - 折翼的小鸟先生</title>
<link>http://www.cnblogs.com/rpup/p/13929762.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/rpup/p/13929762.html</guid>
<description>&lt;p&gt;现在有 &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; 片雪花排成一列。 Pty 要对雪花进行$ M $次染色操作，第 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt;次染色操作中，把&lt;span class=&quot;math inline&quot;&gt;\((i*p+q）%N+1\)&lt;/span&gt; 片雪花和第&lt;span class=&quot;math inline&quot;&gt;\(（i*q+p）%N+1\)&lt;/span&gt;片雪花之间的雪花（包括端点）染成颜色 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt;。其中 &lt;span class=&quot;math inline&quot;&gt;\(p\)&lt;/span&gt;,&lt;span class=&quot;math inline&quot;&gt;\(q\)&lt;/span&gt; 是给定的两个正整数。他想知道最后 &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; 片雪花被染成了什么颜色。&lt;/p&gt;
&lt;p&gt;输入格式&lt;br/&gt;包含 4 行：&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(N M p q\)&lt;/span&gt; 意义如题中所述。&lt;/p&gt;
&lt;p&gt;输出格式&lt;br/&gt;包含 &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; 行:&lt;/p&gt;
&lt;p&gt;第 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; 行表示第 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; 片雪花被染成的颜色 c&lt;/p&gt;
&lt;p&gt;100%的数据满足：1&amp;lt;=n&amp;lt;=1000000,1&amp;lt;=m&amp;lt;=10000000&lt;/p&gt;
&lt;p&gt;保证 &lt;span class=&quot;math inline&quot;&gt;\(1&amp;lt;=M*p+q\)&lt;/span&gt;，&lt;span class=&quot;math inline&quot;&gt;\(M*q+p&amp;lt;=2*10^9\)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;第一眼看到这道题，这不就是线段树裸题吗？&lt;/p&gt;
&lt;p&gt;再看一眼数据范围，发现过不去，我们可以看到所给的修改区间是特殊的&lt;/p&gt;
&lt;p&gt;，然后就开始快乐的打表找规律，经过打表，我们发现，针对区间的修改&lt;/p&gt;
&lt;p&gt;是多个最大长度为&lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt;的循环节，(~我也不会证~)然后区间修改就从1e7降&lt;/p&gt;
&lt;p&gt;为了1e6，剩下的就是线段树模板了。&lt;/p&gt;
&lt;p&gt;看了一下题解，大部分都是链表，并查集(~可我没想出来~)&lt;/p&gt;
&lt;p&gt;就用线段树水了一发&lt;/p&gt;
&lt;p&gt;本题的数据还是很水的(之前错误的暴力都能过，现在过不了了)&lt;/p&gt;
&lt;p&gt;注意余数处理哟!&lt;/p&gt;

&lt;pre&gt;
&lt;code class=&quot;language-c++&quot;&gt;#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;string&amp;gt;
using namespace std;
const int maxn=1e6+100;
inline int read(){
        int ret=0;
        int f=1;
        char ch=getchar();
        while(ch&amp;lt;'0'||ch&amp;gt;'9'){
                if(ch=='-')
                        f=-f;
                ch=getchar();
        }
        while(ch&amp;lt;='9'&amp;amp;&amp;amp;ch&amp;gt;='0'){
                ret=ret*10+(ch^'0');
                ch=getchar();
        }
        return ret*f;
}
int n,m,p,q;
struct node{
        int clo;
        int laz;
        int l,r;
        node(){
                clo=0;
                laz=0;
                l,r=0;
        }
}tre[maxn*4];
void build(int rt,int l,int r){
        tre[rt].l=l;
        tre[rt].r=r;
        if(l==r){
                return ;
        }
        int mid=(l+r)&amp;gt;&amp;gt;1;
        build(rt*2,l,mid);
        build(rt*2+1,mid+1,r);
}
void pushdown(int rt){
        if(tre[rt].laz){
                tre[rt*2].clo=tre[rt].laz;
                tre[rt*2+1].clo=tre[rt].laz;
                tre[rt*2].laz=tre[rt].laz;
                tre[rt*2+1].laz=tre[rt].laz;
                tre[rt].laz=0;
        }
        return ;
}
void update(int rt,int l,int r,int ql,int qr,int k){
        if(r&amp;lt;ql||l&amp;gt;qr){
                return;
        }
        if(ql&amp;lt;=l&amp;amp;&amp;amp;qr&amp;gt;=r){
                tre[rt].clo=k; 
                tre[rt].laz=k;  
                return;
        }
        int mid=(l+r)&amp;gt;&amp;gt;1;
        pushdown(rt);
        if(ql&amp;lt;=mid){
                update(rt*2,l,mid,ql,qr,k);
        }
        if(qr&amp;gt;mid){
                update(rt*2+1,mid+1,r,ql,qr,k);
        }
        return ;
}
void out(int rt,int l,int r){
        if(l==r){
                cout&amp;lt;&amp;lt;tre[rt].clo&amp;lt;&amp;lt;endl;
                return;
        }
        int mid=(l+r)&amp;gt;&amp;gt;1;
        pushdown(rt);
        out(rt*2,l,mid);
        out(rt*2+1,mid+1,r);
}
int main(){
//      freopen(&quot;a.in&quot;,&quot;r&quot;,stdin);
        n=read();
        m=read();
        p=read();
        q=read();
        int ll,rr;
        int lr=1;
        if(m&amp;gt;n){
                lr=m-(m%n+n);
        }
        for(int i=lr;i&amp;lt;=m;i++){
                ll=min((i*p+q)%n+1,(i*q+p)%n+1);
                rr=max((i*p+q)%n+1,(i*q+p)%n+1);
                update(1,1,n,ll,rr,i);
        }
        out(1,1,n);
        return 0;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;完结撒花！！&lt;/p&gt;
</description>
<pubDate>Thu, 05 Nov 2020 00:20:00 +0000</pubDate>
<dc:creator>折翼的小鸟先生</dc:creator>
<og:description>#题目描述： 现在有 \(N\) 片雪花排成一列。 Pty 要对雪花进行$ M $次染色操作，第 $i$次染色操作中，把$(ip+q）%N+1$ 片雪花和第$（iq+p）%N+1$片雪花之间的雪花（包</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/rpup/p/13929762.html</dc:identifier>
</item>
<item>
<title>技术总监7年经验——论程序员的职业发展路线 - pointersss</title>
<link>http://www.cnblogs.com/pointers/p/13929733.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/pointers/p/13929733.html</guid>
<description>&lt;p&gt;作为程序员，在开发岗位上做了几年，特别是到了30岁，这个而立之年，我们会来到一个重要的人生岔路口。就是管理和技术两个选择，一边专业路线，一边是管理路线。&lt;/p&gt;
&lt;p&gt;在互联网的头部企业，对管理和技术是平等对待的，所以晋升会存在管理和技两个通道的&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/img_convert/d351c729fb89c04ca3963313655f9af1.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;既然有了选择，就会有人纠结，不知道是选择专业路线，还是选择技术团队的管理路线。&lt;/p&gt;
&lt;p&gt;这个选择是程序员人生中第一个大的选择，也是第一个障碍，倒不是说这个障碍是到底要不要选择管理，而更多的是对做管理的迟疑，怀疑到底能不能做好管理，做了管理之后，技术是不是就荒废了。&lt;/p&gt;
&lt;p&gt;这种状态犹豫不决、摇摆不定的状态保持时间长了，最终会导致技术和管理都没做好，这是得不偿失的。&lt;/p&gt;
&lt;p&gt;为了解决这个问题，有必要分析程序员职业发展的路线到底有几条，分别需要具备怎样的能力，从而做到”手中有粮，心中不慌“&lt;/p&gt;
&lt;p&gt;01技术
&lt;/p&gt;&lt;p&gt;技术类上，是有两个方向：&lt;strong&gt;架构师和技术专家&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;架构师他的侧重点是&lt;/strong&gt;在“广”上，他主要负责技术的整体和架构，在业务上，需要有很深的理解，有丰富的经验，甚至能做到“走的桥比你吃的盐还多”。在技术上，能够广泛涉略，掌握的技术知识越多，内力就越加深厚。&lt;/p&gt;
&lt;p&gt;我觉得架构师还需要三点必备能力，其一需要有极强的执行力，能够快速的给出合理的方案，推动技术落地。其二需要有极强的判断力，能够准确的找到复杂系统的疑难问题所在，就像武林高手，一眼就看出对方的破绽。最后还需要有极强的创新力，能够创造新的解决方案，解决现有技术难题。&lt;/p&gt;
&lt;p&gt;所以从程序员到架构师的成长之路，总的指导原则是：积累经验，拓宽视野，深度思考（可以参考我之前文章《&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg3NzUxMTgwNQ==&amp;amp;mid=2247483826&amp;amp;idx=1&amp;amp;sn=c82601363825ba261b88c0198ee3a91d&amp;amp;chksm=cf2094a0f8571db6b69603ba66b1ac62ef588fc3668ffdcddd4ca2fa62713eb8c614e279290b&amp;amp;scene=21#wechat_redirect&quot;&gt;程序员进阶必备能力——深度思考&lt;/a&gt;》）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;技术专家他的侧重点&lt;/strong&gt;是在“专”上，这个就很好理解，就是在某个领域能够深入，能够熟悉其背后运行原理。不同的领域都会存在专家，例如：Java专家、前端专家、图像算法专家、Linux内核专家等等。专家相对架构师，更加专注，并不会考虑太多整体方案。&lt;/p&gt;
&lt;p&gt;所以从高级开发成长为技术专家，主要是扩展领域内的技术宽度，提升领域内的技术深度。因为领域也不是特别窄的一个面，而是包含多个技术面。&lt;/p&gt;
&lt;p&gt;举一个例子：Linux内核专家，要想成为Linux内核专家，需要掌握，Linux CPU调度、内存管理、进程管理、存储管理、文件系统、设备管理和驱动、网络通信、系统调用、系统初始化等技术面。&lt;/p&gt;
&lt;p&gt;在每个技术面中，同样包含了很多技术点，这些技术都是知识盲区，所以需要提升技术深度。&lt;/p&gt;

&lt;p&gt;管理也分为了两个方向，技术管理和职业管理。顾名思义，技术管理更加倾向于技术，而职业管理完全抛开了技术，纯粹的商业方向。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;技术管理，&lt;/strong&gt;这个方向是程序员最自然的选择。大部分的技术管理者，在其从程序员转为管理岗位的时候，都是在领导或公司的要求下，被动的推到技术经理岗位上的，并非是自己当初有强烈意愿、主动去选择管理岗的。然后走上曼曼打怪进阶的路线，从技术经理岗到技术总监，带领几十号人的团队冲关，然后到成为技术业务部和事业部的技术副总裁，相当于CTO了。&lt;/p&gt;
&lt;p&gt;技术管理需要在业务上有较深的理解，在技术上能够根据技术发展趋势，进行技术规划。在产品上能够极强的洞察力，进行产品规划。在团队加上能够规划团队建设、组织结构等等，所以这是综合素质的要求。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;职业管理&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;职业管理者往往更加关心于整体产品业务的团队，不限于技术团队。比如某个事业部的总裁，或者是某个业务部的总裁。大家往往都听过某某事业部空降了领导，这个领导就是属于职业管理者，他的移动性更加强，能力更加通用。这个方向是可遇不可求的，有些人一辈子都不可能触及到。这个就是天花板上的别人家的楼板，你说难不难？&lt;/p&gt;

&lt;p&gt;创业这个方向上，一般是作为技术合伙人来参与，如果想要自己的创业公司能够成功，必须是全能型创业团队，在技术、产品、营销等方面不能有明显的短板。&lt;/p&gt;
&lt;p&gt;我举一个真实的例子：&lt;strong&gt;我的上一家公司的直接领导，辞去技术总监的职位，作为一个技术合伙人创建了一个团队，主要提供物流解决方案。前几个月和他聊，公司已经在去年实现盈利1000多万，通过股权上操作，已经成为最大的股东，掌管着整个公司的前进方向。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;说到这里挺惋惜的，创立之初，当时极力的拉我入伙，被我拒绝了，理由是工资太低了，这个理由在现在看来简直可笑啊&lt;/p&gt;
&lt;hr/&gt;

&lt;h2 id=&quot;项目经理&quot;&gt;&lt;strong&gt;项目经理&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;这个方向也是程序员比较常见，也比较自然的方向。项目经理其实一种组织整合能力。不同于技术管理，这条路线走起来，几乎不需要任何外界依赖因素。&lt;/p&gt;
&lt;p&gt;最需要关注的是进度、质量、人力、成本、风险。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;那如何提升项目管理能力呢?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先需要对项目管理知识框架有个大致的认识，避免在庞大的知识体系中迷失方向，比如：&lt;/p&gt;
&lt;ul readability=&quot;3&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;范围管理：项目为何总是做不完？范围管理要界定&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;风险管理：项目风险引发的问题、成因以及防范方法&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;沟通管理：做好项目沟通计划&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;质量管理：加强项目质量&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;时间管理：项目进度控制&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;成本管理：产品成品控制&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;等等&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;其次需要掌握项目计划、项目变更、项目进展报告、复盘等过程方法。&lt;/p&gt;
&lt;p&gt;最后需要掌握跨部门协作，多维度沟通上进行加强。&lt;/p&gt;
&lt;h2 id=&quot;产品经理&quot;&gt;&lt;strong&gt;产品经理&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;程序员转产品经理，需要做到技术思维到产品思维的转换。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;技术思维角度是从功能开始，而产品思维的角度是从业务开始。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;作为程序员，当要做一个项目时候，我们最关心的是这个项目有哪些功能，然后考虑每个功能如何实现；&lt;/p&gt;
&lt;p&gt;而作为产品经理，当要做一个项目时候，我们看重这个项目的业务场景是什么，解决用户什么问题&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;技术思维角度是怎么去实现功能，而产品思维角度是为什么要这个业务。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;从技术思维的角度关注一个需求时候，总是先关注一个需求如何去实现，即HOW；&lt;/p&gt;
&lt;p&gt;而从产品思维上来关注一个需求时候，应该多问一下WHY，为什么需要这个需求，多思考为什么，从而找到需求或问题的本质。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;技术思维角度是向专家一样行动，而产品思维角度是向小白一样思考。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;作为程序员，我们日常接触到最多的还是技术人员，这些人一般来说逻辑思维都较强，擅长使用和处理各种软件，所以总是将这种形象代入到客户身上。&lt;/p&gt;
&lt;p&gt;但作为产品人员思考时候，将用户想得越“小白”越好，假设他们是不懂电脑，不太会玩手机，甚至不会打字的人。&lt;/p&gt;

&lt;p&gt;上面4个方向是程序员主要的职业发展路线，作为个人来看，如果能一直做自己热爱的工作和喜欢的角色，应该是最好的状态。&lt;/p&gt;
&lt;p&gt;不管走那一条路，一些能力是共通的，比如：技术规划、团队建设、沟通、时间管理等。处于自己的选择，可能不会选择管理方向，但是难免在以后的工作中会和管理者打交道。管理作为一种通用的素质，希望大家能够技多不压身。&lt;/p&gt;
&lt;p&gt;总之，作为程序员，技术和管理，就像人的两条腿，所有的职业发展路线都离不开，毕竟一条腿是走不远的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推荐阅读（干货）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg3NzUxMTgwNQ==&amp;amp;mid=2247483891&amp;amp;idx=1&amp;amp;sn=24cd8a6abf3b0681179dc5e5e846e0ba&amp;amp;chksm=cf2094e1f8571df70c1e37be4f3a3a81df0165e5e3359006a16ed64730fe9e5cc7fe97c37289&amp;amp;scene=21#wechat_redirect&quot;&gt;&lt;em&gt;&lt;strong&gt;程序员进阶必备能力——晋升之道&lt;/strong&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg3NzUxMTgwNQ==&amp;amp;mid=2247483792&amp;amp;idx=1&amp;amp;sn=f30fe58e4ea99d647b1853eca6bd5a6a&amp;amp;chksm=cf209482f8571d94e7dd372851397f98a838e84a9fbea9299337e5ee2301084228a4f57d315c&amp;amp;scene=21#wechat_redirect&quot;&gt;&lt;em&gt;&lt;strong&gt;送给刚毕业的程序员——7点建议&lt;/strong&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg3NzUxMTgwNQ==&amp;amp;mid=2247483826&amp;amp;idx=1&amp;amp;sn=c82601363825ba261b88c0198ee3a91d&amp;amp;chksm=cf2094a0f8571db6b69603ba66b1ac62ef588fc3668ffdcddd4ca2fa62713eb8c614e279290b&amp;amp;scene=21#wechat_redirect&quot;&gt;&lt;em&gt;&lt;strong&gt;程序员进阶技术专家必备能力——深度思考&lt;/strong&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg3NzUxMTgwNQ==&amp;amp;mid=2247483879&amp;amp;idx=1&amp;amp;sn=96067a68ebe584002a64dc0e21edb21d&amp;amp;chksm=cf2094f5f8571de38333e04d03d1dd60a56574d08d62324ae65bc73a3bc414e6d6e5e9d17121&amp;amp;scene=21#wechat_redirect&quot;&gt;&lt;em&gt;&lt;strong&gt;程序员如何选择一家好公司&lt;/strong&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;觉得不错，记得关注、转发和在看！多年经验分享，实属不易，感谢支持！&lt;/strong&gt;&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;博主是一位物联网大厂技术总监，从业7年。从软件开发、高级软件开发、技术经理再到技术总监，分享职业发展、技术管理、职场晋升、技术成长等个人多年经验和心得。一起成长！其他文章可以加我公众号如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/img_convert/3986335aa0a5a37520c1d7033744f81f.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 23:55:00 +0000</pubDate>
<dc:creator>pointersss</dc:creator>
<og:description>作为程序员，在开发岗位上做了几年，特别是到了30岁，这个而立之年，我们会来到一个重要的人生岔路口。就是管理和技术两个选择，一边专业路线，一边是管理路线。 在互联网的头部企业，对管理和技术是平等对待的，</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/pointers/p/13929733.html</dc:identifier>
</item>
<item>
<title>水电站入库流量预测--基于自定义损失函数的循环神经网络建模方法 - 牛云杰</title>
<link>http://www.cnblogs.com/NosenLiu/p/13929611.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/NosenLiu/p/13929611.html</guid>
<description>&lt;p&gt;&lt;strong&gt;&lt;span&gt;从志在必得到铩羽而归——记一次大数据竞赛经历&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;最近参加了一个比赛，在工业大数据产业创新平台上，是一个&lt;a href=&quot;http://www.industrial-bigdata.com/Challenge/title?competitionId=GKLEW707XP2O58KZNLO4UPYKCOIEQONH&quot; target=&quot;_blank&quot;&gt;水电站入库流量预测问题&lt;/a&gt;。简单看了一下题目，嚯，这个方向以前有做过啊，不说了~开整。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;赛题背景&lt;/strong&gt;：对进入水电站水库的入库流量进行精准预测，能够帮助水电站对防洪、发电计划调度工作进行合理安排。入库流量受到降水、蒸发、土壤（直接影响地表径流、地下径流）、上游来水等诸多因素的综合影响（如下图所示）。通过数据分析方法，基于大量的历史数据和可获取的监测数据，实现水电站入库流量的精准预测，将对水电站生产带来显著的安全和经济价值。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.industrial-bigdata.com/img/competition/XC62XV7TO2OVX9CE5GHW6TA0Y5E9SJQV.jpg&quot; width=&quot;634&quot; height=&quot;357&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;赛题描述&lt;/strong&gt;：基于历史数据和当前观测信息，对电站未来7日入库流量进行预测。预测时间间隔为3个小时，即对&lt;strong&gt;未来56个时间节点&lt;/strong&gt;的入库流量数据进行预测。其中，历史数据包括：&lt;strong&gt;入库流量数据&lt;/strong&gt;、&lt;strong&gt;环境观测数据&lt;/strong&gt;，&lt;strong&gt;遥测站降雨数据&lt;/strong&gt;，&lt;strong&gt;降雨预报数据&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;一.问题分析及思路简述&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;这是一个典型的时序数据预测问题。首先对数据进行分析。本次题目的原始数据时间段为2013/1/1——2018/1/7，共计5年的历史数据，目标对2018年3段数据(初赛)，2019年5段数据(复赛)进行预测，各类数据情况如下。&lt;/p&gt;
&lt;p&gt;1.入库流量数据：这是本题的预测目标，每个数据点之间时间间隔为3小时。通过观察可以看出，主办方已经将这些数据进行了归一化，流量数据都分布于0~1之间。通过对数据文件的时间节点进行扫描，发现缺失2014-11-20 11:00:00到2014-12-31 23:00:00之间的数据。&lt;/p&gt;
&lt;p&gt;2.环境表数据：环境表的数据间隔为天，即每隔24小时一个数据点。数据文件中共有三类数据，包括温度，风速，风向。其中温度和风速已经进行了归一化操作，数据依然分布在0~1之间，而风向则是原始值，数值较大且没有明显区分度（数值处于999001~999016之间）。&lt;/p&gt;
&lt;p&gt;3.遥测站降雨数据：这个数据文件较大，其时间粒度最细，每隔1个小时即有一个数据点。另外每个数据点包含39个测站，每一个数据即代表某个测站在某一小时内的降雨量。可以看出，数据也已经进行过归一化，但其数值一般都比较小，普遍小于0.1。&lt;/p&gt;
&lt;p&gt;4.降雨预报数据：降雨预报的数据以天为单位，即时间间隔为24小时。每一个时间节点上，包含5个数据点，代表未来5天的降雨情况。数据也都已经被归一化到0~1范围之内。经过扫描发现有部分日期的降雨数据缺失。如下表：&lt;/p&gt;
&lt;p&gt;&lt;span&gt;表1 降雨数据缺失情况&lt;/span&gt;&lt;/p&gt;
&lt;table border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;&lt;tbody readability=&quot;1&quot;&gt;&lt;tr&gt;&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2013-03-11&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2013-07-19&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2014-01-25&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2014-04-09&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2014-04-16&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2014-06-03&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2015-02-07&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2016-05-21&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;189&quot; readability=&quot;5&quot;&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span&gt;2017-09-30 到 2017-10-27&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;经过对数据的简单分析，发现数据存在下述问题：①数据缺失，建立模型之前，需要对缺失数据进行处理，一般使用填充法或者是在拼接训练样本时跳过缺失的数据段。②时间尺度不统一，预测目标入库流量数据的时间间隔为3小时，遥测站降雨数据时间间隔为1小时，而环境表和降雨预报数据的时间间隔都是24小时。在建模之前需要对各类数据的时间尺度进行统一。③特征较为繁杂，这里主要指的是降雨量预报数据和遥测站降雨数据；其中每个时间点的数据都包含较多特征，在建立模型时是否将其纳入，都是我们后续要完成的工作。&lt;/p&gt;
&lt;p&gt;由于数据时序性突出且在每个时间点包含多种特征（即数据有包含多个时间节点，每个时间节点又包含多个特征数据），因此计划使用RNN模型，将多个时间节点的多条特征数据丢入模型一把梭。其建模过程大概分为以下几步：①数据预处理及特征选择，②模型建立及训练，③结果预测。其中需要额外注意的是：本次比赛的评分规则为纳什效率系数（NSE），因此在建立模型的过程中，需要对损失函数（误差判别函数）进行特殊的设计。评分规则截图如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104202200472-102842530.png&quot; width=&quot;900&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt; &lt;strong&gt;&lt;span&gt;二&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;.&lt;/span&gt;&lt;span&gt;数据预处理及特征选择&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;数据预处理一般包含野值剔除、空缺值填充、数据归一化等操作。由于此次赛会提供的数据基本上都经过了归一化，就不必再进行额外的归一化操作。又由于降雨量数值的跃动性较强，极其不稳定（如图&lt;span lang=&quot;EN-US&quot;&gt;1&lt;/span&gt;），因此常规的空缺值填充方法（如均值填充、相似特征回归等）所得到的结果可信度较差，在数据预处理阶段，便不对空缺值进行填充，仅在拼接模型时将其跳过。同样的，由于降雨量数据强烈的不稳定性（如图&lt;span lang=&quot;EN-US&quot;&gt;1&lt;/span&gt;），这里不对其进行野值剔除操作，常规的&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;σ准则等野值判别方式也无法有效工作。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104202640876-884901321.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span&gt; &lt;span&gt;图1&lt;/span&gt; &lt;span&gt;&lt;span&gt;部分降雨量统计示意图&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;在特征选择方面，第一步工作是对遥测站降雨数据进行降维，即对&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;39&lt;/span&gt;&lt;span&gt;个测站的数据进行加和，形成一个单一的降雨量特征。并将其时标和入库流量数据进行统一，变为每&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;&lt;span&gt;小时1个数据点。第二步的工作是验证降雨量预报工作的可信度，具体方法是使用协方差函数，计算降雨量序列和降雨量预报序列的相关系数，其结果如下：&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;第一天预报： &lt;span lang=&quot;EN-US&quot;&gt;0.6411514582529538&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt; 第二天预报： &lt;span lang=&quot;EN-US&quot;&gt;0.556989653623267&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;第三天预报： &lt;span lang=&quot;EN-US&quot;&gt;0.5372333462465179&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt; 第四天预报： &lt;span lang=&quot;EN-US&quot;&gt;0.4850024133929662&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt; 第五天预报： &lt;span lang=&quot;EN-US&quot;&gt;0.4228036934449081&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt; &lt;span&gt;可以看出，相关系数都大于&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;0&lt;/span&gt;&lt;span&gt;，即表明未来&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;5&lt;/span&gt;&lt;span&gt;天的降雨预报与真实的降雨量之间都是正相关的，可以说预测结果都较为准确，因此将这&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;5&lt;/span&gt;&lt;span&gt;个特征全部纳入循环神经网络模型。另外基于对数据的直观理解，在环境表中，风速和温度可以直接影响水域的蒸发速率，而风向关系不是很大，因此将风向这个特征进行移除。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;三&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;.&lt;/span&gt;&lt;span&gt;模型建立及训练&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;1.&lt;/span&gt;&lt;span&gt;训练模型拼接&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;经过上一步的特征选择工作，现在一共剩下&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;9&lt;/span&gt;&lt;span&gt;种特征数据，也就是说在一个时间节点，共有&lt;/span&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;[&lt;/span&gt;&lt;span&gt;温度、风速、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;D1&lt;/span&gt;&lt;span&gt;降雨、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;D2&lt;/span&gt;&lt;span&gt;降雨、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;D3&lt;/span&gt;&lt;span&gt;降雨、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;D4&lt;/span&gt;&lt;span&gt;降雨、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;D5&lt;/span&gt;&lt;span&gt;降雨、实际降雨量（近&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;&lt;span&gt;小时）、入库流量&lt;/span&gt;&lt;/strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;strong&gt;]&lt;/strong&gt;9&lt;/span&gt;&lt;span&gt;条数据。由于题目最终要基于前一个月的数据&lt;/span&gt;&lt;span&gt;对下个月前&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;7天&lt;/span&gt;&lt;span&gt;的入库流量进行预测，这里直接将时间窗口拉满，使用前&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;30&lt;/span&gt;&lt;span&gt;天的数据作为模型输入，后&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;7&lt;/span&gt;&lt;span&gt;天的数据作为模型输出。数据的时间间隔为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;&lt;span&gt;小时，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;30&lt;/span&gt;&lt;span&gt;天的数据共有&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;240&lt;/span&gt;&lt;span&gt;个时间节点，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;7&lt;/span&gt;&lt;span&gt;天的数据共有&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;56&lt;/span&gt;&lt;span&gt;个时间节点。最终的一个训练样本由&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt;&lt;span&gt;部分组成，第一部分是维度为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(240*9)&lt;/span&gt;&lt;span&gt;的输入，第二部分使维度为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(56*1)&lt;/span&gt;&lt;span&gt;的输出，输出中仅包含接下来&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;7&lt;/span&gt;&lt;span&gt;天内的入库流量特征数据。如图&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt;&lt;span&gt;所示，单个样本的输入为绿色框中的部分，包括&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;240&lt;/span&gt;&lt;span&gt;个时间节点的全部特征数据；样本的输出为红色框内的部分，即后续&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;56&lt;/span&gt;&lt;span&gt;个时间节点的入库流量值。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104203008604-663331584.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;图&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt; &lt;span&gt;单个样本输入及输出示意&lt;/span&gt;&lt;/p&gt;
&lt;p&gt; &lt;span&gt;在进行拼接的过程中，采用窗口滑动的方法逐点获取样本，同时注意要将所有特征的时间节点对齐，所有特征数据都是时间连续且一致的情况下，再将其存入训练样本集合。最终得到&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;11189&lt;/span&gt;&lt;span&gt;条训练样本。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104203055328-202629965.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;图&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt; &lt;span&gt;训练样本及其维度&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; &lt;span lang=&quot;EN-US&quot;&gt;2.LSTM&lt;/span&gt;&lt;span&gt;循环神经网络构建&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;①前向传播计算结构&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;这里采用&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;循环神经网络模型对数据进行建模，可以同时将数据的时序性和多特征性纳入考量。在每一个时间节点，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;单元的输入由&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt;&lt;span&gt;部分组成——当前时间节点的输入，以及上一个时间节点的输出。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104203148860-211954435.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;图&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;4 LSTM&lt;/span&gt;&lt;span&gt;循环神经网络模型&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;上图是&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;单元的示意图，其公式不再具体描述。训练样本中每一个时间节点的数据，都作为输入的一部分进入&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;单元，经计算后得到输出并再次循环进入该&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;单元；直到最后一个时间节点，获得一个特征向量，维度为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(1*&lt;/span&gt;&lt;span&gt;神经元数&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;)&lt;/span&gt;&lt;span&gt;，将它乘以一个维度为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(&lt;/span&gt;&lt;span&gt;神经元数&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;*56)&lt;/span&gt;&lt;span&gt;的矩阵，得到一个长度为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;56&lt;/span&gt;&lt;span&gt;的向量，使用&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;Sigmoid&lt;/span&gt;&lt;span&gt;激活函数计算后，向量中的所有值都位于(0,1)之间。该向量即为模型的最终输出结果，代表未来&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;56&lt;/span&gt;&lt;span&gt;个时间节点的入库流量预测。&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;55&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; self.w = tf.Variable(tf.truncated_normal([self.num_nodes, self.output_dim], -0.1, 0.1),name=&lt;span&gt;'&lt;/span&gt;&lt;span&gt;w&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)   &lt;span&gt;#&lt;/span&gt;&lt;span&gt; output_dim 是指输出维度，即一个样本的Y包含几个值&lt;/span&gt;
&lt;span&gt;2&lt;/span&gt; self.b = tf.Variable(tf.zeros([self.output_dim]),name=&lt;span&gt;'&lt;/span&gt;&lt;span&gt;b&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; self.batch_in = tf.placeholder(tf.float32, [None, self.train_data.shape[1], self.input_dim],name=&lt;span&gt;'&lt;/span&gt;&lt;span&gt;batch_in&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; self.batch_out = tf.placeholder(tf.float32, [None, self.output_dim],name=&lt;span&gt;'&lt;/span&gt;&lt;span&gt;batch_out&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; lstm_cell = tf.nn.rnn_cell.BasicLSTMCell(self.num_nodes,forget_bias=1.0,state_is_tuple=&lt;span&gt;True)
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; output, final_state = tf.nn.dynamic_rnn(lstm_cell, self.batch_in, time_major=False, dtype=&lt;span&gt;tf.float32)
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt; self.y_pre = tf.nn.sigmoid(tf.matmul(final_state[1], self.w) + self.b,name=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;y_pre&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;上述代码中，w，b为最后输出结果的权重参数和偏置，用来将RNN最后一个时间节点输出的特征向量转换为一个长度为56的最终输出向量。batch_in，batch_out则是输入的占位符，代表训练样本的输入(X)和输出(Y)，其第一维设置为None，使其可以匹配任意数量的样本，方便成批开展训练。在第5行中的num_nodes代表神经元数目，同时也是特征向量的长度。y_pre则代表前向传播的最终结果，也是最终得到的预测值。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;②定义损失函数及反向传播计算&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;之后需要定义损失函数及反向传播计算。这里重点对损失函数的设计进行详细说明，本次题目的评分规则比较特殊，不同于一般的交叉熵函数、均方根误差等评价方式，这里使用纳什效率系数&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(NSE)&lt;/span&gt;&lt;span&gt;作为评价指标。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104203253302-1688099432.png&quot; width=&quot;450&quot; loading=&quot;lazy&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;在进行&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;NSE&lt;/span&gt;&lt;span&gt;计算的过程中，将数据分成两段，前&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt;&lt;span&gt;天的误差结果给予&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.65&lt;/span&gt;&lt;span&gt;的权重，后&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;5&lt;/span&gt;&lt;span&gt;天的结果给予&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.35&lt;/span&gt;&lt;span&gt;的权重。根据题目要求，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;NSE&lt;/span&gt;&lt;span&gt;越大，评分越高。也就是说需要公式右侧的两个减数：&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt; &lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104203625880-1584576638.png&quot; width=&quot;450&quot; loading=&quot;lazy&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt; &lt;span&gt;尽可能小。因此，在设计损失函数时，将nse'&lt;/span&gt;&lt;span&gt;设置为损失函数，并在训练模型的过程中使其朝着损失变小的方向进行训练。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;49&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; self.batch_out_mean = tf.reshape(tf.reduce_mean(self.batch_out,axis=1),[-1,1&lt;span&gt;])
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; self.nse_left = 0.65*tf.reduce_sum(tf.square(self.batch_out[:,:16]-self.y_pre[:,:16]),axis=1)/tf.reduce_sum(tf.square(self.batch_out[:,:16]-self.batch_out_mean),axis=1&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; self.nse_right = 0.35*tf.reduce_sum(tf.square(self.batch_out[:,16:]-self.y_pre[:,16:]),axis=1)/tf.reduce_sum(tf.square(self.batch_out[:,16:]-self.batch_out_mean),axis=1&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; self.nse = tf.reduce_mean(self.nse_left+self.nse_right,name=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;nse&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; self.train_op =&lt;span&gt; tf.train.RMSPropOptimizer(self.lr).minimize(self.nse)
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; self.saver = tf.train.Saver()
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;上述代码中，self.nse代指的是上方公式中的nse'变量。首先计算这一批真实值中每一个样本向量的均值，再分别计算nse'的两个部分，赋予其0.65及0.35的权重，之后再加和。之后在第5行，设置优化器，使模型在反向传播计算的过程中，沿着nse'减小的方向优化。反向传播的过程构造完毕。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;3.&lt;/span&gt;&lt;span&gt;模型训练及参数调优&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;①梯度爆炸问题的解决&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;在对部分训练样本进行训练的过程中，发现某些样本在经历几轮训练后损失值急剧攀升，成为某个较大的固定值后便不再有任何变动。初步分析是损失函数nse'&lt;/span&gt;&lt;span&gt;中，有部分Q&lt;sub&gt;o&lt;sup&gt;t&lt;/sup&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span&gt;值与观测序列均值&lt;/span&gt;&lt;span&gt;接近，导致分母部分接近于&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;0&lt;/span&gt;&lt;span&gt;，以致损失函数值激增，导致梯度爆炸。为解决这个问题，分阶段对训练样本进行测试，筛除会导致梯度爆炸的样本，最终筛除的样本为：&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;6200~6460&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;7650~8100&lt;/span&gt;&lt;span&gt;共计&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;710&lt;/span&gt;&lt;span&gt;个样本，约占样本总数的&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;6%&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;②训练样本切分&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;经过样本筛除之后，剩余样本共&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;10479&lt;/span&gt;&lt;span&gt;个，将这些训练样本划分为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;&lt;span&gt;个集合，即&lt;strong&gt;训练集、验证集、测试集&lt;/strong&gt;。其中训练集占比&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;90%&lt;/span&gt;&lt;span&gt;，共&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;9431&lt;/span&gt;&lt;span&gt;条样本；验证集和测试集占比都为&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;5%&lt;/span&gt;&lt;span&gt;，分别含有&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;524&lt;/span&gt;&lt;span&gt;条训练样本。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;③学习率调节及训练终止条件设置&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;在每一轮次的训练中，&lt;strong&gt;仅使用训练集中的数据对模型参数进行优化调节&lt;/strong&gt;，并在完成一轮训练之后，使用当前的模型参数，对验证集中的训练样本进行预测，并计算其nse'&lt;/span&gt;&lt;span&gt;。如果该模型对训练集的预测效果优于上一轮，则继续训练；如果模型连续&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;3&lt;/span&gt;&lt;span&gt;轮在验证集中没有取得更好的预测效果，则将学习率降低&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;50%&lt;/span&gt;&lt;span&gt;，以防止模型在最优解附近震荡；如果模型连续&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;4&lt;/span&gt;&lt;span&gt;轮没有在验证集中取得更好的预测效果，则结束训练，保存模型参数。训练结束以后，使用得到的模型对测试集数据进行预测，计算其nse'&lt;/span&gt;&lt;span&gt;结果，与验证集差距不大的话，则说明模型的预测结果可信。&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;54&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; last_loss = 9999.9
&lt;span&gt; 2&lt;/span&gt; last_4_converge = [1,1,1,1&lt;span&gt;]
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; last_3_converge = [1,1,1&lt;span&gt;]
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;for&lt;/span&gt; i &lt;span&gt;in&lt;/span&gt;&lt;span&gt; range(epochs):
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; j &lt;span&gt;in&lt;/span&gt; range(int(len(self.train_data)/&lt;span&gt;self.batch_size)):
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         batch_i = self.train_data[j*self.batch_size:(j+1)*&lt;span&gt;self.batch_size]
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         batch_o = self.train_label[j*self.batch_size:(j+1)*&lt;span&gt;self.batch_size]
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;         self.sess.run(self.train_op, feed_dict=&lt;span&gt;{self.batch_in:batch_i, self.batch_out:batch_o.reshape(self.batch_size,self.output_dim)})
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (i+1)%1==&lt;span&gt;0:
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         this_loss = self.sess.run(self.nse,feed_dict=&lt;span&gt;{self.batch_in:self.validate_X, self.batch_out:self.validate_Y.reshape(len(self.validate_Y),self.output_dim)})
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;(this_loss&amp;gt;=&lt;span&gt;last_loss):
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;            last_3_converge.append(0)
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;            last_3_converge.pop(0)
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;            last_4_converge.append(0)
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;            last_4_converge.pop(0)
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;         &lt;span&gt;else&lt;/span&gt;&lt;span&gt;:
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;             last_3_converge.append(1&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;            last_3_converge.pop(0)
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             last_4_converge.append(1&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;            last_4_converge.pop(0)
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;         last_loss =&lt;span&gt; this_loss
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;         train_loss = self.sess.run(self.nse,feed_dict=&lt;span&gt;{self.batch_in:batch_i,self.batch_out:batch_o.reshape(self.batch_size,self.output_dim)})
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;epoch:%d train:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;%(i+1),train_loss,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;  validate:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,this_loss,&lt;span&gt;'&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;,last_4_converge)
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;((1 &lt;span&gt;not&lt;/span&gt; &lt;span&gt;in&lt;/span&gt; last_4_converge) &lt;span&gt;or&lt;/span&gt; (self.lr&amp;lt;0.000002)):  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;连续4轮未收敛或学习率过小时，结束训练&lt;/span&gt;
&lt;span&gt;25&lt;/span&gt;             &lt;span&gt;break&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;         &lt;span&gt;elif&lt;/span&gt;(1 &lt;span&gt;not&lt;/span&gt; &lt;span&gt;in&lt;/span&gt; last_3_converge):  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;连续3轮未收敛，降低学习率&lt;/span&gt;
&lt;span&gt;27&lt;/span&gt;             self.lr = self.lr*0.5
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;④模型训练&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;根据上述的方法描述，构建&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;LSTM&lt;/span&gt;&lt;span&gt;深度学习模型，开展训练，经过多轮调整测试，发现超参数在设置为下表中的结果时，预测效果较好。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;表&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;2&lt;/span&gt; &lt;span&gt;模型超参数设置建议&lt;/span&gt;&lt;/p&gt;
&lt;table class=&quot;MsoTableGrid&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;隐藏层神经元数目&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;批处理大小&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;初始学习率&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span&gt;优化器&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;256&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;32&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.002 / 0.003&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td width=&quot;142&quot;&gt;
&lt;p class=&quot;MsoNormal&quot; align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;RMSProp&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt; &lt;span&gt;通过共计&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;1000&lt;/span&gt;&lt;span&gt;轮次的训练&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(&lt;/span&gt;&lt;span&gt;两轮&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;500&lt;/span&gt;&lt;span&gt;次的训练&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;)&lt;/span&gt;&lt;span&gt;，最终得到预测模型。其对&lt;strong&gt;训练集&lt;/strong&gt;上最后一个批次的数据预测偏差&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(nse'&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;)&lt;/span&gt;&lt;span&gt;为&lt;/span&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.151&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;，对&lt;strong&gt;验证集&lt;/strong&gt;中所有数据的预测偏差&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;(nse'&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;)&lt;/span&gt;&lt;span&gt;为&lt;/span&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.19552&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;，对&lt;strong&gt;测试集&lt;/strong&gt;中所有样本的预测偏差&lt;/span&gt;(nse')&lt;span&gt;为&lt;/span&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;0.19509&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104212222284-79969287.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt; &lt;span&gt;图&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;5&lt;/span&gt; &lt;span&gt;训练结果&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;结果出来一看，哎，这模型厉害了！对于没有训练过的的测试集来说，其预测结果的平均nse'是0.19509，按照赛会给出的计分公式&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;: score=(1-nse')*100，理论上讲，对于新的输入样本，预测结果的nse平均应该是0.805左右，咋地也能得到80来分的成绩。后面又把测试集的预测结果图像画出来一看，嘿，还真不错。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104213400335-228205291.png&quot; width=&quot;600&quot; loading=&quot;lazy&quot;/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104213848510-1726711581.png&quot; width=&quot;600&quot; loading=&quot;lazy&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104214222022-1924697568.png&quot; width=&quot;600&quot; loading=&quot;lazy&quot;/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1463653/202011/1463653-20201104215234045-1527400718.png&quot; width=&quot;600&quot; loading=&quot;lazy&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;上面是测试集中找了几个比较有代表性的数据样本预测结果，不论是哪种形状的数据，递增的、大段固定值的、以天为单位强周期的，都能取得不错的效果，尤其是对入库流量的峰谷趋势把握的相当到位。预测最差的也就是最后一张图片，nse'的值约为1.064。看到这些，瞬间觉得信心爆棚，胜利似乎近在眼前。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;但现实总是无情打脸，在使用这个模型对目标数据进行预测时，效果很不理想。上传预测结果后，基本上是负分，对于复赛中2019年的5段数据更是超出了下界，即意味着nse'的值超过了2.0。最后终究没有冲进决赛圈（前30），折戟赛场，铩羽而归。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;四.原因分析及个人感悟&lt;/span&gt;&lt;/strong&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;技术层面：&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;对于已有的2013年初至2017年底的数据，本文所构建的LSTM循环神经网络表现良好，能够对未来7天的入库流量数据进行精准的预测。但对主办方给出的3段2018年数据及5段2019年数据，则效果欠佳，损失函数nse'值扩大了5~20倍不等。由于主办方并未公开2018年及2019年数据，无法做到按例分析。猜测出现该问题的原因可能是以下几个方面：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;①模型对已有数据(2013.1——2017.12)产生了过拟合。理论上来讲，这种现象是不会发生的，因为在进行模型训练的过程中，模型参数调整仅依赖于训练集，而模型训练程度则由验证集进行判断，&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;测试集始终没有参与其中。以前在别的时序数据预测项目中出现过模型在测试集上表现糟糕，而在训练集和验证集上表现良好的现象，可以推测出模型对训练集合验证集拟合过度。本次比赛中这种对训练集、验证集、测试集都表现良好而在新的样本上表现差劲的现象还是第一次遇到。经过思考，为避免模型对已有数据产生过拟合，可以在设置终止条件时，控制学习率的大小，为其规定一个最小值，当学习率调整小于该值时，停止训练。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;②在解决梯度爆炸问题的过程中，剔除了710个样本，这710个样本中可能存在某种规律没有被模型所掌握。关于这个问题有两种解决方案：一是在损失函数中，在计算分母时判断其值的大小，为其规定一个最小值，如0.01，避免梯度的爆炸；二是使用常规损失函数如rmse(均方根误差)来训练出第二个模型，预测结果由两个模型进行均值融合后获得。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;③时间窗口设置过长。这次为了节约建模时间，把时间窗口设置到最大的30天，这样便增加了模型的复杂度，在进行训练时，更多的时间窗口便意味着特征向量在LSTM结构里循环了更多的次数，也就更容易产生梯度爆炸/消失问题。另外，直观上来讲，30天前的降雨对当前的河流水量产生不了太大影响，因此设定一个较短的、符合实际情况的时间窗口更加合适。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span&gt;心理层面：&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;通过这次比赛有以下收获：一是不能钻牛角尖，骄兵必败。在初赛阶段，我已经发现上传的预测结果无法达到模型的理论得分，当时经过了500轮的训练，模型的理论得分在70分左右，但上传的2018年3条数据预测结果只得到了-20分的成绩。由于对于自己的模型信仰坚定，我判断是训练还不够不充分所导致。便又深入训练了500轮，达到了理论得分80分的水平，在复赛中对2019年5条数据的预测结果直接崩盘，达到-100分开外......二是将所有特征放进模型里面一把梭，会使其参数量增大，模型复杂度也会跟着暴涨，根据奥卡姆剃刀法则，越复杂的模型也就越难以信任。未来的建模过程中还应投入更多的人工分析工作，不能一味信任复杂模型。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p&gt;欢迎各位大佬进行指导，提出改进意见。&lt;/p&gt;

</description>
<pubDate>Wed, 04 Nov 2020 17:15:00 +0000</pubDate>
<dc:creator>牛云杰</dc:creator>
<og:description>从志在必得到铩羽而归——记一次大数据竞赛经历 最近参加了一个比赛，在工业大数据产业创新平台上，是一个水电站入库流量预测问题。简单看了一下题目，嚯，这个方向以前有做过啊，不说了~开整。 赛题背景：对进入</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/NosenLiu/p/13929611.html</dc:identifier>
</item>
<item>
<title>了解JWT认证 - 云崖先生</title>
<link>http://www.cnblogs.com/Yunya-Cnblogs/p/13929169.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/Yunya-Cnblogs/p/13929169.html</guid>
<description>&lt;p&gt;　　 &lt;code&gt;JWT&lt;/code&gt;的全称为&lt;code&gt;Json web token&lt;/code&gt;，是为了在网络应用环境间传递声明而执行的一种基于&lt;code&gt;JSON&lt;/code&gt;的开放标准（(RFC 7519).该&lt;code&gt;token&lt;/code&gt;被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。&lt;/p&gt;
&lt;p&gt;　　 &lt;code&gt;JWT&lt;/code&gt;的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该&lt;code&gt;token&lt;/code&gt;也可直接被用于认证，也可被加密。&lt;/p&gt;

&lt;p&gt;　　 &lt;code&gt;JWT&lt;/code&gt;的本质就是&lt;code&gt;token&lt;/code&gt;，它主要有三部分组成，分别是头部（header）、荷载（payload）主题部、以及签证（signature）。&lt;/p&gt;
&lt;p&gt;　　 前两部分都是由&lt;code&gt;base64&lt;/code&gt;进行编码（可反接的加密），后一部分是不可反解的加密，由前两部分&lt;code&gt;base64&lt;/code&gt;的结果加密（hash256）后组成。&lt;/p&gt;
&lt;p&gt;　　 各部分之间用&lt;code&gt;.&lt;/code&gt;进行分割，如下所示：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;eyJ0eXBlIjogIkpXVCIsICJhbGciOiAiSEFTSDI1NiJ9.7B226964223A202231303031222C20226E616D65223A202279756E7961222C2022616765223A20223138227D.3495bb47139c954ba17c3081262c55d2b436346e0d58990202cc668b7bca54ac
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;header&lt;/h2&gt;
&lt;p&gt;　　 &lt;code&gt;header&lt;/code&gt;中一般都具有两种信息:&lt;/p&gt;
&lt;blockquote readability=&quot;9&quot;&gt;
&lt;p&gt;　　 声明类型，这里是jwt&lt;/p&gt;
&lt;p&gt;　　 声明加密的算法 通常直接使用 HMAC SHA256&lt;/p&gt;
&lt;p&gt;　　 当然你也可以添加上其他信息，如公司名称等。这都是允许的&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;　　 下面进行自定义头部，&lt;code&gt;JSON&lt;/code&gt;格式：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{
    &quot;type&quot;:&quot;JWT&quot;,
    &quot;alg&quot;:&quot;HASH256&quot;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;　　 然后使用&lt;code&gt;base64&lt;/code&gt;对其进行编码，得到&lt;code&gt;JWT&lt;/code&gt;中的&lt;code&gt;header&lt;/code&gt;部分：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;eyJ0eXBlIjogIkpXVCIsICJhbGciOiAiSEFTSDI1NiJ9
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;payload&lt;/h2&gt;
&lt;p&gt;　　 荷载部作为&lt;code&gt;JWT&lt;/code&gt;三部分中的第二部分，都是存放有效信息。它可以存放三种类型的有效信息：&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;　　 标准中注册的声明&lt;/p&gt;
&lt;p&gt;　　 公共的声明&lt;/p&gt;
&lt;p&gt;　　 私有的声明&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;　　 &lt;strong&gt;标准中注册的声明&lt;/strong&gt;(建议但不强制使用)：&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;荷载部位的key&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;iss&lt;/td&gt;
&lt;td&gt;JWT签发者（服务端）&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;sub&lt;/td&gt;
&lt;td&gt;JWT所面向的用户&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;aud&lt;/td&gt;
&lt;td&gt;接收JWT的一方&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;exp&lt;/td&gt;
&lt;td&gt;JWT的过期时间，该时间必须大于签发时间&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;nbf&lt;/td&gt;
&lt;td&gt;再某一时间段之前，该JWT不可用&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;jti&lt;/td&gt;
&lt;td&gt;JWT的唯一身份标识，主要用作一次性token，回避时序攻击&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;　　 &lt;strong&gt;公共的声明：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　 公共的声明可以添加任何的信息，一般添加用户的相关信息或其他业务需要的必要信息，但不建议添加敏感信息，因为该部分在客户端可解密。&lt;/p&gt;
&lt;p&gt;　　 &lt;strong&gt;私有的声明：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;　　 私有声明是提供者和消费者所共同定义的声明，一般不建议存放敏感信息，因为&lt;code&gt;base64&lt;/code&gt;是对称解密的，意味着该部分信息可以归类为明文信息。&lt;/p&gt;
&lt;p&gt;　　 如下，定义一个&lt;code&gt;payload&lt;/code&gt;：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{
    &quot;id&quot;:&quot;1001&quot;,
    &quot;name&quot;:&quot;yunya&quot;,
    &quot;age&quot;:&quot;12&quot;,
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;　　 然后将其进行&lt;code&gt;base64&lt;/code&gt;加密，得到&lt;code&gt;JWT&lt;/code&gt;的第二部分。&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;7B226964223A202231303031222C20226E616D65223A202279756E7961222C2022616765223A20223138227D
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;signature&lt;/h2&gt;
&lt;p&gt;　　 &lt;code&gt;JWT&lt;/code&gt;的第三部分是一个签证信息，这个签证信息由三部分组成&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;　　 header (base64后的)&lt;/p&gt;
&lt;p&gt;　　 payload (base64后的)&lt;/p&gt;
&lt;p&gt;　　 secret&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;　　 这个部分需要&lt;code&gt;base64&lt;/code&gt;加密后的&lt;code&gt;header&lt;/code&gt;和&lt;code&gt;base64&lt;/code&gt;加密后的&lt;code&gt;payload&lt;/code&gt;使用&lt;code&gt;.&lt;/code&gt;连接组成的字符串，然后通过&lt;code&gt;header&lt;/code&gt;中声明的加密方式进行加盐&lt;code&gt;secret&lt;/code&gt;组合加密，然后就构成了&lt;code&gt;JWT&lt;/code&gt;的第三部分。&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;signature = hashlib.sha256()
signature.update(header_payload_result)
signature.update(&quot;salt&quot;.encode(&quot;utf-8&quot;)) # 加盐
signature_result = signature.hexdigest()  # 获得结果
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;　　 &lt;code&gt;JWT&lt;/code&gt;第三部分结果：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;3495bb47139c954ba17c3081262c55d2b436346e0d58990202cc668b7bca54ac
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;最终的JWT&lt;/h2&gt;
&lt;p&gt;　　 下面将用&lt;code&gt;Python&lt;/code&gt;进行演示，如何创建一个&lt;code&gt;JWT&lt;/code&gt;：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;import base64
import hashlib
import json


# 第一步：进行头部声明
header = {
    &quot;type&quot;:&quot;JWT&quot;,
    &quot;alg&quot;:&quot;HASH256&quot;
}

header_result = base64.b64encode(json.dumps(header).encode(&quot;utf-8&quot;))

# 第二步：进行荷载声明，不要存放密码等敏感信息，因为可通过反解出来（你也可以存放过期时间等，都是OK的）
payload = {
    &quot;id&quot;:&quot;1001&quot;,
    &quot;name&quot;:&quot;yunya&quot;,
    &quot;age&quot;:&quot;18&quot;,
}

payload_result = base64.b16encode(json.dumps(payload).encode(&quot;utf-8&quot;))

# 第三步：将头部与荷载进行 . 拼接
header_payload_result = header_result + b&quot;.&quot; + payload_result


# 第四步：将头部与荷载的信息与盐进行hash256加密（通常加密方式都是再alg中声明的），得到签证
signature = hashlib.sha256()
signature.update(header_payload_result)
signature.update(&quot;salt&quot;.encode(&quot;utf-8&quot;)) # 加盐
signature_result = signature.hexdigest()  # 获得结果

# 第五步：通过 . 拼接出jwt
jwt = header_payload_result + b&quot;.&quot; + signature_result.encode(&quot;utf-8&quot;)
print(jwt)

# b'eyJ0eXBlIjogIkpXVCIsICJhbGciOiAiSEFTSDI1NiJ9.7B226964223A202231303031222C20226E616D65223A202279756E7961222C2022616765223A20223138227D.3495bb47139c954ba17c3081262c55d2b436346e0d58990202cc668b7bca54ac'
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;　　 下面是&lt;code&gt;JWT&lt;/code&gt;的验证流程：&lt;/p&gt;
&lt;p&gt;　　 &lt;img src=&quot;https://images-1302522496.cos.ap-nanjing.myqcloud.com/img/image-20201104162935792.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;　　 再附上一张原生&lt;code&gt;token&lt;/code&gt;验证的流程：&lt;/p&gt;
&lt;p&gt;　　 &lt;img src=&quot;https://img2020.cnblogs.com/blog/1881426/202009/1881426-20200919213804002-566281459.png&quot; alt=&quot;image-20200917011529551&quot;/&gt;&lt;/p&gt;

&lt;p&gt;　　 要想了解&lt;code&gt;JWT&lt;/code&gt;的优势，则需要与&lt;code&gt;cookie&lt;/code&gt;以及&lt;code&gt;session&lt;/code&gt;做对比。&lt;/p&gt;
&lt;p&gt;　　 &lt;code&gt;cookie&lt;/code&gt;的劣势主要是存储时不安全，所有数据存放只用户本地，一旦被窃取就可以伪造登录。&lt;/p&gt;
&lt;p&gt;　　 &lt;code&gt;session&lt;/code&gt;的劣势主要有三点：①.数据存放至服务器，占用服务器资源。②.每次用户登录成功后，都需要向数据库中写入&lt;code&gt;session&lt;/code&gt;，速度缓慢。③.对于集群式的部署，如果存储&lt;code&gt;session&lt;/code&gt;的数据库不一致，则会是个大麻烦，因为用户如果接入了不同的服务器，则意味着写入的&lt;code&gt;session&lt;/code&gt;也在不同的数据库中。这会导致用户的&lt;code&gt;session&lt;/code&gt;在不同数据库中会存在多次写入的问题。&lt;/p&gt;
&lt;p&gt;　　 了解了&lt;code&gt;cookie&lt;/code&gt;以及&lt;code&gt;session&lt;/code&gt;的劣势后，&lt;code&gt;jwt&lt;/code&gt;的优势就显而易见。&lt;/p&gt;
&lt;p&gt;　　 用户数据存放至本地，但必须要与服务端存储的盐进行对比一致后才认证成功。&lt;/p&gt;
&lt;p&gt;　　 不需要有数据库写入的操作。&lt;/p&gt;
&lt;p&gt;　　 集群式部署时也没有任何问题，前提是每个服务器的盐都一样。&lt;/p&gt;
&lt;p&gt;　　 &lt;a href=&quot;http://liuqingzheng.top/python/Django-rest-framework%E6%A1%86%E6%9E%B6/9-drf-JWT%E8%AE%A4%E8%AF%81/&quot;&gt;点我了解更多&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 14:38:00 +0000</pubDate>
<dc:creator>云崖先生</dc:creator>
<og:description>JWT介绍 JWT的全称为Json web token，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布式站点的</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/Yunya-Cnblogs/p/13929169.html</dc:identifier>
</item>
<item>
<title>不吹不黑，跨平台框架AspNetCore开发实践杂谈 - 画星星高手</title>
<link>http://www.cnblogs.com/deali/p/13929132.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/deali/p/13929132.html</guid>
<description>&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-e1529b0c4e91d0e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;最近边学边做，初步上手了AspNetCore的开发，对MVC这套熟悉了一下，因为之前没有拿来做过独立项目，都是和别人合作开发，所以前后端分离，我都只做WebApi，而且还是很小的项目（课设级别），生产环境用最多的应该是Python的Django框架，这次我把一个之前做的Django项目用AspNetCore重写一遍，性能提升了不少，C#的性能真不是盖的，AspNetCore这个框架的性能也很不错，榜上有名的（WebApi），虽然MVC排不上名，但是性能依旧甩Django很多，Django每次上线前就做各种性能优化，恐怖，不过性能太好也不行，等会公司觉得工作量不饱和（逃）&lt;/p&gt;
&lt;p&gt;ok，既然是杂谈，那也不用把条理梳理得很清楚，我随意列几个方面对比其他框架（Django和Spring之类）聊一聊~&lt;br/&gt;由于我是初学者，对各种概念的理解可能有偏差的地方请各位大佬指正，也欢迎大家一起交流哈哈&lt;/p&gt;
&lt;h2 id=&quot;依赖注入&quot;&gt;依赖注入&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-eaf38529e04ecdfc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;对于写习惯Django的我来说，依赖注入以前是很少用到的，刚刚搜了一下，发现Stack Overflow上有一个讨论（Why is IoC / DI not common in Python?）说得不错，给我扫盲了一下，传送门：&lt;a href=&quot;https://stackoverflow.com/questions/2461702/why-is-ioc-di-not-common-in-python&quot;&gt;https://stackoverflow.com/questions/2461702/why-is-ioc-di-not-common-in-python&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Python的模块是天生单例模式的，比起Java这种甚至单例模式有多少种实现方式都能进面试题的语言，不知道高到哪里去了，C#好很多，有静态类，不过在开发中还是会以Singleton模式注册到IoC容器中来实现单例~&lt;/p&gt;
&lt;p&gt;依赖注入有个很形象的类比，就是把静态语言当成动态脚本语言来用：启动时把一堆东西丢进去IoC容器里，等到要用的时候告诉容器要给你什么，容器就帮你生成，而在容器里面的这堆东西又可以导入别的依赖，这样层层下来相互依赖，如果框架运行过程出问题的话排查起来很痛苦hhh，还要注意避免因为设计问题导致循环依赖等各类问题，所以感觉Django在设计上还是好，生产力是真的高，其他Web框架用得少，除了AspNetCore和Django这些，就用了传统的Spring、Beego和其他小众语言的MVC框架（我甚至用过dart写后台，然并卵），有时间试试新兴的的Vert.x、WebFlux这类，应该会比较好玩~&lt;/p&gt;
&lt;p&gt;就这个IoC和DI来说AspNetCore和Spring差不多，功能上差不多，使用方法也差不多，hhh，不过写起来肯定是不如Python畅快的，不过为啥我还要用AspNetCore这种东西呢，因为静态类型语言写起来爽呀，Drf写接口特别快，但是写起来基本靠猜，哈哈哈，感觉这个形容很贴切。最近有个FastApi的看起来不错，据说是100%的类型注解，可以把Python当成静态类型语言来写，但是这种框架太新了，没有经过市场的验证，很难在生产环境用上…&lt;/p&gt;
&lt;h2 id=&quot;orm&quot;&gt;ORM&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-39acee66f2f8b164.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;数据库操作是现在Web框架的核心（误？），我也不知道，反正Web开发基本就是CRUD，整天和数据库打交道是没错的，所以ORM很重要，设计合理好用的ORM可以减少很多工作量，Django为啥受欢迎一大原因就是它的ORM很强大很好用，这应该也是动态语言的优势之一吧。&lt;/p&gt;
&lt;p&gt;.NetCore平台上的其他ORM我只用过EF Core和Chloe（官网：&lt;a href=&quot;https://github.com/shuxinqin/Chloe%EF%BC%89%EF%BC%8C%E8%BF%99%E4%B8%AAChloe%E4%B9%9F%E6%98%AF%E4%B8%80%E4%B8%AA%E5%9B%BD%E4%BA%A7ORM%EF%BC%8C%E7%94%A8%E8%B5%B7%E6%9D%A5%E8%9B%AE%E6%96%B9%E4%BE%BF%E7%9A%84%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B8%8D%E6%94%AF%E6%8C%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%EF%BC%8C%E6%B2%A1%E5%8A%9E%E6%B3%95%E6%A0%B9%E6%8D%AE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%EF%BC%8C%E8%BF%99%E7%82%B9%E8%BF%98%E6%98%AF%E6%9C%89%E7%82%B9%E4%B8%8D%E7%88%BD%E7%9A%84%E3%80%82EFCore%E6%98%AF%E5%BE%AE%E8%BD%AF%E5%AE%98%E6%96%B9%E7%9A%84ORM%EF%BC%8C%E8%87%AA%E7%84%B6%E6%98%AF%E5%A5%BD%E7%94%A8%EF%BC%8C%E6%94%AF%E6%8C%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%81%E7%A7%BB%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%B0%B1%E5%BE%88%E6%96%B9%E4%BE%BF%E4%BA%86%EF%BC%8C%E7%84%B6%E5%90%8E%E5%85%B6%E4%BB%96%E7%89%B9%E7%82%B9%E6%88%91%E4%B9%9F%E6%80%BB%E7%BB%93%E4%B8%8D%E5%87%BA%E6%9D%A5%EF%BC%8C%E5%9B%A0%E4%B8%BA%E7%94%A8%E5%BE%97%E4%B8%8D%E6%B7%B1%EF%BC%8C%E6%B2%A1%E5%95%A5%E7%89%B9%E5%88%AB%E7%9A%84%E4%BD%93%E4%BC%9A%E3%80%82&quot;&gt;https://github.com/shuxinqin/Chloe），这个Chloe也是一个国产ORM，用起来蛮方便的，但是不支持数据库迁移，没办法根据代码生成数据库表，这点还是有点不爽的。EFCore是微软官方的ORM，自然是好用，支持数据库迁移，这个就很方便了，然后其他特点我也总结不出来，因为用得不深，没啥特别的体会。&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这次项目我选的ORM是国产的FreeSQL，原因是偶然间在博客园看到作者王婆卖瓜的文章，觉得还不错，然后就拿来用一用，确实挺好用的，可以很轻量一句话完成数据库连接建立，也可以像EFCore那样有各种丰富的功能，而且也支持DB First，这个就很舒服了，这次因为是把Django项目迁移到AspNetCore，所以我打算先用原来的数据库试试看，然后FreeSQL一通DB First之后居然美滋滋的可以用，就更坚定了要继续用下去的信心，哈哈（虽然后面遇到了很多坑，大多是关于多对多关系的，被DjangoORM惯坏了）&lt;/p&gt;
&lt;p&gt;FreeSQL官网文档：&lt;a href=&quot;https://github.com/dotnetcore/FreeSql/wiki&quot;&gt;https://github.com/dotnetcore/FreeSql/wiki&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;体验下来，FreeSQL对外键（一对多、多对一）、多对多、一对一关系的处理方式还是可以的，通过「导航属性」，跟EFCore应该差不多，但是定义Model的时候如果有外键，还有多定义一个字段存Id，这点感觉有点反人类了，EFCore不用，直接引用对象即可，迁移之后反映到表里就是一个外键Id，不过这个FreeSQL是软外键，引用归引用，关系全都在代码里面处理，不在数据库里面生成外键，这个也有它的好处，甚至可以说是一个优势了，有时候维护表的完整性约束有点麻烦hhh&lt;/p&gt;
&lt;p&gt;参考文章：.NET ORM 导航属性到底可以解决什么问题？&lt;a href=&quot;https://www.cnblogs.com/kellynic/p/13575053.html&quot;&gt;https://www.cnblogs.com/kellynic/p/13575053.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;然后再小小对比了一下Kotlin的Ktorm，这也是一个优秀的ORM，上次我也小小的试用了一下，挺不错的，除了没有迁移功能没法自动建表，这个Ktorm用起来类似EFCore的体验，同样是外键直接引用就行，不用像FreeSQL那样留一个Id字段来保存，各有利弊吧…不展开了&lt;/p&gt;
&lt;p&gt;&lt;em&gt;PS：之前的文章里吐槽了Ktorm之后被作者大佬看到找上来手把手指导我写代码了（逃），有些坑真不是框架的问题，还是自己太菜了啊…&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;数据库&quot;&gt;数据库&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-8dba01755d701da8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;数据库我用SQLite，反正小项目我全都用这个，性能好，部署方便，虽然有写入锁，但就几个人在用的系统，要啥自行车？&lt;/p&gt;
&lt;h2 id=&quot;viewmodel&quot;&gt;ViewModel&lt;/h2&gt;
&lt;p&gt;ViewModel在分层架构中很重要，其实除了ViewModel还有一个叫DTO（Data Transfer Object）的概念，ViewModel和DTO在MVC架构中同属于Model层，DTO也可以叫做Input Model，因为一般作为外部传入数据的对象（顾名思义嘛），然后通常总是在说的Model，其实也可以叫Entity，这些对象是直接对应到数据库中的表，一般在View或者Api中不直接呈现Model，而是呈现ViewModel，因为可能我们会对要输出的数据做一些处理啦，比如增加字段删除字段这些，用Model肯定不行，数据表都是固定的。&lt;/p&gt;
&lt;p&gt;同理，在传入数据的时候，和数据表也不一定重合的，所以需要借助DTO，其实和ViewModel没什么严格的界限，你要拿DTO去呈现也行，只是我觉得ViewModel看名字就是拿来呈现的，习惯哈哈。&lt;/p&gt;
&lt;p&gt;其实传统的MVC、MVVM模式都已经有点跟不上时代了，我觉得现在的Web应用就得按照DDD（Domain-Driven Design）模式来设计，不过DDD初学有点复杂，概念很多，我也不好乱解释，引用一下知乎的一段回答：&lt;/p&gt;
&lt;blockquote readability=&quot;11.455894476505&quot;&gt;
&lt;p&gt;DDD简单说是: 一个项目里面有多个Bounded Context， 譬如说一个是前台面向用户的，一个是后台面向公司内部人员的。每个Bounded Context里面会分为多个aggregate。每个aggregate里面包含了一堆需要保证事务性一致的物体，也就是说从全局来说，每个aggregate都是当作一个整体。常见的例子就是Order（订单）和OrderLine(订单里面的商品）。Entity包括Aggregate root都有唯一标识。两者的区别是aggregate root全局里面有唯一标识，而aggregate 内部其他entity只是在aggregate内部有唯一标识（也许你数据库里面有主键，但是这边是指概念上来说这个唯一标识对全局来说意义不大，只有在aggregate内部意义才大）。另外的value object就是没有标识的物体，他们的意义就在于它的值，你可以想象成比较两个entity是不是同一个只需要判断ID是否相等，而判断value objects需要看里面的每个属性是否一样。&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-d514ca7d26cd74c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;作者：鲍牙叔&lt;br/&gt;链接：&lt;a href=&quot;https://www.zhihu.com/question/25256772/answer/77940547&quot;&gt;https://www.zhihu.com/question/25256772/answer/77940547&lt;/a&gt;&lt;br/&gt;来源：知乎&lt;br/&gt;著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后，这么多对象在转来转去，又有很多字段是差不多的，一个个重新赋值显得很傻也根本没必要，这个时候AutoMapper就要用起来了，具体用法不是本文的讨论范围（参考下方列出的官方文档），不过提一点，AutoMapper是可以配置的，有哪些字段不要的可以排除，我在Profile中是这么写的：&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-c#&quot;&gt;public class VideoProfile : Profile {
    private readonly List&amp;lt;string&amp;gt; _unmapped = new List&amp;lt;string&amp;gt; {
        &quot;HostEnvironment&quot;, &quot;Previews&quot;, &quot;OverallRating&quot;
    };
    public VideoProfile() {
        CreateMap&amp;lt;Video, VideoViewModel&amp;gt;();
        ShouldMapProperty = (property) =&amp;gt; !_unmapped.Contains(property.Name);
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;把不要的字段放在一个List里面，然后用lambda配置 ShouldMapProperty 就好啦。&lt;/p&gt;
&lt;p&gt;参考&lt;/p&gt;
&lt;h2 id=&quot;一些关于c语言的&quot;&gt;一些关于C#语言的&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-79ebb68a613ef300.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;C#语言我用很久了，但是却几乎没有专门去学习过语法，这门语言，emmm，下限低，上限很高，上手很简单，但复杂度比Java高很多，语法糖很多，所以圈子里的人很多有种高人一等的优越感哈哈，但其实国内的生态是比较差啦，有就是一些培训班啥的在吹，不过国外可以感觉到是比较热门的一个技术，平时遇到啥问题，可能用中文关键词搜不到，但是换成英文可以轻松搜索到很多高质量的答案，只能说国内的技术环境被阿里之类的大厂带偏了，大家都去搞Java了，很多其他好技术和好的语言无人问津，可惜啊……&lt;/p&gt;
&lt;p&gt;这次项目也没用到啥高大上的东西，就是泛型、扩展方法、高阶函数这类，用得飞起，贴一小段代码来看看哈哈~&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-c#&quot;&gt;public static IList&amp;lt;TViewModel&amp;gt; ToViewModels&amp;lt;TModel, TViewModel&amp;gt;(
    this ISelect&amp;lt;TModel&amp;gt; data,
    IService&amp;lt;TModel, TViewModel&amp;gt; service,
    int limit = 0
) where TModel : class
    where TViewModel : class {
    var limitData = limit == 0 ? data : data.Limit(limit);
    return limitData
        .ToList()
        .Select(service.Get)
        .ToList();
}

public static IEnumerable&amp;lt;TViewModel&amp;gt; ToSampleViewModels&amp;lt;TModel, TViewModel&amp;gt;(
    this ISelect&amp;lt;TModel&amp;gt; data,
    IService&amp;lt;TModel, TViewModel&amp;gt; service,
    int limit = 0
) where TModel : class
    where TViewModel : class {
    return data.ToViewModels(service)
        .Shuffle()
        .Take(limit);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;这个代码就是把FreeSQL查询数据库的结果一键转换为ViewModel，转换过程是通过Service，功能很简单，但是做成扩展方法然后调用真的不要太爽，减少了n多代码重复，很舒服~&lt;/p&gt;
&lt;p&gt;然后C#的高阶函数一开始我有点不习惯，因为之前写习惯python、dart和js，都是map、reduce、filter这些，但是C#的LINQ中却换了个名字，map对应select、filter对应where，这就很像SQL的风格了，我一开始都找不到……&lt;/p&gt;
&lt;p&gt;总之C#语言值得好好学一学，对提高工作效率和编程思维是有帮助的！多看书就完事了！&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8869373-9c07b1e44a9fb8ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;参考资料&quot;&gt;参考资料&lt;/h3&gt;
&lt;h2 id=&quot;几个库&quot;&gt;几个库&lt;/h2&gt;
&lt;p&gt;另外还有看到好像蛮不错的几个库，我还没用，目前已经把AspNetCore应用到工作中了，以后应该有机会把这些库用上hhh&lt;/p&gt;
&lt;h2 id=&quot;欢迎交流&quot;&gt;欢迎交流&lt;/h2&gt;
&lt;p&gt;我整理了一系列的技术文章和资料，在公众号「程序设计实验室」后台回复 linux、flutter、c#、netcore、android、kotlin、java、python 等可获取相关技术文章和资料，同时有任何问题都可以在公众号后台留言~&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 14:31:00 +0000</pubDate>
<dc:creator>画星星高手</dc:creator>
<og:description>前言 最近边学边做，初步上手了AspNetCore的开发，对MVC这套熟悉了一下，因为之前没有拿来做过独立项目，都是和别人合作开发，所以前后端分离，我都只做WebApi，而且还是很小的项目（课设级别）</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/deali/p/13929132.html</dc:identifier>
</item>
<item>
<title>Azure Data Factory（三）集成 Azure Devops 实现CI/CD - Grant_Allen</title>
<link>http://www.cnblogs.com/AllenMaster/p/13922858.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/AllenMaster/p/13922858.html</guid>
<description>&lt;h2&gt;一，引言&lt;/h2&gt;
&lt;p&gt;　　由于上一节文章内容过长，无法分享Azure Data Factory 的持续集成，持续发布。今天将着重介绍一下在使用 Azure DevOps Pipeline 发布，自动进行持续集成，并且已自动化发布，将Azure Data Factory 部署到多个环境中。&lt;/p&gt;
&lt;p&gt;　　其实大家也不必惊讶，这里的部署其实也没有多么神秘的，我们在ADF中的 master 分支发布之后，其实会将ADF中所有的配置信息打包，编译到adf_master 分支下面，如果大家仔细看过发布之后的代码，就很很容易发现，都是一些 ARM 模板资源。以当前我创建的demo为例&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201103211813440-2079048822.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;这是就有人在问了，什么是ARM模板？这里就先见到你的概规一下：&lt;/p&gt;
&lt;p&gt;　　针对于Azure上一些基础设施资源的部署，可以通过运用基础架构即代码，可是实现部署自动化，在代码中定义需要部署的基础架构资源。将这些基础架构资源代码变成项目的一部分，与应用程序代码一样。通过代码管理工具，管理起来，方便部署，通过代码的方式创建、删除资源。而ARM模板就是基础架构即代码的一种形式（另外一种是 Terraform）,&lt;span data-ttu-id=&quot;a3166-115&quot;&gt;该模板是一个定义项目基础结构和配置的 JavaScript 对象表示法 (JSON) 文件。 &lt;span data-ttu-id=&quot;a3166-116&quot;&gt;该模板使用声明性语法，使你可以指明要部署的内容，而不需要编写一系列编程命令来创建内容。 &lt;span data-ttu-id=&quot;a3166-117&quot;&gt;在该模板中，指定要部署的资源以及这些资源的属性。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span data-ttu-id=&quot;a3166-115&quot;&gt;&lt;span data-ttu-id=&quot;a3166-116&quot;&gt;&lt;span data-ttu-id=&quot;a3166-117&quot;&gt;说人话，就是ARM模板中描述了我们需要部署的云资源以及其资源所需要的参数，比如说通过使用ARM不是一台VM，那么ARM模板中就描述了VM资源以及其创建VM所需要的必要的参数。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span data-ttu-id=&quot;a3166-115&quot;&gt;&lt;span data-ttu-id=&quot;a3166-116&quot;&gt;&lt;span data-ttu-id=&quot;a3166-117&quot;&gt;回到ADF中，也就是说我们最终通过master分支发布到 adf_master 分支的代码，其实就是一堆描述ADF资源以及ADF配置的属性及参数。我们今天的内容也就是通过ARM去实现ADF的 UAT，PRO 环境的部署。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span data-ttu-id=&quot;a3166-115&quot;&gt;&lt;span data-ttu-id=&quot;a3166-116&quot;&gt;&lt;span data-ttu-id=&quot;a3166-117&quot;&gt;--------------------我是分割线--------------------&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://www.cnblogs.com/AllenMaster/p/13895871.html&quot; target=&quot;_blank&quot;&gt;1，Azure Data Factory（一）入门简介&lt;/a&gt;&lt;/h3&gt;
&lt;h3&gt;&lt;a href=&quot;https://www.cnblogs.com/AllenMaster/p/13903209.html&quot; target=&quot;_blank&quot;&gt;2，Azure Data Factory（二）复制数据&lt;/a&gt;&lt;/h3&gt;
&lt;h3&gt;&lt;a href=&quot;https://www.cnblogs.com/AllenMaster/p/13922858.html&quot; target=&quot;_blank&quot;&gt;3，Azure Data Factory（三）集成 Azure Devops 实现CI/CD&lt;/a&gt;&lt;/h3&gt;
&lt;h2&gt;二，正文&lt;/h2&gt;
&lt;h3&gt;1，创建ADF的 UAT 环境&lt;/h3&gt;
&lt;p&gt;我们通过资源名+UAT的方式来模拟测试环境，如下新创建了一个叫 &quot;ADF-CnBateBlogWeb-UAT&quot; 的 Azure Data Factory 和 两个UAT 环境的 Blob Storage&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201103215909684-1698589864.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;”cnbateblogwebaccount1dev“ 作为UAT 环境的数据源，我们也为UAT环境创建叫 “resformfolder” 的容器&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201103215713907-25430409.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;“cnbateblogwebaccount2dev” 作为UAT 环境的目标源，我们也为UAT环境创建叫 “restofolder” 的容器&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201103215837497-985899751.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;2，初始化部署前后脚本&lt;/h3&gt;
&lt;p&gt;实际中，我们在部署ADF 甚至其他项目代码时，都是需要将AFD的触发器停止，等到部署完成后，我们就得重启ADF中配置的触发器。微软有帮助我们提供了部署前后可以使用的脚本&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43.5&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_5816b11c-cda3-4f34-b572-50af04159a4f&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_5816b11c-cda3-4f34-b572-50af04159a4f&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_5816b11c-cda3-4f34-b572-50af04159a4f&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;82&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;param&lt;/span&gt;
&lt;span&gt;  2&lt;/span&gt; &lt;span&gt;(
&lt;/span&gt;&lt;span&gt;  3&lt;/span&gt;     [parameter(Mandatory = &lt;span&gt;$false&lt;/span&gt;)] [String] &lt;span&gt;$armTemplate&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;  4&lt;/span&gt;     [parameter(Mandatory = &lt;span&gt;$false&lt;/span&gt;)] [String] &lt;span&gt;$ResourceGroupName&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;  5&lt;/span&gt;     [parameter(Mandatory = &lt;span&gt;$false&lt;/span&gt;)] [String] &lt;span&gt;$DataFactoryName&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;  6&lt;/span&gt;     [parameter(Mandatory = &lt;span&gt;$false&lt;/span&gt;)] [Bool] &lt;span&gt;$predeployment&lt;/span&gt;=&lt;span&gt;$true&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;  7&lt;/span&gt;     [parameter(Mandatory = &lt;span&gt;$false&lt;/span&gt;)] [Bool] &lt;span&gt;$deleteDeployment&lt;/span&gt;=&lt;span&gt;$false&lt;/span&gt;
&lt;span&gt;  8&lt;/span&gt; &lt;span&gt;)
&lt;/span&gt;&lt;span&gt;  9&lt;/span&gt; 
&lt;span&gt; 10&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; getPipelineDependencies {
&lt;/span&gt;&lt;span&gt; 11&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;([System.Object] &lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.Pipeline) {
&lt;/span&gt;&lt;span&gt; 13&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; @(&lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.Pipeline.ReferenceName)
&lt;/span&gt;&lt;span&gt; 14&lt;/span&gt;     } &lt;span&gt;elseif&lt;/span&gt; (&lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.Activities) {
&lt;/span&gt;&lt;span&gt; 15&lt;/span&gt;         &lt;span&gt;$result&lt;/span&gt; = @&lt;span&gt;()
&lt;/span&gt;&lt;span&gt; 16&lt;/span&gt;         &lt;span&gt;$activity&lt;/span&gt;.Activities | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$result&lt;/span&gt; += getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 17&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;$result&lt;/span&gt;
&lt;span&gt; 18&lt;/span&gt;     } &lt;span&gt;elseif&lt;/span&gt; (&lt;span&gt;$activity&lt;/span&gt;.ifFalseActivities &lt;span&gt;-or&lt;/span&gt; &lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.ifTrueActivities) {
&lt;/span&gt;&lt;span&gt; 19&lt;/span&gt;         &lt;span&gt;$result&lt;/span&gt; = @&lt;span&gt;()
&lt;/span&gt;&lt;span&gt; 20&lt;/span&gt;         &lt;span&gt;$activity&lt;/span&gt;.ifFalseActivities | Where-Object {&lt;span&gt;$_&lt;/span&gt; &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;$null&lt;/span&gt;} | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$result&lt;/span&gt; += getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 21&lt;/span&gt;         &lt;span&gt;$activity&lt;/span&gt;.ifTrueActivities | Where-Object {&lt;span&gt;$_&lt;/span&gt; &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;$null&lt;/span&gt;} | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$result&lt;/span&gt; += getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 22&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;$result&lt;/span&gt;
&lt;span&gt; 23&lt;/span&gt;     } &lt;span&gt;elseif&lt;/span&gt; (&lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.defaultActivities) {
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt;         &lt;span&gt;$result&lt;/span&gt; = @&lt;span&gt;()
&lt;/span&gt;&lt;span&gt; 25&lt;/span&gt;         &lt;span&gt;$activity&lt;/span&gt;.defaultActivities | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$result&lt;/span&gt; += getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$activity&lt;/span&gt;&lt;span&gt;.cases) {
&lt;/span&gt;&lt;span&gt; 27&lt;/span&gt;             &lt;span&gt;$activity&lt;/span&gt;.cases | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$_&lt;/span&gt;.activities } | &lt;span&gt;ForEach&lt;/span&gt;-Object{&lt;span&gt;$result&lt;/span&gt; += getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 29&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;$result&lt;/span&gt;
&lt;span&gt; 30&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 31&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; @&lt;span&gt;()
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 33&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 34&lt;/span&gt; 
&lt;span&gt; 35&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; pipelineSortUtil {
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;([Microsoft.Azure.Commands.DataFactoryV2.Models.PSPipeline]&lt;span&gt;$pipeline&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 37&lt;/span&gt;     [Hashtable] &lt;span&gt;$pipelineNameResourceDict&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 38&lt;/span&gt;     [Hashtable] &lt;span&gt;$visited&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 39&lt;/span&gt;     [System.Collections.Stack] &lt;span&gt;$sortedList&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 40&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$visited&lt;/span&gt;[&lt;span&gt;$pipeline&lt;/span&gt;.Name] &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 41&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 42&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 43&lt;/span&gt;     &lt;span&gt;$visited&lt;/span&gt;[&lt;span&gt;$pipeline&lt;/span&gt;.Name] = &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 44&lt;/span&gt;     &lt;span&gt;$pipeline&lt;/span&gt;.Activities | &lt;span&gt;ForEach&lt;/span&gt;-Object{ getPipelineDependencies -activity &lt;span&gt;$_&lt;/span&gt; -pipelineNameResourceDict &lt;span&gt;$pipelineNameResourceDict&lt;/span&gt;}  | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object{
&lt;/span&gt;&lt;span&gt; 45&lt;/span&gt;         pipelineSortUtil -pipeline &lt;span&gt;$pipelineNameResourceDict&lt;/span&gt;[&lt;span&gt;$_&lt;/span&gt;] -pipelineNameResourceDict &lt;span&gt;$pipelineNameResourceDict&lt;/span&gt; -visited &lt;span&gt;$visited&lt;/span&gt; -sortedList &lt;span&gt;$sortedList&lt;/span&gt;
&lt;span&gt; 46&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 47&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt;.Push(&lt;span&gt;$pipeline&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 48&lt;/span&gt; 
&lt;span&gt; 49&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 50&lt;/span&gt; 
&lt;span&gt; 51&lt;/span&gt; &lt;span&gt;function&lt;/span&gt; Get-&lt;span&gt;SortedPipelines {
&lt;/span&gt;&lt;span&gt; 52&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;&lt;span&gt;(
&lt;/span&gt;&lt;span&gt; 53&lt;/span&gt;         [string] &lt;span&gt;$DataFactoryName&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 54&lt;/span&gt;         [string] &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt; 55&lt;/span&gt; &lt;span&gt;    )
&lt;/span&gt;&lt;span&gt; 56&lt;/span&gt;     &lt;span&gt;$pipelines&lt;/span&gt; = Get-AzDataFactoryV2Pipeline -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt; 57&lt;/span&gt;     &lt;span&gt;$ppDict&lt;/span&gt; = @&lt;span&gt;{}
&lt;/span&gt;&lt;span&gt; 58&lt;/span&gt;     &lt;span&gt;$visited&lt;/span&gt; = @&lt;span&gt;{}
&lt;/span&gt;&lt;span&gt; 59&lt;/span&gt;     &lt;span&gt;$stack&lt;/span&gt; = new-&lt;span&gt;object System.Collections.Stack
&lt;/span&gt;&lt;span&gt; 60&lt;/span&gt;     &lt;span&gt;$pipelines&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$ppDict&lt;/span&gt;[&lt;span&gt;$_&lt;/span&gt;.Name] = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 61&lt;/span&gt;     &lt;span&gt;$pipelines&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object{ pipelineSortUtil -pipeline &lt;span&gt;$_&lt;/span&gt; -pipelineNameResourceDict &lt;span&gt;$ppDict&lt;/span&gt; -visited &lt;span&gt;$visited&lt;/span&gt; -sortedList &lt;span&gt;$stack&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 62&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt; = new-&lt;span&gt;object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSPipeline]
&lt;/span&gt;&lt;span&gt; 63&lt;/span&gt;     
&lt;span&gt; 64&lt;/span&gt;     &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;$stack&lt;/span&gt;.Count &lt;span&gt;-gt&lt;/span&gt; 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 65&lt;/span&gt;         &lt;span&gt;$sortedList&lt;/span&gt;.Add(&lt;span&gt;$stack&lt;/span&gt;&lt;span&gt;.Pop())
&lt;/span&gt;&lt;span&gt; 66&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 67&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt;
&lt;span&gt; 68&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 69&lt;/span&gt; 
&lt;span&gt; 70&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; triggerSortUtil {
&lt;/span&gt;&lt;span&gt; 71&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;([Microsoft.Azure.Commands.DataFactoryV2.Models.PSTrigger]&lt;span&gt;$trigger&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 72&lt;/span&gt;     [Hashtable] &lt;span&gt;$triggerNameResourceDict&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 73&lt;/span&gt;     [Hashtable] &lt;span&gt;$visited&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 74&lt;/span&gt;     [System.Collections.Stack] &lt;span&gt;$sortedList&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 75&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$visited&lt;/span&gt;[&lt;span&gt;$trigger&lt;/span&gt;.Name] &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 76&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 77&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt;     &lt;span&gt;$visited&lt;/span&gt;[&lt;span&gt;$trigger&lt;/span&gt;.Name] = &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 79&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$trigger&lt;/span&gt;&lt;span&gt;.Properties.DependsOn) {
&lt;/span&gt;&lt;span&gt; 80&lt;/span&gt;         &lt;span&gt;$trigger&lt;/span&gt;.Properties.DependsOn | Where-Object {&lt;span&gt;$_&lt;/span&gt; &lt;span&gt;-and&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.ReferenceTrigger} | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object{
&lt;/span&gt;&lt;span&gt; 81&lt;/span&gt;             triggerSortUtil -trigger &lt;span&gt;$triggerNameResourceDict&lt;/span&gt;[&lt;span&gt;$_&lt;/span&gt;.ReferenceTrigger.ReferenceName] -triggerNameResourceDict &lt;span&gt;$triggerNameResourceDict&lt;/span&gt; -visited &lt;span&gt;$visited&lt;/span&gt; -sortedList &lt;span&gt;$sortedList&lt;/span&gt;
&lt;span&gt; 82&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 83&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt;.Push(&lt;span&gt;$trigger&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 85&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 86&lt;/span&gt; 
&lt;span&gt; 87&lt;/span&gt; &lt;span&gt;function&lt;/span&gt; Get-&lt;span&gt;SortedTriggers {
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;&lt;span&gt;(
&lt;/span&gt;&lt;span&gt; 89&lt;/span&gt;         [string] &lt;span&gt;$DataFactoryName&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 90&lt;/span&gt;         [string] &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt; 91&lt;/span&gt; &lt;span&gt;    )
&lt;/span&gt;&lt;span&gt; 92&lt;/span&gt;     &lt;span&gt;$triggers&lt;/span&gt; = Get-AzDataFactoryV2Trigger -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt;
&lt;span&gt; 93&lt;/span&gt;     &lt;span&gt;$triggerDict&lt;/span&gt; = @&lt;span&gt;{}
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt;     &lt;span&gt;$visited&lt;/span&gt; = @&lt;span&gt;{}
&lt;/span&gt;&lt;span&gt; 95&lt;/span&gt;     &lt;span&gt;$stack&lt;/span&gt; = new-&lt;span&gt;object System.Collections.Stack
&lt;/span&gt;&lt;span&gt; 96&lt;/span&gt;     &lt;span&gt;$triggers&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object{ &lt;span&gt;$triggerDict&lt;/span&gt;[&lt;span&gt;$_&lt;/span&gt;.Name] = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 97&lt;/span&gt;     &lt;span&gt;$triggers&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object{ triggerSortUtil -trigger &lt;span&gt;$_&lt;/span&gt; -triggerNameResourceDict &lt;span&gt;$triggerDict&lt;/span&gt; -visited &lt;span&gt;$visited&lt;/span&gt; -sortedList &lt;span&gt;$stack&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt; 98&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt; = new-&lt;span&gt;object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSTrigger]
&lt;/span&gt;&lt;span&gt; 99&lt;/span&gt;     
&lt;span&gt;100&lt;/span&gt;     &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;$stack&lt;/span&gt;.Count &lt;span&gt;-gt&lt;/span&gt; 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;101&lt;/span&gt;         &lt;span&gt;$sortedList&lt;/span&gt;.Add(&lt;span&gt;$stack&lt;/span&gt;&lt;span&gt;.Pop())
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;103&lt;/span&gt;     &lt;span&gt;$sortedList&lt;/span&gt;
&lt;span&gt;104&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;105&lt;/span&gt; 
&lt;span&gt;106&lt;/span&gt; &lt;span&gt;function&lt;/span&gt; Get-&lt;span&gt;SortedLinkedServices {
&lt;/span&gt;&lt;span&gt;107&lt;/span&gt;     &lt;span&gt;param&lt;/span&gt;&lt;span&gt;(
&lt;/span&gt;&lt;span&gt;108&lt;/span&gt;         [string] &lt;span&gt;$DataFactoryName&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;109&lt;/span&gt;         [string] &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;110&lt;/span&gt; &lt;span&gt;    )
&lt;/span&gt;&lt;span&gt;111&lt;/span&gt;     &lt;span&gt;$linkedServices&lt;/span&gt; = Get-AzDataFactoryV2LinkedService -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt;
&lt;span&gt;112&lt;/span&gt;     &lt;span&gt;$LinkedServiceHasDependencies&lt;/span&gt; = @&lt;span&gt;('HDInsightLinkedService', 'HDInsightOnDemandLinkedService', 'AzureBatchLinkedService')
&lt;/span&gt;&lt;span&gt;113&lt;/span&gt;     &lt;span&gt;$Akv&lt;/span&gt; =&lt;span&gt; 'AzureKeyVaultLinkedService'
&lt;/span&gt;&lt;span&gt;114&lt;/span&gt;     &lt;span&gt;$HighOrderList&lt;/span&gt; = New-&lt;span&gt;Object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSLinkedService]
&lt;/span&gt;&lt;span&gt;115&lt;/span&gt;     &lt;span&gt;$RegularList&lt;/span&gt; = New-&lt;span&gt;Object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSLinkedService]
&lt;/span&gt;&lt;span&gt;116&lt;/span&gt;     &lt;span&gt;$AkvList&lt;/span&gt; = New-&lt;span&gt;Object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSLinkedService]
&lt;/span&gt;&lt;span&gt;117&lt;/span&gt; 
&lt;span&gt;118&lt;/span&gt;     &lt;span&gt;$linkedServices&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object {
&lt;/span&gt;&lt;span&gt;119&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.Properties.GetType().Name -&lt;span&gt;in&lt;/span&gt; &lt;span&gt;$LinkedServiceHasDependencies&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;120&lt;/span&gt;             &lt;span&gt;$HighOrderList&lt;/span&gt;.Add(&lt;span&gt;$_&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;121&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;122&lt;/span&gt;         &lt;span&gt;elseif&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.Properties.GetType().Name &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;$Akv&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;             &lt;span&gt;$AkvList&lt;/span&gt;.Add(&lt;span&gt;$_&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;124&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;125&lt;/span&gt;         &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;126&lt;/span&gt;             &lt;span&gt;$RegularList&lt;/span&gt;.Add(&lt;span&gt;$_&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;127&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;128&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;129&lt;/span&gt; 
&lt;span&gt;130&lt;/span&gt;     &lt;span&gt;$SortedList&lt;/span&gt; = New-Object Collections.Generic.List[Microsoft.Azure.Commands.DataFactoryV2.Models.PSLinkedService](&lt;span&gt;$HighOrderList&lt;/span&gt;.Count + &lt;span&gt;$RegularList&lt;/span&gt;.Count + &lt;span&gt;$AkvList&lt;/span&gt;&lt;span&gt;.Count)
&lt;/span&gt;&lt;span&gt;131&lt;/span&gt;     &lt;span&gt;$SortedList&lt;/span&gt;.AddRange(&lt;span&gt;$HighOrderList&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;132&lt;/span&gt;     &lt;span&gt;$SortedList&lt;/span&gt;.AddRange(&lt;span&gt;$RegularList&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;133&lt;/span&gt;     &lt;span&gt;$SortedList&lt;/span&gt;.AddRange(&lt;span&gt;$AkvList&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;134&lt;/span&gt;     &lt;span&gt;$SortedList&lt;/span&gt;
&lt;span&gt;135&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;136&lt;/span&gt; 
&lt;span&gt;137&lt;/span&gt; &lt;span&gt;$templateJson&lt;/span&gt; = Get-Content &lt;span&gt;$armTemplate&lt;/span&gt; | ConvertFrom-&lt;span&gt;Json
&lt;/span&gt;&lt;span&gt;138&lt;/span&gt; &lt;span&gt;$resources&lt;/span&gt; = &lt;span&gt;$templateJson&lt;/span&gt;&lt;span&gt;.resources
&lt;/span&gt;&lt;span&gt;139&lt;/span&gt; 
&lt;span&gt;140&lt;/span&gt; &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Triggers &lt;/span&gt;
&lt;span&gt;141&lt;/span&gt; Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Getting triggers&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;142&lt;/span&gt; &lt;span&gt;$triggersInTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/triggers&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;143&lt;/span&gt; &lt;span&gt;$triggerNamesInTemplate&lt;/span&gt; = &lt;span&gt;$triggersInTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;)}
&lt;/span&gt;&lt;span&gt;144&lt;/span&gt; 
&lt;span&gt;145&lt;/span&gt; &lt;span&gt;$triggersDeployed&lt;/span&gt; = Get-SortedTriggers -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;146&lt;/span&gt; 
&lt;span&gt;147&lt;/span&gt; &lt;span&gt;$triggersToStop&lt;/span&gt; = &lt;span&gt;$triggersDeployed&lt;/span&gt; | Where-Object { &lt;span&gt;$triggerNamesInTemplate&lt;/span&gt; &lt;span&gt;-contains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.Name } | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;148&lt;/span&gt;     New-Object PSObject -Property @&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;149&lt;/span&gt;         Name = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;150&lt;/span&gt;         TriggerType = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Properties.GetType().Name 
&lt;/span&gt;&lt;span&gt;151&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;152&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;153&lt;/span&gt; &lt;span&gt;$triggersToDelete&lt;/span&gt; = &lt;span&gt;$triggersDeployed&lt;/span&gt; | Where-Object { &lt;span&gt;$triggerNamesInTemplate&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.Name } | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;154&lt;/span&gt;     New-Object PSObject -Property @&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;155&lt;/span&gt;         Name = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;156&lt;/span&gt;         TriggerType = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Properties.GetType().Name 
&lt;/span&gt;&lt;span&gt;157&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;158&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;159&lt;/span&gt; &lt;span&gt;$triggersToStart&lt;/span&gt; = &lt;span&gt;$triggersInTemplate&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.properties.runtimeState &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Started&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;-and&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.properties.pipelines.Count &lt;span&gt;-gt&lt;/span&gt; 0 &lt;span&gt;-or&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.properties.pipeline.pipelineReference &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;$null&lt;/span&gt;)} | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;160&lt;/span&gt;     New-Object PSObject -Property @&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;161&lt;/span&gt;         Name = &lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;162&lt;/span&gt;         TriggerType = &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Properties.type
&lt;/span&gt;&lt;span&gt;163&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;164&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;165&lt;/span&gt; 
&lt;span&gt;166&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$predeployment&lt;/span&gt; &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;167&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Stop all triggers&lt;/span&gt;
&lt;span&gt;168&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Stopping deployed triggers`n&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;169&lt;/span&gt;     &lt;span&gt;$triggersToStop&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object {
&lt;/span&gt;&lt;span&gt;170&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.TriggerType &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;BlobEventsTrigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;171&lt;/span&gt;             Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Unsubscribing&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.Name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;from events&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;172&lt;/span&gt;             &lt;span&gt;$status&lt;/span&gt; = Remove-AzDataFactoryV2TriggerSubscription -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;173&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;$status&lt;/span&gt;.Status &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Disabled&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;){
&lt;/span&gt;&lt;span&gt;174&lt;/span&gt;                 Start-Sleep -s 15
&lt;span&gt;175&lt;/span&gt;                 &lt;span&gt;$status&lt;/span&gt; = Get-AzDataFactoryV2TriggerSubscriptionStatus -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;176&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;177&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;178&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Stopping trigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;179&lt;/span&gt;         Stop-AzDataFactoryV2Trigger -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;.Name -&lt;span&gt;Force
&lt;/span&gt;&lt;span&gt;180&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;181&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;182&lt;/span&gt; &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;183&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Deleted resources&lt;/span&gt;
&lt;span&gt;184&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;pipelines&lt;/span&gt;
&lt;span&gt;185&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Getting pipelines&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;186&lt;/span&gt;     &lt;span&gt;$pipelinesADF&lt;/span&gt; = Get-SortedPipelines -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;187&lt;/span&gt;     &lt;span&gt;$pipelinesTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/pipelines&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;188&lt;/span&gt;     &lt;span&gt;$pipelinesNames&lt;/span&gt; = &lt;span&gt;$pipelinesTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;)}
&lt;/span&gt;&lt;span&gt;189&lt;/span&gt;     &lt;span&gt;$deletedpipelines&lt;/span&gt; = &lt;span&gt;$pipelinesADF&lt;/span&gt; | Where-Object { &lt;span&gt;$pipelinesNames&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name }
&lt;/span&gt;&lt;span&gt;190&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;dataflows&lt;/span&gt;
&lt;span&gt;191&lt;/span&gt;     &lt;span&gt;$dataflowsADF&lt;/span&gt; = Get-AzDataFactoryV2DataFlow -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;192&lt;/span&gt;     &lt;span&gt;$dataflowsTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/dataflows&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;193&lt;/span&gt;     &lt;span&gt;$dataflowsNames&lt;/span&gt; = &lt;span&gt;$dataflowsTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;) }
&lt;/span&gt;&lt;span&gt;194&lt;/span&gt;     &lt;span&gt;$deleteddataflow&lt;/span&gt; = &lt;span&gt;$dataflowsADF&lt;/span&gt; | Where-Object { &lt;span&gt;$dataflowsNames&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name }
&lt;/span&gt;&lt;span&gt;195&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;datasets&lt;/span&gt;
&lt;span&gt;196&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Getting datasets&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;197&lt;/span&gt;     &lt;span&gt;$datasetsADF&lt;/span&gt; = Get-AzDataFactoryV2Dataset -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;198&lt;/span&gt;     &lt;span&gt;$datasetsTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/datasets&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;199&lt;/span&gt;     &lt;span&gt;$datasetsNames&lt;/span&gt; = &lt;span&gt;$datasetsTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;) }
&lt;/span&gt;&lt;span&gt;200&lt;/span&gt;     &lt;span&gt;$deleteddataset&lt;/span&gt; = &lt;span&gt;$datasetsADF&lt;/span&gt; | Where-Object { &lt;span&gt;$datasetsNames&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name }
&lt;/span&gt;&lt;span&gt;201&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;linkedservices&lt;/span&gt;
&lt;span&gt;202&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Getting linked services&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;203&lt;/span&gt;     &lt;span&gt;$linkedservicesADF&lt;/span&gt; = Get-SortedLinkedServices -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;204&lt;/span&gt;     &lt;span&gt;$linkedservicesTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/linkedservices&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;205&lt;/span&gt;     &lt;span&gt;$linkedservicesNames&lt;/span&gt; = &lt;span&gt;$linkedservicesTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;)}
&lt;/span&gt;&lt;span&gt;206&lt;/span&gt;     &lt;span&gt;$deletedlinkedservices&lt;/span&gt; = &lt;span&gt;$linkedservicesADF&lt;/span&gt; | Where-Object { &lt;span&gt;$linkedservicesNames&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name }
&lt;/span&gt;&lt;span&gt;207&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Integrationruntimes&lt;/span&gt;
&lt;span&gt;208&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Getting integration runtimes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;209&lt;/span&gt;     &lt;span&gt;$integrationruntimesADF&lt;/span&gt; = Get-AzDataFactoryV2IntegrationRuntime -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;210&lt;/span&gt;     &lt;span&gt;$integrationruntimesTemplate&lt;/span&gt; = &lt;span&gt;$resources&lt;/span&gt; | Where-Object { &lt;span&gt;$_&lt;/span&gt;.type &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Microsoft.DataFactory/factories/integrationruntimes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;211&lt;/span&gt;     &lt;span&gt;$integrationruntimesNames&lt;/span&gt; = &lt;span&gt;$integrationruntimesTemplate&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-Object {&lt;span&gt;$_&lt;/span&gt;.name.Substring(37, &lt;span&gt;$_&lt;/span&gt;.name.Length-40&lt;span&gt;)}
&lt;/span&gt;&lt;span&gt;212&lt;/span&gt;     &lt;span&gt;$deletedintegrationruntimes&lt;/span&gt; = &lt;span&gt;$integrationruntimesADF&lt;/span&gt; | Where-Object { &lt;span&gt;$integrationruntimesNames&lt;/span&gt; &lt;span&gt;-notcontains&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name }
&lt;/span&gt;&lt;span&gt;213&lt;/span&gt; 
&lt;span&gt;214&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Delete resources&lt;/span&gt;
&lt;span&gt;215&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting triggers&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;216&lt;/span&gt;     &lt;span&gt;$triggersToDelete&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;217&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting trigger &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;  &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;218&lt;/span&gt;         &lt;span&gt;$trig&lt;/span&gt; = Get-AzDataFactoryV2Trigger -name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt;
&lt;span&gt;219&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$trig&lt;/span&gt;.RuntimeState &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Started&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;220&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.TriggerType &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;BlobEventsTrigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;221&lt;/span&gt;                 Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Unsubscribing trigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.Name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;from events&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;222&lt;/span&gt;                 &lt;span&gt;$status&lt;/span&gt; = Remove-AzDataFactoryV2TriggerSubscription -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;223&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;$status&lt;/span&gt;.Status &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Disabled&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;){
&lt;/span&gt;&lt;span&gt;224&lt;/span&gt;                     Start-Sleep -s 15
&lt;span&gt;225&lt;/span&gt;                     &lt;span&gt;$status&lt;/span&gt; = Get-AzDataFactoryV2TriggerSubscriptionStatus -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;226&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;227&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;228&lt;/span&gt;             Stop-AzDataFactoryV2Trigger -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;.Name -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;229&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;230&lt;/span&gt;         Remove-AzDataFactoryV2Trigger -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;231&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;232&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting pipelines&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;233&lt;/span&gt;     &lt;span&gt;$deletedpipelines&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;234&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting pipeline &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;235&lt;/span&gt;         Remove-AzDataFactoryV2Pipeline -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;236&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;237&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting dataflows&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;238&lt;/span&gt;     &lt;span&gt;$deleteddataflow&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;239&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting dataflow &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;240&lt;/span&gt;         Remove-AzDataFactoryV2DataFlow -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;241&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;242&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting datasets&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;243&lt;/span&gt;     &lt;span&gt;$deleteddataset&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;244&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting dataset &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;245&lt;/span&gt;         Remove-AzDataFactoryV2Dataset -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;246&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;247&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting linked services&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;248&lt;/span&gt;     &lt;span&gt;$deletedlinkedservices&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;249&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting Linked Service &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;250&lt;/span&gt;         Remove-AzDataFactoryV2LinkedService -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;251&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;252&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting integration runtimes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;253&lt;/span&gt;     &lt;span&gt;$deletedintegrationruntimes&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;254&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting integration runtime &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;255&lt;/span&gt;         Remove-AzDataFactoryV2IntegrationRuntime -Name &lt;span&gt;$_&lt;/span&gt;.Name -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -&lt;span&gt;Force 
&lt;/span&gt;&lt;span&gt;256&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;257&lt;/span&gt; 
&lt;span&gt;258&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$deleteDeployment&lt;/span&gt; &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;$true&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;259&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting ARM deployment ... under resource group: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;260&lt;/span&gt;         &lt;span&gt;$deployments&lt;/span&gt; = Get-AzResourceGroupDeployment -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;261&lt;/span&gt;         &lt;span&gt;$deploymentsToConsider&lt;/span&gt; = &lt;span&gt;$deployments&lt;/span&gt; | Where { &lt;span&gt;$_&lt;/span&gt;.DeploymentName &lt;span&gt;-like&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ArmTemplate_master*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;-or&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.DeploymentName &lt;span&gt;-like&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ArmTemplateForFactory*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; } | Sort-Object -Property Timestamp -&lt;span&gt;Descending
&lt;/span&gt;&lt;span&gt;262&lt;/span&gt;         &lt;span&gt;$deploymentName&lt;/span&gt; = &lt;span&gt;$deploymentsToConsider&lt;/span&gt;[0&lt;span&gt;].DeploymentName
&lt;/span&gt;&lt;span&gt;263&lt;/span&gt; 
&lt;span&gt;264&lt;/span&gt;        Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deployment to be deleted: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$deploymentName&lt;/span&gt;
&lt;span&gt;265&lt;/span&gt;         &lt;span&gt;$deploymentOperations&lt;/span&gt; = Get-AzResourceGroupDeploymentOperation -DeploymentName &lt;span&gt;$deploymentName&lt;/span&gt; -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt;
&lt;span&gt;266&lt;/span&gt;         &lt;span&gt;$deploymentsToDelete&lt;/span&gt; = &lt;span&gt;$deploymentOperations&lt;/span&gt; | Where { &lt;span&gt;$_&lt;/span&gt;.properties.targetResource.id &lt;span&gt;-like&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;*Microsoft.Resources/deployments*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; }
&lt;/span&gt;&lt;span&gt;267&lt;/span&gt; 
&lt;span&gt;268&lt;/span&gt;         &lt;span&gt;$deploymentsToDelete&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;269&lt;/span&gt;             Write-host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting inner deployment: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.properties.targetResource.id
&lt;/span&gt;&lt;span&gt;270&lt;/span&gt;             Remove-AzResourceGroupDeployment -Id &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.properties.targetResource.id
&lt;/span&gt;&lt;span&gt;271&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;272&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Deleting deployment: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$deploymentName&lt;/span&gt;
&lt;span&gt;273&lt;/span&gt;         Remove-AzResourceGroupDeployment -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -Name &lt;span&gt;$deploymentName&lt;/span&gt;
&lt;span&gt;274&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;275&lt;/span&gt; 
&lt;span&gt;276&lt;/span&gt;     &lt;span&gt;#&lt;/span&gt;&lt;span&gt;Start active triggers - after cleanup efforts&lt;/span&gt;
&lt;span&gt;277&lt;/span&gt;     Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Starting active triggers&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;278&lt;/span&gt;     &lt;span&gt;$triggersToStart&lt;/span&gt; | &lt;span&gt;ForEach&lt;/span&gt;-&lt;span&gt;Object { 
&lt;/span&gt;&lt;span&gt;279&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;$_&lt;/span&gt;.TriggerType &lt;span&gt;-eq&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;BlobEventsTrigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;280&lt;/span&gt;             Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Subscribing&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;.Name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;to events&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;281&lt;/span&gt;             &lt;span&gt;$status&lt;/span&gt; = Add-AzDataFactoryV2TriggerSubscription -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;282&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;$status&lt;/span&gt;.Status &lt;span&gt;-ne&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Enabled&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;){
&lt;/span&gt;&lt;span&gt;283&lt;/span&gt;                 Start-Sleep -s 15
&lt;span&gt;284&lt;/span&gt;                 &lt;span&gt;$status&lt;/span&gt; = Get-AzDataFactoryV2TriggerSubscriptionStatus -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;285&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;286&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;287&lt;/span&gt;         Write-Host &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Starting trigger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;$_&lt;/span&gt;&lt;span&gt;.Name
&lt;/span&gt;&lt;span&gt;288&lt;/span&gt;         Start-AzDataFactoryV2Trigger -ResourceGroupName &lt;span&gt;$ResourceGroupName&lt;/span&gt; -DataFactoryName &lt;span&gt;$DataFactoryName&lt;/span&gt; -Name &lt;span&gt;$_&lt;/span&gt;.Name -&lt;span&gt;Force
&lt;/span&gt;&lt;span&gt;289&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;290&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;adf_ci_cd.sh&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;我们将当前powershell 脚本添加到代码中。文件命名为 “adf_ci_cd.sh”&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104164029621-1527239950.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;将，上面的脚本文件的内容贴进去，点击 “Commit”，并且提交保存到 “master” 分支中&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104164210341-970307450.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104164317271-1883308560.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;3，配置Azure DevOps Pipeline 环境&lt;/h3&gt;
&lt;p&gt;回到Azure DevOps 中，选择 “Pipelines=》Releases”，点击 “New pipeline”&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104155342298-1895115430.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;此时需要我们选择模板，我们先点击 “Empty job” 创建一个空的 job&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104155543301-6975680.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;修改补助名称为 “UAT”&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104155751730-2087360308.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来选择添加 “artifact”，先添加一个afd_master 发布产品源&lt;/p&gt;
&lt;p&gt;Source Type 选择：”Azure Repos Git“&lt;/p&gt;
&lt;p&gt;Project 选择：”CnBateBlogWeb_Proj“&lt;/p&gt;
&lt;p&gt;Source(reposity)选择：”CnBateBlogWeb_Proj“&lt;/p&gt;
&lt;p&gt;Default branch：”adf_publish“&lt;/p&gt;
&lt;p&gt;Source alias（源别名）：”_CnBateBlogWeb_Proj_Publish“&lt;/p&gt;
&lt;p&gt;点击 ”Add“ 进行添加操作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104171235010-1022760997.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;再添加 “artifact”，先添加一个ADF的 ”master“ 分布作为产品发布源，大家注意里面的参数&lt;/p&gt;
&lt;p&gt;Default branch：”master“&lt;/p&gt;
&lt;p&gt;Source alias：”_CnBateBlogWeb_Proj_Master“&lt;/p&gt;
&lt;p&gt;点击 ”OK“ 进行添加操作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104171721758-227986524.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;最后，让我们给 ”UAT“ stages 添加 task，点击图中圈起来的部分&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104172059962-268982930.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;点击 ”+“，进行添加 ”Azure PowerShell“ Task，同时PowerShell 脚本去停止目前所有正在运行的 Triggers &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104172540523-1785512642.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;对于当前停止Trigger的 Task，有些需要我们留意的属性配置&lt;/p&gt;
&lt;p&gt;1，Display name 可以改为 ”Stop Triggers“（表面当前Task具体干了什么事）&lt;/p&gt;
&lt;p&gt;2，选择 ”UAT“ 环境所在的Azure 订阅&lt;/p&gt;
&lt;p&gt;3，Script Path（脚本路径）&lt;/p&gt;
&lt;p&gt;4，Script Arguments（脚本参数）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104174250255-1520133954.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;上面提到的脚本文件说明一下，就是我们刚刚在 ”master“ 分支提交的 adf_ci_cd.sh 这个文件，我们可以进行选择&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104174625432-1425507444.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;部署前，需要停止所有Trigger，关于脚本参数（停止Trigger）&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
-armTemplate &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$(System.DefaultWorkingDirectory)/&amp;lt;your-arm-template-location&amp;gt;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -ResourceGroupName &amp;lt;your-resource-group-name&amp;gt; -DataFactoryName &amp;lt;your-data-factory-name&amp;gt; -predeployment &lt;span&gt;$true&lt;/span&gt; -deleteDeployment &lt;span&gt;$false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt; 部署完成后，需要启动所有Trigger，关于脚本参数（启动Trigger）&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
-armTemplate &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$(System.DefaultWorkingDirectory)/&amp;lt;your-arm-template-location&amp;gt;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -ResourceGroupName &amp;lt;your-resource-group-name&amp;gt; -DataFactoryName &amp;lt;your-data-factory-name&amp;gt; -predeployment &lt;span&gt;$false&lt;/span&gt; -deleteDeployment &lt;span&gt;$true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;大家将上面对应的的脚本参数贴上自己的实际的UAT环境所在的资源组，资源名称，以及模板所在路径&lt;/p&gt;
&lt;p&gt;以下是我当前的模板参数；大家可以作为参考：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
-armTemplate &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$(System.DefaultWorkingDirectory)/_CnBateBlogWeb_Proj_Publish/ADF-CnBateBlogWeb-Dev/ARMTemplateForFactory.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -ResourceGroupName &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Web_Test_DF_RG_UAT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -DataFactoryName &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ADF-CnBateBlogWeb-AUT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -predeployment &lt;span&gt;$true&lt;/span&gt; -deleteDeployment &lt;span&gt;$false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;接下来就是添加 ARM 模板部署了，搜索 ”ARM template deployment“，找到 ARM 模板部署，点击 ”Add“ 进行添加&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104175948026-48682954.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;修改当前Task属性&lt;/p&gt;
&lt;p&gt;Display name：”ARM Template deployment：ADF Deploy“&lt;/p&gt;
&lt;p&gt;Subscription 选择：当前需要UAT环境所在的订阅&lt;/p&gt;
&lt;p&gt;Resource group 选择：”Web_Test_DF_RG_UAT“（也就是当前UAT环境 ADF所在的资源组）&lt;/p&gt;
&lt;p&gt;Loaction 选择：”East Asia“&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104180744530-678764616.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Template 以及 Template parameters 分别选择 ”_CnBateBlog_Proj_Publish“ 下的 ”ARMTemplateForFactory.json“,&quot;ARMTemplateParametersForFactory.json&quot;&lt;/p&gt;
&lt;p&gt;而 Override template parameters（替换模板参数）则指我们需要把模板参数文件中的一些参数替换掉，如需要部署的ADF的名称，数据源、目标源的blob Storage 的链接字符串&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104182518257-243818015.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;如下，我演示的覆盖模板参数实例（&lt;span&gt;大家需要将UAT环境的ADF 名称换成自己创建命名的，以及两个链接字符参数名称需要在模板参数文件中找到自己对应的名称，链接字符串复制粘贴自己UAT环境的两个Blob Storage的链接字符串&lt;/span&gt;）：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
-factoryName &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ADF-CnBateBlogWeb-AUT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -CnBateBlogFromBlobStorage_connectionString &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;DefaultEndpointsProtocol=https;AccountName=cnbateblogwebaccount1uat;AccountKey=XF7XkFsnEdIGZT8CCUJs7At1E/Ni9k/XJBtwWaKvwAuBnp3cCN6e2CYiV2uzsq2iI0vI2eZVHS8Kh9CvcuoNcg==;EndpointSuffix=core.windows.net&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -CnBateBlobToBlobStorage_connectionString &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;DefaultEndpointsProtocol=https;AccountName=cnbateblogwebaccount2uat;AccountKey=E5z+q7XL7+8xTlqHsyaIGr0Eje/0DhT9+/E+oro4D57tsSuEchmnjLiK8zftTtyvQKLQUvTGJEsAOFCBGdioHw==;EndpointSuffix=core.windows.net&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最近就是添加重启所有 Trigger 的 PowerShell 的 Task，具体参数如下图&lt;/p&gt;
&lt;p&gt;Script Path 选择 ：”_CnBateBlogWeb_Proj_Master“ 文件下的 “adf_ci_cd.sh” 文件&lt;/p&gt;
&lt;p&gt;Script Path （需要清理资源、重启所有Trigger的脚本参数）：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
-armTemplate &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$(System.DefaultWorkingDirectory)/&amp;lt;your-arm-template-location&amp;gt;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -ResourceGroupName &amp;lt;your-resource-group-name&amp;gt; -DataFactoryName &amp;lt;your-data-factory-name&amp;gt; -predeployment &lt;span&gt;$false&lt;/span&gt; -deleteDeployment &lt;span&gt;$true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;大家将上面对应的的脚本参数贴上自己的实际的UAT环境所在的资源组，资源名称，以及模板所在路径&lt;/p&gt;
&lt;p&gt;以下是我当前的模板参数；大家可以作为参考：&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
-armTemplate &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$(System.DefaultWorkingDirectory)/_CnBateBlogWeb_Proj_Publish/ADF-CnBateBlogWeb-Dev/ARMTemplateForFactory.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -ResourceGroupName &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Web_Test_DF_RG_UAT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -DataFactoryName &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ADF-CnBateBlogWeb-AUT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -predeployment &lt;span&gt;$true&lt;/span&gt; -deleteDeployment &lt;span&gt;$true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104183253766-1223138820.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;修改当前pipeline 的名称，点击 &quot;Save” 进行保存。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104183922770-1774217627.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来，就是设置 pipeline 的触发条件&lt;/p&gt;
&lt;p&gt;开启持续部署触发，每次在所选存储库中发生Git推送时触发pipeline，接下来添加分支筛选条件&lt;/p&gt;
&lt;p&gt;Type：Include，Branch：“adf_master”，也就是说每当 “adf_publish” 发生git 推送的时候，触发此 pipeline&lt;/p&gt;
&lt;p&gt;设置完毕后，点击 “Save” 进行保存&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104211141580-1273004335.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;我们可以手动 “创建Release”，测试 pipeline 状态显示正常，成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104212643526-1478837356.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;回到Azure UAT 环境中，我们可以发现 UAT 环境的ADF的 pipeline dataset 等也已经部署配置成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104212911688-1636570408.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;4，测试ADF 自动化部署&lt;/h3&gt;
&lt;p&gt;我们回到ADF的 Dev 环境，我们尝试在ADF Dev 环境创建一个的新的 “Feature Branch” 尝试更改 pipeline 中复制数据的名称&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104213432599-1215701373.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;我们将上图中的Copy Data 的名称由 “Copy data1” 改为 “Copy data2”，并且进行保存，验证操作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104213605914-1695311602.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;验证没有问题后，我们就可以将当前 “allen/Feature_1” 分支上的更改合并到 “master” 分支上&lt;/p&gt;
&lt;p&gt;通过提交 “Create pull request”&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1996262/202011/1996262-20201104213819543-1841346385.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;接下来我就不再演示了，有什么的不懂的，大家可以去看上一篇文章。等待合并完成后，我们回到Dev 环境的ADF 中就可以在 “master” 分支进行发布了。当发布完成后，就会将最新更改推送到 &quot;adf_master&quot; 分支上的 ARM 模板以及参数等。这个时候就会触发之前设置好的Azure DevOps pipeline 了，就可以自动就这些更改自动部署到UA环境了。&lt;/p&gt;
&lt;h2&gt;三，结尾&lt;/h2&gt;
&lt;p&gt; 　　今天的内容着重介绍了一下Azure Data Factory 与Azure Pipeline 的集成和自动化部署，但是同样的也遗留了一个问题，就是在部署ARM 模板的时候，我们时直接将Blob Storage 的链接字符串直接粘贴到覆盖模板参数一栏中，如果ADF 中添加很多数据源的化，使用直接这种方式也是不合适的，这个问题怎么解决，下一节我们继续。*★,°*:.☆(￣▽￣)/$:*.°★* 。&lt;/p&gt;
&lt;p&gt;作者：&lt;a href=&quot;https://www.cnblogs.com/AllenMaster&quot; target=&quot;_blank&quot;&gt;Allen&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;版权：转载请在文章明显位置注明作者及出处。如发现错误，欢迎批评指正。&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 14:30:00 +0000</pubDate>
<dc:creator>Grant_Allen</dc:creator>
<og:description>一，引言 由于上一节文章内容过长，无法分享Azure Data Factory 的持续集成，持续发布。今天将着重介绍一下在使用 Azure DevOps Pipeline 发布，自动进行持续集成，并且</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/AllenMaster/p/13922858.html</dc:identifier>
</item>
<item>
<title>前端模块化简单总结 - 风吹De麦浪</title>
<link>http://www.cnblogs.com/CandyManPing/p/13923285.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/CandyManPing/p/13923285.html</guid>
<description>&lt;p&gt;&lt;span&gt;　　JavaScript初期就是为了实现简单的页面交互逻辑，如今CPU、浏览器性能得到了极大的提升，很多页面逻辑迁移到了客户端，前端代码日益膨胀，此时在js方面就会考虑怎么样来管理使用模块化规范去管理。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　无论是什么语言一旦发展到一定地步，其工程化能力和可维护性势必得到相应的发展。 模块化这件事，无论在哪个编程领域都是常见的事情，模块化存在的意义就是为了增加可复用性，以尽可能少的代码是实现个性化的需求。同为前端三剑客之一的 CSS 早在 2.1 的版本就提出了 &lt;span&gt;@import&lt;/span&gt; 来实现模块化，但是 JavaScript 直到 ES6 才出现官方的模块化方案： &lt;span&gt;ES Module (import、export)&lt;/span&gt;。尽管早期 JavaScript 语言规范上不支持模块化，但这并没有阻止 JavaScript 的发展，官方没有模块化标准开发者们就开始自己创建规范，自己实现规范。&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;　　&lt;span&gt;JavaScript 在早期的设计中就没有模块、包甚至类的概念，虽然 &lt;code&gt;ES6&lt;/code&gt; 中有了 &lt;code&gt;class&lt;/code&gt; 关键字，那也只是个语法糖。随意随着项目复杂度的增加，开发者必然需要模拟类的功能，来隔离、封装、组织复杂的 JavaScript 代码，而这种&lt;strong&gt;封装和隔离&lt;/strong&gt;，也被被我们称之为模块化。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　模块就是一个实现特定功能的文件 or 代码块。随着前端工程体系建设的愈发成熟，或许模块化的概念已经在前端圈子里已经耳熟能详了。但是对于很多开发者而言，ES6 中的 &lt;span&gt;&lt;strong&gt;&lt;code&gt;export&lt;/code&gt;、&lt;code&gt;import&lt;/code&gt;，&lt;code&gt;nodejs&lt;/code&gt;&lt;/strong&gt;&lt;/span&gt; 中的 &lt;span&gt;&lt;strong&gt;&lt;code&gt;require&lt;/code&gt;、&lt;code&gt;exports.xx&lt;/code&gt;、&lt;code&gt;module.exports&lt;/code&gt;&lt;/strong&gt;&lt;/span&gt;到底有什么区别？为什么又有 &lt;code&gt;CommonJS&lt;/code&gt;，又有&lt;span&gt; &lt;span&gt;&lt;strong&gt;&lt;code&gt;AMD&lt;/code&gt;，&lt;code&gt;CMD&lt;/code&gt;，&lt;code&gt;UMD&lt;/code&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;？区别是什么？甚至我们在编写 ts 文件的时候，还需要在配置文件里面说明什么模块方式，在项目中使用的时候，我们又是否真正知道，你用的到底是基于哪一种规范的模块化？&lt;/span&gt;&lt;/p&gt;

&lt;ul&gt;&lt;li&gt;&lt;span&gt;&lt;span&gt;可维护性&lt;/span&gt;，每一个模块都是独立的。良好的设计能够极大的降低项目的耦合度。以便于其能独立于别的功能被整改。至少维护一个独立的功能模块，比维护一坨凌乱的代码要容易很多。&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;&lt;span&gt;减少全局变量污染&lt;/span&gt;，前端开发的初期，我们都在为全局变量而头疼，因为经常会触发一些难以排查且非技术性的 bug。当一些无关的代码一不小心重名了全局变量，我们就会遇到烦人的“命名空间污染”的问题。在模块化规范没有确定之前，其实我们都在极力的避免于此。（后文会介绍）&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;&lt;span&gt;可复用性&lt;/span&gt;，前端模块功能的封装，极大的提高了代码的可复用性。这点应该就不用详细说明了。想想从 &lt;code&gt;npm&lt;/code&gt; 上找 &lt;code&gt;package&lt;/code&gt; 的时候，是在干啥？&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;&lt;span&gt;方便管理依赖关系&lt;/span&gt;，在模块化规范没有完全确定的时候，模块之间相互依赖的关系非常的模糊，完全取决于 js 文件引入的顺序。粗俗！丝毫没有技术含量，不仅依赖模糊且难以维护。&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;

&lt;h2&gt;&lt;span&gt;1、函数封装&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;回到我们刚刚说的模块的定义，模块就是一个实现特定功能的文件 or 代码块（这是我自己给定义的）。专业定义是，在程序设计中，为完成某一功能所需的一段程序或子程序；或指能由编译程序、装配程序等处理的独立程序单位；或指大型软件系统的一部分。而函数的一个功能就是实现特定逻辑的一组语句打包。并且 JavaScript 的作用域就是基于函数的，所以最原始之处，函数必然是作为模块化的第一步。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;将不同的功能封装成不同的函数&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;编码: 将不同的功能封装成不同的全局函数&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;问题: 污染全局命名空间, 容易引起命名冲突或数据不安全，而且模块成员之间看不出直接关系，模块之间的关系模糊&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;函数1&lt;/span&gt;
&lt;span&gt;function&lt;/span&gt;&lt;span&gt; fn1(){
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;statement&lt;/span&gt;
&lt;span&gt;}
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;函数2&lt;/span&gt;
&lt;span&gt;function&lt;/span&gt;&lt;span&gt; fn2(){
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;statement&lt;/span&gt;
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;&lt;span&gt;2、namespace模式 &lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;也可以理解为对象封装，其实就是把相关函数、变量在外面加了一层&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;let module1 =&lt;span&gt; {
  let tag : &lt;/span&gt;1&lt;span&gt;,
  let name:&lt;/span&gt;'module1'&lt;span&gt;,
  
  fun1(){
    console.log(&lt;/span&gt;'this is fun1'&lt;span&gt;)
  },
  
  fun2(){
    console.log(&lt;/span&gt;'this is fun2'&lt;span&gt;)
  }
}&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;我们在使用的时候呢，就直接&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot;&gt;
&lt;pre&gt;
&lt;span&gt;module1.fun2();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;优点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;一定程度上优化了命名冲突，降低了全局变量污染的风险&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;有一定的模块封装和隔离，并且还可以进一步语义化一些&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;缺点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;并没有实质上改变命名冲突的问题&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;外部可以随意修改内部成员变量，还是容易产生意外风险&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt; 3、IIFE模式：立即执行匿名函数(闭包)&lt;/h2&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span readability=&quot;1&quot;&gt;let global = 'Hello, I am a global variable :)'&lt;span&gt;;

(&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; () {
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 在函数的作用域中下面的变量是私有的&lt;/span&gt;
&lt;span&gt;
  const myGrades &lt;/span&gt;= [93, 95, 88, 0, 55, 91&lt;span&gt;];

  let average &lt;/span&gt;= &lt;span&gt;function&lt;/span&gt;&lt;span&gt;() {
    let total &lt;/span&gt;= myGrades.reduce(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(accumulator, item) {
      &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; accumulator + item}, 0&lt;span&gt;);

    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; 'Your average grade is ' + total / myGrades.length + '.'&lt;span&gt;;
  }

  let failing &lt;/span&gt;= &lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
    let failingGrades &lt;/span&gt;= myGrades.filter(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(item) {
      &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; item &amp;lt; 70&lt;span&gt;;});

    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; 'You failed ' + failingGrades.length + ' times.'&lt;span readability=&quot;2&quot;&gt;;
  }

  console.log(failing());
  console.log(global);&lt;p&gt;// 需要暴露的api&lt;br/&gt;return {&lt;br/&gt;// something&lt;br/&gt;}
}());

&lt;/p&gt;&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 控制台显示：'You failed 2 times.'&lt;/span&gt;&lt;span&gt;
//&lt;/span&gt;&lt;span&gt; 控制台显示：'Hello, I am a global variable :)'&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;这种方法的好处在于，你可以在函数内部使用局部变量，而不会意外覆盖同名全局变量，但仍然能够访问到全局变量&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;类似如上的 &lt;/span&gt;&lt;code&gt;IIFE&lt;/code&gt;&lt;span&gt; ，还有非常多的演进写法&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;比如引入依赖：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;把内部需要的变量传进去。&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; module.js文件&lt;/span&gt;
(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(window, $) {
  let data &lt;/span&gt;= 'www.baidu.com'
  &lt;span&gt;//&lt;/span&gt;&lt;span&gt;操作数据的函数&lt;/span&gt;
  &lt;span&gt;function&lt;/span&gt;&lt;span&gt; foo() {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;用于暴露有函数&lt;/span&gt;
&lt;span&gt;    console.log(`foo() ${data}`)
    $(&lt;/span&gt;'body').css('background', 'red'&lt;span&gt;)
  }
  &lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; bar() {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;用于暴露有函数&lt;/span&gt;
&lt;span&gt;    console.log(`bar() ${data}`)
    otherFun() &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;内部调用&lt;/span&gt;
&lt;span&gt;  }
  &lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; otherFun() {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;内部私有的函数&lt;/span&gt;
    console.log('otherFun()'&lt;span&gt;)
  }
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;暴露行为&lt;/span&gt;
  window.myModule =&lt;span&gt; { foo, bar }
})(window, jQuery)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;使用&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; index.html文件&lt;/span&gt;
  &amp;lt;!-- 引入的js必须有一定顺序 --&amp;gt;
  &amp;lt;script type=&quot;text/javascript&quot; src=&quot;jquery-1.10.1.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;script type=&quot;text/javascript&quot; src=&quot;module.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;script type=&quot;text/javascript&quot;&amp;gt;&lt;span&gt;
    myModule.foo()
  &lt;/span&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;优点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;实现了基本的封装&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;只暴露对外的方法操作，利用闭包实现了类似 &lt;code&gt;public&lt;/code&gt; 和 &lt;code&gt;private&lt;/code&gt; 的概念&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;h4&gt;&lt;span&gt;缺点&lt;/span&gt;&lt;/h4&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;模块依赖关系模糊&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;模块与模块之间不好管理&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt;　　上述的所有解决方案，虽然每种方法都可行，但是始终没有哪一种可以很好的解决变量污染、各个模块之间依赖关系清晰、方便管理、与第三方代码方便集成。随着大前端时代的到来，在2009年提出了 CommonJS 规范，并且nodeJs 直接用该规范来管理模块化，随着时间的迁移，现在 JavaScript 模块规范也就有了：CommonJS、AMD、CMD、UMD、ES6 模块化。&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span&gt;4、CommonJS&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;　　CommonJS 是 JavaScript 的一个模块化规范（&lt;a href=&quot;http://www.commonjs.org/&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;http://www.commonjs.org/&lt;/span&gt;&lt;/a&gt;），主要用于服务端Nodejs 中。根据规范，每一个文件既是一个模块，其内部定义的变量是属于这个模块的，不会污染全局变量。&lt;span&gt;每个模块内部，module变量代表当前模块，这个变量是一个对象，它的exports属性（即module.exports）是对外的接口。加载某个模块，其实是加载该模块的module.exports属性。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;CommonJS 的核心思想是通过 require 方法来同步加载所依赖的模块，然后通过 exports 或者 module.exprots 来导出对外暴露的接口。 &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;基本用法&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;暴露模块：&lt;span&gt;&lt;strong&gt;module.exports&lt;/strong&gt;&lt;/span&gt; = value 或 exports.xxx = value&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;引入模块：&lt;span&gt;&lt;strong&gt;require(xxx)，&lt;/strong&gt;&lt;/span&gt;如果是第三方模块，xxx为模块名；如果是自定义模块，xxx为模块文件路径&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; example.js&lt;/span&gt;
let x = 5&lt;span&gt;;
&lt;/span&gt;let addX = &lt;span&gt;function&lt;/span&gt;&lt;span&gt; (value) {
  &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; value +&lt;span&gt; x;
};
module.exports.x &lt;/span&gt;=&lt;span&gt; x;
module.exports.addX &lt;/span&gt;= addX;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;let&lt;/span&gt; example = require('./example.js');
console.log(example.x); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;
console.log(example.addX(1)); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;require命令用于加载模块文件。&lt;span&gt;&lt;strong&gt;require命令的基本功能是，读入并执行一个JavaScript文件，然后返回该模块的exports对象，如果没有发现指定模块，会报错，如果存在多个&lt;/strong&gt; &lt;strong&gt;exports&lt;/strong&gt;  &lt;strong&gt;只有第一个exports 有效&lt;/strong&gt;。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p data-lake-id=&quot;1d3232e90f433f521b4f0e7911f47029&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;require 是加载这个文件然后执行，在返回、输出 exports 这个对象&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;console.log('开始加载了') &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 会输出 开始加载了&lt;/span&gt;

&lt;span&gt;function&lt;/span&gt;&lt;span&gt; run (val) {
  console.log(val)
}&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;特点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;以文件为一个单元模块，代码运行在模块作用域内，不会污染全局变量&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;同步加载模块，在服务端直接读取本地磁盘没问题，不太适用于浏览器&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;模块可以加载多次，但是只会在第一次加载时运行，然后在加载，就是读取的缓存文件。需清理缓存后才可再次读取文件内容&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;模块加载的顺序，按照其在代码中出现的顺序&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;导出的是值的拷贝，这一点和 ES6 有着很大的不同（后面会介绍到）&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;补充知识点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;Node 中，一个文件是一个模块-&amp;gt;module&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;a href=&quot;https://github.com/nodejs/node/blob/master/lib/internal/modules/cjs/loader.js#L149&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;&lt;span&gt;源码&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;span&gt;定义如下：&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;function&lt;/span&gt; Module(id = ''&lt;span&gt;, parent) {
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.path =&lt;span&gt; path.dirname(id);
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.exports =&lt;span&gt; {};
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.parent =&lt;span&gt; parent;
  updateChildren(parent, &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.filename = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.loaded = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
  &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.children =&lt;span&gt; [];
}&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;实例化一个模块&lt;/span&gt;
&lt;span&gt;var&lt;/span&gt; module = &lt;span&gt;new&lt;/span&gt; Module(filename, parent);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;CommonJS 的一个模块，就是一个脚本文件。require命令第一次加载该脚本，就会执行整个脚本，然后在内存生成一个对象。&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;{
  id: &lt;/span&gt;'...'&lt;span&gt;,
  exports: { ... },
  loaded: &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;,
  ...
}&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;　　上面代码就是 Node 内部加载模块后生成的一个对象。该对象的id属性是模块名，exports属性是模块输出的各个接口，loaded属性是一个布尔值，表示该模块的脚本是否执行完毕。其他还有很多属性。以后需要用到这个模块的时候，就会到exports属性上面取值。即使再次执行require命令，也不会再次执行该模块，而是到缓存之中取值。也就是说，CommonJS 模块无论加载多少次，都只会在第一次加载时运行一次，以后再加载，就返回第一次运行的结果，除非手动清除系统缓存。&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span&gt;关于AMD、CMD&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;　&lt;span&gt;　CommonJS &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;在 Node.js 环境下取得了很不错的成功，很多人想把commonJs 规范推向浏览器端，但是浏览器不能像服务器那样直接读取磁盘上的内容所以又有了后面的AMD、CMD规范。&lt;/span&gt;&lt;span&gt;ES6 在语言标准的层面上，实现了模块功能，而且实现得相当简单，完全可以取代现有的 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案，因为我自己也是在近几年才做前端， AMD、CMD 并没有太多使用，所以AMD、CMD 这里只是做简单的介绍。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;


&lt;h2&gt;5、AMD&lt;/h2&gt;

&lt;p&gt;&lt;span&gt;AMD 全称为 &lt;span&gt;Asynchromous Module Definition&lt;/span&gt;（异步模块定义）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;AMD 是 &lt;a href=&quot;https://requirejs.org/&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;RequireJS&lt;/span&gt;&lt;/a&gt; 在推广过程中对模块定义的规范化产出，它是一个在浏览器端模块化开发的规范。 AMD 模式可以用于浏览器环境并且允许&lt;strong&gt;异步&lt;/strong&gt;加载模块，同时又能保证正确的顺序，也可以按需动态加载模块。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;特点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;异步加载模块，不会造成因网络问题而出现的假死&lt;/li&gt;
&lt;li&gt;显式地列出其依赖关系，并以函数(定义此模块的那个函数)参数的形式将这些依赖进行注入&lt;/li&gt;
&lt;li&gt;在模块开始时，加载所有所需依赖&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;定义模块&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div readability=&quot;7&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;define(id?: String, dependencies?: String[], callback: Function|Object);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;id,一个可选参数，类似给模块取个名字，但是却是模块的唯一标识。如果没有提供则取脚本的文件名&lt;/li&gt;
&lt;li&gt;dependence，依赖的模块数组&lt;/li&gt;
&lt;li&gt;callback，工厂方法，模块初始化的一些操作。如果是函数，只被执行一次。如果是对象，则为模块的输出值&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;使用模块&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div readability=&quot;6.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;require([moduleName],callback);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;使用&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div readability=&quot;9.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;article.js文件&lt;/span&gt;&lt;span&gt;
//&lt;/span&gt;&lt;span&gt; 定义有依赖的模块&lt;/span&gt;
define(['user'], &lt;span&gt;function&lt;/span&gt;&lt;span&gt;(user) {
  let name &lt;/span&gt;= 'THE LAST TIME'
  &lt;span&gt;function&lt;/span&gt;&lt;span&gt; consoleMsg() {
    console.log(`${name} by ${user.getAuthor()}`);
  }
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 暴露模块&lt;/span&gt;
  &lt;span&gt;return&lt;/span&gt;&lt;span&gt; { consoleMsg }
})&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;// 调用 article 模块种的 consoleMsg&lt;/span&gt;&lt;br/&gt;&lt;span&gt;require(['article'], &lt;span&gt;function&lt;/span&gt;&lt;span&gt;(alerter) {
    article.consoleMsg()
  })&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;span&gt;关于 require.js 的使用，仔细看文档，其实还是有很多知识点的。但是鉴于我们着实现在使用不多（我也不熟），所以这里也就参考网上优秀文章和自己实践，抛砖引玉。&lt;/span&gt;&lt;/p&gt;

&lt;h2&gt;&lt;span&gt;6、CMD&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;　　CMD 即&lt;span&gt;Common Module Definition&lt;/span&gt;通用模块定义，&lt;/span&gt;&lt;span&gt;CMD 是 &lt;span&gt;SeaJS&lt;/span&gt; 在推广过程中对模块定义的规范化产出，是&lt;/span&gt;阿里的玉伯提出来，它和 AMD 其实非常的相似，文件即为模块。&lt;/span&gt;&lt;span&gt;CMD最主要的区别是实现了按需加载，推崇依赖就近的原则，模块延迟执行，而 AMD 所依赖模块式提前执行（requireJS 2.0 后也改为了延迟执行）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;所以AMD和CMD最大的区别是对依赖模块的执行时机处理不同，注意不是加载的时机或者方式不同。&lt;/span&gt;&lt;span&gt;CMD 规范尽量保持简单，并与 CommonJS 规范保持了很大的兼容性。通过 CMD 规范书写的模块，可以很容易在 Node.js 中运行。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;在 CMD 规范中，一个模块就是一个文件。格式如下：&lt;/span&gt;&lt;/p&gt;
&lt;div readability=&quot;30&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot;&gt;
&lt;pre&gt;
&lt;span&gt;define(factory);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;define&lt;/strong&gt;&lt;/span&gt; 是一个全局函数，用来定义模块，参数factory可以是对象、字符串、函数&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;factory&lt;/strong&gt;&lt;/span&gt; 为对象、字符串时，表示模块的接口就是该对象、字符串。比如可以如下定义一个 JSON 数据模块：&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;define({ &quot;foo&quot;: &quot;bar&quot; });&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;也可以通过字符串定义模板模块：&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;define('I am a template. My name is {{name}}.');&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;factory&lt;/strong&gt;&lt;/span&gt; 为函数时，表示是模块的构造方法。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;执行该构造方法，可以得到模块向外提供的接口。factory 方法在执行时，默认会传入三个参数：require、exports 和 module：&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;define(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(require, exports, module) {
  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 模块代码&lt;/span&gt;
});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;使用sea.js&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;* sea.js *&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 定义模块 math.js&lt;/span&gt;
define(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(require, exports, module) {
    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; $ = require('jquery.js'&lt;span&gt;);
    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; add = &lt;span&gt;function&lt;/span&gt;&lt;span&gt;(a,b){
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; a+&lt;span&gt;b;
    }
    exports.add &lt;/span&gt;=&lt;span&gt; add;
});
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 加载模块&lt;/span&gt;
seajs.use(['math.js'], &lt;span&gt;function&lt;/span&gt;&lt;span&gt;(math){
    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; sum = math.add(1+2&lt;span&gt;);
});&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;关于 sea.js 的使用，仔细看文档，其实还是有很多知识点的。但是鉴于我们着实现在使用不多（我也不熟），所以这里也就参考网上优秀文章和自己实践，抛砖引玉。&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2&gt;&lt;span&gt; 7、UMD&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;UMD 是 &lt;span&gt;AMD&lt;/span&gt; 和 &lt;span&gt;CommonJS&lt;/span&gt; 的综合产物。如上所说，AMD 的用武之地是浏览器，非阻塞式加载。CommonJS 主要用于服务端 Nodejs 中使用。所以人们就想到了一个通用的模式 UMD（universal module definition）。来解决跨平台的问题。&lt;/span&gt;&lt;br/&gt;&lt;span&gt;没错！就是 ifElse 的写法。&lt;/span&gt;&lt;br/&gt;&lt;span&gt;核心思想就是：先判断是否支持Node.js的模块（exports）是否存在，存在则使用Node.js模块模式。&lt;/span&gt;&lt;br/&gt;&lt;span&gt;在判断是否支持AMD（define是否存在），存在则使用AMD方式加载模块。&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;(&lt;span&gt;function&lt;/span&gt;&lt;span&gt; (root, factory) {
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (&lt;span&gt;typeof&lt;/span&gt; define === 'function' &amp;amp;&amp;amp;&lt;span&gt; define.amd) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;AMD&lt;/span&gt;
        define(['jquery'&lt;span&gt;], factory);
    } &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;typeof&lt;/span&gt; exports === 'object'&lt;span&gt;) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;Node, CommonJS之类的&lt;/span&gt;
        module.exports = factory(require('jquery'&lt;span&gt;));
    } &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;浏览器全局变量(root 即 window)&lt;/span&gt;
        root.returnExports =&lt;span&gt; factory(root.jQuery);
    }
}(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;, &lt;span&gt;function&lt;/span&gt;&lt;span&gt; ($) {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;方法&lt;/span&gt;
    &lt;span&gt;function&lt;/span&gt;&lt;span&gt; myFunc(){};
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;暴露公共方法&lt;/span&gt;
    &lt;span&gt;return&lt;/span&gt;&lt;span&gt; myFunc;
}));&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;h2 class=&quot;heading&quot; data-id=&quot;heading-24&quot;&gt;&lt;span&gt;8、ES Module&lt;/span&gt;&lt;/h2&gt;
&lt;div readability=&quot;23&quot;&gt;
&lt;p&gt;&lt;span&gt;　　在 ES Module 之前，社区制定了一些模块加载方案，最主要的有 CommonJS 和 AMD 两种。前者用于服务器，后者用于浏览器。ES Module 在语言标准的层面上，实现了模块功能，而且实现得相当简单，完全可以取代 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ES Module 的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　CommonJS 和 AMD 模块，其本质是在运行时生成一个&lt;strong&gt;对象&lt;/strong&gt;进行导出，称为“&lt;span&gt;运行时加载&lt;/span&gt;”，没法进行“编译优化”，而 ES Module 不是对象，而是通过 &lt;strong&gt;&lt;code&gt;export&lt;/code&gt;&lt;/strong&gt; 命令显式指定输出的代码，再通过 &lt;strong&gt;&lt;code&gt;import&lt;/code&gt;&lt;/strong&gt; 命令输入。这称为“&lt;span&gt;&lt;strong&gt;编译时加载&lt;/strong&gt;&lt;/span&gt;”或者&lt;span&gt;&lt;strong&gt;静态加载&lt;/strong&gt;&lt;/span&gt;，即 ES Module 可以在编译时就完成模块加载，效率要比 CommonJS 模块的加载方式高。当然，这也导致了没法引用 ES Module 模块本身，因为它不是对象。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;由于 ES Module 是编译时加载，使得静态分析成为可能。有了它，就能进一步拓宽 JavaScript 的语法，比如引入宏（macro）和类型检验（type system）这些只能靠静态分析实现的功能。&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;heading&quot; data-id=&quot;heading-26&quot;&gt;&lt;span&gt;&lt;strong&gt;特点&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;静态编译&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;输出的值引用，而非值拷贝&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;import&lt;/strong&gt;&lt;/span&gt; 只能写在顶层，因为是静态语法&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;div&gt;
&lt;p class=&quot;_mce_tagged_br&quot;&gt; &lt;/p&gt;
&lt;h2 class=&quot;_mce_tagged_br&quot;&gt;9、CommonJs、ESM 区别&lt;/h2&gt;
&lt;/div&gt;
&lt;table class=&quot;lake-table&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;CommonJs&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span&gt;ES6 Module&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;7.5&quot;&gt;&lt;tr readability=&quot;7&quot;&gt;&lt;td&gt;&lt;span&gt;运行时加载；CommonJs模块就是对象（&lt;span&gt;module.exports&lt;/span&gt;属性）），即在输入时是先加载整个模块、执行模块，生成一个对象，然后再从这个对象上面读取方法。&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span&gt;编译时加载；ES6 模块不是对象，而是通过 export 命令显式指定输出的代码，import时采用静态命令的形式。即在import时可以指定加载某个输出值，而不是加载整个模块。&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;8&quot;&gt;&lt;td&gt;&lt;span&gt;输出的是值的拷贝（一旦输出一个值，模块内部的变化就影响不到这个值。）&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span&gt;输出的是值的引用（JS 引擎对脚本静态分析的时候，遇到模块加载命令import，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。即原始值变了，import加载的值也会跟着变。因此，ES6 模块是动态引用，并且不会缓存值，模块里面的变量绑定其所在的模块。）&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p id=&quot;5fdfbade&quot; data-lake-id=&quot;3d2222bab90c3476e14ac1d33620fac6&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;strong&gt;差异&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul data-lake-id=&quot;d0cbb1114e9d653cff975735914e7f51&quot;&gt;&lt;li data-lake-id=&quot;57e607832e4abb53c01b440475050ea1&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;strong&gt;CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用&lt;/strong&gt;。&lt;/span&gt;&lt;/li&gt;
&lt;li data-lake-id=&quot;e868f448a481457a5189d5051edd09c7&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;strong&gt;CommonJS 模块是运行时加载，ES6 模块是编译时输出接口&lt;/strong&gt;。&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p id=&quot;YnMHd&quot; data-lake-id=&quot;7328b6a441924bc1c5575a16e9f0286b&quot; data-wording=&quot;true&quot;&gt;&lt;strong&gt;&lt;span&gt;加载 &amp;amp; 编译&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p data-lake-id=&quot;1408d9044ea38f51bb39c9e3e73e3d1b&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;因为 &lt;code&gt;CommonJS&lt;/code&gt; 加载的是一个对象（&lt;code&gt;module.exports&lt;/code&gt;），对象只有在有脚本运行的时候才能生成。而 ES6 模块不是一个对象，只是一个静态的定义。在代码解析阶段就会生成。&lt;/span&gt;&lt;/p&gt;
&lt;p data-lake-id=&quot;45dc07c4ccd5f94ee61b4579de7f1c08&quot;&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p data-lake-id=&quot;ad852777af883518d1ad7062dcdd04a4&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;ES6 模块是编译时输出接口，因此有如下2个特点：&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li data-lake-id=&quot;ad852777af883518d1ad7062dcdd04a4&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;import&lt;/span&gt;&lt;/strong&gt; 命令会被 JS 引擎静态分析，优先于模块内的其他内容执行&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li data-lake-id=&quot;ad852777af883518d1ad7062dcdd04a4&quot; data-wording=&quot;true&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;export&lt;/span&gt;&lt;/strong&gt; 命令会有变量声明提升的效果,所以import 和 export 命令在模块中的位置并不影响程序的输出。&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;异步加载模块，不会造成因网络问题而出现的假死&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;显式地列出其依赖关系，并以函数(定义此模块的那个函数)参数的形式将这些依赖进行注入&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;在模块开始时，加载所有所需依赖&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Wed, 04 Nov 2020 14:25:00 +0000</pubDate>
<dc:creator>风吹De麦浪</dc:creator>
<og:description>前言 JavaScript初期就是为了实现简单的页面交互逻辑，如今CPU、浏览器性能得到了极大的提升，很多页面逻辑迁移到了客户端，前端代码日益膨胀，此时在js方面就会考虑怎么样来管理使用模块化规范去管</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/CandyManPing/p/13923285.html</dc:identifier>
</item>
<item>
<title>K8s之实践Pod搭建LNMP - 梦里花落知多少sl</title>
<link>http://www.cnblogs.com/user-sunli/p/13928967.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/user-sunli/p/13928967.html</guid>
<description>

&lt;h2&gt;&lt;span&gt;1、同一pod下的nginx+php+mysql&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;nginx+php+mysql.yaml文件&lt;/span&gt;&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
---&lt;span&gt;
apiVersion: v1
kind: Secret
metadata:
  name: mysql&lt;/span&gt;-&lt;span&gt;pass
  namespace: default
type: Qpaque
data:
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Passwd123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  password: UGFzc3dkMTIz
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;tmp&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  database: dG1w
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;: MTIz
 
&lt;/span&gt;---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: nginx&lt;/span&gt;-php-&lt;span&gt;mysql
spec:
  selector:
    matchLabels:
      app: nginx&lt;/span&gt;-php-&lt;span&gt;mysql
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: nginx&lt;/span&gt;-php-&lt;span&gt;mysql
    spec:
      containers:
      &lt;/span&gt;-&lt;span&gt; name: php
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/&lt;span&gt;php
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;9000&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/var/www/html/
 
      -&lt;span&gt; name: nginx
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/alpine:nginx1.&lt;span&gt;18.0&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;80&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html
        &lt;/span&gt;- name: nginx-&lt;span&gt;conf
          mountPath: &lt;/span&gt;/etc/nginx/conf.d/
 
      - image: mysql:&lt;span&gt;5.7&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        name: mysql
        &lt;/span&gt;&lt;span&gt;env&lt;/span&gt;&lt;span&gt;:
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=password=&lt;span&gt;Passwd123
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: password
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_DATABASE
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=database=&lt;span&gt;tmp
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: database
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_USER
          value: sun
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=&lt;span&gt;passwd&lt;/span&gt;=&lt;span&gt;123&lt;/span&gt;&lt;span&gt;
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
          name: mysql
        volumeMounts:
        &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
          mountPath: &lt;/span&gt;/var/lib/&lt;span&gt;mysql
 
      volumes:
      &lt;/span&gt;- name: nginx-&lt;span&gt;data
        nfs:
         server: &lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;&lt;span&gt;  #nfs server服务器IP
         path: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
#kubectl create cm ngin&lt;/span&gt;-conf --from-&lt;span&gt;file&lt;/span&gt;=/conf/&lt;span&gt;default.conf
      &lt;/span&gt;- name: nginx-&lt;span&gt;conf
        configMap:
         name: ngin&lt;/span&gt;-&lt;span&gt;conf
         items:
         &lt;/span&gt;-&lt;span&gt; key: default.conf
           path: add.conf
      &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
        emptyDir: {}
 
&lt;/span&gt;---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: nginx&lt;/span&gt;-php-&lt;span&gt;mysql
spec:
  type: NodePort
  ports:
  &lt;/span&gt;-&lt;span&gt; name: nginx
    port: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    protocol: TCP
    targetPort: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    nodePort: &lt;/span&gt;&lt;span&gt;30010&lt;/span&gt;&lt;span&gt;
  selector:
    app: nginx&lt;/span&gt;-php-mysql
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;master安装nfs（注意work节点也要安装nfs并启动）&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
# &lt;span&gt;yum&lt;/span&gt; -y &lt;span&gt;install&lt;/span&gt; nfs-&lt;span&gt;utils
# systemctl start nfs
# &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www    192.168.10.0/24(rw,sync,no_root_squash)&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/&lt;span&gt;exports
# systemctl restart nfs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;test&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt; /www/&lt;span&gt;index.html
# &lt;/span&gt;&lt;span&gt;cat&lt;/span&gt; /www/&lt;span&gt;index.php
&lt;/span&gt;&amp;lt;?&lt;span&gt;php
  phpinfo();
&lt;/span&gt;?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;p&gt;配置文件default.conf&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;# cat /conf/default.conf&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt; 
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;server {
    listen       &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;;
    server_name  localhost;
    location &lt;/span&gt;/&lt;span&gt; {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
        index  index.html index.htm;
    }
    error_page   &lt;/span&gt;&lt;span&gt;500&lt;/span&gt; &lt;span&gt;502&lt;/span&gt; &lt;span&gt;503&lt;/span&gt; &lt;span&gt;504&lt;/span&gt;  /&lt;span&gt;50x.html;
    location &lt;/span&gt;= /&lt;span&gt;50x.html {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
    }
    location &lt;/span&gt;~&lt;span&gt; \.php$ {
        fastcgi_pass   &lt;/span&gt;&lt;span&gt;127.0&lt;/span&gt;.&lt;span&gt;0.1&lt;/span&gt;:&lt;span&gt;9000&lt;/span&gt;&lt;span&gt;;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  &lt;/span&gt;/var/www/html/&lt;span&gt;$fastcgi_script_name;
        include        fastcgi_params;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl create cm ngin-conf --from-&lt;span&gt;file&lt;/span&gt;=/conf/default.conf
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p&gt;注意：采用configMap的挂载方式，如果修改了文件，需要删除configMap并重新创建&lt;/p&gt;
&lt;div readability=&quot;11&quot;&gt;
&lt;p&gt;&lt;span&gt;创建：kubectl create cm ngin-conf --from-file=/conf/default.conf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;查看：kubectl describe cm&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;删除：&lt;/span&gt;kubectl delete configmaps ngin-conf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;cm=&lt;/span&gt;configmaps(简称)&lt;/p&gt;
&lt;/div&gt;

&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl apply -f nginx+php+mysql.yaml
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;p&gt;测试：&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
[root@master-test www]# curl &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;:&lt;span&gt;30010&lt;/span&gt;&lt;span&gt;
test
[root@master&lt;/span&gt;-test www]# curl &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;:&lt;span&gt;30010&lt;/span&gt;/index.php -&lt;span&gt;I
HTTP&lt;/span&gt;/&lt;span&gt;1.1&lt;/span&gt; &lt;span&gt;200&lt;/span&gt;&lt;span&gt; OK
Server: nginx&lt;/span&gt;/&lt;span&gt;1.18&lt;/span&gt;.&lt;span&gt;0&lt;/span&gt;&lt;span&gt;
Date: Wed, &lt;/span&gt;&lt;span&gt;04&lt;/span&gt; Nov &lt;span&gt;2020&lt;/span&gt; &lt;span&gt;02&lt;/span&gt;:&lt;span&gt;50&lt;/span&gt;:&lt;span&gt;30&lt;/span&gt;&lt;span&gt; GMT
Content&lt;/span&gt;-Type: text/&lt;span&gt;html
Connection: keep&lt;/span&gt;-&lt;span&gt;alive
X&lt;/span&gt;-Powered-By: PHP/&lt;span&gt;5.4&lt;/span&gt;.&lt;span&gt;16&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;

&lt;p&gt;修改vim /www/index.php&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;
&amp;lt;?&lt;span&gt;php
  mysqli_connect(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;127.0.0.1&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;sun&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;) or die(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;failed&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
  &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;success&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p&gt;再次访问，success成功啦&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
[root@master-test www]# curl &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;:&lt;span&gt;30010&lt;/span&gt;/index.php -&lt;span&gt;i
HTTP&lt;/span&gt;/&lt;span&gt;1.1&lt;/span&gt; &lt;span&gt;200&lt;/span&gt;&lt;span&gt; OK
Server: nginx&lt;/span&gt;/&lt;span&gt;1.18&lt;/span&gt;.&lt;span&gt;0&lt;/span&gt;&lt;span&gt;
Date: Wed, &lt;/span&gt;&lt;span&gt;04&lt;/span&gt; Nov &lt;span&gt;2020&lt;/span&gt; &lt;span&gt;02&lt;/span&gt;:&lt;span&gt;54&lt;/span&gt;:&lt;span&gt;15&lt;/span&gt;&lt;span&gt; GMT
Content&lt;/span&gt;-Type: text/&lt;span&gt;html
Transfer&lt;/span&gt;-&lt;span&gt;Encoding: chunked
Connection: keep&lt;/span&gt;-&lt;span&gt;alive
X&lt;/span&gt;-Powered-By: PHP/&lt;span&gt;5.4&lt;/span&gt;.&lt;span&gt;16&lt;/span&gt;
 
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;&lt;span&gt;
success[root@master&lt;/span&gt;-test www]#
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;


&lt;h2&gt;&lt;span&gt;&lt;strong&gt;2、nginx+php同一个Pod、mysql另一个Pod&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;

&lt;p&gt;nginx+php.yaml文件&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: nginx&lt;/span&gt;-&lt;span&gt;php
spec:
  selector:
    matchLabels:
      app: nginx&lt;/span&gt;-&lt;span&gt;php
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: nginx&lt;/span&gt;-&lt;span&gt;php
    spec:
      containers:
      &lt;/span&gt;-&lt;span&gt; name: php
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/&lt;span&gt;php
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;9000&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/var/www/html/
 
      -&lt;span&gt; name: nginx
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/alpine:nginx1.&lt;span&gt;18.0&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;80&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html
        &lt;/span&gt;- name: nginx-&lt;span&gt;conf
          mountPath: &lt;/span&gt;/etc/nginx/conf.d/&lt;span&gt;
 
      volumes:
      &lt;/span&gt;- name: nginx-&lt;span&gt;data
        nfs:
         server: &lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;&lt;span&gt;  #nfs server服务器IP
         path: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
      - name: nginx-&lt;span&gt;conf
        configMap:
         name: ngin&lt;/span&gt;-&lt;span&gt;conf
         items:
         &lt;/span&gt;-&lt;span&gt; key: default.conf
           path: add.conf
 
&lt;/span&gt;---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: nginx&lt;/span&gt;-&lt;span&gt;php
spec:
  type: NodePort
  ports:
  &lt;/span&gt;-&lt;span&gt; name: nginx
    port: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    protocol: TCP
    targetPort: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    nodePort: &lt;/span&gt;&lt;span&gt;30010&lt;/span&gt;&lt;span&gt;
  selector:
    app: nginx&lt;/span&gt;-php
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;p&gt;配置文件default.conf(和1一样，不用修改)&lt;/p&gt;
&lt;div&gt;
&lt;p&gt;# cat /conf/default.conf&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt; 
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;server {
    listen       &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;;
    server_name  localhost;
    location &lt;/span&gt;/&lt;span&gt; {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
        index  index.html index.htm;
    }
    error_page   &lt;/span&gt;&lt;span&gt;500&lt;/span&gt; &lt;span&gt;502&lt;/span&gt; &lt;span&gt;503&lt;/span&gt; &lt;span&gt;504&lt;/span&gt;  /&lt;span&gt;50x.html;
    location &lt;/span&gt;= /&lt;span&gt;50x.html {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
    }
    location &lt;/span&gt;~&lt;span&gt; \.php$ {
        fastcgi_pass   &lt;/span&gt;&lt;span&gt;127.0&lt;/span&gt;.&lt;span&gt;0.1&lt;/span&gt;:&lt;span&gt;9000&lt;/span&gt;&lt;span&gt;;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  &lt;/span&gt;/var/www/html/&lt;span&gt;$fastcgi_script_name;
        include        fastcgi_params;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;master安装nfs（注意work节点也要安装nfs并启动）&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
# &lt;span&gt;yum&lt;/span&gt; -y &lt;span&gt;install&lt;/span&gt; nfs-&lt;span&gt;utils
# systemctl start nfs
# &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www    192.168.10.0/24(rw,sync,no_root_squash)&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/&lt;span&gt;exports
# systemctl restart nfs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div&gt;
&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;test&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt; /www/&lt;span&gt;index.html
# &lt;/span&gt;&lt;span&gt;cat&lt;/span&gt; /www/index.php
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div class=&quot;cnblogs_code&quot;&gt;
&lt;pre&gt;
&amp;lt;?&lt;span&gt;php
  phpinfo();
&lt;/span&gt;?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl apply -f nginx+php.yaml
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;p&gt;mysql.yaml&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
---&lt;span&gt;
apiVersion: v1
kind: Secret
metadata:
  name: mysql&lt;/span&gt;-&lt;span&gt;pass
  namespace: default
type: Qpaque
data:
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Passwd123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  password: UGFzc3dkMTIz
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;tmp&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  database: dG1w
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;: MTIz
 
&lt;/span&gt;---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: mysql
spec:
  selector:
    matchLabels:
      app: mysql
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      &lt;/span&gt;- image: mysql:&lt;span&gt;5.7&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        name: mysql
        &lt;/span&gt;&lt;span&gt;env&lt;/span&gt;&lt;span&gt;:
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=password=&lt;span&gt;Passwd123
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: password
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_DATABASE
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=database=&lt;span&gt;tmp
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: database
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_USER
          value: sun
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=&lt;span&gt;passwd&lt;/span&gt;=&lt;span&gt;123&lt;/span&gt;&lt;span&gt;
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
          name: mysql
        volumeMounts:
        &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
          mountPath: &lt;/span&gt;/var/lib/&lt;span&gt;mysql
      volumes:
      &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
        emptyDir: {}
&lt;/span&gt;---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: mysql
  labels:
    app: mysql
spec:
  ports:
  &lt;/span&gt;-&lt;span&gt; name: mysql
    port: &lt;/span&gt;&lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
    targetPort: &lt;/span&gt;&lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
  selector:
    app: mysql&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl apply -f mysql.yaml
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;

&lt;p&gt;测试：&lt;/p&gt;
&lt;p&gt;修改vim /www/index.php&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;
&amp;lt;?&lt;span&gt;php
  mysqli_connect(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;10.106.159.184&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;sun&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;) or die(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;failed&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
  &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;success&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p&gt;再次访问，success成功啦&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
[root@master-test ~]# curl &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;:&lt;span&gt;30010&lt;/span&gt;/index.php -&lt;span&gt;i
HTTP&lt;/span&gt;/&lt;span&gt;1.1&lt;/span&gt; &lt;span&gt;200&lt;/span&gt;&lt;span&gt; OK
Server: nginx&lt;/span&gt;/&lt;span&gt;1.18&lt;/span&gt;.&lt;span&gt;0&lt;/span&gt;&lt;span&gt;
Date: Wed, &lt;/span&gt;&lt;span&gt;04&lt;/span&gt; Nov &lt;span&gt;2020&lt;/span&gt; &lt;span&gt;03&lt;/span&gt;:&lt;span&gt;40&lt;/span&gt;:&lt;span&gt;58&lt;/span&gt;&lt;span&gt; GMT
Content&lt;/span&gt;-Type: text/&lt;span&gt;html
Transfer&lt;/span&gt;-&lt;span&gt;Encoding: chunked
Connection: keep&lt;/span&gt;-&lt;span&gt;alive
X&lt;/span&gt;-Powered-By: PHP/&lt;span&gt;5.4&lt;/span&gt;.&lt;span&gt;16&lt;/span&gt;
 
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;&lt;span&gt;
success[root@master&lt;/span&gt;-test ~]#
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;

&lt;h2&gt;3、php一个Pod、nginx一个Pod、mysql一个Pod&lt;/h2&gt;
&lt;p&gt;&lt;span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;php.yaml&lt;/span&gt;&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: php
spec:
  selector:
    matchLabels:
      app: php
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: php
    spec:
      containers:
      &lt;/span&gt;-&lt;span&gt; name: php
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/&lt;span&gt;php
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;9000&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/var/www/html/&lt;span&gt;
 
      volumes:
      &lt;/span&gt;- name: nginx-&lt;span&gt;data
        nfs:
         server: &lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;&lt;span&gt;  #nfs server服务器IP
         path: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
 
---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: php
spec:
  ports:
  &lt;/span&gt;-&lt;span&gt; name: php
    port: &lt;/span&gt;&lt;span&gt;9000&lt;/span&gt;&lt;span&gt;
    protocol: TCP
    targetPort: &lt;/span&gt;&lt;span&gt;9000&lt;/span&gt;&lt;span&gt;
  selector:
    app: php
# kubectl aapply &lt;/span&gt;-&lt;span&gt;f php.yml
 
nginx.yaml
&lt;/span&gt;---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: nginx
spec:
  selector:
    matchLabels:
      app: nginx
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      &lt;/span&gt;-&lt;span&gt; name: nginx
        image: registry.cn&lt;/span&gt;-shenzhen.aliyuncs.com/user-&lt;span&gt;sum&lt;/span&gt;/alpine:nginx1.&lt;span&gt;18.0&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;80&lt;/span&gt;&lt;span&gt;
        volumeMounts:
        &lt;/span&gt;- name: nginx-&lt;span&gt;data
          mountPath: &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html
        &lt;/span&gt;- name: nginx-&lt;span&gt;conf
          mountPath: &lt;/span&gt;/etc/nginx/conf.d/&lt;span&gt;
      volumes:
      &lt;/span&gt;- name: nginx-&lt;span&gt;data
        nfs:
         server: &lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;&lt;span&gt;  #nfs server服务器IP
         path: &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/www&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
      - name: nginx-&lt;span&gt;conf
        configMap:
         name: ngin&lt;/span&gt;-&lt;span&gt;conf
         items:
         &lt;/span&gt;-&lt;span&gt; key: default.conf
           path: add.conf
&lt;/span&gt;---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: nginx
spec:
  type: NodePort
  ports:
  &lt;/span&gt;-&lt;span&gt; name: nginx
    port: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    protocol: TCP
    targetPort: &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;
    nodePort: &lt;/span&gt;&lt;span&gt;30010&lt;/span&gt;&lt;span&gt;
  selector:
    app: nginx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;配置文件nginx.conf&lt;/p&gt;
&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;

&lt;div&gt;
&lt;p&gt;# cat /conf/default.conf&lt;/p&gt;

&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;server {
    listen       &lt;/span&gt;&lt;span&gt;80&lt;/span&gt;&lt;span&gt;;
    server_name  localhost;
    location &lt;/span&gt;/&lt;span&gt; {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
        index  index.php index.html index.htm;
    }
    error_page   &lt;/span&gt;&lt;span&gt;500&lt;/span&gt; &lt;span&gt;502&lt;/span&gt; &lt;span&gt;503&lt;/span&gt; &lt;span&gt;504&lt;/span&gt;  /&lt;span&gt;50x.html;
    location &lt;/span&gt;= /&lt;span&gt;50x.html {
        root   &lt;/span&gt;/usr/share/nginx/&lt;span&gt;html;
    }
    location &lt;/span&gt;~&lt;span&gt; \.php$ {
        fastcgi_pass   &lt;/span&gt;&lt;span&gt;10.108&lt;/span&gt;.&lt;span&gt;129.142&lt;/span&gt;:&lt;span&gt;9000&lt;/span&gt;&lt;span&gt;;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  &lt;/span&gt;/var/www/html/&lt;span&gt;$fastcgi_script_name;
        include        fastcgi_params;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div readability=&quot;9&quot;&gt;
&lt;p&gt;删除：kubectl delete configmaps ngin-conf&lt;/p&gt;
&lt;p&gt;重新创建：kubectl create cm ngin-conf --from-file=/conf/default.conf&lt;/p&gt;
&lt;/div&gt;

&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl apply -f nginx.yaml
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;p&gt;mysql.yaml&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
 ---&lt;span&gt;
apiVersion: v1
kind: Secret
metadata:
  name: mysql&lt;/span&gt;-&lt;span&gt;pass
  namespace: default
type: Qpaque
data:
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Passwd123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  password: UGFzc3dkMTIz
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;tmp&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  database: dG1w
#&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; -n &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; |&lt;span&gt;base64
  &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;: MTIz
 
&lt;/span&gt;---&lt;span&gt;
apiVersion: apps&lt;/span&gt;/&lt;span&gt;v1
kind: Deployment
metadata:
  name: mysql
spec:
  selector:
    matchLabels:
      app: mysql
  replicas: &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      &lt;/span&gt;- image: mysql:&lt;span&gt;5.7&lt;/span&gt;&lt;span&gt;
        imagePullPolicy: IfNotPresent
        name: mysql
        &lt;/span&gt;&lt;span&gt;env&lt;/span&gt;&lt;span&gt;:
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=password=&lt;span&gt;Passwd123
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: password
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_DATABASE
          valueFrom:
            secretKeyRef:
            #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=database=&lt;span&gt;tmp
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: database
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_USER
          value: sun
        &lt;/span&gt;-&lt;span&gt; name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              #kubectl create secret generic mysql&lt;/span&gt;-pass --from-literal=&lt;span&gt;passwd&lt;/span&gt;=&lt;span&gt;123&lt;/span&gt;&lt;span&gt;
              name: mysql&lt;/span&gt;-&lt;span&gt;pass
              key: &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt;
        ports:
        &lt;/span&gt;- containerPort: &lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
          name: mysql
        volumeMounts:
        &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
          mountPath: &lt;/span&gt;/var/lib/&lt;span&gt;mysql
      volumes:
      &lt;/span&gt;- name: mysql-persistent-&lt;span&gt;storage
        emptyDir: {}
&lt;/span&gt;---&lt;span&gt;
apiVersion: v1
kind: Service
metadata:
  name: mysql
  labels:
    app: mysql
spec:
  ports:
  &lt;/span&gt;-&lt;span&gt; name: mysql
    port: &lt;/span&gt;&lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
    targetPort: &lt;/span&gt;&lt;span&gt;3306&lt;/span&gt;&lt;span&gt;
  selector:
    app: mysql&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div readability=&quot;6&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
# kubectl apply -f mysql.yaml
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;

&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt; &lt;/div&gt;

&lt;p&gt;测试：&lt;/p&gt;
&lt;p&gt;修改vim /www/index.php&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;
&amp;lt;?&lt;span&gt;php
  mysqli_connect(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;10.109.228.202&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;sun&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,&lt;span&gt;'&lt;/span&gt;&lt;span&gt;123&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;) or die(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;failed&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
  &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;success&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
#  phpinfo();
&lt;/span&gt;?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p&gt;再次访问，success成功啦&lt;/p&gt;
&lt;div readability=&quot;7.5&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
[root@master-test ~]# curl &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;10.10&lt;/span&gt;:&lt;span&gt;30010&lt;/span&gt;/index.php -&lt;span&gt;i
HTTP&lt;/span&gt;/&lt;span&gt;1.1&lt;/span&gt; &lt;span&gt;200&lt;/span&gt;&lt;span&gt; OK
Server: nginx&lt;/span&gt;/&lt;span&gt;1.18&lt;/span&gt;.&lt;span&gt;0&lt;/span&gt;&lt;span&gt;
Date: Wed, &lt;/span&gt;&lt;span&gt;04&lt;/span&gt; Nov &lt;span&gt;2020&lt;/span&gt; &lt;span&gt;05&lt;/span&gt;:&lt;span&gt;24&lt;/span&gt;:&lt;span&gt;57&lt;/span&gt;&lt;span&gt; GMT
Content&lt;/span&gt;-Type: text/&lt;span&gt;html
Transfer&lt;/span&gt;-&lt;span&gt;Encoding: chunked
Connection: keep&lt;/span&gt;-&lt;span&gt;alive
X&lt;/span&gt;-Powered-By: PHP/&lt;span&gt;5.4&lt;/span&gt;.&lt;span&gt;16&lt;/span&gt;
 
&amp;lt;h1&amp;gt;Test php-mysql &amp;lt;/h1&amp;gt;&lt;span&gt;
success[root@master&lt;/span&gt;-test ~]#
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;div&gt;&lt;img/&gt;&lt;img src=&quot;data:image/png;base64,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&quot;/&gt;&lt;/div&gt;


</description>
<pubDate>Wed, 04 Nov 2020 14:01:00 +0000</pubDate>
<dc:creator>梦里花落知多少sl</dc:creator>
<og:description>K8s之实践Pod搭建LNMP 1、同一pod下的nginx+php+mysql nginx+php+mysql.yaml文件 apiVersion: v1 kind: Secret metadata</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/user-sunli/p/13928967.html</dc:identifier>
</item>
<item>
<title>【快速因数分解】Pollard's Rho 算法 - RioTian</title>
<link>http://www.cnblogs.com/RioTian/p/13928916.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/RioTian/p/13928916.html</guid>
<description>&lt;p&gt;&lt;strong&gt;Pollard-Rho&lt;/strong&gt; 是一个很神奇的算法，用于在 $O(n^{\frac{1}4}) $的期望时间复杂度内计算合数 n 的某个非平凡因子（除了1和它本身以外能整除它的数）。事书上给出的复杂度是 &lt;span class=&quot;math inline&quot;&gt;\(O(\sqrt{p})\)&lt;/span&gt; ， p 是 n 的某个最小因子，满足 p 与 n/p 互质。虽然是随机的，但 &lt;strong&gt;Pollard Rho&lt;/strong&gt; 算法在实际环境中运行的相当不错，不会被卡。&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;简单来说：&lt;strong&gt;Pollard-Rho算法&lt;/strong&gt;是 &lt;strong&gt;John Pollard&lt;/strong&gt;发明的一种能 &lt;u&gt;快速找到大整数的一个非1、非自身的因子&lt;/u&gt; 的算法。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;前缀知识&quot;&gt;前缀知识&lt;/h2&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/RioTian/p/13927813.html&quot;&gt;快速乘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/RioTian/p/13927952.html&quot;&gt;Miller-Rabin 素数检验算法&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;pollardrhopollardrho-算法：&quot;&gt;PollardRhoPollardRho 算法：&lt;/h2&gt;
&lt;h3 id=&quot;问题模型：&quot;&gt;问题模型：&lt;/h3&gt;
&lt;p&gt;给一个数 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; ，你需要快速求出它的一个非平凡因子。&lt;/p&gt;
&lt;p&gt;对于一个比较小的数（ &lt;span class=&quot;math inline&quot;&gt;\(n≤10^9\)&lt;/span&gt; ），我们直接暴力枚举质因子就行但太大了我们就必须考虑一下随机算法了。&lt;/p&gt;
&lt;p&gt;对于一个非常大的合数 &lt;span class=&quot;math inline&quot;&gt;\(n≤10^{18}\)&lt;/span&gt; （如果可能是质数，我们可以用&lt;strong&gt;Miller Rabin&lt;/strong&gt;判一下）我们要求 nn 的某一个非平凡因子，如果 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的质因子很多（就是约数很多）我们也可以暴力随机弄一弄，但如果是一些（像由两个差不多的而且很大的质数乘得的 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; ）它的非平凡因子就只有两个而且 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 本身还很大，此时如果我们随机的话复杂度 &lt;span class=&quot;math inline&quot;&gt;\(O(n)\)&lt;/span&gt; ，这个太难接受了，所以我们想办法优化一下。&lt;/p&gt;
&lt;h3 id=&quot;1我们求-gcd&quot;&gt;1.我们求 gcd&lt;/h3&gt;
&lt;p&gt;如果我们直接随机求 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的某一个约数复杂度很高，我们可以考虑求一下 gcdgcd 。因为我们可以保证一个合数它绝对存在一个质因子小于 &lt;span class=&quot;math inline&quot;&gt;\(√n\)&lt;/span&gt; ，所以在 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 就存在至少 &lt;span class=&quot;math inline&quot;&gt;\(√n\)&lt;/span&gt; 个数与 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 有大于一的公约数。于是我们随机的可能性就提高到了 &lt;span class=&quot;math inline&quot;&gt;\(O(\sqrt{n})\)&lt;/span&gt; 。&lt;/p&gt;
&lt;h3 id=&quot;2玄学随机法：&quot;&gt;2.玄学随机法： &lt;span class=&quot;math inline&quot;&gt;\(x^2+c \ \ _{x=rand(),c=rand()}\)&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;其实网上大多都叫这种方法为生日悖论（悖论是不符合经验但符合事实的结论），有兴趣的可以去看看。但博主也不懂觉得这个方法跟我们的 &lt;strong&gt;PollardRho&lt;/strong&gt; 的关联。在1中我们用gcd的方案，现在我们考虑有没有办法能够快速的找到这些与 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 有公约数的数（或者说找到一种随机生成方法，使随机生成这类我们需要的数的概率变大一点）。&lt;/p&gt;
&lt;p&gt;这个随机生成方法最终被 &lt;span class=&quot;math inline&quot;&gt;\(Pollard\)&lt;/span&gt; 研发出来了：就是标题那个式子！ 我们定义&lt;/p&gt;
&lt;p&gt;\[(y=x\ x=x×x+c \ g=gcd(y−x,p)) \]&lt;/p&gt;
&lt;p&gt;为一次操作，我们发现 &lt;span class=&quot;math inline&quot;&gt;\(g&amp;gt;1\)&lt;/span&gt; （就是找到我们需要的数）的几率出奇的高，根据国际上大佬的疯狂测试，在 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 中找到一对 &lt;span class=&quot;math inline&quot;&gt;\(y−x\)&lt;/span&gt; 使两者有公约数的概率接近 &lt;span class=&quot;math inline&quot;&gt;\(n^{\frac14}\)&lt;/span&gt; ，不得不说太玄学又太优秀了！&lt;/p&gt;
&lt;h3 id=&quot;判环&quot;&gt;判环&lt;/h3&gt;
&lt;p&gt;这种随机生成方法虽然优秀，但也有一些需要注意之处，比如有可能会生成一个环，并不断在这个环上生成以前生成过一次的数，所以我们必须写点东西来判环：&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;我们可以让 &lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt; 根据生成公式以比 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 快两倍的速度向后生成，这样当&lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt; 再次与 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 相等时，&lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 一定跑完了一个圈且没重复跑多少！&lt;/li&gt;
&lt;li&gt;我们可以用倍增的思想，让 &lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt; 记住 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 的位置，然后 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 再跑当前跑过次数的一倍的次数。这样不断让 &lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt; 记住 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 的位置，&lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 再往下跑，因为倍增所以当 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 跑到 &lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt; 时，已经跑完一个圈，并且也不会多跑太多（这个必须好好想一想，也可以看看代码如何实现的）（因为这种方法会比第一种用的更多，因为它在 &lt;span class=&quot;math inline&quot;&gt;\(PollardRho\)&lt;/span&gt; 二次优化时还可以起到第二个作用）（这里就给第二种的代码吧）&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code class=&quot;language-cpp&quot;&gt;inline ll rho(ll n) {
    ll x, y, c, g;
    rg i, j;
    x = y = rand();
    c = rand();    //初始化
    i = 0, j = 1;  //倍增初始化
    while (++i) {
        x = (ksc(x, x, n) + c) % n;  // x只跑一次
        if (x == y) break;           //跑完了一个环
        g = gcd(Abs(y - x), n);      //求gcd（注意绝对值）
        if (g &amp;gt; 1) return g;
        if (i == j) y = x, j &amp;lt;&amp;lt;= 1;  //倍增的实现
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;pollardrho-算法的二次优化：&quot;&gt;PollardRho 算法的二次优化：&lt;/h2&gt;
&lt;p&gt;我们发现其实 &lt;span class=&quot;math inline&quot;&gt;\(PollardRho\)&lt;/span&gt; 算法其实复杂度不止 &lt;span class=&quot;math inline&quot;&gt;\(O(n^{\frac14})\)&lt;/span&gt; ，它每一次操作都会求一次 &lt;span class=&quot;math inline&quot;&gt;\(gcd\)&lt;/span&gt; ，所以复杂度会变成 &lt;span class=&quot;math inline&quot;&gt;\(O(n^{\frac14}log)\)&lt;/span&gt; 我们发现这个 &lt;span class=&quot;math inline&quot;&gt;\(log\)&lt;/span&gt; 实在有些拖慢速度（虽然实际上也很快了）。于是一个很奇妙的优化诞生了！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;二次优化&lt;/strong&gt;：我们发现我们在每一次生成操作中，乘法之后所模的数就是我们的 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; ，而我们要求的就是 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的某一个约数！也就是说我们现在的模数并不是一个质数！而根据取模的性质：如果模数和被模的数都含有一个公约数，那么这次模运算的结果必然也会是这个公约数的倍数！！！所以如果我们将若干个 &lt;span class=&quot;math inline&quot;&gt;\((y−x)\)&lt;/span&gt; 乘到一起，因为中途模的是 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; ，所以如果我的若干个 &lt;span class=&quot;math inline&quot;&gt;\((y−x)\)&lt;/span&gt; 中有一个与 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 有公约数，最后的结果定然也会含有这个公约数！所以我们完全可以多算几次 &lt;span class=&quot;math inline&quot;&gt;\((y−x)\)&lt;/span&gt; 的乘积在来求 &lt;span class=&quot;math inline&quot;&gt;\(gcd\)&lt;/span&gt; （一般连续算127次再求一次 &lt;span class=&quot;math inline&quot;&gt;\(gcd\)&lt;/span&gt; （这个应该有大佬测试过了）），这样我们的复杂度就能降一个 &lt;span class=&quot;math inline&quot;&gt;\(log\)&lt;/span&gt; 级别，跑的飞快！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;对原算法的一些影响：&lt;/strong&gt;任何一个优化都是要考虑其对原算法的影响的。这个优化也会有一些影响：首先，因为我们会等大概127次后再去 &lt;span class=&quot;math inline&quot;&gt;\(gcd\)&lt;/span&gt; ，然而我们有可能在生成时碰上一个环，我们有可能还没生成127次就跳出这个环了，这样就无法得出答案；其次，我们的 &lt;span class=&quot;math inline&quot;&gt;\(PollardRho\)&lt;/span&gt; 算法实在太玄学优秀了，可能我们跑127次之后，所有 &lt;span class=&quot;math inline&quot;&gt;\((y−x)\)&lt;/span&gt; 的乘积就变成了 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的倍数（模 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 意义下得到 &lt;span class=&quot;math inline&quot;&gt;\(0\)&lt;/span&gt; ），所以我们不能完全就只呆板的等127次在取模。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;那怎么办呢？&lt;/strong&gt;（在上文就已经提到过了：倍增时我们的 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; 和 &lt;span class=&quot;math inline&quot;&gt;\(j\)&lt;/span&gt; 会在二次优化时起到另一种作用。）没错！就是倍增！我们可以用倍增，分别在生成（1次，2次，4次，8次，16次，32次......）之后进行 &lt;span class=&quot;math inline&quot;&gt;\(gcd\)&lt;/span&gt; ！这样就可以完全避免上述的两个影响，而且我们是倍增来gcd的这对我们的复杂度影响不大！！！！！然后我们看代码吧！&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-cpp&quot;&gt;inline ll rho(ll p) {  //求出p的非平凡因子
    ll x, y, z, c, g;
    rg i, j;                 //先摆出来（z用来存（y-x）的乘积）
    while (1) {              //保证一定求出一个因子来
        y = x = rand() % p;  //随机初始化
        z = 1;
        c = rand() % p;                  //初始化
        i = 0, j = 1;                    //倍增初始化
        while (++i) {                    //开始玄学生成
            x = (ksc(x, x, p) + c) % p;  //可能要用快速乘
            z = ksc(z, Abs(y - x), p);  //我们将每一次的（y-x）都累乘起来
            if (x == y || !z)
                break;  //如果跑完了环就再换一组试试（注意当z=0时，继续下去是没意义的）
            if (!(i % 127) ||
                i == j) {  //我们不仅在等127次之后gcd我们还会倍增的来gcd
                g = gcd(z, p);
                if (g &amp;gt; 1) return g;
                if (i == j)
                    y = x, j &amp;lt;&amp;lt;= 1;  //维护倍增正确性，并判环（一箭双雕）
            }
        }
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;然后是两道道例题，都有点难度的。&lt;/p&gt;
&lt;h2 id=&quot;code1：&quot;&gt;code1：&lt;/h2&gt;
&lt;pre&gt;
&lt;code class=&quot;language-cpp&quot;&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
using namespace std;

#define rg register int
typedef long long ll;
typedef unsigned long long ull;
typedef long double lb;

int n;
ll ans, m;

inline ll qr() {  //快读
    char ch;
    while ((ch = getchar()) &amp;lt; '0' || ch &amp;gt; '9')
        ;
    ll res = ch ^ 48;
    while ((ch = getchar()) &amp;gt;= '0' &amp;amp;&amp;amp; ch &amp;lt;= '9') res = res * 10 + (ch ^ 48);
    return res;
}

inline ll Abs(ll x) { return x &amp;lt; 0 ? -x : x; }  //取绝对值
inline ll gcd(ll x, ll y) {                     //非递归求gcd
    ll z;
    while (y) {
        z = x;
        x = y;
        y = z % y;
    }
    return x;
}

inline ll ksc(ull x, ull y, ll p) {  // O(1)快速乘（防爆long long）
    return (x * y - (ull)((lb)x / p * y) * p + p) % p;
}

inline ll ksm(ll x, ll y, ll p) {  //快速幂
    ll res = 1;
    while (y) {
        if (y &amp;amp; 1) res = ksc(res, x, p);
        x = ksc(x, x, p);
        y &amp;gt;&amp;gt;= 1;
    }
    return res;
}

inline bool mr(ll x, ll p) {              // mille rabin判质数
    if (ksm(x, p - 1, p) != 1) return 0;  //费马小定理
    ll y = p - 1, z;
    while (!(y &amp;amp; 1)) {  //二次探测
        y &amp;gt;&amp;gt;= 1;
        z = ksm(x, y, p);
        if (z != 1 &amp;amp;&amp;amp; z != p - 1) return 0;
        if (z == p - 1) return 1;
    }
    return 1;
}

inline bool prime(ll x) {
    if (x &amp;lt; 2) return 0;  // mille rabin判质数
    if (x == 2 || x == 3 || x == 5 || x == 7 || x == 43) return 1;
    return mr(2, x) &amp;amp;&amp;amp; mr(3, x) &amp;amp;&amp;amp; mr(5, x) &amp;amp;&amp;amp; mr(7, x) &amp;amp;&amp;amp; mr(43, x);
}

inline ll rho(ll p) {  //求出p的非平凡因子
    ll x, y, z, c, g;
    rg i, j;                 //先摆出来（z用来存（y-x）的乘积）
    while (1) {              //保证一定求出一个因子来
        y = x = rand() % p;  //随机初始化
        z = 1;
        c = rand() % p;                  //初始化
        i = 0, j = 1;                    //倍增初始化
        while (++i) {                    //开始玄学生成
            x = (ksc(x, x, p) + c) % p;  //可能要用快速乘
            z = ksc(z, Abs(y - x), p);  //我们将每一次的（y-x）都累乘起来
            if (x == y || !z)
                break;  //如果跑完了环就再换一组试试（注意当z=0时，继续下去是没意义的）
            if (!(i % 127) ||
                i == j) {  //我们不仅在等127次之后gcd我们还会倍增的来gcd
                g = gcd(z, p);
                if (g &amp;gt; 1) return g;
                if (i == j)
                    y = x, j &amp;lt;&amp;lt;= 1;  //维护倍增正确性，并判环（一箭双雕）
            }
        }
    }
}

inline void prho(ll p) {   //不断的找他的质因子
    if (p &amp;lt;= ans) return;  //最优性剪纸
    if (prime(p)) {
        ans = p;
        return;
    }
    ll pi = rho(p);  //我们一次必定能求的出一个因子，所以不用while
    while (p % pi == 0) p /= pi;  //记得要除尽
    return prho(pi), prho(p);     //分开继续分解质因数
}

int main() {
    // freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    // ios::sync_with_stdio(false), cin.tie(0), cout.tie(0);
    n = qr();
    srand(time(0));  //随机数生成必备！！！
    for (rg i = 1; i &amp;lt;= n; ++i) {
        ans = 1;
        prho((m = qr()));
        if (ans == m)
            puts(&quot;Prime&quot;);
        else
            printf(&quot;%lld\n&quot;, ans);
    }
    return 0;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;code2：&quot;&gt;code2：&lt;/h2&gt;
&lt;p&gt;题目链接：&lt;a href=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=3864&quot;&gt;杭电3864 D_num&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;根据这道题的答案性质，我们知道这个数在除了1以外还有三个约数，仔细想一下不难发现这类数最多只能有两个质因子，而这两个质因子分别就是它的两个约数，而第三个约数自然就是它自己了！（当然还有可能出现质数的三次方这类特殊的数，所以我们要特判一下）&lt;/p&gt;
&lt;p&gt;所以我们的思路就是，先求出 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的一个小于它的约数，然后我们可以用这个约数算出 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的另一个约数，然后我们判一下它是不是质数的三次方这类特殊的数（是就可以直接输出答案了），不是的话我们判断这两个约数是否分别是不同的质因子，是就能输出了，不是就说明这不是 &lt;span class=&quot;math inline&quot;&gt;\(D\_num\)&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-cpp&quot;&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
using namespace std;

#define ll long long
#define db double
#define rg register int
#define cut {puts(&quot;is not a D_num&quot;);continue;} //这个可以看一看

ll n;

inline ll qr() {
    char ch;
    while ((ch = getchar()) &amp;lt; '0' || ch &amp;gt; '9')
        ;
    ll res = ch ^ 48;
    while ((ch = getchar()) &amp;gt;= '0' &amp;amp;&amp;amp; ch &amp;lt;= '9') res = res * 10 + (ch ^ 48);
    return res;
}

inline ll Abs(ll x) { return x &amp;lt; 0 ? -x : x; }
inline ll gcd(ll x, ll y) {
    ll z;
    while (y) {
        z = x, x = y, y = z % y;
    }
    return x;
}

inline ll ksm(ll x, ll y, ll p) {
    ll res = 1;
    while (y) {
        if (y &amp;amp; 1) res = (__int128)res * x % p;
        x = (__int128)x * x % p;
        y &amp;gt;&amp;gt;= 1;
    }
    return res;
}

inline bool mr(ll x, ll p) {
    if (ksm(x, p - 1, p) != 1) return 0;
    ll y = p - 1, z;
    while (!(y &amp;amp; 1)) {
        y &amp;gt;&amp;gt;= 1;
        z = ksm(x, y, p);
        if (z != 1 &amp;amp;&amp;amp; z != p - 1) return 0;
        if (z == p - 1) return 1;
    }
    return 1;
}

inline bool prime(ll p) {
    if (p &amp;lt; 2) return 0;
    if (p == 2 || p == 3 || p == 5 || p == 7 || p == 43) return 1;
    return mr(2, p) &amp;amp;&amp;amp; mr(3, p) &amp;amp;&amp;amp; mr(5, p) &amp;amp;&amp;amp; mr(7, p) &amp;amp;&amp;amp; mr(43, p);
}

inline ll rho(ll p) {
    ll x, y, z, c, g;
    rg i, j;
    while (1) {
        y = x = rand() % p;
        z = 1, c = rand() % p;
        i = 0, j = 1;
        while (++i) {
            x = ((__int128)x * x + c) % p;
            z = (__int128)z * Abs(y - x) % p;
            if (x == y) break;
            if (i % 72 || i == j) {
                g = gcd(z, p);
                if (g &amp;gt; 1 &amp;amp;&amp;amp; g != p) return g;
                if (i == j) y = x, j &amp;lt;&amp;lt;= 1;
            }
        }
    }
}

int main() {
    // freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);
    // ios::sync_with_stdio(false), cin.tie(0), cout.tie(0);
    srand(time(0));
    ll p, q;
    while (scanf(&quot;%lld&quot;, &amp;amp;n) != EOF) {
        if (prime(n) || n &amp;lt;= 2) cut;
        p = rho(n);
        q = n / p;
        if ((__int128)p * p == q || (__int128)q * q == p)  //这题很卡细节的
        {
            printf(&quot;%lld %lld %lld\n&quot;, p, q, n);
            continue;
        }
        if (!prime(p) || !prime(q) || p == q) cut;  //注意两个相等也不行
        printf(&quot;%lld %lld %lld\n&quot;, min(p, q), max(p, q), n);
    }
    return 0;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;参考&quot;&gt;参考&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq_39972971/article/details/82346390&quot;&gt;https://blog.csdn.net/qq_39972971/article/details/82346390&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ld246.com/article/1569220928268&quot;&gt;https://ld246.com/article/1569220928268&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/267884783&quot;&gt;https://zhuanlan.zhihu.com/p/267884783&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 14:00:00 +0000</pubDate>
<dc:creator>RioTian</dc:creator>
<og:description>Pollard-Rho 是一个很神奇的算法，用于在 $O(n^{\frac{1}4}) $的期望时间复杂度内计算合数 n 的某个非平凡因子（除了1和它本身以外能整除它的数）。事书上给出的复杂度是 \(</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/RioTian/p/13928916.html</dc:identifier>
</item>
<item>
<title>Ubuntu18.04上安装NS-3 - variablex</title>
<link>http://www.cnblogs.com/variablex/p/13928867.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/variablex/p/13928867.html</guid>
<description>&lt;p&gt;我自己前后安装过好几次NS3了，网上其他相关的博客质量都不是很好，因此自己总结了一个ns3的安装过程。&lt;/p&gt;
&lt;p&gt;首先先去网址https://www.nsnam.org/releases/下载自己想要安装的NS-3的源代码。&lt;/p&gt;
&lt;p&gt;然后使用如下命令解压： &lt;code&gt;tar xjf ns-allinone-3.26.tar.bz2&lt;/code&gt;&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1546042/202011/1546042-20201104214053980-1478198818.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h4 id=&quot;第一步：处理gccg版本&quot;&gt;第一步：处理gcc/g++版本&lt;/h4&gt;
&lt;p&gt;ns3的安装需要使用gcc和g++编译，但是Ubuntu18.04系统默认的gcc/g++版本一般在7.X多，而ns3的编译不支持太高版本的gcc/g++，如果不将gcc/g++降级的话，在编译安装ns3时会失败。&lt;/p&gt;
&lt;p&gt;可以先通过命令&lt;code&gt;gcc -v&lt;/code&gt;查看一下系统中当前gcc/g++版本。&lt;/p&gt;
&lt;p&gt;如果确实较高则执行如下命令降低gcc和g++版本：&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;#安装低版本gcc和g++
sudo apt-get install gcc-5
sudo apt-get install g++-5
#进入/usr/bin目录
cd /usr/bin
#先备份
sudo mv gcc gcc.backup
sudo mv g++ g++.backup
#然后将我们下载的5.几版本的gcc和g++链接过去
sudo ln -sf gcc-5 gcc
sudo ln -sf g++-5 g++
#参看是否降级成功
gcc -v
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;code&gt;sudo apt-get install gcc-5&lt;/code&gt; 这条命令如果写出具体的gcc版本在我的系统上无法成功执行，但是模糊的写一个&lt;code&gt;gcc-5&lt;/code&gt;就可以成功执行，命令会自动下载一个gcc-5.5。g++同理。&lt;/p&gt;
&lt;h4 id=&quot;第二步：安装相关依赖&quot;&gt;第二步：安装相关依赖&lt;/h4&gt;
&lt;p&gt;在正式编译安装ns3之前，要先安装很多依赖软件，执行以下命令安装这些依赖即可：&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;sudo apt-get update
sudo apt-get install gcc g++ python
sudo apt-get install gcc g++ python python-dev
sudo apt-get install mercurial
sudo apt-get install bzr
sudo apt-get install gdb valgrind
sudo apt-get install gsl-bin libgsl-dev libgsl2 
sudo apt-get install flex bison libfl-dev
sudo apt-get install g++ gcc
sudo apt-get install tcpdump
sudo apt-get install sqlite sqlite3 libsqlite3-dev
sudo apt-get install libxml2 libxml2-dev
sudo apt-get install libgtk2.0-0 libgtk2.0-dev
sudo apt-get install vtun lxc
sudo apt-get install uncrustify
sudo apt-get install doxygen graphviz imagemagick
sudo apt-get install python-sphinx dia
sudo apt-get install python-pygraphviz python-kiwi python-pygoocanvas libgoocanvas-dev
sudo apt-get install libboost-signals-dev libboost-filesystem-dev 
sudo apt-get install openmpi*
sudo apt-get install texlive texlive-extra-utils texlive-latex-extra
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;可以把这些命令复制到一个脚本文件里一次性执行，免得一条一条执行太麻烦。&lt;/p&gt;
&lt;h4 id=&quot;第三步：正式安装&quot;&gt;第三步：正式安装&lt;/h4&gt;
&lt;p&gt;1、先进入到目录ns-allinone-3.26，然后执行如下命令：&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;cd ns-allinone-3.26
sudo ./build.py 
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;2、然后进入到目录ns-3.26,执行命令&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;cd ns-3.26
sudo ./waf clean
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;3、在目录ns-3.26下，执行如下命令完成编译安装&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;sudo ./waf -d debug --enable-example --enable-tests configure
sudo ./waf
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;如图下图所示，出现该情况表示编译成功&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1546042/202011/1546042-20201104214144903-418778732.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h4 id=&quot;第四步：测试&quot;&gt;第四步：测试&lt;/h4&gt;
&lt;p&gt;在ns-allinone-3.26/ns-3.26目录下，执行如下命令，测试是否安装成功：&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;sudo ./waf --run hello-simulator
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;输出Hello Simulator表示安装成功&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1546042/202011/1546042-20201104214157973-1153073670.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;到目前为止ns3可视化动画工具netanim还是不能用的状态，后续会更新netanim的安装过程。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;参考文献：&lt;/strong&gt;&lt;br/&gt;&lt;a href=&quot;https://www.jianshu.com/p/2c6c38ebe936&quot;&gt;https://www.jianshu.com/p/2c6c38ebe936&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://blog.csdn.net/wuzhiwuweisun/article/details/79483178&quot;&gt;https://blog.csdn.net/wuzhiwuweisun/article/details/79483178&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 04 Nov 2020 13:50:00 +0000</pubDate>
<dc:creator>variablex</dc:creator>
<og:description>我自己前后安装过好几次NS3了，网上其他相关的博客质量都不是很好，因此自己总结了一个ns3的安装过程。 首先先去网址https://www.nsnam.org/releases/下载自己想要安装的NS</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/variablex/p/13928867.html</dc:identifier>
</item>
</channel>
</rss>