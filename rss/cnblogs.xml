<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>æå®¢ Play ç© Terminalâ€”â€”GitHub çƒ­ç‚¹é€Ÿè§ˆ Vol.40 - å‰Šå¾®å¯’</title>
<link>http://www.cnblogs.com/xueweihan/p/13794102.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/xueweihan/p/13794102.html</guid>
<description>&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173550985-193880884.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä½œè€…ï¼šHelloGitHub-&lt;strong&gt;å°é±¼å¹²&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¤šå°‘äººä»¥ä¸ºæš—é»‘çš„ç»ˆç«¯ä¾¿æ˜¯ä¸€åç¨‹åºå‘˜çš„å·¥ä½œå°ï¼Œå…¶å®ä¸Šï¼Œç»ˆç«¯å¯ä»¥ä¸åªæ˜¯ä¸€ä¸ªè¾“å…¥ command çš„ç•Œé¢ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬å‘¨ç‰¹æ¨ kb ä¸€æ ·ï¼Œé¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨ï¼Œå°†å›¾åƒã€PDFã€è§†é¢‘åŠæ–‡ä»¶ç®¡ç†çš„äº•äº•æœ‰æ¡æ–¹ä¾¿ä½ å¿«é€Ÿæ‰¾å¯»ä¿¡æ¯çº¿ç´¢ã€‚ç»ˆç«¯ï¼Œä¹Ÿå¯æ˜¯ä¸€ä¸ªæ¸¸æˆæœºï¼Œç©ç€åƒæ˜¯ shapez.io çš„å›¾å½¢æ¸¸æˆï¼Œé ä½ çš„æƒ³è±¡åŠ›é€šå…³ç»ˆç«¯ï¼ŒæŠ‘æˆ–æ˜¯å›å½’æœ¬è´¨ï¼Œåªæ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„ç£ç›˜ç®¡ç†å·¥å…·ï¼Œä»…ä»…åªæ˜¯ç®€å•åœ°ç”¨å‘½ä»¤ä¾¿å¯æŸ¥çœ‹ç£ç›˜ä½¿ç”¨ç‡ï¼Œè¿˜æ˜¯é‚£ä¸ªåˆšçŸ¥é“ç»ˆç«¯æ—¶çš„è¾“å…¥å·¥å…·â€¦&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹æ‘˜å½•è‡ªå¾®åš&lt;a href=&quot;https://www.weibo.com/hellogithub/&quot;&gt;@HelloGitHub&lt;/a&gt; çš„ GitHub Trending åŠ Hacker News çƒ­å¸–ï¼ˆç®€ç§° HN çƒ­å¸–ï¼‰ï¼Œé€‰é¡¹æ ‡å‡†ï¼š&lt;code&gt;æ–°å‘å¸ƒ&lt;/code&gt; | &lt;code&gt;å®ç”¨&lt;/code&gt; | &lt;code&gt;æœ‰è¶£&lt;/code&gt;ï¼Œæ ¹æ®é¡¹ç›® release æ—¶é—´åˆ†ç±»ï¼Œå‘å¸ƒæ—¶é—´ä¸è¶…è¿‡ 7 day çš„é¡¹ç›®ä¼šæ ‡æ³¨ &lt;code&gt;New&lt;/code&gt;ï¼Œæ— è¯¥æ ‡å¿—åˆ™è¯´æ˜é¡¹ç›® release è¶…è¿‡ä¸€å‘¨ã€‚ç”±äºæœ¬æ–‡ç¯‡å¹…æœ‰é™ï¼Œè¿˜æœ‰éƒ¨åˆ†é¡¹ç›®æœªèƒ½åœ¨æœ¬æ–‡å±•ç¤ºï¼Œæœ›å‘¨çŸ¥ ğŸŒ&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æœ¬æ–‡ç›®å½•
&lt;ul&gt;&lt;li&gt;
&lt;ol&gt;&lt;li&gt;æœ¬å‘¨ç‰¹æ¨&lt;/li&gt;
&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;1.1 é¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨ï¼škb&lt;/li&gt;
&lt;li&gt;1.2 æå®¢é£ç£ç›˜å·¥å…·ï¼šDuf&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;2&quot;&gt;&lt;li&gt;GitHub Trending å‘¨æ¦œ&lt;/li&gt;
&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;2.1 å¯è§†åŒ–ç»„ä»¶é›†ï¼šVisx&lt;/li&gt;
&lt;li&gt;2.2 HTTP å·¥å…·åŒ…ï¼šHetty&lt;/li&gt;
&lt;li&gt;2.3 æ‰“åŒ…å‹ç¼©å·¥å…·ï¼šesbuild&lt;/li&gt;
&lt;li&gt;2.4 Steam å›¾å½¢æ¸¸æˆï¼šshapez.io&lt;/li&gt;
&lt;li&gt;2.5 é«˜å¯ç”¨ UI ç»„ä»¶ï¼šheadlessui&lt;/li&gt;
&lt;li&gt;2.6 NLP æ•°æ®é›†ï¼šDatasets&lt;/li&gt;
&lt;li&gt;2.7 è´Ÿè½½æµ‹è¯•å·¥å…·ï¼šali&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;3&quot;&gt;&lt;li&gt;æ¨èé˜…è¯»&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;1-æœ¬å‘¨ç‰¹æ¨&quot;&gt;1. æœ¬å‘¨ç‰¹æ¨&lt;/h2&gt;
&lt;h3 id=&quot;11-é¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨ï¼škb&quot;&gt;1.1 é¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨ï¼škb&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š300+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;kb æ˜¯ä¸€ä¸ªé¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ kb ä¸»è¦é’ˆå¯¹åŸºäºæ–‡æœ¬çš„ç¬”è®°æ”¶é›†ï¼Œä½†å®ƒä¹Ÿæ”¯æŒéæ–‡æœ¬æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼šå›¾åƒï¼ŒPDFï¼Œè§†é¢‘å’Œå…¶ä»–æ–‡ä»¶ã€‚ä¸»è¦ç‰¹æ€§&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å°†åŒ…å«ç¬”è®°ã€æŒ‡å—ã€è¿‡ç¨‹ã€å¤‡å¿˜å•çš„é¡¹ç›®æ”¶é›†åˆ°æœ‰ç»„ç»‡çš„çŸ¥è¯†åº“ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä¸åŒçš„å…ƒæ•°æ®è¿‡æ»¤çŸ¥è¯†åº“ï¼šæ ‡é¢˜ï¼Œç±»åˆ«ï¼Œæ ‡ç­¾å’Œå…¶ä»–ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ï¼ˆæˆ–ä¸ä½¿ç”¨ï¼‰è¯­æ³•é«˜äº®æ˜¾ç¤ºçŸ¥è¯†åº“ä¸­çš„é¡¹ç›®ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æµè§ˆçŸ¥è¯†åº“ä¸­çš„ grepï¼›&lt;/li&gt;
&lt;li&gt;å¯¼å…¥/å¯¼å‡ºæ•´ä¸ªçŸ¥è¯†åº“ï¼›&lt;/li&gt;
&lt;/ul&gt;&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/gnebbia/kb&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173712197-653592165.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;12-æå®¢é£ç£ç›˜å·¥å…·ï¼šduf&quot;&gt;1.2 æå®¢é£ç£ç›˜å·¥å…·ï¼šDuf&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š2400+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¼€æºä¸åˆ° 1 å‘¨å°±è·å¾— 2k+ star çš„ç£ç›˜å·¥å…· Dufï¼Œå¯åœ¨ç»ˆç«¯ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ç£ç›˜ä½¿ç”¨ç‡ã€‚Duf ç‰¹æ€§&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ğŸ¨ ç”¨æˆ·å‹å¥½çš„å½©è‰²è¾“å‡º&lt;/li&gt;
&lt;li&gt;ğŸ’» è°ƒæ•´ç»ˆç«¯å®½åº¦&lt;/li&gt;
&lt;li&gt;ğŸ¥³ æŒ‰éœ€æ’åˆ—ç»“æœ&lt;/li&gt;
&lt;li&gt;ğŸ„â€â™‚ï¸ ç¾¤ç»„ &amp;amp; è®¾å¤‡ç­›é€‰&lt;/li&gt;
&lt;li&gt;ğŸ“ æ”¯æŒ JSON è¾“å‡º&lt;/li&gt;
&lt;/ul&gt;&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/muesli/duf&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173723718-1016717878.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-github-trending-å‘¨æ¦œ&quot;&gt;2. GitHub Trending å‘¨æ¦œ&lt;/h2&gt;
&lt;h3 id=&quot;21-å¯è§†åŒ–ç»„ä»¶é›†ï¼švisx&quot;&gt;2.1 å¯è§†åŒ–ç»„ä»¶é›†ï¼šVisx&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š2000+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Visx æ˜¯å¯å¤ç”¨ã€ä½é˜¶çš„å¯è§†åŒ–ç»„ä»¶é›†åˆï¼Œå®ƒç»“åˆäº† d3 çš„å¼ºå¤§åŠŸèƒ½å’Œ React æ›´æ–° DOM çš„ä¼˜åŠ¿æ¥ç”Ÿæˆä½ çš„å¯è§†åŒ–ç»„ä»¶ã€‚è€Œä¸Šå‘¨æ—¶éš” Visx å‘å¸ƒä¸‰å¹´ä¹‹åï¼ŒAirbnb ä½¿ç”¨ TypeScript é‡å†™å¹¶å‘å¸ƒäº† Visx 1.0 æ­£å¼ç‰ˆã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/airbnb/visx&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173734304-604836774.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;22-http-å·¥å…·åŒ…ï¼šhetty&quot;&gt;2.2 HTTP å·¥å…·åŒ…ï¼šHetty&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š1750+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;New&lt;/code&gt; Hetty æ˜¯ä¸€ä¸ªç”¨äºå®‰å…¨ç ”ç©¶çš„ HTTP å·¥å…·åŒ…ã€‚å®ƒçš„ç›®æ ‡æ˜¯å¸Œæœ›æˆä¸ºåƒ Burp Suite Pro è¿™æ ·çš„å•†ä¸šè½¯ä»¶çš„å¼€æºæ›¿ä»£å“ï¼Œæ‹¥æœ‰ä¸º infosec å’Œ bug å¥–åŠ±ç¤¾åŒºé‡èº«å®šåˆ¶çš„å¼ºå¤§åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/dstotijn/hetty&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173747198-1783856656.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;23-æ‰“åŒ…å‹ç¼©å·¥å…·ï¼šesbuild&quot;&gt;2.3 æ‰“åŒ…å‹ç¼©å·¥å…·ï¼šesbuild&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š1050+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª JavaScript æ‰“åŒ…å’Œå‹ç¼©ç¨‹åºã€‚å®ƒç”¨äºæ‰“åŒ… JavaScript å’Œ TypeScript ä»£ç ä»¥åœ¨ç½‘ç»œä¸Šåˆ†å‘ã€‚ç›®å‰ esbuild æœ‰ä¸¤ä¸ªåŸºå‡†æµ‹è¯•ç”¨äºè¡¡é‡ esbuild çš„æ€§èƒ½ï¼Œesbuild æ¯”æµ‹è¯•çš„å…¶ä»– JavaScript æ‰“åŒ…ç¨‹åº å¿«è‡³å°‘ 100 å€ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/evanw/esbuild&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173759500-269475905.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;24-steam-å›¾å½¢æ¸¸æˆï¼šshapezio&quot;&gt;2.4 Steam å›¾å½¢æ¸¸æˆï¼šshapez.io&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š400+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;shapez.io çš„æºä»£ç ï¼Œshapez.io æ˜¯ä¸€æ¬¾ Steam æ¸¸æˆï¼Œåœ¨æ— è¾¹é™…çš„åœ°å›¾ä¸Šå»ºé€ å·¥å‚ã€è‡ªåŠ¨åŒ–ç”Ÿäº§ä¸ç»„åˆæ„ˆåŠ å¤æ‚çš„å›¾å½¢çš„æ¸¸æˆã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/tobspr/shapez.io&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173810358-999677078.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;25-é«˜å¯ç”¨-ui-ç»„ä»¶ï¼šheadlessui&quot;&gt;2.5 é«˜å¯ç”¨ UI ç»„ä»¶ï¼šheadlessui&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š650+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;headlessui æ˜¯ä¸€ç»„æ— é£æ ¼çš„ã€é«˜å¯ç”¨çš„ UI ç»„ä»¶ï¼Œå®ƒè¢«è®¾è®¡å¯å®Œç¾é›†æˆ CSSï¼Œheadlessui æœ‰å¯¹åº” Vueã€React åŒ…ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/tailwindlabs/headlessui&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173822859-1130189263.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;26-nlp-æ•°æ®é›†ï¼šdatasets&quot;&gt;2.6 NLP æ•°æ®é›†ï¼šDatasets&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š700+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Datasets æ˜¯ä¸€ä¸ªè½»é‡çº§å’Œå¯æ‰©å±•çš„åº“ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å…±äº«å’Œè®¿é—®è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰çš„æ•°æ®é›†å’Œè¯„ä¼°æŒ‡æ ‡ç­‰ï¼Œå¯ç”¨äº PyTorchã€TensorFlowã€NumPy å’Œ Pandasã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/huggingface/datasets&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173833622-1347572239.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;27-è´Ÿè½½æµ‹è¯•å·¥å…·ï¼šali&quot;&gt;2.7 è´Ÿè½½æµ‹è¯•å·¥å…·ï¼šali&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æœ¬å‘¨ star å¢é•¿æ•°ï¼š550+&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ali æ˜¯ä¸€ä¸ªå— vegeta å’Œ jplot å¯å‘çš„è´Ÿè½½æµ‹è¯•å·¥å…·ï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªåµŒå…¥å¼çš„åŸºäºç»ˆç«¯çš„ UIï¼Œå¯å®æ—¶ç»˜åˆ¶æŒ‡æ ‡ï¼Œå› æ­¤å¯ä»¥åœ¨ç»ˆç«¯ä¸Šæ‰§è¡Œå®æ—¶åˆ†æã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;GitHub åœ°å€â†’https://github.com/nakabonne/ali&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/759200/202010/759200-20201010173844133-638727683.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;3-æ¨èé˜…è¯»&quot;&gt;3. æ¨èé˜…è¯»&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šä¸º 2020 å¹´ç¬¬ 40 ä¸ªå·¥ä½œå‘¨çš„ GitHub Trending ğŸ‰å¦‚æœä½  Pick å…¶ä»–å¥½ç©ã€å®ç”¨çš„ GitHub é¡¹ç›®ï¼Œè®°å¾—æ¥ &lt;a href=&quot;https://github.com/521xueweihan/HelloGitHub&quot;&gt;HelloGitHub&lt;/a&gt; issue åŒºå’Œæˆ‘ä»¬åˆ†äº«ä¸‹å“Ÿ ğŸŒ&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;HelloGitHub äº¤æµç¾¤ç°å·²å…¨é¢å¼€æ”¾ï¼Œæ·»åŠ å¾®ä¿¡å·ï¼šHelloGitHub ä¸ºå¥½å‹å…¥ç¾¤ï¼Œå¯åŒå‰ç«¯ã€Javaã€Go ç­‰å„ç•Œå¤§ä½¬è°ˆç¬‘é£ç”Ÿã€åˆ‡ç£‹æŠ€æœ¯~&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Sun, 11 Oct 2020 00:45:00 +0000</pubDate>
<dc:creator>å‰Šå¾®å¯’</dc:creator>
<og:description>ä½œè€…ï¼šHelloGitHub-å°é±¼å¹² å¤šå°‘äººä»¥ä¸ºæš—é»‘çš„ç»ˆç«¯ä¾¿æ˜¯ä¸€åç¨‹åºå‘˜çš„å·¥ä½œå°ï¼Œå…¶å®ä¸Šï¼Œç»ˆç«¯å¯ä»¥ä¸åªæ˜¯ä¸€ä¸ªè¾“å…¥ command çš„ç•Œé¢ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬å‘¨ç‰¹æ¨ kb ä¸€æ ·ï¼Œé¢å‘æå®¢çš„æç®€å‘½ä»¤è¡ŒçŸ¥è¯†åº“ç®¡ç†å™¨</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/xueweihan/p/13794102.html</dc:identifier>
</item>
<item>
<title>[æºç é˜…è¯»] é˜¿é‡ŒSOFAæœåŠ¡æ³¨å†Œä¸­å¿ƒMetaServer(2)  - ç½—è¥¿çš„æ€è€ƒ</title>
<link>http://www.cnblogs.com/rossiXYZ/p/13789353.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/rossiXYZ/p/13789353.html</guid>
<description>&lt;p&gt;SOFARegistry æ˜¯èš‚èšé‡‘æœå¼€æºçš„ä¸€ä¸ªç”Ÿäº§çº§ã€é«˜æ—¶æ•ˆã€é«˜å¯ç”¨çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚æœ¬ç³»åˆ—å°†å¸¦é¢†å¤§å®¶ä¸€èµ·åˆ†æå…¶MetaServerçš„å®ç°æœºåˆ¶ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒç¯‡ï¼Œä»‹ç»MetaServeråŸºæœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚æ³¨å†Œï¼Œå­˜å‚¨ï¼Œé€šçŸ¥ï¼Œç»­çº¦ç­‰ã€‚&lt;/p&gt;&lt;div id=&quot;cnblogs_post_body&quot; readability=&quot;942.19282279073&quot;&gt;


&lt;h2 id=&quot;0x00-æ‘˜è¦&quot;&gt;0x00 æ‘˜è¦&lt;/h2&gt;
&lt;p&gt;SOFARegistry æ˜¯èš‚èšé‡‘æœå¼€æºçš„ä¸€ä¸ªç”Ÿäº§çº§ã€é«˜æ—¶æ•ˆã€é«˜å¯ç”¨çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚æœ¬ç³»åˆ—å°†å¸¦é¢†å¤§å®¶ä¸€èµ·åˆ†æå…¶MetaServerçš„å®ç°æœºåˆ¶ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒç¯‡ï¼Œä»‹ç»MetaServeråŸºæœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚æ³¨å†Œï¼Œå­˜å‚¨ï¼Œé€šçŸ¥ï¼Œç»­çº¦ç­‰ã€‚&lt;/p&gt;

&lt;h3 id=&quot;11-leaderå…¥å£&quot;&gt;1.1 Leaderå…¥å£&lt;/h3&gt;
&lt;p&gt;MetaServer çš„ä¸šåŠ¡å¯åŠ¨æ˜¯ä»setLeaderProcessListenerå¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;å‰é¢æåˆ°ï¼ŒMetaServer é›†ç¾¤å†…éƒ¨åŸºäº Raft åè®®é€‰ä¸¾å’Œå¤åˆ¶ï¼Œåªè¦ä¸è¶…è¿‡ 1â„2 èŠ‚ç‚¹å®•æœºï¼Œå°±å¯ä»¥å¯¹å¤–æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Raft åè®®ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é¢†å¯¼äººé€‰ä¸¾ï¼ˆLeader Electionï¼‰&lt;/li&gt;
&lt;li&gt;æ—¥å¿—å¤åˆ¶ï¼ˆLog Replicationï¼‰&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§ï¼ˆSafetyï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å¦‚æœä½¿ç”¨JRaft, éœ€è¦å®ç°å…¶çŠ¶æ€æœºï¼Œè€Œåœ¨MetaServerä¹‹ä¸­ï¼Œ jraft FSM çš„å…·ä½“å®ç°æ˜¯ ServiceStateMachineç±»ï¼ˆåæ–‡ä¸­ä¼šæœ‰å¤§é‡ Raft ç›¸å…³å†…å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ raft é€‰å‡ºäº†MetaServer leaderä¹‹åï¼ŒServiceStateMachineä¼šè°ƒç”¨ setLeaderProcessListenerï¼Œå…¶ä¸­åˆè°ƒç”¨åˆ°äº†registerCurrentNodeï¼Œè¿™æ ·å°±åœ¨MetaServerä¸­æ³¨å†Œäº†å½“å‰MetaèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;raftServer.setLeaderProcessListener(new LeaderProcessListener() {
    @Override
    public void startProcess() {
        executorManager.startScheduler();
        PeerId leader = new PeerId(NetUtil.getLocalAddress().getHostAddress(),
            metaServerConfig.getRaftServerPort());
        registerCurrentNode();  //
        raftServer.sendNotify(leader, &quot;leader&quot;);
    }
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶è¿è¡Œå †æ ˆå¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;register:51, MetaServerRegistry (com.alipay.sofa.registry.server.meta.registry)
registerCurrentNode:203, RaftExchanger (com.alipay.sofa.registry.server.meta.remoting)
access$200:56, RaftExchanger (com.alipay.sofa.registry.server.meta.remoting)
startProcess:105, RaftExchanger$1 (com.alipay.sofa.registry.server.meta.remoting)
lambda$onLeaderStart$2:234, ServiceStateMachine (com.alipay.sofa.registry.jraft.bootstrap)
run:-1, 318295790 (com.alipay.sofa.registry.jraft.bootstrap.ServiceStateMachine$$Lambda$191)
call:511, Executors$RunnableAdapter (java.util.concurrent)
run$$$capture:266, FutureTask (java.util.concurrent)
run:-1, FutureTask (java.util.concurrent)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;12-æ³¨å†Œ&quot;&gt;1.2 æ³¨å†Œ&lt;/h3&gt;
&lt;p&gt;æ³¨å†Œè¡Œä¸ºç”± Registry å®Œæˆã€‚æ³¨å†Œæ¥å£å®ç°ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public interface Registry&amp;lt;T extends Node&amp;gt; {
    NodeChangeResult setNodes(List&amp;lt;T&amp;gt; nodes);
    NodeChangeResult register(T node);
    void cancel(String connectId, NodeType nodeType);
    void evict();
    void renew(T node, int duration);
    void getOtherDataCenterNodeAndUpdate(NodeType nodeType);
    DataCenterNodes getDataCenterNodes(NodeType nodeType);
    NodeChangeResult getAllNodes(NodeType nodeType);
    void pushNodeListChange(NodeType nodeType);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“å®ç°ä¸¾ä¾‹æ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaServerRegistry implements Registry&amp;lt;Node&amp;gt; {  
    @Override
    public NodeChangeResult register(Node node) {
        StoreService storeService = ServiceFactory.getStoreService(node.getNodeType());
        return storeService.addNode(node);
    }            
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Registry æ ¹æ®ä¸åŒçš„èŠ‚ç‚¹ç±»å‹ï¼Œè·å–å¯¹åº”çš„&lt;code&gt;StoreService&lt;/code&gt;å®Œæˆæ·»åŠ èŠ‚ç‚¹æœåŠ¡ï¼Œè¿™é‡ŒèŠ‚ç‚¹ç±»å‹å°±æ˜¯&quot;META&quot;ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;node = {MetaNode@6342} &quot;MetaNode{ip=192.168.1.2}&quot;
 nodeType = {Node$NodeType@6369} &quot;META&quot;
 nodeUrl = {URL@6370} &quot;URL{address='192.168.1.2:0'}&quot;
 dataCenter = &quot;DefaultDataCenter&quot;
 name = &quot;192.168.1.2&quot;
 regionId = null
 nodeStatus = {Node$NodeStatus@6373} &quot;INIT&quot;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;storeService å°±æ˜¯ä»ä¸Šæ–‡ ServiceFactory ä»‹ç»çš„ storeServiceMap ä¸­æå–ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ &lt;code&gt;MetaNode&lt;/code&gt;ï¼Œå…¶å¯¹åº” storeService å®ç°ä¸º &lt;code&gt;MetaStoreService&lt;/code&gt; ï¼Œæ‰€ä»¥å°±ä¼šç”¨ &lt;code&gt;MetaStoreService&lt;/code&gt; å®Œæˆå­˜å‚¨ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;storeServiceMap = {HashMap@6394}  size = 3
 {Node$NodeType@6454} &quot;SESSION&quot; -&amp;gt; {SessionStoreService@6455} 
 {Node$NodeType@6369} &quot;META&quot; -&amp;gt; {MetaStoreService@6456} 
 {Node$NodeType@6457} &quot;DATA&quot; -&amp;gt; {DataStoreService@6458} 
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;13-å­˜å‚¨æœåŠ¡&quot;&gt;1.3 å­˜å‚¨æœåŠ¡&lt;/h3&gt;
&lt;p&gt;Node ç„¶åç”± &lt;code&gt;StoreService&lt;/code&gt; å­˜å‚¨åˆ° &lt;code&gt;Repository&lt;/code&gt; ä¸­ï¼Œå…·ä½“ä¸¾ä¾‹ &lt;code&gt;MetaStoreService&lt;/code&gt; å®ç°ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaStoreService implements StoreService&amp;lt;MetaNode&amp;gt; {
    @RaftReference(uniqueId = &quot;metaServer&quot;)
    private RepositoryService&amp;lt;String, RenewDecorate&amp;lt;MetaNode&amp;gt;&amp;gt; metaRepositoryService;

    @Override
    public NodeChangeResult addNode(MetaNode metaNode) {
        NodeChangeResult nodeChangeResult;
        String ipAddress = metaNode.getNodeUrl().getIpAddress();
        write.lock();
        try {
            //å­˜æ”¾åˆ°repositoryï¼ˆè‡ªåŠ¨é€šè¿‡jraftåŒæ­¥ç»™é›†ç¾¤ï¼‰
            metaRepositoryService.put(ipAddress, new RenewDecorate(metaNode,
                RenewDecorate.DEFAULT_DURATION_SECS));

            //è§¦å‘é€šçŸ¥(éœ€è¦é€šçŸ¥data/session)
            nodeChangeResult = getNodeChangeResult();
            firePushDataListTask(nodeChangeResult, &quot;addMetaNode&quot;);
            firePushSessionListTask(nodeChangeResult, &quot;addMetaNode&quot;);
        } finally {
            write.unlock();
        }
        return nodeChangeResult;
    }  
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é¢„å…ˆæŠŠå­˜å‚¨æµç¨‹æ€»ç»“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;                                                                                      +------------------------------+
                                                     +-----------------------+        |  Map(String, NodeRepository) |
                                                +---&amp;gt;+ metaRepositoryService +-------&amp;gt;+  registry                    |
                                                |    +-----------------------+        +------------------------------+
                                                |
                                                |
                                                |
Register +-------------------+  addNode   +-----+-----------+
+------&amp;gt; | MetaServerRegistry| +--------&amp;gt; | MetaStoreService|
         +-------------------+            +-----+-----------+
                                                |
                                                |
                                                |            +-------------------+     +--------------+       +----------------------+
                                                +----------&amp;gt; |TaskListenerManager+---&amp;gt; |TaskDispatcher| +---&amp;gt; |DataNodeChangePushTask|
                                               sendTaskEvent +-------------------+     +--------------+       +----------------------+

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰‹æœºä¸Šå‚è§ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1850883/202010/1850883-20201009224341528-1176675905.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;14-repositoryæœåŠ¡&quot;&gt;1.4 RepositoryæœåŠ¡&lt;/h3&gt;
&lt;p&gt;Repositoryç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„æ¦‚å¿µäº†ï¼Œå°è£…æ•°æ®æŸ¥è¯¢å’Œå­˜å‚¨é€»è¾‘ã€‚å®šä¹‰ï¼ˆæ¥è‡ªMartin Fowlerçš„ã€Šä¼ä¸šåº”ç”¨æ¶æ„æ¨¡å¼ã€‹ï¼‰ï¼šMediates between the domain and data mapping layers using a collection-like interface for accessing domain objectsã€‚&lt;/p&gt;
&lt;p&gt;Repositoryæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å±‚ï¼Œä»‹äºé¢†åŸŸå±‚ä¸æ•°æ®æ˜ å°„å±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰ä¹‹é—´ã€‚å®ƒçš„å­˜åœ¨è®©é¢†åŸŸå±‚æ„Ÿè§‰ä¸åˆ°æ•°æ®è®¿é—®å±‚çš„å­˜åœ¨ï¼Œå³æä¾›ä¸€ä¸ªç±»ä¼¼é›†åˆçš„æ¥å£æä¾›ç»™é¢†åŸŸå±‚è¿›è¡Œé¢†åŸŸå¯¹è±¡çš„è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;Repositoryå¯ä»¥è¢«è®¤ä¸ºæ˜¯ä»“åº“ç®¡ç†å‘˜ï¼Œé¢†åŸŸå±‚éœ€è¦ä»€ä¹ˆä¸œè¥¿åªéœ€å‘Šè¯‰ä»“åº“ç®¡ç†å‘˜ï¼Œç”±ä»“åº“ç®¡ç†å‘˜æŠŠä¸œè¥¿æ‹¿ç»™å®ƒï¼Œå¹¶ä¸éœ€è¦çŸ¥é“ä¸œè¥¿å®é™…æ”¾åœ¨å“ªã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼ŒNodeå¹¶æ²¡æœ‰æŒä¹…åŒ–ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚äºæ˜¯å°±è¦ &lt;u&gt;&lt;strong&gt;é‡ç‚¹æ³¨æ„&lt;/strong&gt;ï¼Œè™½ç„¶Repositoryå­˜å‚¨ä¸€ä¸ªNodeæ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼çŠ¶æ€ä¸‹ï¼Œå¦‚ä½•ä¿è¯ &quot;åœ¨ä¸€ä¸ªRepositoryä¸­æ–°Nodeçš„å­˜å‚¨çŠ¶æ€&quot; å¯ä»¥æ‹“å±•åˆ°é›†ç¾¤å…¶ä»–èŠ‚ç‚¹ä¸­ï¼Ÿè€Œä¸”èƒ½ä¿è¯ æ•°æ®ä¸€è‡´æ€§å‘¢ï¼Ÿ&lt;/u&gt;&lt;/p&gt;
&lt;h4 id=&quot;141-metarepositoryservice&quot;&gt;1.4.1 MetaRepositoryService&lt;/h4&gt;
&lt;p&gt;&lt;u&gt;MetaRepositoryService å†…éƒ¨çš„å­˜å‚¨æ˜¯åœ¨é›†ç¾¤å†…éƒ¨ç”±Raftåè®®æ¥ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„&lt;/u&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åç«¯ Repository å¯ä»¥çœ‹ä½œ SOFAJRaft çš„çŠ¶æ€æœºï¼Œä»»ä½•å¯¹ Map çš„æ“ä½œéƒ½ä¼šåœ¨é›†ç¾¤å†…éƒ¨ï¼Œäº¤ç”± Raft åè®®è¿›è¡ŒåŒæ­¥ï¼Œä»è€Œè¾¾åˆ°é›†ç¾¤å†…éƒ¨çš„ä¸€è‡´ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°&lt;code&gt;MetaRepositoryService&lt;/code&gt;åŠ ä¸Šäº† &lt;code&gt;RaftService&lt;/code&gt; æ³¨è§£ï¼Œè¿™å°±æ˜¯Raftçš„éƒ¨åˆ†å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´å¥½çš„è¯´æ˜ï¼Œæˆ‘ä»¬è¿™é‡Œæå‰ä»‹ç»ä¸‹ Raft çš„ä¸¤ä¸ªæ³¨è§£ï¼š&lt;code&gt;RaftReference&lt;/code&gt; å’Œ &lt;code&gt;RaftService&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ³¨è§£å¯ä»¥è®¤ä¸ºæ˜¯å°è£…å¥½Raftçš„ï¼Œå‘ˆç°ç»™Registryçš„æ¥å£ã€‚&lt;u&gt;RaftReference å¯¹åº”äº†å®¢æˆ·ç«¯ä»£ç†ï¼ŒRaftServiceå¯¹åº”ç€æœåŠ¡ç«¯çš„å®ç°&lt;/u&gt;ã€‚ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ&lt;u&gt;&lt;strong&gt;å› ä¸ºéœ€è¦ç»´æŠ¤æ•°æ®ä¸€è‡´æ€§ï¼Œæ‰€ä»¥å¿…é¡»æŠŠå•çº¯çš„æœ¬åœ°è°ƒç”¨è½¬æ¢ä¸ºå¼‚æ­¥ç½‘ç»œè°ƒç”¨ï¼Œè¿™æ ·æ‰èƒ½ç”¨raftåè®®ä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;/strong&gt;&lt;/u&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;RepositoryService&lt;/code&gt; çš„å…·ä½“å®ç°ç±»éƒ½åŠ äº† &lt;code&gt;@RaftService&lt;/code&gt; æ³¨è§£ï¼Œè¿™æ ·å°±è¯´æ˜è‡ªå·±æ˜¯ä¸€ä¸ªæœåŠ¡ç«¯ï¼›&lt;/li&gt;
&lt;li&gt;å‡¡æ˜¯ &lt;strong&gt;å¼•ç”¨&lt;/strong&gt; &lt;code&gt;RepositoryService&lt;/code&gt; çš„åœ°æ–¹ï¼Œéƒ½åŠ äº† &lt;code&gt;@RaftReference&lt;/code&gt;ï¼Œè¿™æ ·è°ƒç”¨ &lt;code&gt;RepositoryService&lt;/code&gt; çš„å‡½æ•°å°±ç›¸å½“äºå®¢æˆ·ç«¯è°ƒç”¨åˆ°æœåŠ¡ç«¯ï¼›&lt;/li&gt;
&lt;li&gt;å‡¡æ˜¯åŠ äº† &lt;code&gt;@RaftReference&lt;/code&gt; æ³¨è§£çš„å±æ€§ï¼Œéƒ½ä¼šè¢«åŠ¨æ€ä»£ç†ç±»æ›¿æ¢ï¼Œå…¶ä»£ç†å®ç°è§ &lt;code&gt;ProxyHandler&lt;/code&gt; ç±»ï¼Œå³å°†æ–¹æ³•è°ƒç”¨ï¼Œå°è£…ä¸º &lt;code&gt;ProcessRequest&lt;/code&gt;ï¼Œé€šè¿‡ RaftClient å‘é€ç»™ RaftServerã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å›åˆ°&lt;code&gt;MetaRepositoryService&lt;/code&gt;ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@RaftService(uniqueId = &quot;metaServer&quot;)
public class MetaRepositoryService extends AbstractSnapshotProcess
                          implements RepositoryService&amp;lt;String, RenewDecorate&amp;lt;MetaNode&amp;gt;&amp;gt; {
    @Autowired
    private NodeConfig                                 nodeConfig;
    /**
     * meta node store and version
     */
    private Map&amp;lt;String/*dataCenter*/, NodeRepository&amp;gt; registry          = new ConcurrentHashMap&amp;lt;&amp;gt;();
    private Set&amp;lt;String&amp;gt;                                snapShotFileNames = new HashSet&amp;lt;&amp;gt;();
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;142-putæ“ä½œ&quot;&gt;1.4.2 putæ“ä½œ&lt;/h4&gt;
&lt;p&gt;å½“æœ‰æ–°èŠ‚ç‚¹ æ—¶å€™ï¼ŒMetaRepositoryService ä¼šè¿›è¡Œ put æ“ä½œã€‚&lt;u&gt;åœ¨å…·ä½“putå‡½æ•°è°ƒç”¨ä¸­ï¼Œå®é™…ä¸Šæ˜¯å°†æ–¹æ³•è°ƒç”¨ï¼Œå°è£…ä¸º &lt;code&gt;ProcessRequest&lt;/code&gt;ï¼Œé€šè¿‡ RaftClient å‘é€ç»™ RaftServerã€‚è¿™æ ·å°±ç”± Raft åè®®ä¿è¯äº†æ•°æ®ä¸€è‡´æ€§&lt;/u&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public RenewDecorate&amp;lt;MetaNode&amp;gt; put(String ipAddress, RenewDecorate&amp;lt;MetaNode&amp;gt; metaNode,
                                   Long currentTimeMillis) {
    try {
        String dataCenter = metaNode.getRenewal().getDataCenter();
        NodeRepository&amp;lt;MetaNode&amp;gt; metaNodeRepository = registry.get(dataCenter);
        if (metaNodeRepository == null) {
            NodeRepository&amp;lt;MetaNode&amp;gt; nodeRepository = new NodeRepository&amp;lt;&amp;gt;(dataCenter,
                new ConcurrentHashMap&amp;lt;&amp;gt;(), currentTimeMillis);
            // putæ“ä½œå®é™…ä¸Šæ˜¯è°ƒç”¨åˆ°äº†æœåŠ¡ç«¯
            metaNodeRepository = registry.put(dataCenter, nodeRepository); 
            if (metaNodeRepository == null) {
                metaNodeRepository = nodeRepository;
            }
        }
        metaNodeRepository.setVersion(currentTimeMillis);
        Map&amp;lt;String/*ipAddress*/, RenewDecorate&amp;lt;MetaNode&amp;gt;&amp;gt; metaNodes = metaNodeRepository
            .getNodeMap();
        RenewDecorate oldRenewDecorate = metaNodes.get(ipAddress);
        metaNodes.put(ipAddress, metaNode);
    } 
    return metaNode;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;143-èŠ‚ç‚¹æ•°æ®å­˜å‚¨&quot;&gt;1.4.3 èŠ‚ç‚¹æ•°æ®å­˜å‚¨&lt;/h4&gt;
&lt;p&gt;èŠ‚ç‚¹æ•°æ®çš„å­˜å‚¨ï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨åœ¨å†…å­˜çš„å“ˆå¸Œè¡¨ä¸­ï¼Œå…¶å­˜å‚¨ç»“æ„ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;// RepositoryService åº•å±‚å­˜å‚¨
Map&amp;lt;String/*dataCenter*/, NodeRepository&amp;gt; registry;

// NodeRepository åº•å±‚å­˜å‚¨
Map&amp;lt;String/*ipAddress*/, RenewDecorate&amp;lt;T&amp;gt;&amp;gt; nodeMap;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å°†&lt;code&gt;RenewDecorate&lt;/code&gt;å­˜å‚¨åˆ°è¯¥ Map ä¸­ï¼Œæ•´ä¸ªèŠ‚ç‚¹æ³¨å†Œçš„æµç¨‹å°±å®Œæˆäº†ï¼Œè‡³äºå¦‚ä½•å’Œ Raft åè®®è¿›è¡Œç»“åˆå’Œæ•°æ®åŒæ­¥ï¼Œåç»­ä¼šä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;èŠ‚ç‚¹ç§»é™¤çš„é€»è¾‘ç±»ä¼¼ï¼Œå°†èŠ‚ç‚¹ä¿¡æ¯ä»è¯¥ Map ä¸­åˆ é™¤ï¼Œä¹Ÿä¼šå­˜å‚¨ä¸€ä¸ªå˜æ›´äº‹ä»¶åˆ°é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åç»“æœå¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;this = {MetaRepositoryService@6905} 
 registry = {ConcurrentHashMap@6907}  size = 1
  &quot;DefaultDataCenter&quot; -&amp;gt; {NodeRepository@7251} 
 snapShotFileNames = {HashSet@6904}  size = 1
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;15-jraftå®ç°æ•°æ®ä¸€è‡´æ€§&quot;&gt;1.5 jraftå®ç°æ•°æ®ä¸€è‡´æ€§&lt;/h3&gt;
&lt;p&gt;æˆå‘˜åˆ—è¡¨æ•°æ®å­˜å‚¨åœ¨ Repository ä¸­ï¼ŒRepository è¢«ä¸€è‡´æ€§åè®®å±‚è¿›è¡ŒåŒ…è£…ï¼Œä½œä¸º SOFAJRaft çš„çŠ¶æ€æœºå®ç°ï¼Œæ‰€æœ‰å¯¹ Repository çš„æ“ä½œéƒ½ä¼šåŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œé€šè¿‡ Registry æ¥æ“ä½œå­˜å‚¨å±‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åŒæ­¥æ—¶å€™ï¼Œjraftå¯ä»¥ç›´æ¥è°ƒç”¨ MetaRepositoryServiceï¼Œå®ç°å†…éƒ¨æ•°æ®ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;u&gt;è¿™é‡Œè¯´çš„æ˜¯å…¶ä»–èŠ‚ç‚¹çš„åŒæ­¥æ“ä½œï¼Œå’Œä¸ŠèŠ‚ä¸åŒã€‚ä¸ŠèŠ‚æ˜¯ä¸»åŠ¨å­˜å‚¨èŠ‚ç‚¹ï¼Œè¿™é‡Œæ˜¯è¢«åŠ¨åŒæ­¥&lt;/u&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;put:45, MetaRepositoryService (com.alipay.sofa.registry.server.meta.repository.service)
put:31, RepositoryService (com.alipay.sofa.registry.server.meta.repository)
invokeInterface_L3_L:-1, 1412712349 (java.lang.invoke.LambdaForm$DMH)
reinvoke:-1, 1139092036 (java.lang.invoke.LambdaForm$BMH)
invoker:-1, 403463237 (java.lang.invoke.LambdaForm$MH)
invokeExact_MT:-1, 1568507411 (java.lang.invoke.LambdaForm$MH)
invokeWithArguments:627, MethodHandle (java.lang.invoke)
process:123, Processor (com.alipay.sofa.registry.jraft.processor)
onApply:133, ServiceStateMachine (com.alipay.sofa.registry.jraft.bootstrap)
doApplyTasks:534, FSMCallerImpl (com.alipay.sofa.jraft.core)
doCommitted:503, FSMCallerImpl (com.alipay.sofa.jraft.core)
runApplyTask:431, FSMCallerImpl (com.alipay.sofa.jraft.core)
access$100:72, FSMCallerImpl (com.alipay.sofa.jraft.core)
onEvent:147, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
onEvent:141, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
run:137, BatchEventProcessor (com.lmax.disruptor)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;16-é€šçŸ¥data-session&quot;&gt;1.6 é€šçŸ¥data, session&lt;/h3&gt;
&lt;h4 id=&quot;161-é€šçŸ¥æ“ä½œ&quot;&gt;1.6.1 é€šçŸ¥æ“ä½œ&lt;/h4&gt;
&lt;p&gt;å‰æ–‡ &quot;1.3 å­˜å‚¨æœåŠ¡&quot; ä¸­æœ‰ firePushDataListTaskï¼ŒfirePushSessionListTaskï¼Œæœ€ç»ˆç›®çš„æ˜¯é€šçŸ¥æ‰€æœ‰data/sessionæœ‰metaServerå˜åŠ¨ï¼Œè¿™é‡ŒæŠŠä»£ç å†è´´å‡ºæ¥æ¸©ä¹ ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaStoreService implements StoreService&amp;lt;MetaNode&amp;gt; {

    @Override
    public NodeChangeResult addNode(MetaNode metaNode) {

            //å­˜æ”¾åˆ°repositoryï¼ˆè‡ªåŠ¨é€šè¿‡jraftåŒæ­¥ç»™é›†ç¾¤ï¼‰
            metaRepositoryService.put(ipAddress, new RenewDecorate(metaNode,
                RenewDecorate.DEFAULT_DURATION_SECS));

            //è§¦å‘é€šçŸ¥(éœ€è¦é€šçŸ¥data/session)ï¼Œæˆ‘ä»¬è¯´çš„å°±æ˜¯è¿™é‡Œ
            nodeChangeResult = getNodeChangeResult();
            firePushDataListTask(nodeChangeResult, &quot;addMetaNode&quot;);
            firePushSessionListTask(nodeChangeResult, &quot;addMetaNode&quot;);
    }  
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;firePushDataListTask å’Œ firePushSessionListTask è¿›è€Œä¼šå¾€taskListenerManagerå‘é€æ¶ˆæ¯ï¼Œ&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;private void firePushDataListTask(NodeChangeResult nodeChangeResult, String nodeOperate) {
    TaskEvent taskEvent = new TaskEvent(nodeChangeResult, TaskType.DATA_NODE_CHANGE_PUSH_TASK);
    taskEvent.setAttribute(Constant.PUSH_NEED_CONFIRM_KEY, false);
    taskEvent.setAttribute(Constant.PUSH_TARGET_TYPE, NodeType.DATA);
    taskEvent.setAttribute(Constant.PUSH_TARGET_OPERATOR_TYPE, nodeOperate);
    taskListenerManager.sendTaskEvent(taskEvent);
}

private void firePushSessionListTask(NodeChangeResult nodeChangeResult, String nodeOperate) {
    //notify all session node
    TaskEvent taskEvent = new TaskEvent(nodeChangeResult, TaskType.DATA_NODE_CHANGE_PUSH_TASK);
    taskEvent.setAttribute(Constant.PUSH_TARGET_TYPE, NodeType.SESSION);
    taskEvent.setAttribute(Constant.PUSH_TARGET_OPERATOR_TYPE, nodeOperate);
    taskListenerManager.sendTaskEvent(taskEvent);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ­¤å¤„æ˜¯è§¦å‘é€šçŸ¥ï¼Œäºæ˜¯data èŠ‚ç‚¹, sessionèŠ‚ç‚¹ä¼šå¾—åˆ°é€šçŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•é€šçŸ¥dataèŠ‚ç‚¹, sessionèŠ‚ç‚¹ï¼Ÿè¿™é‡Œç”¨åˆ°äº†Listenerï¼Œå³è°ƒç”¨äº† DefaultTaskListenerManager # sendTaskEventã€‚&lt;/p&gt;
&lt;p&gt;å †æ ˆå¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;sendTaskEvent:45, DefaultTaskListenerManager (com.alipay.sofa.registry.task.listener)
firePushDataListTask:355, MetaStoreService (com.alipay.sofa.registry.server.meta.store)
addNode:127, MetaStoreService (com.alipay.sofa.registry.server.meta.store)
addNode:54, MetaStoreService (com.alipay.sofa.registry.server.meta.store)
register:52, MetaServerRegistry (com.alipay.sofa.registry.server.meta.registry)
registerCurrentNode:203, RaftExchanger (com.alipay.sofa.registry.server.meta.remoting)
access$200:56, RaftExchanger (com.alipay.sofa.registry.server.meta.remoting)
startProcess:105, RaftExchanger$1 (com.alipay.sofa.registry.server.meta.remoting)
lambda$onLeaderStart$2:234, ServiceStateMachine (com.alipay.sofa.registry.jraft.bootstrap)
run:-1, 50941601 (com.alipay.sofa.registry.jraft.bootstrap.ServiceStateMachine$$Lambda$192)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;162-åˆ†å‘é€šçŸ¥æ¶ˆæ¯&quot;&gt;1.6.2 åˆ†å‘é€šçŸ¥æ¶ˆæ¯&lt;/h4&gt;
&lt;p&gt;TaskListenerManager æ˜¯ç”¨æ¥åˆ†å‘å„ç§é€šçŸ¥æ¶ˆæ¯çš„ç±»ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DefaultTaskListenerManager implements TaskListenerManager {
    @Override
    public void sendTaskEvent(TaskEvent taskEvent) {
        Collection&amp;lt;TaskListener&amp;gt; taskListeners = this.taskListeners.get(taskEvent.getTaskType());
        for (TaskListener taskListener : taskListeners) {
            taskListener.handleEvent(taskEvent);
        }
    }  
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨ taskListenerManager.addTaskListener(taskListener); ä¸­æ³¨å†Œäº†å¾ˆå¤šå¤„ç†æ¶ˆæ¯çš„handlerï¼Œä»ä¸‹é¢è¿è¡Œå˜é‡çš„æ–‡å­—ä¸­å¯ä»¥çœ‹å‡ºå…¶é€»è¾‘æ„ä¹‰ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;this.taskListeners = {ArrayListMultimap@7221} 
 expectedValuesPerKey = 3
 map = {HashMap@7227}  size = 4
  {TaskEvent$TaskType@7235} &quot;RECEIVE_STATUS_CONFIRM_NOTIFY_TASK&quot; -&amp;gt; {ArrayList@7236}  size = 1
   key = {TaskEvent$TaskType@7235} &quot;RECEIVE_STATUS_CONFIRM_NOTIFY_TASK&quot;
   value = {ArrayList@7236}  size = 1
    0 = {ReceiveStatusConfirmNotifyTaskListener@7248} 
  {TaskEvent$TaskType@7237} &quot;PERSISTENCE_DATA_CHANGE_NOTIFY_TASK&quot; -&amp;gt; {ArrayList@7238}  size = 1
   key = {TaskEvent$TaskType@7237} &quot;PERSISTENCE_DATA_CHANGE_NOTIFY_TASK&quot;
   value = {ArrayList@7238}  size = 1
    0 = {PersistenceDataChangeNotifyTaskListener@7254} 
  {TaskEvent$TaskType@7239} &quot;SESSION_NODE_CHANGE_PUSH_TASK&quot; -&amp;gt; {ArrayList@7240}  size = 1
   key = {TaskEvent$TaskType@7239} &quot;SESSION_NODE_CHANGE_PUSH_TASK&quot;
   value = {ArrayList@7240}  size = 1
    0 = {SessionNodeChangePushTaskListener@7252} 
  {TaskEvent$TaskType@7241} &quot;DATA_NODE_CHANGE_PUSH_TASK&quot; -&amp;gt; {ArrayList@7242}  size = 1
   key = {TaskEvent$TaskType@7241} &quot;DATA_NODE_CHANGE_PUSH_TASK&quot;
   value = {ArrayList@7242}  size = 1
    0 = {DataNodeChangePushTaskListener@7250} 
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;äºæ˜¯åœ¨ sendTaskEvent ä¹‹ä¸­ä¼šè°ƒç”¨ç›¸å…³çš„æ¶ˆæ¯handleræ¥è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;h4 id=&quot;163-å¼‚æ­¥å¤„ç†æ¶ˆæ¯&quot;&gt;1.6.3 å¼‚æ­¥å¤„ç†æ¶ˆæ¯&lt;/h4&gt;
&lt;p&gt;å…·ä½“å¤„ç†æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä¸¾ä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;DataNodeChangePushTaskListener å°±æ˜¯ç”¨æ¥å¤„ç†DataNodeç›¸å…³æ¶ˆæ¯çš„ç±»ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataNodeChangePushTaskListener implements TaskListener {
  
    private TaskDispatcher&amp;lt;String, MetaServerTask&amp;gt; dataSingleTaskDispatcher;
    private TaskDispatcher&amp;lt;String, MetaServerTask&amp;gt; sessionSingleTaskDispatcher;
  
    @Override
    public void handleEvent(TaskEvent event) {

        NodeType nodeType = (NodeType) event.getAttribute(Constant.PUSH_TARGET_TYPE);
        switch (nodeType) {
            case SESSION:
                MetaServerTask sessionNodeChangePushTask = new DataNodeChangePushTask(
                    NodeType.SESSION, metaServerConfig);
                sessionNodeChangePushTask.setTaskEvent(event);
                sessionSingleTaskDispatcher.dispatch(sessionNodeChangePushTask.getTaskId(),
                    sessionNodeChangePushTask, sessionNodeChangePushTask.getExpiryTime());
                break;
            case DATA:
                MetaServerTask dataNodeChangePushTask = new DataNodeChangePushTask(NodeType.DATA,
                    metaServerConfig);
                dataNodeChangePushTask.setTaskEvent(event);
                dataSingleTaskDispatcher.dispatch(dataNodeChangePushTask.getTaskId(),
                    dataNodeChangePushTask, dataNodeChangePushTask.getExpiryTime());
                break;
            default:
                break;
        }
    }  
} 
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒTaskDispatcher æ˜¯ä¸€ä¸ªåˆ†å‘å¼‚æ­¥æ¶ˆæ¯ï¼Œéšä¹‹é€šè¿‡TaskExecutorsè¿›è¡Œå¼‚æ­¥æ“ä½œçš„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚æ˜¯DataNodeï¼Œæœ€åä¼šè°ƒç”¨åˆ° DataNodeChangePushTaskï¼Œå…¶æ˜¯ç”± DataNodeSingleTaskProcessor æ¥æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å…¶è°ƒç”¨æ ˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;pushDataNodes:73, DataNodeServiceImpl (com.alipay.sofa.registry.server.meta.node.impl)
execute:86, DataNodeChangePushTask (com.alipay.sofa.registry.server.meta.task)
process:41, DataNodeSingleTaskProcessor (com.alipay.sofa.registry.server.meta.task.processor)
process:32, DataNodeSingleTaskProcessor (com.alipay.sofa.registry.server.meta.task.processor)
run:136, TaskExecutors$WorkerRunnable (com.alipay.sofa.registry.task.batcher)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“åˆ° DataNodeChangePushTask æ¥è¿›è¡Œä¸å„ä¸ªDataNodeè¿›è¡Œäº¤äº’çš„æ“ä½œã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataNodeChangePushTask extends AbstractMetaServerTask {
    private final SessionNodeService sessionNodeService;
    private final DataNodeService    dataNodeService;
    final private MetaServerConfig   metaServerConfig;
    final private NodeType           nodeType;
    private NodeChangeResult         nodeChangeResult;
    private Boolean                  confirm;
    private String                   confirmNodeIp;

    private Map&amp;lt;String, DataNode&amp;gt;    targetNodes;
  
    @Override
    public void execute() {
        switch (nodeType) {
            case SESSION:
                sessionNodeService.pushDataNodes(nodeChangeResult);
                break;
            case DATA:
                dataNodeService
                    .pushDataNodes(nodeChangeResult, targetNodes, confirm, confirmNodeIp);
                break;
            default:
                break;
        }
    }
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä»¥DataNodeServiceImplä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°æœ€åè°ƒç”¨äº† dataNodeExchanger å®Œæˆäº†èŠ‚ç‚¹é—´é€šè®¯ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataNodeServiceImpl implements DataNodeService {

    @Autowired
    private NodeExchanger         dataNodeExchanger;

    @Autowired
    private StoreService          dataStoreService;

    @Autowired
    private AbstractServerHandler dataConnectionHandler;

    @Override
    public void pushDataNodes(NodeChangeResult nodeChangeResult, Map&amp;lt;String, DataNode&amp;gt; targetNodes,
                              boolean confirm, String confirmNodeIp) {

        if (nodeChangeResult != null) {

            List&amp;lt;Throwable&amp;gt; exceptions = new ArrayList&amp;lt;&amp;gt;();
            NodeConnectManager nodeConnectManager = getNodeConnectManager();

            Collection&amp;lt;InetSocketAddress&amp;gt; connections = nodeConnectManager.getConnections(null);

            // add register confirm
            StoreService storeService = ServiceFactory.getStoreService(NodeType.DATA);
            DataCenterNodes dataCenterNodes = storeService.getDataCenterNodes();
            Map&amp;lt;String, DataNode&amp;gt; registeredNodes = dataCenterNodes.getNodes();

            for (InetSocketAddress address : connections) {
                try {
                    if (targetNodes != null &amp;amp;&amp;amp; !targetNodes.isEmpty()) {
                        if (!targetNodes.keySet().contains(address.getAddress().getHostAddress())) {
                            continue;
                        }
                    } else {
                        if (!registeredNodes.keySet().contains(
                            address.getAddress().getHostAddress())) {
                            continue;
                        }
                    }

                    Request&amp;lt;NodeChangeResult&amp;gt; nodeChangeRequestRequest = new Request&amp;lt;NodeChangeResult&amp;gt;() {
                        @Override
                        public NodeChangeResult getRequestBody() {
                            return nodeChangeResult;
                        }

                        @Override
                        public URL getRequestUrl() {
                            return new URL(address);
                        }
                    };
                    // èŠ‚ç‚¹é—´é€šè®¯
                    Response response = dataNodeExchanger.request(nodeChangeRequestRequest);

                    if (confirm) {
                        Object result = response.getResult();
                        if (result instanceof CommonResponse) {
                            CommonResponse genericResponse = (CommonResponse) result;
                            if (genericResponse.isSuccess()) {
                                confirmStatus(address, confirmNodeIp);
                            } 
                        } 
                    }
                } 
            }
        }
    }
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;164-å¦ä¸€ç§äº§ç”Ÿé€šçŸ¥æ–¹å¼&quot;&gt;1.6.4 å¦ä¸€ç§äº§ç”Ÿé€šçŸ¥æ–¹å¼&lt;/h4&gt;
&lt;p&gt;&lt;u&gt;ExecutorManagerçš„pushNodeListChangeä¼šå®šæœŸæ£€æŸ¥ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œåˆ™äº§ç”Ÿé€šçŸ¥&lt;/u&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹åº”åæ–‡çš„ DataConfirmStatusService èŠ‚ç‚¹å˜æ›´äº‹ä»¶ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;scheduler.schedule(
        new TimedSupervisorTask(&quot;CheckDataNodeListChangePush&quot;, scheduler, checkNodeListChangePushExecutor,
                metaServerConfig.getSchedulerCheckNodeListChangePushTimeout(), TimeUnit.SECONDS,
                metaServerConfig.getSchedulerCheckNodeListChangePushExpBackOffBound(),
                () -&amp;gt; metaServerRegistry.pushNodeListChange(NodeType.DATA)),
        metaServerConfig.getSchedulerCheckNodeListChangePushFirstDelay(), TimeUnit.SECONDS);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶å †æ ˆæ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;pushNodeListChange:278, DataStoreService (com.alipay.sofa.registry.server.meta.store)
pushNodeListChange:103, MetaServerRegistry (com.alipay.sofa.registry.server.meta.registry)
lambda$startScheduler$4:158, ExecutorManager (com.alipay.sofa.registry.server.meta.executor)
run:-1, 758751909 (com.alipay.sofa.registry.server.meta.executor.ExecutorManager$$Lambda$202)
call:511, Executors$RunnableAdapter (java.util.concurrent)
run$$$capture:266, FutureTask (java.util.concurrent)
run:-1, FutureTask (java.util.concurrent)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¯”å¦‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataStoreService implements StoreService&amp;lt;DataNode&amp;gt; {
    @Override
    public void pushNodeListChange() {
        NodeOperator&amp;lt;DataNode&amp;gt; fireNode;
        if ((fireNode = dataConfirmStatusService.peekConfirmNode()) != null) {
            NodeChangeResult nodeChangeResult = getNodeChangeResult();
            Map&amp;lt;String, Map&amp;lt;String, DataNode&amp;gt;&amp;gt; map = nodeChangeResult.getNodes();
            Map&amp;lt;String, DataNode&amp;gt; addNodes = map.get(nodeConfig.getLocalDataCenter());
            if (addNodes != null) {
                Map&amp;lt;String, DataNode&amp;gt; previousNodes = dataConfirmStatusService.putExpectNodes(
                    fireNode.getNode(), addNodes);

                if (!previousNodes.isEmpty()) {
                    // äº§ç”Ÿé€šçŸ¥
                    firePushDataListTask(fireNode, nodeChangeResult, previousNodes, true);
                }
            }
            // äº§ç”Ÿé€šçŸ¥
            firePushSessionListTask(nodeChangeResult, fireNode.getNodeOperate().toString());
        }
    }  
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;0x02-èŠ‚ç‚¹æ³¨å†Œ&quot;&gt;0x02 èŠ‚ç‚¹æ³¨å†Œ&lt;/h2&gt;
&lt;h3 id=&quot;21--dataapplication&quot;&gt;2.1 DataApplication&lt;/h3&gt;
&lt;h4 id=&quot;211-dataconnectionhandler&quot;&gt;2.1.1 DataConnectionHandler&lt;/h4&gt;
&lt;p&gt;å½“ä¸€ä¸ªDataApplicationå¯åŠ¨ï¼Œé¦–å…ˆDataConnectionHandlerä¼šå“åº”ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;connected:40, DataConnectionHandler (com.alipay.sofa.registry.server.meta.remoting.connection)
onEvent:69, ConnectionEventAdapter (com.alipay.sofa.registry.remoting.bolt)
onEvent:44, ConnectionEventListener (com.alipay.remoting)
run:201, ConnectionEventHandler$1 (com.alipay.remoting)
runWorker:1149, ThreadPoolExecutor (java.util.concurrent)
run:624, ThreadPoolExecutor$Worker (java.util.concurrent)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ„Ÿè§‰åªæ˜¯è®¾ç½®äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataConnectionHandler extends AbstractServerHandler implements NodeConnectManager {
    private Map&amp;lt;String/*connectId*/, InetSocketAddress&amp;gt; connections = new ConcurrentHashMap&amp;lt;&amp;gt;();

    @Override
    public void connected(Channel channel) throws RemotingException {
        super.connected(channel);
        addConnection(channel);
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;212-datanodehandler&quot;&gt;2.1.2 DataNodeHandler&lt;/h4&gt;
&lt;p&gt;ç„¶åæ˜¯ DataNodeHandler ä¼šå“åº”ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;reply:43, DataNodeHandler (com.alipay.sofa.registry.server.meta.remoting.handler)
handleRequest:54, SyncUserProcessorAdapter (com.alipay.sofa.registry.remoting.bolt)
dispatchToUserProcessor:239, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
doProcess:145, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
run:366, RpcRequestProcessor$ProcessTask (com.alipay.remoting.rpc.protocol)
runWorker:1149, ThreadPoolExecutor (java.util.concurrent)
run:624, ThreadPoolExecutor$Worker (java.util.concurrent)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“ä»£ç å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataNodeHandler extends AbstractServerHandler&amp;lt;DataNode&amp;gt; {
    @Autowired
    private Registry            metaServerRegistry;

    @Override
    public Object reply(Channel channel, DataNode dataNode) {
        NodeChangeResult nodeChangeResult;
        nodeChangeResult = metaServerRegistry.register(dataNode);
        return nodeChangeResult;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯è°ƒç”¨StoreæœåŠ¡è¿›è¡Œæ·»åŠ èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public NodeChangeResult register(Node node) {
    StoreService storeService = ServiceFactory.getStoreService(node.getNodeType());
    return storeService.addNode(node);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä»£ç æ¥åˆ° DataStoreServiceï¼Œä¾ç„¶æ˜¯è°ƒç”¨ RepositoryService æ¥è¿›è¡ŒèŠ‚ç‚¹çš„æ³¨å†Œå’Œå­˜å‚¨ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataStoreService implements StoreService&amp;lt;DataNode&amp;gt; {
    @Autowired
    private TaskListenerManager                                taskListenerManager;

    @RaftReference(uniqueId = &quot;dataServer&quot;)
    private RepositoryService&amp;lt;String, RenewDecorate&amp;lt;DataNode&amp;gt;&amp;gt; dataRepositoryService;

    @RaftReference(uniqueId = &quot;dataServer&quot;)
    private NodeConfirmStatusService&amp;lt;DataNode&amp;gt;                 dataConfirmStatusService;

    @Override
    public NodeChangeResult addNode(DataNode dataNode) {
        NodeChangeResult nodeChangeResult;
        String ipAddress = dataNode.getNodeUrl().getIpAddress();
        write.lock();
        try {
            dataRepositoryService.put(ipAddress, new RenewDecorate(dataNode,
                RenewDecorate.DEFAULT_DURATION_SECS));
            renew(dataNode, 30);
            nodeChangeResult = getNodeChangeResult();
            dataConfirmStatusService.putConfirmNode(dataNode, DataOperator.ADD);
        } finally {
            write.unlock();
        }
        return nodeChangeResult;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;dataConfirmStatusService.putConfirmNode&lt;/code&gt; åŒæ—¶ä¼šå­˜å‚¨ä¸€ä¸ªå˜æ›´äº‹ä»¶åˆ°é˜Ÿåˆ—ä¸­ï¼Œä¸»è¦ç”¨äºæ•°æ®æ¨é€ï¼Œæ¶ˆè´¹å¤„ç†ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void putConfirmNode(DataNode node, DataOperator nodeOperate) {
        expectNodesOrders.put(new NodeOperator(node, nodeOperate));
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;213-dataconfirmstatusservice&quot;&gt;2.1.3 DataConfirmStatusService&lt;/h4&gt;
&lt;p&gt;DataConfirmStatusService ä¹Ÿæ˜¯æ³¨è§£äº†RaftServiceï¼Œè¿™è¯´æ˜æ˜¯ä¸€ä¸ªç”± Raft åè®®è¿›è¡ŒåŒæ­¥çš„å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹çš„è¿™äº›å­˜å‚¨ç»“æ„ä¼šè¢«åŒæ­¥ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;expectNodesOrders&lt;/code&gt; ç”¨æ¥å­˜å‚¨èŠ‚ç‚¹å˜æ›´äº‹ä»¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;expectNodes&lt;/code&gt; ç”¨æ¥å­˜å‚¨å˜æ›´äº‹ä»¶éœ€è¦ç¡®è®¤çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ &lt;code&gt;NodeOperator&lt;/code&gt; åªæœ‰å¾—åˆ°äº†å…¶ä»–èŠ‚ç‚¹çš„ç¡®è®¤ï¼Œæ‰ä¼šä» &lt;code&gt;expectNodesOrders&lt;/code&gt; ç§»é™¤ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;snapShotFileNames&lt;/code&gt; æ˜¯å¿«ç…§æ–‡ä»¶åï¼›&lt;/li&gt;
&lt;/ul&gt;&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@RaftService(uniqueId = &quot;dataServer&quot;)
public class DataConfirmStatusService extends AbstractSnapshotProcess
                                      implements NodeConfirmStatusService&amp;lt;DataNode&amp;gt; {
  
        private ConcurrentHashMap&amp;lt;DataNode/*node*/, Map&amp;lt;String/*ipAddress*/, DataNode&amp;gt;&amp;gt; expectNodes             = new ConcurrentHashMap&amp;lt;&amp;gt;();
        private BlockingQueue&amp;lt;NodeOperator&amp;gt;                                               expectNodesOrders       = new LinkedBlockingQueue();
        private Set&amp;lt;String&amp;gt;   snapShotFileNames 
      
        @Override
  public void putConfirmNode(DataNode node, DataOperator nodeOperate) {
      expectNodesOrders.put(new NodeOperator(node, nodeOperate));
  }    
    
  public NodeOperator&amp;lt;DataNode&amp;gt; peekConfirmNode() {
      return expectNodesOrders.peek();
  }
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;214-æ¶ˆè´¹&quot;&gt;2.1.4 æ¶ˆè´¹&lt;/h4&gt;
&lt;p&gt;äº‹ä»¶å­˜å‚¨åˆ° BlockingQueue expectNodesOrders é‡Œï¼Œå“ªé‡Œå»æ¶ˆè´¹å‘¢ï¼Ÿ çœ‹æºç å‘ç°ï¼Œå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹é˜»å¡çš„è¯»ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;ExecutorManager&lt;/code&gt;ä¸­ä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œè½®è¯¢è¯¥é˜Ÿåˆ—æœ‰æ²¡æœ‰æ•°æ®ã€‚å³å‘¨æœŸæ€§çš„è°ƒç”¨&lt;code&gt;Registry#pushNodeListChange&lt;/code&gt;æ–¹æ³•ï¼Œè·å–é˜Ÿåˆ—çš„å¤´èŠ‚ç‚¹å¹¶æ¶ˆè´¹ã€‚Data å’Œ Session å„å¯¹åº”ä¸€ä¸ªä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2019/png/338467/1568256774231-1672888e-de2f-44fd-b9c5-45573f3d4b79.png&quot; alt=&quot;push_processor&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;é¦–å…ˆè·å–é˜Ÿåˆ—ï¼ˆexpectNodesOrdersï¼‰å¤´èŠ‚ç‚¹ï¼Œå¦‚æœä¸ºNullç›´æ¥è¿”å›ï¼›&lt;/li&gt;
&lt;li&gt;è·å–å½“å‰æ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¹¶å­˜å‚¨åˆ°ç¡®è®¤è¡¨ï¼ˆexpectNodesï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡ï¼ˆfirePushXxListTask)ï¼›&lt;/li&gt;
&lt;li&gt;å¤„ç†ä»»åŠ¡ï¼Œå³è°ƒç”¨ XxNodeService çš„ pushXxxNode æ–¹æ³•ï¼Œå³é€šè¿‡ ConnectionHandler è·å–æ‰€æœ‰çš„èŠ‚ç‚¹è¿æ¥ï¼Œå‘é€èŠ‚ç‚¹åˆ—è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;æ”¶åˆ°å›å¤åï¼Œå¦‚æœéœ€è¦ç¡®è®¤ï¼Œåˆ™ä¼šè°ƒç”¨&lt;code&gt;StoreService#confirmNodeStatus&lt;/code&gt; æ–¹æ³•ï¼Œå°†è¯¥èŠ‚ç‚¹ä»expectNodesä¸­ç§»é™¤ï¼›&lt;/li&gt;
&lt;li&gt;å¾…æ‰€æœ‰çš„èŠ‚ç‚¹ä» expectNodes ä¸­ç§»é™¤ï¼Œåˆ™å°†æ­¤æ¬¡æ“ä½œä» expectNodesOrders ç§»é™¤ï¼Œå¤„ç†å®Œæ¯•ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;å…·ä½“å¯ä»¥ç»†åŒ–å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;h5 id=&quot;2141-å®šæ—¶æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡&quot;&gt;2.1.4.1 å®šæ—¶æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡&lt;/h5&gt;
&lt;p&gt;æœ¬å°èŠ‚å¯¹åº”ä¸Šé¢æ­¥éª¤çš„å‰ä¸‰æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚å…³äºData å®šæ—¶ä»»åŠ¡å¦‚ä¸‹ï¼Œé‡Œé¢å®šæœŸè°ƒç”¨äº†MetaServerRegistry çš„ pushNodeListChangeå‡½æ•°æ¥å¤„ç†ä»»åŠ¡ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;scheduler.schedule(
        new TimedSupervisorTask(&quot;CheckDataNodeListChangePush&quot;, scheduler, checkNodeListChangePushExecutor,
                metaServerConfig.getSchedulerCheckNodeListChangePushTimeout(), TimeUnit.SECONDS,
                metaServerConfig.getSchedulerCheckNodeListChangePushExpBackOffBound(),
                () -&amp;gt; metaServerRegistry.pushNodeListChange(NodeType.DATA)),
        metaServerConfig.getSchedulerCheckNodeListChangePushFirstDelay(), TimeUnit.SECONDS);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;MetaServerRegistry ä¸­çš„ pushNodeListChange å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void pushNodeListChange(NodeType nodeType) {
    StoreService storeService = ServiceFactory.getStoreService(nodeType);
    if (storeService != null) {
        storeService.pushNodeListChange();
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;DataStoreService è¿™é‡Œåšäº†ä»¥ä¸‹å·¥ä½œã€‚&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;é¦–å…ˆè·å–é˜Ÿåˆ—ï¼ˆexpectNodesOrdersï¼‰å¤´èŠ‚ç‚¹ï¼Œå¦‚æœä¸ºNullç›´æ¥è¿”å›ï¼›&lt;/li&gt;
&lt;li&gt;è·å–å½“å‰æ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¹¶å­˜å‚¨åˆ°ç¡®è®¤è¡¨ï¼ˆexpectNodesï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡ï¼ˆfirePushXxListTask)ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void pushNodeListChange() {
    NodeOperator&amp;lt;DataNode&amp;gt; fireNode;
    //  é¦–å…ˆè·å–é˜Ÿåˆ—ï¼ˆexpectNodesOrdersï¼‰å¤´èŠ‚ç‚¹ï¼Œå¦‚æœä¸ºNullç›´æ¥è¿”å›ï¼›
    if ((fireNode = dataConfirmStatusService.peekConfirmNode()) != null) {
        NodeChangeResult nodeChangeResult = getNodeChangeResult();
        Map&amp;lt;String, Map&amp;lt;String, DataNode&amp;gt;&amp;gt; map = nodeChangeResult.getNodes();
        Map&amp;lt;String, DataNode&amp;gt; addNodes = map.get(nodeConfig.getLocalDataCenter());
        if (addNodes != null) {
            // è·å–å½“å‰æ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¹¶å­˜å‚¨åˆ°ç¡®è®¤è¡¨ï¼ˆexpectNodesï¼‰ï¼›
            Map&amp;lt;String, DataNode&amp;gt; previousNodes = dataConfirmStatusService.putExpectNodes(
                fireNode.getNode(), addNodes);
            // æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡ï¼ˆfirePushXxListTask)ï¼›
            if (!previousNodes.isEmpty()) {
                firePushDataListTask(fireNode, nodeChangeResult, previousNodes, true);
            }
        }
        // æäº¤èŠ‚ç‚¹å˜æ›´æ¨é€ä»»åŠ¡ï¼ˆfirePushXxListTask)ï¼›
        firePushSessionListTask(nodeChangeResult, fireNode.getNodeOperate().toString());
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ ·å°±æŠŠä»»åŠ¡æäº¤åˆ°äº†Taskä»»åŠ¡ã€‚&lt;/p&gt;
&lt;h5 id=&quot;2142-å®šæ—¶å¼‚æ­¥å¤„ç†ä»»åŠ¡&quot;&gt;2.1.4.2 å®šæ—¶å¼‚æ­¥å¤„ç†ä»»åŠ¡&lt;/h5&gt;
&lt;p&gt;æœ¬å°èŠ‚å¯¹åº”ä¸Šé¢æ­¥éª¤çš„åä¸‰æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±æ˜¯å®šæ—¶å¼‚æ­¥å¤„ç†ä»»åŠ¡ ã€‚&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;å¤„ç†ä»»åŠ¡ï¼Œå³è°ƒç”¨ XxNodeService çš„ pushXxxNode æ–¹æ³•ï¼Œå³é€šè¿‡ ConnectionHandler è·å–æ‰€æœ‰çš„èŠ‚ç‚¹è¿æ¥ï¼Œå‘é€èŠ‚ç‚¹åˆ—è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;æ”¶åˆ°å›å¤åï¼Œå¦‚æœéœ€è¦ç¡®è®¤ï¼Œåˆ™ä¼šè°ƒç”¨&lt;code&gt;StoreService#confirmNodeStatus&lt;/code&gt; æ–¹æ³•ï¼Œå°†è¯¥èŠ‚ç‚¹ä»expectNodesä¸­ç§»é™¤ï¼›&lt;/li&gt;
&lt;li&gt;å¾…æ‰€æœ‰çš„èŠ‚ç‚¹ä» expectNodes ä¸­ç§»é™¤ï¼Œåˆ™å°†æ­¤æ¬¡æ“ä½œä» expectNodesOrders ç§»é™¤ï¼Œå¤„ç†å®Œæ¯•ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class DataNodeServiceImpl implements DataNodeService {
    @Override
    public void pushDataNodes(NodeChangeResult nodeChangeResult, Map&amp;lt;String, DataNode&amp;gt; targetNodes,
                              boolean confirm, String confirmNodeIp) {

        if (nodeChangeResult != null) {
            NodeConnectManager nodeConnectManager = getNodeConnectManager();
            Collection&amp;lt;InetSocketAddress&amp;gt; connections = nodeConnectManager.getConnections(null);

            // add register confirm
            StoreService storeService = ServiceFactory.getStoreService(NodeType.DATA);
            DataCenterNodes dataCenterNodes = storeService.getDataCenterNodes();
            Map&amp;lt;String, DataNode&amp;gt; registeredNodes = dataCenterNodes.getNodes();

            // é€šè¿‡ ConnectionHandler è·å–æ‰€æœ‰çš„èŠ‚ç‚¹è¿æ¥ï¼Œå‘é€èŠ‚ç‚¹åˆ—è¡¨ï¼›
            for (InetSocketAddress address : connections) {
                try {
                    Request&amp;lt;NodeChangeResult&amp;gt; nodeChangeRequestRequest = new Request&amp;lt;NodeChangeResult&amp;gt;() {
                        @Override
                        public NodeChangeResult getRequestBody() {
                            return nodeChangeResult;
                        }

                        @Override
                        public URL getRequestUrl() {
                            return new URL(address);
                        }
                    };
                    // å‘é€èŠ‚ç‚¹åˆ—è¡¨ï¼›
                    Response response = dataNodeExchanger.request(nodeChangeRequestRequest);

                    if (confirm) {
                        Object result = response.getResult();
                        if (result instanceof CommonResponse) {
                            CommonResponse genericResponse = (CommonResponse) result;
                            if (genericResponse.isSuccess()) {
                             // æ”¶åˆ°å›å¤åï¼Œå¦‚æœéœ€è¦ç¡®è®¤ï¼Œåˆ™ä¼šè°ƒç”¨`StoreService#confirmNodeStatus` æ–¹æ³•ï¼Œå°†è¯¥èŠ‚ç‚¹ä»expectNodesä¸­ç§»é™¤ï¼›
                                confirmStatus(address, confirmNodeIp);
                            }
                        } 
                    }

                } 
            }
        }
    }  
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶å †æ ˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;pushDataNodes:73, DataNodeServiceImpl (com.alipay.sofa.registry.server.meta.node.impl)
execute:86, DataNodeChangePushTask (com.alipay.sofa.registry.server.meta.task)
process:41, DataNodeSingleTaskProcessor (com.alipay.sofa.registry.server.meta.task.processor)
process:32, DataNodeSingleTaskProcessor (com.alipay.sofa.registry.server.meta.task.processor)
run:136, TaskExecutors$WorkerRunnable (com.alipay.sofa.registry.task.batcher)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h5 id=&quot;2143-ç¡®è®¤æ­¥éª¤&quot;&gt;2.1.4.3 ç¡®è®¤æ­¥éª¤&lt;/h5&gt;
&lt;p&gt;è¿›ä¸€æ­¥ç»†åŒ–ä¸Šæ–‡æåˆ°çš„ â€œç¡®è®¤æ­¥éª¤â€&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;private void confirmStatus(InetSocketAddress address, String confirmNodeIp) {
    String ipAddress = address.getAddress().getHostAddress();
    dataStoreService.confirmNodeStatus(ipAddress, confirmNodeIp);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶åæ˜¯ DataStoreService&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;æ”¶åˆ°å›å¤åï¼Œå¦‚æœéœ€è¦ç¡®è®¤ï¼Œåˆ™ä¼šè°ƒç”¨&lt;code&gt;StoreService#confirmNodeStatus&lt;/code&gt; æ–¹æ³•ï¼Œå°†è¯¥èŠ‚ç‚¹ä»expectNodesä¸­ç§»é™¤ï¼›&lt;/li&gt;
&lt;li&gt;å¾…æ‰€æœ‰çš„èŠ‚ç‚¹ä» expectNodes ä¸­ç§»é™¤ï¼Œåˆ™å°†æ­¤æ¬¡æ“ä½œä» expectNodesOrders ç§»é™¤ï¼Œå¤„ç†å®Œæ¯•ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void confirmNodeStatus(String ipAddress, String confirmNodeIp) {
    NodeOperator&amp;lt;DataNode&amp;gt; fireNode = dataConfirmStatusService.peekConfirmNode();
    if (fireNode != null) {
        String fireNodeIp = fireNode.getNode().getIp();
        Map&amp;lt;String/*ipAddress*/, DataNode&amp;gt; waitNotifyNodes = dataConfirmStatusService
            .getExpectNodes(fireNode.getNode());

        if (waitNotifyNodes != null) {
            Set&amp;lt;String&amp;gt; removeIp = getRemoveIp(waitNotifyNodes.keySet());
            removeIp.add(ipAddress);

            // å°†è¯¥èŠ‚ç‚¹ä»expectNodesä¸­ç§»é™¤ï¼›
            waitNotifyNodes = dataConfirmStatusService.removeExpectConfirmNodes(
                fireNode.getNode(), removeIp);

            if (waitNotifyNodes.isEmpty()) {
                //all node be notified,or some disconnect node be evict
                try {
                    // å¾…æ‰€æœ‰çš„èŠ‚ç‚¹ä» expectNodes ä¸­ç§»é™¤ï¼Œåˆ™å°†æ­¤æ¬¡æ“ä½œä» expectNodesOrders ç§»é™¤ï¼Œå¤„ç†å®Œæ¯•ï¼›
                    if (null != dataConfirmStatusService
                        .removeExpectNodes((dataConfirmStatusService.pollConfirmNode())
                            .getNode())) {
                        //add init status must notify
                        if (fireNode.getNodeOperate() == DataOperator.ADD) {
                            notifyConfirm(fireNode.getNode());
                        }
                    }
                }
            }
        } else {
            try {
                //wait node not exist,
                dataConfirmStatusService.pollConfirmNode();
            } 
        }
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h5 id=&quot;2144-æ€»ç»“æ¶ˆè´¹æµç¨‹&quot;&gt;2.1.4.4 æ€»ç»“æ¶ˆè´¹æµç¨‹&lt;/h5&gt;
&lt;p&gt;å¯¹äºæ¶ˆè´¹æµç¨‹ï¼Œæ€»ç»“å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-javascript&quot;&gt; +-------------------+        +-----------+         +------------------------+                                       +----------------+
 |ServiceStateMachine+------&amp;gt; | Processor | +-----&amp;gt; |DataConfirmStatusService|                                       |     loop       |
 +-------------------+        +-----------+         +-----+------------------+                                       v                |
                                                          |                                                   +------+------+         |
                                                          | put                                               |TaskExecutors|         |
                                                          v                                                   +------+------+         |
                                                 +--------+--------+   remo^e                                        |                |
                            +------------------&amp;gt; |expectNodesOrders| &amp;lt;-------+                                       |                |
                            | loop               +--------+--------+         |                                       v                |
                            |                             |                  |                          +------------+--------------+ |
                            |                             | peekConfirmNode  |                          |DataNodeSingleTaskProcessor| |
                            |                             |                  |                          +------------+--------------+ |
                            |                             |                  |                                       |                |
+---------------------------+--------------------+        v                  |                                       |                |
|               ExecutorManager                  |   +----+---+              |                                       v                |
| +--------------------------------------------+ |   |fireNode|              |                            +----------+-----------+    |
| |           TimedSuper^isorTask              | |   +----+---+              |                            |DataNodeChangePushTask|    |
| |  +---------------------------------------+ | |        |                  |                            +----------+-----------+    |
| |  | metaServerRegistry.pushNodeListChange | | |        | putExpectNodes   |                                       |                |
| |  +---------------------------------------+ | |        |                  |                                       |                |
| +--------------------------------------------+ |        v                  |                                       v                |
+------------------------------------------------+ +------+------+   remo^e  |                             +---------+---------+      |
                            ^                      | expectNodes | &amp;lt;---------+------------------&amp;lt;--------+ |DataNodeServiceImpl|      |
                            |                      +------+------+                                       | +---------+---------+      |
                            |                             |                                              |           |                |
                            |                             v                                              |           |                |
                            |               +-------------+--------+                                     |           v                |
                            |               | firePushDataListTask +-----------------------------------&amp;gt; |    +------+-------+        |
                            |               +-------------+--------+ taskListenerManager.sendTaskEvent   |    | StoreService |        |
                            |                             |                                              |    +------+-------+        ^
                            |                             v                                              |           |                |
                            |               +-------------+-----------+                                  |           v                |
                            ^&amp;lt;--------------+ firePushSessionListTask +--------------------------------&amp;gt; |     +-----+-------+        |
                                            +-------------------------+taskListenerManager.sendTaskEvent +-----+confirmStatus|        |
                                                                                                               +-----+-------+        |
                                                                                                                     |                |
                                                                                                                     &amp;gt;----------------+

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰‹æœºä¸Šå‚è§å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1850883/202010/1850883-20201009224427134-654536082.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h4 id=&quot;215-æ€»ç»“&quot;&gt;2.1.5 æ€»ç»“&lt;/h4&gt;
&lt;p&gt;æ•°æ®èŠ‚ç‚¹æ³¨å†Œæµç¨‹æ€»ç»“å¦‚ä¸‹å›¾ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;                                                                                                       +----------------------------+
                                                              put        +----------------------+      | Map(String, NodeRepository)|
                                                            +----------&amp;gt; |dataRepositoryService +----&amp;gt; | registry                   |
                                                            |            +----------------------+      +----------------------------+
                                                            |
                 register                   addNode         |
+----------------+      +------------------+        +-------+--------+
| DataNodeHandler+-----&amp;gt;+metaServerRegistry+-------&amp;gt;+DataStoreService|                                       TimedSupervisorTask
+----------------+      +------------------+        +-------+--------+
                                                            |            +------------------------+          +------------------+
                                                            +----------&amp;gt; |dataConfirmStatusService| +------&amp;gt; |pushNodeListChange|
                                                          putConfirmNode +------------------------+          +------------------+

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰‹æœºä¸Šå‚è§å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1850883/202010/1850883-20201009224450673-148329632.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;22--sessionnodehandler&quot;&gt;2.2 SessionNodeHandler&lt;/h3&gt;
&lt;p&gt;SessionèŠ‚ç‚¹çš„æ³¨å†Œå’ŒDataèŠ‚ç‚¹å‡ ä¹ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;SessionNodeHandler å®šä¹‰å¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class SessionNodeHandler extends AbstractServerHandler&amp;lt;SessionNode&amp;gt; {

    private static final Logger LOGGER = LoggerFactory.getLogger(SessionNodeHandler.class);

    @Autowired
    private Registry            metaServerRegistry;

    @Override
    public Object reply(Channel channel, SessionNode sessionNode) {
        NodeChangeResult nodeChangeResult;
        try {
            nodeChangeResult = metaServerRegistry.register(sessionNode);
        } 
        return nodeChangeResult;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶åæ˜¯è¿›è¡Œä¸šåŠ¡å¤„ç†çš„SessionStoreServiceã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class SessionStoreService implements StoreService&amp;lt;SessionNode&amp;gt; {
  
    @Override
    public NodeChangeResult addNode(SessionNode sessionNode) {

        write.lock();
        try {
            String ipAddress = sessionNode.getNodeUrl().getIpAddress();

            sessionRepositoryService.put(ipAddress, new RenewDecorate(sessionNode,
                RenewDecorate.DEFAULT_DURATION_SECS));

            sessionVersionRepositoryService.checkAndUpdateVersions(nodeConfig.getLocalDataCenter(),
                System.currentTimeMillis());

            renew(sessionNode, 30);
            sessionConfirmStatusService.putConfirmNode(sessionNode, DataOperator.ADD);

        } finally {
            write.unlock();
        }

        return dataStoreService.getNodeChangeResult();
    }
}

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶åæ˜¯SessionRepositoryServiceã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œè¿™é‡Œmapçš„keyæ˜¯ipï¼Œè¿™æ˜¯ä¸Dataä¸ä¸€è‡´çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@RaftService(uniqueId = &quot;sessionServer&quot;)
public class SessionRepositoryService extends AbstractSnapshotProcess
                                                                     implements
                                                                     RepositoryService&amp;lt;String, RenewDecorate&amp;lt;SessionNode&amp;gt;&amp;gt; {
    /**
     * session node store
     */
    private ConcurrentHashMap&amp;lt;String/*ipAddress*/, RenewDecorate&amp;lt;SessionNode&amp;gt;&amp;gt; registry          = new ConcurrentHashMap&amp;lt;&amp;gt;();
  
    @Override
    public RenewDecorate&amp;lt;SessionNode&amp;gt; put(String ipAddress, RenewDecorate&amp;lt;SessionNode&amp;gt; sessionNode,
                                          Long currentTimeMillis) {
        try {
            RenewDecorate oldRenewDecorate = registry.get(ipAddress);
            registry.put(ipAddress, sessionNode);
        }
        return sessionNode;
    }  
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç”±ä¸ŠèŠ‚å¯çŸ¥ï¼ŒDataServer å’Œ SessionServer éƒ½æœ‰å¤„ç†èŠ‚ç‚¹æ³¨å†Œè¯·æ±‚çš„ Handlerã€‚æ³¨å†Œè¡Œä¸ºç”± Registry å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ metaServerHandlersã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Bean(name = &quot;metaServerHandlers&quot;)
public Collection&amp;lt;AbstractServerHandler&amp;gt; metaServerHandlers() {
    Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
    list.add(metaConnectionHandler());
    list.add(getNodesRequestHandler());
    return list;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;0x03-æ³¨å†Œä¿¡æ¯ç»­çº¦&quot;&gt;0x03 æ³¨å†Œä¿¡æ¯ç»­çº¦&lt;/h2&gt;
&lt;h3 id=&quot;31-å…³é”®ç±»-renewdecorate&quot;&gt;3.1 å…³é”®ç±» RenewDecorate&lt;/h3&gt;
&lt;p&gt;èŠ‚ç‚¹æ³¨å†Œçš„æ—¶å€™ï¼ŒèŠ‚ç‚¹ä¿¡æ¯è¢« &lt;code&gt;RenewDecorate&lt;/code&gt; åŒ…è£…èµ·æ¥äº†ï¼Œè¿™ä¸ªå°±æ˜¯å®ç°æ³¨å†Œä¿¡æ¯ç»­çº¦å’Œé©±é€çš„å…³é”®ï¼Œè¯¥ç±»å®šä¹‰ å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class RenewDecorate&amp;lt;T&amp;gt; implements Serializable {
    public static final int DEFAULT_DURATION_SECS = 15;
    private T               renewal;  // èŠ‚ç‚¹å¯¹è±¡å°è£…
    private long            beginTimestamp; // æ³¨å†Œäº‹ä»¶
    private volatile long   lastUpdateTimestamp; // ç»­çº¦æ—¶é—´
    private long            duration; // è¶…æ—¶æ—¶é—´
  
    public boolean isExpired() {
        return System.currentTimeMillis() &amp;gt; lastUpdateTimestamp + duration;
    }

    public void renew() {
        lastUpdateTimestamp = System.currentTimeMillis() + duration;
    }

    public void renew(long durationSECS) {
        lastUpdateTimestamp = System.currentTimeMillis() + durationSECS * 1000;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¥å¯¹è±¡ä¸ºæ³¨å†ŒèŠ‚ç‚¹ä¿¡æ¯ï¼Œé™„åŠ äº†æ³¨å†Œæ—¶é—´ã€ä¸Šæ¬¡ç»­çº¦æ—¶é—´ã€è¿‡æœŸæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ç»­çº¦æ“ä½œå°±æ˜¯ä¿®æ”¹&lt;code&gt;lastUpdateTimestamp&lt;/code&gt;ï¼Œæ˜¯å¦è¿‡æœŸå°±æ˜¯åˆ¤æ–­&lt;code&gt;System.currentTimeMillis() - lastUpdateTimestamp &amp;gt; duration&lt;/code&gt; æ˜¯å¦æˆç«‹ï¼Œæˆç«‹åˆ™è®¤ä¸ºèŠ‚ç‚¹è¶…æ—¶è¿›è¡Œé©±é€ã€‚&lt;/p&gt;
&lt;h3 id=&quot;32-æ‰§è¡Œè·¯å¾„&quot;&gt;3.2 æ‰§è¡Œè·¯å¾„&lt;/h3&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œrenewå¯ä»¥ä»å¤šæ¡æ‰§è¡Œè·¯å¾„è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è·¯å¾„ä¸€ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;renew:70, RenewDecorate (com.alipay.sofa.registry.server.meta.store)
replace:176, DataRepositoryService (com.alipay.sofa.registry.server.meta.repository.service)
replace:45, DataRepositoryService (com.alipay.sofa.registry.server.meta.repository.service)
replace:39, RepositoryService (com.alipay.sofa.registry.server.meta.repository)
invokeInterface_L3_L:-1, 1889671331 (java.lang.invoke.LambdaForm$DMH)
reinvoke:-1, 171310548 (java.lang.invoke.LambdaForm$BMH)
invoker:-1, 559310456 (java.lang.invoke.LambdaForm$MH)
invokeExact_MT:-1, 426124479 (java.lang.invoke.LambdaForm$MH)
invokeWithArguments:627, MethodHandle (java.lang.invoke)
process:123, Processor (com.alipay.sofa.registry.jraft.processor)
onApply:133, ServiceStateMachine (com.alipay.sofa.registry.jraft.bootstrap)
doApplyTasks:534, FSMCallerImpl (com.alipay.sofa.jraft.core)
doCommitted:503, FSMCallerImpl (com.alipay.sofa.jraft.core)
runApplyTask:431, FSMCallerImpl (com.alipay.sofa.jraft.core)
access$100:72, FSMCallerImpl (com.alipay.sofa.jraft.core)
onEvent:147, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
onEvent:141, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
run:137, BatchEventProcessor (com.lmax.disruptor)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è·¯å¾„äºŒï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;renew:171, DataStoreService (com.alipay.sofa.registry.server.meta.store)
addNode:111, DataStoreService (com.alipay.sofa.registry.server.meta.store)
addNode:60, DataStoreService (com.alipay.sofa.registry.server.meta.store)
register:52, MetaServerRegistry (com.alipay.sofa.registry.server.meta.registry)
reply:43, DataNodeHandler (com.alipay.sofa.registry.server.meta.remoting.handler)
reply:32, DataNodeHandler (com.alipay.sofa.registry.server.meta.remoting.handler)
handleRequest:54, SyncUserProcessorAdapter (com.alipay.sofa.registry.remoting.bolt)
dispatchToUserProcessor:239, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
doProcess:145, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
run:366, RpcRequestProcessor$ProcessTask (com.alipay.remoting.rpc.protocol)
runWorker:1149, ThreadPoolExecutor (java.util.concurrent)
run:624, ThreadPoolExecutor$Worker (java.util.concurrent)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¯”å¦‚åœ¨ DataStoreService ä¹‹ä¸­&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public NodeChangeResult addNode(DataNode dataNode) {
    NodeChangeResult nodeChangeResult;
    String ipAddress = dataNode.getNodeUrl().getIpAddress();
    write.lock();
    try {
        dataRepositoryService.put(ipAddress, new RenewDecorate(dataNode,
            RenewDecorate.DEFAULT_DURATION_SECS));
        renew(dataNode, 30);  // ç»­çº¦ 
        nodeChangeResult = getNodeChangeResult();
        dataConfirmStatusService.putConfirmNode(dataNode, DataOperator.ADD);
    } finally {
        write.unlock();
    }
    return nodeChangeResult;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿›è€Œè°ƒç”¨renew&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void renew(DataNode dataNode, int duration) {
    write.lock();
    try {
        String ipAddress = dataNode.getNodeUrl().getIpAddress();
        RenewDecorate renewer = dataRepositoryService.get(ipAddress);
        if (renewer == null) {
            addNode(dataNode); // æ–°å¢ 
        } else {
            // ç»­çº¦
            if (duration &amp;gt; 0) {
                dataRepositoryService.replace(ipAddress, new RenewDecorate(dataNode, duration));
            } else {
                dataRepositoryService.replace(ipAddress, new RenewDecorate(dataNode,
                    RenewDecorate.DEFAULT_DURATION_SECS));
            }

        }
    } finally {
        write.unlock();
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å› ä¸ºæ˜¯Raftå¯¹Repositoryè¿›è¡Œæ•°æ®ä¸€è‡´æ€§ç»´æŠ¤ï¼Œæ‰€ä»¥ dataRepositoryService.replace ä¼šè¢« Proxy æ›¿æ¢ï¼Œè¿›è€Œæ¥åˆ°äº†ProxyHandlerã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public Object invoke(Object proxy, Method method, Object[] args) {
    try {
        ProcessRequest request = new ProcessRequest();
        request.setMethodArgSigs(createParamSignature(method.getParameterTypes()));
        request.setMethodName(method.getName());
        request.setMethodArgs(args);
        request.setServiceName(serviceId);

        if (Processor.getInstance().isLeaderReadMethod(method)) {
            return doInvokeMethod(request);
        }
        return client.sendRequest(request);
    } 
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å½“ Raft æ¥åˆ° &lt;strong&gt;æœåŠ¡ç«¯&lt;/strong&gt;ï¼Œå †æ ˆå¦‚ä¸‹ ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;replace:165, DataRepositoryService (com.alipay.sofa.registry.server.meta.repository.service)
replace:45, DataRepositoryService (com.alipay.sofa.registry.server.meta.repository.service)
replace:39, RepositoryService (com.alipay.sofa.registry.server.meta.repository)
invokeInterface_L3_L:-1, 1177311202 (java.lang.invoke.LambdaForm$DMH)
reinvoke:-1, 960369282 (java.lang.invoke.LambdaForm$BMH)
invoker:-1, 198860519 (java.lang.invoke.LambdaForm$MH)
invokeExact_MT:-1, 2035225037 (java.lang.invoke.LambdaForm$MH)
invokeWithArguments:627, MethodHandle (java.lang.invoke)
process:123, Processor (com.alipay.sofa.registry.jraft.processor)
onApply:133, ServiceStateMachine (com.alipay.sofa.registry.jraft.bootstrap)
doApplyTasks:534, FSMCallerImpl (com.alipay.sofa.jraft.core)
doCommitted:503, FSMCallerImpl (com.alipay.sofa.jraft.core)
runApplyTask:431, FSMCallerImpl (com.alipay.sofa.jraft.core)
access$100:72, FSMCallerImpl (com.alipay.sofa.jraft.core)
onEvent:147, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
onEvent:141, FSMCallerImpl$ApplyTaskHandler (com.alipay.sofa.jraft.core)
run:137, BatchEventProcessor (com.lmax.disruptor)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“renewä»£ç å¦‚ä¸‹ï¼Œè¿™æ ·å°±æœ€ç»ˆå®Œæˆäº†æ›´æ–°ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public RenewDecorate&amp;lt;DataNode&amp;gt; replace(String ipAddress, RenewDecorate&amp;lt;DataNode&amp;gt; dataNode,
                                       Long currentTimeMillis) {
    try {
        String dataCenter = dataNode.getRenewal().getDataCenter();
        NodeRepository&amp;lt;DataNode&amp;gt; dataNodeRepository = registry.get(dataCenter);

        if (dataNodeRepository != null) {
            Map&amp;lt;String/*ipAddress*/, RenewDecorate&amp;lt;DataNode&amp;gt;&amp;gt; dataNodes = dataNodeRepository
                .getNodeMap();
            RenewDecorate&amp;lt;DataNode&amp;gt; oldRenewDecorate = dataNodes.get(ipAddress);
            if (oldRenewDecorate != null &amp;amp;&amp;amp; oldRenewDecorate.getRenewal() != null) {
                oldRenewDecorate.setRenewal(dataNode.getRenewal());
                oldRenewDecorate.renew();
            } 
        } 
        return dataNode;
    } 
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“å¦‚ä¸‹å›¾&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;+---------------------------------------+        +---------------------------------------------+
| +------------------------------+      |        |       +----------------------------------+  |
| | +----------------+  registry |Client|        | Server| +----------------------+registry |  |
| | |DataStoreService|           |      |        |       | | DataRepositoryService|         |  |
| | +-----+----------+           |      |        |       | +---------+------------+         |  |
| |       | replace              |      |        |       |           ^  replace             |  |
| |       |                      |      |        |       |           |                      |  |
| |       v                      |      |        |       |    +------+----+                 |  |
| | +-----+--------------------+ |      |        |       |    | Processor |                 |  |
| | |DataRepositoryService stub| |      |        |       |    +------+----+                 |  |
| | +-----+--------------------+ |      |        |       |           ^  onApply             |  |
| |       |                      |      |        |       |           |                      |  |
| |       v                      |      |        |       |   +-------+------+               |  |
| |     +-+---+                  |      |        |       |   | StateMachine |               |  |
| |     |Proxy|                  |      |        |       |   +-------+------+               |  |
| |     +-+---+                  |      |        |       |           ^  process             |  |
| |       | invoke               |      |        |       |           |                      |  |
| |       v                      |      |        |       |           |                      |  |
| |  +----+-------+              |      |        |       |    +------+------+               |  |
| |  |ProxyHandler|              |      |        |       |    |FSMCallerImpl|               |  |
| |  +----+-------+              |      |        |       |    +------+------+               |  |
| |       | sendRequest          |      |        |       |           ^                      |  |
| |       v                      |      |        |       |           |  received            |  |
| |   +---+------+               |      |        |       |           |                      |  |
| |   |RaftClient|               |      |        |       |   +-----------------+            |  |
| |   +----------+               |      | network|       |   |RaftServerHandler|            |  |
| |                              | +-------------------&amp;gt; |   +-----------------+            |  |
| +------------------------------+      |        |       +----------------------------------+  |
|                                       |        |                                             |
+---------------------------------------+        +---------------------------------------------+

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰‹æœºä¸Šå¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1850883/202010/1850883-20201009224518218-1316861681.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;33-renewnodesrequesthandler&quot;&gt;3.3 ReNewNodesRequestHandler&lt;/h3&gt;
&lt;p&gt;å’Œæ³¨å†Œä¸€æ ·ï¼Œç»­çº¦è¯·æ±‚çš„å¤„ç† Handler ä¸º&lt;code&gt;ReNewNodesRequestHandler&lt;/code&gt;ï¼Œæœ€ç»ˆäº¤ç”± StoreService è¿›è¡Œç»­çº¦æ“ä½œã€‚å¦å¤–ä¸€ç‚¹ï¼Œç»­çº¦çš„æ—¶å€™å¦‚æœæ²¡æœ‰æŸ¥è¯¢åˆ°æ³¨å†ŒèŠ‚ç‚¹ï¼Œä¼šè§¦å‘èŠ‚ç‚¹æ³¨å†Œçš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åˆå§‹åŒ–æ—¶å€™ï¼Œå°±è®¾ç½®äº†ReNew handlerã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;        @Bean(name = &quot;sessionServerHandlers&quot;)
        public Collection&amp;lt;AbstractServerHandler&amp;gt; sessionServerHandlers() {
            Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
            list.add(sessionConnectionHandler());
            list.add(sessionNodeHandler());
            list.add(renewNodesRequestHandler()); // æ³¨å†Œåˆ°Server handler
            list.add(getNodesRequestHandler());
            list.add(fetchProvideDataRequestHandler());
            return list;
        }

        @Bean(name = &quot;dataServerHandlers&quot;)
        public Collection&amp;lt;AbstractServerHandler&amp;gt; dataServerHandlers() {
            Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
            list.add(dataConnectionHandler());
            list.add(getNodesRequestHandler());
            list.add(dataNodeHandler());
            list.add(renewNodesRequestHandler()); // æ³¨å†Œåˆ°Server handler
            list.add(fetchProvideDataRequestHandler());
            return list;
        }

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class RenewNodesRequestHandler extends AbstractServerHandler&amp;lt;RenewNodesRequest&amp;gt; {
    @Autowired
    private Registry            metaServerRegistry;

    @Override
    public Object reply(Channel channel, RenewNodesRequest renewNodesRequest) {
        Node renewNode = null;
        renewNode = renewNodesRequest.getNode();
        metaServerRegistry.renew(renewNode, renewNodesRequest.getDuration());
        return null;
    }

    @Override
    public Class interest() {
        return RenewNodesRequest.class;
    }

    @Override
    public HandlerType getType() {
        return HandlerType.PROCESSER;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;0x04-é©±é™¤&quot;&gt;0x04 é©±é™¤&lt;/h2&gt;
&lt;p&gt;é©±å‡ºçš„æ“ä½œæ˜¯ç”±å®šæ—¶ä»»åŠ¡å®Œæˆï¼ŒMetaServer åœ¨å¯åŠ¨æ—¶ä¼šå¯åŠ¨å¤šä¸ªå®šæ—¶ä»»åŠ¡ï¼Œè¯¦è§&lt;code&gt;ExecutorManager#startScheduler&lt;/code&gt;ï¼Œå…¶ä¸­ä¸€ä¸ªä»»åŠ¡ä¼šè°ƒç”¨&lt;code&gt;Registry#evict&lt;/code&gt;ï¼Œå…¶å®ç°ä¸ºéå†å­˜å‚¨çš„ Map, è·å¾—è¿‡æœŸçš„åˆ—è¡¨ï¼Œè°ƒç”¨&lt;code&gt;StoreService#removeNodes&lt;/code&gt;æ–¹æ³•ï¼Œå°†ä»–ä»¬ä» &lt;code&gt;Repository&lt;/code&gt; ä¸­ç§»é™¤ï¼Œ&lt;u&gt;è¿™ä¸ªæ“ä½œä¹Ÿä¼šè§¦å‘å˜æ›´é€šçŸ¥&lt;/u&gt;ã€‚è¯¥ä»»åŠ¡é»˜è®¤æ¯3ç§’æ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;h3 id=&quot;41-é…ç½®&quot;&gt;4.1 é…ç½®&lt;/h3&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public void startScheduler() {
    scheduler.schedule(new TimedSupervisorTask(&quot;HeartbeatCheck&quot;, scheduler, heartbeatCheckExecutor,
                    metaServerConfig.getSchedulerHeartbeatTimeout(), TimeUnit.SECONDS,
                    metaServerConfig.getSchedulerHeartbeatExpBackOffBound(), () -&amp;gt; metaServerRegistry.evict()),
            metaServerConfig.getSchedulerHeartbeatFirstDelay(), TimeUnit.SECONDS);
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;42-é©±é™¤&quot;&gt;4.2 é©±é™¤&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œå°±æ˜¯éå†å„ç§StoreServiceï¼Œè·å–å…¶ä¸­çš„è¿‡æœŸèŠ‚ç‚¹ï¼Œç„¶åè¿›è¡Œé©±é™¤ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaServerRegistry implements Registry&amp;lt;Node&amp;gt; {
    @Override
    public void evict() {
        for (NodeType nodeType : NodeType.values()) {
            StoreService storeService = ServiceFactory.getStoreService(nodeType);
            if (storeService != null) {
                Collection&amp;lt;Node&amp;gt; expiredNodes = storeService.getExpired();
                if (expiredNodes != null &amp;amp;&amp;amp; !expiredNodes.isEmpty()) {
                    storeService.removeNodes(expiredNodes);
                }
            }
        }
    }  
}    
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“åˆä¼šç»§ç»­è°ƒç”¨ DataStoreServiceã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public void removeNodes(Collection&amp;lt;DataNode&amp;gt; nodes) {
    write.lock();
    try {
        if (nodes != null &amp;amp;&amp;amp; !nodes.isEmpty()) {
            for (DataNode dataNode : nodes) {
                String ipAddress = dataNode.getNodeUrl().getIpAddress();
                RenewDecorate&amp;lt;DataNode&amp;gt; dataNodeRemove = dataRepositoryService
                    .remove(ipAddress);
                if (dataNodeRemove != null) {
                    dataConfirmStatusService.putConfirmNode(dataNode, DataOperator.REMOVE);
                }
            }
        }
    } finally {
        write.unlock();
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æœ€åè°ƒç”¨åˆ° DataRepositoryService&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Override
public RenewDecorate&amp;lt;DataNode&amp;gt; remove(Object key, Long currentTimeMillis) {
    try {
        String ipAddress = (String) key;
        String dataCenter = nodeConfig.getLocalDataCenter();

        NodeRepository&amp;lt;DataNode&amp;gt; dataNodeRepository = registry.get(dataCenter);
        if (dataNodeRepository != null) {
            Map&amp;lt;String/*ipAddress*/, RenewDecorate&amp;lt;DataNode&amp;gt;&amp;gt; dataNodes = dataNodeRepository
                .getNodeMap();
            if (dataNodes != null) {
                RenewDecorate&amp;lt;DataNode&amp;gt; oldRenewDecorate = dataNodes.remove(ipAddress);
                dataNodeRepository.setVersion(currentTimeMillis);
                return oldRenewDecorate;
            }
        }
    } 
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;0x05-èŠ‚ç‚¹åˆ—è¡¨æŸ¥è¯¢&quot;&gt;0x05 èŠ‚ç‚¹åˆ—è¡¨æŸ¥è¯¢&lt;/h2&gt;
&lt;p&gt;Dataï¼ŒMeta, Session Server éƒ½æä¾› &lt;code&gt;getNodesRequestHandler&lt;/code&gt; ï¼Œç”¨äºå¤„ç†æŸ¥è¯¢å½“å‰èŠ‚ç‚¹åˆ—è¡¨çš„è¯·æ±‚ï¼Œå…¶æœ¬è´¨ä¸Šä»åº•å±‚å­˜å‚¨ Repository è¯»å–æ•°æ®è¿”å›ã€‚è¿”å›çš„ç»“æœçš„å…·ä½“ç»“æ„è§ &lt;code&gt;NodeChangeResult&lt;/code&gt; ç±»ï¼ŒåŒ…å«å„ä¸ªæ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹åˆ—è¡¨ä»¥åŠç‰ˆæœ¬å·ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class NodeChangeResult&amp;lt;T extends Node&amp;gt; implements Serializable {
    private final NodeType                                               nodeType;
    private Map&amp;lt;String/*dataCenter id*/, Map&amp;lt;String /*ipAddress*/, T&amp;gt;&amp;gt; nodes;
    private Long                                                         version;
    private Map&amp;lt;String/*dataCenter*/, Long /*version*/&amp;gt;                dataCenterListVersions;
    /** local dataCenter id */
    private String                                                       localDataCenter;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;51-é…ç½®&quot;&gt;5.1 é…ç½®&lt;/h3&gt;
&lt;p&gt;Dataï¼ŒMetaï¼ŒSession Server éƒ½æä¾› &lt;code&gt;getNodesRequestHandler&lt;/code&gt;ã€‚å…·ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Bean(name = &quot;sessionServerHandlers&quot;)
public Collection&amp;lt;AbstractServerHandler&amp;gt; sessionServerHandlers() {
    Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
    list.add(sessionConnectionHandler());
    list.add(sessionNodeHandler());
    list.add(renewNodesRequestHandler());
    list.add(getNodesRequestHandler()); // åšäº†é…ç½®
    list.add(fetchProvideDataRequestHandler());
    return list;
}

@Bean(name = &quot;dataServerHandlers&quot;)
public Collection&amp;lt;AbstractServerHandler&amp;gt; dataServerHandlers() {
    Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
    list.add(dataConnectionHandler());
    list.add(getNodesRequestHandler()); // åšäº†é…ç½®
    list.add(dataNodeHandler());
    list.add(renewNodesRequestHandler()); 
    list.add(fetchProvideDataRequestHandler());
    return list;
}

@Bean(name = &quot;metaServerHandlers&quot;)
public Collection&amp;lt;AbstractServerHandler&amp;gt; metaServerHandlers() {
    Collection&amp;lt;AbstractServerHandler&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
    list.add(metaConnectionHandler());
    list.add(getNodesRequestHandler()); // åšäº†é…ç½®
    return list;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;getNodesRequestHandlerçš„Beané…ç½®ç”Ÿæˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Configuration
public static class MetaServerRemotingConfiguration {
        @Bean
        public AbstractServerHandler getNodesRequestHandler() {
            return new GetNodesRequestHandler();
        }  
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;52-å“åº”handler&quot;&gt;5.2 å“åº”handler&lt;/h3&gt;
&lt;p&gt;NodesRequest æ˜¯é€šè¿‡Boltæ¥å“åº”æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class GetNodesRequestHandler extends AbstractServerHandler&amp;lt;GetNodesRequest&amp;gt; {
    @Autowired
    private Registry            metaServerRegistry;

    @Override
    public Object reply(Channel channel, GetNodesRequest getNodesRequest) {
        NodeChangeResult nodeChangeResult;
        try {
            nodeChangeResult = metaServerRegistry.getAllNodes(getNodesRequest.getNodeType());
        } 
        return nodeChangeResult;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å †æ ˆä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;getNodeChangeResult:188, MetaStoreService (com.alipay.sofa.registry.server.meta.store)
getAllNodes:96, MetaServerRegistry (com.alipay.sofa.registry.server.meta.registry)
reply:44, GetNodesRequestHandler (com.alipay.sofa.registry.server.meta.remoting.handler)
reply:33, GetNodesRequestHandler (com.alipay.sofa.registry.server.meta.remoting.handler)
handleRequest:54, SyncUserProcessorAdapter (com.alipay.sofa.registry.remoting.bolt)
dispatchToUserProcessor:239, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
doProcess:145, RpcRequestProcessor (com.alipay.remoting.rpc.protocol)
run:366, RpcRequestProcessor$ProcessTask (com.alipay.remoting.rpc.protocol)
runWorker:1149, ThreadPoolExecutor (java.util.concurrent)
run:624, ThreadPoolExecutor$Worker (java.util.concurrent)
run:748, Thread (java.lang)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;                      +-------------------------+
                      | SyncUserProcessorAdapter|
                      +-----------+-------------+
                                  |
                                  |
                                  v  handleRequest
                       +----------+-----------+
                       |GetNodesRequestHandler|
                       +----------+-----------+
                                  |
                                  |
                                  v  getAllNodes
                         +--------+---------+
                         |MetaServerRegistry|
                         +--------+---------+
                                  |
                                  |
                                  v  getNodeChangeResult
                          +-------+--------+
                          |MetaStoreService|
                          +----+------+----+
                               |      |
                   +-----------+      +------------+
                   |                               |
      getNodeMap   v                               v  getNodeMap
+------------------+-----------+        +----------+-------------------+
|dataCenter, metaNodeRepository|  ...   |dataCenter, metaNodeRepository|
+------------------------------+        +------------------------------+

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å†å…·ä½“æ·±å…¥ä¸‹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;53-registryæ“ä½œ&quot;&gt;5.3 Registryæ“ä½œ&lt;/h3&gt;
&lt;p&gt;Registry åªæ˜¯ç®€å•è°ƒç”¨StoreServiceã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaServerRegistry implements Registry&amp;lt;Node&amp;gt; {
    @Override
    public NodeChangeResult getAllNodes(NodeType nodeType) {
        StoreService storeService = ServiceFactory.getStoreService(nodeType);
        return storeService.getNodeChangeResult();
    }  
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;54-storeserviceæ“ä½œ&quot;&gt;5.4 StoreServiceæ“ä½œ&lt;/h3&gt;
&lt;p&gt;Service ä¼šéå†æ•°æ®ä¸­å¿ƒï¼Œè·å–å¯¹åº”çš„Nodeåˆ—è¡¨ä»¥åŠversionï¼Œæœ€ç»ˆè¿”å›ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class MetaStoreService implements StoreService&amp;lt;MetaNode&amp;gt; {
    @Override
    public NodeChangeResult getNodeChangeResult() {

        NodeChangeResult nodeChangeResult = new NodeChangeResult(NodeType.META);
        String localDataCenter = nodeConfig.getLocalDataCenter();
        Map&amp;lt;String/*dataCenter*/, NodeRepository&amp;gt; metaRepositoryMap = metaRepositoryService.getNodeRepositories();
        ConcurrentHashMap&amp;lt;String/*dataCenter*/, Map&amp;lt;String/*ipAddress*/, MetaNode&amp;gt;&amp;gt; pushNodes = new ConcurrentHashMap&amp;lt;&amp;gt;();
        Map&amp;lt;String/*dataCenter*/, Long&amp;gt; versionMap = new ConcurrentHashMap&amp;lt;&amp;gt;();

        metaRepositoryMap.forEach((dataCenter, metaNodeRepository) -&amp;gt; {

            if (localDataCenter.equalsIgnoreCase(dataCenter)) {
                nodeChangeResult.setVersion(metaNodeRepository.getVersion());
            }
            versionMap.put(dataCenter, metaNodeRepository.getVersion());

            Map&amp;lt;String, RenewDecorate&amp;lt;MetaNode&amp;gt;&amp;gt; dataMap = metaNodeRepository.getNodeMap();
            Map&amp;lt;String, MetaNode&amp;gt; newMap = new ConcurrentHashMap&amp;lt;&amp;gt;();
            dataMap.forEach((ip, dataNode) -&amp;gt; newMap.put(ip, dataNode.getRenewal()));
            pushNodes.put(dataCenter, newMap);
        });

        nodeChangeResult.setLocalDataCenter(localDataCenter);
        nodeChangeResult.setNodes(pushNodes);
        nodeChangeResult.setDataCenterListVersions(versionMap);
        return nodeChangeResult;
    } 
}  
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æœ€åç»“æœæ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;nodeChangeResult = 
 nodeType = {Node$NodeType@7190} &quot;DATA&quot;
 nodes = {ConcurrentHashMap@8267}  size = 1
  &quot;DefaultDataCenter&quot; -&amp;gt; {ConcurrentHashMap@8276}  size = 0
   key = &quot;DefaultDataCenter&quot;
   value = {ConcurrentHashMap@8276}  size = 0
 version = {Long@8268} 1601126414990
 dataCenterListVersions = {ConcurrentHashMap@8269}  size = 1
  &quot;DefaultDataCenter&quot; -&amp;gt; {Long@8268} 1601126414990
   key = &quot;DefaultDataCenter&quot;
   value = {Long@8268} 1601126414990
 localDataCenter = &quot;DefaultDataCenter&quot;
  value = {char[17]@8280} 
  hash = 761435552
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;55-èŠ‚ç‚¹å˜æ›´æ—¶çš„æ•°æ®åŒæ­¥&quot;&gt;5.5 èŠ‚ç‚¹å˜æ›´æ—¶çš„æ•°æ®åŒæ­¥&lt;/h3&gt;
&lt;p&gt;MetaServer ä¼šé€šè¿‡ç½‘ç»œè¿æ¥æ„ŸçŸ¥åˆ°æ–°èŠ‚ç‚¹ä¸Šçº¿æˆ–è€…ä¸‹çº¿ï¼Œæ‰€æœ‰çš„ DataServer ä¸­è¿è¡Œç€ä¸€ä¸ªå®šæ—¶åˆ·æ–°è¿æ¥çš„ä»»åŠ¡ ConnectionRefreshTaskï¼Œè¯¥ä»»åŠ¡å®šæ—¶å»è½®è¯¢ MetaServerï¼Œè·å–æ•°æ®èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé™¤äº† DataServer ä¸»åŠ¨å» MetaServer æ‹‰å–èŠ‚ç‚¹ä¿¡æ¯å¤–ï¼ŒMetaServer ä¹Ÿä¼šä¸»åŠ¨å‘é€ NodeChangeResult è¯·æ±‚åˆ°å„ä¸ªèŠ‚ç‚¹ï¼Œé€šçŸ¥èŠ‚ç‚¹ä¿¡æ¯å‘ç”Ÿå˜åŒ–ï¼Œæ¨æ‹‰è·å–ä¿¡æ¯çš„æœ€ç»ˆæ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æåˆ°äº†å¾ˆå¤šRaftç›¸å…³ä¿¡æ¯ï¼Œä¸‹ç¯‡æ–‡ç« å°±å…·ä½“æ¢ç©¶ä¸‹ç©¶ç«ŸMetaServeræ˜¯å¦‚ä½•ä½¿ç”¨ Raftã€‚&lt;/p&gt;
&lt;h2 id=&quot;0xff-å‚è€ƒ&quot;&gt;0xFF å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-metaserver-function-introduction/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒ MetaServer åŠŸèƒ½ä»‹ç»å’Œå®ç°å‰–æ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-dataserver-smooth-expansion-contraction/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒå¦‚ä½•å®ç° DataServer å¹³æ»‘æ‰©ç¼©å®¹ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-data-consistency/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒæ•°æ®ä¸€è‡´æ€§æ–¹æ¡ˆåˆ†æ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-service-offline-notification/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒå¦‚ä½•å®ç°ç§’çº§æœåŠ¡ä¸Šä¸‹çº¿é€šçŸ¥ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-session-storage/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒ Session å­˜å‚¨ç­–ç•¥ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-data-fragmentation-synchronization-scheme/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒæ•°æ®åˆ†ç‰‡å’ŒåŒæ­¥æ–¹æ¡ˆè¯¦è§£ | SOFARegistry è§£æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-service-discovery-optimization/&quot;&gt;æœåŠ¡æ³¨å†Œä¸­å¿ƒ SOFARegistry è§£æ | æœåŠ¡å‘ç°ä¼˜åŒ–ä¹‹è·¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-registry-introduction/&quot;&gt;æµ·é‡æ•°æ®ä¸‹çš„æ³¨å†Œä¸­å¿ƒ - SOFARegistry æ¶æ„ä»‹ç»&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/projects/sofa-registry/server-quick-start/&quot;&gt;æœåŠ¡ç«¯éƒ¨ç½²&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/projects/sofa-registry/client-quick-start/&quot;&gt;å®¢æˆ·ç«¯ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/125573685&quot;&gt;å…¨é¢ç†è§£Raftåè®®&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ff00yo/article/details/89212859&quot;&gt;è¯¦è§£èš‚èšé‡‘æœ SOFAJRaft | ç”Ÿäº§çº§é«˜æ€§èƒ½ Java å®ç°&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/luozhiyun/p/13150808.html&quot;&gt;ä»JRaftæ¥çœ‹Raftåè®®å®ç°ç»†èŠ‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/luozhiyun/p/11627092.html&quot;&gt;SOFAJRaftâ€”åˆæ¬¡ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bookstack.cn/read/sofa-jraft/3.md&quot;&gt;JRaft ç”¨æˆ·æŒ‡å— &amp;amp; API è¯¦è§£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/bonelee/p/6228998.html&quot;&gt;æ€æ ·æ‰“é€ ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“â€”â€”rocksDB, raft, mvccï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ºäº†è§£å†³è·¨æ•°æ®ä¸­å¿ƒçš„å¤åˆ¶&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.bubuko.com/infodetail-3451565.html&quot;&gt;sofa-boltæºç é˜…è¯»(5)-æ—¥å¿—&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/mindwind/p/5231986.html&quot;&gt;Raft ä¸ºä»€ä¹ˆæ˜¯æ›´æ˜“ç†è§£çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://segmentfault.com/a/1190000022397988&quot;&gt;SOFAJRaft æºç åˆ†æä¸€ï¼ˆå¯åŠ¨æµç¨‹å’ŒèŠ‚ç‚¹å˜åŒ–ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/blog/sofa-jraft-algorithm-storage-module-deep-dive/&quot;&gt;SOFAJRaft å®ç°åŸç† - ç”Ÿäº§çº§ Raft ç®—æ³•åº“å­˜å‚¨æ¨¡å—å‰–æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sofastack.tech/projects/sofa-registry/client-quick-start/&quot;&gt;å®¢æˆ·ç«¯ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;</description>
<pubDate>Sun, 11 Oct 2020 00:37:00 +0000</pubDate>
<dc:creator>ç½—è¥¿çš„æ€è€ƒ</dc:creator>
<og:description>SOFARegistry æ˜¯èš‚èšé‡‘æœå¼€æºçš„ä¸€ä¸ªç”Ÿäº§çº§ã€é«˜æ—¶æ•ˆã€é«˜å¯ç”¨çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚æœ¬ç³»åˆ—å°†å¸¦é¢†å¤§å®¶ä¸€èµ·åˆ†æå…¶MetaServerçš„å®ç°æœºåˆ¶ï¼Œæœ¬æ–‡ä¸ºç¬¬äºŒç¯‡ï¼Œä»‹ç»MetaServeråŸºæœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚æ³¨å†Œï¼Œ</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/rossiXYZ/p/13789353.html</dc:identifier>
</item>
<item>
<title>æ´›è°·  P6851 ã€onuã€‘è´ªå¿ƒ - liuchanglc</title>
<link>http://www.cnblogs.com/liuchanglc/p/13796131.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/liuchanglc/p/13796131.html</guid>
<description>&lt;h2 id=&quot;é¢˜ç›®æè¿°&quot;&gt;é¢˜ç›®æè¿°&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.luogu.com.cn/problem/P6851&quot;&gt;é¢˜ç›®ä¼ é€é—¨&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;åˆ†æ&quot;&gt;åˆ†æ&lt;/h2&gt;
&lt;p&gt;å› ä¸ºå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; æ‰“å‡ºçš„ç‰Œä¸å° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; æ‰“å‡ºçš„ç‰ŒèŠ±è‰²å¿…é¡»ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‰ç…§èŠ±è‰²åˆ†ç±»è®¨è®º&lt;/p&gt;
&lt;p&gt;å¯¹äºæŸä¸€ç§èŠ±è‰²&lt;/p&gt;
&lt;p&gt;å¦‚æœå° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; æ²¡æœ‰è¿™ç§èŠ±è‰²çš„ç‰Œä½†æ˜¯å° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; æœ‰ï¼Œé‚£ä¹ˆå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„ç‰Œä¸€å®šæ‰“ä¸å‡ºå»ï¼Œç›´æ¥ &lt;span class=&quot;math inline&quot;&gt;\(continue\)&lt;/span&gt; æ‰&lt;/p&gt;
&lt;p&gt;å¦‚æœå° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; æœ‰è¿™ç§èŠ±è‰²çš„ç‰Œï¼Œé‚£ä¹ˆå¯¹äºå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; æ¥è¯´ï¼Œä»–è‚¯å®šæƒ³è®©ä»–èµ¢çš„æ¬¡æ•°å°½å¯èƒ½å¤š&lt;/p&gt;
&lt;p&gt;è¿™å…¶å®å°±æ˜¯ä¸€ä¸ªç”°å¿Œèµ›é©¬çš„é—®é¢˜&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠå° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; å’Œå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„ç‰ŒæŒ‰ç…§ç‚¹æ•°ä»å¤§åˆ°å°æ’åº&lt;/p&gt;
&lt;p&gt;å¯¹äºå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„æ¯ä¸€å¼ ç‰Œï¼Œæˆ‘ä»¬åœ¨å° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; å°äºç­‰äºè¿™å¼ ç‰Œç‚¹æ•°çš„ç‰Œé‡Œé€‰æ‹©ç‚¹æ•°æœ€å¤§çš„é‚£ä¸€å¼ ä¸å…¶é…å¯¹&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ¶ˆè€—ä¸€ä¸ªç‚¹æ•°å¤§çš„ç‰Œè‚¯å®šæ›´ä¼˜ï¼Œè¿™æ ·å¯ä»¥ä¸ºä¹‹åçš„ç‰Œåˆ›é€ æ›´å¤šçš„è·èƒœæœºä¼š&lt;/p&gt;
&lt;p&gt;å› ä¸ºå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„ç‰Œçš„ç‚¹æ•°æ˜¯å•è°ƒé€’å‡çš„ï¼Œæ‰€ä»¥é€‰å‡ºçš„ç‰Œçš„ç‚¹æ•°ä¹Ÿä¸€å®šæ˜¯å•è°ƒé€’å‡çš„&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆç»´æŠ¤&lt;/p&gt;
&lt;p&gt;è¿™æ ·åˆ°æœ€åå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„ç‰Œè¦ä¹ˆéƒ½æ‰“å…‰ï¼Œè¦ä¹ˆå‰©ä¸‹ä¸€äº›&lt;/p&gt;
&lt;p&gt;å¯¹äºå‰©ä¸‹çš„ç‰Œï¼Œæˆ‘ä»¬éšä¾¿é…å¯¹å°±å¯ä»¥äº†ï¼Œå› ä¸ºæ‰“å‡ºå»è‚¯å®šæ¯”ä¸æ‰“å‡ºå»æ›´ä¼˜&lt;/p&gt;
&lt;p&gt;åœ¨åŒ¹é…çš„è¿‡ç¨‹ä¸­å¦‚æœå° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; çš„ç‰Œä¸å¤Ÿç”¨ï¼Œé‚£ä¹ˆå°±åœæ­¢åŒ¹é…&lt;/p&gt;
&lt;p&gt;å¦‚æœå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; çš„ç‰Œæ‰“å…‰åå° &lt;span class=&quot;math inline&quot;&gt;\(C\)&lt;/span&gt; è¿˜å‰©ä¸‹ç‰Œï¼Œé‚£ä¹ˆå° &lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt; åªèƒ½é€‰æ‹©å¼ƒæƒ&lt;/p&gt;
&lt;h2 id=&quot;ä»£ç &quot;&gt;ä»£ç &lt;/h2&gt;
&lt;pre&gt;
&lt;code class=&quot;language-cpp&quot;&gt;#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;vector&amp;gt;
#include&amp;lt;cmath&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#define rg register
struct asd{
        int id,val;
        asd(){}
        asd(int aa,int bb){ id=aa,val=bb; }
};
bool cmp(asd aa,asd bb){
        return aa.val&amp;gt;bb.val;
}
const int maxn=1e5+5;
std::vector&amp;lt;asd&amp;gt; gd[maxn],gc[maxn];
int ans[maxn],n,m,maxid;
long long c,v;
bool vis[maxn];
void solve(int id){
        if(gc[id].size()==0) return;
        rg int head=0,js=0;
        for(rg int i=0;i&amp;lt;gd[id].size();i++){
                rg int cs=gd[id][i].val;
                if(head&amp;gt;=gc[id].size()) break;
                while(1){
                        if(gc[id][head].val&amp;gt;cs) head++;
                        if(head&amp;gt;=gc[id].size()) break;
                        if(gc[id][head].val&amp;lt;=cs){
                                ans[gc[id][head].id]=gd[id][i].id;
                                vis[gc[id][head].id]=1;
                                v=v+c+gd[id][i].val;
                                head++,js++;
                                break;
                        }
                }
        }
        for(rg int i=0;i&amp;lt;gc[id].size();i++){
                rg int now=gc[id][i].id;
                if(vis[now]) continue;
                if(js&amp;gt;=gd[id].size()){
                        ans[now]=-1;
                        vis[now]=1;
                        v=v-c;
                } else {
                        ans[now]=gd[id][js].id;
                        v=v-c+gd[id][js].val;
                        vis[now]=1;
                        js++;
                }
        }
}
int main(){
        scanf(&quot;%d%d%lld%lld&quot;,&amp;amp;n,&amp;amp;m,&amp;amp;c,&amp;amp;v);
        rg int aa,bb;
        for(rg int i=1;i&amp;lt;=n;i++){
                scanf(&quot;%d%d&quot;,&amp;amp;aa,&amp;amp;bb);
                gd[aa].push_back(asd(i,bb));
                maxid=std::max(maxid,aa);
        }
        for(rg int i=1;i&amp;lt;=m;i++){
                scanf(&quot;%d%d&quot;,&amp;amp;aa,&amp;amp;bb);
                gc[aa].push_back(asd(i,bb));
                maxid=std::max(maxid,aa);
        }
        for(rg int i=1;i&amp;lt;=maxid;i++){
                std::sort(gd[i].begin(),gd[i].end(),cmp);
                std::sort(gc[i].begin(),gc[i].end(),cmp);
        }
        for(rg int i=1;i&amp;lt;=maxid;i++) solve(i);
        printf(&quot;%lld\n&quot;,v);
        for(rg int i=1;i&amp;lt;=m;i++) printf(&quot;%d\n&quot;,ans[i]);
        return 0;
}
&lt;/code&gt;
&lt;/pre&gt;</description>
<pubDate>Sun, 11 Oct 2020 00:05:00 +0000</pubDate>
<dc:creator>liuchanglc</dc:creator>
<og:description>é¢˜ç›®æè¿° é¢˜ç›®ä¼ é€é—¨ åˆ†æ å› ä¸ºå° \(D\) æ‰“å‡ºçš„ç‰Œä¸å° \(C\) æ‰“å‡ºçš„ç‰ŒèŠ±è‰²å¿…é¡»ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‰ç…§èŠ±è‰²åˆ†ç±»è®¨è®º å¯¹äºæŸä¸€ç§èŠ±è‰² å¦‚æœå° \(C\) æ²¡æœ‰è¿™ç§èŠ±è‰²çš„ç‰Œä½†æ˜¯å° \(D\)	æœ‰</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/liuchanglc/p/13796131.html</dc:identifier>
</item>
<item>
<title>DX12é¾™ä¹¦ 01 - å‘é‡åœ¨å‡ ä½•å­¦å’Œæ•°å­¦ä¸­çš„è¡¨ç¤ºä»¥åŠè¿ç®—å®šä¹‰ - drnkcff</title>
<link>http://www.cnblogs.com/drnkcff/p/13795323.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/drnkcff/p/13795323.html</guid>
<description>&lt;hr/&gt;&lt;p&gt;å‘é‡ ( vector ) æ˜¯ä¸€ç§å…¼å…·å¤§å° ( magnitude ) å’Œæ–¹å‘çš„é‡ã€‚&lt;/p&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;å‡ ä½•æ–¹æ³•ä¸­ç”¨ä¸€æ¡æœ‰å‘çº¿æ®µæ¥è¡¨ç¤ºä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­ï¼Œçº¿æ®µé•¿åº¦ä»£è¡¨å‘é‡çš„æ¨¡ï¼Œç®­å¤´çš„æŒ‡å‘ä»£è¡¨å‘é‡çš„æ–¹å‘ã€‚&lt;/p&gt;
&lt;p&gt;æ”¹å˜å‘é‡çš„ä½ç½®ä¸ä¼šæ”¹å˜å…¶å¤§å°å’Œæ–¹å‘ï¼Œæ‰€ä»¥å‘é‡ä¸å…¶ä½ç½®æ— å…³ã€‚å½“æˆ‘ä»¬è¯´ä¸¤ä¸ªå‘é‡ç›¸ç­‰ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬çš„é•¿åº¦ç›¸ç­‰ä¸”æ–¹å‘ç›¸åŒã€‚&lt;/p&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;æ•°å­¦ä¸­ä½¿ç”¨åæ ‡ç³»æ¥æè¿°å‘é‡ï¼Œé€šè¿‡å¹³ç§»æ“ä½œå°†å‘é‡çš„å°¾éƒ¨ç§»åŠ¨åˆ°åŸç‚¹ï¼Œå°±å¯ä»¥é€šè¿‡åæ ‡æ¥ç¡®å®šè¯¥å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å½“æˆ‘ä»¬æ ¹æ®åæ ‡æ¥ç¡®å®šä¸€ä¸ªå‘é‡æ—¶ï¼Œå…¶å¯¹åº”çš„åæ ‡æ€»æ˜¯ç›¸å¯¹äºæŸä¸€å‚è€ƒç³»è€Œè¨€çš„ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;æ ‡é‡å’Œå‘é‡éƒ½å¯ä»¥ç”¨åæ ‡ (x, y, z) æ¥è¡¨ç¤ºã€‚ä½†å®ƒä»¬çš„æ„ä¹‰æˆªç„¶ä¸åŒï¼šç‚¹ä»…è¡¨ç¤ºä½ç½®ï¼Œè€Œå‘é‡è¡¨ç¤ºå¤§å°ä¸æ–¹å‘ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;è®¾æœ‰å‘é‡ &lt;span class=&quot;math inline&quot;&gt;\(u = (u_x, u_y, y_z)\)&lt;/span&gt; å’Œ &lt;span class=&quot;math inline&quot;&gt;\(v = (v_x, v_y, v_z)\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;ä¸¤ä¸ªå‘é‡ç›¸ç­‰ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬å¯¹åº”çš„åˆ†é‡åˆ†åˆ«ç›¸ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;å‘é‡åŠ æ³•ï¼š&lt;span class=&quot;math inline&quot;&gt;\(u + v = (u_x + v_x, u_y + v_y, u_z + v_z)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ ‡é‡ä¹˜æ³• ( scalar multiplication )ï¼Œè®¾ k æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œåˆ™ &lt;span class=&quot;math inline&quot;&gt;\(ku = (ku_x, ku_y, ku_z)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å‘é‡å‡æ³•ï¼š&lt;span class=&quot;math inline&quot;&gt;\(u - v = (u_x - v_x, u_y - v_y, u_z - v_z)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&quot;math inline&quot;&gt;\((0, 0, 0)\)&lt;/span&gt; ç§°ä¸ºé›¶å‘é‡ (zero-vector)ï¼Œå¯ç®€è®°ä¸º 0ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;å‘é‡çš„å¤§å°ï¼ˆå³æ¨¡ï¼‰çš„å‡ ä½•æ„ä¹‰æ˜¯å¯¹åº”æœ‰å‘çº¿æ®µçš„æ“¦æ±—é«˜éš¾åº¦ï¼Œç”¨åŒç«–çº¿è¡¨ç¤ºï¼ˆå¦‚ &lt;span class=&quot;math inline&quot;&gt;\(||u||\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä»£æ•°è®¡ç®—æ–¹æ³•ï¼š&lt;span class=&quot;math inline&quot;&gt;\(\|u\| = \sqrt{x^2 + y^2 + z^2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è§„èŒƒåŒ– (normalizing) ï¼š&lt;/p&gt;
&lt;p&gt;å°†å‘é‡çš„é•¿åº¦å˜ä¸ºå•ä½é•¿åº¦ï¼Œå°†å‘é‡çš„æ¯ä¸ªåˆ†é‡åˆ†åˆ«é™¤ä»¥è¯¥å‘é‡çš„æ¨¡ï¼š&lt;span class=&quot;math inline&quot;&gt;\(\hat{u} = \frac{u}{\|u\|} = (\frac{x}{\|u\|},\frac{y}{\|u\|}\frac{z}{\|u\|})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;è§„èŒƒåŒ–åˆç§°æ ‡å‡†åŒ–ã€å½’ä¸€åŒ–ã€æ­£å¸¸åŒ–ã€è§„æ ¼åŒ–ã€æ­£æ€åŒ–ã€å•ä½åŒ–â€¦â€¦ä¸å¿…æ‹˜æ³¥äºåè¯è¯‘æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;ç‚¹ç§¯ ( dot product ï¼Œä¹Ÿç§°ä¸ºæ•°é‡ç§¯æˆ–å†…ç§¯ ) æ˜¯ä¸€ç§è®¡ç®—ç»“æœä¸ºæ ‡é‡å€¼çš„å‘é‡ä¹˜æ³•è¿ç®—ï¼Œå› æ­¤ä¹Ÿç§°æ ‡é‡ç§¯ ( scalar product )ã€‚è®¾ &lt;span class=&quot;math inline&quot;&gt;\(u = (u_x, u_y, y_z)\)&lt;/span&gt; å’Œ &lt;span class=&quot;math inline&quot;&gt;\(v = (v_x, v_y, v_z)\)&lt;/span&gt;ï¼Œåˆ™ç‚¹ç§¯çš„å®šä¹‰ä¸ºï¼š&lt;span class=&quot;math inline&quot;&gt;\(u \cdot v = u_xv_x + u_yv_y + u_zv_z\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹ç§¯çš„å‡ ä½•æ„ä¹‰æ˜¯ï¼š&lt;span class=&quot;math inline&quot;&gt;\(u \cdot v = \|u\| \|v\| \cos{\theta}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹ç§¯çš„ä¸€äº›å‡ ä½•æ€§è´¨ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;span class=&quot;math inline&quot;&gt;\(u \cdot v = 0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&quot;math inline&quot;&gt;\(u \perp v\)&lt;/span&gt; ï¼ˆå³ä¸¤ä¸ªå‘é‡æ­£äº¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&quot;math inline&quot;&gt;\(u \cdot v \gt 0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸¤å‘é‡ä¹‹é—´çš„å¤¹è§’ Î¸ å°äº 90Â°ï¼ˆå³ä¸¤å‘é‡é—´çš„å¤¹è§’ä¸ºä¸€é”è§’ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&quot;math inline&quot;&gt;\(u \cdot v \lt 0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸¤å‘é‡ä¹‹é—´çš„å¤¹è§’ Î¸ å¤§äº 90Â°ï¼ˆå³ä¸¤å‘é‡é—´çš„å¤¹è§’ä¸ºä¸€é’è§’ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;æ­£äº¤ ï¼ˆorthogonalï¼‰ä¸å‚ç›´ï¼ˆperendicularï¼‰ä¸ºåŒä¹‰è¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;ç»™å‡ºå‘é‡ v å’Œå•ä½å‘é‡ nï¼Œç”¨ç‚¹ç§¯å…¬å¼æ±‚å‡º pã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1890896/202010/1890896-20201010214523031-1746004248.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸º n æ˜¯å•ä½å‘é‡ï¼Œæ‰€ä»¥ï¼š&lt;span class=&quot;math inline&quot;&gt;\(p = (\|v\| \cos{\theta}) n = (v \cdot n)n\)&lt;/span&gt;ã€‚æˆ‘ä»¬ç§° p ä¸ºå‘é‡ v è½åœ¨å‘é‡ n ä¸Šçš„&lt;strong&gt;æ­£äº¤æŠ•å½±&lt;/strong&gt;ï¼ˆorhogonal projectionï¼‰ï¼Œé€šå¸¸å°†å®ƒè¡¨ç¤ºä¸ºï¼š&lt;span class=&quot;math inline&quot;&gt;\(p = proj_n(v)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ n ä¸å…·æœ‰å•ä½é•¿åº¦ï¼Œå°±å…ˆå¯¹å®ƒè¿›è¡Œè§„åˆ’æ³•å¤„ç†ï¼Œä½¿ä¹‹æˆä¸ºå•ä½å‘é‡ã€‚å¯ä»¥å¾—åˆ°æ›´ä¸€èˆ¬çš„æŠ•å½±å…¬å¼ï¼š&lt;span class=&quot;math inline&quot;&gt;\(p = proj_n(v) = (v \cdot \frac{n}{\|n\|}) \frac{n}{\|n\|} = \frac{(v \cdot n)}{\|n\|^2}n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå‘é‡é›†åˆä¸­æ¯ä¸ªå‘é‡éƒ½æ˜¯ç›¸äº’æ­£äº¤ä¸”çš†å…·å•ä½é•¿åº¦ï¼Œæˆ‘ä»¬å°±ç§°æ­¤é›†åˆæ˜¯&lt;strong&gt;è§„èŒƒæ­£äº¤&lt;/strong&gt;ï¼ˆorhonormalï¼‰çš„ã€‚&lt;/p&gt;
&lt;br/&gt;æœ‰ä¸€ç§å¸¸è§çš„å·¥ä½œï¼Œå°†éè§„èŒƒæ­£äº¤é›†æ­£äº¤åŒ–ã€‚
&lt;p&gt;&lt;strong&gt;1.2D æ­£äº¤åŒ–å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾æœ‰ä¸€ä¸ªå‘é‡é›†åˆ &lt;span class=&quot;math inline&quot;&gt;\(\{v_0, v_1\}\)&lt;/span&gt;ï¼Œç°åœ¨è¦å°†å®ƒæ­£äº¤åŒ–ä¸º &lt;span class=&quot;math inline&quot;&gt;\(\{w_0, w_1\}\)&lt;/span&gt;ã€‚é¦–å…ˆè®¾ &lt;span class=&quot;math inline&quot;&gt;\(w_0=v_0\)&lt;/span&gt;ï¼Œé€šè¿‡ä½¿ &lt;span class=&quot;math inline&quot;&gt;\(v_1\)&lt;/span&gt; å‡å»å®ƒåœ¨ &lt;span class=&quot;math inline&quot;&gt;\(w_0\)&lt;/span&gt; ä¸Šçš„åˆ†é‡æ¥ä»¤å®ƒæ­£äº¤äº &lt;span class=&quot;math inline&quot;&gt;\(w_0\)&lt;/span&gt;ï¼š&lt;span class=&quot;math inline&quot;&gt;\(w_1 = v_1 - proj_{w_0}(v_1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬å°±å¾—åˆ°ä¸€ä¸ªå…ƒç´ ç›¸äº’æ­£äº¤çš„å‘é‡é›†åˆ &lt;span class=&quot;math inline&quot;&gt;\(\{w_0, w_1\}\)&lt;/span&gt;ï¼›æœ€åå°†å…¶ä¸­çš„å…ƒç´ è§„èŒƒåŒ–ä¸ºå•ä½å‘é‡å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.3D æ­£äº¤åŒ–å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ 2D çš„å¤„ç†æ–¹å¼ç±»ä¼¼ï¼Œåªä¸è¿‡è¦å¤šä¸€äº›æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–ï¼ˆGram-Schmidt Orthogonalizationï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºå…·æœ‰ n ä¸ªå‘é‡çš„ä¸€èˆ¬é›†åˆ &lt;span class=&quot;math inline&quot;&gt;\(\{ v_0, ..., v_{n-1}\}\)&lt;/span&gt; æ¥è¯´ï¼ŒåŸºæœ¬æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&quot;math inline&quot;&gt;\(w_0 = v_0\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&quot;math inline&quot;&gt;\(1 \le i \le n - 1\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&quot;math inline&quot;&gt;\(w_i=v_i - \sum_{j=0}^{i-1}proj_{w_j}(v_i)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è§„èŒƒåŒ–æ­¥éª¤ï¼šä»¤ &lt;span class=&quot;math inline&quot;&gt;\(w_i=\frac{w_i}{\|w_i\|}\)&lt;/span&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;å°†ç»™å®šé›†åˆå†…çš„å‘é‡ &lt;span class=&quot;math inline&quot;&gt;\(v_i\)&lt;/span&gt; æ·»åŠ åˆ°è§„èŒƒæ­£äº¤é›†ä¸­æ—¶ï¼Œéœ€è¦ä»¤ &lt;span class=&quot;math inline&quot;&gt;\(v_i\)&lt;/span&gt; å‡å»å®ƒåœ¨ç°æœ‰è§„èŒƒæ­£äº¤é›†ä¸­çš„å…¶ä»–å‘é‡æ–¹å‘ä¸Šçš„åˆ†é‡ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ–°åŠ å…¥è§„èŒƒæ­£äº¤é›†çš„å‘é‡ä¸è¯¥é›†åˆä¸­çš„å…¶ä»–å‘é‡ç›¸äº’æ­£äº¤ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br/&gt;&lt;hr/&gt;&lt;p&gt;å‡è®¾ 3D å‘é‡ u ä¸ v çš„å‰ç§¯ä¸º wï¼Œåˆ™ w ä¸å‘é‡ uã€v å½¼æ­¤æ­£äº¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(w = u \times v = (u_yv_z - u_zv_y, u_zv_x - u_xv_z, u_xv_y - u_yv_x)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡å‰ç§¯æ¥è¿›è¡Œæ­£äº¤åŒ–&lt;/p&gt;
&lt;p&gt;æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;ä»¤ &lt;span class=&quot;math inline&quot;&gt;\(w_0 = \frac{v_0}{\|v_0\|}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»¤ &lt;span class=&quot;math inline&quot;&gt;\(w_2 = \frac{w_0 \times v_1}{\|w_0 \times v_1\|}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä»¤ &lt;span class=&quot;math inline&quot;&gt;\(w_1 = w_2 \times w_0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;æ­¤æ—¶ï¼Œå‘é‡é›† &lt;span class=&quot;math inline&quot;&gt;\(\{ w_0, w_1, w_2 \}\)&lt;/span&gt; æ˜¯è§„èŒƒæ­£äº¤çš„ã€‚&lt;/p&gt;
&lt;br/&gt;</description>
<pubDate>Sat, 10 Oct 2020 23:27:00 +0000</pubDate>
<dc:creator>drnkcff</dc:creator>
<og:description>0x00 å‘é‡ å‘é‡ ( vector ) æ˜¯ä¸€ç§å…¼å…·å¤§å° ( magnitude ) å’Œæ–¹å‘çš„é‡ã€‚ 0x01 å‡ ä½•è¡¨ç¤º å‡ ä½•æ–¹æ³•ä¸­ç”¨ä¸€æ¡æœ‰å‘çº¿æ®µæ¥è¡¨ç¤ºä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­ï¼Œçº¿æ®µé•¿åº¦ä»£è¡¨å‘é‡çš„æ¨¡ï¼Œç®­å¤´çš„æŒ‡å‘</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/drnkcff/p/13795323.html</dc:identifier>
</item>
<item>
<title>JVMç³»åˆ—ã€4ã€‘å†…å­˜æ¨¡å‹ - kongxubihai</title>
<link>http://www.cnblogs.com/kongbubihai/p/13796052.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/kongbubihai/p/13796052.html</guid>
<description>&lt;h2 id=&quot;jvmç³»åˆ—ç¬”è®°ç›®å½•&quot;&gt;JVMç³»åˆ—ç¬”è®°ç›®å½•&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ul&gt;&lt;li&gt;è™šæ‹Ÿæœºçš„åŸºç¡€æ¦‚å¿µ&lt;/li&gt;
&lt;li&gt;classæ–‡ä»¶ç»“æ„&lt;/li&gt;
&lt;li&gt;classæ–‡ä»¶åŠ è½½è¿‡ç¨‹&lt;/li&gt;
&lt;li&gt;jvmå†…å­˜æ¨¡å‹&lt;/li&gt;
&lt;li&gt;JVMå¸¸ç”¨æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;GCä¸è°ƒä¼˜&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;
&lt;h3 id=&quot;ç¡¬ä»¶å±‚æ•°æ®ä¸€è‡´æ€§&quot;&gt;ç¡¬ä»¶å±‚æ•°æ®ä¸€è‡´æ€§&lt;/h3&gt;
&lt;h4 id=&quot;--å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„&quot;&gt;- å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1295651/202010/1295651-20201011014108077-1425354914.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä»L6-L0 ç©ºé—´ç”±å¤§å˜å°ï¼Œé€Ÿåº¦ç”±æ…¢åˆ°å¿«ã€‚&lt;/p&gt;
&lt;h4 id=&quot;-ç¼“å­˜ä¸€è‡´æ€§ç®—æ³•&quot;&gt;-ç¼“å­˜ä¸€è‡´æ€§ç®—æ³•&lt;/h4&gt;
&lt;p&gt;CPUå®ç°ç¼“å­˜ä¸€è‡´æ€§çš„åè®®å¾ˆå¤šï¼Œå…¶ä¸­intel ä½¿ç”¨çš„MESI(Modified Exclusive Shared Or Invalid)åè®®ã€‚å…·ä½“å¯ä»¥å‚è€ƒï¼š[&lt;a href=&quot;https://www.cnblogs.com/z00377750/p/9180644.html&quot;&gt;MESI--CPUç¼“å­˜ä¸€è‡´æ€§åè®®&lt;/a&gt;](&lt;a href=&quot;https://www.cnblogs.com/z00377750/p/9180644.html&quot;&gt;https://www.cnblogs.com/z00377750/p/9180644.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1295651/202010/1295651-20201011014108883-1611103947.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç°ä»£CPUçš„æ•°æ®ä¸€è‡´æ€§å®ç°=ç¼“å­˜é”(MESI...) +æ€»çº¿é”&lt;/p&gt;
&lt;h4 id=&quot;-ç¼“å­˜è¡Œ&quot;&gt;-ç¼“å­˜è¡Œ&lt;/h4&gt;
&lt;p&gt;ç¼“å­˜è¯»å–æ—¶çš„å•ä½ï¼Œä¸€èˆ¬æ˜¯64Byte&lt;br/&gt;ä½¿ç”¨ç¼“å­˜è¡Œçš„å¯¹é½èƒ½å¤Ÿæé«˜æ•ˆç‡&lt;/p&gt;
&lt;h4 id=&quot;-ä¼ªå…±äº«&quot;&gt;-ä¼ªå…±äº«&lt;/h4&gt;
&lt;p&gt;ä½äºåŒä¸€ç¼“å­˜è¡Œçš„2ä¸ªä¸åŒçš„æ•°æ®ï¼Œè¢«2ä¸ªä¸åŒçš„CPUé”å®šï¼Œäº§ç”Ÿäº’ç›¸å½±å“çš„ä¼ªå…±äº«é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è§£å†³ï¼Ÿ ä½¿ç”¨ç¼“å­˜è¡Œçš„å¯¹é½èƒ½å¤Ÿæé«˜æ•ˆç‡&lt;/p&gt;
&lt;h4 id=&quot;cpuä¹±åºé—®é¢˜&quot;&gt;CPUä¹±åºé—®é¢˜&lt;/h4&gt;
&lt;h4 id=&quot;--æ¦‚å¿µ&quot;&gt;- æ¦‚å¿µ&lt;/h4&gt;
&lt;p&gt;CPUä¸ºäº†æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œä¼šåœ¨ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­(æ¯”å¦‚å»å†…å­˜å–æ•°æ®(æ…¢100å€))ï¼Œå»åŒæ—¶æ‰§è¡Œå¦ä¸€æ¡æŒ‡ä»¤ï¼Œå‰ææ˜¯ä¸¤æ¡æŒ‡ä»¤æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚å…·ä½“å‚è€ƒï¼š[&lt;a href=&quot;https://www.cnblogs.com/liushaodong/p/4777308.html&quot;&gt;ç°ä»£cpuçš„åˆå¹¶å†™æŠ€æœ¯å¯¹ç¨‹åºçš„å½±å“&lt;/a&gt;](&lt;a href=&quot;https://www.cnblogs.com/liushaodong/p/4777308.html&quot;&gt;https://www.cnblogs.com/liushaodong/p/4777308.html&lt;/a&gt;)&lt;/p&gt;
&lt;h4 id=&quot;-åˆå¹¶å†™&quot;&gt;-åˆå¹¶å†™&lt;/h4&gt;
&lt;p&gt;CPUä¸Šæœ‰ä¸€ä¸ªWriteCombinBufferï¼Œä»…4ä¸ªå­—èŠ‚ï¼Œæ¯”L1ç­‰çº§è¿˜é«˜ï¼ŒæŸäº›å†™æ“ä½œä¼šåˆå¹¶åœ¨ä¸€èµ·æäº¤ã€‚[&lt;a href=&quot;https://www.cnblogs.com/liushaodong/p/4777308.html&quot;&gt;ç°ä»£cpuçš„åˆå¹¶å†™æŠ€æœ¯å¯¹ç¨‹åºçš„å½±å“&lt;/a&gt;](&lt;a href=&quot;https://www.cnblogs.com/liushaodong/p/4777308.html&quot;&gt;https://www.cnblogs.com/liushaodong/p/4777308.html&lt;/a&gt;)&lt;/p&gt;
&lt;h4 id=&quot;-ä¹±åºè¯æ˜&quot;&gt;-ä¹±åºè¯æ˜&lt;/h4&gt;
&lt;p&gt;CPUä¹±åºç°è±¡æœ‰å¤§ä½¬å†™ç¨‹åºæ¨¡æ‹Ÿå‡ºæ¥äº†ï¼Œå…·ä½“å‚è€ƒï¼š &lt;a href=&quot;https://preshing.com/20120515/memory-reordering-caught-in-the-act/&quot;&gt;Memory Reordering Caught in the Act&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;å¦‚ä½•ä¿è¯åœ¨ç‰¹å®šæƒ…å†µä¸‹ä¿è¯ä¸ä¹±åº&quot;&gt;å¦‚ä½•ä¿è¯åœ¨ç‰¹å®šæƒ…å†µä¸‹ä¿è¯ä¸ä¹±åº&lt;/h4&gt;
&lt;h4 id=&quot;ç¡¬ä»¶çº§åˆ«&quot;&gt;ç¡¬ä»¶çº§åˆ«&lt;/h4&gt;
&lt;blockquote readability=&quot;18&quot;&gt;
&lt;p&gt;X86 CPUçº§åˆ«å†…å­˜å±éšœ&lt;/p&gt;
&lt;p&gt;sfence&lt;br/&gt;store fence åœ¨sfenceæŒ‡ä»¤å‰çš„å†™æ“ä½œå¿…é¡»åœ¨sfenceæŒ‡ä»¤åçš„å†™æ“ä½œå‰å®Œæˆ&lt;/p&gt;
&lt;p&gt;lfence&lt;br/&gt;load fence åœ¨lfenceæŒ‡ä»¤å‰çš„è¯»æ“ä½œå¿…é¡»åœ¨lfenceæŒ‡ä»¤åçš„è¯»æ“ä½œå‰å®Œæˆ&lt;/p&gt;
&lt;p&gt;mfence&lt;br/&gt;mixed fence åœ¨mfenceæŒ‡ä»¤å‰çš„è¯»å†™æ“ä½œå¿…é¡»åœ¨mfenceæŒ‡ä»¤åçš„è¯»å†™æ“ä½œå‰å®Œæˆ&lt;/p&gt;
&lt;p&gt;CPUåŸå­æŒ‡ä»¤&lt;br/&gt;å¦‚x86ä¸Šçš„â€lock â€¦â€ æŒ‡ä»¤æ˜¯ä¸€ä¸ªFull Barrierï¼Œæ‰§è¡Œæ—¶ä¼šé”ä½å†…å­˜å­ç³»ç»Ÿæ¥ç¡®ä¿æ‰§è¡Œé¡ºåºï¼Œç”šè‡³è·¨å¤šä¸ªCPU&lt;/p&gt;
&lt;p&gt;æ€»ç»“ï¼š Software Locksé€šå¸¸ä½¿ç”¨äº†å†…å­˜å±éšœæˆ–åŸå­æŒ‡ä»¤æ¥å®ç°å˜é‡å¯è§æ€§å’Œä¿æŒç¨‹åºé¡ºåº&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;jvmçº§åˆ«&quot;&gt;JVMçº§åˆ«&lt;/h4&gt;
&lt;blockquote readability=&quot;20&quot;&gt;
&lt;p&gt;JSR113è§„èŒƒè§„å®šäº†4ç§å†…å­˜å±éšœ&lt;/p&gt;
&lt;p&gt;LoadLoadå±éšœ&lt;br/&gt;å¯¹äºè¯­å¥Load1;LoadLoad;Load2ï¼Œåœ¨Load2åŠåç»­è¯»å–æŒ‡ä»¤è¦è¯»å–çš„æ•°æ®è¢«è®¿é—®å‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•&lt;/p&gt;
&lt;p&gt;StoreStoreå±éšœ&lt;br/&gt;å¯¹äºè¯­å¥Store1;StoreStore;Store2,åœ¨Store2åŠåç»­å†™æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥æ“ä½œå¯¹å…¶å®ƒå¤„ç†å™¨å¯è§&lt;/p&gt;
&lt;p&gt;LoadStoreå±éšœ&lt;br/&gt;å¯¹äºè¯­å¥Load1;StoreStore;Store2,åœ¨Store2åŠåç»­å†™æ“ä½œè¢«åˆ·å‡ºå‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•&lt;/p&gt;
&lt;p&gt;StoreLoadå±éšœ&lt;br/&gt;å¯¹äºè¯­å¥Store1;StoreStore;Load2,åœ¨Load2åŠåç»­è¯»å–æŒ‡ä»¤è¦æ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥æ“ä½œå¯¹å…¶å®ƒå¤„ç†å™¨å¯è§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;sychronizedvolatileåœ¨å­—èŠ‚ç ã€jvmã€ç¡¬ä»¶oså±‚é¢å®ç°ç»†èŠ‚&quot;&gt;sychronized/volatileåœ¨å­—èŠ‚ç ã€JVMã€ç¡¬ä»¶OSå±‚é¢å®ç°ç»†èŠ‚&lt;/h4&gt;
&lt;h4 id=&quot;--sychronized&quot;&gt;- sychronized&lt;/h4&gt;
&lt;blockquote&gt;
&lt;ul readability=&quot;0&quot;&gt;&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;å­—èŠ‚ç å±‚é¢&lt;/p&gt;
&lt;p&gt;sychronized m() : AccessFlag : ACC_VOLATILE&lt;/p&gt;
&lt;p&gt;sychronized(this){} : monitorenter monitorexit monitorenter&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;JVMå±‚é¢&lt;/p&gt;
&lt;p&gt;C/C++ è°ƒç”¨æ“ä½œç³»ç»Ÿçš„åŒæ­¥æ“ä½œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¡¬ä»¶OSå±‚é¢&lt;/p&gt;
&lt;p&gt;X86 : lock cmpxchg / xxx&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;
&lt;h4 id=&quot;-volatile&quot;&gt;-volatile&lt;/h4&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;ul readability=&quot;0&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;å­—èŠ‚ç å±‚é¢&lt;br/&gt;AccessFlag : ACC_VOLATILE&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;JVMå±‚é¢&lt;/p&gt;
&lt;p&gt;volatileå†…å­˜åŒºåŸŸéƒ½åŠ å±éšœ&lt;/p&gt;
&lt;p&gt;StoreStoreBarrier volatile å†™æ“ä½œ StoreLoadBarrier&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;â€‹ LoadLoadBarrier â€‹ volatile è¯»æ“ä½œ â€‹ LoadStoreBarrier&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;é¢è¯•new-object-6è¿é—®&quot;&gt;é¢è¯•new Object() 6è¿é—®&lt;/h3&gt;
&lt;ul readability=&quot;3.7699115044248&quot;&gt;&lt;li readability=&quot;2.6647564469914&quot;&gt;
&lt;p&gt;1.è§£é‡Šå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;è¯¥é—®é¢˜ç»“åˆä¸Šç¯‡åšå®¢ï¼š&lt;a href=&quot;https://blog.csdn.net/qq_21579619/article/details/109001854&quot;&gt;JVMç³»åˆ—ã€3ã€‘Classæ–‡ä»¶åŠ è½½è¿‡ç¨‹&lt;/a&gt;ä¸éš¾å›ç­”å‡ºæ¥ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;class loading&lt;/p&gt;
&lt;p&gt;class linking (vertification prepraration resolution)&lt;/p&gt;
&lt;p&gt;class initiazing&lt;/p&gt;
&lt;p&gt;new ç”³è¯·å†…å­˜ç©ºé—´&lt;/p&gt;
&lt;p&gt;æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼&lt;/p&gt;
&lt;p&gt;è°ƒç”¨æ„é€ æ–¹æ³•:æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ï¼›æ‰§è¡Œæ„é€ æ–¹æ³•è¯­å¥ï¼Œsuper()çˆ¶ç±»æ„é€ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li readability=&quot;7&quot;&gt;
&lt;p&gt;2.å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¸ƒå±€&lt;/p&gt;
&lt;p&gt;å¯¹è±¡åœ¨å†…å­˜ä¸­å¸ƒå±€åˆ†æ™®é€šå¯¹è±¡å’Œæ•°ç»„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;æ™®é€šå¯¹è±¡4éƒ¨åˆ†ï¼šå¯¹è±¡å¤´markword(8å­—èŠ‚)ã€ClassPointeræŒ‡é’ˆ(4æˆ–8å­—èŠ‚)ã€å®ä¾‹æ•°æ®ã€paddingå¯¹é½ä¸º8çš„å€æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ•°ç»„å¯¹è±¡5éƒ¨åˆ†ï¼Œå’Œæ™®é€šå¯¹è±¡ç±»ä¼¼ï¼Œä½†ä¸­é—´æ˜¯æ•°ç»„é•¿åº¦4å­—èŠ‚å’Œå…·ä½“çš„æ•°ç»„æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1295651/202010/1295651-20201011014109454-1345580660.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;ul readability=&quot;1.3309352517986&quot;&gt;&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;3.å¯¹è±¡å¤´å…·ä½“åŒ…æ‹¬ä»€ä¹ˆ&lt;/p&gt;
&lt;p&gt;å¯¹è±¡å¤´markword(8å­—èŠ‚)å…·ä½“å†…å®¹å’Œå¯¹è±¡é”çŠ¶æ€æœ‰å…³ç³»ï¼Œå…¶ä¸­æœ€é«˜ä½2ä½æ˜¯é”çŠ¶æ€ä¸­ï¼Œæœ€ä½3ä½ç”¨ä½œé”æ ‡å¿—ä½ï¼Œä¸­é—´4ä½æ˜¯GCå¹´é¾„ï¼Œå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1295651/202010/1295651-20201011014253677-451292269.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-0.5948275862069&quot;&gt;
&lt;p&gt;4.å¯¹è±¡æ€ä¹ˆå®šä½&lt;/p&gt;
&lt;p&gt;é€šè¿‡å¥æŸ„æ± å’Œç›´æ¥æŒ‡é’ˆï¼Œå…·ä½“å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/clover_lily/article/details/80095580&quot;&gt;è®¿é—®å¯¹è±¡ä¸¤ç§æ–¹å¼--å¥æŸ„å’Œç›´æ¥æŒ‡é’ˆ&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;5.å¯¹è±¡æ€ä¹ˆåˆ†é…ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹è±¡çš„åˆ†é…å…¶å®å’Œåƒåœ¾å›æ”¶GCæœ‰å…³ç³»ï¼Œåç»­æ€»ç»“GCè¯¦ç»†è®²ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1295651/202010/1295651-20201011014109802-290925713.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;çŸ¥è¯†åˆ†äº«ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚å­¦æ— å…ˆåï¼Œè¾¾è€…ä¸ºå…ˆï¼&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Sat, 10 Oct 2020 17:41:00 +0000</pubDate>
<dc:creator>kongxubihai</dc:creator>
<og:description>JVMç³»åˆ—ç¬”è®°ç›®å½• è™šæ‹Ÿæœºçš„åŸºç¡€æ¦‚å¿µ classæ–‡ä»¶ç»“æ„ classæ–‡ä»¶åŠ è½½è¿‡ç¨‹ jvmå†…å­˜æ¨¡å‹ JVMå¸¸ç”¨æŒ‡ä»¤ GCä¸è°ƒä¼˜ ç¡¬ä»¶å±‚æ•°æ®ä¸€è‡´æ€§ - å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„ ä»L6-L0 ç©ºé—´ç”±å¤§å˜å°ï¼Œé€Ÿåº¦ç”±æ…¢</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/kongbubihai/p/13796052.html</dc:identifier>
</item>
<item>
<title>golangæ‹¾é—ï¼šæŒ‡é’ˆå’Œæ¥å£ - apocelipes</title>
<link>http://www.cnblogs.com/apocelipes/p/13796041.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/apocelipes/p/13796041.html</guid>
<description>&lt;p&gt;è¿™æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œgolangæ‹¾é—ä¸»è¦æ˜¯ç”¨æ¥è®°å½•ä¸€äº›é—å¿˜äº†çš„ã€å¹³æ—¶ä»æ²¡æ³¨æ„è¿‡çš„golangç›¸å…³çŸ¥è¯†ã€‚æƒ³åšæœ¬ç³»åˆ—çš„å¥‘æœºå…¶å®æ˜¯å› ä¸ºç–«æƒ…é—²ç€åœ¨å®¶æ— èŠï¼Œç½‘ä¸Šå†²æµªçš„æ—¶å€™å‘ç°äº†zhuihuä¸Šçš„&lt;a href=&quot;https://www.zhihu.com/column/polaris&quot;&gt;goè¯­è¨€çˆ±å¥½è€…å‘¨åˆŠ&lt;/a&gt;å’Œ&lt;a href=&quot;https://go101.org/article/101.html&quot;&gt;Go 101&lt;/a&gt;ï¼Œè¯»ä¹‹å¦‚é†é†çŒé¡¶ï¼Œå—ç›ŠåŒªæµ…ï¼Œäºæ˜¯æœ¬ç³»åˆ—çš„æ–‡ç« å°±è¯ç”Ÿäº†ã€‚æ‹¾é—ä¸»è¦æ˜¯æ”¶é›†å’Œgolangç›¸å…³çš„çç¢çŸ¥è¯†ï¼Œå½“ç„¶ä¹Ÿä¼šå¯¹å‘¨åˆŠå’Œ101çš„å†…å®¹åšä¸€äº›è¡¥å……è¯´æ˜ã€‚å¥½äº†ï¼Œé¢˜å¤–è¯å°±æ­¤æ‰“ä½ï¼Œä¸‹é¢è¯¥è¿›å…¥ä»Šå¤©çš„æ­£é¢˜äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æŒ‡é’ˆå’Œæ¥å£&quot;&gt;æŒ‡é’ˆå’Œæ¥å£&lt;/h2&gt;
&lt;p&gt;golangçš„ç±»å‹ç³»ç»Ÿå…¶å®å¾ˆæœ‰æ„æ€ï¼Œæœ‰æ„æ€çš„åœ°æ–¹å°±åœ¨äºç±»å‹ç³»ç»Ÿè¡¨é¢ä¸Šçœ‹èµ·æ¥ä¼—ç”Ÿå¹³ç­‰ï¼Œç„¶è€Œå®é™…ä¸Šå´è¦åˆ†æˆæ™®é€šç±»å‹ï¼ˆtypesï¼‰å’Œæ¥å£ï¼ˆinterfacesï¼‰æ¥çœ‹å¾…ã€‚æ™®é€šç±»å‹ä¹ŸåŒ…å«äº†æ‰€è°“çš„å¼•ç”¨ç±»å‹ï¼Œä¾‹å¦‚&lt;code&gt;slice&lt;/code&gt;å’Œ&lt;code&gt;map&lt;/code&gt;ï¼Œè™½ç„¶ä»–ä»¬å’Œ&lt;code&gt;interface&lt;/code&gt;åŒä¸ºå¼•ç”¨ç±»å‹ï¼Œä½†æ˜¯è¡Œä¸ºæ›´è¶‹è¿‘äºæ™®é€šçš„å†…ç½®ç±»å‹å’Œè‡ªå®šä¹‰ç±»å‹ï¼Œå› æ­¤åªæœ‰ç‰¹ç«‹ç‹¬è¡Œçš„&lt;code&gt;interface&lt;/code&gt;ä¼šè¢«å•ç‹¬å½’ç±»ã€‚&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬æ˜¯ä¾æ®ä»€ä¹ˆæŠŠgolangçš„ç±»å‹åˆ†æˆä¸¤ç±»çš„å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œçœ‹ç±»å‹èƒ½ä¸èƒ½åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šä»¥åŠè°ƒç”¨çš„ç±»å‹æ–¹æ³•æ˜¯å¦èƒ½åœ¨ç¼–è¯‘æœŸè¢«ç¡®å®šã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè§‰å¾—ä¸Šé¢çš„è§£é‡Šå¤ªè¿‡æŠ½è±¡çš„å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;package main

import &quot;fmt&quot;

func main(){
    m := make(map[int]int)
    m[1] = 1 * 2
    m[2] = 2 * 2
    fmt.Println(m)
    m2 := make(map[string]int)
    m2[&quot;python&quot;] = 1
    m2[&quot;golang&quot;] = 2
    fmt.Println(m2)
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ¥çœ‹éinterfaceçš„å¼•ç”¨ç±»å‹ï¼Œ&lt;code&gt;m&lt;/code&gt;å’Œ&lt;code&gt;m2&lt;/code&gt;æ˜æ˜¾æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»å‹ï¼Œä¸è¿‡å®é™…ä¸Šåœ¨åº•å±‚ä»–ä»¬æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¿¡æˆ‘ä»¬ç”¨objdumpå·¥å…·æ£€æŸ¥ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;go tool objdump -s 'main\.main' a

TEXT main.main(SB) /tmp/a.go
  a.go:6  CALL runtime.makemap_small(SB)     # m := make(map[int]int)
  ...
  a.go:7  CALL runtime.mapassign_fast64(SB)  # m[1] = 1 * 2
  ...
  a.go:8  CALL runtime.mapassign_fast64(SB)  # m[2] = 2 * 2
  ...
  ...
  a.go:10 CALL runtime.makemap_small(SB)     # m2 := make(map[string]int)
  ...
  a.go:11 CALL runtime.mapassign_faststr(SB) # m2[&quot;python&quot;] = 1
  ...
  a.go:12 CALL runtime.mapassign_faststr(SB) # m2[&quot;golang&quot;] = 2
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;çœç•¥äº†ä¸€äº›å¯„å­˜å™¨çš„æ“ä½œå’Œæ— å…³å‡½æ•°çš„è°ƒç”¨ï¼Œé¡ºä¾¿åŠ ä¸Šäº†å¯¹åº”çš„ä»£ç çš„åŸæ–‡ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°å°½ç®¡ç±»å‹ä¸åŒï¼Œä½†mapè°ƒç”¨çš„æ–¹æ³•éƒ½æ˜¯ç›¸åŒçš„è€Œä¸”æ˜¯ç¼–è¯‘æœŸå°±å·²ç»ç¡®å®šçš„ã€‚å¦‚æœæ˜¯è‡ªå®šä¹‰ç±»å‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;package main

import &quot;fmt&quot;

type Person struct {
    name string
    age int
}

func (p *Person) sayHello() {
    fmt.Printf(&quot;Hello, I'm %v, %v year(s) old\n&quot;, p.name, p.age)
}

func main(){
    p := Person{
        name: &quot;apocelipes&quot;,
        age: 100,
    }
    p.sayHello()
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ‹¥æœ‰è‡ªå®šä¹‰å­—æ®µå’Œæ–¹æ³•çš„è‡ªå®šä¹‰ç±»å‹ï¼Œä¸‹é¢å†ç”¨objdumpæ£€æŸ¥ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;go tool objdump -s 'main\.main' b

TEXT main.main(SB) /tmp/b.go
  ...
  b.go:19   CALL main.(*Person).sayHello(SB)
  ...
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç”¨å­—é¢é‡åˆ›å»ºå¯¹è±¡å’Œåˆå§‹åŒ–è°ƒç”¨å †æ ˆçš„æ±‡ç¼–ä»£ç ä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹åœ¨äºé‚£å¥&lt;code&gt;CALL&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰ç±»å‹çš„æ–¹æ³•ä¹Ÿæ˜¯åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£åè¿‡æ¥çœ‹çœ‹interfaceä¼šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;package main

import &quot;fmt&quot;

type Worker interface {
    Work()
}

type Typist struct{}
func (*Typist)Work() {
    fmt.Println(&quot;Typing...&quot;)
}

type Programer struct{}
func (*Programer)Work() {
    fmt.Println(&quot;Programming...&quot;)
}

func main(){
    var w Worker = &amp;amp;Typist{}
    w.Work()
    w = &amp;amp;Programer{}
    w.Work()
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ³¨æ„ï¼ç¼–è¯‘è¿™ä¸ªç¨‹åºéœ€è¦ç¦æ­¢ç¼–è¯‘å™¨è¿›è¡Œä¼˜åŒ–ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠŠæ¥å£çš„æ–¹æ³•æŸ¥æ‰¾ç›´æ¥ä¼˜åŒ–ä¸ºç‰¹å®šç±»å‹çš„æ–¹æ³•è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;go build -gcflags &quot;-N -l&quot; c.go
go tool objdump -S -s 'main\.main' c

TEXT main.main(SB) /tmp/c.go
  ...
  var w Worker = &amp;amp;Typist{}
    LEAQ runtime.zerobase(SB), AX
    MOVQ AX, 0x10(SP)
    MOVQ AX, 0x20(SP)
    LEAQ go.itab.*main.Typist,main.Worker(SB), CX
    MOVQ CX, 0x28(SP)
    MOVQ AX, 0x30(SP)
  w.Work()
    MOVQ 0x28(SP), AX
    TESTB AL, 0(AX)
    MOVQ 0x18(AX), AX
    MOVQ 0x30(SP), CX
    MOVQ CX, 0(SP)
    CALL AX
  w = &amp;amp;Programer{}
    LEAQ runtime.zerobase(SB), AX
    MOVQ AX, 0x8(SP)
    MOVQ AX, 0x18(SP)
    LEAQ go.itab.*main.Programer,main.Worker(SB), CX
    MOVQ CX, 0x28(SP)
    MOVQ AX, 0x30(SP)
  w.Work()
    MOVQ 0x28(SP), AX
    TESTB AL, 0(AX)
    MOVQ 0x18(AX), AX
    MOVQ 0x30(SP), CX
    MOVQ CX, 0(SP)
    CALL AX
  ...
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è°ƒç”¨æ¥å£çš„æ–¹æ³•ä¼šå»åœ¨runtimeè¿›è¡ŒæŸ¥æ‰¾ï¼Œéšå&lt;code&gt;CALL&lt;/code&gt;æ‰¾åˆ°çš„åœ°å€ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰é‚£æ ·åœ¨ç¼–è¯‘æœŸå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ç›´æ¥è°ƒç”¨ã€‚è¿™å°±æ˜¯interfaceä¸ºä»€ä¹ˆç‰¹æ®Šçš„åŸå› ï¼šinterfaceæ˜¯åŠ¨æ€å˜åŒ–çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥åŠ¨æ€å˜åŒ–çš„ç±»å‹æœ€æ˜¾è€Œæ˜“è§çš„å¥½å¤„æ˜¯ç»™äºˆç¨‹åºé«˜åº¦çš„çµæ´»æ€§ï¼Œä½†çµæ´»æ€§æ˜¯è¦ä»˜å‡ºä»£ä»·çš„ï¼Œä¸»è¦åœ¨ä¸¤æ–¹é¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ˜¯æ€§èƒ½ä»£ä»·ã€‚åŠ¨æ€çš„æ–¹æ³•æŸ¥æ‰¾æ€»æ˜¯è¦æ¯”ç¼–è¯‘æœŸå°±èƒ½ç¡®å®šçš„æ–¹æ³•è°ƒç”¨å¤šèŠ±è´¹å‡ æ¡æ±‡ç¼–æŒ‡ä»¤ï¼ˆmovå’Œleaé€šå¸¸éƒ½æ˜¯ä¼šäº§ç”Ÿå®é™…æŒ‡ä»¤çš„ï¼‰ï¼Œæ•°é‡ç´¯è®¡åå°±ä¼šäº§ç”Ÿæ€§èƒ½å½±å“ã€‚ä¸è¿‡å¥½æ¶ˆæ¯æ˜¯é€šå¸¸ç¼–è¯‘å™¨å¯¹æˆ‘ä»¬çš„ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚&lt;code&gt;c.go&lt;/code&gt;ä¸­å¦‚æœæˆ‘ä»¬ä¸å…³é—­ç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸé—´å°±æ›¿æˆ‘ä»¬å®Œæˆæ–¹æ³•çš„æŸ¥æ‰¾ï¼Œå®é™…ç”Ÿäº§çš„ä»£ç é‡Œä¸ä¼šæœ‰åŠ¨æ€æŸ¥æ‰¾çš„å†…å®¹ã€‚ç„¶è€Œåæ¶ˆæ¯æ˜¯è¿™ç§ä¼˜åŒ–éœ€è¦ç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘æœŸç¡®å®šæ¥å£å¼•ç”¨æ•°æ®çš„å®é™…ç±»å‹ï¼Œè€ƒè™‘å¦‚ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;type Worker interface {
    Work()
}

for _, v := workers {
    v.Work()
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å› ä¸ºåªè¦å®ç°äº†&lt;code&gt;Worker&lt;/code&gt;æ¥å£çš„ç±»å‹å°±å¯ä»¥æŠŠè‡ªå·±çš„å®ä¾‹å¡è¿›&lt;code&gt;workers&lt;/code&gt;åˆ‡ç‰‡é‡Œï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¸èƒ½ç¡®å®švå¼•ç”¨çš„æ•°æ®çš„ç±»å‹ï¼Œä¼˜åŒ–è‡ªç„¶ä¹Ÿæ— ä»è°ˆèµ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;è€Œå¦ä¸€ä¸ªä»£ä»·ï¼Œç¡®åˆ‡åœ°è¯´å…¶å®åº”è¯¥å«é™·é˜±ï¼Œå°±æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ¢è®¨çš„ä¸»é¢˜äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;golangçš„æŒ‡é’ˆ&quot;&gt;golangçš„æŒ‡é’ˆ&lt;/h2&gt;
&lt;p&gt;æŒ‡é’ˆä¹Ÿæ˜¯ä¸€ä¸ªææœ‰æ¢è®¨ä»·å€¼çš„è¯é¢˜ï¼Œç‰¹åˆ«æ˜¯æŒ‡é’ˆåœ¨reflectä»¥åŠruntimeåŒ…é‡Œçš„å„ç§é»‘ç§‘æŠ€ã€‚ä¸è¿‡æ”¾è½»æ¾ï¼Œä»Šå¤©æˆ‘ä»¬åªç”¨äº†è§£ä¸‹æŒ‡é’ˆçš„è‡ªåŠ¨è§£å¼•ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠ&lt;code&gt;b.go&lt;/code&gt;é‡Œçš„ä»£ç æ”¹åŠ¨ä¸€è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;p := &amp;amp;Person{
    name: &quot;apocelipes&quot;,
    age: 100,
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;pç°åœ¨æ˜¯ä¸ªæŒ‡é’ˆï¼Œå…¶ä½™ä»£ç ä¸éœ€è¦ä»»ä½•æ”¹åŠ¨ï¼Œç¨‹åºä¾æ—§å¯ä»¥æ­£å¸¸ç¼–è¯‘æ‰§è¡Œã€‚å¯¹åº”çš„æ±‡ç¼–æ˜¯è¿™æ ·çš„ç”»é£ï¼ˆå½“ç„¶å¾—å…³é—­ä¼˜åŒ–ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;p.sayHello()
    MOVQ AX, 0(SP)
    CALL main.(*Person).sayHello(SB)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯¹æ¯”ä¸€ä¸‹éæŒ‡é’ˆç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;p.sayHello()
    LEAQ 0x8(SP), AX
    MOVQ AX, 0(SP)
    CALL main.(*Person).sayHello(SB)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸å…¶è¯´æ˜¯æŒ‡é’ˆè‡ªåŠ¨è§£å¼•ç”¨ï¼Œå€’ä¸å¦‚è¯´æ˜¯éæŒ‡é’ˆç‰ˆæœ¬å…ˆæ±‚å‡ºäº†å¯¹è±¡çš„å®é™…åœ°å€ï¼Œéšåä¼ å…¥äº†è¿™ä¸ªåœ°å€ä½œä¸ºæ–¹æ³•çš„æ¥æ”¶å™¨è°ƒç”¨äº†æ–¹æ³•ã€‚è¿™ä¹Ÿæ²¡ä»€ä¹ˆå¥½å¥‡æ€ªçš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ–¹æ³•æ˜¯æŒ‡é’ˆæ¥æ”¶å™¨ï¼šPã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæŠŠæ¥æ”¶å™¨æ¢æˆå€¼ç±»å‹æ¥æ”¶å™¨ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;p.sayHello()
    TESTB AL, 0(AX)
    MOVQ 0x40(SP), AX
    MOVQ 0x48(SP), CX
    MOVQ 0x50(SP), DX
    MOVQ AX, 0x28(SP)
    MOVQ CX, 0x30(SP)
    MOVQ DX, 0x38(SP)
    MOVQ AX, 0(SP)
    MOVQ CX, 0x8(SP)
    MOVQ DX, 0x10(SP)
    CALL main.Person.sayHello(SB)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä½œä¸ºå¯¹æ¯”ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;p.sayHello()
    MOVQ AX, 0(SP)
    MOVQ $0xa, 0x8(SP)
    MOVQ $0x64, 0x10(SP)
    CALL main.Person.sayHello(SB)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ—¶å€™golangå°±æ˜¯å…ˆæ£€æŸ¥æŒ‡é’ˆéšåè§£å¼•ç”¨äº†ã€‚åŒæ—¶è¦æ³¨æ„ï¼Œè¿™é‡Œçš„æ–¹æ³•è°ƒç”¨æ˜¯å·²ç»åœ¨ç¼–è¯‘æœŸç¡®å®šäº†çš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æŒ‡å‘interfaceçš„æŒ‡é’ˆ&quot;&gt;æŒ‡å‘interfaceçš„æŒ‡é’ˆ&lt;/h2&gt;
&lt;p&gt;é“ºå«äº†è¿™ä¹ˆä¹…ï¼Œç»ˆäºè¯¥è¿›å…¥æ­£é¢˜äº†ã€‚ä¸è¿‡åœ¨æ­¤ä¹‹å‰è¿˜æœ‰ä¸€ç‚¹å°å°çš„é¢„å¤‡çŸ¥è¯†éœ€è¦æä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;A pointer type denotes the set of all pointers to variables of a given type, called the base type of the pointer. --- go language spec&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¢è€Œè¨€ä¹‹ï¼Œåªè¦æ˜¯èƒ½å–åœ°å€çš„ç±»å‹å°±æœ‰å¯¹åº”çš„æŒ‡é’ˆç±»å‹ï¼Œæ¯”è¾ƒå·§çš„æ˜¯åœ¨golangé‡Œå¼•ç”¨ç±»å‹æ˜¯å¯ä»¥å–åœ°å€çš„ï¼ŒåŒ…æ‹¬interfaceã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº†è¿™äº›é“ºå«ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„è¯´å”±æ­Œæ‰‹ç¨‹åºäº†ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;package main

import &quot;fmt&quot;

type Rapper interface {
    Rap() string
}

type Dean struct {}

func (_ Dean) Rap() string {
    return &quot;Im a rapper&quot;
}

func doRap(p *Rapper) {
    fmt.Println(p.Rap())
}

func main(){
    i := new(Rapper)
    *i = Dean{}
    fmt.Println(i.Rap())
    doRap(i)
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é—®é¢˜æ¥äº†ï¼Œå°é’å¹´Deanèƒ½åœ†è‡ªå·±çš„è¯´å”±æ¢¦ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¾ˆé—æ†¾ï¼Œç¼–è¯‘å™¨ç»™å‡ºäº†åå¯¹æ„è§ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-text&quot;&gt;# command-line-arguments
./rapper.go:16:18: p.Rap undefined (type *Rapper is pointer to interface, not interface)
./rapper.go:22:18: i.Rap undefined (type *Rapper is pointer to interface, not interface)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¹Ÿè®¸&lt;code&gt;type *XXX is pointer to interface, not interface&lt;/code&gt;è¿™ä¸ªé”™è¯¯ä½ å¹¶ä¸é™Œç”Ÿï¼Œä½ æ›¾ç»ä¹ŸçŠ¯è¿‡ç”¨æŒ‡é’ˆæŒ‡å‘interfaceçš„é”™è¯¯ï¼Œç»è¿‡ä¸€ç•ªæœç´¢åä½ æ‰¾åˆ°äº†ä¸€ç¯‡æ•™ç¨‹ï¼Œæˆ–è€…æ˜¯åšå®¢ï¼Œæœ‰æˆ–è€…æ˜¯éšä¾¿ä»€ä¹ˆåœ°æ–¹çš„èµ„æ–™ï¼Œä»–ä»¬éƒ½ä¼šå‘Šè¯‰ä½ ä¸åº”è¯¥ç”¨æŒ‡é’ˆå»æŒ‡å‘æ¥å£ï¼Œæ¥å£æœ¬èº«æ˜¯å¼•ç”¨ç±»å‹æ— éœ€å†ç”¨æŒ‡é’ˆå»å¼•ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ä»–ä»¬åªè¯´å¯¹äº†ä¸€åŠï¼Œäº‹å®ä¸Šåªè¦æŠŠiå’Œpæ”¹æˆæ¥å£ç±»å‹å°±å¯ä»¥æ­£å¸¸ç¼–è¯‘è¿è¡Œäº†ã€‚æ²¡è¯´å¯¹çš„ä¸€åŠæ˜¯æŒ‡é’ˆå¯ä»¥æŒ‡å‘æ¥å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ¥å£çš„æ–¹æ³•ï¼Œä½†æ˜¯è¦ç»•äº›å¼¯è·¯ï¼ˆå½“ç„¶ï¼Œç”¨æŒ‡é’ˆå¼•ç”¨æ¥å£é€šå¸¸æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œæ‰€ä»¥å¬ä»ç»éªŒä¹‹è°ˆä¹Ÿæ²¡ä»€ä¹ˆä¸å¥½çš„ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;func doRap(p *Rapper) {
    fmt.Println((*p).Rap())
}

func main(){
    i := new(Rapper)
    *i = Dean{}
    fmt.Println((*i).Rap())
    doRap(i)
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;go run rapper.go 

Im a rapper
Im a rapper
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç¥å¥‡çš„ä¸€å¹•å‡ºç°äº†ï¼Œç¨‹åºä¸ä»…æ²¡æŠ¥é”™è€Œä¸”è¿è¡Œå¾—å¾ˆæ­£å¸¸ã€‚ä½†æ˜¯è¿™å’Œgolangå¯¹æŒ‡é’ˆçš„è‡ªåŠ¨è§£å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæ˜æ˜çœ‹èµ·æ¥éƒ½ä¸€æ ·ä½†å°±æ˜¯ç¬¬ä¸€ç§æ–¹æ¡ˆä¼šæŠ¥&lt;br/&gt;æ‰¾ä¸åˆ°&lt;code&gt;Rap&lt;/code&gt;æ–¹æ³•ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿï¼Œæˆ‘ä»¬æŠŠè°ƒç”¨è¯­å¥å•ç‹¬æŠ½å‡ºæ¥ï¼Œç„¶åæŸ¥çœ‹æœªä¼˜åŒ–è¿‡çš„æ±‡ç¼–ç ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;s := (*p).Rap()
  0x498ee1              488b842488000000        MOVQ 0x88(SP), AX
  0x498ee9              8400                    TESTB AL, 0(AX)
  0x498eeb              488b08                  MOVQ 0(AX), CX
  0x498eee              8401                    TESTB AL, 0(CX)
  0x498ef0              488b4008                MOVQ 0x8(AX), AX
  0x498ef4              488b4918                MOVQ 0x18(CX), CX
  0x498ef8              48890424                MOVQ AX, 0(SP)
  0x498efc              ffd1                    CALL CX
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æŠ›å¼€æ‰‹å·¥è§£å¼•ç”¨çš„éƒ¨åˆ†ï¼Œå6è¡Œå…¶å®å’Œç›´æ¥ä½¿ç”¨interfaceè¿›è¡ŒåŠ¨æ€æŸ¥è¯¢æ˜¯ä¸€æ ·çš„ã€‚çœŸæ­£çš„é—®é¢˜å…¶å®å‡ºåœ¨è‡ªåŠ¨è§£å¼•ç”¨ä¸Šï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-assembly&quot;&gt;p.sayHello()
    TESTB AL, 0(AX)
    MOVQ 0x40(SP), AX
    MOVQ 0x48(SP), CX
    MOVQ 0x50(SP), DX
    MOVQ AX, 0x28(SP)
    MOVQ CX, 0x30(SP)
    MOVQ DX, 0x38(SP)
    MOVQ AX, 0(SP)
    MOVQ CX, 0x8(SP)
    MOVQ DX, 0x10(SP)
    CALL main.Person.sayHello(SB)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸åŒä¹‹å¤„å°±åœ¨äºè¿™ä¸ª&lt;code&gt;CALL&lt;/code&gt;ä¸Šï¼Œè‡ªåŠ¨è§£å¼•ç”¨æ—¶çš„&lt;code&gt;CALL&lt;/code&gt;å…¶å®æ˜¯æŠŠæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹è§†ä½œ_æ™®é€šç±»å‹_ï¼Œå› æ­¤ä¼šå»é™æ€æŸ¥æ‰¾æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œè€ŒæŒ‡å‘çš„å†…å®¹æ˜¯interfaceçš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šå»interfaceæœ¬èº«çš„æ•°æ®ç»“æ„ä¸Šå»æŸ¥æ‰¾æœ‰æ²¡æœ‰&lt;code&gt;Rap&lt;/code&gt;è¿™ä¸ªæ–¹æ³•ï¼Œç­”æ¡ˆæ˜¾ç„¶æ˜¯æ²¡æœ‰ï¼Œæ‰€ä»¥çˆ†äº†&lt;code&gt;p.Rap undefined&lt;/code&gt;é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆinterfaceçš„çœŸå®é•¿ç›¸æ˜¯ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬çœ‹çœ‹go1.15.2çš„å®ç°ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-golang&quot;&gt;// src/runtime/runtime2.go
// å› ä¸ºè¿™è¾¹æ²¡ä½¿ç”¨ç©ºæ¥å£ï¼Œæ‰€ä»¥åªèŠ‚é€‰äº†å«æ•°æ®æ¥å£çš„å®ç°
type iface struct {
        tab  *itab
        data unsafe.Pointer
}

// src/runtime/runtime2.go
type itab struct {
        inter *interfacetype
        _type *_type
        hash  uint32 // copy of _type.hash. Used for type switches.
        _     [4]byte
        fun   [1]uintptr // variable sized. fun[0]==0 means _type does not implement inter.
}

// src/runtime/type.go
type imethod struct {
        name nameOff
        ityp typeOff
}

type interfacetype struct {
        typ     _type
        pkgpath name
        mhdr    []imethod // ç±»å‹æ‰€åŒ…å«çš„å…¨éƒ¨æ–¹æ³•
}

// src/runtime/type.go
type _type struct {
        size       uintptr
        ptrdata    uintptr // size of memory prefix holding all pointers
        hash       uint32
        tflag      tflag
        align      uint8
        fieldAlign uint8
        kind       uint8
        // function for comparing objects of this type
        // (ptr to object A, ptr to object B) -&amp;gt; ==?
        equal func(unsafe.Pointer, unsafe.Pointer) bool
        // gcdata stores the GC type data for the garbage collector.
        // If the KindGCProg bit is set in kind, gcdata is a GC program.
        // Otherwise it is a ptrmask bitmap. See mbitmap.go for details.
        gcdata    *byte
        str       nameOff
        ptrToThis typeOff
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ²¡æœ‰ç»™å‡ºå®šä¹‰çš„ç±»å‹éƒ½æ˜¯å¯¹å„ç§æ•´æ•°ç±»å‹çš„typing aliasã€‚&lt;code&gt;interface&lt;/code&gt;å®é™…ä¸Šå°±æ˜¯å­˜å‚¨ç±»å‹ä¿¡æ¯å’Œå®é™…æ•°æ®çš„&lt;code&gt;struct&lt;/code&gt;ï¼Œè‡ªåŠ¨è§£å¼•ç”¨åç¼–è¯‘å™¨æ˜¯ç›´æ¥æŸ¥çœ‹å†…å­˜å†…å®¹çš„ï¼ˆè§æ±‡ç¼–ï¼‰ï¼Œè¿™æ—¶çœ‹åˆ°çš„å…¶å®æ˜¯&lt;code&gt;iface&lt;/code&gt;è¿™ä¸ªæ™®é€šç±»å‹ï¼Œæ‰€ä»¥é™æ€æŸ¥æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•å°±å¤±è´¥äº†ã€‚è€Œä¸ºä»€ä¹ˆæ‰‹åŠ¨è§£å¼•ç”¨çš„ä»£ç å¯ä»¥è¿è¡Œï¼Ÿå› ä¸ºæˆ‘ä»¬æ‰‹åŠ¨è§£å¼•ç”¨åç¼–è¯‘å™¨å¯ä»¥æ¨å¯¼å‡ºå®é™…ç±»å‹æ˜¯interfaceï¼Œè¿™æ—¶å€™ç¼–è¯‘å™¨å°±å¾ˆè‡ªç„¶åœ°ç”¨å¤„ç†interfaceçš„æ–¹æ³•å»å¤„ç†å®ƒè€Œä¸æ˜¯ç›´æ¥æŠŠå†…å­˜é‡Œçš„ä¸œè¥¿å¯»å€åå¡è¿›å¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå¥½æ€»ç»“çš„ã€‚åªæœ‰ä¸¤ç‚¹éœ€è¦è®°ä½ï¼Œä¸€æ˜¯interfaceæ˜¯æœ‰è‡ªå·±å¯¹åº”çš„å®ä½“æ•°æ®ç»“æ„çš„ï¼ŒäºŒæ˜¯å°½é‡ä¸è¦ç”¨æŒ‡é’ˆå»æŒ‡å‘interfaceï¼Œå› ä¸ºgolangå¯¹æŒ‡é’ˆè‡ªåŠ¨è§£å¼•ç”¨çš„å¤„ç†ä¼šå¸¦æ¥é™·é˜±ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ å¯¹interfaceçš„å®ç°å¾ˆæ„Ÿå…´è¶£çš„è¯ï¼Œè¿™é‡Œæœ‰ä¸ªreflect+æš´åŠ›ç©·ä¸¾å®ç°çš„&lt;a href=&quot;https://www.tapirgames.com/blog/golang-interface-implementation&quot;&gt;ä¹ä¸ç‰ˆ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç†è§£äº†ä¹ä¸ç‰ˆçš„åŸºç¡€ä¸Šå¦‚æœæœ‰å…´è¶£è¿˜å¯ä»¥çœ‹çœ‹çœŸæ­£çš„golangå®ç°ï¼Œæ•°æ®çš„å±‚æ¬¡ç»“æ„ä¸Šæ›´ç»†åŒ–ï¼Œè€Œä¸”æœ‰ä½¿ç”¨æŒ‡é’ˆå’Œå†…å­˜åç§»ç­‰çš„èªæ˜åŠæ³•ï¼Œä¸è¯´æ˜¯å¦ä¼šæœ‰æ”¶è·ï¼Œèµ·ç ç ”ç©¶èµ·æ¥ä¸ä¼šæ— èŠï¼šPã€‚&lt;/p&gt;
</description>
<pubDate>Sat, 10 Oct 2020 17:15:00 +0000</pubDate>
<dc:creator>apocelipes</dc:creator>
<og:description>è¿™æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œgolangæ‹¾é—ä¸»è¦æ˜¯ç”¨æ¥è®°å½•ä¸€äº›é—å¿˜äº†çš„ã€å¹³æ—¶ä»æ²¡æ³¨æ„è¿‡çš„golangç›¸å…³çŸ¥è¯†ã€‚æƒ³åšæœ¬ç³»åˆ—çš„å¥‘æœºå…¶å®æ˜¯å› ä¸ºç–«æƒ…é—²ç€åœ¨å®¶æ— èŠï¼Œç½‘ä¸Šå†²æµªçš„æ—¶å€™å‘ç°äº†zhuihuä¸Šçš„goè¯­è¨€çˆ±å¥½è€…</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/apocelipes/p/13796041.html</dc:identifier>
</item>
<item>
<title>spring-boot-routeï¼ˆåä¸€ï¼‰æ•°æ®åº“é…ç½®ä¿¡æ¯åŠ å¯† - Javaæ—…é€”</title>
<link>http://www.cnblogs.com/zhixie/p/13796002.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zhixie/p/13796002.html</guid>
<description>&lt;p&gt;Spring Bootæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯è‡ªåŠ¨é…ç½®äº†ï¼Œå¤§å¤§çš„å‡å°‘äº†ä¼ ç»ŸSpringæ¡†æ¶çš„ç¹çé…ç½®ï¼Œé€šè¿‡å‡ è¡Œç®€å•çš„é…ç½®å°±å¯ä»¥å®Œæˆå…¶ä»–ç»„ä»¶çš„æ¥å…¥ã€‚æ¯”å¦‚ä½ æƒ³è¦è¿æ¥mysqlæ•°æ®åº“ï¼Œåªéœ€è¦çš„é…ç½®æ–‡ä»¶é‡Œé¢åŠ å…¥mysqlçš„ä¸€äº›é…ç½®ä¿¡æ¯å°±å¯ä»¥äº†ã€‚ä¸ºäº†ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸é€‰æ‹©åŠ å¯†è¿™äº›é‡è¦ä¿¡æ¯ã€‚æ¥ä¸‹æ¥ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•å®ç°é…ç½®åŠ å¯†æ–‡ä»¶å¹¶ä¸”æˆåŠŸè¿æ¥æ•°æ®åº“çš„ã€‚&lt;/p&gt;
&lt;p&gt;é…ç½®ä¿¡æ¯åŠ å¯†æœ‰å¥½å‡ ç§æ–¹å¼ï¼Œè¿™é‡Œæˆ‘åªè¯¦ç»†çš„å†™ä¸€ä¸‹æˆ‘æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§æ–¹å¼ã€‚é¦–å…ˆé€šè¿‡æŸç§åŠ å¯†ç®—æ³•å°†ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨åŠ å¯†ä¸²ä»£æ›¿åŸæ¥çš„æ˜æ–‡ã€‚ç„¶åè‡ªå®šä¹‰æ•°æ®æºï¼Œåœ¨è‡ªå®šä¹‰æ•°æ®æºä¸­è§£å¯†ç”¨æˆ·åå’Œå¯†ç ã€‚&lt;/p&gt;
&lt;h2 id=&quot;springbootè‡ªåŠ¨è£…é…&quot;&gt;SpringBootè‡ªåŠ¨è£…é…&lt;/h2&gt;
&lt;p&gt;SpringBootçš„è‡ªåŠ¨è£…é…ï¼Œä»¥å‰çš„æ¨æ–‡ä¸­ä¹Ÿè¯¦ç»†çš„è®²åˆ°è¿‡ï¼Œä»Šå¤©ç®€å•æ¥å¤ä¹ ä¸€ä¸‹ã€‚åœ¨æ¯ä¸ªSpring Bootçš„åº”ç”¨çš„å¯åŠ¨ç±»ä¸Šéƒ½èƒ½å‘ç°æœ‰ä¸€ä¸ªæ³¨è§£&lt;code&gt;@SpringBootApplication&lt;/code&gt;ï¼Œè¿™ä¸ªæ³¨è§£åŒ…å«çš„æ³¨è§£&lt;code&gt;@EnableAutoConfiguration&lt;/code&gt;å°±æ˜¯ç”¨æ¥å®Œæˆè‡ªåŠ¨è£…é…çš„ã€‚è¿™ä¸ªæ³¨è§£é€šè¿‡å¯¼å…¥ç±»&lt;code&gt;AutoConfigurationImportSelector&lt;/code&gt;ï¼Œè¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•&lt;code&gt;selectImports&lt;/code&gt;ï¼Œå…¶ä½œç”¨å°±æ˜¯æ‰«ææ‰€æœ‰jaråŒ…ä¸­çš„&lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ï¼Œå»åŠ è½½é‡Œé¢çš„å…·ä½“å®ç°ç±»ï¼Œå®Œæˆè‡ªåŠ¨è£…é…ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;spring-boot-autoconfigure&lt;/code&gt;jaråŒ…çš„&lt;code&gt;META-INF/spring.factories&lt;/code&gt;æ–‡ä»¶ä¸­æŒ‡å®šäº†ä¸€ä¸ªç±»ç”¨æ¥åŠ è½½æ•°æ®åº“é…ç½®ä¿¡æ¯ï¼Œè¿™ä¸ªç±»å°±æ˜¯&lt;code&gt;org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;è‡ªå®šä¹‰æ•°æ®æº&quot;&gt;è‡ªå®šä¹‰æ•°æ®æº&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨&lt;code&gt;HikariDataSource&lt;/code&gt;ä½œä¸ºè‡ªå®šä¹‰çš„æ•°æ®æºï¼Œè‡ªå®šä¹‰çš„æ•°æ®æºç›®çš„å°±æ˜¯ä¸ºäº†è§£å¯†é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Configuration
public class DataSourceConfiguration {

    @Autowired
    DataSourceProperties properties;

    @Bean
    public DataSource dataSource() throws Exception{
        String username = Des3.decryptThreeDESECB(properties.getUsername(),Des3.DES3KEY);
        String password = Des3.decryptThreeDESECB(properties.getPassword(),Des3.DES3KEY);
        HikariDataSource dataSource = new HikariDataSource();
        dataSource.setDriverClassName(properties.getDriverClassName());
        dataSource.setJdbcUrl(properties.getUrl());
        dataSource.setUsername(username);
        dataSource.setPassword(password);
        return dataSource;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-yml&quot;&gt;spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/xxx
    username: aMkeRCLWqNw=
    password: rq-fzucH32I=
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…·ä½“çš„åŠ è§£å¯†ç®—æ³•è¿™é‡Œå°±ä¸åœ¨æåŠäº†ï¼Œæ ¹æ®å…·ä½“è¦æ±‚é€‰æ‹©ä¸€ç§å¯é€†çš„åŠ å¯†ç®—æ³•å°±å¯ä»¥äº†ï¼Œå¦‚æœè¿˜ä¸æ˜¯å¾ˆäº†è§£åŠ å¯†ç®—æ³•çš„ç§ç±»ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä»¥å‰å†™çš„ä¸€ç¯‡æ–‡ç« â€”â€”&lt;a href=&quot;https://mp.weixin.qq.com/s/x_y6w-F1lCN102E8KQmuvQ&quot;&gt;é¢è¯•å®˜ï¼šè¯´ä¸€ä¸‹ä½ å¸¸ç”¨çš„åŠ å¯†ç®—æ³•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ˜¯spring-boot-routeç³»åˆ—çš„ç¬¬åä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–‡ç« éƒ½æ¯”è¾ƒç®€å•ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¸®åŠ©åˆæ¬¡æ¥è§¦Spring Boot çš„åŒå­¦æœ‰ä¸€ä¸ªç³»ç»Ÿçš„è®¤è¯†ã€‚æœ¬æ–‡å·²æ”¶å½•è‡³æˆ‘çš„&lt;a href=&quot;https://github.com/binzh303/spring-boot-route&quot;&gt;github&lt;/a&gt;ï¼Œæ¬¢è¿å„ä½å°ä¼™ä¼´&lt;code&gt;star&lt;/code&gt;ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;github&lt;/strong&gt;ï¼š&lt;a href=&quot;https://github.com/binzh303/spring-boot-route&quot;&gt;https://github.com/binzh303/spring-boot-route&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç‚¹å…³æ³¨ã€ä¸è¿·è·¯&quot;&gt;ç‚¹å…³æ³¨ã€ä¸è¿·è·¯&lt;/h2&gt;
&lt;p&gt;å¦‚æœè§‰å¾—æ–‡ç« ä¸é”™ï¼Œæ¬¢è¿&lt;strong&gt;å…³æ³¨&lt;/strong&gt;ã€&lt;strong&gt;ç‚¹èµ&lt;/strong&gt;ã€&lt;strong&gt;æ”¶è—&lt;/strong&gt;ï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘åˆ›ä½œçš„åŠ¨åŠ›ï¼Œæ„Ÿè°¢å¤§å®¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ–‡ç« å†™çš„æœ‰é—®é¢˜ï¼Œè¯·ä¸è¦åå•¬ï¼Œæ¬¢è¿ç•™è¨€æŒ‡å‡ºï¼Œæˆ‘ä¼šåŠæ—¶æ ¸æŸ¥ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ è¿˜æƒ³æ›´åŠ æ·±å…¥çš„äº†è§£æˆ‘ï¼Œå¯ä»¥å¾®ä¿¡æœç´¢ã€Œ&lt;strong&gt;Javaæ—…é€”&lt;/strong&gt;ã€è¿›è¡Œå…³æ³¨ã€‚å›å¤ã€Œ&lt;strong&gt;1024&lt;/strong&gt;ã€å³å¯è·å¾—å­¦ä¹ è§†é¢‘åŠç²¾ç¾ç”µå­ä¹¦ã€‚æ¯å¤©7:30å‡†æ—¶æ¨é€æŠ€æœ¯æ–‡ç« ï¼Œè®©ä½ çš„ä¸Šç­è·¯ä¸åœ¨å­¤ç‹¬ï¼Œè€Œä¸”æ¯æœˆè¿˜æœ‰é€ä¹¦æ´»åŠ¨ï¼ŒåŠ©ä½ æå‡ç¡¬å®åŠ›ï¼&lt;/p&gt;
</description>
<pubDate>Sat, 10 Oct 2020 16:31:00 +0000</pubDate>
<dc:creator>Javaæ—…é€”</dc:creator>
<og:description>Spring Bootæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯è‡ªåŠ¨é…ç½®äº†ï¼Œå¤§å¤§çš„å‡å°‘äº†ä¼ ç»ŸSpringæ¡†æ¶çš„ç¹çé…ç½®ï¼Œé€šè¿‡å‡ è¡Œç®€å•çš„é…ç½®å°±å¯ä»¥å®Œæˆå…¶ä»–ç»„ä»¶çš„æ¥å…¥ã€‚æ¯”å¦‚ä½ æƒ³è¦è¿æ¥mysqlæ•°æ®åº“ï¼Œåªéœ€è¦çš„é…ç½®æ–‡ä»¶é‡Œé¢åŠ å…¥mysq</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/zhixie/p/13796002.html</dc:identifier>
</item>
<item>
<title>äºŒåˆ†åªèƒ½ç”¨æ¥æŸ¥æ‰¾å…ƒç´ å—ï¼Ÿ - RioTian</title>
<link>http://www.cnblogs.com/RioTian/p/13795935.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/RioTian/p/13795935.html</guid>
<description>&lt;p&gt;&lt;img src=&quot;https://gitee.com//riotian/blogimage/raw/master/img/20201010234644.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;äºŒåˆ†æœç´¢ç®€ä»‹&quot;&gt;äºŒåˆ†æœç´¢ç®€ä»‹&lt;/h3&gt;
&lt;p&gt;åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒäºŒåˆ†æœç´¢ï¼ˆbinary searchï¼‰ä¹Ÿç§°æŠ˜åŠæœç´¢ï¼ˆhalf-interval searchï¼‰ã€å¯¹æ•°æœç´¢ï¼ˆlogarithmic searchï¼‰ï¼Œæ˜¯åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ç‰¹å®šå…ƒç´ çš„æœç´¢ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…¶åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡é€æ¬¡æ¯”è¾ƒæ•°ç»„ç‰¹å®šèŒƒå›´çš„ä¸­é—´å…ƒç´ ä¸ç›®æ ‡å…ƒç´ çš„å¤§å°ï¼Œæ¯æ¬¡ç¼©å°ä¸€åŠçš„æœç´¢èŒƒå›´ï¼Œæ¥æé«˜æœç´¢æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;äºŒåˆ†æœç´¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯ &lt;span class=&quot;math inline&quot;&gt;\(O(log n)\)&lt;/span&gt;ï¼Œç©ºé—´å¤æ‚åº¦ä¸º &lt;span class=&quot;math inline&quot;&gt;\(O(1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;äºŒåˆ†æŸ¥æ‰¾åˆ°åº•èƒ½è¿ç”¨åœ¨å“ªé‡Œï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ€å¸¸è§çš„å°±æ˜¯æ•™ç§‘ä¹¦ä¸Šçš„ä¾‹å­ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä»‹ç»çš„ä¸€èˆ¬ã€‚åœ¨&lt;strong&gt;æœ‰åºæ•°ç»„&lt;/strong&gt;ä¸­æœç´¢ç»™å®šçš„æŸä¸ªç›®æ ‡å€¼çš„ç´¢å¼•ã€‚å†æ¨å¹¿ä¸€ç‚¹ï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨é‡å¤ï¼Œä¿®æ”¹ç‰ˆçš„äºŒåˆ†æŸ¥æ‰¾å¯ä»¥è¿”å›ç›®æ ‡å€¼çš„å·¦ä¾§è¾¹ç•Œç´¢å¼•æˆ–è€…å³ä¾§è¾¹ç•Œç´¢å¼•ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;4.9859154929577&quot;&gt;
&lt;p&gt;PSï¼šä»¥ä¸Šæåˆ°çš„ä¸‰ç§äºŒåˆ†æŸ¥æ‰¾ç®—æ³•å½¢å¼åœ¨ä¸œå“¥çš„ &lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzAxODQxMDM0Mw==&amp;amp;mid=2247484507&amp;amp;idx=1&amp;amp;sn=36b8808fb8fac0e1906493347d3c96e6&amp;amp;chksm=9bd7fa53aca0734531ec9f37127c0f371344e1690918888dfb1cfdf043c40c0b43d1121e5851&amp;amp;scene=21#wechat_redirect&quot;&gt;äºŒåˆ†æŸ¥æ‰¾ç®—æ³•è¯¦è§£&lt;/a&gt; æœ‰ä»£ç è¯¦è§£ï¼Œå¦‚æœæ²¡çœ‹è¿‡å¼ºçƒˆå»ºè®®çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æŠ›å¼€æœ‰åºæ•°ç»„è¿™ä¸ªæ¯ç‡¥çš„æ•°æ®ç»“æ„ï¼ŒäºŒåˆ†æŸ¥æ‰¾å¦‚ä½•è¿ç”¨åˆ°å®é™…çš„ç®—æ³•é—®é¢˜ä¸­å‘¢ï¼Ÿå½“æœç´¢ç©ºé—´æœ‰åºçš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡äºŒåˆ†æœç´¢ã€Œå‰ªæã€ï¼Œå¤§å¹…æå‡æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;è¯´èµ·æ¥ç„ä¹å¾—å¾ˆï¼Œæœ¬æ–‡ç”¨ã€ŒKoko åƒé¦™è•‰ã€å’Œã€Œè´§ç‰©è¿è¾“ã€çš„é—®é¢˜æ¥ä¸¾ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¸€ã€koko-åƒé¦™è•‰&quot;&gt;ä¸€ã€Koko åƒé¦™è•‰&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://gitee.com//riotian/blogimage/raw/master/img/20201010234136.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼ŒKoko æ¯å°æ—¶æœ€å¤šåƒä¸€å †é¦™è•‰ï¼Œå¦‚æœåƒä¸ä¸‹çš„è¯ç•™åˆ°ä¸‹ä¸€å°æ—¶å†åƒï¼›å¦‚æœåƒå®Œäº†è¿™ä¸€å †è¿˜æœ‰èƒƒå£ï¼Œä¹Ÿåªä¼šç­‰åˆ°ä¸‹ä¸€å°æ—¶æ‰ä¼šåƒä¸‹ä¸€å †ã€‚åœ¨è¿™ä¸ªæ¡ä»¶ä¸‹ï¼Œè®©æˆ‘ä»¬ç¡®å®š Koko åƒé¦™è•‰çš„&lt;strong&gt;æœ€å°é€Ÿåº¦&lt;/strong&gt;ï¼ˆæ ¹/å°æ—¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç›´æ¥ç»™ä½ è¿™ä¸ªæƒ…æ™¯ï¼Œä½ èƒ½æƒ³åˆ°å“ªé‡Œèƒ½ç”¨åˆ°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•å—ï¼Ÿå¦‚æœæ²¡æœ‰è§è¿‡ç±»ä¼¼çš„é—®é¢˜ï¼Œææ€•æ˜¯å¾ˆéš¾æŠŠè¿™ä¸ªé—®é¢˜å’ŒäºŒåˆ†æŸ¥æ‰¾è”ç³»èµ·æ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å…ˆæŠ›å¼€äºŒåˆ†æŸ¥æ‰¾æŠ€å·§ï¼Œ&lt;strong&gt;æƒ³æƒ³å¦‚ä½•æš´åŠ›è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œç®—æ³•è¦æ±‚çš„æ˜¯ã€Œ&lt;code&gt;H&lt;/code&gt;å°æ—¶å†…åƒå®Œé¦™è•‰çš„æœ€å°é€Ÿåº¦ã€ï¼Œæˆ‘ä»¬ä¸å¦¨ç§°ä¸º&lt;code&gt;speed&lt;/code&gt;ï¼Œ&lt;strong&gt;è¯·é—®&lt;code&gt;speed&lt;/code&gt;æœ€å¤§å¯èƒ½ä¸ºå¤šå°‘ï¼Œæœ€å°‘å¯èƒ½ä¸ºå¤šå°‘å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶æœ€å°‘ä¸º 1ï¼Œæœ€å¤§ä¸º&lt;code&gt;max(piles)&lt;/code&gt;ï¼Œå› ä¸ºä¸€å°æ—¶æœ€å¤šåªèƒ½åƒä¸€å †é¦™è•‰ã€‚é‚£ä¹ˆæš´åŠ›è§£æ³•å°±å¾ˆç®€å•äº†ï¼Œåªè¦ä» 1 å¼€å§‹ç©·ä¸¾åˆ°&lt;code&gt;max(piles)&lt;/code&gt;ï¼Œä¸€æ—¦å‘ç°å‘ç°æŸä¸ªå€¼å¯ä»¥åœ¨&lt;code&gt;H&lt;/code&gt;å°æ—¶å†…åƒå®Œæ‰€æœ‰é¦™è•‰ï¼Œè¿™ä¸ªå€¼å°±æ˜¯æœ€å°é€Ÿåº¦ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;int minEatingSpeed(int[] piles, int H) {
    // piles æ•°ç»„çš„æœ€å¤§å€¼
    int max = getMax(piles);
    for (int speed = 1; speed &amp;lt; max; speed++) {
        // ä»¥ speed æ˜¯å¦èƒ½åœ¨ H å°æ—¶å†…åƒå®Œé¦™è•‰
        if (canFinish(piles, speed, H))
            return speed;
    }
    return max;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ³¨æ„è¿™ä¸ª for å¾ªç¯ï¼Œå°±æ˜¯åœ¨&lt;strong&gt;è¿ç»­çš„ç©ºé—´çº¿æ€§æœç´¢ï¼Œè¿™å°±æ˜¯äºŒåˆ†æŸ¥æ‰¾å¯ä»¥å‘æŒ¥ä½œç”¨çš„æ ‡å¿—****ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬è¦æ±‚çš„æ˜¯æœ€å°é€Ÿåº¦ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ª&lt;strong&gt;æœç´¢å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾&lt;/strong&gt;æ¥ä»£æ›¿çº¿æ€§æœç´¢ï¼Œæå‡æ•ˆç‡ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;int minEatingSpeed(int[] piles, int H) {
    // å¥—ç”¨æœç´¢å·¦ä¾§è¾¹ç•Œçš„ç®—æ³•æ¡†æ¶
    int left = 1, right = getMax(piles) + 1;
    while (left &amp;lt; right) {
        // é˜²æ­¢æº¢å‡º
        int mid = left + (right - left) / 2;
        if (canFinish(piles, mid, H)) {
            right = mid;
        } else {
            left = mid + 1;
        }
    }
    return left;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å‰©ä¸‹çš„è¾…åŠ©å‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œå¯ä»¥ä¸€æ­¥æ­¥æ‹†è§£å®ç°ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;// æ—¶é—´å¤æ‚åº¦ O(N)boolean canFinish(int[] piles, int speed, int H) {
    int time = 0;
    for (int n : piles) {
        time += timeOf(n, speed);
    }
    return time &amp;lt;= H;
}

int timeOf(int n, int speed) {
    return (n / speed) + ((n % speed &amp;gt; 0) ? 1 : 0);
}

int getMax(int[] piles) {
    int max = 0;
    for (int n : piles)
        max = Math.max(n, max);
    return max;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤ï¼Œå€ŸåŠ©äºŒåˆ†æŸ¥æ‰¾æŠ€å·§ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&quot;math inline&quot;&gt;\(O(NlogN)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&quot;äºŒã€åŒ…è£¹è¿è¾“é—®é¢˜&quot;&gt;äºŒã€åŒ…è£¹è¿è¾“é—®é¢˜&lt;/h3&gt;
&lt;p&gt;ç±»ä¼¼çš„ï¼Œå†çœ‹ä¸€é“è¿è¾“é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://gitee.com//riotian/blogimage/raw/master/img/20201010234239.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¦åœ¨&lt;code&gt;D&lt;/code&gt;å¤©å†…è¿è¾“å®Œæ‰€æœ‰è´§ç‰©ï¼Œè´§ç‰©ä¸å¯åˆ†å‰²ï¼Œå¦‚ä½•ç¡®å®šè¿è¾“çš„æœ€å°è½½é‡å‘¢ï¼ˆä¸‹æ–‡ç§°ä¸º&lt;code&gt;cap&lt;/code&gt;ï¼‰ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®æœ¬è´¨ä¸Šå’Œ Koko åƒé¦™è•‰çš„é—®é¢˜ä¸€æ ·çš„ï¼Œé¦–å…ˆç¡®å®š&lt;code&gt;cap&lt;/code&gt;çš„æœ€å°å€¼å’Œæœ€å¤§å€¼åˆ†åˆ«ä¸º&lt;code&gt;max(weights)&lt;/code&gt;å’Œ&lt;code&gt;sum(weights)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼åˆšæ‰çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦æ±‚&lt;strong&gt;æœ€å°è½½é‡&lt;/strong&gt;ï¼Œå¯ä»¥ç”¨ for å¾ªç¯ä»å°åˆ°å¤§éå†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨&lt;strong&gt;æœç´¢å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥&lt;/strong&gt;æ‰¾ç®—æ³•ä¼˜åŒ–çº¿æ€§æœç´¢ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;// å¯»æ‰¾å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾int shipWithinDays(int[] weights, int D) {
    // è½½é‡å¯èƒ½çš„æœ€å°å€¼
    int left = getMax(weights);
    // è½½é‡å¯èƒ½çš„æœ€å¤§å€¼ + 1
    int right = getSum(weights) + 1;
    while (left &amp;lt; right) {
        int mid = left + (right - left) / 2;
        if (canFinish(weights, D, mid)) {
            right = mid;
        } else {
            left = mid + 1;
        }
    }
    return left;
}

// å¦‚æœè½½é‡ä¸º capï¼Œæ˜¯å¦èƒ½åœ¨ D å¤©å†…è¿å®Œè´§ç‰©ï¼Ÿboolean canFinish(int[] w, int D, int cap) {
    int i = 0;
    for (int day = 0; day &amp;lt; D; day++) {
        int maxCap = cap;
        while ((maxCap -= w[i]) &amp;gt;= 0) {
            i++;
            if (i == w.length)
                return true;
        }
    }
    return false;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œä½ æ˜¯å¦æ˜ç™½äº†äºŒåˆ†æŸ¥æ‰¾åœ¨å®é™…é—®é¢˜ä¸­çš„åº”ç”¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ€è€ƒä½¿ç”¨ for å¾ªç¯æš´åŠ›è§£å†³é—®é¢˜ï¼Œè§‚å¯Ÿä»£ç æ˜¯å¦å¦‚ä¸‹å½¢å¼ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;for (int i = 0; i &amp;lt; n; i++)
    if (isOK(i))
        return answer;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æœç´¢ä¼˜åŒ–æœç´¢ç©ºé—´ï¼šå¦‚æœè¦æ±‚æœ€å°å€¼å°±æ˜¯æœç´¢å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†ï¼Œå¦‚æœè¦æ±‚æœ€å¤§å€¼å°±ç”¨æœç´¢å³ä¾§è¾¹ç•Œçš„äºŒåˆ†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;å¾ˆå¤šäººè§‰å¾—äºŒåˆ†æœç´¢å¾ˆç®€å•ï¼Œå®é™…ä¸ŠäºŒåˆ†æœç´¢ä¹Ÿå¯ä»¥å‡ºæ¯”è¾ƒéš¾çš„é¢˜ã€‚ç”šè‡³æœ‰äº›é¢˜ç›®ï¼Œä½ ä¸ä¸€å®šèƒ½æƒ³åˆ°ç”¨äºŒåˆ†æ³•æ¥è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶åœ¨ä¸åŒçš„æ•°æ®ç»“æ„å’Œä¸åŒçš„åº”ç”¨åœºæ™¯ä¸­ï¼Œéƒ½å¯ä»¥ä½¿ç”¨äºŒåˆ†æœç´¢çš„æ€æƒ³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/tag/binary-search/&quot;&gt;è¿™é‡Œ&lt;/a&gt; æ˜¯ leetcode ä¸­å’ŒäºŒåˆ†æœç´¢æœ‰å…³çš„ä¹ é¢˜ã€‚&lt;br/&gt;leetcode ä¸Šè¿˜æœ‰ä¸ªäºŒåˆ†æŸ¥æ‰¾çš„ &lt;a href=&quot;https://leetcode-cn.com/explore/learn/card/binary-search&quot;&gt;ä¸“é¢˜ç»ƒä¹ å¡ç‰‡&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;æœ€ç®€å•çš„äºŒåˆ†æœç´¢&quot;&gt;æœ€ç®€å•çš„äºŒåˆ†æœç´¢&lt;/h3&gt;
&lt;h3 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/circle/article/OPV954/&quot;&gt;https://leetcode-cn.com/circle/article/OPV954/&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 10 Oct 2020 15:50:00 +0000</pubDate>
<dc:creator>RioTian</dc:creator>
<og:description>äºŒåˆ†æœç´¢ç®€ä»‹ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒäºŒåˆ†æœç´¢ï¼ˆbinary searchï¼‰ä¹Ÿç§°æŠ˜åŠæœç´¢ï¼ˆhalf-interval searchï¼‰ã€å¯¹æ•°æœç´¢ï¼ˆlogarithmic searchï¼‰ï¼Œæ˜¯åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ç‰¹</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/RioTian/p/13795935.html</dc:identifier>
</item>
<item>
<title>ä½¿ç”¨æ ‘è“æ´¾åˆ¶ä½œæ™ºèƒ½å°è½¦ - DiyAbc-Eleven</title>
<link>http://www.cnblogs.com/DiyAbc/p/13795792.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/DiyAbc/p/13795792.html</guid>
<description>&lt;p&gt;ç”µå½±é‡Œï¼Œæ—¶ä¸æ—¶åœ°å¯ä»¥çœ‹åˆ°ä¸€äº›è¿™æ ·çš„åœºæ™¯ï¼Œä¸€è¾†å°è½¦ï¼Œä¸Šé¢è£…æœ‰æ‘„åƒå¤´ï¼Œè¿™è¾†å°è½¦å¯ä»¥é€šè¿‡ç”µè„‘æˆ–éƒ½æ˜¯æ‰‹æœºè¿›è¡Œè¿œç¨‹é¥æ§ï¼Œè½¦ä¸Šæ‘„åƒå¤´æ‹åˆ°çš„ç”»é¢ï¼Œå¯ä»¥å®æ—¶åœ°æ˜¾ç¤ºåœ¨ç”µè„‘æˆ–æ‰‹æœºä¸Šï¼Œå°±åƒä¸‹å›¾è¿™æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/2115834/202010/2115834-20201010225109313-1677111488.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰æ¥è§¦è¿‡è¿™æ–¹é¢çš„æœ‹å‹æˆ–è®¸ä¼šè§‰å¾—è¿™æ˜¯ä¸€é—¨å¾ˆé«˜å¤§ä¸Šçš„æŠ€æœ¯æ´»ï¼Œå…¶å®ï¼Œå¹¶ä¸ç„¶ï¼Œè¿™ç§å°è½¦åšèµ·æ¥å…¶å®å¾ˆç®€å•ã€‚é‚£ä¹ˆï¼Œè¿™æ ·å­çš„å°è½¦ï¼Œéœ€è¦æ€ä¹ˆå»åšå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œæˆ‘ä»¬åªéœ€è¦å‡†å¤‡ä¸€å—æ§åˆ¶å°è½¦çš„ç”µè·¯æ¿ï¼ˆå¼€å‘æ¿ï¼‰ï¼Œ2åˆ°4ä¸ªç”µæœºï¼ˆé©¬è¾¾ï¼‰ã€å°è½¦æ¶å­ä¸€ä¸ªã€æ‘„åƒå¤´ä»¥åŠæ‘„åƒå¤´äº‘å°ä¸€ä¸ªï¼Œä»¥ä¸Šè¿™äº›åŸºç¡€é…ä»¶ï¼Œç„¶åå¯¹å¼€å‘æ¿è¿›è¡Œç¼–ç¨‹ã€æ§åˆ¶å°±å¯ä»¥äº†ï¼Œæ•´ ä½“ç¡¬ä»¶æˆæœ¬åŠ èµ·æ¥ä¸åˆ°500å—é’±ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼€å‘æ¿ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¼€å‘æ¿æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚51å•ç‰‡æœºã€æ ‘è“æ´¾ã€STM32ã€Arduinoã€micro:bitç­‰ç­‰ï¼Œéƒ½å¯ä»¥åšä¸ºå°è½¦çš„æ§åˆ¶æ¿ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯æ ‘è“æ´¾å¼€å‘æ¿ï¼Œç„¶åï¼Œå¯æŒæ ‘è“æ´¾æœ‰å¾ˆå¤šç‰ˆæœ¬ã€å‹å·ï¼Œæœ€ä¾¿å®œçš„æ ‘è“æ´¾zero 68å…ƒå°±å¯ä»¥ä¹°åˆ°ï¼Œä¸è¿‡ä¸å»ºè®®ä¹°è¿™ç§ï¼Œæ²¡æœ‰ç½‘å¡ï¼Œéœ€è¦å¦å¤–ä¹°ç½‘çº¿æ¨¡å—ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯æ ‘è“æ´¾3Bï¼Œä»·æ ¼220å…ƒï¼Œå¸¦æœ‰æ— çº¿å’Œæœ‰çº¿ç½‘å¡ï¼Œè¿˜å¸¦æœ‰è“ç‰™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/2115834/202010/2115834-20201010225251516-538873627.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°è½¦æ¶å­ï¼š&lt;/strong&gt;æŸå®ä¸Šæœ‰å¾ˆå¤šè¿™ç§è½¦æ¶å­ï¼Œå„å¼å„æ ·çš„ï¼Œåªéœ€è¦åœ¨æŸå®ä¸Šæœç´¢â€œæ™ºèƒ½å°è½¦â€å°±èƒ½æ‰¾åˆ°ï¼Œå¸¦ä¸Šé©¬è¾¾ä¸€æ•´å¥—ï¼Œä¹Ÿå°±äº”å…­åå—é’±ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/2115834/202010/2115834-20201010225259838-862430688.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‘„åƒå¤´+äº‘å°ï¼š&lt;/strong&gt;æŸå®ä¸Šä¹Ÿæ˜¯ä¸€æœä¸€å¤§å †ï¼Œæ¯”å¦‚æˆ‘ä¸‹é¢ç”¨çš„é‚£ä¸ªï¼Œ45å—é’±ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/2115834/202010/2115834-20201010225310681-1468725279.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;é…ä»¶å‡†å¤‡å¥½äº†ï¼Œå°±æ˜¯ç»™å°è½¦çš„å¼€å‘æ¿è£…ç³»ç»Ÿï¼Œç„¶åå¯¹å°è½¦è¿›è¡Œç¼–ç¨‹æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;å°è½¦çš„æ§åˆ¶æœ€ä¸»è¦æœ‰ä¸¤æ–¹é¢çš„æ§åˆ¶ï¼Œä¸€ä¸ªæ˜¯å°è½¦çš„å‰åå·¦å³çš„è¿åŠ¨æ§åˆ¶ï¼Œä¸€ä¸ªæ˜¯æ‘„åƒå¤´çš„æ‹æ‘„ã€ä¸Šä¸‹å·¦å³è½¬è¿çš„æ§åˆ¶ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;77&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;-*- coding:UTF-8 -*-&lt;/span&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; RPi.GPIO as GPIO
&lt;/span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; time

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦ç”µæœºå¼•è„šå®šä¹‰&lt;/span&gt;
LeftIn1 = 20&lt;span&gt;
LeftIn2 &lt;/span&gt;= 21&lt;span&gt;
LeftSpeed &lt;/span&gt;= 16&lt;span&gt;


RightIn1 &lt;/span&gt;= 19&lt;span&gt;
RightIn2 &lt;/span&gt;= 26&lt;span&gt;
RightSpeed &lt;/span&gt;= 13

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è®¾ç½®GPIOå£ä¸ºBCMç¼–ç æ–¹å¼&lt;/span&gt;
&lt;span&gt;GPIO.setmode(GPIO.BCM)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å¿½ç•¥è­¦å‘Šä¿¡æ¯&lt;/span&gt;
&lt;span&gt;GPIO.setwarnings(False)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;ç”µæœºå¼•è„šåˆå§‹åŒ–æ“ä½œ&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; car_init():
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; pwm_LeftSpeed
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; pwm_RightSpeed
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; delaytime
    GPIO.setup(LeftSpeed,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)
    GPIO.setup(LeftIn1,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)
    GPIO.setup(LeftIn2,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)

    GPIO.setup(RightSpeed,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)
    GPIO.setup(RightIn1,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)
    GPIO.setup(RightIn2,GPIO.OUT,initial&lt;/span&gt;=&lt;span&gt;GPIO.LOW)

    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è®¾ç½®pwmå¼•è„šå’Œé¢‘ç‡ä¸º2000hz&lt;/span&gt;
    pwm_LeftSpeed = GPIO.PWM(LeftSpeed, 2000&lt;span&gt;)
    pwm_RightSpeed &lt;/span&gt;= GPIO.PWM(RightSpeed, 2000&lt;span&gt;)
    pwm_LeftSpeed.start(0)
    pwm_RightSpeed.start(0)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦å‰è¿›   &lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; run(delaytime):
    GPIO.output(LeftIn1, GPIO.HIGH)
    GPIO.output(LeftIn2, GPIO.LOW)

    GPIO.output(RightIn1, GPIO.HIGH)
    GPIO.output(RightIn2, GPIO.LOW)

    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦åé€€&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; back(delaytime):
    GPIO.output(LeftIn1, GPIO.LOW)
    GPIO.output(LeftIn2, GPIO.HIGH)
    GPIO.output(RightIn1, GPIO.LOW)
    GPIO.output(RightIn2, GPIO.HIGH)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦å·¦è½¬   &lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; left(delaytime):
    GPIO.output(LeftIn1, GPIO.LOW)
    GPIO.output(LeftIn2, GPIO.LOW)
    GPIO.output(RightIn1, GPIO.HIGH)
    GPIO.output(RightIn2, GPIO.LOW)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦å³è½¬&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; right(delaytime):
    GPIO.output(LeftIn1, GPIO.HIGH)
    GPIO.output(LeftIn2, GPIO.LOW)
    GPIO.output(RightIn1, GPIO.LOW)
    GPIO.output(RightIn2, GPIO.LOW)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦åŸåœ°å·¦è½¬&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; spin_left(delaytime):
    GPIO.output(LeftIn1, GPIO.LOW)
    GPIO.output(LeftIn2, GPIO.HIGH)
    GPIO.output(RightIn1, GPIO.HIGH)
    GPIO.output(RightIn2, GPIO.LOW)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦åŸåœ°å³è½¬&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; spin_right(delaytime):
    GPIO.output(LeftIn1, GPIO.HIGH)
    GPIO.output(LeftIn2, GPIO.LOW)
    GPIO.output(RightIn1, GPIO.LOW)
    GPIO.output(RightIn2, GPIO.HIGH)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°è½¦åœæ­¢   &lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; brake(delaytime):
    GPIO.output(LeftIn1, GPIO.LOW)
    GPIO.output(LeftIn2, GPIO.LOW)
    GPIO.output(RightIn1, GPIO.LOW)
    GPIO.output(RightIn2, GPIO.LOW)
    pwm_LeftSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    pwm_RightSpeed.ChangeDutyCycle(&lt;/span&gt;80&lt;span&gt;)
    time.sleep(delaytime)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‘„åƒå¤´æ§åˆ¶æœ‰ä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯æ‹æ‘„ã€äºŒæ˜¯äº‘å°è½¬åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‘„åƒå¤´çš„æ‹æ‘„ï¼š&lt;/strong&gt;æ‹æ‘„éƒ¨åˆ†ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯mjpg-streamerï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥æŠŠå°è½¦ä¸Šçš„æ‘„åƒå¤´å½“ä½œè¿œç¨‹æ‘„åƒå¤´ï¼ˆWeb Cameraï¼‰ä½¿ç”¨ï¼Œå®‰è£…çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å®‰è£…å¿…è¦çš„åº“&lt;/span&gt;
sudo apt-&lt;span&gt;get update
sudo apt&lt;/span&gt;-get install libjpeg8-&lt;span&gt;dev
sudo apt&lt;/span&gt;-&lt;span&gt;get install imagemagick
sudo apt&lt;/span&gt;-get install libv4l-&lt;span&gt;dev
sudo apt&lt;/span&gt;-&lt;span&gt;get autoremove cmake
sudo apt&lt;/span&gt;-get install cmake
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¿…è¦åº“å®‰è£…å¥½åï¼Œä¸‹è½½mjpg-streameråˆ°æ ‘è“æ´¾ä¸Šï¼Œå¹¶æ‰§è¡Œç¼–è¯‘å³å¯ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
cd mjpg-streamer/mjpg-streamer-&lt;span&gt;experimental
make all
sudo make install&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡ä»¥ä¸Šæ“ä½œï¼Œå°±å¯ä»¥å¯åŠ¨æ‘„åƒå¤´äº†ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è¿è¡Œmjpg-streamer&lt;/span&gt;
&lt;span&gt;
.&lt;/span&gt;/mjpg_streamer -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;./input_uvc.so&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; -o &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;./output_http.so -w ./www&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‘„åƒå¤´å¯åŠ¨åï¼Œå¯ä»¥åœ¨å±€åŸŸç½‘å†…çš„ä»»ä½•ä¸€å°ç”µè„‘ä¸Šä½¿ç”¨æµè§ˆå™¨è¾“å…¥ï¼š&lt;a href=&quot;http://xn--ip-t68di3qyq6a:8080/?action=stream&quot; rel=&quot;nofollow&quot;&gt;http://æ ‘è“æ´¾IP:8080/?action=stream&lt;/a&gt;Â å³å¯çœ‹åˆ°æ‘„åƒå¤´æ‹åˆ°çš„ç”»é¢ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;äº‘å°æ§åˆ¶ï¼š&lt;/strong&gt;äº‘å°çš„ä¸»æ˜¯å¯¹æ§åˆ¶ä¸Šä¸‹å’Œå·¦å³çš„ä¸¤èˆµæœºè¿›è¡Œç¼–ç æ§åˆ¶ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; RPi.GPIO as GPIO
&lt;/span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; time
&lt;/span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; pygame


&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;èˆµæœºå¼•è„šå®šä¹‰&lt;/span&gt;
ServoUpDownPin = 9&lt;span&gt;
ServoLeftRightPin &lt;/span&gt;= 11

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è®¾ç½®GPIOå£ä¸ºBCMç¼–ç æ–¹å¼&lt;/span&gt;
&lt;span&gt;GPIO.setmode(GPIO.BCM)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å¿½ç•¥è­¦å‘Šä¿¡æ¯&lt;/span&gt;
&lt;span&gt;GPIO.setwarnings(False)


&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;åˆå§‹åŒ–ä¸Šä¸‹å·¦å³è§’åº¦ä¸º90åº¦&lt;/span&gt;
ServoLeftRightPos = 90&lt;span&gt;
ServoUpDownPos &lt;/span&gt;= 90

&lt;span&gt;def&lt;/span&gt;&lt;span&gt; init():
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; pwm_UpDownServo
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; pwm_LeftRightServo
    
    GPIO.setup(ServoUpDownPin, GPIO.OUT)
    GPIO.setup(ServoLeftRightPin, GPIO.OUT)
    
    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è®¾ç½®èˆµæœºçš„é¢‘ç‡å’Œèµ·å§‹å ç©ºæ¯”&lt;/span&gt;
    pwm_UpDownServo = GPIO.PWM(ServoUpDownPin, 50&lt;span&gt;)
    pwm_LeftRightServo &lt;/span&gt;= GPIO.PWM(ServoLeftRightPin, 50&lt;span&gt;)
    
    pwm_UpDownServo.start(0)
    pwm_LeftRightServo.start(0)


&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºå·¦å³æ—‹è½¬åˆ°æŒ‡å®šè§’åº¦&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; leftrightservo_appointed_detection(pos): 
    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; i &lt;span&gt;in&lt;/span&gt; range(1&lt;span&gt;):   
        pwm_LeftRightServo.ChangeDutyCycle(&lt;/span&gt;2.5 + 10 * pos/180&lt;span&gt;)
        time.sleep(&lt;/span&gt;0.02)                            &lt;span&gt;#&lt;/span&gt;&lt;span&gt;ç­‰å¾…20mså‘¨æœŸç»“æŸ&lt;/span&gt;
        pwm_LeftRightServo.ChangeDutyCycle(0)  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºä¸Šä¸‹æ—‹è½¬åˆ°æŒ‡å®šè§’åº¦&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; updownservo_appointed_detection(pos):  
    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; i &lt;span&gt;in&lt;/span&gt; range(1&lt;span&gt;):  
        pwm_UpDownServo.ChangeDutyCycle(&lt;/span&gt;2.5 + 10 * pos/180&lt;span&gt;)
        time.sleep(&lt;/span&gt;0.02)                            &lt;span&gt;#&lt;/span&gt;&lt;span&gt;ç­‰å¾…20mså‘¨æœŸç»“æŸ&lt;/span&gt;
        pwm_UpDownServo.ChangeDutyCycle(0) &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;
        
        

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºå‘ä¸Šè¿åŠ¨&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_up():
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; ServoUpDownPos
    pos &lt;/span&gt;=&lt;span&gt; ServoUpDownPos
    updownservo_appointed_detection(pos)
    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;time.sleep(0.05)&lt;/span&gt;
    pos +=0.7&lt;span&gt; 
    ServoUpDownPos &lt;/span&gt;=&lt;span&gt; pos
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; ServoUpDownPos &amp;gt;= 180&lt;span&gt;:
        ServoUpDownPos &lt;/span&gt;= 180

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºå‘ä¸‹è¿åŠ¨      &lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_down():
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; ServoUpDownPos
    pos &lt;/span&gt;=&lt;span&gt; ServoUpDownPos
    updownservo_appointed_detection(pos)
    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;time.sleep(0.05)&lt;/span&gt;
    pos -= 0.7&lt;span&gt;
    ServoUpDownPos &lt;/span&gt;=&lt;span&gt; pos
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; ServoUpDownPos &amp;lt;= 45&lt;span&gt;:
        ServoUpDownPos &lt;/span&gt;= 45
    

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºå‘å·¦è¿åŠ¨&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_left():
    &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;servo_left&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; ServoLeftRightPos
    pos &lt;/span&gt;=&lt;span&gt; ServoLeftRightPos
    leftrightservo_appointed_detection(pos)
    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;time.sleep(0.10)&lt;/span&gt;
    pos += 0.7&lt;span&gt;
    ServoLeftRightPos &lt;/span&gt;=&lt;span&gt; pos
    &lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;ServoLeftRightPos:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;,ServoLeftRightPos)
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; ServoLeftRightPos &amp;gt;= 180&lt;span&gt;:
        ServoLeftRightPos &lt;/span&gt;= 180

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‘„åƒå¤´èˆµæœºå‘å³è¿åŠ¨&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_right():
    &lt;/span&gt;&lt;span&gt;global&lt;/span&gt;&lt;span&gt; ServoLeftRightPos
    pos &lt;/span&gt;=&lt;span&gt; ServoLeftRightPos
    leftrightservo_appointed_detection(pos)
    &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;time.sleep(0.10)&lt;/span&gt;
    pos -= 0.7&lt;span&gt; 
    ServoLeftRightPos &lt;/span&gt;=&lt;span&gt; pos
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; ServoLeftRightPos &amp;lt;=&lt;span&gt; 0:
        ServoLeftRightPos &lt;/span&gt;=&lt;span&gt;  0
        
        
&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ‰€æœ‰èˆµæœºå½’ä½&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_init():
    servoflag &lt;/span&gt;=&lt;span&gt; 0
    servoinitpos &lt;/span&gt;= 90
    &lt;span&gt;if&lt;/span&gt; servoflag !=&lt;span&gt; servoinitpos:  
        updownservo_appointed_detection(servoinitpos)
        leftrightservo_appointed_detection(servoinitpos)
        time.sleep(&lt;/span&gt;0.5&lt;span&gt;)        
        pwm_LeftRightServo.ChangeDutyCycle(0)   &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;
        pwm_UpDownServo.ChangeDutyCycle(0)  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;
    
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;èˆµæœºåœæ­¢&lt;/span&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; servo_stop():
    pwm_LeftRightServo.ChangeDutyCycle(0)   &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;
    pwm_UpDownServo.ChangeDutyCycle(0)  &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½’é›¶ä¿¡å·&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯¹å°è½¦çš„æ§åˆ¶ç¼–ç¨‹å®Œæˆåï¼Œæœ€åæˆ‘ä»¬ä½¿ç”¨WebSocketè¿œç¨‹è¿æ¥å°è½¦ï¼Œå‘é€ç›¸å…³çš„æ§åˆ¶å‘½ä»¤ï¼Œå°±å¯ä»¥ä½¿ç”¨ç”µè„‘æˆ–æ‰‹æœºè¿œç¨‹æ§åˆ¶å°è½¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;Â &lt;img src=&quot;https://img2020.cnblogs.com/blog/2115834/202010/2115834-20201010225109313-1677111488.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;å®Œæ•´çš„æ•™å­¦è§†é¢‘å¯æŸ¥çœ‹ï¼š&lt;a href=&quot;http://www.diyabc.com/frontweb/product400.html&quot; rel=&quot;nofollow&quot;&gt;http://www.diyabc.com/frontweb/product400.html&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

</description>
<pubDate>Sat, 10 Oct 2020 14:59:00 +0000</pubDate>
<dc:creator>DiyAbc-Eleven</dc:creator>
<og:description>ç”µå½±é‡Œï¼Œæ—¶ä¸æ—¶åœ°å¯ä»¥çœ‹åˆ°ä¸€äº›è¿™æ ·çš„åœºæ™¯ï¼Œä¸€è¾†å°è½¦ï¼Œä¸Šé¢è£…æœ‰æ‘„åƒå¤´ï¼Œè¿™è¾†å°è½¦å¯ä»¥é€šè¿‡ç”µè„‘æˆ–éƒ½æ˜¯æ‰‹æœºè¿›è¡Œè¿œç¨‹é¥æ§ï¼Œè½¦ä¸Šæ‘„åƒå¤´æ‹åˆ°çš„ç”»é¢ï¼Œå¯ä»¥å®æ—¶åœ°æ˜¾ç¤ºåœ¨ç”µè„‘æˆ–æ‰‹æœºä¸Šï¼Œå°±åƒä¸‹å›¾è¿™æ ·ã€‚ æ²¡æœ‰æ¥è§¦è¿‡è¿™æ–¹é¢çš„æœ‹å‹</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/DiyAbc/p/13795792.html</dc:identifier>
</item>
<item>
<title>é™æ€åˆ†æ´¾ä¸åŠ¨æ€åˆ†æ´¾â€”â€”è®°ä¸€æ¬¡è¢«è…¾è®¯é¢è¯•å®˜æš´è™çš„é¢è¯•ç»å† - wunsiang</title>
<link>http://www.cnblogs.com/wunsiang/p/13795782.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/wunsiang/p/13795782.html</guid>
<description>&lt;p&gt;åœ¨è…¾è®¯çš„é¢è¯•ä¸­è¢«é—®åˆ°äº†é‡è½½çš„è¿è¡Œæ—¶å¤šæ€æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ˜¾ç„¶è¿™ä¸€å—æ˜¯æˆ‘çš„çŸ¥è¯†ç›²åŒºï¼Œæ‰€ä»¥èµ¶ç´§è¡¥å……ä¸‹ã€‚&lt;/p&gt;&lt;div id=&quot;cnblogs_post_body&quot; readability=&quot;86.82426199262&quot;&gt;
&lt;p&gt;åœ¨è…¾è®¯çš„é¢è¯•ä¸­è¢«é—®åˆ°äº†é‡è½½çš„è¿è¡Œæ—¶å¤šæ€æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ˜¾ç„¶è¿™ä¸€å—æ˜¯æˆ‘çš„çŸ¥è¯†ç›²åŒºï¼Œæ‰€ä»¥èµ¶ç´§è¡¥å……ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;é™æ€åˆ†æ´¾&quot;&gt;é™æ€åˆ†æ´¾&lt;/h2&gt;
&lt;p&gt;ä¾èµ–é™æ€ç±»å‹æ¥å®šä½æ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾åŠ¨ä½œç§°ä½œé™æ€åˆ†æ´¾ï¼Œé™æ€åˆ†æ´¾çš„å…¸å‹æ˜¯æ–¹æ³•é‡è½½ã€‚å¦‚ä¸‹ä»£ç å®ä¾‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class StaticDispatch {
    static abstract class Human {
    }

    static class Man extends Human {
    }

    static class Woman extends Human {
    }

    public void sayHello (Human guy) {
        System.out.println(&quot;hello,guy&quot;);
    }

    public void sayHello (Man guy) {
        System.out.println(&quot;hello,gentleman&quot;);
    }

    public void sayHello (Woman guy) {
        System.out.println(&quot;hello,lady&quot;);
    }

    public static void main(String[] args) {
        Human man = new Man();
        Human woman = new Woman();
        StaticDispatch sr = new StaticDispatch();
        sr.sayHello(man);//hello,guy!
        sr.sayHello(woman);//hello,guy!
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯¹äºè¿™æ®µä»£ç çš„è¿è¡Œç»“æœæƒ³å¿…å¤§å®¶éƒ½å¾ˆæ¸…æ¥šï¼Œç©¶å…¶åŸå› ï¼Œé‡è½½çš„æ–¹æ³•è°ƒç”¨æ˜¯ç”±é™æ€ç±»å‹è€Œéå®é™…ç±»å‹å†³å®šçš„ï¼Œåœ¨ç¼–è¯‘å™¨ä¾¿å†³å®šäº†ä½¿ç”¨å“ªä¸ªé‡è½½ç‰ˆæœ¬ï¼Œå¹¶ä¼šæŠŠè¿™ä¸ªæ–¹æ³•çš„ç¬¦å·å¼•ç”¨å†™åˆ°main()æ–¹æ³•çš„ä¸¤æ¡invokevirtualæŒ‡ä»¤çš„å‚æ•°ä¸­ã€‚&lt;br/&gt;æ€»ç»“ï¼šJavaé‡è½½æ˜¯åŸºäºé™æ€åˆ†æ´¾å®Œæˆçš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŠ¨æ€åˆ†æ´¾&quot;&gt;åŠ¨æ€åˆ†æ´¾&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“Javaå¤šæ€æ€§å¦ä¸€ç§å®ç°æ–¹å¼æ˜¯â€œé‡å†™â€ï¼Œè€Œè¿™ç§è¿è¡Œæ—¶å¤šæ€ç¼–è¯‘å™¨æ˜¯ä¸å¯èƒ½çŸ¥é“å®ƒçš„å®é™…è°ƒç”¨çš„å®ä¾‹çš„ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;Scanner in = new Scanner(System.in);
Person person = null;
if (in.nextLine().equals(&quot;chinese&quot;)) {
    person = new Chinese();
} else {
    person = new English();
}
person.sayHello();
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨é‡è½½çš„åœºæ™¯ä¸‹ï¼ŒJVMä½¿ç”¨çš„æ˜¯åŠ¨æ€åˆ†æ´¾ï¼Œå³åœ¨è¿è¡Œæ—¶ç¡®å®šæ¥å—è€…çš„å®é™…ç±»å‹ã€‚JVMä¼šåœ¨æ“ä½œæ•°æ ˆä¸­æ‰¾åˆ°æŒ‡å‘å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œä¹‹ååœ¨è¯¥ç±»çš„æ–¹æ³•è¡¨ï¼ˆå­˜åœ¨æ–¹æ³•åŒºä¸­ï¼Œå­˜æ”¾ç€å„ä¸ªæ–¹æ³•çš„å®é™…å…¥å£ï¼‰ä¸­æ‰¾åˆ°å¯¹åº”æè¿°ç¬¦å’Œå’Œç®€å•åç§°éƒ½ç›¸ç¬¦çš„æ–¹æ³•ï¼ŒåŒæ—¶è¿›è¡Œè®¿é—®æƒé™æ ¡éªŒï¼Œå¦‚é€šè¿‡åˆ™æŸ¥æ‰¾è¿‡ç¨‹ç»“æŸã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ–¹æ³•ï¼Œåˆ™é€šè¿‡ç»§æ‰¿å…³ç³»åœ¨è¯¥ç±»çš„çˆ¶ç±»çš„æ–¹æ³•è¡¨ä¸­æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°åˆ™ç»“æŸï¼Œå¦åˆ™æŠ›å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.ibm.com/developerworks/cn/java/j-lo-polymorph/&quot;&gt;å¤šæ€åœ¨ Java å’Œ C++ ç¼–ç¨‹è¯­è¨€ä¸­çš„å®ç°æ¯”è¾ƒ&lt;/a&gt;&lt;br/&gt;ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹&lt;/p&gt;
&lt;/div&gt;</description>
<pubDate>Sat, 10 Oct 2020 14:56:00 +0000</pubDate>
<dc:creator>wunsiang</dc:creator>
<og:description>åœ¨è…¾è®¯çš„é¢è¯•ä¸­è¢«é—®åˆ°äº†é‡è½½çš„è¿è¡Œæ—¶å¤šæ€æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ˜¾ç„¶è¿™ä¸€å—æ˜¯æˆ‘çš„çŸ¥è¯†ç›²åŒºï¼Œæ‰€ä»¥èµ¶ç´§è¡¥å……ä¸‹ã€‚</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/wunsiang/p/13795782.html</dc:identifier>
</item>
</channel>
</rss>