<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>Error while instantiating 'org.apache.spark.sql.hive.HiveSessionStateBuilder':  â€”â€” windows å¼€å‘ç¯å¢ƒä½¿ç”¨spark æ— æ³•è®¿é—®hdfs é—®é¢˜è§£å†³ - åŠªåŠ›å°±æ˜¯é­…åŠ›</title>
<link>http://www.cnblogs.com/nulijiushimeili/p/14147751.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/nulijiushimeili/p/14147751.html</guid>
<description>&lt;p&gt;## é”™è¯¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1364969/202012/1364969-20201217084126030-1722667915.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Â ## è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ hadoop çš„å¯æ‰§è¡ŒtaråŒ…ï¼Œè§£å‹æ”¾åœ¨windows æœ¬åœ°ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ã€‚ åœ¨ è§£å‹åçš„æ–‡ä»¶å¤¹çš„binç›®å½•ä¸‹æ”¾å…¥ä¸¤ä¸ªæ–‡ä»¶ï¼š winutils.exe, hadoop.dllÂ Â &lt;/p&gt;
&lt;p&gt;## windows ä¸Šhadoop å·¥å…·çš„è·å–ï¼šhttps://github.com/steveloughran/winutils/tree/master/hadoop-2.6.4/binÂ  Â  Â  Â (æˆ–è€…è‡ªè¡Œç™¾åº¦ä¸€ä¸‹)&lt;/p&gt;

</description>
<pubDate>Thu, 17 Dec 2020 00:46:00 +0000</pubDate>
<dc:creator>åŠªåŠ›å°±æ˜¯é­…åŠ›</dc:creator>
<og:description>## é”™è¯¯ï¼š ## è§£å†³æ–¹æ¡ˆï¼š ä¸‹è½½ hadoop çš„å¯æ‰§è¡ŒtaråŒ…ï¼Œè§£å‹æ”¾åœ¨windows æœ¬åœ°ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ã€‚ åœ¨ è§£å‹åçš„æ–‡ä»¶å¤¹çš„binç›®å½•ä¸‹æ”¾å…¥ä¸¤ä¸ªæ–‡ä»¶ï¼š winutils.exe, had</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/nulijiushimeili/p/14147751.html</dc:identifier>
</item>
<item>
<title>å•ç²¾åº¦æµ®ç‚¹æ•°è½¬åŒ–ä¸º10è¿›åˆ¶æ•°çš„åŸç† - é’æ¤’è‚‰ä¸ä¸¶</title>
<link>http://www.cnblogs.com/qingjiaorousi/p/14147729.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/qingjiaorousi/p/14147729.html</guid>
<description>&lt;p&gt;åœ¨åšMODBUSé€šè®¯æ—¶ç»å¸¸ä¼šç”¨åˆ°å•ç²¾åº¦æµ®ç‚¹æ•°æ¥è¡¨ç¤ºæµ‹é‡å€¼ï¼Œæ¯”å¦‚41 20 00 00ä»£è¡¨åè¿›åˆ¶çš„10ï¼Œç”¨ä»£ç å¯ä»¥è½»æ¾å®ç°è½¬æ¢ï¼Œä½†æ˜¯ä»–æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„å‘¢ï¼ŸæŸ¥äº†ä¸€äº›èµ„æ–™åæˆ‘çŸ¥é“äº†è®¡ç®—çš„æ–¹æ³•ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚10ï¼Œä»–çš„å•ç²¾åº¦æµ®ç‚¹æ•°æ—¶41 20 00 00ï¼Œå…ˆå°†å…¶ä»16è¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶ï¼Œå°±æ˜¯65 32 00 00ï¼Œå†æŠŠä»–ä»¬å¯¹åº”çš„8ä½äºŒè¿›åˆ¶æ•°å†™å‡ºæ¥01000001 00100000 00000000 00000000ä¸€å…±32ä½ï¼ˆ32ä½æ˜¯å•ç²¾åº¦ï¼Œ64ä½æ˜¯åŒç²¾åº¦ï¼‰ï¼Œå†å°†å…¶ä»å³å¾€å·¦æ•°åˆ’åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š31ä½ï¼Œ30åˆ°23ä½ï¼Œ22åˆ°0ä½ã€‚&lt;br/&gt;1ã€å…¶ä¸­ç¬¬31ä½ä¸º1ä½ç¬¦å·ä½ï¼Œ0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ï¼›&lt;br/&gt;2ã€30åˆ°23ä½ä¸º8ä½æŒ‡æ•°ä½ï¼Œå¾—åˆ°1000 0010ï¼Œåè¿›åˆ¶ä¸º130ï¼›&lt;br/&gt;3ã€22åˆ°0ä½ä¸ºå°¾æ•°ä½ï¼Œå¾—åˆ°010 0000 0000 0000 0000 0000ï¼Œè¿™é‡Œç›´æ¥åœ¨å‰é¢åŠ â€œ0.â€ï¼Œå¾—åˆ°0.010 0000 0000 0000 0000 0000ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶å°æ•°çš„0.01ï¼Œå¾—åˆ°åè¿›åˆ¶0.25ï¼›&lt;br/&gt;4ã€æœ€åæ˜¯è®¡ç®—çš„å…¬å¼ï¼š10è¿›åˆ¶æ•°=(-1)^ç¬¦å·ä½ * (1+å°¾æ•°ä½) * 2^(æŒ‡æ•°ä½-127),æŠŠ1~3çš„å€¼ä»£å…¥ï¼Œ(-1 ^ 0) * (1+0.25) * 2 ^ï¼ˆ130 - 127) = 1 * 1.25 * 2^3 = 10ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¨èä¸€ä¸ªå•ç²¾åº¦æµ®ç‚¹æ•°åœ¨çº¿è½¬æ¢çš„ç½‘å€&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.styb.cn/cms/ieee_754.php&quot; target=&quot;_blank&quot;&gt;http://www.styb.cn/cms/ieee_754.php&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Thu, 17 Dec 2020 00:31:00 +0000</pubDate>
<dc:creator>é’æ¤’è‚‰ä¸ä¸¶</dc:creator>
<og:description>åœ¨åšMODBUSé€šè®¯æ—¶ç»å¸¸ä¼šç”¨åˆ°å•ç²¾åº¦æµ®ç‚¹æ•°æ¥è¡¨ç¤ºæµ‹é‡å€¼ï¼Œæ¯”å¦‚41 20 00 00ä»£è¡¨åè¿›åˆ¶çš„10ï¼Œç”¨ä»£ç å¯ä»¥è½»æ¾å®ç°è½¬æ¢ï¼Œä½†æ˜¯ä»–æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„å‘¢ï¼ŸæŸ¥äº†ä¸€äº›èµ„æ–™åæˆ‘çŸ¥é“äº†è®¡ç®—çš„æ–¹æ³•ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/qingjiaorousi/p/14147729.html</dc:identifier>
</item>
<item>
<title>IDEA 2020.3 æ›´æ–°äº†ï¼Œæœºå™¨å­¦ä¹ éƒ½æ•´ä¸Šäº† - æ¥¼ä¸‹å°é»‘å“¥</title>
<link>http://www.cnblogs.com/goodAndyxublog/p/14147692.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/goodAndyxublog/p/14147692.html</guid>
<description>&lt;p&gt;Helloï¼Œå¤§å®¶å¥½,æˆ‘æ˜¯æ¥¼ä¸‹å°é»‘å“¥~&lt;/p&gt;
&lt;p&gt;ä¸Šå‘¨ Java å¼€å‘ç”³è¯·ç¥å™¨ IDEA 2020.3 æ–°ç‰ˆæ­£å¼å‘å¸ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080557241-424080896.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å°é»‘å“¥ç¬¬ä¸€æ—¶é—´å°±åœ¨å¼€å‘æœºä¸Šæ›´æ–°äº†æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”å®Œæ•´ä½“éªŒäº†ä¸¤å‘¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬çš„ä¸»è¦åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;h3 id=&quot;1ã€å…¨æ–°çš„æ¬¢è¿çª—å£ï¼Œæ›´åŠ äººæ€§åŒ–&quot;&gt;1ã€å…¨æ–°çš„æ¬¢è¿çª—å£ï¼Œæ›´åŠ äººæ€§åŒ–&lt;/h3&gt;
&lt;p&gt;IDEA æ¬¢è¿çª—å£å…¨æ–°å‡çº§ï¼Œé¦–é¡µå¢åŠ ä¸‰ä¸ªé€‰é¡¹å¡ï¼Œä¸€ä¸ªç”¨äºè®¾ç½® IDE ç•Œé¢çš„ &lt;em&gt;Customize&lt;/em&gt;ï¼Œä¸€ä¸ªç”¨äºæ’ä»¶å®‰è£…çš„ &lt;em&gt;Plugins&lt;/em&gt;ï¼Œä¸€ä¸ªäºè®¿é—®å¸®åŠ©å’Œå­¦ä¹ èµ„æºçš„ &lt;em&gt;Learn IntelliJ IDEA&lt;/em&gt;ï¼Œå¦å¤–åŒ…æ‹¬ä¹‹å‰ç”¨äºç®¡ç†é¡¹ç›®çš„ &lt;em&gt;Projects&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080557901-526855778.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç‰¹åˆ«æä¸€ä¸‹ &lt;strong&gt;Learn IntelliJ IDEA&lt;/strong&gt; ï¼Œæˆ‘ä»¬å¯ä»¥ä»é¦–é¡µæ‰“å¼€è¿›å…¥Learn IntelliJ IDEA é¡µé¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080558228-1612337260.jpg&quot; alt=&quot;Learn IntelliJ IDEA&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªé¡µé¢ï¼Œä½ å¯ä»¥é€‰æ‹©å¤šä¸ªäº¤äº’è¯¾ç¨‹ï¼Œä»ä¸­å­¦ä¹  IDEA åŸºæœ¬åŠŸèƒ½ï¼Œå¿«æ·é”®ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ä¸€ä¸ª IDEA åˆå­¦è€…å»ºè®®ä½ å¤šä½¿ç”¨ &lt;strong&gt;Learn IntelliJ IDEA&lt;/strong&gt; åŠŸèƒ½ï¼Œå¤šåŠ ç»ƒä¹  IDEA å¿«æ·é”®ç­‰åŠŸèƒ½ï¼Œè¿™å¯ä»¥æˆå€çš„æå‡ä½ çš„ç¼–ç æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬çš„ IDEAï¼Œæš‚æ—¶ä¸èƒ½å‡çº§ï¼Œä¹Ÿæ²¡å…³ç³»çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥å®‰è£…ä¸€ä¸ªæ’ä»¶ &lt;strong&gt;IDE Features Trainer&lt;/strong&gt;ï¼Œå®‰è£…ä¹‹åå°†ä¼šæœ‰ä¸Šé¢ç»ƒä¹ åŠŸèƒ½äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080558603-1539095277.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;2ã€é˜…è¯»å™¨æ¨¡å¼&quot;&gt;2ã€é˜…è¯»å™¨æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å¦‚æœæ‰“å¼€äºŒæ–¹åŒ…ç±»ã€æ–‡ä»¶æˆ–è€…è¯´å…¶ä»–åªè¯»æ–‡ä»¶ï¼ŒIDEA å°†ä¼šé»˜è®¤åœ¨é˜…è¯»å™¨æ¨¡å¼ä¸‹æ‰“å¼€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¨¡å¼ï¼Œæ³¨é‡Šå†…å®¹å°†ä¼šè¢«æ ¼å¼åŒ–ï¼Œæ›´åŠ å®¹æ˜“è¢«é˜…è¯»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080559345-1058717633.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»å³ä¸Šçš„ &lt;strong&gt;Reader Mode&lt;/strong&gt;ï¼Œå¯ä»¥è¿˜åŸæˆä¹‹å‰çš„æ¨¡å¼ï¼Œå¹¶ä¸”æŒ‰é’®å°†ä¼šå˜æˆä¸‹æ–¹çš„å½¢çŠ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080559617-1042256464.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;3ã€çª—å£æ‹†åˆ†æ›´åŠ æ–¹ä¾¿&quot;&gt;3ã€çª—å£æ‹†åˆ†æ›´åŠ æ–¹ä¾¿&lt;/h3&gt;
&lt;p&gt;ä¹‹å‰ IDEA ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ‹†åˆ†çª—å£ï¼Œæ‰“å¼€ä¸¤ä¸ªç¼–è¾‘çª—å£ï¼Œåªèƒ½åœ¨é€‰æ‹©èœå•æ ä¸­æ‹†åˆ†é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080559807-704094763.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æ‹†åˆ†å®Œæˆä¹‹åï¼Œå·¦å³ä¸¤ä¸ªçª—å£æ‰“å¼€æ˜¯åŒä¸€ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰‹åŠ¨åœ¨å·¦è¾¹åˆ‡æ¢æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ IDEA æä¾›äº† &lt;strong&gt;Split and Move Right&lt;/strong&gt; çš„åŠŸèƒ½ï¼Œä¸ç”¨å†é¢å¤–æ“ä½œåˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æ‹†åˆ†æ›´åŠ æ–¹ä¾¿ï¼Œç›´æ¥ä½¿ç”¨é¼ æ ‡æ‹–æ‹½å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080601056-2068369417.gif&quot; alt=&quot;æ‹–æ”¾é€‰é¡¹å¡&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥æŠŠç»ˆç«¯çª—å£ç§»åˆ°ä»æœ€å°æ–¹ç§»åŠ¨åˆ°ä¸Šæ–¹ç¼–è¾‘çª—å£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080601933-314960633.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;4ã€ä¼˜åŒ–é‡æ„åŠŸèƒ½&quot;&gt;4ã€ä¼˜åŒ–é‡æ„åŠŸèƒ½&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬ç®€åŒ–äº†é‡æ„çš„ &lt;strong&gt;Extract method&lt;/strong&gt; åŠŸèƒ½ï¼Œæ— éœ€é‡æ–°æ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£å£°æ˜æ–¹æ³•åï¼Œæ–¹æ³•å˜é‡ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080602546-1918488327.gif&quot; alt=&quot;æ–°çš„ Extract method å¸ƒå±€&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿™ä¸ªç‰ˆæœ¬é‡æ„çš„ &lt;strong&gt;Rename&lt;/strong&gt; åŠŸèƒ½ï¼Œè¿˜å¯ä»¥é€‰æ‹©å°†ä»£ç æ³¨é‡Šä¸­çš„å­—ç¬¦ä¸²ä¸€å—ä¸€èµ· &lt;strong&gt;Rename&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080603393-465688870.gif&quot; alt=&quot;æ›´æ–°çš„ Rename é‡æ„&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;ä¸å¾—ä¸è¯´ä½¿ç”¨ IDEA é‡æ„ä»£ç çœŸçš„æ˜¯ä¸æ»‘èˆ¬ä½“éªŒ~&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&quot;5ã€debug-åŠŸèƒ½å‡çº§&quot;&gt;5ã€DEBUG åŠŸèƒ½å‡çº§&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬æˆ‘ä»¬ debug çš„æ—¶å€™ï¼Œå³è¾¹å°†ä¼šæ˜¾ç¤ºå½“å‰å˜é‡ï¼Œç›´æ¥ç‚¹å‡»ï¼Œå°†ä¼šå¿«é€Ÿå¼¹å‡ºå˜é‡çš„æŸ¥çœ‹çª—å£ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸‹å°±ä¸ç”¨è·³åˆ°ä¸‹æ–¹çš„è°ƒè¯•çª—å£ï¼Œæˆ–è€…æ‰“å¼€å˜é‡æŸ¥çœ‹çª—å£æŸ¥çœ‹å˜é‡äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080603761-63516813.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªçª—å£åŒå‡»å˜é‡çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿä¿®æ”¹å˜é‡ï¼Œä¸èˆ¬é¡ºæ»‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080604400-2090793765.gif&quot; alt=&quot;è°ƒè¯•å™¨äº¤äº’å¼æç¤º&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼ŒIDEA æ–°å¢ä¸€ç§ &lt;strong&gt;Inline Watch&lt;/strong&gt;ï¼Œå¯ä»¥åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œä»…ä»…æ˜¾ç¤ºä¸€ä¸ªå˜é‡ä¸­æŸä¸€ä¸ªå€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080605585-1772324304.gif&quot; alt=&quot;è°ƒè¯•å™¨å†…è”ç›‘è§†&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æœ€åæˆ‘ä»¬è¿˜å¯ä»¥åœ¨è°ƒè¯•å™¨ä¸­è¿›è¡ŒåŸºæœ¬çš„å†…å­˜åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªåŠŸèƒ½æ˜¯ &lt;em&gt;Show referring objects&lt;/em&gt;ï¼Œç”¨äºæŸ¥æ‰¾ä»å¯¹è±¡åˆ° GC æ ¹çš„æœ€çŸ­è·¯å¾„ã€‚ ç¬¬äºŒä¸ªåŠŸèƒ½æ˜¯ &lt;em&gt;Calculate retained size&lt;/em&gt;ï¼Œç”¨äºè®¡ç®—å¯¹è±¡çš„ä¿ç•™å¤§å°å¹¶æ˜¾ç¤ºå…¶ä¿ç•™é›†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080606195-2037042114.gif&quot; alt=&quot;åœ¨è°ƒè¯•å™¨ä¸­æ˜¾ç¤ºå¼•ç”¨å¯¹è±¡&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;6ã€ä»£ç æç¤ºæ›´åŠ æ™ºèƒ½&quot;&gt;6ã€ä»£ç æç¤ºæ›´åŠ æ™ºèƒ½&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬ä»£ç è¡¥å•å¼•å…¥æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼ŒåŸºäºæˆåƒä¸Šä¸‡çš„çœŸå®ç”¨æˆ·çš„ä»£ç è¡¥å…¨ç”¨æ³•ï¼Œå¯¹æ–¹æ³•è¿›è¡Œæ™ºèƒ½æ’åºï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´åŠ å¿«é€Ÿé€‰æ‹©ç›¸åº”çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080606739-249602711.jpg&quot; alt=&quot;æœºå™¨å­¦ä¹ ä»£ç è¡¥å…¨&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨å…¨çƒ IDEA ä½¿ç”¨è€…è¿™ä¹ˆå¤šï¼Œæ¯å¤©å¤§é‡æ ·æœ¬å¯ä»¥è¢«ç”¨ä½œæœºå™¨å­¦ä¹ ï¼ŒçŒœæƒ³ IDEA åç»­ç‰ˆæœ¬æ¨å‡ºæ›´åŠ æ™ºèƒ½çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h3 id=&quot;7ã€search-everywhere-ä¼˜åŒ–&quot;&gt;7ã€Search Everywhere ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬æˆ‘ä»¬å¯ä»¥åœ¨ Search Everywhere çª—å£ä¸­ï¼Œç›´æ¥ä½¿ç”¨ git æäº¤è®°å½•å“ˆå¸Œå’Œæ¶ˆæ¯ã€æ ‡è®°ä»¥åŠåˆ†æ”¯è¿›è¡Œå¿«é€Ÿçš„æŸ¥æ‰¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080607058-1539758024.jpg&quot; alt=&quot;éšå¤„æœç´¢æäº¤å“ˆå¸Œ&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤– Search Everywhere çª—å£è¿˜æ”¯æŒç®€å•çš„æ•°å­¦è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080607680-178833528.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;8ã€ä¼˜åŒ–-java-15-æ–°ç‰¹æ€§ä½“éªŒ&quot;&gt;8ã€ä¼˜åŒ– Java 15 æ–°ç‰¹æ€§ä½“éªŒ&lt;/h3&gt;
&lt;p&gt;Java 15 å¼•å…¥ &lt;code&gt;Record&lt;/code&gt;æ–°è¯­æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª&lt;strong&gt;çº¯æ•°æ®è½½ä½“&lt;/strong&gt;ç±»ï¼Œè€Œæˆ‘ä»¬æ— éœ€ç¼–å†™ Geter/Setter ç­‰æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆå¼•å…¥ä¸€ä¸ªè½¬åŒ–æ“ä½œï¼Œå¯ä»¥å¿«é€Ÿå°† &lt;code&gt;Record&lt;/code&gt;è½¬æ¢æˆæ™®é€š Java ç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¿«é€Ÿé™çº§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080608159-2144136837.gif&quot; alt=&quot;å°†è®°å½•è½¬æ¢ä¸ºç±»&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–å¯¹äº Java 15 å¦ä¸€ä¸ªæ–°è¯­æ³• &lt;code&gt;sealed&lt;/code&gt;ï¼Œè¿™ä¸ªç‰ˆæœ¬è¡¥å…¨ã€ä»£ç æ´å¯Ÿå’Œé‡æ„ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080608676-1261619877.gif&quot; alt=&quot;æ”¯æŒå¯†å°ç±»&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;9ã€å…¶ä»–æ”¹åŠ¨&quot;&gt;9ã€å…¶ä»–æ”¹åŠ¨&lt;/h3&gt;
&lt;ol&gt;&lt;li&gt;IDEA è‡ªå¸¦æ•°æ®åº“å·¥å…·ï¼Œç°åœ¨å¯ä»¥æ”¯æŒä½¿ç”¨ SQL æŸ¥è¯¢ MongoDBã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080609001-1073658724.jpg&quot; alt=&quot;ä½¿ç”¨ SQL æŸ¥è¯¢ MongoDB&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot; readability=&quot;0&quot;&gt;&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;Lombok ç›®å‰æˆä¸º IDEA å®˜æ–¹å†…ç½®æ’ä»¶ï¼Œä»¥åç‰ˆæœ¬å‡çº§ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒ Lombok æ’ä»¶ä¸é€‚é…ï¼Œå¯¼è‡´å…¨éƒ¨ä»£ç å·¥ç¨‹ä¸€ç‰‡çº¢äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;VSC èœå•å‡çº§ä¼˜åŒ–ï¼Œå°†ä¼šæ ¹æ®å½“å‰ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå‘½å VCS èœå•ï¼Œå¹¶ä¸”å½“å‰èœå•æ æ›´åŠ ç®€æ´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080609216-1067651312.jpg&quot; alt=&quot;æ›´æ–°çš„ VCS èœå•&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;å°ç»“&quot;&gt;å°ç»“&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢ä»‹ç»åªæ˜¯è¿™æ¬¡æ”¹åŠ¨ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œå…¨éƒ¨åŠŸèƒ½ç‚¹è¯·æŸ¥çœ‹ IDEA å®˜ç½‘ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¡¥å……ä¸€ç‚¹ï¼ŒIDEA å®˜æ–¹ç°åœ¨å·²ç»æ”¯æŒä¸­æ–‡äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080609502-391314761.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨æ¢¯å­æ‰“å¼€ï¼Œæ˜¾ç¤ºè¿˜æ˜¯è‹±æ–‡ï¼Œé‚£ä¹ˆå¯ä»¥å°†é¡µé¢æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œé‡æ–°é€‰æ‹©è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1419561/202012/1419561-20201217080609727-1839854032.jpg&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº 2020.3 åªæ˜¯ä¸€ä¸ªå°ç‰ˆæœ¬ï¼Œæ‰€ä»¥è¿™æ¬¡å¹¶æ²¡æœ‰é¢å¤–å¢ç‰¹åˆ«çš„åŠ æ–°åŠŸèƒ½ã€‚è¿™æ¬¡æ–°ç‰ˆæœ¬ä¸»è¦è¿˜æ˜¯ä¼˜åŒ– IDEA ç”¨æˆ·ä½“éªŒï¼Œè®©å¼€å‘è€…ä½¿ç”¨èµ·æ¥è¶Šæ¥è¶Šæµç•…ã€‚&lt;/p&gt;
&lt;p&gt;2020 å¹´è¿˜æœ‰ä¸€ä¸ªæœˆå°±è¿‡å»çœ‹ï¼ŒIDEA 2021 ç‰ˆæœ¬ç›¸ä¿¡å¾ˆå¿«å°±æ¥äº†ï¼ŒæœŸå¾…è¿™æ¬¡å¤§ç‰ˆæœ¬çš„åŠŸèƒ½å‡çº§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€åæ„Ÿå¹ä¸€å¥ï¼ŒIDEA ç‰›é€¼ğŸš€ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;5.5555555555556&quot;&gt;
&lt;p&gt;æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šå°é»‘åä¸€ç‚¹åŠï¼Œè·å¾—æ—¥å¸¸å¹²è´§æ¨é€ã€‚å¦‚æœæ‚¨å¯¹æˆ‘çš„ä¸“é¢˜å†…å®¹æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„åšå®¢ï¼š&lt;a href=&quot;https://studyidea.cn&quot; target=&quot;_blank&quot;&gt;studyidea.cn&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Thu, 17 Dec 2020 00:06:00 +0000</pubDate>
<dc:creator>æ¥¼ä¸‹å°é»‘å“¥</dc:creator>
<og:description>Helloï¼Œå¤§å®¶å¥½,æˆ‘æ˜¯æ¥¼ä¸‹å°é»‘å“¥~ ä¸Šå‘¨ Java å¼€å‘ç”³è¯·ç¥å™¨ IDEA 2020.3 æ–°ç‰ˆæ­£å¼å‘å¸ƒï¼š å°é»‘å“¥ç¬¬ä¸€æ—¶é—´å°±åœ¨å¼€å‘æœºä¸Šæ›´æ–°äº†æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”å®Œæ•´ä½“éªŒäº†ä¸¤å‘¨äº†ã€‚ ä¸‹é¢ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬çš„ä¸»è¦åŠŸ</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/goodAndyxublog/p/14147692.html</dc:identifier>
</item>
<item>
<title>SpringBoot-2.3é•œåƒæ–¹æ¡ˆä¸ºä»€ä¹ˆè¦åšå¤šä¸ªlayer - ç¨‹åºå‘˜æ¬£å®¸</title>
<link>http://www.cnblogs.com/bolingcavalry/p/14147683.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/bolingcavalry/p/14147683.html</guid>
<description>&lt;h3 id=&quot;æ¬¢è¿è®¿é—®æˆ‘çš„github&quot;&gt;æ¬¢è¿è®¿é—®æˆ‘çš„GitHub&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/zq2599/blog_demos&quot; target=&quot;_blank&quot;&gt;https://github.com/zq2599/blog_demos&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å†…å®¹ï¼šæ‰€æœ‰åŸåˆ›æ–‡ç« åˆ†ç±»æ±‡æ€»åŠé…å¥—æºç ï¼Œæ¶‰åŠJavaã€Dockerã€Kubernetesã€DevOPSç­‰ï¼›&lt;/p&gt;
&lt;h3 id=&quot;èƒŒæ™¯&quot;&gt;èƒŒæ™¯&lt;/h3&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://www.cnblogs.com/bolingcavalry/p/14147683.html&quot;&gt;ã€Šä½“éªŒSpringBoot(2.3)åº”ç”¨åˆ¶ä½œDockeré•œåƒ(å®˜æ–¹æ–¹æ¡ˆ)ã€‹&lt;/a&gt;ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½“éªŒäº†å®˜æ–¹æ¨èçš„é•œåƒåˆ¶ä½œæ–¹æ¡ˆï¼Œæ‰§è¡Œdocker historyå‘½ä»¤è§‚å¯Ÿé•œåƒå†…éƒ¨ï¼Œå‘ç°æ˜¯ç”±å¤šä¸ªlayerç»„æˆçš„ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075129842-2113679791.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;é—®é¢˜æ¥äº†ï¼šæè¿™ä¹ˆå¤šlayerå¹²å•¥ï¼Ÿæ¥ä¸‹æ¥ä»¥å›¾æ–‡æ–¹å¼ï¼Œæ‚¨ä¸€èµ·ç†è§£dockeré•œåƒlayerå¯¹javaå¼€å‘è€…çš„çš„ä½œç”¨ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;h3 id=&quot;å£°æ˜&quot;&gt;å£°æ˜&lt;/h3&gt;
&lt;p&gt;æœ¬æ–‡çš„ç›®æ ‡æ˜¯é€šè¿‡å›¾æ–‡å¸®åŠ©javaå¼€å‘è€…ç†è§£dockeré•œåƒçš„layerä½œç”¨ï¼Œå†…å®¹å’Œå®é™…æƒ…å†µå¹¶æœªå®Œå…¨ä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚åŸºç¡€é•œåƒçš„layeræ²¡æœ‰æåˆ°ï¼Œè€Œä¸”javaé•œåƒçš„layerå¯èƒ½ä¸æ­¢ä¸šåŠ¡é•œåƒã€é…ç½®æ–‡ä»¶ã€ä¾èµ–åº“è¿™ä¸‰å±‚ï¼›&lt;/p&gt;
&lt;h3 id=&quot;å¸¸è§è§’è‰²&quot;&gt;å¸¸è§è§’è‰²&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨dockeræ—¶ï¼Œæœ‰ä¸‰ä¸ªå¸¸è§è§’è‰²ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;é•œåƒåˆ¶ä½œè€…ï¼šæœ¬æ–‡ä¸­å°±æ˜¯SpringBootåº”ç”¨å¼€å‘è€…ï¼Œå†™å®Œä»£ç æŠŠåº”ç”¨åšæˆdockeré•œåƒï¼›&lt;/li&gt;
&lt;li&gt;dockerå…¬å…±é•œåƒä»“åº“ï¼šé•œåƒåˆ¶ä½œè€…å°†é•œåƒæ¨é€åˆ°ä»“åº“ç»™å¤§å®¶ä½¿ç”¨ï¼›&lt;/li&gt;
&lt;li&gt;é•œåƒä½¿ç”¨è€…ï¼šä»é•œåƒä»“åº“å°†é•œåƒä¸‹è½½åˆ°æœ¬åœ°ä½¿ç”¨ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;æ¥ä¸‹æ¥çš„æ•…äº‹å›´ç»•ä¸Šè¿°ä¸‰ä¸ªè§’è‰²å±•å¼€ï¼›&lt;/p&gt;
&lt;h3 id=&quot;ä»åˆ¶ä½œåˆ°ä½¿ç”¨çš„è¿‡ç¨‹&quot;&gt;ä»åˆ¶ä½œåˆ°ä½¿ç”¨çš„è¿‡ç¨‹&lt;/h3&gt;
&lt;ol&gt;&lt;li&gt;å¦‚ä¸‹å›¾ï¼ŒSpringBootåº”ç”¨å¼€å‘è€…ï¼Œå†™å®Œä»£ç æŠŠåº”ç”¨åšæˆdockeré•œåƒï¼Œè¯¥é•œåƒçš„TAGæ˜¯1.0ï¼Œæ­¤æ—¶å¼€å‘è€…å°†é•œåƒæ¨é€åˆ°å…¬å…±ä»“åº“æ—¶ï¼Œä¸€å…±è¦æ¨é€ä¸‰ä¸ªlayerï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075131151-1122989543.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥ï¼Œä½¿ç”¨è€…è¦ä¸‹è½½é•œåƒï¼Œå°±ä»é•œåƒä»“åº“ä¸‹è½½ä¸‰ä¸ªlayerï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075132073-1261637252.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶ï¼Œä¸‰ä¸ªè§’è‰²æ‹¥æœ‰çš„å†…å®¹éƒ½æ˜¯ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸‰ä¸ªlayerï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075133093-637014222.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;è¿™æ—¶å€™SpringBootå¼€å‘è€…ä¿®æ”¹äº†ä¸šåŠ¡ä»£ç ï¼Œäºæ˜¯åšäº†ä¸ªæ–°çš„é•œåƒï¼ˆTAGæ˜¯2.0ï¼‰ï¼Œç„¶åæ¨é€åˆ°é•œåƒä»“åº“ï¼›&lt;/li&gt;
&lt;li&gt;&lt;span&gt;é‡ç‚¹æ¥äº†&lt;/span&gt;ï¼šå› ä¸ºåªæ”¹äº†ä¸šåŠ¡ä»£ç ï¼Œå› æ­¤åªæœ‰ä¸šåŠ¡classçš„layeræ˜¯æ–°çš„ï¼Œåªæœ‰è¿™ä¸ªlayerä¼šè¢«æ¨é€åˆ°ä»“åº“ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075134493-2033748941.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;å¯¹é•œåƒä½¿ç”¨è€…æ¥è¯´ï¼Œå¦‚æœä¹‹å‰ä¸‹è½½è¿‡1.0çš„é•œåƒï¼Œæ­¤æ—¶è¦ç”¨2.0é•œåƒçš„è¯ï¼Œåªè¦ä»ä»“åº“ä¸‹è½½æœ€æ–°çš„ä¸šåŠ¡classçš„layerå³å¯ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075135193-455393040.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼Œå…¬å…±ä»“åº“å’Œé•œåƒä½¿ç”¨è€…éƒ½å·²æœ€å°çš„ä»£ä»·å¾—åˆ°äº†2.0é•œåƒï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/485422/202012/485422-20201217075135795-1977062764.png&quot; alt=&quot;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&quot; loading=&quot;lazy&quot;/&gt;&lt;br/&gt;å¯è§ï¼Œä½¿ç”¨å¤šä¸ªlayerçš„é•œåƒï¼Œåœ¨é•œåƒçš„åˆ†å‘è¿‡ç¨‹ä¸­ï¼Œç›¸æ¯”å•ä¸€layerçš„é•œåƒä¼šæ›´åŠ é«˜æ•ˆï¼Œå°¤å…¶æ˜¯ä½¿ç”¨hub.docker.comè¿™æ ·çš„å¤–ç½‘å…¬æœ‰ä»“åº“ï¼Œä»¥åŠé¢‘ç¹å‘å¸ƒæ–°ç‰ˆçš„åœºæ™¯ä¸‹ï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;h3 id=&quot;ä½ ä¸å­¤å•ï¼Œæ¬£å®¸åŸåˆ›ä¸€è·¯ç›¸ä¼´&quot;&gt;ä½ ä¸å­¤å•ï¼Œæ¬£å®¸åŸåˆ›ä¸€è·¯ç›¸ä¼´&lt;/h3&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105068742&quot; target=&quot;_blank&quot;&gt;Javaç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105086498&quot; target=&quot;_blank&quot;&gt;Springç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105086732&quot; target=&quot;_blank&quot;&gt;Dockerç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105086794&quot; target=&quot;_blank&quot;&gt;kubernetesç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105086850&quot; target=&quot;_blank&quot;&gt;æ•°æ®åº“+ä¸­é—´ä»¶ç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://xinchen.blog.csdn.net/article/details/105086920&quot; target=&quot;_blank&quot;&gt;DevOpsç³»åˆ—&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;h3 id=&quot;æ¬¢è¿å…³æ³¨å…¬ä¼—å·ï¼šç¨‹åºå‘˜æ¬£å®¸&quot;&gt;æ¬¢è¿å…³æ³¨å…¬ä¼—å·ï¼šç¨‹åºå‘˜æ¬£å®¸&lt;/h3&gt;
&lt;blockquote readability=&quot;4.258064516129&quot;&gt;
&lt;p&gt;å¾®ä¿¡æœç´¢ã€Œç¨‹åºå‘˜æ¬£å®¸ã€ï¼Œæˆ‘æ˜¯æ¬£å®¸ï¼ŒæœŸå¾…ä¸æ‚¨ä¸€åŒç•…æ¸¸Javaä¸–ç•Œ...&lt;br/&gt;&lt;a href=&quot;https://github.com/zq2599/blog_demos&quot; target=&quot;_blank&quot;&gt;https://github.com/zq2599/blog_demos&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Wed, 16 Dec 2020 23:52:00 +0000</pubDate>
<dc:creator>ç¨‹åºå‘˜æ¬£å®¸</dc:creator>
<og:description>æ¬¢è¿è®¿é—®æˆ‘çš„GitHub https://github.com/zq2599/blog_demos å†…å®¹ï¼šæ‰€æœ‰åŸåˆ›æ–‡ç« åˆ†ç±»æ±‡æ€»åŠé…å¥—æºç ï¼Œæ¶‰åŠJavaã€Dockerã€Kubernetesã€DevOPS</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/bolingcavalry/p/14147683.html</dc:identifier>
</item>
<item>
<title>æ­å¼€DRFåºåˆ—åŒ–æŠ€æœ¯çš„ç¥ç§˜é¢çº± - dongfanger</title>
<link>http://www.cnblogs.com/df888/p/14145364.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/df888/p/14145364.html</guid>
<description>&lt;p&gt;åœ¨RESTful APIä¸­ï¼Œæ¥å£è¿”å›çš„æ˜¯JSONï¼ŒJSONçš„å†…å®¹å¯¹åº”çš„æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®ï¼ŒDRFæ˜¯é€šè¿‡åºåˆ—åŒ–ï¼ˆSerializationï¼‰çš„æŠ€æœ¯ï¼ŒæŠŠæ•°æ®æ¨¡å‹è½¬æ¢ä¸ºJSONçš„ï¼Œåä¹‹ï¼Œå«åšååºåˆ—åŒ–ï¼ˆdeserializationï¼‰ã€‚æœ¬æ–‡å°±æ¥æ­å¼€DRFåºåˆ—åŒ–æŠ€æœ¯çš„ç¥ç§˜é¢çº±ã€‚&lt;/p&gt;

&lt;p&gt;è™šæ‹Ÿç¯å¢ƒæ˜¯ç‹¬ç«‹çš„Pythonç¯å¢ƒï¼Œå¯ä»¥å’Œç³»ç»Ÿç¯å¢ƒåˆ†ç¦»ï¼Œåªå®‰è£…éœ€è¦çš„åŒ…å³å¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºå¹¶æ¿€æ´»ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;# åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
python -m venv env
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
env\Scripts\activate.bat  
# Macä¸­ä½¿ç”¨`source env/bin/activate`
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;é€€å‡ºè™šæ‹Ÿç¯å¢ƒç”¨deactivateã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¥ç€åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…æœ¬æ–‡ç”¨åˆ°çš„åŒ…ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;pip install django
pip install djangorestframework
pip install pygments  # ä»£ç é«˜äº®
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;åˆ›å»ºprojectï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;django-admin startproject tutorial
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åˆ›å»ºappï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;cd tutorial
python manage.py startapp snippets
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨&lt;code&gt;tutorial/settings.py&lt;/code&gt;ä¸­çš„&lt;code&gt;INSTALLED_APPS&lt;/code&gt;æ·»åŠ &lt;code&gt;snippets&lt;/code&gt;å’Œ&lt;code&gt;rest_framework&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;INSTALLED_APPS = [
    ...
    'rest_framework',
    'snippets.apps.SnippetsConfig',
]
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;åªæœ‰æ·»åŠ åï¼Œappæ‰ä¼šç”Ÿæ•ˆå“¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç¼–è¾‘&lt;code&gt;snippets/models.py&lt;/code&gt;ï¼Œåˆ›å»ºSnippetæ¨¡å‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from django.db import models
from pygments.lexers import get_all_lexers
from pygments.styles import get_all_styles

LEXERS = [item for item in get_all_lexers() if item[1]]
LANGUAGE_CHOICES = sorted([(item[1][0], item[0]) for item in LEXERS])
STYLE_CHOICES = sorted([(item, item) for item in get_all_styles()])


class Snippet(models.Model):
    created = models.DateTimeField(auto_now_add=True)
    title = models.CharField(max_length=100, blank=True, default='')
    code = models.TextField()
    linenos = models.BooleanField(default=False)
    language = models.CharField(choices=LANGUAGE_CHOICES, default='python', max_length=100)
    style = models.CharField(choices=STYLE_CHOICES, default='friendly', max_length=100)

    class Meta:
        ordering = ['created']
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Snippetæœ‰6ä¸ªå­—æ®µï¼Œcreatedã€titleã€codeã€linenosã€languageã€styleã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€åŒæ­¥æ•°æ®åº“ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;python manage.py makemigrations snippets
python manage.py migrate
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;rest_framework.serializersçš„ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1629545/202012/1629545-20201216180531041-178360855.png&quot;/&gt;&lt;/center&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;æŸ¥çœ‹Pythonæ¨¡å—ä¸­çš„æˆå‘˜ï¼Œéœ€è¦å‹¾é€‰ï¼š&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1629545/202012/1629545-20201216180531437-744565507.png&quot;/&gt;&lt;/center&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹‹å‰æˆ‘ä»¬ç”¨è¿‡HyperlinkedModelSerializerï¼Œæ˜¯å°è£…åçš„ç¬¦åˆRESTfulè‰¯å¥½è®¾è®¡çš„åºåˆ—åŒ–å™¨ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨æ›´åº•å±‚çš„Serializerã€‚åœ¨&lt;code&gt;snippets&lt;/code&gt;ç›®å½•ä¸‹åˆ›å»º&lt;code&gt;serializers.py&lt;/code&gt;ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from rest_framework import serializers
from snippets.models import Snippet, LANGUAGE_CHOICES, STYLE_CHOICES


class SnippetSerializer(serializers.Serializer):
    id = serializers.IntegerField(read_only=True)
    title = serializers.CharField(required=False, allow_blank=True, max_length=100)
    code = serializers.CharField(style={'base_template': 'textarea.html'})
    linenos = serializers.BooleanField(required=False)
    language = serializers.ChoiceField(choices=LANGUAGE_CHOICES, default='python')
    style = serializers.ChoiceField(choices=STYLE_CHOICES, default='friendly')

    def create(self, validated_data):
        &quot;&quot;&quot;
        Create and return a new `Snippet` instance, given the validated data.
        &quot;&quot;&quot;
        return Snippet.objects.create(**validated_data)

    def update(self, instance, validated_data):
        &quot;&quot;&quot;
        Update and return an existing `Snippet` instance, given the validated data.
        &quot;&quot;&quot;
        instance.title = validated_data.get('title', instance.title)
        instance.code = validated_data.get('code', instance.code)
        instance.linenos = validated_data.get('linenos', instance.linenos)
        instance.language = validated_data.get('language', instance.language)
        instance.style = validated_data.get('style', instance.style)
        instance.save()
        return instance
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä»£ç ç¬¬ä¸€éƒ¨åˆ†å®šä¹‰äº†åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å­—æ®µï¼Œå­—æ®µå®šä¹‰æ–¹å¼ç±»ä¼¼äºFormã€‚ç¬¬äºŒéƒ¨åˆ†çš„&lt;code&gt;create()&lt;/code&gt;å’Œ&lt;code&gt;update()&lt;/code&gt;æ–¹æ³•å®šä¹‰äº†è°ƒç”¨&lt;code&gt;serializer.save()&lt;/code&gt;æ—¶ï¼Œåˆ›å»ºå’Œæ›´æ–°å®ä¾‹çš„å¤„ç†æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;æ—¢ç„¶å·²ç»åˆ›å»ºå¥½äº†Serializerï¼Œä½•ä¸ç©ç©å®ƒï¼Ÿåªæœ‰ç©äº†æ‰çŸ¥é“åºåˆ—åŒ–çš„æŠ€æœ¯ç»†èŠ‚ã€‚è¿™é‡Œç”¨åˆ°äº†Django shellï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œå®æ—¶çœ‹åˆ°è¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;python manage.py shell
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é¦–å…ˆé€šè¿‡æ¨¡å‹æ–°å¢2æ¡æµ‹è¯•æ•°æ®ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from snippets.models import Snippet
from snippets.serializers import SnippetSerializer
from rest_framework.renderers import JSONRenderer
from rest_framework.parsers import JSONParser

snippet = Snippet(code='foo = &quot;bar&quot;\n')
snippet.save()

snippet = Snippet(code='print(&quot;hello, world&quot;)\n')
snippet.save()
&lt;/code&gt;
&lt;/pre&gt;
&lt;center&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1629545/202012/1629545-20201216180531657-1439258875.png&quot;/&gt;&lt;/center&gt;
&lt;p&gt;æ¥ç€æŠŠå®ƒåºåˆ—åŒ–çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;serializer = SnippetSerializer(snippet)
serializer.data
# {'id': 2, 'title': '', 'code': 'print(&quot;hello, world&quot;)\n', 'linenos': False, 'language': 'python', 'style': 'friendly'}
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;å› ä¸º&lt;code&gt;snippet&lt;/code&gt;å˜é‡æœ€åå¼•ç”¨çš„æ˜¯ç¬¬2ä¸ªæ•°æ®æ¨¡å‹çš„å®ä¾‹ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¾ç¤ºç¬¬2æ¡æ•°æ®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;serializer.dataè¿”å›çš„æ˜¯ä¸ªå­—å…¸ï¼Œæœ€åæŠŠå­—å…¸è½¬æ¢ä¸ºJSONï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;content = JSONRenderer().render(serializer.data)
content
# b'{&quot;id&quot;: 2, &quot;title&quot;: &quot;&quot;, &quot;code&quot;: &quot;print(\\&quot;hello, world\\&quot;)\\n&quot;, &quot;linenos&quot;: false, &quot;language&quot;: &quot;python&quot;, &quot;style&quot;: &quot;friendly&quot;}'
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™å°±æ˜¯åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œæ¨¡å‹å®ä¾‹â†’Pythonå­—å…¸â†’JSONã€‚&lt;/p&gt;
&lt;p&gt;ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯ç±»ä¼¼çš„ï¼Œå…ˆæŠŠJSONè½¬æ¢ä¸ºPythonå­—å…¸ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;import io

stream = io.BytesIO(content)
data = JSONParser().parse(stream)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å†æŠŠå­—å…¸è½¬æ¢ä¸ºæ¨¡å‹å®ä¾‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;serializer = SnippetSerializer(data=data)
serializer.is_valid()
# True
serializer.validated_data
# OrderedDict([('title', ''), ('code', 'print(&quot;hello, world&quot;)\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')])
serializer.save()
# &amp;lt;Snippet: Snippet object&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;å› ä¸ºSnippetSerializerçš„create()æ–¹æ³•ä»£ç æ˜¯&lt;code&gt;return Snippet.objects.create(**validated_data)&lt;/code&gt;ï¼Œæ‰€ä»¥&lt;code&gt;serializer.save()&lt;/code&gt;ä¼šåœ¨æ•°æ®åº“ä¸­æ–°å¢1æ¡æ•°æ®ï¼Œå¹¶è¿”å›Snippetæ¨¡å‹å®ä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦å¤–ï¼Œåºåˆ—åŒ–å¯¹è±¡ä¸åªæœ‰æ¨¡å‹å®ä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°æ®é›†ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;serializer = SnippetSerializer(Snippet.objects.all(), many=True)
serializer.data
# [OrderedDict([('id', 1), ('title', ''), ('code', 'foo = &quot;bar&quot;\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')]), OrderedDict([('id', 2), ('title', ''), ('code', 'print(&quot;hello, world&quot;)\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')]), OrderedDict([('id', 3), ('title', ''), ('code', 'print(&quot;hello, world&quot;)'), ('linenos', False), ('language', 'python'), ('style', 'friendly')])]
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;rest_framework.serializers.Serializersæ¯”è¾ƒåº•å±‚ï¼Œéœ€è¦é‡å¤å®šä¹‰modelä¸­çš„å­—æ®µï¼ŒDRFçš„ä½œè€…å½“ç„¶ä¹Ÿæƒ³åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”ç»™å‡ºäº†è§£å†³åŠæ³•ï¼šæŠŠSerializerså°è£…æˆModelSerializersã€‚åœ¨&lt;code&gt;snippets/serializers.py&lt;/code&gt;ä¸­æ›¿æ¢&lt;code&gt;SnippetSerializer&lt;/code&gt;ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;class SnippetSerializer(serializers.ModelSerializer):
    class Meta:
        model = Snippet
        fields = ['id', 'title', 'code', 'linenos', 'language', 'style']
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å†™æ³•æœç„¶ç®€æ´äº†å¾ˆå¤šã€‚ä½¿ç”¨Django shellæ‰“å°å‡ºæ¥çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from snippets.serializers import SnippetSerializer
serializer = SnippetSerializer()
print(repr(serializer))
# SnippetSerializer():
#    id = IntegerField(label='ID', read_only=True)
#    title = CharField(allow_blank=True, max_length=100, required=False)
#    code = CharField(style={'base_template': 'textarea.html'})
#    linenos = BooleanField(required=False)
#    language = ChoiceField(choices=[('Clipper', 'FoxPro'), ('Cucumber', 'Gherkin'), ('RobotFramework', 'RobotFramework'), ('abap', 'ABAP'), ('ada', 'Ada')...
#    style = ChoiceField(choices=[('autumn', 'autumn'), ('borland', 'borland'), ('bw', 'bw'), ('colorful', 'colorful')...
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å’Œæ‰‹åŠ¨å®šä¹‰çš„å­—æ®µä¸€æ¨¡ä¸€æ ·ã€‚å…¶å®ModelSerializerå¹¶æ²¡æœ‰åšé¢å¤–çš„å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä»å®ƒçš„éƒ¨åˆ†ä»£ç ç‰‡æ®µçœ‹åˆ°:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;  serializer_field_mapping = {
        models.AutoField: IntegerField,
        models.BigIntegerField: IntegerField,
        models.BooleanField: BooleanField,
  
  
  # Default `create` and `update` behavior...
  def create(self, validated_data):
  
  
  def update(self, instance, validated_data):
      raise_errors_on_nested_writes('update', self, validated_data)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å»ºç«‹å­—æ®µæ˜ å°„ï¼Œå®šä¹‰&lt;code&gt;create()&lt;/code&gt;å’Œ&lt;code&gt;update()&lt;/code&gt;ç­‰æ–¹æ³•ï¼Œåªåšäº†æœ€ç®€å•çš„å°è£…ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¹‹å‰ç”¨çš„æ˜¯å·²ç»å°è£…å¥½çš„rest_framework.viewsetsï¼Œè¿™é‡Œç›´æ¥ç”¨DjangoåŸç”Ÿçš„viewã€‚åœ¨&lt;code&gt;snippets/views.py&lt;/code&gt;ä¸­æ·»åŠ ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from django.http import HttpResponse, JsonResponse
from django.views.decorators.csrf import csrf_exempt
from rest_framework.parsers import JSONParser
from snippets.models import Snippet
from snippets.serializers import SnippetSerializer
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…ˆåˆ›å»ºsnippet_listè§†å›¾ï¼Œè¿”å›snippetsåˆ—è¡¨æˆ–è€…æ–°å»º1ä¸ªsnippetï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;@csrf_exempt
def snippet_list(request):
    &quot;&quot;&quot;
    List all code snippets, or create a new snippet.
    &quot;&quot;&quot;
    if request.method == 'GET':
        snippets = Snippet.objects.all()
        serializer = SnippetSerializer(snippets, many=True)
        return JsonResponse(serializer.data, safe=False)

    elif request.method == 'POST':
        data = JSONParser().parse(request)
        serializer = SnippetSerializer(data=data)
        if serializer.is_valid():
            serializer.save()
            return JsonResponse(serializer.data, status=201)
        return JsonResponse(serializer.errors, status=400)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æœ¬æ–‡ç¤ºä¾‹ä¸­ï¼Œå®¢æˆ·ç«¯å‘èµ·POSTè¯·æ±‚æ˜¯ä¸å¸¦CSRF tokençš„ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ csrf_exemptï¼ˆexemptç¿»è¯‘ä¸ºå…é™¤ï¼‰è£…é¥°å™¨ï¼Œå…è®¸è·¨åŸŸè®¿é—®ã€‚è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œå®é™…ä¼šä½¿ç”¨&lt;code&gt;django-cors-headers&lt;/code&gt;æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œè€Œä¸æ˜¯ç»™æ¯ä¸ªviewéƒ½åŠ ä¸Š&lt;code&gt;@csrf_exempt&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;CSRFæ˜¯æŒ‡è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ”»å‡»è€…ç›—ç”¨ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚CSRF tokenæ˜¯æŒ‡æœåŠ¡å™¨é€šè¿‡tokenæ¥è®¤è¯ï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰tokenæˆ–è€…tokenä¸åŒ¹é…ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå¯èƒ½æ˜¯CSRFè€Œæ‹’ç»è¯¥è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¥ç€æ·»åŠ ä¸€ä¸ªviewï¼Œå¯¹å•ä¸ªsnippetè¿›è¡Œåˆ ï¼ˆdeleteï¼‰ã€æ”¹ï¼ˆupdateï¼‰ã€æŸ¥ï¼ˆretrieveï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;@csrf_exempt
def snippet_detail(request, pk):
    &quot;&quot;&quot;
    Retrieve, update or delete a code snippet.
    &quot;&quot;&quot;
    try:
        snippet = Snippet.objects.get(pk=pk)
    except Snippet.DoesNotExist:
        return HttpResponse(status=404)

    if request.method == 'GET':
        serializer = SnippetSerializer(snippet)
        return JsonResponse(serializer.data)

    elif request.method == 'PUT':
        data = JSONParser().parse(request)
        serializer = SnippetSerializer(snippet, data=data)
        if serializer.is_valid():
            serializer.save()
            return JsonResponse(serializer.data)
        return JsonResponse(serializer.errors, status=400)

    elif request.method == 'DELETE':
        snippet.delete()
        return HttpResponse(status=204)
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;æ³¨æ„ï¼Œå‰é¢createè¿”å›çš„statusä¸º201ï¼Œè¿™é‡Œretrieveè¿”å›çš„é»˜è®¤çš„200ï¼Œé™„ä¸Šå‡ ä¸ªå¸¸è§çŠ¶æ€ç ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;200 OK - GET/PUT/PATCHï¼šæœåŠ¡å™¨æˆåŠŸè¿”å›ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼ˆIdempotentï¼‰&lt;/li&gt;
&lt;li&gt;201 CREATED - POSTï¼šç”¨æˆ·æ–°å»ºæ•°æ®æˆåŠŸ&lt;/li&gt;
&lt;li&gt;204 NO content - DELETEï¼šç”¨æˆ·åˆ é™¤æ•°æ®æˆåŠŸ&lt;/li&gt;
&lt;li&gt;400 Invalid request - POST/PUT/PATCHï¼šç”¨æˆ·å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼Œè¯¥æ“ä½œæ˜¯å¹‚ç­‰çš„&lt;/li&gt;
&lt;li&gt;401 Unauthorized - *ï¼šè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰&lt;/li&gt;
&lt;li&gt;403 Forbidden - *ï¼šè¡¨ç¤ºç”¨æˆ·å¾—åˆ°æˆæƒï¼ˆä¸401é”™è¯¯ç›¸å¯¹ï¼‰ï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;
&lt;p&gt;æœ€åï¼Œæ·»åŠ è·¯ç”±ï¼Œæ–°å»ºæ–‡ä»¶&lt;code&gt;snippets/urls.py&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from django.urls import path
from snippets import views

urlpatterns = [
    path('snippets/', views.snippet_list),
    path('snippets/&amp;lt;int:pk&amp;gt;/', views.snippet_detail),
]
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å†é…ç½®åˆ°&lt;code&gt;tutorial/urls.py&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-python&quot;&gt;from django.urls import path, include

urlpatterns = [
    path('', include('snippets.urls')),
]
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;å¯åŠ¨é¡¹ç›®ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;python manage.py runserver
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ–°å¼€ä¸€ä¸ªTerminalï¼Œå®‰è£…HTTPå‘½ä»¤è¡Œå·¥å…·ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;pip install httpie
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯·æ±‚snippetsåˆ—è¡¨ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;http http://127.0.0.1:8000/snippets/

HTTP/1.1 200 OK
...
[
  {
    &quot;id&quot;: 1,
    &quot;title&quot;: &quot;&quot;,
    &quot;code&quot;: &quot;foo = \&quot;bar\&quot;\n&quot;,
    &quot;linenos&quot;: false,
    &quot;language&quot;: &quot;python&quot;,
    &quot;style&quot;: &quot;friendly&quot;
  },
  {
    &quot;id&quot;: 2,
    &quot;title&quot;: &quot;&quot;,
    &quot;code&quot;: &quot;print(\&quot;hello, world\&quot;)\n&quot;,
    &quot;linenos&quot;: false,
    &quot;language&quot;: &quot;python&quot;,
    &quot;style&quot;: &quot;friendly&quot;
  }
]
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯·æ±‚idä¸º2çš„snippetï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;http http://127.0.0.1:8000/snippets/2/

HTTP/1.1 200 OK
...
{
  &quot;id&quot;: 2,
  &quot;title&quot;: &quot;&quot;,
  &quot;code&quot;: &quot;print(\&quot;hello, world\&quot;)\n&quot;,
  &quot;linenos&quot;: false,
  &quot;language&quot;: &quot;python&quot;,
  &quot;style&quot;: &quot;friendly&quot;
}
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;ä¸å¾—ä¸è¯´DRFçš„Tutorialå®è·µæ€§å¾ˆå¼ºï¼ŒåŸºæœ¬ä¸Šç…§ç€åšéƒ½èƒ½æ•²å‡ºæ¥ï¼Œä½“éªŒæ¯”è¾ƒå¥½ã€‚åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œå°±æ˜¯æ¨¡å‹å®ä¾‹â†’Pythonå­—å…¸â†’JSONçš„è¿‡ç¨‹ã€‚é€šè¿‡æœ¬æ–‡ä¹Ÿç†è§£äº†åœ¨appä¸­&lt;code&gt;models.py&lt;/code&gt;â†’&lt;code&gt;serializers.py&lt;/code&gt;â†’&lt;code&gt;views.py&lt;/code&gt;â†’&lt;code&gt;urls.py&lt;/code&gt;çš„ä»£ç ç¼–å†™é¡ºåºã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;0.84397163120567&quot;&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.django-rest-framework.org/tutorial/1-serialization/&quot; target=&quot;_blank&quot;&gt;https://www.django-rest-framework.org/tutorial/1-serialization/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/yexudengzhidao/article/details/93527586&quot; target=&quot;_blank&quot;&gt;https://blog.csdn.net/yexudengzhidao/article/details/93527586&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Wed, 16 Dec 2020 23:37:00 +0000</pubDate>
<dc:creator>dongfanger</dc:creator>
<og:description>åœ¨RESTful APIä¸­ï¼Œæ¥å£è¿”å›çš„æ˜¯JSONï¼ŒJSONçš„å†…å®¹å¯¹åº”çš„æ˜¯æ•°æ®åº“ä¸­çš„æ•°æ®ï¼ŒDRFæ˜¯é€šè¿‡åºåˆ—åŒ–ï¼ˆSerializationï¼‰çš„æŠ€æœ¯ï¼ŒæŠŠæ•°æ®æ¨¡å‹è½¬æ¢ä¸ºJSONçš„ï¼Œåä¹‹ï¼Œå«åšååºåˆ—åŒ–ï¼ˆdese</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/df888/p/14145364.html</dc:identifier>
</item>
<item>
<title>ã€éœ‡æƒŠã€‘padding-topçš„ç™¾åˆ†æ¯”å€¼å‚è€ƒå¯¹è±¡ç«Ÿæ˜¯çˆ¶çº§å…ƒç´ çš„å®½åº¦ - èƒ¡å“¥æœ‰è¯è¯´</title>
<link>http://www.cnblogs.com/justbecoder/p/14147650.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/justbecoder/p/14147650.html</guid>
<description>&lt;h2 id=&quot;å¼•è¨€&quot;&gt;å¼•è¨€&lt;/h2&gt;
&lt;p&gt;ä¹¦å†™é¡µé¢æ ·å¼ä¸å¸ƒå±€æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆ&lt;code&gt;Coding&lt;/code&gt; ä¸­å¿…ä¸å¯å°‘çš„ä¸€é¡¹å·¥ä½œï¼Œåœ¨å®šä¹‰é¡µé¢å…ƒç´ çš„æ ·å¼æ—¶ï¼Œ&lt;code&gt;padding&lt;/code&gt; å±æ€§ä¹Ÿæ˜¯ç»å¸¸è¢«ä½¿ç”¨åˆ°çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;padding&lt;/code&gt; å±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å†…è¾¹è·ï¼Œå…¶å€¼å¯ä»¥æ˜¯&lt;code&gt;length&lt;/code&gt;ã€&lt;code&gt;inherit&lt;/code&gt;ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯&lt;code&gt;ç™¾åˆ†æ¯”&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©ä¸ºä»€ä¹ˆä¼šèŠåˆ°&lt;code&gt;padding-top&lt;/code&gt;è®¾ç½®ç™¾åˆ†æ¯”æ—¶çš„å‚è€ƒå¯¹è±¡è¿™ä¸ªè¯é¢˜å‘¢ï¼Œè¿™è¿˜è¦ä»ä¸€é“ä¸é‚£ä¹ˆæ­£ç»çš„é¢è¯•é¢˜è¯´èµ·~&lt;/p&gt;
&lt;h2 id=&quot;ä¸€é“ä¸é‚£ä¹ˆæ­£ç»çš„csså¸ƒå±€é¢è¯•é¢˜&quot;&gt;ä¸€é“ä¸é‚£ä¹ˆæ­£ç»çš„csså¸ƒå±€é¢è¯•é¢˜&lt;/h2&gt;
&lt;p&gt;åœ¨å¯¹é¢ï¼Œä¸€æœ¬æ­£ç»çš„é¢è¯•å®˜å’Œè”¼å¯äº²çš„è¯´é“ï¼šæˆ‘ä»¬æ¥é“ç®€å•çš„é¢è¯•é¢˜ï¼Œå†™å†™ä»£ç å§ã€‚ä½ ä¸€è„¸å¾®ç¬‘çš„è¯´é“ï¼šå¥½å“’ã€‚&lt;/p&gt;
&lt;h4 id=&quot;é¢˜ç›®é¡»çŸ¥ï¼š&quot;&gt;é¢˜ç›®é¡»çŸ¥ï¼š&lt;/h4&gt;
&lt;p&gt;é¡µé¢ä¸­æœ‰ä¸€ä¸ªå…ƒç´ Aï¼Œè¯·å®ç°ä»¥ä¸‹éœ€æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;å…ƒç´ Aåœ¨é¡µé¢å†…æ°´å¹³ã€å‚ç›´å±…ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;å…ƒç´ Aè·ç¦»é¡µé¢å·¦å³çš„é—´è·ä¸º10pxï¼Œå…ƒç´ Açš„å®½åº¦éšé¡µé¢å®½åº¦å˜å¤§è€Œå˜å¤§ï¼›&lt;/li&gt;
&lt;li&gt;è®¾ç½®å…ƒç´ Açš„é«˜åº¦å§‹ç»ˆä¸ºå®½åº¦çš„ä¸€åŠï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;åªè¦æ˜¯å¯¹CSSäº†è§£çš„ä¸€äº›çš„åŒå­¦ï¼Œå®ç°1å’Œ2éƒ½æ˜¯éå¸¸ç®€å•çš„ï¼Œè€Œä¸”æ–¹å¼ä¹Ÿæ˜¯å¤šç§å¤šæ ·çš„ã€‚é‚£å¦‚ä½•èƒ½è®¾ç½®è®©å…ƒç´ Açš„é«˜åº¦å§‹ç»ˆä¸ºå®½åº¦çš„ä¸€åŠå‘¢ï¼Ÿä¸Šä»£ç ~&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;é¡µé¢å¸ƒå±€ï¼šè¦è€ƒè™‘DOMçš„ç»“æ„å’ŒCSSçš„æ ·å¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;
&lt;code class=&quot;language-html&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;meta charset=&quot;UTF-8&quot;&amp;gt;
  &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&amp;gt;
  &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;
  &amp;lt;style&amp;gt;
    * {
      margin: 0;
      padding: 0;
    }
    html, body {
      width: 100%;
      height: 100%;
      /* è®¾ç½®å­å…ƒç´ Aå‚ç›´æ°´å¹³å±…ä¸­ */ 
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .a {
      /* è®¾ç½®marginå·¦å³é—´è·ä¸º10px */
      margin: 0 10px;
      background: #F00;
      /* è®¾ç½®å®½åº¦ä¸º100vwï¼Œå®é™…å®½åº¦ä¼šå—åˆ°å¼¹æ€§ç›’å­çš„å½±å“ */
      width: 100vw;
      /* calcæ–¹æ³•åŠ¨æ€è®¡ç®—ï¼šheightçš„å€¼ä¸ºå®½åº¦çš„1/2ï¼Œæ‰€ä»¥æ˜¯ (100vw - 20px) / 2 */
      height: calc(50vw - 10px);
    }
  &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
  &amp;lt;div class=&quot;a&quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;åœ¨ä¸Šè¿°çš„ä»£ç ä¸­æˆ‘ä»¬å€ŸåŠ©calcæ–¹æ³•å®ç°äº†è®¾ç½®å…ƒç´ çš„é«˜åº¦ä¸ºå®½åº¦çš„1/2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤æ—¶å†…å¿ƒæ˜¯å¦æœ‰äº›çªƒå–œï¼Œåˆæå®šäº†ä¸€ä¸ªé—®é¢˜ï¼Œé¥±å«è‡ªä¿¡(&lt;strong&gt;å‚²å¨‡&lt;/strong&gt;)çš„ç›®å…‰çœ‹å‘äº†é¢è¯•å®˜ã€‚&lt;br/&gt;ç„¶è€Œï¼Œå½“ä½ æ²¡æœ‰getåˆ°é¢è¯•å®˜çš„&lt;code&gt;G&lt;/code&gt;ç‚¹æ—¶ï¼Œé¢è¯•å®˜åˆå’Œè”¼å¯äº²ï¼ˆ&lt;strong&gt;å†·è‹¥å†°éœœ&lt;/strong&gt;ï¼‰çš„è¯´é“â€œè¿˜æœ‰åˆ«çš„æ–¹æ³•å—ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;è¿˜èƒ½æœ‰å•¥åˆ«çš„åŠæ³•å‘¢ï¼Ÿä½ æ— åŠ©çš„æ‹äº†æ‹è‡ªå·±é‚£ä¸ºæ•°ä¸å¤šçš„ç§€å‘ã€‚&lt;/p&gt;
&lt;p&gt;å•¦å•¦å•¦ï¼Œå¿«æ¥ä½¿ç”¨&lt;code&gt;padding-top&lt;/code&gt;ï¼Œå“¼å“¼å“ˆå˜¿...&lt;/p&gt;
&lt;h2 id=&quot;æ¢ç©¶padding-topçš„ç§˜å¯†&quot;&gt;æ¢ç©¶padding-topçš„ç§˜å¯†&lt;/h2&gt;
&lt;p&gt;å½“padding-topçš„å€¼ä¸ºç™¾åˆ†æ¯”æ—¶ï¼Œå‚è€ƒçš„å¯¹è±¡æ˜¯çˆ¶çº§å…ƒç´ çš„å®½åº¦&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;è¿™å¥è¯åœˆèµ·æ¥ï¼Œæ˜¯é‡ç‚¹ï¼Œè¦è€ƒ~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;
&lt;code class=&quot;language-html&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&quot;en&quot;&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;meta charset=&quot;UTF-8&quot;&amp;gt;
  &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&amp;gt;
  &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;
  &amp;lt;style&amp;gt;
    * {
      margin: 0;
      padding: 0;
    }
    html, body {
      width: 100%;
      height: 100%;
      /* è®¾ç½®å­å…ƒç´ Aå‚ç›´æ°´å¹³å±…ä¸­ */ 
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .a {
      /* è®¾ç½®marginå·¦å³é—´è·ä¸º10px */
      margin: 0 10px;
      background: #F00;
      /* è®¾ç½®å®½åº¦ä¸º100%ï¼Œçˆ¶çº§å®¹å™¨å®½åº¦çš„100%ï¼Œå®é™…å®½åº¦ä¼šå—åˆ°å¼¹æ€§ç›’å­çš„å½±å“ */
      width: 100%;
      height: 0;
      /* calcæ–¹æ³•åŠ¨æ€è®¡ç®—ï¼špadding-topçš„å€¼ä¸ºçˆ¶çº§å®¹å™¨å®½åº¦çš„1/2ï¼Œæ‰€ä»¥æ˜¯ (100vw - 20px) / 2 */
      padding-top: calc(50% - 10px);
    }
  &amp;lt;/style&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
  &amp;lt;div class=&quot;a&quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;æ­¤å¤„ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨&lt;code&gt;padding-bottom&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤åˆ»ä½ å†æŠ¬å¤´æ—¶ï¼Œçœ‹åˆ°äº†é¢è¯•å®˜é‚£é¥±å«äº†å¿ƒæ»¡æ„è¶³ã€å­ºå­å¯æ•™çš„çƒ­çƒˆçœ¼ç¥...&lt;/p&gt;
&lt;h2 id=&quot;æœ€åçš„ç§˜å¯†&quot;&gt;æœ€åçš„ç§˜å¯†&lt;/h2&gt;
&lt;p&gt;å½“&lt;code&gt;padding-top&lt;/code&gt;ã€&lt;code&gt;padding-bottom&lt;/code&gt;ã€&lt;code&gt;margin-top&lt;/code&gt;ã€&lt;code&gt;margin-bottom&lt;/code&gt;å±æ€§è®¾ç½®ä¸ºç™¾åˆ†æ¯”æ—¶ï¼Œå‚è€ƒå¯¹è±¡éƒ½æ˜¯çˆ¶çº§å…ƒç´ çš„å®½åº¦&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;è¦è®°ä½å‘€ï¼Œä¸‹å›è¿˜å¾—è€ƒ~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;åè®°&quot;&gt;åè®°&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯èƒ¡å“¥ä»Šå¤©ç»™å¤§å®¶åˆ†äº«çš„å†…å®¹ï¼Œå–œæ¬¢çš„å°ä¼™ä¼´è®°å¾—&lt;code&gt;ç‚¹èµ&lt;/code&gt;ã€&lt;code&gt;æ”¶è—&lt;/code&gt;å‘¦ï¼Œå…³æ³¨èƒ¡å“¥æœ‰è¯è¯´ï¼Œå­¦ä¹ å‰ç«¯ä¸è¿·è·¯ï¼Œæ¬¢è¿å¤šå¤šç•™è¨€äº¤æµ...&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;èƒ¡å“¥æœ‰è¯è¯´ï¼Œä¸“æ³¨äºå¤§å‰ç«¯æŠ€æœ¯é¢†åŸŸï¼Œåˆ†äº«å‰ç«¯ç³»ç»Ÿæ¶æ„ï¼Œæ¡†æ¶å®ç°åŸç†ï¼Œæœ€æ–°æœ€é«˜æ•ˆçš„æŠ€æœ¯å®è·µï¼&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Wed, 16 Dec 2020 18:49:00 +0000</pubDate>
<dc:creator>èƒ¡å“¥æœ‰è¯è¯´</dc:creator>
<og:description>å¼•è¨€ ä¹¦å†™é¡µé¢æ ·å¼ä¸å¸ƒå±€æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆCoding ä¸­å¿…ä¸å¯å°‘çš„ä¸€é¡¹å·¥ä½œï¼Œåœ¨å®šä¹‰é¡µé¢å…ƒç´ çš„æ ·å¼æ—¶ï¼Œpadding å±æ€§ä¹Ÿæ˜¯ç»å¸¸è¢«ä½¿ç”¨åˆ°çš„ã€‚ padding å±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å†…è¾¹è·ï¼Œå…¶å€¼å¯ä»¥æ˜¯lengt</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/justbecoder/p/14147650.html</dc:identifier>
</item>
<item>
<title>G1 æ”¶é›†å™¨ - buttercup</title>
<link>http://www.cnblogs.com/buttercup/p/13829881.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/buttercup/p/13829881.html</guid>
<description>&lt;h2 id=&quot;æ€§èƒ½æŒ‡æ ‡&quot;&gt;æ€§èƒ½æŒ‡æ ‡&lt;/h2&gt;
&lt;p&gt;åœ¨è°ƒä¼˜Javaåº”ç”¨ç¨‹åºæ—¶ï¼Œé‡ç‚¹é€šå¸¸æ”¾åœ¨ä¸¤ä¸ªä¸»è¦ç›®æ ‡ä¸Šï¼š&lt;strong&gt;å“åº”æ€§&lt;/strong&gt; æˆ– &lt;strong&gt;ååé‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ã€€&lt;strong&gt;å“åº”æ€§&lt;/strong&gt;&lt;code&gt;Responsiveness&lt;/code&gt; æ˜¯æŒ‡åº”ç”¨ç¨‹åºå¯¹è¯·æ±‚çš„æ•°æ®åšå‡ºå“åº”çš„é€Ÿåº¦ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æ¡Œé¢ç”¨æˆ·ç•Œé¢å¯¹äº‹ä»¶çš„å“åº”é€Ÿåº¦&lt;/li&gt;
&lt;li&gt;ç½‘ç«™è¿”å›é¡µé¢çš„é€Ÿåº¦&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æŸ¥è¯¢çš„è¿”å›é€Ÿåº¦&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;ã€€&lt;strong&gt;ååé‡&lt;/strong&gt;&lt;code&gt;Throughput&lt;/code&gt; ä¸“æ³¨äºæœ€å¤§ç¨‹åº¦åœ°æé«˜åº”ç”¨ç¨‹åºåœ¨ç‰¹å®šæ—¶é—´æ®µå†…çš„å·¥ä½œé‡ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åœ¨ç»™å®šæ—¶é—´å†…å®Œæˆçš„äº‹åŠ¡æ¬¡æ•°&lt;/li&gt;
&lt;li&gt;æ‰¹å¤„ç†ç¨‹åºåœ¨ä¸€å°æ—¶å†…å¯ä»¥å®Œæˆçš„ä½œä¸šæ•°&lt;/li&gt;
&lt;li&gt;ä¸€å°æ—¶å†…å¯ä»¥å®Œæˆçš„æ•°æ®åº“æŸ¥è¯¢æ•°&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;è¾ƒé•¿çš„æš‚åœæ—¶é—´&lt;code&gt;Pause Time&lt;/code&gt;å¯¹äºæ³¨é‡å“åº”æ€§çš„åº”ç”¨ç¨‹åºæ˜¯ä¸å¯æ¥å—çš„ï¼Œä½†å¯¹äºæ³¨é‡ååé‡çš„åº”ç”¨ç¨‹åºæ¥è¯´å¯ä»¥æ¥å—çš„ã€‚å‰è€…é‡ç‚¹æ˜¯åœ¨çŸ­æ—¶é—´å†…åšå‡ºå“åº”ï¼Œåè€…åˆ™ä¾§é‡ä¸é•¿æ—¶é—´è¿è¡Œçš„å¤„ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2 id=&quot;gc-åŸºç¡€&quot;&gt;GC åŸºç¡€&lt;/h2&gt;
&lt;h3 id=&quot;gc-root&quot;&gt;GC Root&lt;/h3&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/05/Java-GC-mark-and-sweep.png&quot; width=&quot;500&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¯è¾¾æ€§åˆ†ææ˜¯ Java GC ç®—æ³•çš„åŸºç¡€ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯ä»¥ä¸€ç³»åˆ—åä¸º &lt;code&gt;GC Roots&lt;/code&gt; å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œé€šè¿‡å¼•ç”¨å…³ç³»éå†å¯¹è±¡å›¾ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åˆ° &lt;code&gt;GC Roots&lt;/code&gt; é—´æ²¡æœ‰ä»»ä½•å¯è¾¾è·¯å¾„ç›¸è¿æ—¶ï¼Œåˆ™è¯´æ˜æ­¤å¯¹è±¡å¯ä»¥è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/14041675-df1525e1beadcb43.png?imageMogr2/auto-orient/strip|imageView2/2/w/1108/format/webp&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½œä¸º &lt;code&gt;GC Roots&lt;/code&gt; çš„å¯¹è±¡ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„nativeæ–¹æ³•ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;ä¸‰è‰²æ ‡è®°&quot;&gt;ä¸‰è‰²æ ‡è®°&lt;/h3&gt;
&lt;p&gt;å¯è¾¾æ€§åˆ†æä¸­é‡è¦çš„ä¸€ç¯å°±æ˜¯éå†æ•´ä¸ªå †ï¼Œå¹¶æ ‡è®°å…¶ä¸­çš„å­˜æ´»å¯¹è±¡ã€‚ä¸€ç§å¸¸ç”¨çš„æ ‡è®°ç®—æ³•æ˜¯ &lt;strong&gt;ä¸‰è‰²æ ‡è®°æ³•&lt;/strong&gt;&lt;code&gt;tri-color marking&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Animation_of_tri-color_garbage_collection.gif/330px-Animation_of_tri-color_garbage_collection.gif&quot; width=&quot;350&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå¯¹è±¡å¯èƒ½ä¸ºä»¥ä¸‹ 3 ç§é¢œè‰²ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;white&lt;/strong&gt; â€” æœªè¢«æ ‡è®°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;gray&lt;/strong&gt; â€” æœ¬èº«å·²æ ‡è®°ï¼Œä½†éƒ¨åˆ†å¼•ç”¨çš„å¯¹è±¡å®Œæˆæ ‡è®°ï¼ˆåŠ¨å›¾çš„é»„è‰²å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;black&lt;/strong&gt; â€” æœ¬èº«å·²æ ‡è®°ï¼Œä¸”æ‰€æœ‰å¼•ç”¨çš„å¯¹è±¡å®Œæˆæ ‡è®°ï¼ˆåŠ¨å›¾çš„è“è‰²å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;æ ‡è®°ç®—æ³•ä» GC Roots å‡ºå‘éå†å †ï¼Œå¯è¾¾å¯¹è±¡å…ˆæ ‡è®° grayï¼Œç„¶åå†æ ‡è®° ä¸º blackã€‚&lt;/p&gt;
&lt;p&gt;éå†å®Œæˆä¹‹åæ‰€æœ‰å¯è¾¾å¯¹è±¡éƒ½æ˜¯ black çš„ï¼Œæ­¤æ—¶æ‰€æœ‰æ ‡è®°ä¸º white çš„å¯¹è±¡éƒ½æ˜¯å¯ä»¥å›æ”¶çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“å®ç°å¹¶å‘æ ‡è®°ç®—æ³•æ—¶ï¼Œå¿…é¡»é˜²æ­¢ white å¯¹è±¡è¢«æ¼æ ‡ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ä¸è¯¥å›æ”¶çš„å¯¹è±¡è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;br/&gt;&lt;h3 id=&quot;åˆ†ä»£æ”¶é›†&quot;&gt;åˆ†ä»£æ”¶é›†&lt;/h3&gt;
&lt;p&gt;ä¼ ç»Ÿåƒåœ¾æ”¶é›†å™¨å°†å †åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šå¹´è½»ä»£&lt;code&gt;YoungGen = Eden + Survivor&lt;/code&gt;ï¼Œè€å¹´ä»£&lt;code&gt;OldGen&lt;/code&gt;å’Œæ°¸ä¹…ä»£&lt;code&gt;PermGen&lt;/code&gt;ï¼Œæ¯ä¸ªåŒºåŸŸå†…å­˜è¿ç»­ä¸”å¤§å°å›ºå®šã€‚&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://www.oracle.com/webfolder/technetwork/tutorials/obe/java/G1GettingStarted/images/HeapStructure.png&quot; width=&quot;400&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å¹´è½»ä»£ï¼šä¸€æ¬¡æ€§ä½¿ç”¨çš„ä¸´æ—¶å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼šæ–¹æ³•ä¸­æ„é€ çš„ä¸´æ—¶å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£ï¼šè¢«é•¿æœŸå¼•ç”¨çš„å¸¸é©»å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼šç¼“å­˜å¯¹è±¡ã€å•ä¾‹å¯¹è±¡ï¼‰&lt;/li&gt;
&lt;li&gt;æ°¸ä¹…ä»£ï¼šJVM è¿è¡Œè¿‡ç¨‹ä¸­ä¸€ç›´å­˜åœ¨çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼šå­—ç¬¦ä¸²å¸¸é‡ã€ç±»ä¿¡æ¯ï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å°†å †å†…å­˜è¿›è¡Œåˆ’åˆ†åï¼Œå¯ä»¥æŒ‰ç…§å¯¹è±¡ç”Ÿå‘½å‘¨æœŸé•¿çŸ­ï¼Œåœ¨ä¸åŒåŒºåŸŸä½¿ç”¨ä¸åŒçš„å›æ”¶ç®—æ³•ï¼Œæé«˜ GC çš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;br/&gt;&lt;h3 id=&quot;ç®—æ³•åˆ†ç±»&quot;&gt;ç®—æ³•åˆ†ç±»&lt;/h3&gt;
&lt;h4 id=&quot;mark-and-sweepæ ‡è®°-æ¸…é™¤&quot;&gt;&lt;strong&gt;Mark and Sweep&lt;/strong&gt;&lt;code&gt;æ ‡è®°-æ¸…é™¤&lt;/code&gt;&lt;/h4&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/GC-sweep.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ã€€ç”¨ä¸€ä¸ªç©ºé—²åˆ—è¡¨&lt;code&gt;free-list&lt;/code&gt;è®°å½•å¤±æ•ˆå¯¹è±¡å ç”¨çš„å†…å­˜åŒºåŸŸï¼Œæ–¹ä¾¿åç»­é‡æ–°åˆ†é…ç»™æ–°å¯¹è±¡ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å›æ”¶åŸç†ç®€å•ï¼ŒGC åœé¡¿æ—¶é—´çŸ­&lt;/li&gt;
&lt;li&gt;ç»´æŠ¤ç©ºé—²åˆ—è¡¨éœ€è¦ä¸€å®šçš„ç©ºé—´å¼€é”€&lt;/li&gt;
&lt;li&gt;å†…å­˜ç¢ç‰‡è¾ƒå¤šï¼Œå¯èƒ½å¯¼è‡´å†…å­˜åˆ†é…å¤±è´¥&lt;/li&gt;
&lt;/ul&gt;&lt;h4 id=&quot;mark-sweep-compactæ ‡è®°-æ•´ç†&quot;&gt;&lt;strong&gt;Mark-Sweep-Compact&lt;/strong&gt;&lt;code&gt;æ ‡è®°-æ•´ç†&lt;/code&gt;&lt;/h4&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/GC-mark-sweep-compact.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ã€€å°†æ‰€æœ‰å­˜æ´»å¯¹è±¡ç§»åŠ¨åˆ°å†…å­˜åŒºåŸŸçš„å¼€å¤´ï¼Œå‰©ä½™çš„è¿ç»­å†…å­˜åŒºåŸŸéƒ½æ˜¯å¯ç”¨çš„ç©ºé—²ç©ºé—´ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é€šè¿‡æŒ‡é’ˆç¢°æ’æŸ¥æ‰¾ç©ºé—²ç©ºé—´ï¼Œåˆ†é…é€Ÿåº¦å¿«&lt;/li&gt;
&lt;li&gt;å†…å­˜ç¢ç‰‡å°‘ï¼Œå†…å­˜åˆ†é…å¤±è´¥æ¦‚ç‡ä½&lt;/li&gt;
&lt;li&gt;å¤åˆ¶å¯¹è±¡ä¼šå¯¼è‡´è¾ƒé•¿æ—¶é—´çš„ GC åœé¡¿&lt;/li&gt;
&lt;/ul&gt;&lt;h4 id=&quot;mark-and-copyæ ‡è®°-å¤åˆ¶&quot;&gt;&lt;strong&gt;Mark and Copy&lt;/strong&gt;&lt;code&gt;æ ‡è®°-å¤åˆ¶&lt;/code&gt;&lt;/h4&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/GC-mark-and-copy-in-Java.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ã€€å°†å†…å­˜åˆ’åˆ†ä¸º&lt;strong&gt;æ´»åŠ¨åŒºé—´&lt;/strong&gt;ä¸&lt;strong&gt;ç©ºé—²åŒºé—´&lt;/strong&gt;ï¼Œå‰è€…ç”¨äºåŠ¨æ€åˆ†é…å¯¹è±¡ï¼Œåè€…ç”¨äºå®¹çº³ GC å­˜æ´»å¯¹è±¡ã€‚&lt;br/&gt;ã€€GC æ—¶åªéœ€å°†å­˜æ´»å¯¹è±¡ä»å‰è€…å¤åˆ¶åˆ°åè€…ï¼Œç„¶åäº¤æ¢ä¸¤è€…çš„è§’è‰²å³å¯ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æ ‡è®°å’Œå¤åˆ¶åœ¨åŒä¸€é˜¶æ®µåŒæ—¶è¿›è¡Œï¼Œå½“å­˜æ´»å¯¹è±¡å°‘æ—¶å›æ”¶æ•ˆç‡æé«˜&lt;/li&gt;
&lt;li&gt;éœ€è¦é¢„ç•™ä¸€ä¸ªç©ºé—²ç©ºé—´ç”¨äºå®¹çº³å­˜æ´»å¯¹è±¡ï¼Œé€ æˆå†…å­˜æµªè´¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CMS &lt;code&gt;Concurrent Mark-Sweep&lt;/code&gt; æ˜¯ä¸€ä¸ªé‡‡ç”¨ &lt;strong&gt;æ ‡è®°-æ¸…é™¤&lt;/strong&gt; ç®—æ³•çš„è€å¹´ä»£æ”¶é›†å™¨ã€‚&lt;br/&gt;å®ƒé€šè¿‡ä¸åº”ç”¨ç¨‹åºçº¿ç¨‹å¹¶å‘æ‰§è¡Œå¤§å¤šæ•°åƒåœ¾å›æ”¶å·¥ä½œï¼Œæ¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘ç”±äº GC å¯¼è‡´çš„æš‚åœã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼ŒCMS æ”¶é›†å™¨ä¸ä¼šå¤åˆ¶æˆ–å‹ç¼©æ´»åŠ¨å¯¹è±¡ï¼Œè¿™æ„å‘³ç€æ— éœ€ç§»åŠ¨æ´»åŠ¨å¯¹è±¡å³å¯å®Œæˆåƒåœ¾å›æ”¶ã€‚&lt;br/&gt;ç„¶è€Œè¿‡å¤šçš„å†…å­˜ç¢ç‰‡å¯èƒ½é€ æˆåˆ†é…å¤±è´¥ï¼Œæœ€ç»ˆå¯¼è‡´ FullGCã€‚å¯ä»¥é€šè¿‡åˆ†é…æ›´å¤§çš„å †æ¥è§„é¿è¿™ä¸€é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;CMS å¯¹è€å¹´ä»£çš„å›æ”¶å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul readability=&quot;27&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;strong&gt;Initial Mark &lt;em&gt;(STW)&lt;/em&gt;&lt;/strong&gt; &lt;code&gt;åˆå§‹æ ‡è®°&lt;/code&gt;&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-06.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æ ‡è®° GC Roots ç›´æ¥å¯è¾¾çš„è€å¹´ä»£å¯¹è±¡&lt;/li&gt;
&lt;li&gt;éå†æ–°ç”Ÿä»£å­˜æ´»å¯¹è±¡ï¼Œæ ‡è®°ç›´æ¥å¯è¾¾çš„è€å¹´ä»£å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li readability=&quot;11&quot;&gt;
&lt;p&gt;&lt;strong&gt;Concurrent Mark&lt;/strong&gt; &lt;code&gt;å¹¶å‘æ ‡è®°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;GC çº¿ç¨‹éå† &lt;strong&gt;Initial Mark&lt;/strong&gt; é˜¶æ®µæ ‡è®°å‡ºæ¥å­˜æ´»çš„è€å¹´ä»£å¯¹è±¡ï¼Œç„¶åé€’å½’æ ‡è®°è¿™äº›å¯è¾¾çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-07.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¯¥é˜¶æ®µä¸åº”ç”¨çº¿ç¨‹å¹¶å‘è¿è¡Œï¼ŒæœŸé—´ä¼šå‘ç”Ÿæ–°ç”Ÿä»£å¯¹è±¡æ™‹å‡ã€è€å¹´ä»£å¯¹è±¡å¼•ç”¨å…³ç³»æ›´æ–°ï¼Œéœ€è¦å¯¹è¿™äº›å¯¹è±¡è¿›è¡Œé‡æ–°æ ‡è®°ï¼Œé¿å…å‘ç”Ÿé—æ¼ã€‚&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-08.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;CMS ç”¨ä¸€ä¸ª&lt;code&gt;card-table&lt;/code&gt;ç®¡ç†è€å¹´ä»£ï¼Œå¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªå¯¹è±¡çš„å¼•ç”¨å…³ç³»å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™å°†å¯¹è±¡æ‰€åœ¨çš„å†…å­˜å—æ ‡è®°ä¸º &lt;strong&gt;Dirty Card&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;CMS ä½¿ç”¨&lt;strong&gt;å¢é‡æ›´æ–°&lt;/strong&gt;&lt;code&gt;incremental update&lt;/code&gt;è§£å†³å¹¶å‘ä¿®æ”¹å¯¼è‡´çš„æ¼æ ‡é—®é¢˜ï¼šæŠŠ black å¯¹è±¡é‡æ–°æ ‡è®°ä¸º greyï¼Œä¸‹æ¬¡é‡æ–°æ‰«æå…¶å¼•ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;4&quot;&gt;
&lt;p&gt;&lt;strong&gt;Preclean&lt;/strong&gt; &lt;code&gt;é¢„æ¸…ç†&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸€é˜¶æ®µä¸»è¦æ˜¯å¤„ç† &lt;strong&gt;Concurrent Mark&lt;/strong&gt; é˜¶æ®µä¸­å¼•ç”¨å…³ç³»æ”¹å˜ï¼Œå¯¼è‡´æ²¡æœ‰æ ‡è®°åˆ°çš„å­˜æ´»å¯¹è±¡çš„ã€‚é€šè¿‡å¹¶å‘åœ°é‡æ–°æ‰«æè¿™äº›å¯¹è±¡ï¼Œé¢„æ¸…ç†é˜¶æ®µå¯ä»¥å‡å°‘ &lt;strong&gt;Remark&lt;/strong&gt; é˜¶æ®µçš„ STWã€‚&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-09.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé˜¶æ®µä¼šå¤„ç†å‰ä¸€ä¸ªé˜¶æ®µè¢«æ ‡è®°ä¸º &lt;strong&gt;Dirty Card&lt;/strong&gt; çš„éƒ¨åˆ†ï¼Œå°†å…¶ä¸­å˜åŒ–äº†çš„å¯¹è±¡ä½œä¸º GC Root å†è¿›è¡Œæ‰«æå¹¶é‡æ–°æ ‡è®°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;strong&gt;Abortable Preclean&lt;/strong&gt; &lt;code&gt;å¯ç»ˆæ­¢çš„é¢„æ¸…ç†&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé˜¶æ®µä½œç”¨ä¸ &lt;strong&gt;Preclean&lt;/strong&gt; ç±»ä¼¼ï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½® &lt;strong&gt;æ‰«ææ—¶é•¿&lt;/strong&gt;ï¼ˆé»˜è®¤5ç§’ï¼‰æˆ– &lt;strong&gt;Eden åŒºä½¿ç”¨å æ¯”&lt;/strong&gt;ï¼ˆé»˜è®¤50%ï¼‰æ§åˆ¶æœ¬é˜¶æ®µçš„ç»“æŸæ—¶æœºã€‚&lt;/p&gt;
&lt;p&gt;å¢åŠ è¿™ä¸€é˜¶æ®µçš„åŸå› ï¼Œæ˜¯æœŸå¾…è¿™æœŸé—´èƒ½å‘ç”Ÿä¸€æ¬¡ YoungGC æ¸…ç†æ— æ•ˆçš„å¹´è½»ä»£å¯¹è±¡ï¼Œå‡å°‘ &lt;strong&gt;Remark&lt;/strong&gt; é˜¶æ®µæ‰«æå¹´è½»ä»£çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;12&quot;&gt;
&lt;p&gt;&lt;strong&gt;Remark &lt;em&gt;(STW)&lt;/em&gt;&lt;/strong&gt; &lt;code&gt;é‡æ–°æ ‡è®°&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé˜¶æ®µåŒæ—¶æ‰«æ YoungGen ä¸ OldGenï¼Œé‡æ–°æ ‡è®°æ•´ä¸ªè€å¹´ä»£ä¸­æ‰€æœ‰å­˜æ´»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºä¹‹å‰çš„ &lt;strong&gt;Concurrent Mark&lt;/strong&gt; ä¸ &lt;strong&gt;Preclean&lt;/strong&gt; é˜¶æ®µæ˜¯ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„ï¼Œå¹´è½»ä»£å¯¹è€å¹´ä»£çš„å¼•ç”¨å¯èƒ½å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œ&lt;strong&gt;Remark&lt;/strong&gt; è¦èŠ±å¾ˆå¤šæ—¶é—´å¤„ç†è¿™äº›æ”¹å˜ï¼Œä¼šå¯¼è‡´é•¿æ—¶é—´çš„ STWã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå³ä½¿æ–°ç”Ÿä»£çš„å¯¹è±¡å·²ç»ä¸å¯è¾¾äº†ï¼ŒCMS ä¹Ÿä¼šä½¿ç”¨è¿™äº›ä¸å¯è¾¾çš„å¯¹è±¡å½“åšçš„ GC Roots æ¥æ‰«æè€å¹´ä»£ï¼Œå¯¼è‡´éƒ¨åˆ†å¤±æ•ˆçš„è€å¹´ä»£å¯¹è±¡æ— æ³•è¢«åŠæ—¶å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥åŠ å…¥å‚æ•° -XX:+CMSScavengeBeforeRemarkï¼Œåœ¨é‡æ–°æ ‡è®°ä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡ YoungGCï¼Œå›æ”¶æ‰å¹´è½»ä»£çš„å¯¹è±¡æ— ç”¨çš„å¯¹è±¡ã€‚è¿™æ ·è¿›è¡Œå¹´è½»ä»£æ‰«ææ—¶ï¼Œåªéœ€è¦æ‰«æ Survivor åŒºçš„å¯¹è±¡å³å¯ï¼Œä¸€èˆ¬ Survivor åŒºéå¸¸å°ï¼Œè¿™å¤§å¤§å‡å°‘äº†æ‰«ææ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;9&quot;&gt;
&lt;p&gt;&lt;strong&gt;Concurrent Sweep&lt;/strong&gt; &lt;code&gt;å¹¶å‘æ¸…ç†&lt;/code&gt;&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-10.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼Œè€å¹´ä»£æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡å·²ç»è¢«æ ‡è®°å®Œæˆã€‚è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯æ¸…é™¤é‚£äº›æ²¡æœ‰æ ‡è®°çš„å¯¹è±¡å¹¶ä¸”å›æ”¶ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è¢«å›æ”¶çš„ç©ºé—´ä¼šè¢«æ·»åŠ åˆ° &lt;strong&gt;ç©ºé—²åˆ—è¡¨&lt;/strong&gt;ä¸­ï¼Œä»¥ä¾›ä»¥ååˆ†é…ã€‚è¿™ä¸€è¿‡ç¨‹å¯èƒ½ä¼šå¯¹ç©ºé—²ç©ºé—´è¿›è¡Œåˆå¹¶ï¼Œä½†æ˜¯ä¸ä¼šç§»åŠ¨å­˜æ´»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºè¯¥é˜¶æ®µæ˜¯ä¸åº”ç”¨çº¿ç¨‹å¹¶å‘è¿è¡Œçš„ï¼Œè‡ªç„¶å°±è¿˜ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ä¹‹åï¼Œæ— æ³•åœ¨å½“æ¬¡æ”¶é›†ä¸­å¤„ç†æ‰å®ƒä»¬ã€‚åªå¥½ç•™å¾…ä¸‹ä¸€æ¬¡GCæ—¶å†æ¸…ç†æ‰ã€‚è¿™ä¸€éƒ¨åˆ†åƒåœ¾å°±ç§°ä¸º &lt;strong&gt;æµ®åŠ¨åƒåœ¾&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;strong&gt;Resetting&lt;/strong&gt; &lt;code&gt;é‡ç½®&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¸…é™¤æ•°æ®ç»“æ„ï¼Œå¹¶é‡ç½®å®šæ—¶å™¨ï¼Œä¸ºä¸‹ä¸€è½® GC åšå‡†å¤‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;è®¾è®¡ç›®çš„&quot;&gt;è®¾è®¡ç›®çš„&lt;/h2&gt;
&lt;p&gt;G1 &lt;code&gt;Garbage-First&lt;/code&gt; æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„åƒåœ¾æ”¶é›†å™¨ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å¯ä»¥ä¸åº”ç”¨ç¨‹åºçº¿ç¨‹å¹¶è¡Œè¿è¡Œï¼Œå‡å°‘ STW&lt;/li&gt;
&lt;li&gt;æ•´ç†ç©ºé—²ç©ºé—´å‡å°‘å†…å­˜ç¢ç‰‡ï¼Œä½†ä¸å¼•å…¥è¾ƒé•¿çš„ GC æš‚åœæ—¶é—´&lt;/li&gt;
&lt;li&gt;æä¾›å¯é¢„æµ‹çš„GCæš‚åœæ—¶é—´ï¼Œæ— éœ€ç‰ºç‰²å¾ˆå¤šååé‡&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;G1 èƒ½å¤Ÿåœ¨å¤§å†…å­˜çš„å¤šå¤„ç†å™¨è®¡ç®—æœºä¸Šï¼Œä¿è¯ GC æš‚åœæ—¶é—´å¯æ§ï¼Œå¹¶å®ç°é«˜ååé‡ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æœ€ç»ˆç›®çš„æ˜¯å–ä»£ CMS æˆä¸ºæœåŠ¡ç«¯ GC æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é‡‡ç”¨ &lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt; ç®—æ³•ï¼Œå¯ä»¥é¿å…ä½¿ç”¨ç»†ç²’åº¦çš„ç©ºé—²åˆ—è¡¨è¿›è¡Œåˆ†é…ã€‚ç®€åŒ–äº†æ”¶é›†å™¨è®¾è®¡å¹¶æ¶ˆé™¤äº†æ½œåœ¨çš„ç¢ç‰‡é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;strong&gt;å¢é‡å›æ”¶&lt;/strong&gt;&lt;code&gt;incremental collecting&lt;/code&gt; ç®—æ³•ï¼Œå…¶ GC æš‚åœæ—¶é—´æ¯” CMS æ›´å…·å¯é¢„æµ‹æ€§ï¼Œå¹¶å…è®¸ç”¨æˆ·æŒ‡å®šæœŸæœ›çš„æš‚åœæ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;br/&gt;&lt;h2 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h2&gt;
&lt;p&gt;G1 å°†å †åˆ’åˆ†ä¸ºä¸€ç»„å¤§å°ç›¸ç­‰çš„ä¸”è¿ç»­çš„å †åŒºåŸŸ&lt;code&gt;Region&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-011.png&quot; width=&quot;400&quot;/&gt;&lt;/p&gt;
&lt;p&gt;G1 ä¸­æ–°ç”Ÿä»£ä¸è€å¹´ä»£ä¸å†è¿ç»­ï¼Œæ¯ä¸ªåŒºåŸŸå¯ä»¥åœ¨ &lt;strong&gt;Eden&lt;/strong&gt;ã€&lt;strong&gt;Survivor&lt;/strong&gt; ä¸ &lt;strong&gt;Old&lt;/strong&gt; ä¹‹é—´åˆ‡æ¢è§’è‰²ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç±»è¢«ç§°ä¸º &lt;strong&gt;Humongous&lt;/strong&gt; çš„å·¨å‹åŒºåŸŸï¼Œç”¨äºå®¹çº³ä½“ç§¯ â‰¥ æ ‡å‡†åŒºåŸŸå¤§å°çš„50ï¼…çš„å¯¹è±¡ã€‚JVM é€šå¸¸ä¼šå°†å†…å­˜åˆ’åˆ†ä¸º 2000ä¸ªåŒºåŸŸï¼Œæ¯ä¸ªå¤§å°ä» 1 åˆ° 32Mb ä¸ç­‰ï¼Œç”± JVM åœ¨å¯åŠ¨æ—¶é€šè¿‡ -XX:G1HeapRegionSize æŒ‡å®šã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªåŒºåŸŸä¼šè¢«è¿›ä¸€æ­¥ç»†åˆ†æˆå¤šä¸ªå¡ç‰‡&lt;code&gt;Card&lt;/code&gt;ï¼Œæ¯ä¸ªå¤§å°ä¸º 512Kbï¼Œç”¨äºå®ç°ç»†ç²’åº¦çš„å¼•ç”¨ç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†åŒºè®¾è®¡å¯ä»¥é¿å…ä¸€æ¬¡æ”¶é›†æ•´ä¸ªå †ï¼Œæ¯æ¬¡ GC åªæ”¶é›†åŒºåŸŸçš„ä¸€ä¸ªå­é›† &lt;strong&gt;CSet&lt;/strong&gt;&lt;code&gt;collection set&lt;/code&gt;ï¼Œå…¶ä¸­å¿…ç„¶åŒ…å«æ‰€æœ‰ &lt;strong&gt;Young&lt;/strong&gt; åŒºåŸŸï¼ŒåŒæ—¶å¯èƒ½åŒ…æ‹¬éƒ¨åˆ† &lt;strong&gt;Old&lt;/strong&gt; åŒºåŸŸï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2015/06/g1-02.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®å›æ”¶åŒºåŸŸçš„ä¸åŒï¼Œå¯ä»¥å°† GC åˆ†ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;YoungGC&lt;/strong&gt;ï¼š&lt;strong&gt;CSet&lt;/strong&gt; åªåŒ…å« &lt;strong&gt;Young&lt;/strong&gt; åŒºåŸŸ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MixedGC&lt;/strong&gt;ï¼š &lt;strong&gt;CSet&lt;/strong&gt; åŒæ—¶åŒ…å« &lt;strong&gt;Young&lt;/strong&gt; ä¸ &lt;strong&gt;Old&lt;/strong&gt; åŒºåŸŸ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FullGC&lt;/strong&gt;ï¼š å›æ”¶æ•´ä¸ªå †ï¼ˆå¯ç”¨ç©ºé—´è€—å°½æ—¶è§¦å‘ï¼Œå•çº¿ç¨‹æ‰§è¡Œï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;G1 æ ¹æ®å­˜æ´»å¯¹è±¡çš„å­—èŠ‚æ•°ç»Ÿè®¡æ¯ä¸ªåŒºåŸŸçš„ &lt;strong&gt;æ´»è·ƒåº¦&lt;/strong&gt;&lt;code&gt;liveness&lt;/code&gt;ï¼Œç„¶åæ ¹æ®æœŸæœ›åœé¡¿æ—¶é—´æ¥ç¡®å®šè¯¥ &lt;strong&gt;CSet&lt;/strong&gt; çš„å¤§å°ï¼Œå¹¶ä¿è¯é‚£äº›åƒåœ¾å¤šï¼ˆæ´»è·ƒåº¦ä½ï¼‰çš„åŒºåŸŸä¼šè¢«ä¼˜å…ˆå›æ”¶ï¼Œæ•…æ­¤å¾—å &lt;strong&gt;åƒåœ¾ä¼˜å…ˆ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;G1 çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºç”± 3 ä¸ªé˜¶æ®µç»„æˆçš„å¾ªç¯ï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/cnblogs_com/buttercup/1901291/o_201216040643g1_cycle.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;br/&gt;&lt;h2 id=&quot;young-gc&quot;&gt;Young GC&lt;/h2&gt;
&lt;p&gt;å †ä¸­ä¸€å¼€å§‹åªæœ‰ &lt;strong&gt;YoungGen&lt;/strong&gt;ï¼Œå› æ­¤åªä¼šè§¦å‘ &lt;strong&gt;YoungGC&lt;/strong&gt;ï¼Œå°† &lt;strong&gt;Eden&lt;/strong&gt; ä¸ &lt;strong&gt;Survivor&lt;/strong&gt; åŒºåŸŸä¸­çš„æ´»åŠ¨å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªç©ºé—²çš„ &lt;strong&gt;Survivor&lt;/strong&gt; åŒºåŸŸã€‚&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;https://www.oracle.com/webfolder/technetwork/tutorials/obe/java/G1GettingStarted/images/slide11.png&quot; width=&quot;300&quot;/&gt;&lt;img src=&quot;https://www.oracle.com/webfolder/technetwork/tutorials/obe/java/G1GettingStarted/images/slide12.png&quot; width=&quot;300&quot;/&gt;&lt;/center&gt;
&lt;p&gt;G1 ä¸­å°† &lt;strong&gt;å°†å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å…¶ä»–åŒºåŸŸ&lt;/strong&gt; çš„è¿‡ç¨‹ç§°ä¸º &lt;strong&gt;ç–æ•£&lt;/strong&gt;&lt;code&gt;Evacuation&lt;/code&gt;ã€‚ä¸ºäº†å‡å°‘åœé¡¿æ—¶é—´ï¼Œç–æ•£å·¥ä½œç”±å¤šä¸ª GC çº¿ç¨‹å¹¶è¡Œå®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;YoungGC&lt;/strong&gt; è¿‡ç¨‹ä¸­ä¼šæ ¹æ®é¢„æœŸç›®æ ‡åœé¡¿æ—¶é—´ &lt;strong&gt;-XX:MaxGCPauseMillis&lt;/strong&gt; åŠ¨æ€è°ƒæ•´æ–°ç”Ÿä»£çš„å¤§å°ï¼Œé€šè¿‡ &lt;strong&gt;-XX:G1NewSizePercent&lt;/strong&gt; å‚æ•°å¯ä»¥äººä¸ºå¹²é¢„è¿™ä¸€è¿‡ç¨‹ï¼Œä½†ä¼šè®©é¢„æœŸåœé¡¿æ—¶é—´å‚æ•°å¤±æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;å½“å †çš„æ•´ä½“å ç”¨ç©ºé—´è¶³å¤Ÿå¤§æ—¶ï¼ˆè¶…è¿‡45%ï¼‰ï¼Œå°±ä¼šè¿›å…¥ &lt;strong&gt;Concurrent Marking&lt;/strong&gt; é˜¶æ®µã€‚é€šè¿‡ &lt;strong&gt;-XX:InitiatingHeapOccupancyPercent&lt;/strong&gt; é€‰é¡¹å¯ä»¥é…ç½®è¿™ä¸€è¡Œä¸ºã€‚&lt;/p&gt;
&lt;h2 id=&quot;concurrent-marking&quot;&gt;Concurrent Marking&lt;/h2&gt;
&lt;p&gt;ä¸ CMS ç±»ä¼¼ï¼ŒG1 ä¸­çš„å¹¶å‘æ ‡è®°åŒ…æ‹¬å¤šä¸ªé˜¶æ®µï¼Œå…¶ä¸­ä¸€äº›é˜¶æ®µæ˜¯å¹¶å‘çš„ï¼Œå¦ä¸€äº›é˜¶æ®µåˆ™ä¼š STWã€‚&lt;br/&gt;&lt;/p&gt;
&lt;ul readability=&quot;0.5&quot;&gt;&lt;li readability=&quot;4&quot;&gt;
&lt;p&gt;&lt;strong&gt;Initial Mark &lt;em&gt;(STW)&lt;/em&gt;&lt;/strong&gt; &lt;code&gt;åˆå§‹æ ‡è®°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰«æå¹¶æ ‡è®° &lt;strong&gt;GC Root&lt;/strong&gt; å¯¹è±¡ç›´æ¥å¯è¾¾çš„è€å¹´ä»£å­˜æ´»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Initial Mark&lt;/strong&gt; å¹¶æ²¡æœ‰ç‹¬ç«‹çš„æ‰§è¡Œé˜¶æ®µï¼Œè€Œæ˜¯åµŒå…¥ &lt;strong&gt;YoungGC&lt;/strong&gt; ä¸­æ‰§è¡Œçš„ï¼Œå…¶åœé¡¿æ—¶é—´ä¼šè¢«åˆ†æ‘Šï¼Œå› æ­¤å®é™…çš„å¼€é”€éå¸¸ä½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;br/&gt;&lt;ul readability=&quot;18&quot;&gt;&lt;li readability=&quot;6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Root Region Scan&lt;/strong&gt; &lt;code&gt;æ‰«ææ ¹åŒºåŸŸ&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰«æ &lt;strong&gt;Root Region&lt;/strong&gt; å¹¶æ ‡è®°æ‰€æœ‰å¯è¾¾çš„è€å¹´ä»£å­˜æ´»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„çš„ &lt;strong&gt;Root Region&lt;/strong&gt; å°±æ˜¯å…ˆå‰ &lt;strong&gt;YoungGC&lt;/strong&gt; ä¸­ç”Ÿæˆçš„ &lt;strong&gt;Survivor&lt;/strong&gt; åŒºåŸŸï¼Œå…¶åŒ…å«çš„å¯¹è±¡éƒ½ä¼šè¢«è§†ä¸º &lt;strong&gt;GC Root&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…ç§»åŠ¨å¯¹è±¡å¯¹æ ‡è®°äº§ç”Ÿå½±å“ï¼Œè¯¥è¿‡ç¨‹å¿…é¡»åœ¨ä¸‹æ¬¡ &lt;strong&gt;YongGC&lt;/strong&gt; å¯åŠ¨å‰å®Œæˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;16&quot;&gt;
&lt;p&gt;&lt;strong&gt;Concurrent Mark&lt;/strong&gt; &lt;code&gt;å¹¶å‘æ ‡è®°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨å¹¶å‘æ ‡è®°çº¿ç¨‹ï¼Œæ‰«æå¹¶æ ‡è®°æ•´ä¸ªå †ä¸­çš„å­˜æ´»å¯¹è±¡ï¼ˆçº¿ç¨‹æ•°å¯ä»¥é€šè¿‡ &lt;strong&gt;-XX:ConcGCThread&lt;/strong&gt; è¿›è¡Œé…ç½®ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…é‡å¤æ ‡è®°ï¼ŒG1 ä½¿ç”¨ &lt;strong&gt;SATB&lt;/strong&gt;&lt;code&gt;snapshot-at-the-beginning&lt;/code&gt;ç®—æ³•è§£å†³æ¼æ ‡é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;åº”ç”¨çº¿ç¨‹å¯¹åœ¨ &lt;strong&gt;Concurrent Mark&lt;/strong&gt; æ‰§è¡ŒæœŸé—´è¿›è¡Œçš„æ‰€æœ‰å¹¶å‘æ›´æ–°ï¼Œéƒ½åº”ä¿ç•™å…ˆå‰çš„å·²çŸ¥æ ‡è®°ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥çº¦æŸæ˜¯é€šè¿‡&lt;strong&gt;é¢„å†™å±éšœ&lt;/strong&gt;&lt;code&gt;pre-write barrier&lt;/code&gt;å®ç°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Concurrent Mark&lt;/strong&gt; æ‰«æè¿‡ç¨‹ä¸­ï¼Œå½“åº”ç”¨çº¿ç¨‹ä¿®æ”¹æŸä¸ªå­—æ®µæ—¶ï¼Œä¼šå°†å…ˆå‰çš„å¼•ç”¨å¯¹è±¡å­˜å‚¨åœ¨&lt;strong&gt;æ—¥å¿—ç¼“å†²åŒº&lt;/strong&gt;&lt;code&gt;log buffers&lt;/code&gt;ä¸­ï¼Œç„¶åäº¤ç”±å¹¶å‘æ ‡è®°çº¿ç¨‹å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…ç§»åŠ¨å¯¹è±¡å¯¹æ ‡è®°äº§ç”Ÿå½±å“ï¼Œè¯¥è¿‡ç¨‹å¿…é¡»åœ¨ä¸‹æ¬¡ &lt;strong&gt;YoungGC&lt;/strong&gt; å¯åŠ¨å‰å®Œæˆã€‚æ‰€æœ‰çš„æ ‡è®°ä»»åŠ¡å¿…é¡»åœ¨å †æ»¡å‰å®Œæˆï¼Œå¦‚æœå †æ»¡å‰æ²¡æœ‰å®Œæˆæ ‡è®°ä»»åŠ¡ï¼Œåˆ™ä¼šè§¦å‘æ‹…ä¿æœºåˆ¶ï¼Œç»å†ä¸€æ¬¡é•¿æ—¶é—´çš„ä¸²è¡Œ &lt;strong&gt;FullGC&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;7&quot;&gt;
&lt;p&gt;&lt;strong&gt;Remark &lt;em&gt;(STW)&lt;/em&gt;&lt;/strong&gt; &lt;code&gt;é‡æ–°æ ‡è®°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨å¹¶è¡Œæ ‡è®°çº¿ç¨‹ï¼Œå®Œæˆå¯¹æ•´ä¸ªå †ä¸­å­˜æ´»å¯¹è±¡çš„æ ‡è®°ï¼ˆçº¿ç¨‹æ•°å¯ä»¥é€šè¿‡ &lt;strong&gt;-XX:ParallelGCThread&lt;/strong&gt; è¿›è¡Œé…ç½®ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥é˜¶æ®µä¼šæš‚åœæ‰€æœ‰åº”ç”¨çº¿ç¨‹ï¼Œé¿å…å‘ç”Ÿå¼•ç”¨æ›´æ–°ï¼Œå¹¶å®Œæˆå¯¹&lt;strong&gt;SATB æ—¥å¿—ç¼“å†²åŒº&lt;/strong&gt;ä¸­å‰©ä½™å¯¹è±¡çš„æ ‡è®°ï¼Œæ‰¾å‡ºæ‰€æœ‰æœªè¢«è®¿é—®çš„å­˜æ´»å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥é˜¶æ®µè¿˜æ‰§è¡Œä¸€äº›é¢å¤–çš„æ¸…ç†æ“ä½œï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å¸è½½ä¸å¯è¾¾çš„ç±»ï¼ˆé€šè¿‡ &lt;strong&gt;-XX:+ClassUnloadingWithConcurrentMark&lt;/strong&gt; å¼€å¯ï¼‰&lt;/li&gt;
&lt;li&gt;å¤„ç†å¼•ç”¨å¯¹è±¡ï¼ˆå¼±å¼•ç”¨ã€è½¯å¼•ç”¨ã€è™šå¼•ç”¨ã€æœ€ç»ˆå¼•ç”¨ï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;&lt;strong&gt;Cleanup&lt;/strong&gt; &lt;code&gt;æ¸…ç†åƒåœ¾&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ•´ç†ç»Ÿè®¡ä¿¡æ¯å¹¶è¯†åˆ«å‡ºé«˜æ”¶ç›Šçš„è€å¹´ä»£åˆ†åŒºï¼Œä¸º &lt;strong&gt;MixedGC&lt;/strong&gt; åšå‡†å¤‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦å·¥ä½œæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;RSet æ¢³ç†ï¼ˆåç»­è¯´æ˜ï¼‰&lt;/li&gt;
&lt;li&gt;è¯†åˆ«å›æ”¶æ”¶ç›Šé«˜çš„è€å¹´ä»£åˆ†åŒº (åŸºäºé‡Šæ”¾ç©ºé—´å’Œæš‚åœç›®æ ‡)&lt;/li&gt;
&lt;li&gt;ç›´æ¥å›æ”¶çš„æ²¡æœ‰æ´»è·ƒå¯¹è±¡çš„ç©ºé—²åˆ†åŒº&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;æ­¤å¤–è¿˜ä¼šæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œä¸ºä¸‹ä¸€æ¬¡ &lt;strong&gt;Concurrent Marking&lt;/strong&gt; åšå¥½å‡†å¤‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;mixed-gc&quot;&gt;Mixed GC&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;MixedGC&lt;/strong&gt; ä¸»è¦æµç¨‹ä¸ &lt;strong&gt;YoungGC&lt;/strong&gt; ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº &lt;strong&gt;CSet&lt;/strong&gt; ä¸­åŒ…å«äº† &lt;strong&gt;Old&lt;/strong&gt; åŒºåŸŸã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong&gt;Concurrent Marking&lt;/strong&gt; ç»“æŸåï¼Œå¹¶ä¸ä¸€å®šä¼šç«‹å³è§¦å‘ &lt;strong&gt;MixedGC&lt;/strong&gt;ï¼Œä¸­é—´å¯èƒ½ä¼šç©¿æ’å¤šæ¬¡çš„ &lt;strong&gt;YoungGC&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ”¶é›†æŸä¸ªåŒºåŸŸæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“æ˜¯å¦æœ‰æ¥è‡ªéæ”¶é›†åŒºåŸŸå¼•ç”¨ï¼Œæ¥ç¡®å®šå®ƒä»¬çš„æ´»åŠ¨æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ä»éæ”¶é›†åŒºåŸŸåˆ°æ”¶é›†åŒºåŸŸçš„ &lt;strong&gt;incoming reference&lt;/strong&gt; æ˜¯é‡è¦çš„ï¼ˆè¢«éæ”¶é›†åŒºå¼•ç”¨çš„å¯¹è±¡å¿…é¡»å­˜æ´»ï¼‰&lt;/li&gt;
&lt;li&gt;ä»æ”¶é›†åŒºåŸŸåˆ°éæ”¶é›†åŒºåŸŸçš„ &lt;strong&gt;outgoing reference&lt;/strong&gt; æ˜¯å¯å¿½ç•¥çš„ï¼ˆéæ”¶é›†åŒºåŸŸä¸å‚ä¸GCï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;ä½†æŸ¥æ‰¾æ•´ä¸ªå †éå¸¸è€—æ—¶ï¼ŒåŒæ—¶ä¹Ÿå¤±å»äº†å¢é‡æ”¶é›†çš„ä¼˜åŠ¿ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒG1 ä¸ºæ¯ä¸ªåŒºåŸŸç»´æŠ¤äº†ä¸€ä¸ª &lt;strong&gt;RSet&lt;/strong&gt;&lt;code&gt;remembered set&lt;/code&gt;ï¼Œç”¨äºè®°å¿†ä»å…¶ä»–åŒºåŸŸæŒ‡å‘è‡ªå·±çš„å¼•ç”¨ã€‚&lt;/p&gt;
&lt;br/&gt;&lt;h3 id=&quot;æ”¶é›†è¿‡ç¨‹&quot;&gt;æ”¶é›†è¿‡ç¨‹&lt;/h3&gt;
&lt;p&gt;åœ¨æ‰§è¡Œæ”¶é›†æ—¶ï¼Œ&lt;strong&gt;RSet&lt;/strong&gt; ä¸­å¼•ç”¨ä¿¡æ¯ä¼šæ‰®æ¼”å±€éƒ¨ &lt;strong&gt;GC Roots&lt;/strong&gt; çš„è§’è‰²ï¼Œé¿å…è€—æ—¶çš„å¼•ç”¨æŸ¥æ‰¾ï¼Œä¿è¯æ¯ä¸ªåŒºåŸŸçš„ GC èƒ½å¤Ÿç‹¬ç«‹è¿›è¡Œï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2016/01/g1-03.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œè±¡å¦‚æœ &lt;strong&gt;Old&lt;/strong&gt; åŒºåŸŸä¸­å¯¹åœ¨ &lt;strong&gt;Concurrent Marking&lt;/strong&gt; é˜¶æ®µè¢«ç¡®å®šä¸ºåƒåœ¾ï¼Œå³ä½¿æœ‰å¤–éƒ¨å¼•ç”¨ï¼Œè¯¥å¯¹è±¡ä¹Ÿä¼šè¢«ä½œä¸ºåƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å‘ç”Ÿçš„äº‹æƒ…ä¸å…¶ä»–æ”¶é›†å™¨æ‰€åšçš„ç›¸åŒï¼šå¤šä¸ªå¹¶è¡ŒGCçº¿ç¨‹æ‰¾å‡ºå“ªäº›å¯¹è±¡æ˜¯æ´»åŠ¨çš„ï¼Œå“ªäº›å¯¹è±¡æ˜¯åƒåœ¾ï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2016/01/g1-04.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œé‡Šæ”¾ç©ºé—²åŒºåŸŸï¼Œå°†æ´»åŠ¨å¯¹è±¡ç§»åˆ° &lt;strong&gt;Survivor&lt;/strong&gt; åŒºåŸŸï¼Œå¹¶åœ¨å¿…è¦æ—¶åˆ›å»ºæ–°å¯¹è±¡ï¼š&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;img src=&quot;https://plumbr.io/app/uploads/2016/01/g1-05-v2.png&quot; width=&quot;450&quot;/&gt;&lt;/p&gt;
&lt;br/&gt;&lt;h3 id=&quot;rset-ç»´æŠ¤&quot;&gt;&lt;strong&gt;RSet&lt;/strong&gt; ç»´æŠ¤&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†ç»´æŠ¤ RSetï¼Œåœ¨åº”ç”¨çº¿ç¨‹å¯¹å­—æ®µæ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šè§¦å‘&lt;strong&gt;å†™åå±éšœ&lt;/strong&gt;&lt;code&gt;post-write barrier&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœæ›´æ–°åçš„å¼•ç”¨æ˜¯è·¨åŒºåŸŸçš„ï¼ˆå³ä»ä¸€ä¸ªåŒºåŸŸæŒ‡å‘å¦ä¸€ä¸ªåŒºåŸŸï¼‰ï¼Œåˆ™å¯¹åº”çš„æ¡ç›®å°†å‡ºç°åœ¨ç›®æ ‡åŒºåŸŸçš„ &lt;strong&gt;RSet&lt;/strong&gt; ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‡å°‘å†™å±éšœå¸¦æ¥çš„å¼€é”€ï¼Œè¯¥è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼š&lt;/p&gt;
&lt;p&gt;åº”ç”¨çº¿ç¨‹åªè´Ÿè´£æŠŠæ›´æ–°å­—æ®µæ‰€åœ¨çš„ Card ä¿¡æ¯æ’å…¥ä¸€ä¸ª&lt;strong&gt;DCQ&lt;/strong&gt;&lt;code&gt;Dirty Card Queue&lt;/code&gt;ï¼Œç„¶åç”± Refine çº¿ç¨‹å°†å…¶æ‹¾å–å¹¶å°†ä¿¡æ¯ä¼ æ’­åˆ°è¢«å¼•ç”¨åŒºåŸŸçš„ RSetã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåº”ç”¨çº¿ç¨‹æ’å…¥é€Ÿåº¦è¿‡å¿«ï¼Œä¼šå¯¼è‡´ Refine çº¿ç¨‹æ¥ä¸åŠå¤„ç†ï¼Œé‚£ä¹ˆåº”ç”¨çº¿ç¨‹å°†æ¥ç®¡ RSet æ›´æ–°çš„ä»»åŠ¡ï¼Œä»è€Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt; ä¸ &lt;strong&gt;å¢é‡æ”¶é›†&lt;/strong&gt; æ˜¯ G1 å®ç°é«˜æ€§èƒ½ä¸å¯é¢„æµ‹å›æ”¶çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº CPU èµ„æºå……è¶³ä¸”å¯¹å»¶è¿Ÿæ•æ„Ÿçš„æœåŠ¡ç«¯åº”ç”¨æ¥è¯´ï¼ŒG1 ç®—æ³•èƒ½å¤Ÿåœ¨å¤§å †ä¸Šæä¾›è‰¯å¥½çš„å“åº”é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä»£ä»·ï¼Œé¢å¤–çš„å†™å±éšœä¸æ›´æ´»è·ƒGCçº¿ç¨‹ï¼Œä¼šå¯¹åº”ç”¨çš„ååé‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚&lt;/p&gt;
&lt;br/&gt;&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;
</description>
<pubDate>Wed, 16 Dec 2020 16:53:00 +0000</pubDate>
<dc:creator>buttercup</dc:creator>
<og:description>åŸºç¡€çŸ¥è¯† æ€§èƒ½æŒ‡æ ‡ åœ¨è°ƒä¼˜Javaåº”ç”¨ç¨‹åºæ—¶ï¼Œé‡ç‚¹é€šå¸¸æ”¾åœ¨ä¸¤ä¸ªä¸»è¦ç›®æ ‡ä¸Šï¼šå“åº”æ€§ æˆ– ååé‡ã€‚ å“åº”æ€§Responsiveness æ˜¯æŒ‡åº”ç”¨ç¨‹åºå¯¹è¯·æ±‚çš„æ•°æ®åšå‡ºå“åº”çš„é€Ÿåº¦ï¼š æ¡Œé¢ç”¨æˆ·ç•Œé¢å¯¹äº‹ä»¶çš„å“åº”é€Ÿ</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/buttercup/p/13829881.html</dc:identifier>
</item>
<item>
<title>SpringCloud æºç ç³»åˆ—ï¼ˆ4ï¼‰â€”â€” è´Ÿè½½å‡è¡¡ Ribbon - bojiangzhou</title>
<link>http://www.cnblogs.com/chiangchou/p/ribbon-1.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/chiangchou/p/ribbon-1.html</guid>
<description>&lt;p&gt;æ·±å…¥ç ”ç©¶ Ribbon è´Ÿè½½å‡è¡¡çš„æ ¸å¿ƒåŸç†ï¼ŒRestTemplate å¦‚ä½•å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ï¼Œä»¥åŠ Ribbon æ ¸å¿ƒæ¥å£ç‰¹æ€§ç­‰ã€‚&lt;/p&gt;&lt;div id=&quot;cnblogs_post_body&quot; readability=&quot;664&quot;&gt;
&lt;h2&gt;ä¸€ã€è´Ÿè½½å‡è¡¡&lt;/h2&gt;
&lt;h3&gt;1ã€RestTemplate&lt;/h3&gt;
&lt;p&gt;åœ¨ç ”ç©¶ eureka æºç ä¸Šç¯‡ä¸­ï¼Œæˆ‘ä»¬åœ¨ demo-consumer æ¶ˆè´¹è€…æœåŠ¡ä¸­å®šä¹‰äº†ç”¨ @LoadBalanced æ ‡è®°çš„Â RestTemplateï¼Œç„¶åä½¿ç”¨Â RestTemplate é€šè¿‡æœåŠ¡åçš„å½¢å¼æ¥è°ƒç”¨è¿œç¨‹æœåŠ¡Â demo-producerï¼Œç„¶åè¯·æ±‚ä¼šè½®è¯¢åˆ°ä¸¤ä¸ªÂ demo-producer å®ä¾‹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;RestTemplate æ˜¯ Spring Resources ä¸­ä¸€ä¸ªè®¿é—®ç¬¬ä¸‰æ–¹ RESTful API æ¥å£çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶ã€‚RestTemplate æ˜¯ç”¨æ¥æ¶ˆè´¹ REST æœåŠ¡çš„ï¼Œæ‰€ä»¥ RestTemplate çš„ä¸»è¦æ–¹æ³•éƒ½ä¸ REST çš„ Httpåè®®çš„ä¸€äº›æ–¹æ³•ç´§å¯†ç›¸è¿ï¼Œä¾‹å¦‚ HEADã€GETã€POSTã€PUTã€DELETE å’Œ OPTIONS ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åœ¨ RestTemplate ç±»å¯¹åº”çš„æ–¹æ³•ä¸º headForHeaders()ã€getForObject()ã€postForObject()ã€put() å’Œ delete() ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;RestTemplate æœ¬èº«æ˜¯ä¸å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›çš„ï¼Œå¦‚æœ RestTemplate æœªä½¿ç”¨Â @LoadBalanced æ ‡è®°ï¼Œå°±é€šè¿‡æœåŠ¡åçš„å½¢å¼æ¥è°ƒç”¨ï¼Œå¿…ç„¶ä¼šæŠ¥é”™ã€‚ç”¨Â @LoadBalanced æ ‡è®°åï¼Œè°ƒç”¨Â RestTemplate çš„ REST æ–¹æ³•å°±ä¼šé€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼é€šè¿‡ä¸€å®šçš„ç­–ç•¥è·¯ç”±åˆ°æŸä¸ªæœåŠ¡å®ä¾‹ä¸Šï¼Œåº•å±‚è´Ÿè´£è´Ÿè½½å‡è¡¡çš„ç»„ä»¶å°±æ˜¯ Ribbonã€‚åé¢æˆ‘ä»¬å†æ¥çœ‹Â @LoadBalanced æ˜¯å¦‚ä½•è®©Â RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›çš„ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@SpringBootApplication
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ConsumerApplication {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;    @LoadBalanced
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; RestTemplate restTemplate() {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RestTemplate();
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         SpringApplication.run(ConsumerApplication.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, args);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; 
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;@RestController
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; DemoController {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Logger logger =&lt;span&gt; LoggerFactory.getLogger(getClass());
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; 
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    @Autowired
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; RestTemplate restTemplate;
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; 
&lt;span&gt;22&lt;/span&gt;     @GetMapping(&quot;/v1/id&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ResponseEntity&amp;lt;String&amp;gt;&lt;span&gt; getId() {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;         ResponseEntity&amp;lt;String&amp;gt; result = restTemplate.getForEntity(&quot;http://demo-producer/v1/uuid&quot;, String.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         String uuid =&lt;span&gt; result.getBody();
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         logger.info(&quot;request id: {}&quot;&lt;span&gt;, uuid);
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; ResponseEntity.ok(uuid);
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2ã€Ribbon ä¸è´Ÿè½½å‡è¡¡&lt;/h3&gt;
&lt;p&gt;â‘  è´Ÿè½½å‡è¡¡&lt;/p&gt;
&lt;p&gt;è´Ÿè½½å‡è¡¡æ˜¯æŒ‡å°†è´Ÿè½½åˆ†æ‘Šåˆ°å¤šä¸ªæ‰§è¡Œå•å…ƒä¸Šï¼Œè´Ÿè½½å‡è¡¡ä¸»è¦å¯ä»¥åˆ†ä¸ºé›†ä¸­å¼è´Ÿè½½å‡è¡¡ä¸è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é›†ä¸­å¼è´Ÿè½½å‡è¡¡æŒ‡ä½äºå› ç‰¹ç½‘ä¸æ‰§è¡Œå•å…ƒä¹‹é—´ï¼Œå¹¶è´Ÿè´£æŠŠç½‘ç»œè¯·æ±‚è½¬å‘åˆ°å„ä¸ªæ‰§è¡Œå•å…ƒä¸Šï¼Œæ¯”å¦‚ Nginxã€F5ã€‚é›†ä¸­å¼è´Ÿè½½å‡è¡¡ä¹Ÿå¯ä»¥ç§°ä¸ºæœåŠ¡ç«¯è´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡æ˜¯å°†è´Ÿè½½å‡è¡¡é€»è¾‘é›†æˆåˆ°å®¢æˆ·ç«¯ä¸Šï¼Œå®¢æˆ·ç«¯ç»´æŠ¤äº†ä¸€ä»½æœåŠ¡æä¾›è€…çš„å®ä¾‹åˆ—è¡¨ï¼Œå®ä¾‹åˆ—è¡¨ä¸€èˆ¬ä¼šä»æ³¨å†Œä¸­å¿ƒæ¯”å¦‚ Eureka ä¸­è·å–ã€‚æœ‰äº†å®ä¾‹åˆ—è¡¨ï¼Œå°±å¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥å°†è¯·æ±‚åˆ†æ‘Šç»™å¤šä¸ªæœåŠ¡æä¾›è€…ï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡ä¸€èˆ¬ä¹Ÿç§°ä¸ºå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Ribbon æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ï¼Œå¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶ HTTP å’Œ TCP å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡è¡Œä¸ºã€‚Ribbon æ˜¯ Netflix å…¬å¸å¼€æºçš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç»„ä»¶ï¼Œå·²ç»æ•´åˆåˆ° SpringCloud ç”Ÿæ€ä¸­ï¼Œå®ƒåœ¨ Spring Cloud ç”Ÿæ€å†…æ˜¯ä¸€ä¸ªä¸å¯ç¼ºå°‘çš„ç»„ä»¶ï¼Œå°‘äº†å®ƒï¼ŒæœåŠ¡ä¾¿ä¸èƒ½æ¨ªå‘æ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;â‘¡ Ribbon æ¨¡å—&lt;/p&gt;
&lt;p&gt;Ribbon æœ‰å¾ˆå¤šå­æ¨¡å—ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­è¯´æ˜ï¼Œç›®å‰ Netflix å…¬å¸ä¸»è¦ç”¨äºç”Ÿäº§ç¯å¢ƒçš„ Ribbon å­æ¨¡å—å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ribbon-loadbalancerï¼šå¯ä»¥ç‹¬ç«‹ä½¿ç”¨æˆ–ä¸å…¶ä»–æ¨¡å—ä¸€èµ·ä½¿ç”¨çš„è´Ÿè½½å‡è¡¡å™¨ APIã€‚&lt;/li&gt;
&lt;li&gt;ribbon-eurekaï¼šRibbon ç»“åˆ Eureka å®¢æˆ·ç«¯çš„ APIï¼Œä¸ºè´Ÿè½½å‡è¡¡å™¨æä¾›åŠ¨æ€æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ribbon-coreï¼šRibbon çš„æ ¸å¿ƒAPIã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201211104128888-78357727.png&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;â‘¢ springcloud ä¸ ribbon æ•´åˆ&lt;/p&gt;
&lt;p&gt;ä¸ eureka æ•´åˆåˆ° springcloud ç±»ä¼¼ï¼Œspringcloud æä¾›äº†å¯¹åº”çš„ spring-cloud-starter-netflix-eureka-client(server) ä¾èµ–åŒ…ï¼Œribbon åˆ™æ•´åˆåˆ°äº†Â spring-cloud-starter-netflix-ribbon ä¸­ã€‚ä¸€èˆ¬ä¹Ÿä¸éœ€è¦å•ç‹¬å¼•å…¥ ribbon çš„ä¾èµ–åŒ…ï¼Œspring-cloud-starter-netflix-eureka-client ä¸­å·²ç»ä¾èµ–äº†Â spring-cloud-starter-netflix-ribbonã€‚å› æ­¤æˆ‘ä»¬å¼•å…¥äº†Â spring-cloud-starter-netflix-eureka-client å°±å¯ä»¥ä½¿ç”¨ Ribbon çš„åŠŸèƒ½äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201210154234989-2083153458.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;â‘£ Ribbon ä¸ RestTemplate æ•´åˆä½¿ç”¨&lt;/p&gt;
&lt;p&gt;åœ¨ Spring Cloud æ„å»ºçš„å¾®æœåŠ¡ç³»ç»Ÿä¸­ï¼ŒRibbon ä½œä¸ºæœåŠ¡æ¶ˆè´¹è€…çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œæœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼Œä¸€ç§æ˜¯å’Œ RestTemplate ç›¸ç»“åˆï¼Œå¦ä¸€ç§æ˜¯å’Œ Feign ç›¸ç»“åˆã€‚å‰é¢å·²ç»æ¼”ç¤ºäº†å¸¦æœ‰è´Ÿè½½å‡è¡¡çš„ RestTemplate çš„ä½¿ç”¨ï¼Œä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥çœ‹çœ‹ RestTemplate åŸºäº Ribbon çš„è¿œç¨‹è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201210161132350-70457225.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;äºŒã€RestTemplate è´Ÿè½½å‡è¡¡&lt;/h2&gt;
&lt;h3&gt;1ã€@LoadBalanced æ³¨è§£&lt;/h3&gt;
&lt;p&gt;ä»¥Â RestTemplate ä¸ºåˆ‡å…¥ç‚¹ï¼Œæ¥çœ‹ Ribbon çš„è´Ÿè½½å‡è¡¡æ ¸å¿ƒåŸç†ã€‚é‚£ä¹ˆé¦–å…ˆå°±è¦å…ˆçœ‹çœ‹ @LoadBalanced æ³¨è§£å¦‚ä½•è®©Â RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçœ‹Â @LoadBalanced è¿™ä¸ªæ³¨è§£çš„å®šä¹‰ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è¿™ä¸ªæ³¨è§£ä½¿ç”¨ @Qualifier æ ‡è®°ï¼Œå…¶å®ƒåœ°æ–¹å°±å¯ä»¥æ³¨å…¥Â LoadBalanced æ³¨è§£çš„ bean å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;ä»æ³¨é‡Šä¸­å¯ä»¥äº†è§£åˆ°ï¼Œ@LoadBalanced æ ‡è®°çš„Â RestTemplate æˆ–Â WebClient å°†ä½¿ç”¨Â LoadBalancerClient æ¥é…ç½® bean å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt; * Annotation to mark a RestTemplate or WebClient bean to be configured to use a LoadBalancerClient.
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt; * &lt;/span&gt;&lt;span&gt;@author&lt;/span&gt;&lt;span&gt; Spencer Gibb
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;  &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;@Target({ ElementType.FIELD, ElementType.PARAMETER, ElementType.METHOD })
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;@Retention(RetentionPolicy.RUNTIME)
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;@Documented
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;@Inherited
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;@Qualifier
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; @&lt;span&gt;interface&lt;/span&gt;&lt;span&gt; LoadBalanced {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; 
&lt;span&gt;12&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„ @LoadBalanced æ˜¯ spring-cloud-commons æ¨¡å—ä¸‹ loadbalancer åŒ…ä¸‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201211103801082-786294042.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;2ã€RestTemplateÂ  è´Ÿè½½å‡è¡¡è‡ªåŠ¨åŒ–é…ç½®&lt;/h3&gt;
&lt;p&gt;åœ¨ @LoadBalanced åŒåŒ…ä¸‹ï¼Œæœ‰ä¸€ä¸ªÂ LoadBalancerAutoConfiguration è‡ªåŠ¨åŒ–é…ç½®ç±»ï¼Œä»æ³¨é‡Šä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ Ribbon çš„è‡ªåŠ¨åŒ–é…ç½®ç±»ã€‚&lt;/p&gt;
&lt;p&gt;ä»è¿™ä¸ªè‡ªåŠ¨åŒ–é…ç½®ç±»å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é¦–å…ˆè¦æœ‰Â RestTemplate çš„ä¾èµ–å’Œå®šä¹‰äº†Â LoadBalancerClient å¯¹è±¡çš„å‰æä¸‹æ‰ä¼šè§¦å‘è¿™ä¸ªè‡ªåŠ¨åŒ–é…ç½®ç±»ï¼Œè¿™ä¹Ÿå¯¹åº”äº†å‰é¢ï¼ŒRestTemplate è¦ç”¨ LoadBalancerClientÂ  æ¥é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ç€å¯ä»¥çœ‹åˆ°è¿™ä¸ªç±»æ³¨å…¥äº†å¸¦æœ‰Â @LoadBalanced æ ‡è¯†çš„Â RestTemplate å¯¹è±¡ï¼Œå°±æ˜¯è¦å¯¹è¿™éƒ¨åˆ†å¯¹è±¡å¢åŠ è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;ä»Â SmartInitializingSingleton çš„æ„é€ ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå°±æ˜¯åœ¨ bean åˆå§‹åŒ–å®Œæˆåï¼Œç”¨Â RestTemplateCustomizer å®šåˆ¶åŒ–Â RestTemplateã€‚&lt;/li&gt;
&lt;li&gt;å†å¾€ä¸‹å¯ä»¥çœ‹åˆ°ï¼ŒRestTemplateCustomizer å…¶å®å°±æ˜¯å‘Â RestTemplate ä¸­æ·»åŠ äº†Â LoadBalancerInterceptor è¿™ä¸ªæ‹¦æˆªå™¨ã€‚&lt;/li&gt;
&lt;li&gt;è€ŒÂ LoadBalancerInterceptor çš„æ„å»ºåˆéœ€è¦Â LoadBalancerClient å’ŒÂ LoadBalancerRequestFactoryï¼ŒLoadBalancerRequestFactory åˆ™é€šè¿‡Â LoadBalancerClient å’ŒÂ LoadBalancerRequestTransformer æ„é€ å®Œæˆã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt; * Auto-configuration for Ribbon (client-side load balancing).
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;  &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt; @Configuration(proxyBeanMethods = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; @ConditionalOnClass(RestTemplate.&lt;span&gt;class&lt;/span&gt;) &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æœ‰ RestTemplate çš„ä¾èµ–&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt; @ConditionalOnBean(LoadBalancerClient.&lt;span&gt;class&lt;/span&gt;) &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å®šä¹‰äº† LoadBalancerClient çš„ bean å¯¹è±¡&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt; @EnableConfigurationProperties(LoadBalancerRetryProperties.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LoadBalancerAutoConfiguration {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ³¨å…¥ @LoadBalanced æ ‡è®°çš„ RestTemplate å¯¹è±¡&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    @LoadBalanced
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     @Autowired(required = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; List&amp;lt;RestTemplate&amp;gt; restTemplates =&lt;span&gt; Collections.emptyList();
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; 
&lt;span&gt;15&lt;/span&gt;     @Autowired(required = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; List&amp;lt;LoadBalancerRequestTransformer&amp;gt; transformers =&lt;span&gt; Collections.emptyList();
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; 
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; SmartInitializingSingleton loadBalancedRestTemplateInitializerDeprecated(
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;             &lt;span&gt;final&lt;/span&gt; ObjectProvider&amp;lt;List&amp;lt;RestTemplateCustomizer&amp;gt;&amp;gt;&lt;span&gt; restTemplateCustomizers) {
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; () -&amp;gt; restTemplateCustomizers.ifAvailable(customizers -&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (RestTemplate restTemplate : LoadBalancerAutoConfiguration.&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.restTemplates) {
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (RestTemplateCustomizer customizer : customizers) {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ©ç”¨ RestTemplateCustomizer å®šåˆ¶åŒ– restTemplate&lt;/span&gt;
&lt;span&gt;25&lt;/span&gt; &lt;span&gt;                    customizer.customize(restTemplate);
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;        });
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; 
&lt;span&gt;31&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; LoadBalancerRequestFactory loadBalancerRequestFactory(
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;            LoadBalancerClient loadBalancerClient) {
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; LoadBalancerRequestFactory(loadBalancerClient, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.transformers);
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; 
&lt;span&gt;38&lt;/span&gt;     @Configuration(proxyBeanMethods = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;     @ConditionalOnMissingClass(&quot;org.springframework.retry.support.RetryTemplate&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;     &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LoadBalancerInterceptorConfig {
&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; 
&lt;span&gt;42&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ›å»º LoadBalancerInterceptor éœ€è¦ LoadBalancerClient å’Œ LoadBalancerRequestFactory&lt;/span&gt;
&lt;span&gt;43&lt;/span&gt; &lt;span&gt;        @Bean
&lt;/span&gt;&lt;span&gt;44&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt;&lt;span&gt; LoadBalancerInterceptor ribbonInterceptor(
&lt;/span&gt;&lt;span&gt;45&lt;/span&gt; &lt;span&gt;                LoadBalancerClient loadBalancerClient,
&lt;/span&gt;&lt;span&gt;46&lt;/span&gt; &lt;span&gt;                LoadBalancerRequestFactory requestFactory) {
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LoadBalancerInterceptor(loadBalancerClient, requestFactory);
&lt;/span&gt;&lt;span&gt;48&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;49&lt;/span&gt; 
&lt;span&gt;50&lt;/span&gt; &lt;span&gt;        @Bean
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt; &lt;span&gt;        @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;52&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt;&lt;span&gt; RestTemplateCustomizer restTemplateCustomizer(
&lt;/span&gt;&lt;span&gt;53&lt;/span&gt;                 &lt;span&gt;final&lt;/span&gt;&lt;span&gt; LoadBalancerInterceptor loadBalancerInterceptor) {
&lt;/span&gt;&lt;span&gt;54&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; restTemplate -&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;55&lt;/span&gt;                 List&amp;lt;ClientHttpRequestInterceptor&amp;gt; list = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;(
&lt;/span&gt;&lt;span&gt;56&lt;/span&gt; &lt;span&gt;                        restTemplate.getInterceptors());
&lt;/span&gt;&lt;span&gt;57&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å‘ restTemplate æ·»åŠ  LoadBalancerInterceptor æ‹¦æˆªå™¨&lt;/span&gt;
&lt;span&gt;58&lt;/span&gt; &lt;span&gt;                list.add(loadBalancerInterceptor);
&lt;/span&gt;&lt;span&gt;59&lt;/span&gt; &lt;span&gt;                restTemplate.setInterceptors(list);
&lt;/span&gt;&lt;span&gt;60&lt;/span&gt; &lt;span&gt;            };
&lt;/span&gt;&lt;span&gt;61&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt; 
&lt;span&gt;63&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;64&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;3ã€RestTemplate æ‹¦æˆªå™¨Â LoadBalancerInterceptor&lt;/h3&gt;
&lt;p&gt;LoadBalancerAutoConfiguration è‡ªåŠ¨åŒ–é…ç½®ä¸»è¦å°±æ˜¯ç»™Â RestTemplate æ·»åŠ äº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡æ‹¦æˆªå™¨Â LoadBalancerInterceptorã€‚ä»Â setInterceptors çš„å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œæ‹¦æˆªå™¨çš„ç±»å‹æ˜¯ ClientHttpRequestInterceptorï¼Œå¦‚æœæˆ‘ä»¬æƒ³å®šåˆ¶åŒ–Â RestTemplateï¼Œå°±å¯ä»¥å®ç°è¿™ä¸ªæ¥å£æ¥å®šåˆ¶åŒ–ï¼Œç„¶åè¿˜å¯ä»¥ç”¨ @Order æ ‡è®°æ‹¦æˆªå™¨çš„å…ˆåé¡ºåºã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; setInterceptors(List&amp;lt;ClientHttpRequestInterceptor&amp;gt;&lt;span&gt; interceptors) {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.interceptors !=&lt;span&gt; interceptors) {
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.interceptors.clear();
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.interceptors.addAll(interceptors);
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ® @Order æ³¨è§£çš„é¡ºåºæ’åº&lt;/span&gt;
&lt;span&gt;6&lt;/span&gt;         AnnotationAwareOrderComparator.sort(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.interceptors);
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;8&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;interceptors æ‹¦æˆªå™¨æ˜¯åœ¨Â RestTemplate çš„çˆ¶ç±»Â InterceptingHttpAccessor ä¸­çš„ï¼ŒÂ RestTemplate çš„ç±»ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201211115801109-1362148308.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä»Â restTemplate.getForEntity(&quot;http://demo-producer/v1/uuid&quot;, String.class)Â è¿™ä¸ªGETè¯·æ±‚è¿›å»çœ‹çœ‹ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨Â LoadBalancerInterceptor çš„ã€‚ä¸€æ­¥æ­¥è¿›å»ï¼Œå¯ä»¥çœ‹åˆ°æœ€ç»ˆæ˜¯è¿›å…¥åˆ° doExecute è¿™ä¸ªæ–¹æ³•äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ doExecute æ–¹æ³•ä¸­ï¼Œé¦–å…ˆæ ¹æ® urlã€method åˆ›å»ºä¸€ä¸ªÂ ClientHttpRequestï¼Œç„¶ååˆ©ç”¨Â ClientHttpRequest æ¥å‘èµ·è¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; &amp;lt;T&amp;gt;&lt;span&gt; T doExecute(URI url, @Nullable HttpMethod method, @Nullable RequestCallback requestCallback,
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;         @Nullable ResponseExtractor&amp;lt;T&amp;gt; responseExtractor) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; RestClientException {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     ClientHttpResponse response = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ›å»ºä¸€ä¸ª ClientHttpRequest&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;         ClientHttpRequest request =&lt;span&gt; createRequest(url, method);
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (requestCallback != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;            requestCallback.doWithRequest(request);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è°ƒç”¨ ClientHttpRequest çš„ execute() æ–¹æ³•&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;         response =&lt;span&gt; request.execute();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¤„ç†è¿”å›ç»“æœ&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt; &lt;span&gt;        handleResponse(url, method, response);
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; (responseExtractor != &lt;span&gt;null&lt;/span&gt; ? responseExtractor.extractData(response) : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (IOException ex) {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (response != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;            response.close();
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; 
&lt;span&gt;26&lt;/span&gt; &lt;span&gt;//////////////////////////////////////
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; 
&lt;span&gt;28&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; ClientHttpRequest createRequest(URI url, HttpMethod method) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;     ClientHttpRequest request =&lt;span&gt; getRequestFactory().createRequest(url, method);
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;    initialize(request);
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         logger.debug(&quot;HTTP &quot; + method.name() + &quot; &quot; +&lt;span&gt; url);
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; request;
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;InterceptingHttpAccessor ä¸­é‡å†™äº†çˆ¶ç±»Â HttpAccessor çš„Â getRequestFactory æ–¹æ³•ï¼Œçˆ¶ç±»é»˜è®¤çš„Â requestFactory æ˜¯Â SimpleClientHttpRequestFactoryã€‚&lt;/p&gt;
&lt;p&gt;é‡å†™åçš„Â getRequestFactory æ–¹æ³•ä¸­ï¼Œå¦‚æœæ‹¦æˆªå™¨ä¸ä¸ºç©ºï¼Œåˆ™åŸºäºçˆ¶ç±»é»˜è®¤çš„Â SimpleClientHttpRequestFactory å’Œæ‹¦æˆªå™¨åˆ›å»ºäº†Â InterceptingClientHttpRequestFactoryã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ClientHttpRequestFactory getRequestFactory() {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     List&amp;lt;ClientHttpRequestInterceptor&amp;gt; interceptors =&lt;span&gt; getInterceptors();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;CollectionUtils.isEmpty(interceptors)) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         ClientHttpRequestFactory factory = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.interceptingRequestFactory;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (factory == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä¼ å…¥ SimpleClientHttpRequestFactory å’Œ ClientHttpRequestInterceptor æ‹¦æˆªå™¨&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;             factory = &lt;span&gt;new&lt;/span&gt; InterceptingClientHttpRequestFactory(&lt;span&gt;super&lt;/span&gt;&lt;span&gt;.getRequestFactory(), interceptors);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;this&lt;/span&gt;.interceptingRequestFactory =&lt;span&gt; factory;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; factory;
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.getRequestFactory();
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´è°ƒç”¨äº† InterceptingClientHttpRequestFactory çš„ createRequest æ–¹æ³•æ¥åˆ›å»º ClientHttpRequestã€‚è¿›å»å¯ä»¥çœ‹åˆ°ï¼ŒClientHttpRequest çš„å®é™…ç±»å‹å°±æ˜¯Â InterceptingClientHttpRequestã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt;&lt;span&gt; ClientHttpRequest createRequest(URI uri, HttpMethod httpMethod, ClientHttpRequestFactory requestFactory) {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InterceptingClientHttpRequest(requestFactory, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.interceptors, uri, httpMethod);
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;InterceptingClientHttpRequest çš„ç±»ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201211145750724-2039774128.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;RestTemplate çš„ doExecute ä¸­è°ƒç”¨ request.execute() å…¶å®æ˜¯è°ƒç”¨äº†Â InterceptingClientHttpRequest çˆ¶ç±»Â AbstractClientHttpRequest ä¸­çš„ execute æ–¹æ³•ã€‚ä¸€æ­¥æ­¥è¿›å»å¯ä»¥å‘ç°æœ€ç»ˆå…¶å®æ˜¯è°ƒç”¨äº†Â InterceptingClientHttpRequest çš„Â executeInternal æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Â InterceptingClientHttpRequestÂ  çš„Â executeInternal æ–¹æ³•ä¸­ï¼Œåˆ›å»ºäº†Â InterceptingRequestExecution æ¥æ‰§è¡Œè¯·æ±‚ã€‚åœ¨Â InterceptingRequestExecution çš„Â execute æ–¹æ³•ä¸­ï¼Œä¼šå…ˆéå†æ‰§è¡Œæ‰€æœ‰æ‹¦æˆªå™¨ï¼Œç„¶åé€šè¿‡Â ClientHttpRequest å‘èµ·çœŸæ­£çš„ http è¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;46&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ClientHttpResponse executeInternal(HttpHeaders headers, &lt;span&gt;byte&lt;/span&gt;[] bufferedOutput) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ›å»º InterceptingRequestExecution&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;     InterceptingRequestExecution requestExecution = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; InterceptingRequestExecution();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¯·æ±‚è°ƒç”¨&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; requestExecution.execute(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;, bufferedOutput);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; InterceptingRequestExecution &lt;span&gt;implements&lt;/span&gt;&lt;span&gt; ClientHttpRequestExecution {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Iterator&amp;lt;ClientHttpRequestInterceptor&amp;gt;&lt;span&gt; iterator;
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; 
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; InterceptingRequestExecution() {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‹¦æˆªå™¨è¿­ä»£å™¨&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.iterator =&lt;span&gt; interceptors.iterator();
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; 
&lt;span&gt;17&lt;/span&gt; &lt;span&gt;    @Override
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ClientHttpResponse execute(HttpRequest request, &lt;span&gt;byte&lt;/span&gt;[] body) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.iterator.hasNext()) {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;             ClientHttpRequestInterceptor nextInterceptor = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.iterator.next();
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ©ç”¨æ‹¦æˆªå™¨æ‹¦æˆªå¤„ç†ï¼Œå¹¶ä¼ å…¥ InterceptingRequestExecution&lt;/span&gt;
&lt;span&gt;22&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; nextInterceptor.intercept(request, body, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‹¦æˆªå™¨éå†å®Œåå¼€å§‹å‘èµ·çœŸæ­£çš„ http è¯·æ±‚&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;             HttpMethod method =&lt;span&gt; request.getMethod();
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             Assert.state(method != &lt;span&gt;null&lt;/span&gt;, &quot;No standard HTTP method&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;             ClientHttpRequest delegate =&lt;span&gt; requestFactory.createRequest(request.getURI(), method);
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;             request.getHeaders().forEach((key, value) -&amp;gt;&lt;span&gt; delegate.getHeaders().addAll(key, value));
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (body.length &amp;gt; 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (delegate &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; StreamingHttpOutputMessage) {
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                     StreamingHttpOutputMessage streamingOutputMessage =&lt;span&gt; (StreamingHttpOutputMessage) delegate;
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                     streamingOutputMessage.setBody(outputStream -&amp;gt;&lt;span&gt; StreamUtils.copy(body, outputStream));
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; &lt;span&gt;                    StreamUtils.copy(body, delegate.getBody());
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; delegate.execute();
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿›å…¥åˆ°Â LoadBalancerInterceptor çš„ intercept æ‹¦æˆªæ–¹æ³•å†…ï¼Œå¯ä»¥çœ‹åˆ°ä»è¯·æ±‚çš„åŸå§‹åœ°å€ä¸­è·å–äº†æœåŠ¡åç§°ï¼Œç„¶åè°ƒç”¨äº† loadBalancer çš„ execute æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ LoadBalancerClientã€‚&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œï¼Œå…¶å®å·²ç»å¯ä»¥æƒ³è±¡ï¼ŒloadBalancer.execute è¿™è¡Œä»£ç å°±æ˜¯æ ¹æ®æœåŠ¡åç§°å»è·å–ä¸€ä¸ªå…·ä½“çš„å®ä¾‹ï¼Œç„¶åå°†åŸå§‹åœ°å€æ›¿æ¢ä¸ºå®ä¾‹çš„IPåœ°å€ã€‚é‚£è¿™ä¸ªÂ loadBalancer åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; ClientHttpResponse intercept(&lt;span&gt;final&lt;/span&gt; HttpRequest request, &lt;span&gt;final&lt;/span&gt; &lt;span&gt;byte&lt;/span&gt;[] body, &lt;span&gt;final&lt;/span&gt; ClientHttpRequestExecution execution) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åŸå§‹åœ°å€ï¼š&lt;/span&gt;&lt;span&gt;http://demo-producer/v1/uuid&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;final&lt;/span&gt; URI originalUri =&lt;span&gt; request.getURI();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; host å°±æ˜¯æœåŠ¡åï¼šdemo-producer&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     String serviceName =&lt;span&gt; originalUri.getHost();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     Assert.state(serviceName != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             &quot;Request URI does not contain a valid hostname: &quot; +&lt;span&gt; originalUri);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.loadBalancer.execute(serviceName,
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.requestFactory.createRequest(request, body, execution));
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;4ã€è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯Â LoadBalancerClient&lt;/h3&gt;
&lt;p&gt;åœ¨é…ç½® LoadBalancerInterceptor æ—¶ï¼Œéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼ŒLoadBalancerClient å’ŒÂ LoadBalancerRequestFactoryï¼ŒLoadBalancerRequestFactoryå‰é¢å·²ç»çŸ¥é“æ˜¯å¦‚ä½•åˆ›å»ºçš„äº†ã€‚LoadBalancerClient åˆæ˜¯åœ¨å“ªåˆ›å»ºçš„å‘¢ï¼Ÿé€šè¿‡ IDEA æœç´¢ï¼Œå¯ä»¥å‘ç°æ˜¯åœ¨ spring-cloud-netflix-ribbon æ¨¡å—ä¸‹çš„ RibbonAutoConfiguration ä¸­é…ç½®çš„ï¼Œå¯ä»¥çœ‹åˆ°Â LoadBalancerClient çš„å®é™…ç±»å‹æ˜¯Â RibbonLoadBalancerClientã€‚&lt;/p&gt;
&lt;p&gt;é…ç½®ç±»çš„é¡ºåºæ˜¯Â EurekaClientAutoConfigurationã€RibbonAutoConfigurationã€LoadBalancerAutoConfigurationï¼Œå› ä¸ºä½¿ RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›éœ€è¦Â LoadBalancerInterceptor æ‹¦æˆªå™¨ï¼Œåˆ›å»º LoadBalancerInterceptor åˆéœ€è¦Â LoadBalancerClientï¼Œè€ŒÂ LoadBalancerClient åº•å±‚è¦æ ¹æ®æœåŠ¡åè·å–æŸä¸ªå®ä¾‹ï¼Œè‚¯å®šåˆéœ€è¦ä¸€ä¸ªå®ä¾‹åº“ï¼Œæ¯”å¦‚ä»é…ç½®æ–‡ä»¶ã€æ³¨å†Œä¸­å¿ƒè·å–ã€‚ä»è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºæ¥ï¼ŒRibbonLoadBalancerClient é»˜è®¤ä¼šä» Eureka æ³¨å†Œä¸­å¿ƒè·å–å®ä¾‹ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Configuration
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; @Conditional(RibbonAutoConfiguration.RibbonClassesConditions.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;@RibbonClients
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åäº EurekaClientAutoConfiguration é…ç½®&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; @AutoConfigureAfter(name = &quot;org.springframework.cloud.netflix.eureka.EurekaClientAutoConfiguration&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å…ˆäº LoadBalancerAutoConfiguration é…ç½®&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt; @AutoConfigureBefore({ LoadBalancerAutoConfiguration.&lt;span&gt;class&lt;/span&gt;,    AsyncLoadBalancerAutoConfiguration.&lt;span&gt;class&lt;/span&gt;&lt;span&gt; })
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; @EnableConfigurationProperties({ RibbonEagerLoadProperties.&lt;span&gt;class&lt;/span&gt;, ServerIntrospectorProperties.&lt;span&gt;class&lt;/span&gt;&lt;span&gt; })
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RibbonAutoConfiguration {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt;     @Autowired(required = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; List&amp;lt;RibbonClientSpecification&amp;gt; configurations = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; 
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; SpringClientFactory springClientFactory() {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         SpringClientFactory factory = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; SpringClientFactory();
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         factory.setConfigurations(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.configurations);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; factory;
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; 
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;     @ConditionalOnMissingBean(LoadBalancerClient.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; LoadBalancerClient loadBalancerClient() {
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RibbonLoadBalancerClient(springClientFactory());
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;LoadBalancerClient ä¸»è¦æä¾›äº†ä¸‰ä¸ªæ¥å£ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; LoadBalancerClient &lt;span&gt;extends&lt;/span&gt;&lt;span&gt; ServiceInstanceChooser {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä» LoadBalancer æ‰¾ä¸€ä¸ª Server æ¥å‘é€è¯·æ±‚&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &amp;lt;T&amp;gt; T execute(String serviceId, LoadBalancerRequest&amp;lt;T&amp;gt; request) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä»ä¼ å…¥çš„ ServiceInstance å– Server æ¥å‘é€è¯·æ±‚  &lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     &amp;lt;T&amp;gt; T execute(String serviceId, ServiceInstance serviceInstance, LoadBalancerRequest&amp;lt;T&amp;gt; request) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯¹åŸå§‹ URI é‡æ„&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    URI reconstructURI(ServiceInstance instance, URI original);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿›å…¥åˆ°Â RibbonLoadBalancerClient çš„ execute æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é¦–å…ˆæ ¹æ®æœåŠ¡åè·å–æœåŠ¡å¯¹åº”çš„è´Ÿè½½å‡è¡¡å™¨Â ILoadBalancerã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åä»Â ILoadBalancer ä¸­æ ¹æ®ä¸€å®šç­–ç•¥é€‰å‡ºä¸€ä¸ªå®ä¾‹ Serverã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå°† serverã€serviceId ç­‰ä¿¡æ¯å°è£…åˆ°Â RibbonServer ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæœåŠ¡å®ä¾‹Â ServiceInstanceã€‚&lt;/li&gt;
&lt;li&gt;æœ€åè°ƒç”¨äº†Â LoadBalancerRequest çš„ applyï¼Œå¹¶ä¼ å…¥ ServiceInstanceï¼Œå°†åœ°å€ä¸­çš„æœåŠ¡åæ›¿æ¢ä¸ºçœŸå®çš„IPåœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;49&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; T execute(String serviceId, LoadBalancerRequest&amp;lt;T&amp;gt; request) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; execute(serviceId, request, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; 
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; T execute(String serviceId, LoadBalancerRequest&amp;lt;T&amp;gt;&lt;span&gt; request, Object hint)
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®æœåŠ¡åè·å–ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ ILoadBalancer&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;     ILoadBalancer loadBalancer =&lt;span&gt; getLoadBalancer(serviceId);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ©ç”¨è´Ÿè½½å‡è¡¡å™¨è·å–å®ä¾‹ Server&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     Server server =&lt;span&gt; getServer(loadBalancer, hint);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (server == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalStateException(&quot;No instances available for &quot; +&lt;span&gt; serviceId);
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°è£…å®ä¾‹ä¿¡æ¯ï¼šRibbonServer çš„çˆ¶ç±»æ˜¯ ServiceInstance&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt;     RibbonServer ribbonServer = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RibbonServer(serviceId, server,
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;            isSecure(server, serviceId),
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;            serverIntrospector(serviceId).getMetadata(server));
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; execute(serviceId, ribbonServer, request);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; 
&lt;span&gt;21&lt;/span&gt; &lt;span&gt;@Override
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &amp;lt;T&amp;gt;&lt;span&gt; T execute(String serviceId, ServiceInstance serviceInstance,
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         LoadBalancerRequest&amp;lt;T&amp;gt; request) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; IOException {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;     Server server = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (serviceInstance &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; RibbonServer) {
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         server =&lt;span&gt; ((RibbonServer) serviceInstance).getServer();
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (server == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalStateException(&quot;No instances available for &quot; +&lt;span&gt; serviceId);
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; 
&lt;span&gt;32&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¤„ç†åœ°å€ï¼Œå°†æœåŠ¡åæ›¿æ¢ä¸ºçœŸå®çš„IPåœ°å€&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt;         T returnVal =&lt;span&gt; request.apply(serviceInstance);
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; returnVal;
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;     } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex) {
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...&lt;/span&gt;
&lt;span&gt;38&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™ä¸ªÂ LoadBalancerRequest å…¶å®å°±æ˜¯ LoadBalancerInterceptor çš„Â intercept ä¸­åˆ›å»ºçš„ä¸€ä¸ªåŒ¿åç±»ï¼Œåœ¨å®ƒçš„å‡½æ•°å¼æ¥å£å†…ï¼Œä¸»è¦æ˜¯ç”¨è£…é¥°å™¨ ServiceRequestWrapper å°†Â request åŒ…äº†ä¸€å±‚ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; LoadBalancerRequest&amp;lt;ClientHttpResponse&amp;gt; createRequest(&lt;span&gt;final&lt;/span&gt; HttpRequest request, &lt;span&gt;final&lt;/span&gt; &lt;span&gt;byte&lt;/span&gt;[] body, &lt;span&gt;final&lt;/span&gt;&lt;span&gt; ClientHttpRequestExecution execution) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; instance -&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°è£… HttpRequestï¼ŒServiceRequestWrapper é‡è½½äº† getURI æ–¹æ³•ã€‚&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;         HttpRequest serviceRequest = &lt;span&gt;new&lt;/span&gt; ServiceRequestWrapper(request, instance, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.loadBalancer);
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.transformers != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (LoadBalancerRequestTransformer transformer : &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.transformers) {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 serviceRequest =&lt;span&gt; transformer.transformRequest(serviceRequest, instance);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç»§ç»­æ‰§è¡Œæ‹¦æˆªå™¨&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; execution.execute(serviceRequest, body);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    };
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ServiceRequestWrapper ä¸»è¦å°±æ˜¯é‡å†™äº†Â getURI æ–¹æ³•ï¼Œåœ¨é‡å†™çš„Â getURI æ–¹æ³•å†…ï¼Œå®ƒç”¨Â loadBalancer å¯¹ URI è¿›è¡Œäº†é‡æ„ï¼Œè¿›å»å¯ä»¥å‘ç°ï¼Œå°±æ˜¯å°†åŸå§‹åœ°å€ä¸­çš„æœåŠ¡åæ›¿æ¢ä¸º Server çš„çœŸå®IPã€ç«¯å£åœ°å€ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;@Override
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; URI getURI() {
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡æ„ URI&lt;/span&gt;
&lt;span&gt;4&lt;/span&gt;     URI uri = &lt;span&gt;this&lt;/span&gt;.loadBalancer.reconstructURI(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.instance, getRequest().getURI());
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; uri;
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; URI reconstructURI(ServiceInstance instance, URI original) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     Assert.notNull(instance, &quot;instance can not be null&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æœåŠ¡å&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     String serviceId =&lt;span&gt; instance.getServiceId();
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     RibbonLoadBalancerContext context = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.clientFactory.getLoadBalancerContext(serviceId);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    URI uri;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    Server server;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (instance &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; RibbonServer) {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         RibbonServer ribbonServer =&lt;span&gt; (RibbonServer) instance;
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         server =&lt;span&gt; ribbonServer.getServer();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         uri =&lt;span&gt; updateToSecureConnectionIfNeeded(original, ribbonServer);
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;         server = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Server(instance.getScheme(), instance.getHost(), instance.getPort());
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;         IClientConfig clientConfig =&lt;span&gt; clientFactory.getClientConfig(serviceId);
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         ServerIntrospector serverIntrospector =&lt;span&gt; serverIntrospector(serviceId);
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         uri =&lt;span&gt; updateToSecureConnectionIfNeeded(original, clientConfig, serverIntrospector, server);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡æ„åœ°å€&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; context.reconstructURIWithServer(server, uri);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;reconstructURIWithServerï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_ed14d2b7-360a-4bfd-a46b-88286c7edd70&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_ed14d2b7-360a-4bfd-a46b-88286c7edd70&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_ed14d2b7-360a-4bfd-a46b-88286c7edd70&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;61&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; URI reconstructURIWithServer(Server server, URI original) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     String host =&lt;span&gt; server.getHost();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; port =&lt;span&gt; server.getPort();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     String scheme =&lt;span&gt; server.getScheme();
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (host.equals(original.getHost()) 
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             &amp;amp;&amp;amp; port ==&lt;span&gt; original.getPort()
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &amp;amp;&amp;amp; scheme ==&lt;span&gt; original.getScheme()) {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; original;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (scheme == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         scheme =&lt;span&gt; original.getScheme();
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (scheme == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;         scheme =&lt;span&gt; deriveSchemeAndPortFromPartialUri(original).first();
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; 
&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         StringBuilder sb = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuilder();
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         sb.append(scheme).append(&quot;://&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;Strings.isNullOrEmpty(original.getRawUserInfo())) {
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;             sb.append(original.getRawUserInfo()).append(&quot;@&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;        sb.append(host);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (port &amp;gt;= 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;             sb.append(&quot;:&quot;&lt;span&gt;).append(port);
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;        sb.append(original.getRawPath());
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;Strings.isNullOrEmpty(original.getRawQuery())) {
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;             sb.append(&quot;?&quot;&lt;span&gt;).append(original.getRawQuery());
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;Strings.isNullOrEmpty(original.getRawFragment())) {
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;             sb.append(&quot;#&quot;&lt;span&gt;).append(original.getRawFragment());
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         URI newURI = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; URI(sb.toString());
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; newURI;            
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;     } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (URISyntaxException e) {
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RuntimeException(e);
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;h3&gt;5ã€RestTemplate è´Ÿè½½å‡è¡¡æ€»ç»“&lt;/h3&gt;
&lt;p&gt;åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬å°±å¼„æ¸…æ¥šäº†ä¸€ä¸ªç®€å•çš„Â @LoadBalanced æ³¨è§£å¦‚ä½•è®© RestTemplate å…·å¤‡äº†è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›äº†ï¼Œè¿™ä¸€èŠ‚æ¥åšä¸ªå°ç»“ã€‚&lt;/p&gt;
&lt;p&gt;â‘ Â RestTemplate å¦‚ä½•è·å¾—è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;1ï¼‰é¦–å…ˆÂ RestTemplate æ˜¯ spring-web æ¨¡å—ä¸‹ä¸€ä¸ªè®¿é—®ç¬¬ä¸‰æ–¹ RESTful API æ¥å£çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶&lt;/li&gt;
&lt;li&gt;2ï¼‰åœ¨ spring cloud å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œç”¨ @LoadBalanced å¯¹Â RestTemplate åšä¸ªæ ‡è®°ï¼Œå°±å¯ä»¥ä½¿Â RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;3ï¼‰ä½¿ RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„æ ¸å¿ƒç»„ä»¶å°±æ˜¯Â LoadBalancerAutoConfiguration é…ç½®ç±»ä¸­å‘å…¶æ·»åŠ çš„Â LoadBalancerInterceptor è´Ÿè½½å‡è¡¡æ‹¦æˆªå™¨&lt;/li&gt;
&lt;li&gt;4ï¼‰RestTemplate åœ¨å‘èµ· http è°ƒç”¨å‰ï¼Œä¼šéå†æ‰€æœ‰æ‹¦æˆªå™¨æ¥å¯¹Â RestTemplate å®šåˆ¶åŒ–ï¼ŒLoadBalancerInterceptor å°±æ˜¯åœ¨è¿™æ—¶å°†URIä¸­çš„æœåŠ¡åæ›¿æ¢ä¸ºå®ä¾‹çš„çœŸå®IPåœ°å€ã€‚å®šåˆ¶å®Œæˆåï¼Œå°±ä¼šå‘èµ·çœŸæ­£çš„ http è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;5ï¼‰LoadBalancerInterceptor åˆä¸»è¦æ˜¯ä½¿ç”¨è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ LoadBalancerClient æ¥å®ŒæˆURIçš„é‡æ„çš„ï¼ŒLoadBalancerClient å°±å¯ä»¥æ ¹æ®æœåŠ¡åæŸ¥æ‰¾ä¸€ä¸ªå¯ç”¨çš„å®ä¾‹ï¼Œç„¶åé‡æ„URIã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;â‘¡ æ ¸å¿ƒç»„ä»¶&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¼šæ¶‰åŠå¤šä¸ªæ¨¡å—ï¼Œä¸‹é¢æ˜¯æ ¸å¿ƒç»„ä»¶çš„æ‰€å±æ¨¡å—ï¼š&lt;/p&gt;
&lt;p&gt;spring-webï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;RestTemplate&lt;/li&gt;
&lt;li&gt;InterceptingClientHttpRequestï¼šæ‰§è¡Œæ‹¦æˆªå™¨ï¼Œå¹¶å‘èµ·æœ€ç»ˆhttpè°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;spring-cloud-commonsï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;@LoadBalanced&lt;/li&gt;
&lt;li&gt;LoadBalancerAutoConfiguration&lt;/li&gt;
&lt;li&gt;LoadBalancerRequestFactoryï¼šåˆ›å»ºè£…é¥°ç±»Â ServiceRequestWrapper æ›¿æ¢åŸæ¥çš„Â HttpRequestï¼Œé‡è½½ getURI æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;LoadBalancerInterceptorï¼šè´Ÿè½½å‡è¡¡æ‹¦æˆªå™¨&lt;/li&gt;
&lt;li&gt;LoadBalancerClientï¼šè´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯æ¥å£&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;spring-cloud-netflix-ribbonï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;RibbonLoadBalancerClientï¼šLoadBalancerClient çš„å®ç°ç±»ï¼ŒRibbon çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯&lt;/li&gt;
&lt;li&gt;RibbonAutoConfiguration&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;ribbon-loadbalancerï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ILoadBalancerï¼šè´Ÿè½½å‡è¡¡å™¨&lt;/li&gt;
&lt;li&gt;Serverï¼šå®ä¾‹&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;â‘¢ æœ€åå†ç”¨ä¸€å¼ å›¾æŠŠ RestTemplate è¿™å—çš„å…³ç³»æ‹ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201213173012493-1028244863.png&quot; alt=&quot;&quot; width=&quot;1661&quot; height=&quot;976&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;ä¸‰ã€ILoadBalancer è·å– Server&lt;/h2&gt;
&lt;p&gt;ä»å‰é¢ RestTemplate é‚£å¼ å›¾å¯ä»¥çœ‹å‡ºï¼Œä½¿ RestTemplate å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ï¼Œæœ€é‡è¦çš„ä¸€ä¸ªç»„ä»¶ä¹‹ä¸€å°±æ˜¯Â ILoadBalancerï¼Œå› ä¸ºè¦ç”¨å®ƒæ¥è·å–èƒ½è°ƒç”¨çš„ Serverï¼Œæœ‰äº† Server æ‰èƒ½å¯¹åŸå§‹å¸¦æœ‰æœåŠ¡åçš„ URI è¿›è¡Œé‡æ„ã€‚è¿™èŠ‚å°±æ¥çœ‹ä¸‹ Ribbon çš„è´Ÿè½½å‡è¡¡å™¨ ILoadBalancer æ˜¯å¦‚ä½•åˆ›å»ºçš„ä»¥åŠå¦‚ä½•é€šè¿‡å®ƒè·å– Serverã€‚&lt;/p&gt;
&lt;h3&gt;1ã€åˆ›å»ºè´Ÿè½½å‡è¡¡å™¨Â ILoadBalancer&lt;/h3&gt;
&lt;p&gt;â‘  SpringClientFactoryä¸ä¸Šä¸‹æ–‡&lt;/p&gt;
&lt;p&gt;ILoadBalancer æ˜¯ç”¨ SpringClientFactory çš„ getLoadBalancer æ–¹æ³•æ ¹æ®æœåŠ¡åè·å–çš„ï¼Œä» getInstance ä¸€æ­¥æ­¥è¿›å»å¯ä»¥å‘ç°ï¼Œæ¯ä¸ªæœåŠ¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªÂ AnnotationConfigApplicationContextï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡ ApplicationContextã€‚ç›¸å½“äºå°±æ˜¯ä¸€ä¸ªæœåŠ¡ç»‘å®šä¸€ä¸ªÂ ILoadBalancerã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &amp;lt;C&amp;gt; C getInstance(String name, Class&amp;lt;C&amp;gt;&lt;span&gt; type) {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     C instance = &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.getInstance(name, type);
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (instance != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; instance;
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt;     IClientConfig config = getInstance(name, IClientConfig.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; instantiateWithConfig(getContext(name), type, config);
&lt;/span&gt;&lt;span&gt;8&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; T getInstance(String name, Class&amp;lt;T&amp;gt;&lt;span&gt; type) {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®åç§°è·å–&lt;/span&gt;
&lt;span&gt;3&lt;/span&gt;     AnnotationConfigApplicationContext context =&lt;span&gt; getContext(name);
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (BeanFactoryUtils.beanNamesForTypeIncludingAncestors(context, type).length &amp;gt; 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; context.getBean(type);
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;8&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt;&lt;span&gt; AnnotationConfigApplicationContext getContext(String name) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; contexts =&amp;gt; Map&amp;lt;String, AnnotationConfigApplicationContext&amp;gt;&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.contexts.containsKey(name)) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         &lt;span&gt;synchronized&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.contexts) {
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.contexts.containsKey(name)) {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.contexts.put(name, createContext(name));
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.contexts.get(name);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è°ƒè¯•çœ‹ä¸‹Â AnnotationConfigApplicationContext ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥çœ‹åˆ°æ”¾å…¥äº†ä¸è¿™ä¸ªæœåŠ¡ç»‘å®šçš„Â ILoadBalancerã€IClientConfigã€RibbonLoadBalancerContext ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒè¿™é‡Œä¸ºä»€ä¹ˆè¦æ¯ä¸ªæœåŠ¡éƒ½ç»‘å®šä¸€ä¸ª ApplicationContext å‘¢ï¼Ÿæˆ‘çŒœæƒ³åº”è¯¥æ˜¯å› ä¸ºæœåŠ¡å®ä¾‹åˆ—è¡¨å¯ä»¥æœ‰å¤šä¸ªæ¥æºï¼Œæ¯”å¦‚å¯ä»¥ä» eureka æ³¨å†Œä¸­å¿ƒè·å–ã€å¯ä»¥é€šè¿‡ä»£ç é…ç½®ã€å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®ï¼Œå¦å¤–æ¯ä¸ªæœåŠ¡è¿˜å¯ä»¥æœ‰å¾ˆå¤šä¸ªæ€§åŒ–çš„é…ç½®ï¼Œæœ‰é»˜è®¤çš„é…ç½®ã€å®šåˆ¶çš„å…¨å±€é…ç½®ã€ä¸ªåˆ«æœåŠ¡çš„ç‰¹å®šé…ç½®ç­‰ï¼Œå®ƒè¿™æ ·åšå°±ä¾¿äºç”¨æˆ·å®šåˆ¶æ¯ä¸ªæœåŠ¡çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201213181808005-2030427626.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;â‘¡ Ribbonçš„é¥¥é¥¿åŠ è½½&lt;/p&gt;
&lt;p&gt;è€Œä¸”è¿™ä¸ªRibbonå®¢æˆ·ç«¯çš„åº”ç”¨ä¸Šä¸‹æ–‡é»˜è®¤æ˜¯æ‡’åŠ è½½çš„ï¼Œå¹¶ä¸æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™å°±åŠ è½½ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™æ‰ä¼šå»åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³æœåŠ¡å¯åŠ¨æ—¶å°±åˆå§‹åŒ–ï¼Œå¯ä»¥æŒ‡å®šRibbonå®¢æˆ·ç«¯çš„å…·ä½“åç§°ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™å°±åŠ è½½é…ç½®é¡¹çš„ä¸Šä¸‹æ–‡ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;ribbon:
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;   eager-&lt;span&gt;load:
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;     enabled: &lt;span&gt;true&lt;/span&gt;
&lt;span&gt;4&lt;/span&gt;     clients: demo-producer,demo-xxx
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;â‘¢ RibbonClientConfiguration&lt;/p&gt;
&lt;p&gt;ILoadBalancer çš„åˆ›å»ºåœ¨å“ªå‘¢ï¼Ÿçœ‹Â RibbonClientConfigurationï¼Œè¿™ä¸ªé…ç½®ç±»æä¾›äº†Â ILoadBalancer çš„é»˜è®¤åˆ›å»ºæ–¹æ³•ï¼ŒILoadBalancer çš„é»˜è®¤å®ç°ç±»ä¸ºÂ ZoneAwareLoadBalancerã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;63&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RibbonClientConfiguration {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_CONNECT_TIMEOUT = 1000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; 
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_READ_TIMEOUT = 1000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; DEFAULT_GZIP_PAYLOAD = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    @RibbonClientName
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; String name = &quot;client&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; 
&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    @Autowired
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; PropertiesFactory propertiesFactory;
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; 
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IClientConfig ribbonClientConfig() {
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         DefaultClientConfigImpl config = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DefaultClientConfigImpl();
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         config.loadProperties(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name);
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;        config.set(CommonClientConfigKey.ConnectTimeout, DEFAULT_CONNECT_TIMEOUT);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;        config.set(CommonClientConfigKey.ReadTimeout, DEFAULT_READ_TIMEOUT);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        config.set(CommonClientConfigKey.GZipPayload, DEFAULT_GZIP_PAYLOAD);
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; config;
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; 
&lt;span&gt;26&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IRule ribbonRule(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(IRule.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(IRule.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         ZoneAvoidanceRule rule = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ZoneAvoidanceRule();
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;        rule.initWithNiwsConfig(config);
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; rule;
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; 
&lt;span&gt;37&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IPing ribbonPing(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(IPing.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt;41&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(IPing.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DummyPing();
&lt;/span&gt;&lt;span&gt;44&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;45&lt;/span&gt; 
&lt;span&gt;46&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;48&lt;/span&gt;     @SuppressWarnings(&quot;unchecked&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;49&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ServerList&amp;lt;Server&amp;gt;&lt;span&gt; ribbonServerList(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;50&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(ServerList.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(ServerList.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt;52&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;53&lt;/span&gt;         ConfigurationBasedServerList serverList = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ConfigurationBasedServerList();
&lt;/span&gt;&lt;span&gt;54&lt;/span&gt; &lt;span&gt;        serverList.initWithNiwsConfig(config);
&lt;/span&gt;&lt;span&gt;55&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; serverList;
&lt;/span&gt;&lt;span&gt;56&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;57&lt;/span&gt; 
&lt;span&gt;58&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;59&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;60&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ServerListUpdater ribbonServerListUpdater(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;61&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; PollingServerListUpdater(config);
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;63&lt;/span&gt; 
&lt;span&gt;64&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;65&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;66&lt;/span&gt;     @SuppressWarnings(&quot;unchecked&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;67&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ServerListFilter&amp;lt;Server&amp;gt;&lt;span&gt; ribbonServerListFilter(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;68&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(ServerListFilter.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt;69&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(ServerListFilter.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt;70&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;71&lt;/span&gt;         ZonePreferenceServerListFilter filter = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ZonePreferenceServerListFilter();
&lt;/span&gt;&lt;span&gt;72&lt;/span&gt; &lt;span&gt;        filter.initWithNiwsConfig(config);
&lt;/span&gt;&lt;span&gt;73&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; filter;
&lt;/span&gt;&lt;span&gt;74&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;75&lt;/span&gt; 
&lt;span&gt;76&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;77&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;78&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ILoadBalancer ribbonLoadBalancer(IClientConfig config,
&lt;/span&gt;&lt;span&gt;79&lt;/span&gt;             ServerList&amp;lt;Server&amp;gt; serverList, ServerListFilter&amp;lt;Server&amp;gt;&lt;span&gt; serverListFilter,
&lt;/span&gt;&lt;span&gt;80&lt;/span&gt; &lt;span&gt;            IRule rule, IPing ping, ServerListUpdater serverListUpdater) {
&lt;/span&gt;&lt;span&gt;81&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å…ˆåˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦é…ç½®äº†è´Ÿè½½å‡è¡¡å™¨&lt;/span&gt;
&lt;span&gt;82&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(ILoadBalancer.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt;83&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é€šè¿‡åå°„åˆ›å»º&lt;/span&gt;
&lt;span&gt;84&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(ILoadBalancer.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt;85&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;86&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ZoneAwareLoadBalancer&amp;lt;&amp;gt;&lt;span&gt;(config, rule, ping, serverList,
&lt;/span&gt;&lt;span&gt;87&lt;/span&gt; &lt;span&gt;                serverListFilter, serverListUpdater);
&lt;/span&gt;&lt;span&gt;88&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;89&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åˆ›å»ºÂ ILoadBalancer éœ€è¦Â IClientConfigã€ServerList&amp;lt;Server&amp;gt;ã€ServerListFilter&amp;lt;Server&amp;gt;ã€IRuleã€IPingã€ServerListUpdaterï¼Œå…¶å®è¿™6ä¸ªæ¥å£åŠ ä¸ŠÂ ILoadBalancer å°±æ˜¯ Ribbon çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒä»¬å…±åŒå®šä¹‰äº† Ribbon çš„è¡Œä¸ºç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¿™7ä¸ªæ ¸å¿ƒæ¥å£å’Œé»˜è®¤å®ç°ç±»å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201213184838393-167017566.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;2ã€å®¢æˆ·ç«¯ Ribbon å®šåˆ¶&lt;/h3&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨Â RibbonClientConfiguration ä¸­åˆ›å»ºÂ IRuleã€IPingã€ServerList&amp;lt;Server&amp;gt;ã€ServerListFilter&amp;lt;Server&amp;gt;ã€ILoadBalancer æ—¶ï¼Œéƒ½å…ˆé€šè¿‡Â propertiesFactory.isSet åˆ¤æ–­æ˜¯å¦å·²é…ç½®äº†å¯¹åº”ç±»å‹çš„å®ç°ç±»ï¼Œæ²¡æœ‰æ‰ä½¿ç”¨é»˜è®¤çš„å®ç°ç±»ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´é’ˆå¯¹ç‰¹å®šçš„æœåŠ¡ï¼Œè¿™å‡ ä¸ªç±»å¯ä»¥è‡ªè¡Œå®šåˆ¶åŒ–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æŒ‡å®šå…¶å®ƒçš„å®ç°ç±»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201213185516288-1021170746.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;â‘  å…¨å±€ç­–ç•¥é…ç½®&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³è¦å…¨å±€æ›´æ”¹é…ç½®ï¼Œéœ€è¦åŠ ä¸€ä¸ªé…ç½®ç±»ï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Configuration
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; GlobalRibbonConfiguration {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IRule ribbonRule() {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RandomRule();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IPing ribbonPing() {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NoOpPing();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;â‘¡ åŸºäºæ³¨è§£çš„é…ç½®&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³é’ˆå¯¹æŸä¸€ä¸ªæœåŠ¡å®šåˆ¶é…ç½®ï¼Œå¯ä»¥é€šè¿‡ @RibbonClients æ¥é…ç½®ç‰¹å®šæœåŠ¡çš„é…ç½®ç±»ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªæœåŠ¡é…ç½®ç±»ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Configuration
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ProducerRibbonConfiguration {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IRule ribbonRule() {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RandomRule();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IPing ribbonPing() {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NoOpPing();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç”¨Â @RibbonClients æ³¨è§£ä¸ºæœåŠ¡æŒ‡å®šç‰¹å®šçš„é…ç½®ç±»ï¼Œå¹¶æ’é™¤æ‰ï¼Œä¸è®© Spring æ‰«æï¼Œå¦åˆ™å°±å˜æˆäº†å…¨å±€é…ç½®äº†ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;@RibbonClients({
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     @RibbonClient(name = &quot;demo-producer&quot;, configuration = ProducerRibbonConfiguration.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; &lt;span&gt;})
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; @ComponentScan(excludeFilters =&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;     @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, classes = ProducerRibbonConfiguration.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; })
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;â‘¢ é…ç½®æ–‡ä»¶é…ç½®&lt;/p&gt;
&lt;p&gt;é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥é…ç½®ï¼Œé…ç½®çš„æ ¼å¼å°±æ˜¯ &amp;lt;æœåŠ¡åç§°&amp;gt;.ribbon.&amp;lt;å±æ€§&amp;gt;ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; demo-&lt;span&gt;producer:
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;  ribbon:
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;    # ILoadBalancer
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    NFLoadBalancerClassName: com.netflix.loadbalancer.NoOpLoadBalancer
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;    # IRule
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;    NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    # IPing
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    NFLoadBalancerPingClassName:
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     # ServerList&amp;lt;Server&amp;gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    NIWSServerListClassName:
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     # ServerListFilter&amp;lt;Server&amp;gt;
&lt;span&gt;12&lt;/span&gt;     NIWSServerListFilterClassName:
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;â‘£ ä¼˜å…ˆçº§é¡ºåº&lt;/p&gt;
&lt;p&gt;è¿™å‡ ç§é…ç½®æ–¹å¼çš„ä¼˜å…ˆçº§é¡ºåºæ˜¯ é…ç½®æ–‡ä»¶é…ç½® &amp;gt; @RibbonClients é…ç½® &amp;gt; å…¨å±€é…ç½® &amp;gt; é»˜è®¤é…ç½®ã€‚&lt;/p&gt;
&lt;h3&gt;3ã€ZoneAwareLoadBalancer é€‰æ‹© Server&lt;/h3&gt;
&lt;p&gt;è·å–åˆ°Â ILoadBalancer åï¼Œå°±è¦å»è·å– Server äº†ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå°±æ˜¯ç”¨Â ILoadBalancer æ¥è·å– Serverã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt;&lt;span&gt; Server getServer(ILoadBalancer loadBalancer, Object hint) {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (loadBalancer == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Use 'default' on a null hint, or just pass it on?&lt;/span&gt;
&lt;span&gt;6&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; loadBalancer.chooseServer(hint != &lt;span&gt;null&lt;/span&gt; ? hint : &quot;default&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ILoadBalancerÂ  çš„é»˜è®¤å®ç°ç±»æ˜¯ ZoneAwareLoadBalancerï¼Œè¿›å…¥å®ƒçš„Â chooseServer æ–¹æ³•å†…ï¼Œå¦‚æœåªé…ç½®äº†ä¸€ä¸ª zoneï¼Œå°±èµ°çˆ¶ç±»çš„ chooseServerï¼Œå¦åˆ™ä»å¤šä¸ª zone ä¸­å»é€‰æ‹©å®ä¾‹ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Server chooseServer(Object key) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ENABLED =&amp;gt; ZoneAwareNIWSDiscoveryLoadBalancer.enabled é»˜è®¤ true
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; AvailableZones é…ç½®çš„åªæœ‰ä¸€ä¸ª defaultZone&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (!ENABLED.get() || getLoadBalancerStats().getAvailableZones().size() &amp;lt;= 1&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         logger.debug(&quot;Zone aware logic disabled or there is only one zone&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; èµ°çˆ¶ç±»è·å– Server çš„é€»è¾‘&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.chooseServer(key);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¤š zone é€»è¾‘....&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…ˆçœ‹ä¸‹Â ZoneAwareLoadBalancer çš„ç±»ç»§æ‰¿ç»“æ„ï¼ŒZoneAwareLoadBalancer çš„ç›´æ¥çˆ¶ç±»æ˜¯Â DynamicServerListLoadBalancerï¼ŒDynamicServerListLoadBalancer çš„çˆ¶ç±»åˆæ˜¯Â BaseLoadBalancerã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201215110125267-931853835.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ZoneAwareLoadBalancer è°ƒç”¨çˆ¶ç±»çš„ chooseServer æ–¹æ³•æ˜¯åœ¨Â BaseLoadBalancer ä¸­çš„ï¼Œè¿›å»å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¸»è¦æ˜¯ç”¨ IRule æ¥é€‰æ‹©å®ä¾‹ï¼Œæœ€ç»ˆé€‰æ‹©å®ä¾‹çš„ç­–ç•¥å°±äº¤ç»™äº† IRule æ¥å£ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Server chooseServer(Object key) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (counter == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;         counter =&lt;span&gt; createCounter();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;    counter.increment();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (rule == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; IRule&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; rule.choose(key);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;             logger.warn(&quot;LoadBalancer [{}]:  Error choosing server for key {}&quot;&lt;span&gt;, name, key, e);
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;4ã€ZoneAvoidanceRule æ–­è¨€ç­›é€‰ã€è½®è¯¢é€‰æ‹© Server&lt;/h3&gt;
&lt;p&gt;IRule çš„é»˜è®¤å®ç°ç±»æ˜¯Â ZoneAvoidanceRuleï¼Œå…ˆçœ‹ä¸‹Â ZoneAvoidanceRule çš„ç»§æ‰¿ç»“æ„ï¼ŒZoneAvoidanceRule çš„ç›´æ¥çˆ¶ç±»æ˜¯Â PredicateBasedRuleã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201215111847730-941911802.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;rule.choose çš„é€»è¾‘åœ¨Â PredicateBasedRule ä¸­ï¼ŒgetPredicate() è¿”å›çš„æ˜¯Â ZoneAvoidanceRule åˆ›å»ºçš„ä¸€ä¸ªç»„åˆæ–­è¨€Â CompositePredicateï¼Œå°±æ˜¯ç”¨è¿™ä¸ªæ–­è¨€æ¥è¿‡æ»¤å‡ºå¯ç”¨çš„ Serverï¼Œå¹¶é€šè¿‡è½®è¯¢çš„ç­–ç•¥è¿”å›ä¸€ä¸ª Serverã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Server choose(Object key) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     ILoadBalancer lb =&lt;span&gt; getLoadBalancer();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; getPredicate() Serveræ–­è¨€ =&amp;gt; CompositePredicate
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; RoundRobin è½®è¯¢æ–¹å¼è·å–å®ä¾‹&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     Optional&amp;lt;Server&amp;gt; server =&lt;span&gt; getPredicate().chooseRoundRobinAfterFiltering(lb.getAllServers(), key);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (server.isPresent()) {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; server.get();
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    }       
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨åˆå§‹åŒ–Â ZoneAvoidanceRule é…ç½®æ—¶ï¼Œåˆ›å»ºäº†Â CompositePredicateï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªç»„åˆæ–­è¨€ä¸»è¦æœ‰ä¸¤ä¸ªæ–­è¨€ï¼Œä¸€ä¸ªæ˜¯æ–­è¨€ Server çš„ zone æ˜¯å¦å¯ç”¨ï¼Œä¸€ä¸ªæ–­è¨€ Server æœ¬èº«æ˜¯å¦å¯ç”¨ï¼Œä¾‹å¦‚ Server æ— æ³• ping é€šã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; initWithNiwsConfig(IClientConfig clientConfig) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ–­è¨€ Server çš„ zone æ˜¯å¦å¯ç”¨ï¼Œåªæœ‰ä¸€ä¸ª defaultZone çš„æƒ…å†µä¸‹éƒ½æ˜¯å¯ç”¨çš„&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;     ZoneAvoidancePredicate zonePredicate = &lt;span&gt;new&lt;/span&gt; ZoneAvoidancePredicate(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;, clientConfig);
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ–­è¨€ Server æ˜¯å¦å¯ç”¨&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     AvailabilityPredicate availabilityPredicate = &lt;span&gt;new&lt;/span&gt; AvailabilityPredicate(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;, clientConfig);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°è£…ç»„åˆæ–­è¨€&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     compositePredicate =&lt;span&gt; createCompositePredicate(zonePredicate, availabilityPredicate);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;private&lt;/span&gt;&lt;span&gt; CompositePredicate createCompositePredicate(ZoneAvoidancePredicate p1, AvailabilityPredicate p2) {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å»ºé€ è€…æ¨¡å¼åˆ›å»ºæ–­è¨€&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; CompositePredicate.withPredicates(p1, p2)
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                         .addFallbackPredicate(p2)
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;                         .addFallbackPredicate(AbstractServerPredicate.alwaysTrue())
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;                         .build();
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     
&lt;span&gt;17&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ¥ç€çœ‹é€‰æ‹©Serverçš„Â chooseRoundRobinAfterFilteringï¼Œå‚æ•° servers æ˜¯é€šè¿‡Â ILoadBalancer è·å–çš„æ‰€æœ‰å®ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°å®ƒå…¶å®å°±æ˜¯è¿”å›äº†Â ILoadBalancer åœ¨å†…å­˜ä¸­ç¼“å­˜çš„æœåŠ¡æ‰€æœ‰ Serverã€‚è¿™ä¸ª Server ä»å“ªæ¥çš„æˆ‘ä»¬åé¢å†æ¥çœ‹ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;Server&amp;gt;&lt;span&gt; getAllServers() {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; allServerList =&amp;gt; List&amp;lt;Server&amp;gt;&lt;/span&gt;
&lt;span&gt;3&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Collections.unmodifiableList(allServerList);
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…ˆå¯¹æ‰€æœ‰å®ä¾‹é€šè¿‡æ–­è¨€è¿‡æ»¤æ‰ä¸å¯ç”¨çš„ Serverï¼Œç„¶åæ˜¯é€šè¿‡è½®è¯¢çš„æ–¹å¼è·å–ä¸€ä¸ª Server è¿”å›ã€‚è¿™å°±æ˜¯é»˜è®¤é…ç½®ä¸‹Â ILoadBalancerï¼ˆZoneAwareLoadBalancerï¼‰ é€šè¿‡ IRuleï¼ˆZoneAvoidanceRuleï¼‰ é€‰æ‹© Server çš„æµç¨‹äº†ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; Optional&amp;lt;Server&amp;gt; chooseRoundRobinAfterFiltering(List&amp;lt;Server&amp;gt;&lt;span&gt; servers, Object loadBalancerKey) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ–­è¨€è·å–å¯ç”¨çš„ Server&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;     List&amp;lt;Server&amp;gt; eligible =&lt;span&gt; getEligibleServers(servers, loadBalancerKey);
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (eligible.size() == 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Optional.absent();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é€šè¿‡å–æ¨¡çš„æ–¹å¼è½®è¯¢ Server&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Optional.of(eligible.get(incrementAndGetModulo(eligible.size())));
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;Server&amp;gt; getEligibleServers(List&amp;lt;Server&amp;gt;&lt;span&gt; servers, Object loadBalancerKey) {
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (loadBalancerKey == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; ImmutableList.copyOf(Iterables.filter(servers, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.getServerOnlyPredicate()));            
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;         List&amp;lt;Server&amp;gt; results =&lt;span&gt; Lists.newArrayList();
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯¹æ¯ä¸ª Server æ–­è¨€&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt;         &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Server server: servers) {
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.apply(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; PredicateKey(loadBalancerKey, server))) {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                results.add(server);
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; results;            
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; 
&lt;span&gt;26&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; incrementAndGetModulo(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; modulo) {
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (;;) {
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         &lt;span&gt;int&lt;/span&gt; current =&lt;span&gt; nextIndex.get();
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ¨¡è¿ç®—å–ä½™æ•°&lt;/span&gt;
&lt;span&gt;30&lt;/span&gt;         &lt;span&gt;int&lt;/span&gt; next = (current + 1) %&lt;span&gt; modulo;
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; CAS æ›´æ–° nextIndex&lt;/span&gt;
&lt;span&gt;32&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (nextIndex.compareAndSet(current, next) &amp;amp;&amp;amp; current &amp;lt;&lt;span&gt; modulo)
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; current;
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;å››ã€Ribbon æ•´åˆ Eureka Client æ‹‰å–Serveråˆ—è¡¨&lt;/h2&gt;
&lt;p&gt;å‰é¢åœ¨é€šè¿‡ IRule é€‰æ‹© Server çš„æ—¶å€™ï¼Œé¦–å…ˆé€šè¿‡Â lb.getAllServers() è·å–äº†æ‰€æœ‰çš„ Serverï¼Œé‚£è¿™äº› Server ä»å“ªé‡Œæ¥çš„å‘¢ï¼Œè¿™èŠ‚å°±æ¥çœ‹ä¸‹ã€‚&lt;/p&gt;
&lt;h3&gt;1ã€ILoadBalancer åˆå§‹åŒ–&lt;/h3&gt;
&lt;p&gt;ILoadBalancer çš„é»˜è®¤å®ç°ç±»æ˜¯Â ZoneAwareLoadBalancerï¼Œå…ˆä»Â ZoneAwareLoadBalancer çš„æ„é€ æ–¹æ³•è¿›å»çœ‹çœ‹éƒ½åšäº†äº›ä»€ä¹ˆäº‹æƒ…ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Bean
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;@ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ILoadBalancer ribbonLoadBalancer(IClientConfig config,
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         ServerList&amp;lt;Server&amp;gt; serverList, ServerListFilter&amp;lt;Server&amp;gt;&lt;span&gt; serverListFilter,
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;        IRule rule, IPing ping, ServerListUpdater serverListUpdater) {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(ILoadBalancer.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, name)) {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(ILoadBalancer.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, name);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ZoneAwareLoadBalancer&amp;lt;&amp;gt;&lt;span&gt;(config, rule, ping, serverList,
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;            serverListFilter, serverListUpdater);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼ŒZoneAwareLoadBalancer ç›´æ¥è°ƒç”¨äº†çˆ¶ç±»Â DynamicServerListLoadBalancer çš„æ„é€ æ–¹æ³•ï¼ŒDynamicServerListLoadBalancer å…ˆè°ƒç”¨çˆ¶ç±»Â BaseLoadBalancer åˆå§‹åŒ–ï¼Œç„¶ååˆåšäº†ä¸€äº›å‰©ä½™çš„åˆå§‹åŒ–å·¥ä½œã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;57&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ZoneAwareLoadBalancer(IClientConfig clientConfig, IRule rule,
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;                              IPing ping, ServerList&amp;lt;T&amp;gt; serverList, ServerListFilter&amp;lt;T&amp;gt;&lt;span&gt; filter,
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;                             ServerListUpdater serverListUpdater) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; DynamicServerListLoadBalancer&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;super&lt;/span&gt;&lt;span&gt;(clientConfig, rule, ping, serverList, filter, serverListUpdater);
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; DynamicServerListLoadBalancer(IClientConfig clientConfig, IRule rule, IPing ping,
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                                      ServerList&amp;lt;T&amp;gt; serverList, ServerListFilter&amp;lt;T&amp;gt;&lt;span&gt; filter,
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                                     ServerListUpdater serverListUpdater) {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; BaseLoadBalancer&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;super&lt;/span&gt;&lt;span&gt;(clientConfig, rule, ping);
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.serverListImpl =&lt;span&gt; serverList;
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.filter =&lt;span&gt; filter;
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.serverListUpdater =&lt;span&gt; serverListUpdater;
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (filter &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; AbstractServerListFilter) {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;        ((AbstractServerListFilter) filter).setLoadBalancerStats(getLoadBalancerStats());
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å‰©ä½™çš„ä¸€äº›åˆå§‹åŒ–&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    restOfInit(clientConfig);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; 
&lt;span&gt;23&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; BaseLoadBalancer(IClientConfig config, IRule rule, IPing ping) {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; createLoadBalancerStatsFromConfig =&amp;gt; LoadBalancerStats ç»Ÿè®¡&lt;/span&gt;
&lt;span&gt;25&lt;/span&gt; &lt;span&gt;    initWithConfig(config, rule, ping, createLoadBalancerStatsFromConfig(config));
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;çœ‹Â BaseLoadBalancer çš„Â initWithConfigï¼Œä¸»è¦åšäº†å¦‚ä¸‹çš„åˆå§‹åŒ–ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è®¾ç½® IPing å’Œ IRuleï¼Œping çš„é—´éš”æ—¶é—´æ˜¯ 30 ç§’ï¼ŒsetPing ä¼šå¯åŠ¨ä¸€ä¸ªåå°å®šæ—¶ä»»åŠ¡ï¼Œç„¶åæ¯éš”30ç§’è¿è¡Œä¸€æ¬¡Â PingTask ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½®äº† ILoadBalancer çš„ ç»Ÿè®¡å™¨Â LoadBalancerStatsï¼Œå¯¹ ILoadBalancer çš„ Server çŠ¶æ€è¿›è¡Œç»Ÿè®¡ï¼Œæ¯”å¦‚è¿æ¥å¤±è´¥ã€æˆåŠŸã€ç†”æ–­ç­‰ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å¯ç”¨Â PrimeConnections è¯·æ±‚é¢„çƒ­çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºÂ PrimeConnections æ¥é¢„çƒ­å®¢æˆ·ç«¯ ä¸ Server çš„é“¾æ¥ã€‚é»˜è®¤æ˜¯å…³é—­çš„ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åæ˜¯æ³¨å†Œäº†ä¸€äº›ç›‘æ§ã€å¼€å¯è¯·æ±‚é¢„çƒ­ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;46&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; initWithConfig(IClientConfig clientConfig, IRule rule, IPing ping, LoadBalancerStats stats) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.config =&lt;span&gt; clientConfig;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     String clientName =&lt;span&gt; clientConfig.getClientName();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; clientName;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ping é—´éš”æ—¶é—´ï¼Œé»˜è®¤30ç§’&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; pingIntervalTime = Integer.parseInt(&quot;&quot;
&lt;span&gt; 7&lt;/span&gt;             +&lt;span&gt; clientConfig.getProperty(
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;                    CommonClientConfigKey.NFLoadBalancerPingInterval,
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     Integer.parseInt(&quot;30&quot;&lt;span&gt;)));
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ²¡çœ‹åˆ°ç”¨çš„åœ°æ–¹                &lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; maxTotalPingTime = Integer.parseInt(&quot;&quot;
&lt;span&gt;12&lt;/span&gt;             +&lt;span&gt; clientConfig.getProperty(
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                    CommonClientConfigKey.NFLoadBalancerMaxTotalPingTime,
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                     Integer.parseInt(&quot;2&quot;&lt;span&gt;)));
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® ping é—´éš”æ—¶é—´ï¼Œå¹¶é‡æ–°è®¾ç½®äº† ping ä»»åŠ¡&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    setPingInterval(pingIntervalTime);
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;    setMaxTotalPingTime(maxTotalPingTime);
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; 
&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® IRuleã€IPing&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    setRule(rule);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;    setPing(ping);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; 
&lt;span&gt;23&lt;/span&gt; &lt;span&gt;    setLoadBalancerStats(stats);
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;     rule.setLoadBalancer(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (ping &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; AbstractLoadBalancerPing) {
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         ((AbstractLoadBalancerPing) ping).setLoadBalancer(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;     logger.info(&quot;Client: {} instantiated a LoadBalancer: {}&quot;, name, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;     
&lt;span&gt;30&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; PrimeConnectionsï¼Œè¯·æ±‚é¢„çƒ­ï¼Œé»˜è®¤å…³é—­
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä½œç”¨ä¸»è¦ç”¨äºè§£å†³é‚£äº›éƒ¨ç½²ç¯å¢ƒ(å¦‚è¯»EC2)åœ¨å®é™…ä½¿ç”¨å®æ—¶è¯·æ±‚ä¹‹å‰ï¼Œä»é˜²ç«å¢™è¿æ¥/è·¯å¾„è¿›è¡Œé¢„çƒ­ï¼ˆæ¯”å¦‚å…ˆåŠ ç™½åå•ã€åˆå§‹åŒ–ç­‰ç­‰åŠ¨ä½œæ¯”è¾ƒè€—æ—¶ï¼Œå¯ä»¥ç”¨å®ƒå…ˆå»æ‰“é€šï¼‰ã€‚&lt;/span&gt;
&lt;span&gt;32&lt;/span&gt;     &lt;span&gt;boolean&lt;/span&gt; enablePrimeConnections =&lt;span&gt; clientConfig.get(
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;            CommonClientConfigKey.EnablePrimeConnections, DefaultClientConfigImpl.DEFAULT_ENABLE_PRIME_CONNECTIONS);
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (enablePrimeConnections) {
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.setEnablePrimingConnections(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;         PrimeConnections primeConnections = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; PrimeConnections(
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;                 &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.getName(), clientConfig);
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.setPrimeConnections(primeConnections);
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ³¨å†Œä¸€äº›ç›‘æ§&lt;/span&gt;
&lt;span&gt;41&lt;/span&gt; &lt;span&gt;    init();
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt; 
&lt;span&gt;44&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; init() {
&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;     Monitors.registerObject(&quot;LoadBalancer_&quot; + name, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;46&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; register the rule as it contains metric for available servers count&lt;/span&gt;
&lt;span&gt;47&lt;/span&gt;     Monitors.registerObject(&quot;Rule_&quot; + name, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.getRule());
&lt;/span&gt;&lt;span&gt;48&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é»˜è®¤å…³é—­&lt;/span&gt;
&lt;span&gt;49&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (enablePrimingConnections &amp;amp;&amp;amp; primeConnections != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;50&lt;/span&gt; &lt;span&gt;        primeConnections.primeConnections(getReachableServers());
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;52&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å†çœ‹ä¸‹Â DynamicServerListLoadBalancer çš„åˆå§‹åŒ–ï¼Œæ ¸å¿ƒçš„åˆå§‹åŒ–é€»è¾‘åœ¨Â restOfInit ä¸­ï¼Œä¸»è¦å°±æ˜¯åšäº†ä¸¤ä»¶äº‹æƒ…ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å¼€å¯åŠ¨æ€æ›´æ–° Server çš„ç‰¹æ€§ï¼Œæ¯”å¦‚å®ä¾‹ä¸Šçº¿ã€ä¸‹çº¿ã€æ•…éšœç­‰ï¼Œè¦èƒ½å¤Ÿæ›´æ–° ILoadBalancer çš„ Server åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åå°±å…¨é‡æ›´æ–°ä¸€æ¬¡æœ¬åœ°çš„ Server åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; restOfInit(IClientConfig clientConfig) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;boolean&lt;/span&gt; primeConnection = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.isEnablePrimingConnections();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; turn this off to avoid duplicated asynchronous priming done in BaseLoadBalancer.setServerList()&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.setEnablePrimingConnections(&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¼€å¯åŠ¨æ€æ›´æ–° Server çš„ç‰¹æ€§&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    enableAndInitLearnNewServersFeature();
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ›´æ–° Server åˆ—è¡¨&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    updateListOfServers();
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¼€å¯è¯·æ±‚é¢„çƒ­çš„æƒ…å†µä¸‹ï¼Œå¯¹å¯ç”¨çš„ Server è¿›è¡Œé¢„çƒ­&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (primeConnection &amp;amp;&amp;amp; &lt;span&gt;this&lt;/span&gt;.getPrimeConnections() != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.getPrimeConnections()
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;                .primeConnections(getReachableServers());
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.setEnablePrimingConnections(primeConnection);
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;     LOGGER.info(&quot;DynamicServerListLoadBalancer for client {} initialized: {}&quot;, clientConfig.getClientName(), &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.toString());
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2ã€å…¨é‡æ›´æ–°Serveråˆ—è¡¨&lt;/h3&gt;
&lt;p&gt;å…ˆçœ‹ä¸‹Â updateListOfServers() æ˜¯å¦‚ä½•æ›´æ–° Server åˆ—è¡¨çš„ï¼Œè¿›è€Œçœ‹ä¸‹ ILoadBalancer æ˜¯å¦‚ä½•å­˜å‚¨ Server çš„ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é¦–å…ˆä½¿ç”¨Â ServerList è·å–æ‰€æœ‰çš„ Server åˆ—è¡¨ï¼Œåœ¨Â RibbonClientConfiguration ä¸­é…ç½®çš„æ˜¯Â ConfigurationBasedServerListï¼Œä½†å’Œ eureka é›†åˆå’Œï¼Œå°±ä¸æ˜¯Â ConfigurationBasedServerList äº†ï¼Œè¿™å—ä¸‹ä¸€èŠ‚å†æ¥çœ‹ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åä½¿ç”¨Â ServerListFilter å¯¹ Server åˆ—è¡¨è¿‡æ»¤ï¼Œå…¶é»˜è®¤å®ç°ç±»æ˜¯Â ZonePreferenceServerListFilterï¼Œå®ƒä¸»è¦æ˜¯è¿‡æ»¤å‡ºå½“å‰ Zoneï¼ˆdefaultZoneï¼‰ä¸‹çš„ Serverã€‚&lt;/li&gt;
&lt;li&gt;æœ€åå°±æ˜¯æ›´æ–°æ‰€æœ‰ Server åˆ—è¡¨ï¼Œå…ˆæ˜¯è®¾ç½® Server aliveï¼Œç„¶åè°ƒç”¨çˆ¶ç±»ï¼ˆBaseLoadBalancerï¼‰çš„Â setServersList æ¥æ›´æ–°Serveråˆ—è¡¨ï¼Œè¿™è¯´æ˜ Server æ˜¯å­˜å‚¨åœ¨Â BaseLoadBalancer é‡Œçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; updateListOfServers() {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     List&amp;lt;T&amp;gt; servers = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;T&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (serverListImpl != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä» ServerList è·å–æ‰€æœ‰ Server åˆ—è¡¨&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;         servers =&lt;span&gt; serverListImpl.getUpdatedListOfServers();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         LOGGER.debug(&quot;List of Servers for {} obtained from Discovery client: {}&quot;&lt;span&gt;, getIdentifier(), servers);
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (filter != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç”¨ ServerListFilter è¿‡æ»¤ Server&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;             servers =&lt;span&gt; filter.getFilteredListOfServers(servers);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             LOGGER.debug(&quot;Filtered List of Servers for {} obtained from Discovery client: {}&quot;&lt;span&gt;, getIdentifier(), servers);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ›´æ–°æ‰€æœ‰ Server åˆ°æœ¬åœ°ç¼“å­˜&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    updateAllServerList(servers);
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; 
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; updateAllServerList(List&amp;lt;T&amp;gt;&lt;span&gt; ls) {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (serverListUpdateInProgress.compareAndSet(&lt;span&gt;false&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;&lt;span&gt;)) {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (T s : ls) {
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;                 s.setAlive(&lt;span&gt;true&lt;/span&gt;); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® Server alive&lt;/span&gt;
&lt;span&gt;23&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;            setServersList(ls);
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¼ºåˆ¶åˆå§‹åŒ– Ping&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;             &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.forceQuickPing();
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;         } &lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;             serverListUpdateInProgress.set(&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; 
&lt;span&gt;33&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setServersList(List lsrv) {
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; BaseLoadBalancer&lt;/span&gt;
&lt;span&gt;35&lt;/span&gt;     &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.setServersList(lsrv);
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;     
&lt;span&gt;37&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°† Server æ›´æ–°åˆ° LoadBalancerStats ç»Ÿè®¡ä¸­ ....&lt;/span&gt;
&lt;span&gt;38&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ¥ç€çœ‹çˆ¶ç±»çš„ setServersListï¼Œå¯ä»¥çœ‹å‡ºï¼Œå­˜å‚¨æ‰€æœ‰ Server çš„æ•°æ®ç»“æ„Â allServerList æ˜¯ä¸€ä¸ªåŠ äº† synchronized çš„çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼ŒsetServersList å°±æ˜¯ç›´æ¥å°†å¾—åˆ°çš„ Server åˆ—è¡¨æ›¿æ¢Â  allServerListã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setServersList(List lsrv) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     Lock writeLock =&lt;span&gt; allServerLock.writeLock();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     ArrayList&amp;lt;Server&amp;gt; newServers = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;Server&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åŠ å†™é”&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;    writeLock.lock();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; for å¾ªç¯å°† lsrv ä¸­çš„ Server è½¬ç§»åˆ° allServers&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;         ArrayList&amp;lt;Server&amp;gt; allServers = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;Server&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Object server : lsrv) {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (server == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                 &lt;span&gt;continue&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (server &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; String) {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                 server = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Server((String) server);
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (server &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; Server) {
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                 logger.debug(&quot;LoadBalancer [{}]:  addServer [{}]&quot;&lt;span&gt;, name, ((Server) server).getId());
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;                allServers.add((Server) server);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                 &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalArgumentException(&quot;Type String or Server expected, instead found:&quot; +&lt;span&gt; server.getClass());
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         
&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;boolean&lt;/span&gt; listChanged = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; allServerList =&amp;gt; volatile List&amp;lt;Server&amp;gt; allServerList = Collections.synchronizedList(new ArrayList&amp;lt;Server&amp;gt;())&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;allServerList.equals(allServers)) {
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             listChanged = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æœåŠ¡åˆ—è¡¨å˜æ›´ç›‘å¬å™¨ ServerListChangeListenerï¼Œ å‘å‡ºæœåŠ¡å˜æ›´é€šçŸ¥...&lt;/span&gt;
&lt;span&gt;29&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;         
&lt;span&gt;31&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯ç”¨äº†æœåŠ¡é¢„çƒ­ï¼Œå¼€å§‹ Server é¢„çƒ­...
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         
&lt;span&gt;33&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç›´æ¥æ›¿æ¢&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt;         allServerList =&lt;span&gt; allServers;
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (canSkipPing()) {
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Server s : allServerList) {
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;                 s.setAlive(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;             upServerList =&lt;span&gt; allServerList;
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;         } &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (listChanged) {
&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; &lt;span&gt;            forceQuickPing();
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;     } &lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;44&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡Šæ”¾å†™é”&lt;/span&gt;
&lt;span&gt;45&lt;/span&gt; &lt;span&gt;        writeLock.unlock();
&lt;/span&gt;&lt;span&gt;46&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å‰é¢ chooseRoundRobinAfterFiltering è·å–æ‰€æœ‰ Server æ—¶å°±æ˜¯è¿”å›çš„è¿™ä¸ª allServerListåˆ—è¡¨ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;Server&amp;gt;&lt;span&gt; getAllServers() {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Collections.unmodifiableList(allServerList);
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;3ã€Eureka Ribbon å®¢æˆ·ç«¯é…ç½®&lt;/h3&gt;
&lt;p&gt;è·å– Server çš„ç»„ä»¶æ˜¯ ServerListï¼ŒRibbonClientConfiguration ä¸­é…ç½®çš„é»˜è®¤å®ç°ç±»æ˜¯ ConfigurationBasedServerListã€‚ConfigurationBasedServerList é»˜è®¤æ˜¯ä»é…ç½®æ–‡ä»¶ä¸­è·å–ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·é…ç½®æœåŠ¡å®ä¾‹åœ°å€ï¼Œå¤šä¸ª Server åœ°å€ç”¨é€—å·éš”å¼€ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; demo-&lt;span&gt;producer:
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; &lt;span&gt;  ribbon:
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;     listOfServers: http:&lt;span&gt;//&lt;/span&gt;&lt;span&gt;10.215.0.92:8010,&lt;/span&gt;&lt;span&gt;http://10.215.0.92&lt;/span&gt;&lt;span&gt;:8011&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½†æ˜¯å’Œ eureka-client ç»“åˆåï¼Œä¹Ÿå°±æ˜¯å¼•å…¥ spring-cloud-starter-netflix-eureka-client çš„å®¢æˆ·ç«¯ä¾èµ–ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬å¼•å…¥ spring-cloud-netflix-eureka-client ä¾èµ–ï¼Œè¿™ä¸ªåŒ…ä¸­æœ‰ä¸€ä¸ª RibbonEurekaAutoConfiguration è‡ªåŠ¨åŒ–é…ç½®ç±»ï¼Œå®ƒé€šè¿‡ @RibbonClients æ³¨è§£å®šä¹‰äº†å…¨å±€çš„ Ribbon å®¢æˆ·ç«¯é…ç½®ç±» ä¸ºÂ EurekaRibbonClientConfiguration&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; @Configuration(proxyBeanMethods = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; &lt;span&gt;@EnableConfigurationProperties
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; &lt;span&gt;@ConditionalOnRibbonAndEurekaEnabled
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; @AutoConfigureAfter(RibbonAutoConfiguration.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; @RibbonClients(defaultConfiguration = EurekaRibbonClientConfiguration.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RibbonEurekaAutoConfiguration {
&lt;/span&gt;&lt;span&gt;7&lt;/span&gt; 
&lt;span&gt;8&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿›å…¥ EurekaRibbonClientConfigurationÂ  å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;IPing çš„é»˜è®¤å®ç°ç±»ä¸º NIWSDiscoveryPingã€‚&lt;/li&gt;
&lt;li&gt;ServerList çš„é»˜è®¤å®ç°ç±»ä¸º DomainExtractingServerListï¼Œä½†æ˜¯ DomainExtractingServerList åœ¨æ„é€ æ—¶åˆä¼ å…¥äº†ä¸€ä¸ªç±»å‹ä¸º DiscoveryEnabledNIWSServerList çš„ ServerListã€‚çœ‹åå­—å¤§æ¦‚ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒDiscoveryEnabledNIWSServerList å°±æ˜¯ä» EurekaClient è·å– Server çš„ç»„ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;45&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; @Configuration(proxyBeanMethods = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; EurekaRibbonClientConfiguration {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     @Value(&quot;${ribbon.eureka.approximateZoneFromHostname:false}&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; approximateZoneFromHostname = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;    @RibbonClientName
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; String serviceId = &quot;client&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    @Autowired
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; PropertiesFactory propertiesFactory;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IPing ribbonPing(IClientConfig config) {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(IPing.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, serviceId)) {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(IPing.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, serviceId);
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         NIWSDiscoveryPing ping = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NIWSDiscoveryPing();
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;        ping.initWithNiwsConfig(config);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; ping;
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; 
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;    @Bean
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;    @ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ServerList&amp;lt;?&amp;gt;&lt;span&gt; ribbonServerList(IClientConfig config,
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             Provider&amp;lt;EurekaClient&amp;gt;&lt;span&gt; eurekaClientProvider) {
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.propertiesFactory.isSet(ServerList.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, serviceId)) {
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.propertiesFactory.get(ServerList.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;, config, serviceId);
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         DiscoveryEnabledNIWSServerList discoveryServerList = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DiscoveryEnabledNIWSServerList(config, eurekaClientProvider);
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;         DomainExtractingServerList serverList = &lt;span&gt;new&lt;/span&gt; DomainExtractingServerList(discoveryServerList, config, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.approximateZoneFromHostname);
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; serverList;
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;4ã€ä» DiscoveryClient è·å–Serveråˆ—è¡¨&lt;/h3&gt;
&lt;p&gt;DynamicServerListLoadBalancer ä¸­é€šè¿‡ ServerList çš„ getUpdatedListOfServers æ–¹æ³•å…¨é‡è·å–æœåŠ¡åˆ—è¡¨ï¼Œåœ¨ eureka-client ç¯å¢ƒä¸‹ï¼ŒServerList é»˜è®¤å®ç°ç±»ä¸º DomainExtractingServerListï¼Œé‚£å°±å…ˆçœ‹ä¸‹å®ƒçš„ getUpdatedListOfServers æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼ŒDomainExtractingServerList å…ˆç”¨ DomainExtractingServerList è·å–æœåŠ¡åˆ—è¡¨ï¼Œç„¶åæ ¹æ® Ribbon å®¢æˆ·ç«¯é…ç½®é‡æ–°æ„é€  Server å¯¹è±¡è¿”å›ã€‚è·å–æœåŠ¡åˆ—è¡¨çš„æ ¸å¿ƒåœ¨ DiscoveryEnabledNIWSServerList ä¸­ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Override
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt; getUpdatedListOfServers() {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; list =&amp;gt; DiscoveryEnabledNIWSServerList&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     List&amp;lt;DiscoveryEnabledServer&amp;gt; servers = setZones(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.list.getUpdatedListOfServers());
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; servers;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; List&amp;lt;DiscoveryEnabledServer&amp;gt; setZones(List&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt; servers) {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     List&amp;lt;DiscoveryEnabledServer&amp;gt; result = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;boolean&lt;/span&gt; isSecure = &lt;span&gt;this&lt;/span&gt;.ribbon.isSecure(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;boolean&lt;/span&gt; shouldUseIpAddr = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.ribbon.isUseIPAddrForServer();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®å®¢æˆ·ç«¯é…ç½®é‡æ–°æ„é€  DomainExtractingServer è¿”å›&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (DiscoveryEnabledServer server : servers) {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;         result.add(&lt;span&gt;new&lt;/span&gt; DomainExtractingServer(server, isSecure, shouldUseIpAddr, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.approximateZoneFromHostname));
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; result;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…ˆçœ‹ä¸‹ DiscoveryEnabledNIWSServerListÂ  çš„æ„é€ åˆå§‹åŒ–ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ä¸»è¦æ˜¯ä¼ å…¥äº† Provider&amp;lt;EurekaClient&amp;gt; ç”¨æ¥è·å– EurekaClient&lt;/li&gt;
&lt;li&gt;å¦å¤–è¿˜è®¾ç½®äº†å®¢æˆ·ç«¯åç§° clientName ï¼Œä»¥åŠ vipAddresses ä¹Ÿæ˜¯å®¢æˆ·ç«¯åç§°ï¼Œè¿™ä¸ªåé¢ä¼šç”¨å¾—ä¸Šã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; DiscoveryEnabledNIWSServerList(IClientConfig clientConfig, Provider&amp;lt;EurekaClient&amp;gt;&lt;span&gt; eurekaClientProvider) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.eurekaClientProvider =&lt;span&gt; eurekaClientProvider;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;    initWithNiwsConfig(clientConfig);
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;@Override
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; initWithNiwsConfig(IClientConfig clientConfig) {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å®¢æˆ·ç«¯åç§°ï¼Œå°±æ˜¯æœåŠ¡åç§°&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;     clientName =&lt;span&gt; clientConfig.getClientName();
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; vipAddresses å¾—åˆ°çš„ä¹Ÿæ˜¯å®¢æˆ·ç«¯åç§°&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;     vipAddresses =&lt;span&gt; clientConfig.resolveDeploymentContextbasedVipAddresses();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å…¶å®ƒçš„ä¸€äº›é…ç½®....&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ¥ç€çœ‹è·å–å®ä¾‹çš„ getUpdatedListOfServersï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„æ ¸å¿ƒé€»è¾‘å°±æ˜¯æ ¹æ®æœåŠ¡åä» EurekaClient è·å–Â InstanceInfo å®ä¾‹åˆ—è¡¨ï¼Œç„¶åå°è£… Server ä¿¡æ¯è¿”å›ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt; getUpdatedListOfServers(){
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; obtainServersViaDiscovery();
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; 
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; List&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt; obtainServersViaDiscovery() {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     List&amp;lt;DiscoveryEnabledServer&amp;gt; serverList = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (eurekaClientProvider == &lt;span&gt;null&lt;/span&gt; || eurekaClientProvider.get() == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;DiscoveryEnabledServer&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¾—åˆ° EurekaClientï¼Œå®é™…ç±»å‹æ˜¯ CloudEurekaClientï¼Œå…¶çˆ¶ç±»æ˜¯ DiscoveryClient&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;     EurekaClient eurekaClient =&lt;span&gt; eurekaClientProvider.get();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (vipAddresses!=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;){
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ†å‰² vipAddressesï¼Œé»˜è®¤å°±æ˜¯æœåŠ¡åç§°&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;for&lt;/span&gt; (String vipAddress : vipAddresses.split(&quot;,&quot;&lt;span&gt;)) {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®æœåŠ¡åç§°ä» EurekaClient è·å–å®ä¾‹ä¿¡æ¯&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt;             List&amp;lt;InstanceInfo&amp;gt; listOfInstanceInfo =&lt;span&gt; eurekaClient.getInstancesByVipAddress(vipAddress, isSecure, targetRegion);
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (InstanceInfo ii : listOfInstanceInfo) {
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (ii.getStatus().equals(InstanceStatus.UP)) {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®å®ä¾‹ä¿¡æ¯ InstanceInfo åˆ›å»º Server&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt;                     DiscoveryEnabledServer des =&lt;span&gt; createServer(ii, isSecure, shouldUseIpAddr);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;                    serverList.add(des);
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (serverList.size()&amp;gt;0 &amp;amp;&amp;amp;&lt;span&gt; prioritizeVipAddressBasedServers){
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;                 &lt;span&gt;break&lt;/span&gt;; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; if the current vipAddress has servers, we dont use subsequent vipAddress based servers&lt;/span&gt;
&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; serverList;
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ³¨æ„è¿™é‡Œçš„ vipAddress å…¶å®å°±æ˜¯æœåŠ¡åï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201215234148091-320779200.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æœ€åçœ‹ EurekaClient çš„ getInstancesByVipAddressï¼Œåˆ°è¿™é‡Œå°±å¾ˆæ¸…æ¥šäº†ï¼Œå…¶å®å°±æ˜¯ä» DiscoveryClient çš„æœ¬åœ°åº”ç”¨ Applications ä¸­æ ¹æ®æœåŠ¡åå–å‡ºæ‰€æœ‰çš„å®ä¾‹åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå°±å’Œ Eureka æºç é‚£å—è¡”æ¥ä¸Šäº†ï¼Œeureka-client å…¨é‡æŠ“å–æ³¨å†Œè¡¨ä»¥åŠæ¯éš”30ç§’å¢é‡æŠ“å–æ³¨å†Œè¡¨ï¼Œéƒ½æ˜¯åˆå¹¶åˆ°æœ¬åœ°çš„ Applications ä¸­ã€‚Ribbon ä¸ Eureka ç»“åˆåï¼ŒRibbon è·å– Server å°±ä» DiscoveryClient çš„ Applications ä¸­è·å– Server åˆ—è¡¨äº†ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; List&amp;lt;InstanceInfo&amp;gt; getInstancesByVipAddress(String vipAddress, &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; secure, String region) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;    Applications applications;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (instanceRegionChecker.isLocalRegion(region)) {
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å–æœ¬åœ°åº”ç”¨ Applications&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;         applications = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.localRegionApps.get();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;         applications =&lt;span&gt; remoteRegionVsApps.get(region);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;null&lt;/span&gt; ==&lt;span&gt; applications) {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Collections.emptyList();
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; 
&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;secure) {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¿”å›æœåŠ¡åå¯¹åº”çš„å®ä¾‹&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; applications.getInstancesByVirtualHostName(vipAddress);
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; applications.getInstancesBySecureVirtualHostName(vipAddress);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;5ã€å®šæ—¶æ›´æ–°Serveråˆ—è¡¨&lt;/h3&gt;
&lt;p&gt;DynamicServerListLoadBalancer åˆå§‹åŒ–æ—¶ï¼Œæœ‰ä¸ªæ–¹æ³•è¿˜æ²¡è¯´ï¼Œå°±æ˜¯ enableAndInitLearnNewServersFeature()ã€‚è¿™ä¸ªæ–¹æ³•åªæ˜¯è°ƒç”¨ ServerListUpdater å¯åŠ¨äº†ä¸€ä¸ª UpdateActionï¼Œè¿™ä¸ª UpdateAction åˆåªæ˜¯è°ƒç”¨äº†ä¸€ä¸‹ updateListOfServers æ–¹æ³•ï¼Œå°±æ˜¯å‰é¢è®²è§£è¿‡çš„å…¨é‡æ›´æ–° Server çš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; enableAndInitLearnNewServersFeature() {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;    serverListUpdater.start(updateAction);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; 
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ServerListUpdater.UpdateAction updateAction = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ServerListUpdater.UpdateAction() {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;    @Override
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; doUpdate() {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è°ƒç”¨ updateListOfServers&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;        updateListOfServers();
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; };
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ServerListUpdater çš„é»˜è®¤å®ç°ç±»æ˜¯ PollingServerListUpdaterï¼Œçœ‹ä¸‹å®ƒçš„ start æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;å…¶å®å°±æ˜¯ä»¥å›ºå®šçš„é¢‘ç‡ï¼Œæ¯éš”30ç§’è°ƒç”¨ä¸€ä¸‹ updateListOfServers æ–¹æ³•ï¼Œå°† DiscoveryClient ä¸­ Applications ä¸­ç¼“å­˜çš„å®ä¾‹åŒæ­¥åˆ° ILoadBalancer ä¸­çš„ allServerList åˆ—è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;synchronized&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; start(&lt;span&gt;final&lt;/span&gt;&lt;span&gt; UpdateAction updateAction) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (isActive.compareAndSet(&lt;span&gt;false&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;&lt;span&gt;)) {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;         &lt;span&gt;final&lt;/span&gt; Runnable wrapperRunnable = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Runnable() {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;            @Override
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; run() {
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;                 &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‰§è¡Œä¸€æ¬¡ updateListOfServers&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;                    updateAction.doUpdate();
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½®æœ€åæ›´æ–°æ—¶é—´&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;                     lastUpdated =&lt;span&gt; System.currentTimeMillis();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                 } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                     logger.warn(&quot;Failed one update cycle&quot;&lt;span&gt;, e);
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;        };
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         
&lt;span&gt;18&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å›ºå®šé¢‘ç‡è°ƒåº¦&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt;         scheduledFuture =&lt;span&gt; getRefreshExecutor().scheduleWithFixedDelay(
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                wrapperRunnable,
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;                 initialDelayMs, &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é»˜è®¤ 1000&lt;/span&gt;
&lt;span&gt;22&lt;/span&gt;                 refreshIntervalMs, &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é»˜è®¤ 30 * 1000&lt;/span&gt;
&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                TimeUnit.MILLISECONDS
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;        );
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         logger.info(&quot;Already active, no-op&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;6ã€åˆ¤æ–­Serveræ˜¯å¦å­˜æ´»&lt;/h3&gt;
&lt;p&gt;åœ¨åˆ›å»º ILoadBalancer æ—¶ï¼ŒIPing è¿˜æ²¡æœ‰çœ‹è¿‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦å°±æ˜¯è®¾ç½®äº†å½“å‰çš„ pingï¼Œç„¶åé‡æ–°è®¾ç½®äº†ä¸€ä¸ªè°ƒåº¦ä»»åŠ¡ï¼Œé»˜è®¤æ¯éš”30ç§’è°ƒåº¦ä¸€æ¬¡ PingTask ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setPing(IPing ping) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (ping != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!ping.equals(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.ping)) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;this&lt;/span&gt;.ping =&lt;span&gt; ping;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® Ping ä»»åŠ¡&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;            setupPingTask();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     } &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.ping = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; cancel the timer task&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;        lbTimer.cancel();
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; 
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setupPingTask() {
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ›å»ºä¸€ä¸ªå®šæ—¶è°ƒåº¦å™¨&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt;     lbTimer = &lt;span&gt;new&lt;/span&gt; ShutdownEnabledTimer(&quot;NFLoadBalancer-PingTimer-&quot; + name, &lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; pingIntervalTime é»˜è®¤ä¸º 30 ç§’ï¼Œæ¯éš”30ç§’è°ƒåº¦ä¸€æ¬¡ PingTask&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt;     lbTimer.schedule(&lt;span&gt;new&lt;/span&gt; PingTask(), 0, pingIntervalSeconds * 1000&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç«‹å³å‘èµ·ä»¥ Ping&lt;/span&gt;
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;    forceQuickPing();
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ShutdownEnabledTimer å¯ä»¥ç®€å•äº†è§£ä¸‹ï¼Œå®ƒæ˜¯ç»§æ‰¿è‡ª Timer çš„ï¼Œå®ƒåœ¨åˆ›å»ºçš„æ—¶å€™å‘ Runtime æ³¨å†Œäº†ä¸€ä¸ªå›è°ƒï¼Œåœ¨ jvm å…³é—­çš„æ—¶å€™æ¥å–æ¶ˆ Timer çš„æ‰§è¡Œï¼Œè¿›è€Œé‡Šæ”¾èµ„æºã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_1e8a8969-2487-4d0c-bb9f-2b986607f461&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_1e8a8969-2487-4d0c-bb9f-2b986607f461&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_1e8a8969-2487-4d0c-bb9f-2b986607f461&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;65&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; ShutdownEnabledTimer &lt;span&gt;extends&lt;/span&gt;&lt;span&gt; Timer {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Logger LOGGER = LoggerFactory.getLogger(ShutdownEnabledTimer.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; Thread cancelThread;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; String name;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; ShutdownEnabledTimer(String name, &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; daemon) {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;         &lt;span&gt;super&lt;/span&gt;&lt;span&gt;(name, daemon);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å–æ¶ˆå®šæ—¶å™¨çš„çº¿ç¨‹&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.cancelThread = &lt;span&gt;new&lt;/span&gt; Thread(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Runnable() {
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;             &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; run() {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 ShutdownEnabledTimer.&lt;span&gt;super&lt;/span&gt;&lt;span&gt;.cancel();
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;        });
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; 
&lt;span&gt;17&lt;/span&gt;         LOGGER.info(&quot;Shutdown hook installed for: {}&quot;, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name);
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å‘ Runtime æ³¨å†Œä¸€ä¸ªé’©å­ï¼Œåœ¨ jvm å…³é—­æ—¶ï¼Œè°ƒç”¨ cancelThread å–æ¶ˆå®šæ—¶ä»»åŠ¡&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt;         Runtime.getRuntime().addShutdownHook(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.cancelThread);
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; 
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;    @Override
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; cancel() {
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;super&lt;/span&gt;&lt;span&gt;.cancel();
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         LOGGER.info(&quot;Shutdown hook removed for: {}&quot;, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name);
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             Runtime.getRuntime().removeShutdownHook(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.cancelThread);
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (IllegalStateException ise) {
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;             LOGGER.info(&quot;Exception caught (might be ok if at shutdown)&quot;&lt;span&gt;, ise);
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; 
&lt;span&gt;32&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;å†æ¥çœ‹ä¸‹ PingTaskï¼ŒPingTask æ ¸å¿ƒé€»è¾‘å°±æ˜¯éå†Â allServers åˆ—è¡¨ï¼Œä½¿ç”¨ IPingStrategy å’Œ IPing æ¥åˆ¤æ–­ Server æ˜¯å¦å­˜æ´»ï¼Œå¹¶æ›´æ–° Server çš„çŠ¶æ€ï¼Œä»¥åŠå°†æ‰€æœ‰å­˜æ´»çš„ Server æ›´æ–°åˆ° upServerList ä¸­ï¼ŒupServerList ç¼“å­˜äº†æ‰€æœ‰å­˜æ´»çš„ Serverã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_ba897ff2-b983-4326-bbe1-f182b5d2644e&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_ba897ff2-b983-4326-bbe1-f182b5d2644e&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_ba897ff2-b983-4326-bbe1-f182b5d2644e&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;67&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; PingTask &lt;span&gt;extends&lt;/span&gt;&lt;span&gt; TimerTask {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; run() {
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; pingStrategy =&amp;gt; SerialPingStrategy&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Pinger(pingStrategy).runPinger();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             logger.error(&quot;LoadBalancer [{}]: Error pinging&quot;&lt;span&gt;, name, e);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; 
&lt;span&gt;12&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Pinger {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt;&lt;span&gt; IPingStrategy pingerStrategy;
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; 
&lt;span&gt;15&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Pinger(IPingStrategy pingerStrategy) {
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.pingerStrategy =&lt;span&gt; pingerStrategy;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; 
&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; runPinger() &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; Exception {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!pingInProgress.compareAndSet(&lt;span&gt;false&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;&lt;span&gt;)) { 
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Ping in progress - nothing to do&lt;/span&gt;
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; 
&lt;span&gt;24&lt;/span&gt;         Server[] allServers = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;boolean&lt;/span&gt;[] results = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; 
&lt;span&gt;27&lt;/span&gt;         Lock allLock = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         Lock upLock = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         
&lt;span&gt;30&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;             allLock =&lt;span&gt; allServerLock.readLock();
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;            allLock.lock();
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åŠ è¯»é”ï¼Œå–å‡º allServerList ä¸­çš„ Server&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt;             allServers = allServerList.toArray(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Server[allServerList.size()]);
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;            allLock.unlock();
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; 
&lt;span&gt;37&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; numCandidates =&lt;span&gt; allServers.length;
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä½¿ç”¨ IPingStrategy å’Œ IPing å¯¹æ‰€æœ‰ Server å‘èµ· ping è¯·æ±‚&lt;/span&gt;
&lt;span&gt;39&lt;/span&gt;             results =&lt;span&gt; pingerStrategy.pingServers(ping, allServers);
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; 
&lt;span&gt;41&lt;/span&gt;             &lt;span&gt;final&lt;/span&gt; List&amp;lt;Server&amp;gt; newUpList = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;Server&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt;             &lt;span&gt;final&lt;/span&gt; List&amp;lt;Server&amp;gt; changedServers = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;Server&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt; 
&lt;span&gt;44&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = 0; i &amp;lt; numCandidates; i++&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;                 &lt;span&gt;boolean&lt;/span&gt; isAlive =&lt;span&gt; results[i];
&lt;/span&gt;&lt;span&gt;46&lt;/span&gt;                 Server svr =&lt;span&gt; allServers[i];
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt;                 &lt;span&gt;boolean&lt;/span&gt; oldIsAlive =&lt;span&gt; svr.isAlive();
&lt;/span&gt;&lt;span&gt;48&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® alive æ˜¯å¦å­˜æ´»&lt;/span&gt;
&lt;span&gt;49&lt;/span&gt; &lt;span&gt;                svr.setAlive(isAlive);
&lt;/span&gt;&lt;span&gt;50&lt;/span&gt; 
&lt;span&gt;51&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å®ä¾‹å˜æ›´&lt;/span&gt;
&lt;span&gt;52&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (oldIsAlive !=&lt;span&gt; isAlive) {
&lt;/span&gt;&lt;span&gt;53&lt;/span&gt; &lt;span&gt;                    changedServers.add(svr);
&lt;/span&gt;&lt;span&gt;54&lt;/span&gt;                     logger.debug(&quot;LoadBalancer [{}]:  Server [{}] status changed to {}&quot;,  name, svr.getId(), (isAlive ? &quot;ALIVE&quot; : &quot;DEAD&quot;&lt;span&gt;));
&lt;/span&gt;&lt;span&gt;55&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;56&lt;/span&gt; 
&lt;span&gt;57&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ·»åŠ å­˜æ´»çš„ Server&lt;/span&gt;
&lt;span&gt;58&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isAlive) {
&lt;/span&gt;&lt;span&gt;59&lt;/span&gt; &lt;span&gt;                    newUpList.add(svr);
&lt;/span&gt;&lt;span&gt;60&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;61&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt;             upLock =&lt;span&gt; upServerLock.writeLock();
&lt;/span&gt;&lt;span&gt;63&lt;/span&gt; &lt;span&gt;            upLock.lock();
&lt;/span&gt;&lt;span&gt;64&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ›´æ–° upServerListï¼ŒupServerList åªä¿å­˜äº†å­˜æ´»çš„ Server&lt;/span&gt;
&lt;span&gt;65&lt;/span&gt;             upServerList =&lt;span&gt; newUpList;
&lt;/span&gt;&lt;span&gt;66&lt;/span&gt; &lt;span&gt;            upLock.unlock();
&lt;/span&gt;&lt;span&gt;67&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é€šçŸ¥å˜æ›´&lt;/span&gt;
&lt;span&gt;68&lt;/span&gt; &lt;span&gt;            notifyServerStatusChangeListener(changedServers);
&lt;/span&gt;&lt;span&gt;69&lt;/span&gt;         } &lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;70&lt;/span&gt;             pingInProgress.set(&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;71&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;72&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;73&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;IPingStrategy çš„é»˜è®¤å®ç°ç±»æ˜¯ SerialPingStrategyï¼Œè¿›å…¥å¯ä»¥å‘ç°å®ƒåªæ˜¯éå†æ‰€æœ‰ Serverï¼Œç„¶åç”¨ IPing åˆ¤æ–­ Server æ˜¯å¦å­˜æ´»ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; SerialPingStrategy &lt;span&gt;implements&lt;/span&gt;&lt;span&gt; IPingStrategy {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;    @Override
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt;[] pingServers(IPing ping, Server[] servers) {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         &lt;span&gt;int&lt;/span&gt; numCandidates =&lt;span&gt; servers.length;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         &lt;span&gt;boolean&lt;/span&gt;[] results = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt;[numCandidates];
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = 0; i &amp;lt; numCandidates; i++&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             results[i] = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (ping != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä½¿ç”¨ IPing åˆ¤æ–­ Server æ˜¯å¦å­˜æ´»&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;                     results[i] =&lt;span&gt; ping.isAlive(servers[i]);
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;             } &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 logger.error(&quot;Exception while pinging Server: '{}'&quot;&lt;span&gt;, servers[i], e);
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; results;
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨é›†æˆ eureka-client åï¼ŒIPingé»˜è®¤å®ç°ç±»æ˜¯ NIWSDiscoveryPingï¼Œçœ‹å®ƒçš„ isAlive æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å¯¹åº” Server çš„å®ä¾‹ InstanceInfo çš„çŠ¶æ€æ˜¯å¦æ˜¯ UP çŠ¶æ€ï¼ŒUPçŠ¶æ€å°±è¡¨ç¤º Server å­˜æ´»ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isAlive(Server server) {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     &lt;span&gt;boolean&lt;/span&gt; isAlive = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (server!=&lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; server &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; DiscoveryEnabledServer){
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;         DiscoveryEnabledServer dServer =&lt;span&gt; (DiscoveryEnabledServer)server;                
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;         InstanceInfo instanceInfo =&lt;span&gt; dServer.getInstanceInfo();
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (instanceInfo!=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;){                    
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             InstanceStatus status =&lt;span&gt; instanceInfo.getStatus();
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (status!=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;){
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ¤æ–­Serverå¯¹åº”çš„å®ä¾‹çŠ¶æ€æ˜¯å¦æ˜¯ UP&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;                 isAlive =&lt;span&gt; status.equals(InstanceStatus.UP);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; isAlive;
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;7ã€ä¸€å¼ å›¾æ€»ç»“ Ribbon æ ¸å¿ƒåŸç†&lt;/h3&gt;
&lt;p&gt;â‘  Ribbon æ ¸å¿ƒå·¥ä½œåŸç†æ€»ç»“&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;é¦–å…ˆï¼ŒRibbon çš„7ä¸ªæ ¸å¿ƒæ¥å£å…±åŒå®šä¹‰äº† Ribbon çš„è¡Œä¸ºç‰¹æ€§ï¼Œå®ƒä»¬å°±æ˜¯ Ribbon çš„æ ¸å¿ƒéª¨æ¶ã€‚&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216140622046-1368656207.png&quot; alt=&quot;&quot;/&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Ribbon æ¥å¯¹å®¢æˆ·ç«¯åšè´Ÿè½½å‡è¡¡ï¼ŒåŸºæœ¬çš„ç”¨æ³•å°±æ˜¯ç”¨ @LoadBalanced æ³¨è§£æ ‡æ³¨ä¸€ä¸ª RestTemplate çš„ bean å¯¹è±¡ï¼Œä¹‹ååœ¨ LoadBalancerAutoConfiguration é…ç½®ç±»ä¸­ä¼šå¯¹å¸¦æœ‰ @LoadBalanced æ³¨è§£çš„ RestTemplate æ·»åŠ  LoadBalancerInterceptor æ‹¦æˆªå™¨ã€‚&lt;/li&gt;
&lt;li&gt;LoadBalancerInterceptor ä¼šæ‹¦æˆª RestTemplate çš„ HTTP è¯·æ±‚ï¼Œå°†è¯·æ±‚ç»‘å®šè¿› Ribbon è´Ÿè½½å‡è¡¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç„¶åä½¿ç”¨ LoadBalancerClient çš„ execute æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;LoadBalancerClient é¦–å…ˆä¼šå¾—åˆ°ä¸€ä¸ª ILoadBalancerï¼Œå†ä½¿ç”¨å®ƒå»å¾—åˆ°ä¸€ä¸ª Serverï¼Œè¿™ä¸ª Server å°±æ˜¯å…·ä½“æŸä¸€ä¸ªå®ä¾‹çš„ä¿¡æ¯å°è£…ã€‚å¾—åˆ° Server ä¹‹åï¼Œå°±ç”¨ Server çš„ IP å’Œç«¯å£é‡æ„åŸå§‹ URIã€‚&lt;/li&gt;
&lt;li&gt;ILoadBalancer æœ€ç»ˆåœ¨é€‰æ‹©å®ä¾‹çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ IRule å‡è¡¡ç­–ç•¥æ¥é€‰æ‹©ä¸€ä¸ª Serverã€‚&lt;/li&gt;
&lt;li&gt;ILoadBalancer çš„çˆ¶ç±» BaseLoadBalancer ä¸­æœ‰ä¸€ä¸ª allServerList åˆ—è¡¨ç¼“å­˜äº†æ‰€æœ‰ Serverï¼ŒRibbon ä¸­ Server çš„æ¥æºå°±æ˜¯ allServerListã€‚&lt;/li&gt;
&lt;li&gt;åœ¨åŠ è½½Ribbonå®¢æˆ·ç«¯ä¸Šä¸‹æ–‡æ—¶ï¼ŒILoadBalancer ä¼šç”¨ ServerList ä» DiscoveryClient çš„ Applications ä¸­è·å–å®¢æˆ·ç«¯å¯¹åº”çš„å®ä¾‹åˆ—è¡¨ï¼Œç„¶åä½¿ç”¨ ServerListFilter è¿‡æ»¤ï¼Œæœ€åæ›´æ–°åˆ° allServerList ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ILoadBalancer è¿˜ä¼šå¼€å¯ä¸€ä¸ªåå°ä»»åŠ¡ ServerListUpdater ï¼Œæ¯éš”30ç§’è¿è¡Œä¸€æ¬¡ï¼Œç”¨Â ServerList å°† DiscoveryClient çš„ Applications ä¸­çš„å®ä¾‹åˆ—è¡¨åŒæ­¥åˆ° allServerList ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ILoadBalancer è¿˜ä¼šå¼€å¯ä¸€ä¸ªåå°ä»»åŠ¡ PingTaskï¼Œæ¯éš”30ç§’è¿è¡Œä¸€æ¬¡ï¼Œç”¨ IPing åˆ¤æ–­ Server çš„å­˜æ´»çŠ¶æ€ï¼ŒEurekaClient ç¯å¢ƒä¸‹ï¼Œå°±æ˜¯åˆ¤æ–­ InstanceInfo çš„çŠ¶æ€æ˜¯å¦ä¸º UPã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;â‘¡ ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥æ€»ç»“ä¸‹ Ribbon è¿™å—è·å–Serverçš„æ ¸å¿ƒæµç¨‹ä»¥åŠå¯¹åº”çš„æ ¸å¿ƒæ¥å£é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216131525181-1966349629.png&quot; width=&quot;1500&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;äº”ã€Ribbon æ ¸å¿ƒæ¥å£&lt;/h2&gt;
&lt;p&gt;å‰é¢å·²ç»äº†è§£åˆ° Ribbon æ ¸å¿ƒæ¥å£ä»¥åŠé»˜è®¤å®ç°å¦‚ä½•åä½œæ¥æŸ¥æ‰¾è¦è°ƒç”¨çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¿™èŠ‚å†æ¥çœ‹ä¸‹å„ä¸ªæ ¸å¿ƒæ¥å£çš„ä¸€äº›ç‰¹æ€§åŠå…¶å®ƒå®ç°ç±»ã€‚&lt;/p&gt;
&lt;h3&gt;1ã€å®¢æˆ·ç«¯é…ç½® â€” IClientConfig&lt;/h3&gt;
&lt;p&gt;IClientConfig å°±æ˜¯ç®¡ç†å®¢æˆ·ç«¯é…ç½®çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒçš„é»˜è®¤å®ç°ç±»æ˜¯Â DefaultClientConfigImplã€‚å¯ä»¥çœ‹åˆ°åœ¨åˆ›å»ºÂ IClientConfig æ—¶ï¼Œè®¾ç½®äº† Ribbon å®¢æˆ·ç«¯é»˜è®¤çš„è¿æ¥å’Œè¯»å–è¶…æ—¶æ—¶é—´ä¸º 1 ç§’ï¼Œä¾‹å¦‚è¯»å–å¦‚æœè¶…è¿‡1ç§’ï¼Œå°±ä¼šè¿”å›è¶…æ—¶ï¼Œè¿™ä¸¤ä¸ªä¸€èˆ¬éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥è°ƒæ•´ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;@Bean
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;@ConditionalOnMissingBean
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;public&lt;/span&gt;&lt;span&gt; IClientConfig ribbonClientConfig() {
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     DefaultClientConfigImpl config = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DefaultClientConfigImpl();
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åŠ è½½é…ç½®&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;     config.loadProperties(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name);
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¿æ¥è¶…æ—¶é»˜è®¤ 1 ç§’&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    config.set(CommonClientConfigKey.ConnectTimeout, DEFAULT_CONNECT_TIMEOUT);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¯»å–è¶…æ—¶é»˜è®¤ 1 ç§’&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    config.set(CommonClientConfigKey.ReadTimeout, DEFAULT_READ_TIMEOUT);
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    config.set(CommonClientConfigKey.GZipPayload, DEFAULT_GZIP_PAYLOAD);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; config;
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;CommonClientConfigKey è¿™ä¸ªç±»å®šä¹‰äº† Ribbon å®¢æˆ·ç«¯ç›¸å…³çš„æ‰€æœ‰é…ç½®çš„é”®å¸¸é‡ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªç±»æ¥çœ‹æœ‰å“ªäº›é…ç½®ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_b3458058-9eb5-4669-a230-06257fe7c8cb&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_b3458058-9eb5-4669-a230-06257fe7c8cb&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_b3458058-9eb5-4669-a230-06257fe7c8cb&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;61&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; CommonClientConfigKey&amp;lt;T&amp;gt; &lt;span&gt;implements&lt;/span&gt; IClientConfigKey&amp;lt;T&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;  2&lt;/span&gt; 
&lt;span&gt;  3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; AppName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;AppName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;  4&lt;/span&gt;     
&lt;span&gt;  5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; Version = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;Version&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;  6&lt;/span&gt;         
&lt;span&gt;  7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; Port = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;Port&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;  8&lt;/span&gt;     
&lt;span&gt;  9&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; SecurePort = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;SecurePort&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 10&lt;/span&gt;     
&lt;span&gt; 11&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; VipAddress = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;VipAddress&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt;     
&lt;span&gt; 13&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; ForceClientPortConfiguration = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;ForceClientPortConfiguration&quot;){}; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; use client defined port regardless of server advert&lt;/span&gt;
&lt;span&gt; 14&lt;/span&gt; 
&lt;span&gt; 15&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; DeploymentContextBasedVipAddresses = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;DeploymentContextBasedVipAddresses&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 16&lt;/span&gt;     
&lt;span&gt; 17&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxAutoRetries = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxAutoRetries&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 18&lt;/span&gt;     
&lt;span&gt; 19&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxAutoRetriesNextServer = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxAutoRetriesNextServer&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 20&lt;/span&gt;     
&lt;span&gt; 21&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; OkToRetryOnAllOperations = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;OkToRetryOnAllOperations&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 22&lt;/span&gt;     
&lt;span&gt; 23&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; RequestSpecificRetryOn = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;RequestSpecificRetryOn&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt;     
&lt;span&gt; 25&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ReceiveBufferSize = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ReceiveBufferSize&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt;     
&lt;span&gt; 27&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnablePrimeConnections = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnablePrimeConnections&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt;     
&lt;span&gt; 29&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; PrimeConnectionsClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;PrimeConnectionsClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 30&lt;/span&gt;     
&lt;span&gt; 31&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxRetriesPerServerPrimeConnection = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxRetriesPerServerPrimeConnection&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt;     
&lt;span&gt; 33&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxTotalTimeToPrimeConnections = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxTotalTimeToPrimeConnections&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 34&lt;/span&gt;     
&lt;span&gt; 35&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Float&amp;gt; MinPrimeConnectionsRatio = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Float&amp;gt;(&quot;MinPrimeConnectionsRatio&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt;     
&lt;span&gt; 37&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; PrimeConnectionsURI = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;PrimeConnectionsURI&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 38&lt;/span&gt;     
&lt;span&gt; 39&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; PoolMaxThreads = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;PoolMaxThreads&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 40&lt;/span&gt;     
&lt;span&gt; 41&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; PoolMinThreads = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;PoolMinThreads&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 42&lt;/span&gt;     
&lt;span&gt; 43&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; PoolKeepAliveTime = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;PoolKeepAliveTime&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 44&lt;/span&gt;     
&lt;span&gt; 45&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; PoolKeepAliveTimeUnits = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;PoolKeepAliveTimeUnits&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 46&lt;/span&gt; 
&lt;span&gt; 47&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnableConnectionPool = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnableConnectionPool&quot;&lt;span&gt;) {};
&lt;/span&gt;&lt;span&gt; 48&lt;/span&gt;     
&lt;span&gt; 49&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 50&lt;/span&gt; &lt;span&gt;     * Use {&lt;/span&gt;&lt;span&gt;@link&lt;/span&gt;&lt;span&gt; #MaxConnectionsPerHost}
&lt;/span&gt;&lt;span&gt; 51&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 52&lt;/span&gt; &lt;span&gt;    @Deprecated    
&lt;/span&gt;&lt;span&gt; 53&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxHttpConnectionsPerHost = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxHttpConnectionsPerHost&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 54&lt;/span&gt;     
&lt;span&gt; 55&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 56&lt;/span&gt; &lt;span&gt;     * Use {&lt;/span&gt;&lt;span&gt;@link&lt;/span&gt;&lt;span&gt; #MaxTotalConnections}
&lt;/span&gt;&lt;span&gt; 57&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 58&lt;/span&gt; &lt;span&gt;    @Deprecated
&lt;/span&gt;&lt;span&gt; 59&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxTotalHttpConnections = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxTotalHttpConnections&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 60&lt;/span&gt;     
&lt;span&gt; 61&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxConnectionsPerHost = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxConnectionsPerHost&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 62&lt;/span&gt;     
&lt;span&gt; 63&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; MaxTotalConnections = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;MaxTotalConnections&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 64&lt;/span&gt;     
&lt;span&gt; 65&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; IsSecure = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;IsSecure&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 66&lt;/span&gt;     
&lt;span&gt; 67&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; GZipPayload = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;GZipPayload&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 68&lt;/span&gt;     
&lt;span&gt; 69&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ConnectTimeout = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ConnectTimeout&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 70&lt;/span&gt;     
&lt;span&gt; 71&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; BackoffInterval = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;BackoffTimeout&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 72&lt;/span&gt;     
&lt;span&gt; 73&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ReadTimeout = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ReadTimeout&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 74&lt;/span&gt;     
&lt;span&gt; 75&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; SendBufferSize = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;SendBufferSize&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 76&lt;/span&gt;     
&lt;span&gt; 77&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; StaleCheckingEnabled = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;StaleCheckingEnabled&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt;     
&lt;span&gt; 79&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; Linger = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;Linger&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 80&lt;/span&gt;     
&lt;span&gt; 81&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ConnectionManagerTimeout = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ConnectionManagerTimeout&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 82&lt;/span&gt;     
&lt;span&gt; 83&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; FollowRedirects = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;FollowRedirects&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt;     
&lt;span&gt; 85&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; ConnectionPoolCleanerTaskEnabled = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;ConnectionPoolCleanerTaskEnabled&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 86&lt;/span&gt;     
&lt;span&gt; 87&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ConnIdleEvictTimeMilliSeconds = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ConnIdleEvictTimeMilliSeconds&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt;     
&lt;span&gt; 89&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ConnectionCleanerRepeatInterval = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ConnectionCleanerRepeatInterval&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 90&lt;/span&gt;     
&lt;span&gt; 91&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnableGZIPContentEncodingFilter = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnableGZIPContentEncodingFilter&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 92&lt;/span&gt;     
&lt;span&gt; 93&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; ProxyHost = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;ProxyHost&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt;     
&lt;span&gt; 95&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ProxyPort = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ProxyPort&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 96&lt;/span&gt;     
&lt;span&gt; 97&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; KeyStore = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;KeyStore&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt; 98&lt;/span&gt;     
&lt;span&gt; 99&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; KeyStorePassword = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;KeyStorePassword&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;100&lt;/span&gt;     
&lt;span&gt;101&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; TrustStore = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;TrustStore&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt;     
&lt;span&gt;103&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; TrustStorePassword = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;TrustStorePassword&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;104&lt;/span&gt;     
&lt;span&gt;105&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; if this is a secure rest client, must we use client auth too?    &lt;/span&gt;
&lt;span&gt;106&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; IsClientAuthRequired = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;IsClientAuthRequired&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;107&lt;/span&gt;     
&lt;span&gt;108&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; CustomSSLSocketFactoryClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;CustomSSLSocketFactoryClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;109&lt;/span&gt;      &lt;span&gt;//&lt;/span&gt;&lt;span&gt; must host name match name in certificate?&lt;/span&gt;
&lt;span&gt;110&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; IsHostnameValidationRequired = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;IsHostnameValidationRequired&quot;&lt;span&gt;){}; 
&lt;/span&gt;&lt;span&gt;111&lt;/span&gt; 
&lt;span&gt;112&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; see also &lt;/span&gt;&lt;span&gt;http://hc.apache.org/httpcomponents-client-ga/tutorial/html/advanced.html&lt;/span&gt;
&lt;span&gt;113&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; IgnoreUserTokenInConnectionPoolForSecureClient = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;IgnoreUserTokenInConnectionPoolForSecureClient&quot;&lt;span&gt;){}; 
&lt;/span&gt;&lt;span&gt;114&lt;/span&gt;     
&lt;span&gt;115&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Client implementation&lt;/span&gt;
&lt;span&gt;116&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; ClientClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;ClientClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;117&lt;/span&gt; 
&lt;span&gt;118&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt;LoadBalancer Related&lt;/span&gt;
&lt;span&gt;119&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; InitializeNFLoadBalancer = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;InitializeNFLoadBalancer&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;120&lt;/span&gt;     
&lt;span&gt;121&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NFLoadBalancerClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NFLoadBalancerClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;122&lt;/span&gt;     
&lt;span&gt;123&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NFLoadBalancerRuleClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NFLoadBalancerRuleClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;124&lt;/span&gt;     
&lt;span&gt;125&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NFLoadBalancerPingClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NFLoadBalancerPingClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;126&lt;/span&gt;     
&lt;span&gt;127&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; NFLoadBalancerPingInterval = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;NFLoadBalancerPingInterval&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;128&lt;/span&gt;     
&lt;span&gt;129&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; NFLoadBalancerMaxTotalPingTime = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;NFLoadBalancerMaxTotalPingTime&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;130&lt;/span&gt; 
&lt;span&gt;131&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NFLoadBalancerStatsClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NFLoadBalancerStatsClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;132&lt;/span&gt;     
&lt;span&gt;133&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NIWSServerListClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NIWSServerListClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;134&lt;/span&gt; 
&lt;span&gt;135&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; ServerListUpdaterClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;ServerListUpdaterClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;136&lt;/span&gt;     
&lt;span&gt;137&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; NIWSServerListFilterClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;NIWSServerListFilterClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;138&lt;/span&gt;     
&lt;span&gt;139&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ServerListRefreshInterval = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ServerListRefreshInterval&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;140&lt;/span&gt;     
&lt;span&gt;141&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnableMarkingServerDownOnReachingFailureLimit = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnableMarkingServerDownOnReachingFailureLimit&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;142&lt;/span&gt;     
&lt;span&gt;143&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ServerDownFailureLimit = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ServerDownFailureLimit&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;144&lt;/span&gt;     
&lt;span&gt;145&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Integer&amp;gt; ServerDownStatWindowInMillis = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Integer&amp;gt;(&quot;ServerDownStatWindowInMillis&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;146&lt;/span&gt;     
&lt;span&gt;147&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnableZoneAffinity = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnableZoneAffinity&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;148&lt;/span&gt;     
&lt;span&gt;149&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; EnableZoneExclusivity = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;EnableZoneExclusivity&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;150&lt;/span&gt;     
&lt;span&gt;151&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; PrioritizeVipAddressBasedServers = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;PrioritizeVipAddressBasedServers&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;152&lt;/span&gt;     
&lt;span&gt;153&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; VipAddressResolverClassName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;VipAddressResolverClassName&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;154&lt;/span&gt;     
&lt;span&gt;155&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; TargetRegion = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;TargetRegion&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;156&lt;/span&gt;     
&lt;span&gt;157&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; RulePredicateClasses = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;RulePredicateClasses&quot;&lt;span&gt;){};
&lt;/span&gt;&lt;span&gt;158&lt;/span&gt;     
&lt;span&gt;159&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; RequestIdHeaderName = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;RequestIdHeaderName&quot;&lt;span&gt;) {};
&lt;/span&gt;&lt;span&gt;160&lt;/span&gt;     
&lt;span&gt;161&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;Boolean&amp;gt; UseIPAddrForServer = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;Boolean&amp;gt;(&quot;UseIPAddrForServer&quot;&lt;span&gt;) {};
&lt;/span&gt;&lt;span&gt;162&lt;/span&gt;     
&lt;span&gt;163&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; IClientConfigKey&amp;lt;String&amp;gt; ListOfServers = &lt;span&gt;new&lt;/span&gt; CommonClientConfigKey&amp;lt;String&amp;gt;(&quot;listOfServers&quot;&lt;span&gt;) {};
&lt;/span&gt;&lt;span&gt;164&lt;/span&gt; 
&lt;span&gt;165&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Set&amp;lt;IClientConfigKey&amp;gt; keys = &lt;span&gt;new&lt;/span&gt; HashSet&amp;lt;IClientConfigKey&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;166&lt;/span&gt;         
&lt;span&gt;167&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ...&lt;/span&gt;
&lt;span&gt;168&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;è¿›å…¥åˆ°Â DefaultClientConfigImplï¼Œå¯ä»¥çœ‹åˆ°Â CommonClientConfigKey ä¸­çš„æ¯ä¸ªé…ç½®éƒ½å¯¹åº”äº†ä¸€ä¸ªé»˜è®¤å€¼ã€‚åœ¨åŠ è½½é…ç½®çš„æ—¶å€™ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰å®šåˆ¶é…ç½®ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤çš„é…ç½®ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;57&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_8fdc619a-c340-43da-8dec-6c8af1229c7a&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_8fdc619a-c340-43da-8dec-6c8af1229c7a&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_8fdc619a-c340-43da-8dec-6c8af1229c7a&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;109&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; DefaultClientConfigImpl &lt;span&gt;implements&lt;/span&gt;&lt;span&gt; IClientConfig {
&lt;/span&gt;&lt;span&gt;  2&lt;/span&gt; 
&lt;span&gt;  3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_PRIORITIZE_VIP_ADDRESS_BASED_SERVERS =&lt;span&gt; Boolean.TRUE;
&lt;/span&gt;&lt;span&gt;  4&lt;/span&gt; 
&lt;span&gt;  5&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_NFLOADBALANCER_PING_CLASSNAME = &quot;com.netflix.loadbalancer.DummyPing&quot;; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; DummyPing.class.getName();&lt;/span&gt;
&lt;span&gt;  6&lt;/span&gt; 
&lt;span&gt;  7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_NFLOADBALANCER_RULE_CLASSNAME = &quot;com.netflix.loadbalancer.AvailabilityFilteringRule&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  8&lt;/span&gt; 
&lt;span&gt;  9&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_NFLOADBALANCER_CLASSNAME = &quot;com.netflix.loadbalancer.ZoneAwareLoadBalancer&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 10&lt;/span&gt;     
&lt;span&gt; 11&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; DEFAULT_USEIPADDRESS_FOR_SERVER =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt; 
&lt;span&gt; 13&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_CLIENT_CLASSNAME = &quot;com.netflix.niws.client.http.RestClient&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 14&lt;/span&gt; 
&lt;span&gt; 15&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_VIPADDRESS_RESOLVER_CLASSNAME = &quot;com.netflix.client.SimpleVipAddressResolver&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 16&lt;/span&gt; 
&lt;span&gt; 17&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_PRIME_CONNECTIONS_URI = &quot;/&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 18&lt;/span&gt; 
&lt;span&gt; 19&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_TOTAL_TIME_TO_PRIME_CONNECTIONS = 30000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 20&lt;/span&gt; 
&lt;span&gt; 21&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_RETRIES_PER_SERVER_PRIME_CONNECTION = 9&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 22&lt;/span&gt; 
&lt;span&gt; 23&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_PRIME_CONNECTIONS =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt; 
&lt;span&gt; 25&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_REQUESTS_ALLOWED_PER_WINDOW =&lt;span&gt; Integer.MAX_VALUE;
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt; 
&lt;span&gt; 27&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_REQUEST_THROTTLING_WINDOW_IN_MILLIS = 60000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt; 
&lt;span&gt; 29&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_REQUEST_THROTTLING =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 30&lt;/span&gt; 
&lt;span&gt; 31&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_GZIP_CONTENT_ENCODING_FILTER =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt; 
&lt;span&gt; 33&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_CONNECTION_POOL_CLEANER_TASK_ENABLED =&lt;span&gt; Boolean.TRUE;
&lt;/span&gt;&lt;span&gt; 34&lt;/span&gt; 
&lt;span&gt; 35&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_FOLLOW_REDIRECTS =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt; 
&lt;span&gt; 37&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;float&lt;/span&gt; DEFAULT_PERCENTAGE_NIWS_EVENT_LOGGED = 0.0f&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 38&lt;/span&gt; 
&lt;span&gt; 39&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_AUTO_RETRIES_NEXT_SERVER = 1&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 40&lt;/span&gt; 
&lt;span&gt; 41&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_AUTO_RETRIES = 0&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 42&lt;/span&gt; 
&lt;span&gt; 43&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_BACKOFF_INTERVAL = 0&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 44&lt;/span&gt;     
&lt;span&gt; 45&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_READ_TIMEOUT = 5000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 46&lt;/span&gt; 
&lt;span&gt; 47&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_CONNECTION_MANAGER_TIMEOUT = 2000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 48&lt;/span&gt; 
&lt;span&gt; 49&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_CONNECT_TIMEOUT = 2000&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 50&lt;/span&gt; 
&lt;span&gt; 51&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_CONNECTION_POOL =&lt;span&gt; Boolean.TRUE;
&lt;/span&gt;&lt;span&gt; 52&lt;/span&gt;     
&lt;span&gt; 53&lt;/span&gt; &lt;span&gt;    @Deprecated
&lt;/span&gt;&lt;span&gt; 54&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_HTTP_CONNECTIONS_PER_HOST = 50&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 55&lt;/span&gt; 
&lt;span&gt; 56&lt;/span&gt; &lt;span&gt;    @Deprecated
&lt;/span&gt;&lt;span&gt; 57&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_TOTAL_HTTP_CONNECTIONS = 200&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 58&lt;/span&gt; 
&lt;span&gt; 59&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_CONNECTIONS_PER_HOST = 50&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 60&lt;/span&gt; 
&lt;span&gt; 61&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_MAX_TOTAL_CONNECTIONS = 200&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 62&lt;/span&gt; 
&lt;span&gt; 63&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;float&lt;/span&gt; DEFAULT_MIN_PRIME_CONNECTIONS_RATIO = 1.0f&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 64&lt;/span&gt; 
&lt;span&gt; 65&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_PRIME_CONNECTIONS_CLASS = &quot;com.netflix.niws.client.http.HttpPrimeConnection&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 66&lt;/span&gt; 
&lt;span&gt; 67&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_SEVER_LIST_CLASS = &quot;com.netflix.loadbalancer.ConfigurationBasedServerList&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 68&lt;/span&gt; 
&lt;span&gt; 69&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_SERVER_LIST_UPDATER_CLASS = &quot;com.netflix.loadbalancer.PollingServerListUpdater&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 70&lt;/span&gt; 
&lt;span&gt; 71&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_CONNECTION_IDLE_TIMERTASK_REPEAT_IN_MSECS = 30000; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; every half minute (30 secs)&lt;/span&gt;
&lt;span&gt; 72&lt;/span&gt; 
&lt;span&gt; 73&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_CONNECTIONIDLE_TIME_IN_MSECS = 30000; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; all connections idle for 30 secs&lt;/span&gt;
&lt;span&gt; 74&lt;/span&gt;     
&lt;span&gt; 75&lt;/span&gt;     &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;volatile&lt;/span&gt; Map&amp;lt;String, Object&amp;gt; properties = &lt;span&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;String, Object&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 76&lt;/span&gt;     
&lt;span&gt; 77&lt;/span&gt;     &lt;span&gt;protected&lt;/span&gt; Map&amp;lt;IClientConfigKey&amp;lt;?&amp;gt;, Object&amp;gt; typedProperties = &lt;span&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;IClientConfigKey&amp;lt;?&amp;gt;, Object&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt; 
&lt;span&gt; 79&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Logger LOG = LoggerFactory.getLogger(DefaultClientConfigImpl.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 80&lt;/span&gt; 
&lt;span&gt; 81&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; String clientName = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 82&lt;/span&gt; 
&lt;span&gt; 83&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; VipAddressResolver resolver = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt; 
&lt;span&gt; 85&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; enableDynamicProperties = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 86&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 87&lt;/span&gt; &lt;span&gt;     * Defaults for the parameters for the thread pool used by batchParallel
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt; &lt;span&gt;     * calls
&lt;/span&gt;&lt;span&gt; 89&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 90&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_POOL_MAX_THREADS =&lt;span&gt; DEFAULT_MAX_TOTAL_HTTP_CONNECTIONS;
&lt;/span&gt;&lt;span&gt; 91&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_POOL_MIN_THREADS = 1&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 92&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; DEFAULT_POOL_KEEP_ALIVE_TIME = 15 * 60L&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 93&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; TimeUnit DEFAULT_POOL_KEEP_ALIVE_TIME_UNITS =&lt;span&gt; TimeUnit.SECONDS;
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_ZONE_AFFINITY =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 95&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_ZONE_EXCLUSIVITY =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt; 96&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; DEFAULT_PORT = 7001&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 97&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_LOADBALANCER =&lt;span&gt; Boolean.TRUE;
&lt;/span&gt;&lt;span&gt; 98&lt;/span&gt; 
&lt;span&gt; 99&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; String DEFAULT_PROPERTY_NAME_SPACE = &quot;ribbon&quot;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;100&lt;/span&gt; 
&lt;span&gt;101&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; String propertyNameSpace =&lt;span&gt; DEFAULT_PROPERTY_NAME_SPACE;
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt; 
&lt;span&gt;103&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_OK_TO_RETRY_ON_ALL_OPERATIONS =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt;104&lt;/span&gt; 
&lt;span&gt;105&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_ENABLE_NIWS_EVENT_LOGGING =&lt;span&gt; Boolean.TRUE;
&lt;/span&gt;&lt;span&gt;106&lt;/span&gt; 
&lt;span&gt;107&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Boolean DEFAULT_IS_CLIENT_AUTH_REQUIRED =&lt;span&gt; Boolean.FALSE;
&lt;/span&gt;&lt;span&gt;108&lt;/span&gt; 
&lt;span&gt;109&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; Map&amp;lt;String, DynamicStringProperty&amp;gt; dynamicProperties = &lt;span&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;String, DynamicStringProperty&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;110&lt;/span&gt; 
&lt;span&gt;111&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultPrioritizeVipAddressBasedServers() {
&lt;/span&gt;&lt;span&gt;112&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_PRIORITIZE_VIP_ADDRESS_BASED_SERVERS;
&lt;/span&gt;&lt;span&gt;113&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;114&lt;/span&gt; 
&lt;span&gt;115&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultNfloadbalancerPingClassname() {
&lt;/span&gt;&lt;span&gt;116&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_NFLOADBALANCER_PING_CLASSNAME;
&lt;/span&gt;&lt;span&gt;117&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;118&lt;/span&gt; 
&lt;span&gt;119&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultNfloadbalancerRuleClassname() {
&lt;/span&gt;&lt;span&gt;120&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_NFLOADBALANCER_RULE_CLASSNAME;
&lt;/span&gt;&lt;span&gt;121&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;122&lt;/span&gt; 
&lt;span&gt;123&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultNfloadbalancerClassname() {
&lt;/span&gt;&lt;span&gt;124&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_NFLOADBALANCER_CLASSNAME;
&lt;/span&gt;&lt;span&gt;125&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;126&lt;/span&gt;     
&lt;span&gt;127&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; getDefaultUseIpAddressForServer() {
&lt;/span&gt;&lt;span&gt;128&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_USEIPADDRESS_FOR_SERVER;
&lt;/span&gt;&lt;span&gt;129&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;130&lt;/span&gt; 
&lt;span&gt;131&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultClientClassname() {
&lt;/span&gt;&lt;span&gt;132&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CLIENT_CLASSNAME;
&lt;/span&gt;&lt;span&gt;133&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;134&lt;/span&gt; 
&lt;span&gt;135&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultVipaddressResolverClassname() {
&lt;/span&gt;&lt;span&gt;136&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_VIPADDRESS_RESOLVER_CLASSNAME;
&lt;/span&gt;&lt;span&gt;137&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;138&lt;/span&gt; 
&lt;span&gt;139&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultPrimeConnectionsUri() {
&lt;/span&gt;&lt;span&gt;140&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_PRIME_CONNECTIONS_URI;
&lt;/span&gt;&lt;span&gt;141&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;142&lt;/span&gt; 
&lt;span&gt;143&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxTotalTimeToPrimeConnections() {
&lt;/span&gt;&lt;span&gt;144&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_TOTAL_TIME_TO_PRIME_CONNECTIONS;
&lt;/span&gt;&lt;span&gt;145&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;146&lt;/span&gt; 
&lt;span&gt;147&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxRetriesPerServerPrimeConnection() {
&lt;/span&gt;&lt;span&gt;148&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_RETRIES_PER_SERVER_PRIME_CONNECTION;
&lt;/span&gt;&lt;span&gt;149&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;150&lt;/span&gt; 
&lt;span&gt;151&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnablePrimeConnections() {
&lt;/span&gt;&lt;span&gt;152&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_PRIME_CONNECTIONS;
&lt;/span&gt;&lt;span&gt;153&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;154&lt;/span&gt; 
&lt;span&gt;155&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxRequestsAllowedPerWindow() {
&lt;/span&gt;&lt;span&gt;156&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_REQUESTS_ALLOWED_PER_WINDOW;
&lt;/span&gt;&lt;span&gt;157&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;158&lt;/span&gt; 
&lt;span&gt;159&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultRequestThrottlingWindowInMillis() {
&lt;/span&gt;&lt;span&gt;160&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_REQUEST_THROTTLING_WINDOW_IN_MILLIS;
&lt;/span&gt;&lt;span&gt;161&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;162&lt;/span&gt; 
&lt;span&gt;163&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnableRequestThrottling() {
&lt;/span&gt;&lt;span&gt;164&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_REQUEST_THROTTLING;
&lt;/span&gt;&lt;span&gt;165&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;166&lt;/span&gt; 
&lt;span&gt;167&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnableGzipContentEncodingFilter() {
&lt;/span&gt;&lt;span&gt;168&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_GZIP_CONTENT_ENCODING_FILTER;
&lt;/span&gt;&lt;span&gt;169&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;170&lt;/span&gt; 
&lt;span&gt;171&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultConnectionPoolCleanerTaskEnabled() {
&lt;/span&gt;&lt;span&gt;172&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CONNECTION_POOL_CLEANER_TASK_ENABLED;
&lt;/span&gt;&lt;span&gt;173&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;174&lt;/span&gt; 
&lt;span&gt;175&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultFollowRedirects() {
&lt;/span&gt;&lt;span&gt;176&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_FOLLOW_REDIRECTS;
&lt;/span&gt;&lt;span&gt;177&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;178&lt;/span&gt; 
&lt;span&gt;179&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;float&lt;/span&gt;&lt;span&gt; getDefaultPercentageNiwsEventLogged() {
&lt;/span&gt;&lt;span&gt;180&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_PERCENTAGE_NIWS_EVENT_LOGGED;
&lt;/span&gt;&lt;span&gt;181&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;182&lt;/span&gt; 
&lt;span&gt;183&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxAutoRetriesNextServer() {
&lt;/span&gt;&lt;span&gt;184&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_AUTO_RETRIES_NEXT_SERVER;
&lt;/span&gt;&lt;span&gt;185&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;186&lt;/span&gt; 
&lt;span&gt;187&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxAutoRetries() {
&lt;/span&gt;&lt;span&gt;188&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_AUTO_RETRIES;
&lt;/span&gt;&lt;span&gt;189&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;190&lt;/span&gt; 
&lt;span&gt;191&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultReadTimeout() {
&lt;/span&gt;&lt;span&gt;192&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_READ_TIMEOUT;
&lt;/span&gt;&lt;span&gt;193&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;194&lt;/span&gt; 
&lt;span&gt;195&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultConnectionManagerTimeout() {
&lt;/span&gt;&lt;span&gt;196&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CONNECTION_MANAGER_TIMEOUT;
&lt;/span&gt;&lt;span&gt;197&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;198&lt;/span&gt; 
&lt;span&gt;199&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultConnectTimeout() {
&lt;/span&gt;&lt;span&gt;200&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CONNECT_TIMEOUT;
&lt;/span&gt;&lt;span&gt;201&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;202&lt;/span&gt; 
&lt;span&gt;203&lt;/span&gt; &lt;span&gt;    @Deprecated
&lt;/span&gt;&lt;span&gt;204&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxHttpConnectionsPerHost() {
&lt;/span&gt;&lt;span&gt;205&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_HTTP_CONNECTIONS_PER_HOST;
&lt;/span&gt;&lt;span&gt;206&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;207&lt;/span&gt; 
&lt;span&gt;208&lt;/span&gt; &lt;span&gt;    @Deprecated
&lt;/span&gt;&lt;span&gt;209&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxTotalHttpConnections() {
&lt;/span&gt;&lt;span&gt;210&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_TOTAL_HTTP_CONNECTIONS;
&lt;/span&gt;&lt;span&gt;211&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;212&lt;/span&gt; 
&lt;span&gt;213&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxConnectionsPerHost() {
&lt;/span&gt;&lt;span&gt;214&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_CONNECTIONS_PER_HOST;
&lt;/span&gt;&lt;span&gt;215&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;216&lt;/span&gt; 
&lt;span&gt;217&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultMaxTotalConnections() {
&lt;/span&gt;&lt;span&gt;218&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MAX_TOTAL_CONNECTIONS;
&lt;/span&gt;&lt;span&gt;219&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;220&lt;/span&gt;     
&lt;span&gt;221&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;float&lt;/span&gt;&lt;span&gt; getDefaultMinPrimeConnectionsRatio() {
&lt;/span&gt;&lt;span&gt;222&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_MIN_PRIME_CONNECTIONS_RATIO;
&lt;/span&gt;&lt;span&gt;223&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;224&lt;/span&gt; 
&lt;span&gt;225&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultPrimeConnectionsClass() {
&lt;/span&gt;&lt;span&gt;226&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_PRIME_CONNECTIONS_CLASS;
&lt;/span&gt;&lt;span&gt;227&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;228&lt;/span&gt; 
&lt;span&gt;229&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getDefaultSeverListClass() {
&lt;/span&gt;&lt;span&gt;230&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_SEVER_LIST_CLASS;
&lt;/span&gt;&lt;span&gt;231&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;232&lt;/span&gt; 
&lt;span&gt;233&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultConnectionIdleTimertaskRepeatInMsecs() {
&lt;/span&gt;&lt;span&gt;234&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CONNECTION_IDLE_TIMERTASK_REPEAT_IN_MSECS;
&lt;/span&gt;&lt;span&gt;235&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;236&lt;/span&gt; 
&lt;span&gt;237&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultConnectionidleTimeInMsecs() {
&lt;/span&gt;&lt;span&gt;238&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_CONNECTIONIDLE_TIME_IN_MSECS;
&lt;/span&gt;&lt;span&gt;239&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;240&lt;/span&gt;     
&lt;span&gt;241&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; VipAddressResolver getResolver() {
&lt;/span&gt;&lt;span&gt;242&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; resolver;
&lt;/span&gt;&lt;span&gt;243&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;244&lt;/span&gt; 
&lt;span&gt;245&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isEnableDynamicProperties() {
&lt;/span&gt;&lt;span&gt;246&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; enableDynamicProperties;
&lt;/span&gt;&lt;span&gt;247&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;248&lt;/span&gt; 
&lt;span&gt;249&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultPoolMaxThreads() {
&lt;/span&gt;&lt;span&gt;250&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_POOL_MAX_THREADS;
&lt;/span&gt;&lt;span&gt;251&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;252&lt;/span&gt; 
&lt;span&gt;253&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultPoolMinThreads() {
&lt;/span&gt;&lt;span&gt;254&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_POOL_MIN_THREADS;
&lt;/span&gt;&lt;span&gt;255&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;256&lt;/span&gt; 
&lt;span&gt;257&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;long&lt;/span&gt;&lt;span&gt; getDefaultPoolKeepAliveTime() {
&lt;/span&gt;&lt;span&gt;258&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_POOL_KEEP_ALIVE_TIME;
&lt;/span&gt;&lt;span&gt;259&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;260&lt;/span&gt; 
&lt;span&gt;261&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; TimeUnit getDefaultPoolKeepAliveTimeUnits() {
&lt;/span&gt;&lt;span&gt;262&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_POOL_KEEP_ALIVE_TIME_UNITS;
&lt;/span&gt;&lt;span&gt;263&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;264&lt;/span&gt; 
&lt;span&gt;265&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnableZoneAffinity() {
&lt;/span&gt;&lt;span&gt;266&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_ZONE_AFFINITY;
&lt;/span&gt;&lt;span&gt;267&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;268&lt;/span&gt; 
&lt;span&gt;269&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnableZoneExclusivity() {
&lt;/span&gt;&lt;span&gt;270&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_ZONE_EXCLUSIVITY;
&lt;/span&gt;&lt;span&gt;271&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;272&lt;/span&gt; 
&lt;span&gt;273&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getDefaultPort() {
&lt;/span&gt;&lt;span&gt;274&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_PORT;
&lt;/span&gt;&lt;span&gt;275&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;276&lt;/span&gt; 
&lt;span&gt;277&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultEnableLoadbalancer() {
&lt;/span&gt;&lt;span&gt;278&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_ENABLE_LOADBALANCER;
&lt;/span&gt;&lt;span&gt;279&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;280&lt;/span&gt; 
&lt;span&gt;281&lt;/span&gt; 
&lt;span&gt;282&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultOkToRetryOnAllOperations() {
&lt;/span&gt;&lt;span&gt;283&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_OK_TO_RETRY_ON_ALL_OPERATIONS;
&lt;/span&gt;&lt;span&gt;284&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;285&lt;/span&gt; 
&lt;span&gt;286&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getDefaultIsClientAuthRequired(){
&lt;/span&gt;&lt;span&gt;287&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; DEFAULT_IS_CLIENT_AUTH_REQUIRED;
&lt;/span&gt;&lt;span&gt;288&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;289&lt;/span&gt; 
&lt;span&gt;290&lt;/span&gt; 
&lt;span&gt;291&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt;292&lt;/span&gt; &lt;span&gt;     * Create instance with no properties in default name space {&lt;/span&gt;&lt;span&gt;@link&lt;/span&gt;&lt;span&gt; #DEFAULT_PROPERTY_NAME_SPACE}
&lt;/span&gt;&lt;span&gt;293&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;294&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; DefaultClientConfigImpl() {
&lt;/span&gt;&lt;span&gt;295&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.dynamicProperties.clear();
&lt;/span&gt;&lt;span&gt;296&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.enableDynamicProperties = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;297&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;298&lt;/span&gt; 
&lt;span&gt;299&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt;300&lt;/span&gt; &lt;span&gt;     * Create instance with no properties in the specified name space
&lt;/span&gt;&lt;span&gt;301&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;302&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; DefaultClientConfigImpl(String nameSpace) {
&lt;/span&gt;&lt;span&gt;303&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;304&lt;/span&gt;         &lt;span&gt;this&lt;/span&gt;.propertyNameSpace =&lt;span&gt; nameSpace;
&lt;/span&gt;&lt;span&gt;305&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;306&lt;/span&gt; 
&lt;span&gt;307&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; loadDefaultValues() {
&lt;/span&gt;&lt;span&gt;308&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxHttpConnectionsPerHost, getDefaultMaxHttpConnectionsPerHost());
&lt;/span&gt;&lt;span&gt;309&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxTotalHttpConnections, getDefaultMaxTotalHttpConnections());
&lt;/span&gt;&lt;span&gt;310&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.EnableConnectionPool, getDefaultEnableConnectionPool());
&lt;/span&gt;&lt;span&gt;311&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxConnectionsPerHost, getDefaultMaxConnectionsPerHost());
&lt;/span&gt;&lt;span&gt;312&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxTotalConnections, getDefaultMaxTotalConnections());
&lt;/span&gt;&lt;span&gt;313&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.ConnectTimeout, getDefaultConnectTimeout());
&lt;/span&gt;&lt;span&gt;314&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.ConnectionManagerTimeout, getDefaultConnectionManagerTimeout());
&lt;/span&gt;&lt;span&gt;315&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.ReadTimeout, getDefaultReadTimeout());
&lt;/span&gt;&lt;span&gt;316&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxAutoRetries, getDefaultMaxAutoRetries());
&lt;/span&gt;&lt;span&gt;317&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxAutoRetriesNextServer, getDefaultMaxAutoRetriesNextServer());
&lt;/span&gt;&lt;span&gt;318&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.OkToRetryOnAllOperations, getDefaultOkToRetryOnAllOperations());
&lt;/span&gt;&lt;span&gt;319&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.FollowRedirects, getDefaultFollowRedirects());
&lt;/span&gt;&lt;span&gt;320&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.ConnectionPoolCleanerTaskEnabled, getDefaultConnectionPoolCleanerTaskEnabled());
&lt;/span&gt;&lt;span&gt;321&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.ConnIdleEvictTimeMilliSeconds, getDefaultConnectionidleTimeInMsecs());
&lt;/span&gt;&lt;span&gt;322&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.ConnectionCleanerRepeatInterval, getDefaultConnectionIdleTimertaskRepeatInMsecs());
&lt;/span&gt;&lt;span&gt;323&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.EnableGZIPContentEncodingFilter, getDefaultEnableGzipContentEncodingFilter());
&lt;/span&gt;&lt;span&gt;324&lt;/span&gt;         String proxyHost =&lt;span&gt; ConfigurationManager.getConfigInstance().getString(getDefaultPropName(CommonClientConfigKey.ProxyHost.key()));
&lt;/span&gt;&lt;span&gt;325&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (proxyHost != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; proxyHost.length() &amp;gt; 0&lt;span&gt;) {
&lt;/span&gt;&lt;span&gt;326&lt;/span&gt; &lt;span&gt;            setProperty(CommonClientConfigKey.ProxyHost, proxyHost);
&lt;/span&gt;&lt;span&gt;327&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;328&lt;/span&gt;         Integer proxyPort =&lt;span&gt; ConfigurationManager
&lt;/span&gt;&lt;span&gt;329&lt;/span&gt; &lt;span&gt;                .getConfigInstance()
&lt;/span&gt;&lt;span&gt;330&lt;/span&gt; &lt;span&gt;                .getInteger(
&lt;/span&gt;&lt;span&gt;331&lt;/span&gt; &lt;span&gt;                        getDefaultPropName(CommonClientConfigKey.ProxyPort),
&lt;/span&gt;&lt;span&gt;332&lt;/span&gt;                         (Integer.MIN_VALUE + 1)); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; + 1 just to avoid potential clash with user setting&lt;/span&gt;
&lt;span&gt;333&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (proxyPort != (Integer.MIN_VALUE + 1&lt;span&gt;)) {
&lt;/span&gt;&lt;span&gt;334&lt;/span&gt; &lt;span&gt;            setProperty(CommonClientConfigKey.ProxyPort, proxyPort);
&lt;/span&gt;&lt;span&gt;335&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;336&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.Port, getDefaultPort());
&lt;/span&gt;&lt;span&gt;337&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.EnablePrimeConnections, getDefaultEnablePrimeConnections());
&lt;/span&gt;&lt;span&gt;338&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxRetriesPerServerPrimeConnection, getDefaultMaxRetriesPerServerPrimeConnection());
&lt;/span&gt;&lt;span&gt;339&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.MaxTotalTimeToPrimeConnections, getDefaultMaxTotalTimeToPrimeConnections());
&lt;/span&gt;&lt;span&gt;340&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.PrimeConnectionsURI, getDefaultPrimeConnectionsUri());
&lt;/span&gt;&lt;span&gt;341&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.PoolMinThreads, getDefaultPoolMinThreads());
&lt;/span&gt;&lt;span&gt;342&lt;/span&gt; &lt;span&gt;        putDefaultIntegerProperty(CommonClientConfigKey.PoolMaxThreads, getDefaultPoolMaxThreads());
&lt;/span&gt;&lt;span&gt;343&lt;/span&gt; &lt;span&gt;        putDefaultLongProperty(CommonClientConfigKey.PoolKeepAliveTime, getDefaultPoolKeepAliveTime());
&lt;/span&gt;&lt;span&gt;344&lt;/span&gt; &lt;span&gt;        putDefaultTimeUnitProperty(CommonClientConfigKey.PoolKeepAliveTimeUnits, getDefaultPoolKeepAliveTimeUnits());
&lt;/span&gt;&lt;span&gt;345&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.EnableZoneAffinity, getDefaultEnableZoneAffinity());
&lt;/span&gt;&lt;span&gt;346&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.EnableZoneExclusivity, getDefaultEnableZoneExclusivity());
&lt;/span&gt;&lt;span&gt;347&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.ClientClassName, getDefaultClientClassname());
&lt;/span&gt;&lt;span&gt;348&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.NFLoadBalancerClassName, getDefaultNfloadbalancerClassname());
&lt;/span&gt;&lt;span&gt;349&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.NFLoadBalancerRuleClassName, getDefaultNfloadbalancerRuleClassname());
&lt;/span&gt;&lt;span&gt;350&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.NFLoadBalancerPingClassName, getDefaultNfloadbalancerPingClassname());
&lt;/span&gt;&lt;span&gt;351&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.PrioritizeVipAddressBasedServers, getDefaultPrioritizeVipAddressBasedServers());
&lt;/span&gt;&lt;span&gt;352&lt;/span&gt; &lt;span&gt;        putDefaultFloatProperty(CommonClientConfigKey.MinPrimeConnectionsRatio, getDefaultMinPrimeConnectionsRatio());
&lt;/span&gt;&lt;span&gt;353&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.PrimeConnectionsClassName, getDefaultPrimeConnectionsClass());
&lt;/span&gt;&lt;span&gt;354&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.NIWSServerListClassName, getDefaultSeverListClass());
&lt;/span&gt;&lt;span&gt;355&lt;/span&gt; &lt;span&gt;        putDefaultStringProperty(CommonClientConfigKey.VipAddressResolverClassName, getDefaultVipaddressResolverClassname());
&lt;/span&gt;&lt;span&gt;356&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.IsClientAuthRequired, getDefaultIsClientAuthRequired());
&lt;/span&gt;&lt;span&gt;357&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; putDefaultStringProperty(CommonClientConfigKey.RequestIdHeaderName, getDefaultRequestIdHeaderName());&lt;/span&gt;
&lt;span&gt;358&lt;/span&gt; &lt;span&gt;        putDefaultBooleanProperty(CommonClientConfigKey.UseIPAddrForServer, getDefaultUseIpAddressForServer());
&lt;/span&gt;&lt;span&gt;359&lt;/span&gt;         putDefaultStringProperty(CommonClientConfigKey.ListOfServers, &quot;&quot;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;360&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;361&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å®šåˆ¶é…ç½®ï¼Œä¾‹å¦‚é…ç½®è¶…æ—¶å’Œé‡è¯•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;# å…¨å±€é…ç½®
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;ribbon:
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;  # å®¢æˆ·ç«¯è¯»å–è¶…æ—¶æ—¶é—´
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;   ReadTimeout: 3000
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;  # å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶æ—¶é—´
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;   ConnectTimeout: 3000
&lt;span&gt; 7&lt;/span&gt;   # é»˜è®¤åªé‡è¯• GETï¼Œè®¾ç½®ä¸º &lt;span&gt;true&lt;/span&gt;&lt;span&gt; æ—¶å°†é‡è¯•æ‰€æœ‰ç±»å‹ï¼Œå¦‚ POSTã€PUTã€DELETE
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;   OkToRetryOnAllOperations: &lt;span&gt;false&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;  # é‡è¯•æ¬¡æ•°
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;   MaxAutoRetries: 1
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;  # æœ€å¤šé‡è¯•å‡ ä¸ªå®ä¾‹
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;   MaxAutoRetriesNextServer: 1
&lt;span&gt;13&lt;/span&gt; 
&lt;span&gt;14&lt;/span&gt; # åªé’ˆå¯¹ demo-&lt;span&gt;producer å®¢æˆ·ç«¯
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; demo-&lt;span&gt;producer:
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;  ribbon:
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;    # å®¢æˆ·ç«¯è¯»å–è¶…æ—¶æ—¶é—´
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;     ReadTimeout: 5000
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    # å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶æ—¶é—´
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;     ConnectTimeout: 3000
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2ã€å‡è¡¡ç­–ç•¥ â€” IRule&lt;/h3&gt;
&lt;p&gt;IRule æ˜¯æœ€ç»ˆé€‰æ‹© Server çš„ç­–ç•¥è§„åˆ™ç±»ï¼Œæ ¸å¿ƒçš„æ¥å£å°±æ˜¯ chooseã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; IRule{
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt;     
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é€‰æ‹© Server&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Server choose(Object key);
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è®¾ç½® ILoadBalancer&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setLoadBalancer(ILoadBalancer lb);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è·å– ILoadBalancer&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; ILoadBalancer getLoadBalancer();    
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ribbon æä¾›äº†ä¸°å¯Œçš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æŒ‡å®šä½¿ç”¨æŸä¸ªå‡è¡¡ç­–ç•¥ã€‚ä¸‹é¢æ˜¯æ•´ä¸ªRibbonæä¾›çš„ IRule å‡è¡¡ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216141424713-1149639373.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216141550724-1761844405.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;3ã€æœåŠ¡æ£€æŸ¥ â€” IPing&lt;/h3&gt;
&lt;p&gt;IPing æ˜¯ç”¨äºå®šæœŸæ£€æŸ¥ Server çš„å¯ç”¨æ€§çš„ï¼Œå®ƒåªæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨æ¥åˆ¤æ–­ Server æ˜¯å¦å­˜æ´»ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; IPing {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;     
&lt;span&gt;3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isAlive(Server server);
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;IPing ä¹Ÿæä¾›äº†å¤šç§ç­–ç•¥å¯é€‰ï¼Œä¸‹é¢æ˜¯æ•´ä¸ª IPing ä½“ç³»ç»“æ„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216143650669-1089978409.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216155204028-959715095.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;4ã€è·å–æœåŠ¡åˆ—è¡¨ â€” ServerList&lt;/h3&gt;
&lt;p&gt;ServerList æä¾›äº†ä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ˜¯ç¬¬ä¸€æ¬¡è·å– Server åˆ—è¡¨ï¼Œä¸€ä¸ªæ˜¯æ›´æ–° Server åˆ—è¡¨ï¼Œå…¶ä¸­ getUpdatedListOfServers ä¼šæ¯è¢« Loadbalancer éš” 30 ç§’è°ƒä¸€æ¬¡æ¥æ›´æ–° allServerListã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; ServerList&amp;lt;T &lt;span&gt;extends&lt;/span&gt; Server&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; List&amp;lt;T&amp;gt;&lt;span&gt; getInitialListOfServers();
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;     * Return updated list of servers. This is called say every 30 secs
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;     * (configurable) by the Loadbalancer's Ping cycle
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; List&amp;lt;T&amp;gt;&lt;span&gt; getUpdatedListOfServers();   
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ServerList ä¹Ÿæä¾›äº†å¤šç§å®ç°ï¼ŒServerList ä½“ç³»ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216153448922-1665417546.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216155415765-1116927601.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;5ã€è¿‡æ»¤æœåŠ¡ â€” ServerListFilter&lt;/h3&gt;
&lt;p&gt;ServerListFilter æä¾›äº†ä¸€ä¸ªæ¥å£ç”¨æ¥è¿‡æ»¤å‡ºå¯ç”¨çš„ Serverã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; ServerListFilter&amp;lt;T &lt;span&gt;extends&lt;/span&gt; Server&amp;gt;&lt;span&gt; {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; 
&lt;span&gt;3&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; List&amp;lt;T&amp;gt; getFilteredListOfServers(List&amp;lt;T&amp;gt;&lt;span&gt; servers);
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ServerListFilter ä½“ç³»ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216155723158-899384324.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;6ã€æœåŠ¡åˆ—è¡¨æ›´æ–° â€” ServerListUpdater&lt;/h3&gt;
&lt;p&gt;ServerListUpdater æœ‰å¤šä¸ªæ¥å£ï¼Œæœ€æ ¸å¿ƒçš„å°±æ˜¯ start å¼€å¯å®šæ—¶ä»»åŠ¡è°ƒç”¨ updateAction æ¥æ›´æ–° allServerListã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; ServerListUpdater {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;     * an interface for the updateAction that actually executes a server list update
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; UpdateAction {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;void&lt;/span&gt;&lt;span&gt; doUpdate();
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;/**&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;     * start the serverList updater with the given update action
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;     * This call should be idempotent.
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;      &lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;     &lt;span&gt;void&lt;/span&gt;&lt;span&gt; start(UpdateAction updateAction);
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é»˜è®¤æœ‰ä¸¤ä¸ªå®ç°ç±»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216160325559-919949316.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;7ã€è´Ÿè½½å‡è¡¡å™¨ â€” ILoadBalancer&lt;/h3&gt;
&lt;p&gt;ILoadBalancer æ˜¯è´Ÿè½½å‡è¡¡é€‰æ‹©æœåŠ¡çš„æ ¸å¿ƒæ¥å£ï¼Œä¸»è¦æä¾›äº†å¦‚ä¸‹çš„è·å–Serveråˆ—è¡¨å’Œæ ¹æ®å®¢æˆ·ç«¯åç§°é€‰æ‹©Serverçš„æ¥å£ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; ILoadBalancer {
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ·»åŠ Server&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; addServers(List&amp;lt;Server&amp;gt;&lt;span&gt; newServers);
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ ¹æ®keyé€‰æ‹©ä¸€ä¸ªServer&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt;&lt;span&gt; Server chooseServer(Object key);
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è·å–å­˜æ´»çš„Serveråˆ—è¡¨ï¼Œè¿”å› upServerList&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; List&amp;lt;Server&amp;gt;&lt;span&gt; getReachableServers();
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; 
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è·å–æ‰€æœ‰Serveråˆ—è¡¨ï¼Œè¿”å› allServerList&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; List&amp;lt;Server&amp;gt;&lt;span&gt; getAllServers();
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ILoadBalancer çš„ä½“ç³»ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/856154/202012/856154-20201216160719383-1823772896.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

&lt;/div&gt;</description>
<pubDate>Wed, 16 Dec 2020 16:26:00 +0000</pubDate>
<dc:creator>bojiangzhou</dc:creator>
<og:description>æ·±å…¥ç ”ç©¶ Ribbon è´Ÿè½½å‡è¡¡çš„æ ¸å¿ƒåŸç†ï¼ŒRestTemplate å¦‚ä½•å…·å¤‡è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ï¼Œä»¥åŠ Ribbon æ ¸å¿ƒæ¥å£ç‰¹æ€§ç­‰ã€‚</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/chiangchou/p/ribbon-1.html</dc:identifier>
</item>
<item>
<title>C++å­¦ä¹ æ€»ç»“ - ä¸å¦¨ä¸å¦¨ï¼Œæ¥æ—¥æ–¹é•¿</title>
<link>http://www.cnblogs.com/masbay/p/13942453.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/masbay/p/13942453.html</guid>
<description>&lt;p&gt;&lt;strong&gt;&lt;span&gt;ä¸€äº›éœ€è¦çŸ¥é“çš„åŸºç¡€çŸ¥è¯†ç‚¹ï¼š&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç¨‹åºä»£ç ä¸­æ˜¯é€šè¿‡å˜é‡åå¯¹å†…å­˜å•å…ƒè¿›è¡Œå­˜å–æ“ä½œçš„ï¼Œä½†æ˜¯ä»£ç ç»è¿‡ç¼–è¯‘åå°†å˜é‡åè½¬æ¢ä¸ºè¯¥å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾åœ°å€ï¼Œå¯¹å˜é‡å€¼çš„å­˜å–éƒ½æ˜¯é€šè¿‡åœ°å€è¿›è¡Œçš„ã€‚æ¯”å¦‚i+jçš„è¿ç®—ï¼Œå¦‚æœiç­‰äº3ï¼Œjç­‰äº4ï¼Œç¨‹åºæ˜¯å…ˆæ ¹æ®å˜é‡åä¸åœ°å€çš„å¯¹åº”å…³ç³»ï¼Œæ‰¾åˆ°å˜é‡içš„åœ°å€ï¼Œä»ç¬¬ä¸€ä¸ªåœ°å€å¼€å§‹é¡ºåºè¯»å–å››ä¸ªå­—èŠ‚æ•°æ®æ”¾åˆ°CPUå¯„å­˜å™¨ä¸­ï¼›å†æ‰¾åˆ°jçš„åœ°å€ï¼Œä¾æ¬¡è¯»å–å››ä¸ªæ”¾åˆ°å¯„å­˜å™¨ä¸­ï¼Œç„¶åé€šè¿‡CPUçš„åŠ æ³•ä¸­æ–­è®¡ç®—å‡ºç»“æœã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä½çº§çš„æ±‡ç¼–è¯­è¨€ä¸­éƒ½æ˜¯ç›´æ¥é€šè¿‡åœ°å€æ¥è®¿é—®å†…å­˜å•å…ƒçš„ï¼Œè€Œåœ¨é«˜çº§è¯­è¨€ä¸­æ‰ä½¿ç”¨å˜é‡åè®¿é—®å†…å­˜å•å…ƒï¼ŒCè¯­è¨€ä½œä¸ºé«˜çº§è¯­è¨€å´æä¾›äº†é€šè¿‡åœ°å€æ¥è®¿é—®å†…å­˜å•å…ƒçš„æ–¹æ³•ï¼ŒC++ä¹Ÿç»§æ‰¿äº†è¿™ä¸€ç‰¹æ€§ã€‚åœ°å€å¯ä»¥å½¢è±¡åœ°ç§°ä¸ºæŒ‡é’ˆï¼Œæ„æ€æ˜¯é€šè¿‡æŒ‡é’ˆèƒ½æ‰¾åˆ°å†…å­˜å•å…ƒï¼Œå› ä¸ºåŸæœ¬æ˜¯é€šè¿‡åœ°å€æ‰¾åˆ°å†…å­˜å•å…ƒçš„ï¼Œæ‰€ä»¥ä¸€ä¸ªå˜é‡çš„åœ°å€ç§°ä¸ºè¯¥å˜é‡çš„æŒ‡é’ˆã€‚å¦‚æœæœ‰ä¸€ä¸ªå˜é‡ä¸“é—¨å­˜æ”¾å¦ä¸€ä¸ªå˜é‡çš„åœ°å€ï¼Œå®ƒå°±æ˜¯æŒ‡é’ˆå˜é‡ã€‚åœ¨C++è¯­è¨€ä¸­ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾å†…å­˜å•å…ƒåœ°å€çš„å˜é‡ç±»å‹ï¼Œç§°ä¸ºæŒ‡é’ˆç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œé€šå¸¸æ‰€è¯´çš„æŒ‡é’ˆå°±æ˜¯æŒ‡é’ˆå˜é‡ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾åœ°å€çš„å˜é‡ã€‚è€Œå˜é‡çš„æŒ‡é’ˆè¯´çš„å°±æ˜¯å˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚å˜é‡åœ°å€åœ¨ç¼–å†™ä»£ç æ—¶æ— æ³•è·å¾—ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å¯ä»¥å¾—åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆè·Ÿå¸¸è§„çš„å˜é‡ä¸ºèµ‹å€¼ç›¸åŒï¼Œæ²¡æœ‰å…·ä½“æŒ‡å‘çš„æŒ‡é’ˆä¸ä¼šå¯¼è‡´ç¼–è¯‘å‡ºé”™ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥é¢„æ–™çš„é”™è¯¯ï¼Œæ‰€ä»¥ä¸€æ—¦å®šä¹‰æŒ‡é’ˆï¼Œä¸€å®šè¦è®©å®ƒæœ‰ä¸€ä¸ªå…·ä½“çš„æŒ‡å‘ï¼Œä¹Ÿå°±æ˜¯è¯´è¦æœ‰ä¸€ä¸ªåœ°å€èµ‹ç»™å®ƒã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œå®šä¹‰æŒ‡é’ˆå˜é‡çš„æ—¶å€™ï¼Œè·Ÿå…¶ä»–å¸¸è§„å˜é‡ä¸ºäº†åŒºåˆ†ï¼Œè¦åŠ *å·ï¼Œä½†å…¶å®çœŸæ­£çš„æŒ‡é’ˆå˜é‡æ˜¯æ²¡æœ‰*å·çš„ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™è¦æ³¨æ„ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆè¿›è¡Œè¿ç®—å…¶å®å°±æ˜¯åœ°å€è¿›è¡Œè¿ç®—ï¼ŒæŒ‡é’ˆçš„åŠ å‡è¿ç®—æ˜¯è·ŸæŒ‡é’ˆçš„ç±»å‹æœ‰å…³çš„ï¼Œæ¯”å¦‚intç±»å‹çš„æŒ‡é’ˆåŠ 1ï¼Œåœ°å€å€¼å¹¶ä¸æ˜¯åŠ 1è€Œæ˜¯åŠ 4ï¼Œå› ä¸ºintç±»å‹å å››ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;â€»æŒ‡é’ˆè¿˜å¯ä»¥æŒ‡å‘ç©ºç±»å‹voidã€‚ç©ºç±»å‹æŒ‡é’ˆå¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚void *p = NULL&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ç‚¹é—®é¢˜ï¼ŒNULLä»£æ›¿ç©ºæŒ‡é’ˆå­˜åœ¨äºŒä¹‰æ€§ï¼Œæ‰€ä»¥åæ¥ç”¨nullptræ¥ä»£æ›¿ç©ºæŒ‡é’ˆã€‚æ€»ä¹‹ï¼Œåªè¦è®°ä½nullpträ»£è¡¨ç©ºæŒ‡é’ˆå°±å¯ä»¥äº†ï¼Œè€ŒNULLåœ¨C++ä¸­éƒ½æŠŠå®ƒç†è§£ä¸º0å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;â€»const int *p = &amp;amp;iÂ  è¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆæ˜¯æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼Œåªèƒ½ç”¨æ¥â€œè¯»â€å†…å­˜æ•°æ®ï¼Œæ— æ³•é€šè¿‡*pçš„æ–¹å¼æ›´æ”¹å†…å­˜çš„å†…å®¹ï¼Œå³æ›´æ”¹å˜é‡çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥æ”¹å˜è‡ªèº«çš„åœ°å€å€¼ï¼Œå°±æ˜¯æŒ‡å‘åˆ«çš„å†…å­˜åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;â€»int* const p = &amp;amp;iÂ  è¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆæ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Œä»¥ä¸ºæŒ‡é’ˆå˜é‡é‡Œå­˜æ”¾çš„æ˜¯åœ°å€ï¼Œå®šä¹‰ä¸ºå¸¸é‡æŒ‡é’ˆçš„è¯ï¼Œè¯´æ˜è¿™ä¸ªæŒ‡é’ˆå˜é‡å­˜æ”¾çš„åœ°å€å€¼æ˜¯ä¸å¯ä»¥æ”¹å˜çš„ï¼Œä½†æ˜¯å‘¢ï¼Œå¯ä»¥é€šè¿‡*pçš„æ–¹å¼æ”¹å˜å†…å­˜çš„æ•°æ®ï¼›&lt;/p&gt;
&lt;p&gt;â€»const int* const p = &amp;amp;iÂ  è¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆæ˜¯æŒ‡å‘å¸¸é‡çš„å¸¸é‡æŒ‡é’ˆï¼Œæœ‰ç‚¹æ‹—å£ï¼Œè·Ÿä¸Šé¢çš„å¯¹æ¯”ï¼Œåæ­£å°±æ˜¯åªèƒ½ç”¨æ¥â€œè¯»â€å†…å­˜æ•°æ®ï¼Œä¹Ÿæ— æ³•é€šè¿‡*pçš„æ–¹å¼æ›´æ”¹å†…å­˜çš„å†…å®¹ï¼Œä¹Ÿæ— æ³•æ”¹å˜è‡ªèº«çš„åœ°å€å€¼ã€‚&lt;/p&gt;

&lt;p&gt;æŒ‡é’ˆå’Œä¸€ç»´æ•°ç»„&lt;/p&gt;
&lt;p&gt;ä¸€ç»´æ•°ç»„å’ŒäºŒç»´æ•°ç»„åœ¨å†…å­˜ä¸­çš„å­˜æ”¾ç»“æ„éƒ½æ˜¯çº¿æ€§çš„ã€‚æ•°ç»„ç¬¬ä¸€å…ƒç´ çš„åœ°å€å°±æ˜¯æ•´ä¸ªæ•°ç»„çš„å­˜å‚¨é¦–åœ°å€ï¼Œè¯¥åœ°å€å­˜æ”¾åœ¨æ•°ç»„åä¸­ï¼Œçœ‹å§ï¼Œå…¶å®æ•°ç»„åå°±ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆå˜é‡äº†ï¼Œé‡Œå¤´å­˜æ”¾çš„æ˜¯æ•°ç»„çš„é¦–åœ°å€ã€‚è®¿é—®æ•°ç»„å…ƒç´ çš„æ–¹å¼æœ‰ä¸‹æ ‡æ³•å’ŒæŒ‡é’ˆæ³•ã€‚ç”¨æ•°ç»„å[i]è¿™ä¸ªæ–¹å¼å¯ä»¥è®¿é—®æ•°ç»„å†…å®¹ï¼Œå…¶å®ä¹Ÿå¯ä»¥é€šè¿‡*(a+i)çš„æ–¹å¼ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†å•ç‹¬å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå°†æ•°ç»„çš„é¦–åœ°å€å­˜æ”¾åˆ°è¿™ä¸ªæŒ‡é’ˆå˜é‡ä¸­ï¼Œå½“ç„¶äº†ï¼Œå¯ä»¥ç”¨&amp;amp;a[0]ä¹Ÿå¯ä»¥ç›´æ¥ç”¨aå³æ•°ç»„åï¼Œå› ä¸ºæˆ‘ä»¬è¯´è¿‡äº†æ•°ç»„åæœ¬æ¥å°±å­˜æ”¾çš„æ˜¯æ•°ç»„çš„é¦–åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;*(p++)ç›¸å½“äºa[i++]ï¼Œå…ˆå¯¹pè¿›è¡Œ*è¿ç®—ï¼Œå†ä½¿pè‡ªå¢ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆä¸äºŒç»´æ•°ç»„&lt;/p&gt;
&lt;p&gt;a[0]æ˜¯äºŒç»´æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ï¼Œå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªæŒ‡é’ˆå˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;aä»£è¡¨äºŒç»´æ•°ç»„çš„åœ°å€ï¼Œé€šè¿‡æŒ‡é’ˆè¿ç®—ç¬¦å¯ä»¥è·å–æ•°ç»„ä¸­çš„å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;a+nè¡¨ç¤ºç¬¬nè¡Œçš„é¦–åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;&amp;amp;a[0][0]æ—¢å¯ä»¥çœ‹åšæ•°ç»„0è¡Œ0åˆ—çš„é¦–åœ°å€ï¼Œè¿˜å¯ä»¥çœ‹åšæ˜¯äºŒç»´æ•°ç»„çš„é¦–åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;&amp;amp;a[0]æ˜¯ç¬¬0è¡Œçš„é¦–åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;a[0]+næ˜¯ç¬¬0è¡Œç¬¬nä¸ªå…ƒç´ çš„åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;*(*(a+n)+m)è¡¨ç¤ºç¬¬nè¡Œç¬¬måˆ—å…ƒç´ ï¼›&lt;/p&gt;
&lt;p&gt;*(a[n]+m)è¡¨ç¤ºç¬¬nè¡Œç¬¬måˆ—å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;æ•°ç»„æŒ‡é’ˆå’ŒæŒ‡é’ˆæ•°ç»„&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿˜æ²¡æœ‰ç†è§£å¥½ï¼Œå°¤å…¶æ˜¯æ•°ç»„æŒ‡é’ˆï¼ŒæŒ‡é’ˆæ•°ç»„è¿˜å¥½ç†è§£ï¼Œå°±æ˜¯å­˜å‚¨æŒ‡é’ˆå˜é‡çš„æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆå’Œå­—ç¬¦æ•°ç»„&lt;/p&gt;
&lt;p&gt;å­—ç¬¦æ•°ç»„å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡å­—ç¬¦æŒ‡é’ˆå¯ä»¥æŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡åœ°å€çš„åŠ å‡å®ç°è¯»å–ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ é€’åœ°å€&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æ¥è§¦çš„å‡½æ•°éƒ½æ˜¯å®å‚ä¼ é€’è¿›å‡½æ•°ä½“åï¼Œç”Ÿæˆçš„æ˜¯å®å‚çš„å‰¯æœ¬ï¼Œå‡½æ•°ä½“å†…æ”¹å˜å‰¯æœ¬çš„å€¼å¹¶ä¸ä¼šå½±å“åˆ°å®å‚ï¼Œä½†æ˜¯å¦‚æœä¼ é€’è¿›å»çš„æ˜¯æŒ‡é’ˆï¼Œå³ä½¿æ˜¯å‰¯æœ¬æŒ‡é’ˆï¼ŒæŒ‡å‘çš„åœ°å€è¿˜æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å¯ä»¥æ”¹å˜æŒ‡é’ˆæŒ‡å‘åœ°å€çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆå˜é‡ä¹Ÿå¯ä»¥æŒ‡å‘ä¸€ä¸ªå‡½æ•°ã€‚ä¸€ä¸ªå‡½æ•°åœ¨ç¼–è¯‘æ—¶è¢«åˆ†é…ç»™äº†ä¸€ä¸ªå…¥å£åœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯ä»¥ç†è§£ä¸ºå­˜æ”¾åœ¨å‡½æ•°åä¸­ï¼Œå¯ä»¥å®šä¹‰å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è¿™ä¸ªå‡½æ•°ï¼Œé€šè¿‡æŒ‡é’ˆæ¥è°ƒç”¨å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚:&lt;/p&gt;
&lt;p&gt;int sum(int x, int y)&lt;/p&gt;
&lt;p&gt;int *a(int, int);&lt;/p&gt;
&lt;p&gt;a = sum;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨çš„æ—¶å€™è¿™æ ·ï¼š&lt;/p&gt;
&lt;p&gt;int c,d;&lt;/p&gt;
&lt;p&gt;(*a)(c,d);&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥å®šä¹‰æŒ‡é’ˆå‡½æ•°ï¼Œè¿”å›å€¼æ˜¯æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯åœ°å€äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç©ºæŒ‡é’ˆè°ƒç”¨å‡½æ•°&lt;/p&gt;
&lt;p&gt;ç©ºç±»å‹æŒ‡é’ˆæŒ‡å‘ä»»æ„ç±»å‹å‡½æ•°æˆ–è€…å°†ä»»æ„ç±»å‹çš„å‡½æ•°æŒ‡é’ˆèµ‹å€¼ç»™ç©ºç±»å‹æŒ‡é’ˆéƒ½æ˜¯åˆæ³•çš„ã€‚ä½¿ç”¨ç©ºæŒ‡é’ˆè°ƒç”¨è‡ªèº«æ‰€æŒ‡å‘çš„å‡½æ•°ä»ç„¶æŒ‰ç…§å¼ºåˆ¶è½¬æ¢çš„å½¢å¼ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆæ•°ç»„&lt;/p&gt;

&lt;p&gt;&lt;span&gt;æ„é€ æ•°æ®ç±»å‹&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ç»“æ„ä½“&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;C++ structç»“æ„ä½“å˜é‡å…¶å®è·Ÿæ•°ç»„æœ‰ç‚¹åƒï¼Œåªä¸è¿‡æ•°ç»„æ˜¯ç›¸åŒç±»å‹å…ƒç´ çš„é›†åˆï¼Œè€Œç»“æ„ä½“å˜é‡å¯ä»¥æ˜¯ä¸åŒç±»å‹æ•°æ®çš„é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰ç»“æ„ä½“å˜é‡æœ‰ä¸¤ç§æ–¹å¼ï¼š1ã€åœ¨å®šä¹‰ç»“æ„ä½“çš„æ—¶å€™å®šä¹‰ï¼›2ã€å®šä¹‰å®Œä¹‹åå®šä¹‰ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_Highlighter&quot; readability=&quot;33&quot;&gt;
&lt;pre class=&quot;brush:cpp;gutter:true;&quot;&gt;
struct PersonInfo
{
    int index;
    char name[30];
    short age;
}XiaoMing;

æˆ–è€…
struct PersonInfo
{
    int index;
    char name[30];
    short age;
}
PersonInfo XiaoMing;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¼•ç”¨æ–¹å¼ï¼š1.ä½¿ç”¨æˆå‘˜è¿ç®—ç¬¦.æ¥å¼•ç”¨ï¼›2.å®šä¹‰ç»“æ„ä½“æŒ‡é’ˆå˜é‡ä¹‹åï¼Œä½¿ç”¨æŒ‡å‘è¿ç®—ç¬¦-&amp;gt;æ¥å¼•ç”¨&lt;/p&gt;

&lt;p&gt;ç»“æ„ä½“è¿˜å¯ä»¥è¿›è¡ŒåµŒå¥—ï¼Œç»“æ„ä½“çš„å¤§å°ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ç»“æ„ä½“å†…æˆå‘˜çš„å¤§å°ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨typedefå¯ä»¥ç»™ä¸€ä¸ªå¤æ‚çš„æ•°æ®ç±»å‹å®šä¹‰ä¸€ä¸ªåˆ«åï¼Œæ¯”å¦‚int(*)(int i)å¾ˆå¤æ‚ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªåˆ«åæ¥ä»£æ›¿ã€‚&lt;/p&gt;

&lt;p&gt;&lt;span&gt;æšä¸¾ç±»å‹enumçš„åº”ç”¨&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æšä¸¾ç±»å‹å°±æ˜¯ç”¨å¤§æ‹¬å·å°†ä¸åŒæ ‡è¯†ç¬¦æ”¾åˆ°ä¸€èµ·ï¼Œå˜é‡çš„å€¼åªèƒ½å–è‡ªæ‹¬å·å†…çš„å€¼ï¼Œåœ¨å®šä¹‰æ—¶ï¼Œç¼–è¯‘å™¨é»˜è®¤å°†æ ‡è¯†ç¬¦è‡ªåŠ¨èµ‹ä¸Šæ•´å½¢å¸¸æ•°ã€‚è¿˜å¯ä»¥è‡ªè¡Œä¿®æ”¹æ•´å½¢å¸¸æ•°çš„å€¼ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦å¯¹åº”ä¸€ä¸ªå¸¸æ•°ï¼Œç”¨äºä¸€äº›åˆ¤æ–­æˆ–è€…ä»€ä¹ˆï¼Œç”¨èµ·æ¥æ–¹ä¾¿ä¸€äº›ã€‚èµ‹å€¼çš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥èµ‹æ•´å‹æ•°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢æ¥èµ‹å€¼ã€‚æšä¸¾ç±»å‹çš„å˜é‡ï¼Œå®è´¨å…¶å®æ˜¯æ•´å‹çš„æ•°å­—ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œæ¯”è¾ƒå’Œè¿ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ç»“æ„ä½“&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç»“æ„ä½“å˜é‡è¿˜å¯ä»¥åšå‡½æ•°çš„å‚æ•°ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆï¼Œä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆå‡å°‘äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„å¼€é”€ï¼Œèƒ½å¤Ÿæé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;ç»“æ„ä½“è¿˜å¯ä»¥åˆ›å»ºç»“æ„ä½“æ•°ç»„ï¼Œè·Ÿåˆ›å»ºç»“æ„ä½“å˜é‡ä¸€æ ·ï¼Œåœ¨å®šä¹‰ç»“æ„ä½“æ—¶åˆ›å»ºæˆ–è€…å®šä¹‰å®Œäº†ä¹‹åç”¨ç»“æ„ä½“åè¿™ç§æ•°æ®ç±»å‹åˆ›å»ºã€‚å¯ä»¥å®šä¹‰ç»“æ„ä½“æŒ‡é’ˆï¼ŒæŒ‡å‘æ•°ç»„ï¼Œä½¿ç”¨æŒ‡å‘ç¬¦å·-&amp;gt;è¿›è¡Œè¯»å–ï¼Œä½†æ˜¯è¦æ³¨æ„ï¼ŒæŒ‡é’ˆåŠ 1ï¼ŒæŒ‡å‘çš„å°±æ˜¯æ•°ç»„é‡Œçš„ä¸‹ä¸€ä¸ªç»“æ„ä½“äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å…±ç”¨ä½“&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…±ç”¨ä½“unionæ•°æ®ç±»å‹å…¶å®å’Œç»“æ„ä½“å¾ˆåƒï¼Œå£°æ˜å…±ç”¨ä½“æ•°æ®ç±»å‹å˜é‡å’Œå£°æ˜å…±ç”¨ä½“å˜é‡ä¸€æ ·ï¼Œéƒ½æœ‰ä¸‰ç§æ–¹å¼ï¼Œå‰ä¸¤ç§åº”è¯¥çŸ¥é“ï¼Œç¬¬ä¸‰ç§æ˜¯çœç•¥äº†å…±ç”¨ä½“æ•°æ®ç±»å‹å˜é‡åï¼Œåœ¨å®šä¹‰å…±ç”¨ä½“ä¹‹åæ¥ç€å£°æ˜å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ³¨æ„å…±ç”¨ä½“è·Ÿç»“æ„ä½“æœ€å¤§çš„åŒºåˆ«åœ¨äºå†…å­˜æ–¹é¢ã€‚å…±ç”¨ä½“å˜é‡æ‰€å çš„å†…å­˜é•¿åº¦ç­‰äºæœ€é•¿çš„æˆå‘˜çš„é•¿åº¦ï¼Œä¸€ä¸ªå…±ç”¨ä½“å˜é‡ä¸èƒ½åŒæ—¶å­˜æ”¾å¤šä¸ªæˆå‘˜çš„å€¼ï¼ŒæŸä¸€æ—¶åˆ»åªèƒ½å­˜æ”¾å…¶å®ä¸€ä¸ªæˆå‘˜çš„å€¼ï¼Œè¿™å°±æ˜¯æœ€åèµ‹äºˆä»–çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å…±ç”¨ä½“çš„ç‰¹ç‚¹æ˜¯ï¼š1.ä½¿ç”¨å…±ç”¨ä½“å˜é‡çš„ç›®çš„æ˜¯å¸Œæœ›ç”¨åŒä¸€ä¸ªå†…å­˜æ®µå­˜æ”¾å‡ ç§ä¸åŒç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯æŸä¸ªç¬é—´åªèƒ½å­˜æ”¾ä¸€ç§ï¼Œè€Œä¸æ˜¯åŒæ—¶å­˜æ”¾å‡ ç§ï¼›2.èƒ½å¤Ÿè¢«è®¿é—®çš„æ˜¯æœ€åä¸€ä¸ªè¢«èµ‹å€¼çš„å˜é‡ï¼Œå¯¹æ–°çš„èµ‹å€¼ååŸæ¥çš„å°±å¤±å»ä½œç”¨äº†ï¼›3.å…±ç”¨ä½“å˜é‡çš„åœ°å€å’Œå®ƒçš„å„æˆå‘˜çš„åœ°å€éƒ½æ˜¯åŒä¸€åœ°å€ã€‚4.ä¸èƒ½å¯¹å…±ç”¨ä½“å˜é‡åèµ‹å€¼ï¼Œä¸èƒ½å¼•ç”¨å˜é‡åæ¥å¾—åˆ°å“¦ä¸€ä¸ªå€¼ï¼Œä¸èƒ½åœ¨å®šä¹‰å…±ç”¨ä½“å˜é‡æ—¶å¯¹å®ƒåˆå§‹åŒ–ï¼Œä¸èƒ½ä½œä¸ºå‡½æ•°å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;è‡ªå®šä¹‰æ•°æ®ç±»å‹&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿå‰é¢çš„æ•°æ®ç±»å‹é‡å‘½åä¸€æ ·çš„ï¼Œä½¿ç”¨typedefæ ‡è¯†ç¬¦è¿›è¡Œç±»å‹çš„é‡å‘½åï¼Œæˆ–è€…è¯´æ˜¯è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå…¶å®æ˜¯ä¸ºäº†å†™èµ·æ¥æ–¹ä¾¿æˆ–è€…ç”¨ç‰¹å®šçš„å•è¯ä»£è¡¨ç‰¹æ®Šçš„æ„æ€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å®å®šä¹‰&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨#define å¯ä»¥å¯¹ç¨‹åºä¸­ç»å¸¸å‡ºç°çš„å‚æ•°è¿›è¡Œå®å®šä¹‰ï¼Œè¿™æ ·åœ¨ä¹‹åå†™ä»£ç çš„æ—¶å€™å°±å¯ä»¥ç”¨å®å®šä¹‰æ›¿æ¢ï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡è½»äº†å†™ä»£ç çš„å¤æ‚åº¦ï¼Œç¨‹åºåœ¨ç¼–è¯‘çš„æ—¶å€™è‡ªåŠ¨è¿›è¡Œæ›¿æ¢ï¼Œæ¯”å¦‚PIï¼Œä¸€èˆ¬æ ‡è¯†ç¬¦ä¹ æƒ¯ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œä»¥å’Œå˜é‡åè¿›è¡ŒåŒºåˆ†ï¼Œè¦æ³¨æ„å®å®šä¹‰ä¸æ˜¯Cè¯­è¨€ï¼Œä¸éœ€è¦åœ¨åé¢åŠ åˆ†å·ï¼Œè¿˜å¯ä»¥å®šä¹‰æ•°ç»„å’Œè¿ç®—ï¼Œå®šä¹‰è¿ç®—çš„æ—¶å€™ï¼Œæ‹¬å·å»ºè®®éƒ½åŠ ä¸Šï¼Œä»¥é˜²æ­¢å‡ºç°é”™è¯¯ã€‚å¦‚æœå­—ç¬¦ä¸²é•¿äºä¸€è¡Œï¼Œå¯ä»¥åœ¨è¯¥è¡Œæœ«å°¾ç”¨åæ–œæ \æ¥ç»­è¡Œã€‚ä¸€èˆ¬æ¥è®²ï¼Œå®šä¹‰åªæœ‰ï¼Œä½œç”¨åŸŸå³æœ‰æ•ˆèŒƒå›´æŒ‡çš„æ˜¯å®šä¹‰å‘½ä»¤ä¹‹ååˆ°æ­¤æºæ–‡ä»¶ç»“æŸï¼Œä½†ä¹Ÿå¯é€šè¿‡#undefå‘½ä»¤ç»ˆæ­¢å®å®šä¹‰çš„ä½œç”¨åŸŸã€‚&lt;/p&gt;

</description>
<pubDate>Wed, 16 Dec 2020 15:47:00 +0000</pubDate>
<dc:creator>ä¸å¦¨ä¸å¦¨ï¼Œæ¥æ—¥æ–¹é•¿</dc:creator>
<og:description>ä¸€äº›éœ€è¦çŸ¥é“çš„åŸºç¡€çŸ¥è¯†ç‚¹ï¼š åœ¨ç¨‹åºä»£ç ä¸­æ˜¯é€šè¿‡å˜é‡åå¯¹å†…å­˜å•å…ƒè¿›è¡Œå­˜å–æ“ä½œçš„ï¼Œä½†æ˜¯ä»£ç ç»è¿‡ç¼–è¯‘åå°†å˜é‡åè½¬æ¢ä¸ºè¯¥å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾åœ°å€ï¼Œå¯¹å˜é‡å€¼çš„å­˜å–éƒ½æ˜¯é€šè¿‡åœ°å€è¿›è¡Œçš„ã€‚æ¯”å¦‚i+jçš„è¿ç®—ï¼Œå¦‚æœiç­‰äº3</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/masbay/p/13942453.html</dc:identifier>
</item>
<item>
<title>ä¸ºä»€ä¹ˆç±»åªèƒ½ç”¨publicä¿®é¥°? - é˜¿å»–è</title>
<link>http://www.cnblogs.com/aliaosha/p/14146817.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/aliaosha/p/14146817.html</guid>
<description>&lt;p&gt;é¦–å…ˆï¼Œç±»åªèƒ½ä½¿ç”¨publicä¿®é¥°æ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œåº”è¯¥è¯´æˆ‘ä»¬åªè§åˆ°è¿‡ä½¿ç”¨publicä¿®é¥°çš„ç±»ï¼Œè¿˜æœ‰ä¸€äº›ç±»æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦ï¼Œæ­¤æ—¶è®¿é—®æƒé™ä¸ºdefaultã€‚å…¶æ¬¡ï¼Œç±»å®é™…ä¸Šåˆ†ä¸ºå¤–éƒ¨ç±»å’Œå†…éƒ¨ç±»ï¼ˆinner classï¼‰ï¼Œä¸€èˆ¬çš„ç±»éƒ½æ˜¯å¤–éƒ¨ç±»ï¼Œå†…éƒ¨ç±»éœ€è¦ä¾èµ–å¤–éƒ¨ç±»ç”Ÿæˆï¼Œå†…éƒ¨ç±»å¯ä»¥ç”¨å„ç§è®¿é—®ä¿®é¥°ç¬¦ä¿®é¥°ã€‚æ‰€ä»¥é—®é¢˜è½¬åŒ–æˆï¼Œä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨privateå’Œprotectedä¿®é¥°å¤–éƒ¨ç±»ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Javaä¸­ï¼Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•ã€å˜é‡å’Œæ„é€ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è®¿é—®æƒé™ç”±é«˜åˆ°ä½æœ‰ä»¥ä¸‹4ç§&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th/&gt;
&lt;th&gt;ç±»å†…éƒ¨&lt;/th&gt;
&lt;th&gt;æœ¬åŒ…&lt;/th&gt;
&lt;th&gt;å­åŒ…&lt;/th&gt;
&lt;th&gt;å¤–éƒ¨åŒ…&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;public&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;protected&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;default&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;private&lt;/td&gt;
&lt;td&gt;v&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;td&gt;x&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨è®¿é—®ä¿®é¥°ç¬¦å»ä¿®é¥°ç±»ï¼Œå°±æ˜¯ä¸ºäº†è®©ç±»ä¹‹é—´æ ¹æ®å„ç§æƒé™æ¥è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚å¤–éƒ¨ç±»ä½¿ç”¨privateä¿®é¥°ï¼Œåˆ™ä¸èƒ½è¢«å…¶å®ƒç±»æ‰€è®¿é—®ï¼Œè¿™ä¸ªç±»ä¹Ÿå°±å¤±å»äº†æ„ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚å¤–éƒ¨ç±»ä½¿ç”¨protectedä¿®é¥°ï¼Œçœ‹èµ·æ¥ä¸defaultç›¸æ¯”ï¼Œåœ¨åŒ…å†…å¯è®¿é—®çš„åŸºç¡€ä¸Šï¼ŒåŒ…å¤–çš„å­ç±»ä¹Ÿå¯è®¿é—®ã€‚ä½†åŒ…å¤–æƒ³æˆä¸ºå­ç±»éœ€è¦å…ˆç»§æ‰¿çˆ¶ç±»ï¼Œç„¶è€Œæ— æ³•æ‰¾åˆ°è¯¥çˆ¶ç±»å®é™…ä¸Šæ— æ³•ç»§æ‰¿ï¼ˆå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„é—®é¢˜ï¼‰ï¼Œæ•ˆæœä¸defaultä¸€è‡´ï¼Œä¹Ÿå°±æ²¡å¿…è¦å­˜åœ¨äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å…³äºå†…éƒ¨ç±»ï¼š&quot;&gt;å…³äºå†…éƒ¨ç±»ï¼š&lt;/h2&gt;
&lt;p&gt;å†…éƒ¨ç±»åˆ†ä¸ºæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»ã€‚&lt;/p&gt;
&lt;p&gt;æˆå‘˜å†…éƒ¨ç±»æ˜¯å®šä¹‰åœ¨å¦ä¸€ä¸ªç±»ä¸­çš„ç±»ï¼Œæ˜¯æœ€æ™®é€šçš„ä¸€ç§å†…éƒ¨ç±»ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;class Circle {
    double radius = 0;
     
    public Circle(double radius) {
        this.radius = radius;
    }
     
    class Draw {     //å†…éƒ¨ç±»
        public void drawSahpe() {
            System.out.println(&quot;drawshape&quot;);
        }
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ ·çœ‹èµ·æ¥ï¼Œç±»Drawåƒæ˜¯ç±»Circleçš„ä¸€ä¸ªæˆå‘˜ï¼ŒCircleç§°ä¸ºå¤–éƒ¨ç±»ã€‚æˆå‘˜å†…éƒ¨ç±»å¯ä»¥æ— æ¡ä»¶è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜å±æ€§å’Œæˆå‘˜æ–¹æ³•ï¼ˆåŒ…æ‹¬privateæˆå‘˜å’Œé™æ€æˆå‘˜ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å†…éƒ¨ç±»å¯ä»¥ç”¨privateã€protectedã€defaultã€publicä¿®é¥°ï¼Œä½¿ç”¨privateä¿®é¥°åªèƒ½åœ¨å¤–éƒ¨ç±»å†…è®¿é—®ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å…³äºæ¥å£&quot;&gt;å…³äºæ¥å£&lt;/h2&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public interface Comparable&amp;lt;T&amp;gt;{
    int compareTo(T other);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•&lt;strong&gt;è‡ªåŠ¨åœ°&lt;/strong&gt;å±äºpublicï¼Œåœ¨æ¥å£ä¸­å£°æ˜æ–¹æ³•æ—¶ä¸å¿…æä¾›å…³é”®å­—publicã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä¿®é¥°æ„é€ æ–¹æ³•&quot;&gt;ä¿®é¥°æ„é€ æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;åœ¨å•ä¾‹è®¾è®¡æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨privateä¿®é¥°æ„é€ æ–¹æ³•ï¼Œå°†æ„é€ å™¨ç§æœ‰åŒ–ï¼Œè¡¨ç¤ºåœ¨ç±»å¤–éƒ¨ä¸èƒ½å®ä¾‹åŒ–è¯¥ç±»ã€‚åœ¨ç±»å†…éƒ¨å®ä¾‹åŒ–åï¼Œæä¾›ä¸€ä¸ªå¯ä¾›å¤–éƒ¨è®¿é—®çš„æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;public class SingletonTest {
        public static void main(String[] args) {
                //æµ‹è¯•
                Singleton instance = Singleton.getInstance();
                Singleton instance2 = Singleton.getInstance();
                System.out.println(instance == instance2); // true
                System.out.println(&quot;instance.hashCode=&quot; + instance.hashCode());
                System.out.println(&quot;instance2.hashCode=&quot; + instance2.hashCode());
        }
}

//é¥¿æ±‰å¼
class Singleton {
        //1. æ„é€ å™¨ç§æœ‰åŒ–
        private Singleton() {
        }
        
        //2.æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹
        private final static Singleton instance = new Singleton();
        
        //3. æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
        public static Singleton getInstance() {
                return instance;
        }
&lt;/code&gt;
&lt;/pre&gt;</description>
<pubDate>Wed, 16 Dec 2020 15:04:00 +0000</pubDate>
<dc:creator>é˜¿å»–è</dc:creator>
<og:description>ä¸ºä»€ä¹ˆç±»åªèƒ½ä½¿ç”¨publicä¿®é¥°ï¼Ÿ é¦–å…ˆï¼Œç±»åªèƒ½ä½¿ç”¨publicä¿®é¥°æ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œåº”è¯¥è¯´æˆ‘ä»¬åªè§åˆ°è¿‡ä½¿ç”¨publicä¿®é¥°çš„ç±»ï¼Œè¿˜æœ‰ä¸€äº›ç±»æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦ï¼Œæ­¤æ—¶è®¿é—®æƒé™ä¸ºdefaultã€‚å…¶æ¬¡ï¼Œç±»å®é™…ä¸Šåˆ†ä¸º</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/aliaosha/p/14146817.html</dc:identifier>
</item>
</channel>
</rss>