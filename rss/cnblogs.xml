<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>博客园_首页</title>
<link></link>
<description>代码改变世界</description>
<item>
<title>git 入门教程之分支策略 - snowdreams1006</title>
<link>http://www.cnblogs.com/snowdreams1006/p/10569263.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/snowdreams1006/p/10569263.html</guid>
<description>&lt;p&gt;默认情况下合并分支常常直接使用 &lt;code&gt;git merge&lt;/code&gt; 命令,是最方便快速的合并方法.其实这种情况下 &lt;code&gt;git&lt;/code&gt; 采用的是 &lt;code&gt;fast forward&lt;/code&gt; 模式,特点是删除分支后,会丢失分支信息,好像从来没存在该分支一样,而我们推荐的是&lt;code&gt;recursive&lt;/code&gt; 模式,能够保留分支的版本记录.&lt;/p&gt;
&lt;h2 id=&quot;递归模式recursive&quot;&gt;递归模式(&lt;code&gt;recursive&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;创建并切换 &lt;code&gt;dev&lt;/code&gt; 分支,提交版本后切换回 &lt;code&gt;master&lt;/code&gt; 分支,然后再合并 &lt;code&gt;dev&lt;/code&gt; 分支,这不过这一次不再使用 &lt;code&gt;git merge dev&lt;/code&gt; 命令:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# 创建并切换 dev 分支
$ git checkout -b dev
Switched to a new branch 'dev'
# 提交版本
$ echo &quot;git checkout -b dev&quot; &amp;gt;&amp;gt; test.txt
$ git add test.txt
$ git commit -m &quot;git checkout -b dev&quot;
[dev 44d68f6] git checkout -b dev
 1 file changed, 1 insertion(+)
# 切换回 master 分支
$ git checkout master
Switched to branch 'master'
Your branch is ahead of 'origin/master' by 6 commits.
  (use &quot;git push&quot; to publish your local commits)
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;现在添加 &lt;code&gt;--no-ff&lt;/code&gt; 参数禁用 &lt;code&gt;fast forward&lt;/code&gt; 模式,即&lt;code&gt;git merge --no-ff&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git merge --no-ff -m &quot;git merge --no-ff dev&quot; dev
Merge made by the 'recursive' strategy.
 test.txt | 1 +
 1 file changed, 1 insertion(+)
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;上述内容显示,这次使用的不再是 &lt;code&gt;fast forward&lt;/code&gt; 模式,而是 &lt;code&gt;recursive&lt;/code&gt; 模式,那让我们看一下提交历史有什么不同吧!&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git log --pretty=oneline --graph
*   22fbef71b7575cd7eb7911079551618667f9f38f (HEAD -&amp;gt; master) git merge --no-ff dev
|\  
| * 44d68f674bc85bc972426c572b78915e850e476c (dev) git checkout -b dev
|/  
*   3b8f434013caa8c27fade4c59d7aa2ee2c079636 fix conflict
|\  
| * 0fe95f871b371834d30ea17faa82f84b7d67672b git commit c2
* | 0949cc319e099d554795d03c69ee38923af00d6c git commit c3
|/  
* 5c482cd9965b9dfd4f273b43b240ed7db66167a8 git commit c1
* 413a4d1d2aab5ab85b6097d4b9f81cb5601c3b26 see https://snowdreams1006.github.io/git/usage/branch-overview.html
* 9c30e50248b773e38b032477a859e87abe7c1bb0 learn git branch
* b3d8193bbcb9f76c47e831e3e212f2405ae09f93 (origin/master, origin/HEAD) see https://snowdreams1006.github.io/git/usage/remote-repository.html
* 8e625640348a47ac922409a1ecb4c844385582aa add test.txt
* 9b196aab5bc87eeb11709c9eef35fca283e05c61 Initial commit
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/16648241-13befd6abb125c1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;git-merge-no-ff.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;这种递归模式(&lt;code&gt;recursive&lt;/code&gt;) 有一个明显的特点就是会产生一个新的 &lt;code&gt;commit&lt;/code&gt; ,并不会像之前快速前进模式(&lt;code&gt;fast forward&lt;/code&gt;)那样单纯更改 &lt;code&gt;HEAD&lt;/code&gt; 的指向.&lt;/p&gt;
&lt;p&gt;秉承着阅后即焚的习惯,分支一旦合并后就立即删除,现在删除 &lt;code&gt;dev&lt;/code&gt; 分支,看一下会发生什么:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# 删除 dev 分支
$ git branch -d dev
Deleted branch dev (was 44d68f6).
# 查看提交历史
$ git log --pretty=oneline --graph
*   22fbef71b7575cd7eb7911079551618667f9f38f (HEAD -&amp;gt; master) git merge --no-ff dev
|\  
| * 44d68f674bc85bc972426c572b78915e850e476c git checkout -b dev
|/  
*   3b8f434013caa8c27fade4c59d7aa2ee2c079636 fix conflict
|\  
| * 0fe95f871b371834d30ea17faa82f84b7d67672b git commit c2
* | 0949cc319e099d554795d03c69ee38923af00d6c git commit c3
|/  
* 5c482cd9965b9dfd4f273b43b240ed7db66167a8 git commit c1
* 413a4d1d2aab5ab85b6097d4b9f81cb5601c3b26 see https://snowdreams1006.github.io/git/usage/branch-overview.html
* 9c30e50248b773e38b032477a859e87abe7c1bb0 learn git branch
* b3d8193bbcb9f76c47e831e3e212f2405ae09f93 (origin/master, origin/HEAD) see https://snowdreams1006.github.io/git/usage/remote-repository.html
* 8e625640348a47ac922409a1ecb4c844385582aa add test.txt
* 9b196aab5bc87eeb11709c9eef35fca283e05c61 Initial commit
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/16648241-fd1f341738fdcef0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;git-merge-no-ff-dev.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;由此可见,删除 &lt;code&gt;dev&lt;/code&gt; 分支后仅仅少了 &lt;code&gt;dev&lt;/code&gt; 的引用而已,原来 &lt;code&gt;dev&lt;/code&gt; 分支所做的更改全部保留下来了!&lt;/p&gt;
&lt;h2 id=&quot;快速前进模式fast-forward&quot;&gt;快速前进模式(&lt;code&gt;fast forward&lt;/code&gt;)&lt;/h2&gt;
&lt;p&gt;创建并切换 &lt;code&gt;dev&lt;/code&gt; 分支,提交版本后切换回 &lt;code&gt;master&lt;/code&gt; 分支,然后再合并 &lt;code&gt;dev&lt;/code&gt; 分支,使用 &lt;code&gt;git merge dev&lt;/code&gt; 命令:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# 创建并切换 dev 分支
$ git checkout -b dev
Switched to a new branch 'dev'
# 提交版本
$ echo &quot;fast forward&quot; &amp;gt;&amp;gt; test.txt
$ git add test.txt
$ git commit -m &quot;fast forward&quot;
[dev 3fe94c0] fast forward
 1 file changed, 1 insertion(+)
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;现在切换回 &lt;code&gt;master&lt;/code&gt; 分支,采用默认的&lt;code&gt;git merge&lt;/code&gt; 命令合并 &lt;code&gt;dev&lt;/code&gt; 分支:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git checkout master
Switched to branch 'master'
Your branch is ahead of 'origin/master' by 8 commits.
  (use &quot;git push&quot; to publish your local commits)
sunpodeMacBook-Pro:git-demo sunpo$ git merge dev
Updating 22fbef7..3fe94c0
Fast-forward
 test.txt | 1 +
 1 file changed, 1 insertion(+)
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;上述内容显示这次合并采用的是快速前进模式(&lt;code&gt;fast forward&lt;/code&gt;),让我们看一下提交历史:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git log --pretty=oneline --graph
* 3fe94c0088cae526eda1fb2ffa303001b1eb42ba (HEAD -&amp;gt; master, dev) fast forward
*   22fbef71b7575cd7eb7911079551618667f9f38f git merge --no-ff dev
|\  
| * 44d68f674bc85bc972426c572b78915e850e476c git checkout -b dev
|/  
*   3b8f434013caa8c27fade4c59d7aa2ee2c079636 fix conflict
|\  
| * 0fe95f871b371834d30ea17faa82f84b7d67672b git commit c2
* | 0949cc319e099d554795d03c69ee38923af00d6c git commit c3
|/  
* 5c482cd9965b9dfd4f273b43b240ed7db66167a8 git commit c1
* 413a4d1d2aab5ab85b6097d4b9f81cb5601c3b26 see https://snowdreams1006.github.io/git/usage/branch-overview.html
* 9c30e50248b773e38b032477a859e87abe7c1bb0 learn git branch
* b3d8193bbcb9f76c47e831e3e212f2405ae09f93 (origin/master, origin/HEAD) see https://snowdreams1006.github.io/git/usage/remote-repository.html
* 8e625640348a47ac922409a1ecb4c844385582aa add test.txt
* 9b196aab5bc87eeb11709c9eef35fca283e05c61 Initial commit
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;上述内容表明,此次合并并没有产生新的 &lt;code&gt;commit&lt;/code&gt; ,只是更改下 &lt;code&gt;HEAD&lt;/code&gt; 指向而已(&lt;code&gt;HEAD -&amp;gt; master, dev&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/16648241-79cd92821180eca9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;git-merge-ff-dev.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;同样,现在删除 &lt;code&gt;dev&lt;/code&gt; 分支,再看一下提交历史:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# 删除 dev 分支
$ git branch -d dev
Deleted branch dev (was 3fe94c0).
# 查看提交历史
$ git log --pretty=oneline --graph
* 3fe94c0088cae526eda1fb2ffa303001b1eb42ba (HEAD -&amp;gt; master) fast forward
*   22fbef71b7575cd7eb7911079551618667f9f38f git merge --no-ff dev
|\  
| * 44d68f674bc85bc972426c572b78915e850e476c git checkout -b dev
|/  
*   3b8f434013caa8c27fade4c59d7aa2ee2c079636 fix conflict
|\  
| * 0fe95f871b371834d30ea17faa82f84b7d67672b git commit c2
* | 0949cc319e099d554795d03c69ee38923af00d6c git commit c3
|/  
* 5c482cd9965b9dfd4f273b43b240ed7db66167a8 git commit c1
* 413a4d1d2aab5ab85b6097d4b9f81cb5601c3b26 see https://snowdreams1006.github.io/git/usage/branch-overview.html
* 9c30e50248b773e38b032477a859e87abe7c1bb0 learn git branch
* b3d8193bbcb9f76c47e831e3e212f2405ae09f93 (origin/master, origin/HEAD) see https://snowdreams1006.github.io/git/usage/remote-repository.html
* 8e625640348a47ac922409a1ecb4c844385582aa add test.txt
* 9b196aab5bc87eeb11709c9eef35fca283e05c61 Initial commit
$ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/16648241-18162e54f036ca0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;git-merge-ff-dev-deleted.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;由此可见,快速前进模式一旦删除分支后就彻底丢失了分支的信息,即便是从提交历史中也找不到曾经存在的痕迹!&lt;/p&gt;
&lt;h2 id=&quot;分支策略&quot;&gt;分支策略&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;git&lt;/code&gt; 是分布式版本控制系统,同时鼓励大量使用分支,如此一来大量的分支该如何管理?&lt;br/&gt;实际开发中,建议准从以下原则进行分支管理:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;master&lt;/code&gt; 分支作为主干分支,负责对外提供服务,要求稳定可靠,因为应该专人负责更新维护.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dev&lt;/code&gt; 分支作为开发分支,取代 &lt;code&gt;master&lt;/code&gt; 分支的开发地位,积累到一定产出时再合并到 &lt;code&gt;master&lt;/code&gt; 分支.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;feature&lt;/code&gt; 分支作为新功能分支,根据实际情况动态创建,删除分支,并适时合并到 &lt;code&gt;dev&lt;/code&gt; 分支.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bugFixed&lt;/code&gt; 分支作为修复特定 bug 分支,可能由 &lt;code&gt;master&lt;/code&gt; 分支衍生而来,也可能由 &lt;code&gt;dev&lt;/code&gt; 分支衍生等等,修复后及时合并到原分支.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;custom&lt;/code&gt; 自定义分支,项目成员私有分支,由上级领导分配任务后各开发人员自行选择创建自己的分支,并根据实际情况决定合并到 &lt;code&gt;dev&lt;/code&gt; 分支或 &lt;code&gt;feature&lt;/code&gt; 等分支.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/16648241-796f6700ddc97aa4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;git-strategy.png&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;小结&quot;&gt;小结&lt;/h2&gt;
&lt;ul&gt;&lt;li&gt;快速前进模式(&lt;code&gt;git merge &amp;lt;name&amp;gt;&lt;/code&gt;)不保留分支合并历史,递归模式(&lt;code&gt;git merge --no-ff -m &amp;lt;remark&amp;gt; &amp;lt;name&amp;gt;&lt;/code&gt;)保留分支合并历史.&lt;/li&gt;
&lt;li&gt;制定大家都认同的分支管理原则,并严格准守规则.&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Wed, 20 Mar 2019 23:32:00 +0000</pubDate>
<dc:creator>snowdreams1006</dc:creator>
<og:description>默认情况下合并分支常常直接使用 命令,是最方便快速的合并方法.其实这种情况下 采用的是 模式,特点是删除分支后,会丢失分支信息,好像从来没存在该分支一样,而我们推荐的是 模式,能够保留分支的版本记录.</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/snowdreams1006/p/10569263.html</dc:identifier>
</item>
<item>
<title>微软XAML Studio - WPF, Sliverlight, Xamarin, UWP等技术开发者的福音 - Enjoy233</title>
<link>http://www.cnblogs.com/enjoy233/p/10569205.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/enjoy233/p/10569205.html</guid>
<description>&lt;p&gt;最近又在继续倒腾&lt;code&gt;WPF&lt;/code&gt;的项目，继续使用&lt;code&gt;Caliburn.Micro&lt;/code&gt;和&lt;code&gt;Xceed&lt;/code&gt;来堆代码。每次调试xaml上的binding，都有种要疯的赶脚。&lt;/p&gt;
&lt;p&gt;今天路过 &lt;a href=&quot;https://channel9.msdn.com/&quot; class=&quot;uri&quot;&gt;https://channel9.msdn.com/&lt;/a&gt; 浏览 &lt;code&gt;WPF&lt;/code&gt;相关的学习视频时，遇到微软推荐的相关视频 - &lt;a href=&quot;https://channel9.msdn.com/Shows/On-NET/Introducing-XAML-Studio&quot;&gt;XAML sutdio简介&lt;/a&gt;，好奇心使然，目测是和Visual Studio Code类似而强大的牛牛工具，就好好看完了视频。&lt;br/&gt;&lt;img src=&quot;https://www.cnblogs.com/images/cnblogs_com/enjoy233/1389971/o_xaml_studio.jpg&quot; alt=&quot;XAML studio&quot;/&gt;&lt;br/&gt;XAML sutdio是微软Garage实验小组的作品，其特色是为XAML提供了如下一些功能。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;XAML Studio包含以下功能：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;实时且可交互的预览窗口&lt;/li&gt;
&lt;li&gt;实时绑定和调试&lt;/li&gt;
&lt;li&gt;数据上下文编辑器&lt;/li&gt;
&lt;li&gt;自动保存和恢复文档&lt;/li&gt;
&lt;li&gt;智能感知&lt;/li&gt;
&lt;li&gt;文档工具箱&lt;/li&gt;
&lt;li&gt;对齐指南&lt;/li&gt;
&lt;li&gt;命名空间助手&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;下面结合XAML studio的界面对其进行详细介绍~&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.microsoft.com/en-us/garage/profiles/xaml-studio/&quot;&gt;XAML Studio&lt;/a&gt; 是微软Garage项目组的一个不依赖 Visual Studio而能快速创建&lt;code&gt;XAML&lt;/code&gt;UI原型、实时预览、调试数据绑定及其他更多功能的一个轻项目，其最新版本可从 &lt;a href=&quot;https://www.microsoft.com/en-us/p/xaml-studio/9ntls214tkmq?rtc=1&amp;amp;activetab=pivot:overviewtab&quot;&gt;Microsoft Store&lt;/a&gt; 进行安装，温馨提醒一下这个软件只能在&lt;code&gt;Windows 10&lt;/code&gt;及其以上版本的PC和Surface上使用。&lt;/p&gt;
&lt;h2 id=&quot;编辑器功能&quot;&gt;编辑器功能&lt;/h2&gt;
&lt;p&gt;XAML Studio的编辑器很像一个&quot;轻量级&quot;的Visual Studio，或者用VS Code来类比更合适。除了编辑器， 在左侧还有文件，数据源，调试和工具箱这几个选项。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i0.wp.com/poshtools.com/wp-content/uploads/2019/01/layout.png?resize=991%2C747&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;p&gt;编辑器的行为与您期望的一样。 您可以在底部向XAML添加控件，顶部预览面板会对更新做出响应。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i0.wp.com/poshtools.com/wp-content/uploads/2019/01/editing.gif?zoom=1.5&amp;amp;resize=720%2C546&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;p&gt;工具箱提供了一个可以搜索的控件列表，然后单击以插入到XAML中。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i1.wp.com/poshtools.com/wp-content/uploads/2019/01/rating.gif?zoom=1.5&amp;amp;resize=720%2C546&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;p&gt;与Visual Studio中的XAML编辑器不同，VS中的实时预览不提供任何类型的拖放体验。&lt;/p&gt;
&lt;h2 id=&quot;数据源功能&quot;&gt;数据源功能&lt;/h2&gt;
&lt;p&gt;你可以通过静态JSON或JSON REST API将数据绑定到XAML组件。&lt;/p&gt;
&lt;p&gt;要绑定到静态JSON，可以单击数据源窗格，然后直接在编辑器中输入JSON即可。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i2.wp.com/poshtools.com/wp-content/uploads/2019/01/data-binding.png?resize=991%2C748&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;p&gt;要绑定到REST API，可以单击数据源面板顶部的两个箭头以打开一个文本框，您可以在其中输入REST API。 输入REST API URI然后单击刷新按钮后，JSON将更新，XAML预览也将更新。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i2.wp.com/poshtools.com/wp-content/uploads/2019/01/rest-binding.png?resize=991%2C750&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;调试数据绑定&quot;&gt;调试数据绑定&lt;/h2&gt;
&lt;p&gt;调试功能允许你查看哪些数据绑定实际成功。 打开调试模式后，您将能够看到当前绑定以及可用绑定的历史记录。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i0.wp.com/poshtools.com/wp-content/uploads/2019/01/debugging.gif?zoom=1.5&amp;amp;resize=720%2C546&amp;amp;ssl=1&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;伟大的开始&quot;&gt;伟大的开始&lt;/h2&gt;
&lt;p&gt;我对这个工具的诞生感到很兴奋。 这看似是建立在VS Code和Monaco编辑器的基础上开发而来的，但它的特色是提供了一些便捷的功能。 我很乐意看到这里的绑定不能，不仅仅是英文这里使用了简洁的JSON数据，而是它现在就可以提供非常棒的绑定调试功能，而我知道目前的Visual Studio中还没提供这种功能。&lt;/p&gt;
&lt;h2 id=&quot;我们来一起实践吧&quot;&gt;我们来一起实践吧&lt;/h2&gt;
&lt;p&gt;我在编辑器中创建了一段这样的代码:&lt;/p&gt;
&lt;pre class=&quot;xaml&quot;&gt;
&lt;code&gt;&amp;lt;Page
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    xmlns:d=&quot;http://schemas.microsoft.com/expression/blend/2008&quot;
    xmlns:mc=&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;
    mc:Ignorable=&quot;d&quot;&amp;gt;

    &amp;lt;Grid Padding=&quot;40&quot;&amp;gt;
        &amp;lt;TextBlock&amp;gt;
            &amp;lt;Run FontSize=&quot;24&quot; Foreground=&quot;#FFFC5185&quot;&amp;gt;First demo using XAML Studio&amp;lt;/Run&amp;gt;&amp;lt;LineBreak/&amp;gt;
            &amp;lt;Run&amp;gt; Hello, Bravo.&amp;lt;/Run&amp;gt;
        &amp;lt;/TextBlock&amp;gt;
    &amp;lt;/Grid&amp;gt;
&amp;lt;/Page&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;上方立马就出现了代码预览~&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/436938/201903/436938-20190321023932808-816882570.png&quot; alt=&quot;code preview&quot;/&gt;&lt;br/&gt;知道&lt;code&gt;HTML&lt;/code&gt;的人都应该知道这里 &lt;code&gt;&amp;lt;Run&amp;gt;&lt;/code&gt;标签的作用，其实和HTML中的&lt;code&gt;&amp;lt;p&amp;gt;&lt;/code&gt;标签有点像，除此之外，其他的XAML部分和其他地方一样~&lt;/p&gt;
&lt;p&gt;好吧，请各位慢慢享用了~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;参考链接：&lt;/strong&gt;&lt;br/&gt;&lt;a href=&quot;https://visualstudiomagazine.com/articles/2019/01/23/xaml-studio.aspx&quot;&gt;Microsoft Garage's XAML Studio Does Real-Time UWP UI Changes -- Visual Studio Magazine&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.microsoft.com/en-us/garage/blog/2019/01/by-devs-for-devs-meet-new-garage-projects-xaml-studio-and-team-retrospectives/&quot;&gt;By devs, for devs: meet new Garage projects XAML Studio and Team Retrospectives - Microsoft Garage&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 20 Mar 2019 18:46:00 +0000</pubDate>
<dc:creator>Enjoy233</dc:creator>
<og:description>[TOC] 最近又在继续倒腾 的项目，继续使用 和`Xceed`来堆代码。每次调试xaml上的binding，都有种要疯的赶脚。 今天路过 浏览 相关的学习视频时，遇到微软推荐的相关视频 'XAML</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/enjoy233/p/10569205.html</dc:identifier>
</item>
<item>
<title>从小白到区块链工程师：第一阶段：Go语言的HelloWorld初始（2） - Rocky Ren</title>
<link>http://www.cnblogs.com/renyanlei/p/10569215.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/renyanlei/p/10569215.html</guid>
<description>&lt;h2 align=&quot;center&quot;&gt; &lt;/h2&gt;
&lt;h2 align=&quot;center&quot;&gt;四、写下第一段&lt;span lang=&quot;EN-US&quot;&gt;Go语言代码“&lt;span lang=&quot;EN-US&quot;&gt;Hello World”&lt;/span&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;小建议：就是文件夹路径或者文件名称不要出现中文，可能会导致一些不必要的麻烦（编译失败）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;在sublime中，我们在src文件夹上面，单击右键“New file”。新建一个go文件。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321022725096-763404183.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;将这个文件先保存为.go格式的源代码文件。保存的快捷键是Ctrl+S,或者是点击“file”à“save”。建议使用快捷键。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321022807990-2138755446.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h3 align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;1：代码详解&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;HelloWorld的代码框架如下。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt; &lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321022850219-1151100738.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;在控制台里面找到这个HelloWorld，并且执行结果如下所示：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321022903109-722011335.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;h3 align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;2：单行注释和多行注释&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;注释语法不参与程序的运行。他就是给我们的代码添加一个给程序员提示的信息。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;单行注释：//&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;多行注释(块注释)：/* */&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;在sublime里面的快捷键是“ctrl+/”。再按一下就是取消代码。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321022959432-1769398281.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2 align=&quot;center&quot;&gt;五、&lt;span lang=&quot;EN-US&quot;&gt;Go语言的变量学习&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;      计算机的应用程序，不管你电脑上安装的QQ音乐，还是看视频的暴风影音，还是浏览器本质上都是计算机上的一个应用程序，只要你运行起来。那么，这些应用程序里面的数据都是存储在计算机的内存中，无论你是在听歌（音频），看电影（视频），浏览网页（文字，图片，多媒体）数据一律都是在计算机的内存中保存，只要你关掉，应用程序，那么这些数据也就消失了。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023045471-1947690022.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;变量就是计算机程序在运行的过程中，可以被改变的数据，我们就称为变量。所有的变量都在程序的运行过程中，存储在内存中。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;内存其实就是一个存储数据的连续集合组织。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;每一个内存的存储空间都有一个独有的内存地址，这个地址上面对应着这一块内存的空间。（门牌号码对应着房间。）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;内存地址都是由一个16进制的无符号数据来表示的。（计算机能够识别的是二进制，八进制，十进制，十六进制等等）。一般一个内存地址是这样的。0x00000001，0x10100111,0x00110010&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023129289-826006105.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;      通过内存地址我们就可以对内存空间进行数据的取出来和放进去，但是内存的地址比较难记忆，所以我们在编程的过程中，可以给内存的地址起一个别名，这个别名容易记忆，我们可以对别名的操作来直接进行对内存数据的操作。&lt;/span&gt;&lt;/p&gt;
&lt;h3 align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;1:  变量的声明和定义&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;新建一个go文件，我们来学习，文件名为002变量的定义和使用.go。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023231764-406240902.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;num变量名是计算机内存地址的别称，num==0x010001112(假设)。这样的话方便我们操作内存的空间。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;改变一下变量的值看一下。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023307547-1513680764.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;这个时候打印出来的效果如下：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023341019-1364707266.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;原理：变量的值，可以做修改，nums本身的内存空间里面存放的是10，后来我们把num的内存空间重新赋值20这个数，这就意味着刚才存放的10倍删掉清除，里面只有心赋值的20。（注意：程序的执行时从上到下依次执行的。）&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023412115-1791451391.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 align=&quot;center&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;2：不同的数据类型&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;整型数据int。专门存放程序中的整型数据。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;浮点型数据float32和float64专门存放带有小数点的数据。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;布尔类型：专门存放“对”和“不对”两个数据。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;字符串数据：专门存放文本数据类型。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;不同的数据类型在内存中占据空间的大小不一样。类似于我们去酒店开房，你有几个人就安排多大的房子。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;我们先来了解一下float32这个类型。它是专门用来存放浮点数的也就是小数。计算圆的周长和面积。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023500148-1462869469.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;打印结果如下所示：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023529122-995219837.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;这套区块链开发课程，都有我自己讲解的配套视频课程。如果想要系统的学习区块链开发技术的朋友，可以和我一起交流。添加我请您备注&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;是从博客园看到的，谢谢。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/294888/201903/294888-20190321023713423-1716355025.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;

</description>
<pubDate>Wed, 20 Mar 2019 18:38:00 +0000</pubDate>
<dc:creator>Rocky Ren</dc:creator>
<og:description>四、写下第一段Go语言代码“Hello World” 小建议：就是文件夹路径或者文件名称不要出现中文，可能会导致一些不必要的麻烦（编译失败） 在sublime中，我们在src文件夹上面，单击右键“Ne</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/renyanlei/p/10569215.html</dc:identifier>
</item>
<item>
<title>3-6 Vue中的条件渲染 - 如花红茶</title>
<link>http://www.cnblogs.com/ytraister/p/10568048.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/ytraister/p/10568048.html</guid>
<description>&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;本次案例讲解：v-if，v-show，v-else，v-else-if和key值的相关用法！！！&lt;/span&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;v-if指令：&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320214555340-130001355.png&quot; alt=&quot;&quot;/&gt;&lt;/div&gt;
&lt;p&gt;//通过一个（v-if）指令 ，可以结合js表达式的返回值，决定一个标签是否在页面上展示或决定一个标签是否在页面上存在&lt;/p&gt;
&lt;p&gt;//显示效果如下：　　v-if指令并不会显示div标签　　&lt;span&gt;（为了显示效果明显，特意在此页面中给div的父级设置了粉色背景颜色，便于看出页面的改变）&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320215426479-235574170.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p&gt; //可以看到，调用v-if，设置为false后，div并不会显示出来。&lt;/p&gt;
&lt;p&gt;//当在控制台中，改变v-if的值为true后，div就显示出来了。如下图：&lt;/p&gt;
&lt;div readability=&quot;57&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320215904236-2118288460.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;//查看html代码，也有显示div标签内容了，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320220006268-1380378485.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

===========================================================&lt;p&gt;&lt;span&gt;&lt;strong&gt;v-show指令：&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320220945290-768341495.png&quot; alt=&quot;&quot;/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;//v-show和v-if的代码相似，只要改一下指令就行了。&lt;/p&gt;
&lt;p&gt;//v-show在页面中的显示效果如下：　　（v-show会把div的display属性显示为none的效果）&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320220915003-1989580061.png&quot; alt=&quot;&quot;/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt; //在控制台中设置v-show的值为true后，页面显示效果如下：　　（div标签的display属性消失了）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320221338300-1185760526.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;//综上，v-show指令和v-if指令的效果类似，都是让DOM元素显示或消失。但两者也有点区别：v-if设置的DOM元素只有设置的值为true，才会在页面中加载出来；而v-show设置的DOM元素与display有关，不管display属性的值为none还是block，都会直接显示在页面上，驻留在html代码之中，通过改变display的值来改变DOM元素的显示与否。所以v-show的效果会比v-if好，若要显示/隐藏一个DOM元素，选用v-show最佳&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;===========================================================&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span&gt;v-else指令：&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;注意：v-else中不需要添加js语法　　而且v-if和v-else需要连着用才行&lt;/p&gt;
&lt;div readability=&quot;11&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320224011107-1496785064.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;//因为show的值为false，所以v-if指令不会被执行，而会执行v-else指令，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320224234074-249540007.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;//当修改了show的值为true后，v-if指令就会触发显示，反之v-else指令就会消失了，如下图：&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320224423767-2069306567.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;===========================================================&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;v-else-if指令：&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;注意：同样的v-else-if需要和v-if和v-else一起连着用&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320225036713-486960987.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;//因为show的值设置为true，所以v-if指令会显示（This is A），如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320225325181-649436845.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;//当修改show的值后，v-if指令就没有被显示了，如下图：　　(修改show的值为b后，v-else-if指令就会显示出来；修改show的值为c后，v-else指令就会显示出来)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320225439840-1123576080.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;===========================================================&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;key值：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;编写新的Demo，代码如下：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320230346810-766337954.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;//运行代码效果如下：&lt;/p&gt;
&lt;p&gt; &lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190321001025976-1424346291.gif&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;//当把true的值设置为true，页面中会把邮箱名更改为用户名，但是表单（input）中的内容却没有清空。因为，Vue在重新渲染页面的时候，会尽量尝试去复用页面上已经存在的DOM。（即:当显示邮箱名的时候，已经有了一个input，当切换修改成用户名的时候，vue会发现以前页面上也有一个input，所以它的机制会尽量帮助我们复用页面上的DOM，它会尝试去复用input，而我们发现input是被复用了，但是input里面的内容却没有自动的清空）。所以为了解决这个效果，需要运用到 “key值”&lt;/p&gt;
&lt;p&gt;//添加key值，代码如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320232103580-1928448803.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;//运行代码后，效果如下：&lt;/p&gt;
&lt;p&gt; &lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190321001605620-1434571740.gif&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;//解释：当给某个元素标签一个key值，Vue会知道它是页面上唯一的元素，如果两个的key值不一样，就不会去尝试复用以前的input标签了，这是Vue中虚拟DOM的一个div算法里面用到的内容&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1575890/201903/1575890-20190320230958446-573066144.gif&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
<pubDate>Wed, 20 Mar 2019 16:16:00 +0000</pubDate>
<dc:creator>如花红茶</dc:creator>
<og:description>本次案例讲解：v-if，v-show，v-else，v-else-if和key值的相关用法！！！ v-if指令： //通过一个（v-if）指令 ，可以结合js表达式的返回值，决定一个标签是否在页面上展</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/ytraister/p/10568048.html</dc:identifier>
</item>
<item>
<title>Kali proxychains - MaxBlackTime</title>
<link>http://www.cnblogs.com/mwq1024/p/10568823.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/mwq1024/p/10568823.html</guid>
<description>&lt;p&gt;　&lt;span&gt;　1.什么是proxychains&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;　　&lt;span&gt;在linux系统中有很多软件是不支持代理的，但是proxychains 却可以让不支持代理的软件&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;也能走代理通道，支持HTTP，HTTPS,SOCKS4,SOCKS5,等多种代理协议，而且还能配置代理链&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;(可以理解成多重代理)，可以说是安全渗透的神器！&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;　&lt;span&gt;　2.什么是“强加密”代理、&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　&lt;span&gt;“强加密”代理指的是使用的一重代理，二重代理，多重代理中有一个代理是“强加密”&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;类型的那么该代理就是“强加密”代理。这样如果别人想要获得你的真实IP是很困难的。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;Tor就属于一种“强加密”代理，但是由于国内环境我们必须要进行前置代理，&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;所以我选择SSR+Tor的组合。&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;　　&lt;span&gt;3.在Kali上 proxychains有问题&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　Kali上的proxychains是3.*的版本，无法使用Tor代理。而在firefox中设置代理却能成功。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;使用必然是proxychains的原因。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　&lt;span&gt;4.解决办法&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　第一种办法：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　vi /etc/proxychains.conf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;把socks5代理改成socks4即可&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　如图&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320224007857-1401028265.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;200&quot;/&gt;&lt;/span&gt;&lt;/p&gt;


&lt;p&gt;　　&lt;span&gt;但是呢，socks4和socks5还是有区别的&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;SOCKS代理与其他类型的代理不同，它只是简单地传递数据包，而并不关心是何种应用协议，既可以是HTTP请求，&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;所以SOCKS代理服务器比其他类型的代理服务器速度要快得多。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;SOCKS代理又分为SOCKS4和SOCKS5&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;二者不同的是SOCKS4代理只支持TCP协议（即传输控制协议），而SOCKS5代理则既支持TCP协议又支持UDP协议&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;（即用户数据包协议），还支持各种身份验证机制、服务器端域名解析等。SOCK4能做到的SOCKS5都可得到，&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;但SOCKS5能够做到的SOCK4则不一定能做到，比如我们常用的聊天工具QQ在使用代理时就要求用SOCKS5代理，&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;因为它需要使用UDP协议来传输数据&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;　　第二个方法&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;卸载Kali上的proxychains 安装proxychains-ng(proxychains的升级版),&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;下载地址：https://sourceforge.net/projects/proxychains-ng/files/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;不建议使用命令行下载有点慢，建议浏览器下载。之后解压并在解压目录打开命令行。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;执行一下代码：&lt;/span&gt;&lt;/p&gt;

&lt;pre readability=&quot;8&quot;&gt;
./configure --prefix=/usr --sysconfdir=/etc
  make &amp;amp;&amp;amp; make install
  make install-config (installs proxychains.conf)&lt;p&gt;之后配置代理链&lt;br/&gt;vi /etc/proxychains.conf&lt;/p&gt;&lt;p&gt;配置完后 执行 proxychains firefox发现firefox代理正常&lt;br/&gt;之后执行     proxyresolv www.google.com 发现报错了
&lt;/p&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320225909867-1816617049.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;378&quot;/&gt;&lt;/p&gt;
&lt;p&gt;看到libproxychains.so.3应该是3.*版本没有卸载干净，动态库没更新&lt;/p&gt;
&lt;p&gt;解决方法如下&lt;/p&gt;
&lt;p&gt;首先在Kali的计算机目录搜索 proxychains 看一下更新后的动态库在那个目录&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320230403970-912942359.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;313&quot;/&gt;&lt;/p&gt;
&lt;p&gt;　　然后打开proxyresolv的配置文件&lt;/p&gt;
&lt;p&gt;　　vi /usr/bin/proxyresolv&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320230609323-90098886.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;418&quot;/&gt;&lt;/p&gt;
&lt;p&gt;把 LD_PRELOAD等号后面的路径改成proxychains4.so的路径 &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320230814117-2029304898.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;359&quot;/&gt;&lt;/p&gt;
&lt;p&gt; 测试一下&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1505586/201903/1505586-20190320231458414-1623432369.png&quot; alt=&quot;&quot; width=&quot;500&quot; height=&quot;391&quot;/&gt;&lt;/p&gt;

&lt;p&gt;没有报错！&lt;/p&gt;



</description>
<pubDate>Wed, 20 Mar 2019 15:16:00 +0000</pubDate>
<dc:creator>MaxBlackTime</dc:creator>
<og:description>1.什么是proxychains 在linux系统中有很多软件是不支持代理的，但是proxychains 却可以让不支持代理的软件 也能走代理通道，支持HTTP，HTTPS,SOCKS4,SOCKS5</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/mwq1024/p/10568823.html</dc:identifier>
</item>
<item>
<title>大数据项目之_15_电信客服分析平台_03&amp;04_数据分析 - 黑泽君</title>
<link>http://www.cnblogs.com/chenmingjun/p/10568720.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/chenmingjun/p/10568720.html</guid>
<description>&lt;p id=&quot;tocid_0&quot; class=&quot;toc&quot;&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h33&quot;&gt;3.3、数据分析&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h331mysql&quot;&gt;3.3.1、Mysql 表结构设计&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h332&quot;&gt;3.3.2、需求：按照不同的维度统计通话&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h333&quot;&gt;3.3.3、环境准备&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h334&quot;&gt;3.3.4、编写代码：数据分析&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h335&quot;&gt;3.3.5、运行测试&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;toc_item&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;span class=&quot;toc_left&quot;&gt;&lt;a href=&quot;http://www.cnblogs.com/chenmingjun/p/10568720.html#h336bug&quot;&gt;3.3.6、bug 解决&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;hr/&gt;&lt;h3 id=&quot;h33&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3、数据分析&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;  我们的数据已经完整的采集到了 HBase 集群中，这次我们需要对采集到的数据进行分析，统计出我们想要的结果。注意，在分析的过程中，我们不一定会采取一个业务指标对应一个 mapreduce-job 的方式，如果情景允许，我们会采取一个 mapreduce 分析多个业务指标的方式来进行任务。具体何时采用哪种方式，我们后续会详细探讨。&lt;/p&gt;
&lt;p&gt;  分析模块流程图：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLU1I.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;业务指标：&lt;br/&gt;  a) 用户每天主叫通话个数统计，通话时间统计。&lt;br/&gt;  b) 用户每月通话记录统计，通话时间统计。&lt;br/&gt;  c) 用户之间亲密关系统计。（通话次数与通话时间体现用户亲密关系）&lt;/p&gt;
&lt;h4 id=&quot;h331mysql&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.1、Mysql 表结构设计&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;  我们将分析的结果数据保存到 Mysql 中，以方便 Web 端进行查询展示。&lt;/p&gt;
&lt;p&gt;思路讨论：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLdjP.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;1) 表：&lt;code&gt;db_telecom.tb_call&lt;/code&gt;&lt;br/&gt;用于存放【某个查询人维度下】和【某个时间维度下】通话次数与通话时长的总和。&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLact.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;2) 表：&lt;code&gt;db_telecom.tb_contacts&lt;/code&gt;&lt;br/&gt;用于存放【查询人维度】的相关数据（用户手机号码与查询人姓名）。&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLN9A.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;3) 表：&lt;code&gt;db_telecom.tb_dimension_date&lt;/code&gt;&lt;br/&gt;用于存放【时间维度】的相关数据（年、月、日）。&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLYhd.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;4) 表：&lt;code&gt;db_telecom.tb_intimacy&lt;/code&gt;&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLDHS.png&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;用于存放所有用户【用户关系】的结果数据。（作业中使用）
&lt;h4 id=&quot;h332&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.2、需求：按照不同的维度统计通话&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;  根据需求目标，设计出如上表结构。我们需要按照查询人范围和时间范围（年月日），结合 MapReduce 统计出所属时间范围内所有手机号码的通话次数总和以及通话时长总和。&lt;/p&gt;
&lt;p&gt;思路：&lt;br/&gt;  a) 维度，即某个角度，某个视角，按照时间维度来统计通话，比如我想统计 2017 年所有月份所有日子的通话记录，那这个维度我们大概可以表述为 &lt;code&gt;2017 年*月*日&lt;/code&gt;。&lt;br/&gt;  b) 通过 Mapper 将数据按照不同维度聚合给 Reducer。&lt;br/&gt;  c) 通过 Reducer 拿到按照各个维度聚合过来的数据，进行汇总，输出。&lt;br/&gt;  d) 根据业务需求，将 Reducer 的输出通过 Outputformat 把数据输出到 Mysql。&lt;/p&gt;
&lt;p&gt;数据输入：HBase&lt;br/&gt;数据输出：Mysql&lt;/p&gt;
&lt;p&gt;HBase 中数据源结构：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlL0nf.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;思路：&lt;br/&gt;  a) 已知目标，那么需要结合目标思考已有数据是否能够支撑目标实现；&lt;br/&gt;  b) 根据目标数据结构，构建 Mysql 表结构，建表；&lt;br/&gt;  c) 思考代码需要涉及到哪些功能模块，建立不同功能模块对应的包结构。&lt;br/&gt;  d) 描述数据，一定是基于某个维度（视角）的，所以&lt;code&gt;构建维度类&lt;/code&gt;。比如按照“手机号码”与“年”的组合作为 key 聚合所有的数据，便可以统计这个手机号码，这一年的相关结果。&lt;br/&gt;  e) 自定义 OutputFormat 用于对接 Mysql，使数据输出。&lt;br/&gt;  f) 创建相关工具类。&lt;/p&gt;
&lt;p&gt;MySQL 结果表的创建&lt;/p&gt;
&lt;pre readability=&quot;22&quot;&gt;
&lt;code class=&quot;sql language-sql hljs&quot; readability=&quot;38&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;SET&lt;/span&gt; FOREIGN_KEY_CHECKS=&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;EXISTS&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_call`&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_call`&lt;/span&gt; (&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id_contact_date`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id_dimension_contact`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id_dimension_date`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`call_sum`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`call_duration_sum`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;PRIMARY &lt;span class=&quot;hljs-keyword&quot;&gt;KEY&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;`id_contact_date`&lt;/span&gt;)&lt;br/&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;CHARSET&lt;/span&gt;=utf8;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;EXISTS&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_dimension_contacts`&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_dimension_contacts`&lt;/span&gt; (&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt; AUTO_INCREMENT,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`telephone`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`name`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;PRIMARY &lt;span class=&quot;hljs-keyword&quot;&gt;KEY&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt;)&lt;br/&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;CHARSET&lt;/span&gt;=utf8;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;EXISTS&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_dimension_date`&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_dimension_date`&lt;/span&gt; (&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt; AUTO_INCREMENT,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`year`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`month`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`day`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;PRIMARY &lt;span class=&quot;hljs-keyword&quot;&gt;KEY&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt;)&lt;br/&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;CHARSET&lt;/span&gt;=utf8;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;EXISTS&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_intimacy`&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`tb_intimacy`&lt;/span&gt; (&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt; AUTO_INCREMENT,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`intimacy_rank`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`contact_id1`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`contact_id2`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`call_count`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;`call_duration_count`&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;NULL&lt;/span&gt;,&lt;br/&gt;PRIMARY &lt;span class=&quot;hljs-keyword&quot;&gt;KEY&lt;/span&gt; (&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt;)&lt;br/&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;InnoDB&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;CHARSET&lt;/span&gt;=utf8;&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;&lt;code&gt;注意&lt;/code&gt;：&lt;strong&gt;字段名为什么加反引号？&lt;/strong&gt;&lt;br/&gt; 答：因为 Mysql 中 sql 语法是不区分大小写的，而 Mysql 有一个优化机制，关键字用小写，表名和字段名用小写；关键字用大写，表名和字段名用大写；会提高 sql 执行的效率。&lt;br/&gt; 加反引号的意思是：不让其对字段进行大小写的优化。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使用 Navicat 创建数据库和表，如下：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLsAg.png&quot; alt=&quot;&quot;/&gt;&lt;h4 id=&quot;h333&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.3、环境准备&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;1) idea 中 新建 module：ct_analysis&lt;br/&gt;pom.xml 文件配置如下：&lt;/p&gt;
&lt;pre readability=&quot;12&quot;&gt;
&lt;code class=&quot;xml language-xml hljs&quot; readability=&quot;18&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-attr&quot;&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;p&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.china&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;ct_analysis&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project.build.sourceEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project.build.sourceEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;junit&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;junit&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;4.12&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;mysql&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;mysql-connector-java&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;5.1.27&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.hbase&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;hbase-client&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.3.1&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.hbase&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;hbase-server&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.3.1&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.12.4&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;skipTests&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;skipTests&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;2) 创建包结构，根包：com.china，如下图所示：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLBB8.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;3) 类表，如下图所示：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLyNQ.png&quot; alt=&quot;&quot;/&gt;&lt;h4 id=&quot;h334&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.4、编写代码：数据分析&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;1) 创建类：CountDurationMapper（数据分析的Mapper类，继承自 TableMapper）&lt;/p&gt;
&lt;pre readability=&quot;52.5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;99&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.mapper;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ComDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ContactDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.DateDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Result;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.io.ImmutableBytesWritable;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.mapreduce.TableMapper;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.util.Bytes;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.io.Text;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.HashMap;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationMapper&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;TableMapper&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;Text&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ComDimension comDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ComDimension();&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Text durationText = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Text();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;String, String&amp;gt; phoneNameMap = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Context context)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;phoneNameMap = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13242820024&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;李雁&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;14036178412&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;卫艺&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;16386074226&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;仰莉&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13943139492&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;陶欣悦&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;18714767399&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;施梅梅&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;14733819877&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;金虹霖&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13351126401&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;魏明艳&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13017498589&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;华贞&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;16058589347&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;华啟倩&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;18949811796&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;仲采绿&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13558773808&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;卫丹&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;14343683320&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;戚丽红&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13870632301&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;何翠柔&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13465110157&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;钱溶艳&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;15382018060&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;钱琳&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13231085347&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;缪静欣&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13938679959&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;焦秋菊&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;13779982232&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;吕访琴&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;18144784030&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;沈丹&quot;&lt;/span&gt;);&lt;br/&gt;phoneNameMap.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;18637946280&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;褚美丽&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(ImmutableBytesWritable key, Result value, Context context)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;String roeKey = Bytes.toString(value.getRow());&lt;/p&gt;&lt;p&gt;&lt;br/&gt;String[] splits = roeKey.split(&lt;span class=&quot;hljs-string&quot;&gt;&quot;_&quot;&lt;/span&gt;);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;String flag = splits[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;];&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (flag.equals(&lt;span class=&quot;hljs-string&quot;&gt;&quot;0&quot;&lt;/span&gt;)) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;String call1 = splits[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];&lt;br/&gt;String call2 = splits[&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;];&lt;br/&gt;String bulidTime = splits[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;];&lt;br/&gt;String duration = splits[&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;];&lt;/p&gt;&lt;p&gt;durationText.set(duration);&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; year = Integer.valueOf(bulidTime.substring(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;));&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; month = Integer.valueOf(bulidTime.substring(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;));&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; day = Integer.valueOf(bulidTime.substring(&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;));&lt;/p&gt;&lt;p&gt;&lt;br/&gt;DateDimension yearDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DateDimension(year, -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);&lt;br/&gt;DateDimension monthDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DateDimension(year, month, -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);&lt;br/&gt;DateDimension dayDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DateDimension(year, month, day);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;ContactDimension call1ContactDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ContactDimension(call1, phoneNameMap.get(call1)); &lt;br/&gt;ContactDimension call2ContactDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ContactDimension(call2, phoneNameMap.get(call2)); &lt;/p&gt;&lt;p&gt;&lt;br/&gt;comDimension.setContactDimension(call1ContactDimension);&lt;br/&gt;comDimension.setDateDimension(yearDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;br/&gt;comDimension.setDateDimension(monthDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;br/&gt;comDimension.setDateDimension(dayDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;comDimension.setContactDimension(call2ContactDimension);&lt;br/&gt;comDimension.setDateDimension(yearDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;br/&gt;comDimension.setDateDimension(monthDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;br/&gt;comDimension.setDateDimension(dayDimension);&lt;br/&gt;context.write(comDimension, durationText);&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;2) 创建类：CountDurationReducer（数据分析的Reducer类，继承自 Reduccer）&lt;/p&gt;
&lt;pre readability=&quot;16.5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;27&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.reducer;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ComDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.value.CountDurationValue;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.io.Text;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.mapreduce.Reducer;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationReducer&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Reducer&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;Text&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;CountDurationValue&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; CountDurationValue countDurationValue = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; CountDurationValue();&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(ComDimension key, Iterable&amp;lt;Text&amp;gt; values, Context context)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callSum = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callDurationSum = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Text text : values) {&lt;br/&gt;callSum++;&lt;br/&gt;callDurationSum += Integer.valueOf(text.toString());&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;countDurationValue.setCallSum(callSum);&lt;br/&gt;countDurationValue.setCallDurationSum(callDurationSum);&lt;/p&gt;&lt;p&gt;context.write(key, countDurationValue);&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;3) 创建类：CountDurationRunner（数据分析的驱动类，组装 Job）&lt;/p&gt;
&lt;pre readability=&quot;31.5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;57&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.runner;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ComDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.value.CountDurationValue;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.mapper.CountDurationMapper;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.outputformat.MySQLOutputFormat;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.reducer.CountDurationReducer;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.constants.Constants;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.conf.Configuration;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.HBaseConfiguration;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.TableName;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Admin;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Connection;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.ConnectionFactory;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Scan;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.io.Text;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.mapreduce.Job;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.util.Tool;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.util.ToolRunner;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationRunner&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Tool&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Configuration conf = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setConf&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Configuration conf)&lt;/span&gt; &lt;/span&gt;{           &lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.conf = HBaseConfiguration.create(conf);    &lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Configuration &lt;span class=&quot;hljs-title&quot;&gt;getConf&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.conf;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String[] strings)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;br/&gt;Job job = Job.getInstance(conf, &lt;span class=&quot;hljs-string&quot;&gt;&quot;CALLLOG_ANALYSIS&quot;&lt;/span&gt;);&lt;br/&gt;job.setJarByClass(CountDurationRunner.class);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;initHBaseInputConfig(job);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;initReducerOutputConfig(job);&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; job.waitForCompletion(&lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;) ? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;initHBaseInputConfig&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Job job)&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;Admin admin = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;conn = ConnectionFactory.createConnection(conf);&lt;br/&gt;admin = conn.getAdmin();&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!admin.tableExists(TableName.valueOf(Constants.SCAN_TABLE_NAME))) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;无法找到目标表&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;Scan scan = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Scan();&lt;br/&gt;&lt;/p&gt;&lt;p&gt;TableMapReduceUtil.initTableMapperJob(&lt;br/&gt;Constants.SCAN_TABLE_NAME,  &lt;br/&gt;scan,                       &lt;br/&gt;CountDurationMapper.class,  &lt;br/&gt;ComDimension.class,         &lt;br/&gt;Text.class,                 &lt;br/&gt;job,                        &lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;&lt;br/&gt;);&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (admin != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&lt;br/&gt;admin.close();&lt;br/&gt;}&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (conn != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; conn.isClosed()) {&lt;br/&gt;conn.close();&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;initReducerOutputConfig&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Job job)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;job.setReducerClass(CountDurationReducer.class);&lt;/p&gt;&lt;p&gt;job.setOutputKeyClass(ComDimension.class);&lt;br/&gt;job.setOutputValueClass(CountDurationValue.class);&lt;/p&gt;&lt;p&gt;job.setOutputFormatClass(MySQLOutputFormat.class);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; status = ToolRunner.run(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; CountDurationRunner(), args);&lt;br/&gt;System.exit(status);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (status == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {&lt;br/&gt;System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;运行成功&quot;&lt;/span&gt;);&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {&lt;br/&gt;System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;运行失败&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {&lt;br/&gt;System.out.println(&lt;span class=&quot;hljs-string&quot;&gt;&quot;运行失败&quot;&lt;/span&gt;);&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;&lt;code&gt;注意&lt;/code&gt;：&lt;strong&gt;conf默认是从resources中加载，加载文件的顺序是：core-default.xml -&amp;gt; core-site.xml -&amp;gt; hdfs-default.xml -&amp;gt; hdfs-site.xml -&amp;gt; hbase-default.xml -&amp;gt; hbase-site.xml&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;4) 创建类：MySQLOutputFormat（自定义 Outputformat，对接 Mysql）&lt;/p&gt;
&lt;pre readability=&quot;52.5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;99&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.outputformat;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.converter.impl.DimensionConverterImpl;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseValue;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ComDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.value.CountDurationValue;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.constants.Constants;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.utils.JDBCCacheBean;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.utils.JDBCUtil;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.fs.Path;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.mapreduce.*;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.Connection;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.PreparedStatement;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MySQLOutputFormat&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;OutputFormat&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;BaseValue&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; OutputCommitter committer = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; RecordWriter&amp;lt;BaseDimension, BaseValue&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;getRecordWriter&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TaskAttemptContext taskAttemptContext)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;conn = JDBCCacheBean.getInstance();&lt;br/&gt;conn.setAutoCommit(&lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;);&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; IOException(e);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; MysqlRecordWriter(conn);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;checkOutputSpecs&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(JobContext jobContext)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; OutputCommitter &lt;span class=&quot;hljs-title&quot;&gt;getOutputCommitter&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TaskAttemptContext taskAttemptContext)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (committer == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&lt;br/&gt;String name = taskAttemptContext.getConfiguration().get(FileOutputFormat.OUTDIR);&lt;br/&gt;Path outputPath = name == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; : &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Path(name);&lt;br/&gt;committer = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; FileOutputCommitter(outputPath, taskAttemptContext);&lt;br/&gt;}&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; committer;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MysqlRecordWriter&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;RecordWriter&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;BaseValue&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; DimensionConverterImpl dci = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; PreparedStatement ps = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String insertSQL = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; count = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; batchNumber = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MysqlRecordWriter&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Connection conn)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.conn = conn;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dci = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DimensionConverterImpl();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.batchNumber = Constants.JDBC_DEFAULT_BATCH_NUMBER;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension key, BaseValue value)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (insertSQL == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&lt;br/&gt;insertSQL = &lt;span class=&quot;hljs-string&quot;&gt;&quot;INSERT INTO `tb_call` (`id_contact_date`, `id_dimension_contact`, `id_dimension_date`, `call_sum`, `call_duration_sum`) VALUES (?, ?, ?, ?, ?) ON DUPLICATE KEY UPDATE `id_contact_date`=?;&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (ps == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&lt;br/&gt;ps = conn.prepareStatement(insertSQL);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;ComDimension comDimension = (ComDimension) key;&lt;br/&gt;CountDurationValue countDurationValue = (CountDurationValue) value;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id_dimension_contact = dci.getDimensionId(comDimension.getContactDimension());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id_dimension_date = dci.getDimensionId(comDimension.getDateDimension());&lt;/p&gt;&lt;p&gt;String id_contact_date = id_dimension_contact + &lt;span class=&quot;hljs-string&quot;&gt;&quot;_&quot;&lt;/span&gt; + id_dimension_date;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; call_sum = countDurationValue.getCallSum();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; call_duration_sum = countDurationValue.getCallDurationSum();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;ps.setString(++i, id_contact_date);&lt;br/&gt;ps.setInt(++i, id_dimension_contact);&lt;br/&gt;ps.setInt(++i, id_dimension_date);&lt;br/&gt;ps.setInt(++i, call_sum);&lt;br/&gt;ps.setInt(++i, call_duration_sum);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;ps.setString(++i, id_contact_date);&lt;/p&gt;&lt;p&gt;ps.addBatch();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;count++;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (count &amp;gt;= &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.batchNumber) {&lt;br/&gt;ps.executeBatch();&lt;br/&gt;conn.commit();&lt;br/&gt;count = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(TaskAttemptContext taskAttemptContext)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (ps != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) {&lt;br/&gt;ps.executeBatch();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.conn.commit();&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt; {&lt;br/&gt;JDBCUtil.close(conn, ps, &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;5) 创建类：BaseDimension（维度（key）基类，为了便于扩展）&lt;/p&gt;
&lt;pre readability=&quot;5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;4&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.base;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.io.WritableComparable;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;WritableComparable&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt;&amp;gt; &lt;/span&gt;{}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;6) 创建类：BaseValue（值（value）基类，为了便于扩展）&lt;/p&gt;
&lt;pre readability=&quot;5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;4&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.base;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.io.Writable;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseValue&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Writable&lt;/span&gt; &lt;/span&gt;{}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;7) 创建类：ContactDimension（联系人维度，封装 Mapper 输出的 key）&lt;/p&gt;
&lt;pre readability=&quot;33&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;60&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.key;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataInput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataOutput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ContactDimension&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String telephone;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String name;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ContactDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ContactDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String telephone, String name)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.telephone = telephone;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.name = name;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; id;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id = id;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;getTelephone&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; telephone;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setTelephone&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String telephone)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.telephone = telephone;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; name;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String name)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.name = name;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; == o) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || getClass() != o.getClass()) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;ContactDimension that = (ContactDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (telephone != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? !telephone.equals(that.telephone) : that.telephone != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; name != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? name.equals(that.name) : that.name == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hashCode&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = telephone != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? telephone.hashCode() : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;result = &lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt; * result + (name != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? name.hashCode() : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;compareTo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;ContactDimension anotherContactDimension = (ContactDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = Integer.compare(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id, anotherContactDimension.getId());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result= &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.telephone.compareTo(anotherContactDimension.getTelephone());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.name.compareTo(anotherContactDimension.getName());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataOutput dataOutput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;dataOutput.writeInt(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id);&lt;br/&gt;dataOutput.writeUTF(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.telephone);&lt;br/&gt;dataOutput.writeUTF(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.name);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;readFields&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataInput dataInput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id = dataInput.readInt();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.telephone = dataInput.readUTF();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.name = dataInput.readUTF();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;ContactDimension{&quot;&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;id=&quot;&lt;/span&gt; + id +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, telephone='&quot;&lt;/span&gt; + telephone + &lt;span class=&quot;hljs-string&quot;&gt;'\''&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, name='&quot;&lt;/span&gt; + name + &lt;span class=&quot;hljs-string&quot;&gt;'\''&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'}'&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;8) 创建类：DateDimension（时间维度，封装 Mapper 输出的 key）&lt;/p&gt;
&lt;pre readability=&quot;37&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;68&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.key;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataInput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataOutput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DateDimension&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; year;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; month;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; day;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DateDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DateDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; year, &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; month, &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; day)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.year = year;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.month = month;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day = day;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; id;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id = id;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getYear&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; year;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setYear&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; year)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.year = year;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getMonth&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; month;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setMonth&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; month)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.month = month;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getDay&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; day;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setDay&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; day)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day = day;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; == o) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || getClass() != o.getClass()) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;DateDimension that = (DateDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (year != that.year) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (month != that.month) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; day == that.day;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hashCode&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = year;&lt;br/&gt;result = &lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt; * result + month;&lt;br/&gt;result = &lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt; * result + day;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;compareTo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;DateDimension anotherDateDimension = (DateDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = Integer.compare(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id, anotherDateDimension.getId());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result = Integer.compare(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.year, anotherDateDimension.getYear());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result = Integer.compare(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.month, anotherDateDimension.getMonth());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result = Integer.compare(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day, anotherDateDimension.getDay());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataOutput dataOutput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;dataOutput.writeInt(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id);&lt;br/&gt;dataOutput.writeInt(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.year);&lt;br/&gt;dataOutput.writeInt(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.month);&lt;br/&gt;dataOutput.writeInt(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;readFields&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataInput dataInput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.id = dataInput.readInt();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.year = dataInput.readInt();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.month = dataInput.readInt();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day = dataInput.readInt();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;DateDimension{&quot;&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;id=&quot;&lt;/span&gt; + id +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, year=&quot;&lt;/span&gt; + year +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, month=&quot;&lt;/span&gt; + month +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, day=&quot;&lt;/span&gt; + day +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'}'&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;9) 创建类：ComDimension（时间维度+联系人维度的组合维度，封装 Mapper 输出的 组合key）&lt;/p&gt;
&lt;pre readability=&quot;31&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;56&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.key;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataInput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataOutput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseDimension&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ContactDimension contactDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ContactDimension();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; DateDimension dateDimension = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DateDimension();&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ComDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(ContactDimension contactDimension, DateDimension dateDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.contactDimension = contactDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateDimension = dateDimension;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ContactDimension &lt;span class=&quot;hljs-title&quot;&gt;getContactDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; contactDimension;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setContactDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(ContactDimension contactDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.contactDimension = contactDimension;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; DateDimension &lt;span class=&quot;hljs-title&quot;&gt;getDateDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dateDimension;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setDateDimension&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DateDimension dateDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateDimension = dateDimension;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; == o) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (o == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || getClass() != o.getClass()) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;ComDimension that = (ComDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (contactDimension != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? !contactDimension.equals(that.contactDimension) : that.contactDimension != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;)&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;false&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dateDimension != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? dateDimension.equals(that.dateDimension) : that.dateDimension == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hashCode&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = contactDimension != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? contactDimension.hashCode() : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;result = &lt;span class=&quot;hljs-number&quot;&gt;31&lt;/span&gt; * result + (dateDimension != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; ? dateDimension.hashCode() : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;compareTo&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension o)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; == o) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;ComDimension anotherComDimension = (ComDimension) o;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateDimension.compareTo(anotherComDimension.getDateDimension());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;/p&gt;&lt;p&gt;result = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.contactDimension.compareTo(anotherComDimension.getContactDimension());&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataOutput dataOutput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.contactDimension.write(dataOutput);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateDimension.write(dataOutput);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;readFields&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataInput dataInput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.contactDimension.readFields(dataInput);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateDimension.readFields(dataInput);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;ComDimension{&quot;&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;contactDimension=&quot;&lt;/span&gt; + contactDimension +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, dateDimension=&quot;&lt;/span&gt; + dateDimension +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'}'&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;10) 创建类：CountDurationValue（通话次数与通话时长的封装，封装 Reducer 输出的 value）&lt;/p&gt;
&lt;pre readability=&quot;19&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;32&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.kv.value;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseValue;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataInput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.DataOutput;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationValue&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;BaseValue&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callSum;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callDurationSum;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CountDurationValue&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callSum, &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callDurationSum)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callSum = callSum;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callDurationSum = callDurationSum;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getCallSum&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; callSum;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setCallSum&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callSum)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callSum = callSum;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getCallDurationSum&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; callDurationSum;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setCallDurationSum&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; callDurationSum)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callDurationSum = callDurationSum;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataOutput dataOutput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;dataOutput.writeInt(callSum);&lt;br/&gt;dataOutput.writeInt(callDurationSum);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;readFields&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(DataInput dataInput)&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callSum = dataInput.readInt();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.callDurationSum = dataInput.readInt();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;CountDurationValue{&quot;&lt;/span&gt; +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;callSum=&quot;&lt;/span&gt; + callSum +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;, callDurationSum=&quot;&lt;/span&gt; + callDurationSum +&lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'}'&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;11) 创建类：JDBCUtil（封装 JDBC 和 关闭数据库连接资源操作）&lt;/p&gt;
&lt;pre readability=&quot;17&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;28&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.utils;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.*;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;JDBCUtil&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; String MYSQL_DRIVER_CLASS = &lt;span class=&quot;hljs-string&quot;&gt;&quot;com.mysql.jdbc.Driver&quot;&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; String MYSQL_URL = &lt;span class=&quot;hljs-string&quot;&gt;&quot;jdbc:mysql://hadoop102:3306/db_telecom?userUnicode=true&amp;amp;characterEncoding=UTF-8&quot;&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; String MYSQL_USERNAME = &lt;span class=&quot;hljs-string&quot;&gt;&quot;root&quot;&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; String MYSQL_PASSWORD = &lt;span class=&quot;hljs-string&quot;&gt;&quot;123456&quot;&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Connection &lt;span class=&quot;hljs-title&quot;&gt;getConnection&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;Class.forName(MYSQL_DRIVER_CLASS);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; DriverManager.getConnection(MYSQL_URL, MYSQL_USERNAME, MYSQL_PASSWORD);&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (ClassNotFoundException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Connection conn, Statement stat, ResultSet rs)&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (rs != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !rs.isClosed()) {&lt;br/&gt;rs.close();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (stat != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !stat.isClosed()) {&lt;br/&gt;stat.close();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (conn != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !conn.isClosed()) {&lt;br/&gt;conn.close();&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;12) 创建类：JDBCCacheBean（单例 JDBC 连接器）&lt;/p&gt;
&lt;pre readability=&quot;9.5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;13&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.utils;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.Connection;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;JDBCCacheBean&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;JDBCCacheBean&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Connection &lt;span class=&quot;hljs-title&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (conn == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || conn.isClosed() || conn.isValid(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;)) {&lt;br/&gt;conn = JDBCUtil.getConnection();&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; conn;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;13) 创建类：DimensionConverter&lt;/p&gt;
&lt;pre readability=&quot;6&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;6&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.converter;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DimensionConverter&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getDimensionId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension baseDimension)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;14) 创建类：DimensionConverterImpl&lt;/p&gt;
&lt;pre readability=&quot;58&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;110&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.analysis.converter.impl;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.converter.DimensionConverter;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.base.BaseDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.ContactDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.analysis.kv.key.DateDimension;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.utils.JDBCCacheBean;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.utils.JDBCUtil;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.china.utils.LRUCache;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.slf4j.Logger;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.slf4j.LoggerFactory;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.Connection;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.PreparedStatement;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.ResultSet;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DimensionConverterImpl&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DimensionConverter&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Logger looger = LoggerFactory.getLogger(DimensionConverterImpl.class); &lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ThreadLocal&amp;lt;Connection&amp;gt; threadLocalConnection = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ThreadLocal&amp;lt;&amp;gt;();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; LRUCache&amp;lt;String, Integer&amp;gt; lruCache = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; LRUCache&amp;lt;&amp;gt;(&lt;span class=&quot;hljs-number&quot;&gt;3000&lt;/span&gt;);&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DimensionConverterImpl&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;looger.info(&lt;span class=&quot;hljs-string&quot;&gt;&quot;stopping mysql connection ...&quot;&lt;/span&gt;);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;Runtime.getRuntime().addShutdownHook(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Thread(() -&amp;gt; JDBCUtil.close(threadLocalConnection.get(), &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;)));&lt;/p&gt;&lt;p&gt;looger.info(&lt;span class=&quot;hljs-string&quot;&gt;&quot;mysql connection is successful closed&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getDimensionId&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension baseDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;String cackeKey = genCacheKey(baseDimension);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (lruCache.containsKey(cackeKey)) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; lruCache.get(cackeKey);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;String[] sqls = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; DateDimension) {&lt;br/&gt;sqls = genDateDimensionSQL();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; ContactDimension) {&lt;br/&gt;sqls = genContactDimensionSQL();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Cannot match the dimession, unknown dimension.&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.getConnection();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; id = -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;) {&lt;br/&gt;id = execSQL(conn, sqls, baseDimension);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;lruCache.put(cackeKey, id);&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; id;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Connection &lt;span class=&quot;hljs-title&quot;&gt;getConnection&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;Connection conn = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;conn = threadLocalConnection.get();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (conn == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || conn.isClosed() || conn.isValid(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;)) {&lt;br/&gt;conn = JDBCCacheBean.getInstance();&lt;br/&gt;}&lt;br/&gt;threadLocalConnection.set(conn);&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; conn;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;execSQL&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Connection conn, String[] sqls, BaseDimension baseDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;PreparedStatement ps = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;ResultSet rs = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;ps = conn.prepareStatement(sqls[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);&lt;br/&gt;setArguments(ps, baseDimension);&lt;br/&gt;rs = ps.executeQuery();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (rs.next()) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; rs.getInt(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); &lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;ps = conn.prepareStatement(sqls[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);&lt;br/&gt;setArguments(ps, baseDimension);&lt;br/&gt;ps.executeUpdate();&lt;/p&gt;&lt;p&gt;&lt;br/&gt;JDBCUtil.close(&lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;, ps, rs);&lt;/p&gt;&lt;p&gt;&lt;br/&gt;ps = conn.prepareStatement(sqls[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);&lt;br/&gt;setArguments(ps, baseDimension);&lt;br/&gt;rs = ps.executeQuery();&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (rs.next()) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; rs.getInt(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); &lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt; {&lt;br/&gt;JDBCUtil.close(&lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;, ps, rs);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Failed to get id!&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setArguments&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(PreparedStatement ps, BaseDimension baseDimension)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt;  DateDimension) {&lt;br/&gt;DateDimension dateDimension = (DateDimension) baseDimension;&lt;br/&gt;ps.setInt(++i, dateDimension.getYear());&lt;br/&gt;ps.setInt(++i, dateDimension.getMonth());&lt;br/&gt;ps.setInt(++i, dateDimension.getDay());&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt;  ContactDimension) {&lt;br/&gt;ContactDimension contactDimension = (ContactDimension) baseDimension;&lt;br/&gt;ps.setString(++i, contactDimension.getTelephone());&lt;br/&gt;ps.setString(++i, contactDimension.getName());&lt;br/&gt;}&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {&lt;br/&gt;e.printStackTrace();&lt;br/&gt;}&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String[] genContactDimensionSQL() {&lt;br/&gt;String query = &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT `id` FROM `tb_dimension_contacts` WHERE `telephone`=? AND `name`=? ORDER BY `id`;&quot;&lt;/span&gt;;&lt;br/&gt;String insert = &lt;span class=&quot;hljs-string&quot;&gt;&quot;INSERT INTO `tb_dimension_contacts` (`telephone`, `name`) VALUES (?, ?);&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; String[]{query, insert};&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String[] genDateDimensionSQL() {&lt;br/&gt;String query = &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT `id` FROM `tb_dimension_date` WHERE `year`=? AND `month`=? AND `day`=? ORDER BY `id`;&quot;&lt;/span&gt;;&lt;br/&gt;String insert = &lt;span class=&quot;hljs-string&quot;&gt;&quot;INSERT INTO `tb_dimension_date` (`year`, `month`, `day`) VALUES (?, ?, ?);&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; String[]{query, insert};&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String &lt;span class=&quot;hljs-title&quot;&gt;genCacheKey&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BaseDimension baseDimension)&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;StringBuilder sb = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; StringBuilder();&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; DateDimension) {&lt;br/&gt;DateDimension dateDimension = (DateDimension) baseDimension;&lt;br/&gt;sb.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;date_dimension&quot;&lt;/span&gt;);&lt;br/&gt;sb.append(dateDimension.getYear()).append(dateDimension.getMonth()).append(dateDimension.getDay());&lt;br/&gt;} &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (baseDimension &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; ContactDimension) {&lt;br/&gt;ContactDimension contactDimension = (ContactDimension) baseDimension;&lt;br/&gt;sb.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;contact_dimension&quot;&lt;/span&gt;);&lt;br/&gt;sb.append(contactDimension.getTelephone()).append(contactDimension.getName());&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (sb.length() &amp;lt;= &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Cannot create cacheKey.&quot;&lt;/span&gt; + baseDimension);&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sb.toString();&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;15) 创建类：LRUCache&lt;/p&gt;
&lt;pre readability=&quot;12&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;18&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.utils;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.LinkedHashMap;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; java.util.Map;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;LRUCache&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;K&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;V&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;K&lt;/span&gt;, &lt;span class=&quot;hljs-title&quot;&gt;V&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;long&lt;/span&gt; serialVersionUID = &lt;span class=&quot;hljs-number&quot;&gt;1L&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; maxElements;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;LRUCache&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; maxSize)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;super&lt;/span&gt;(maxSize, &lt;span class=&quot;hljs-number&quot;&gt;0.75F&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;);&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.maxElements = maxSize;&lt;br/&gt;}&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;removeEldestEntry&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Map.Entry&amp;lt;K, V&amp;gt; eldest)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.size() &amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.maxElements;&lt;br/&gt;}&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;16) 创建类：Constants（常量类）&lt;/p&gt;
&lt;pre readability=&quot;5&quot;&gt;
&lt;code class=&quot;java language-java hljs&quot; readability=&quot;4&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;package&lt;/span&gt; com.china.constants;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Constants&lt;/span&gt; &lt;/span&gt;{&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; JDBC_DEFAULT_BATCH_NUMBER = &lt;span class=&quot;hljs-number&quot;&gt;500&lt;/span&gt;;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; String SCAN_TABLE_NAME = &lt;span class=&quot;hljs-string&quot;&gt;&quot;ns_ct:calllog&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;h335&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.5、运行测试&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;0) 将 core-site.xml、hdfs-site.xml、log4j.properties、hbase-site.xml 拷贝到 \ct\ct_analysis\src\main\resources 目录下&lt;/p&gt;
&lt;p&gt;1) 在 hadoop-env.sh 添加内容：&lt;/p&gt;
&lt;pre readability=&quot;4&quot;&gt;
&lt;code class=&quot;hljs ruby&quot; readability=&quot;2&quot;&gt;[atguigu@hadoop102 hadoop]$ pwd&lt;br/&gt;/opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hadoop&lt;/span&gt;-2.7.2/&lt;span class=&quot;hljs-title&quot;&gt;etc&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hadoop&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;[atguigu@hadoop102 hadoop]$ vim hadoop-env.sh&lt;p&gt;export HADOOP_CLASSPATH=$HADOOP_CLASSPATH&lt;span class=&quot;hljs-symbol&quot;&gt;:/opt/module/hbase/lib/*&lt;/span&gt;&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;注意&lt;/code&gt;：&lt;strong&gt;修改配置后，需要配置分发，然后重启集群，方可生效！！！&lt;/strong&gt;&lt;br/&gt;&lt;code&gt;注意&lt;/code&gt;：&lt;strong&gt;修改配置后，需要配置分发，然后重启集群，方可生效！！！&lt;/strong&gt;&lt;br/&gt;&lt;code&gt;注意&lt;/code&gt;：&lt;strong&gt;修改配置后，需要配置分发，然后重启集群，方可生效！！！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;2) 将 mysql 驱动包放入到 /opt/module/flume/job/ct/lib 测试目录下&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs ruby&quot;&gt;[atguigu@hadoop102 ct]$ pwd&lt;br/&gt;/opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;flume&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;job&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;ct&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;[atguigu@hadoop102 ct]$ cp -a /opt/software/mysql-libs/mysql-connector-java-&lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;27&lt;/span&gt;/mysql-connector-java-&lt;span class=&quot;hljs-number&quot;&gt;5.1&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;27&lt;/span&gt;-bin.jar ./lib/&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;3) 将要运行的 ct_analysis-1.0-SNAPSHOT.jar 拷贝至 /opt/module/hbase/lib 目录下，然后同步到其他机器或者配置分发&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs ruby&quot;&gt;[atguigu@hadoop102 ~]$ scp -r /opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hbase&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;ct_analysis&lt;/span&gt;-1.0-&lt;span class=&quot;hljs-title&quot;&gt;SNAPSHOT&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hadoop103&lt;/span&gt;:/&lt;span class=&quot;hljs-title&quot;&gt;opt&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hbase&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;/span&gt;&lt;br/&gt;[atguigu@hadoop102 ~]$ scp -r /opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hbase&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;ct_analysis&lt;/span&gt;-1.0-&lt;span class=&quot;hljs-title&quot;&gt;SNAPSHOT&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;hadoop104&lt;/span&gt;:/&lt;span class=&quot;hljs-title&quot;&gt;opt&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hbase&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;/span&gt;&lt;br/&gt;或者&lt;br/&gt;[atguigu@hadoop102 ~]$ xsync /opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hbase&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;ct_analysis&lt;/span&gt;-1.0-&lt;span class=&quot;hljs-title&quot;&gt;SNAPSHOT&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;4) 提交任务&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs ruby&quot;&gt;[atguigu@hadoop102 ct]$ pwd&lt;br/&gt;/opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;flume&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;job&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;ct&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;[atguigu@hadoop102 ct]$ /opt/&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;hadoop&lt;/span&gt;-2.7.2/&lt;span class=&quot;hljs-title&quot;&gt;bin&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;yarn&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt; ./&lt;span class=&quot;hljs-title&quot;&gt;ct_analysis&lt;/span&gt;-1.0-&lt;span class=&quot;hljs-title&quot;&gt;SNAPSHOT&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;com&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;china&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;analysis&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;runner&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;CountDurationRunner&lt;/span&gt; -&lt;span class=&quot;hljs-title&quot;&gt;libjars&lt;/span&gt; ./&lt;span class=&quot;hljs-title&quot;&gt;lib&lt;/span&gt;/&lt;span class=&quot;hljs-title&quot;&gt;mysql&lt;/span&gt;-&lt;span class=&quot;hljs-title&quot;&gt;connector&lt;/span&gt;-&lt;span class=&quot;hljs-title&quot;&gt;java&lt;/span&gt;-5.1.27-&lt;span class=&quot;hljs-title&quot;&gt;bin&lt;/span&gt;.&lt;span class=&quot;hljs-title&quot;&gt;jar&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;5) 观察 Mysql 中的结果：&lt;/p&gt;
&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlL4BT.png&quot; alt=&quot;&quot;/&gt;&lt;br/&gt;简单测试下数据：&lt;br/&gt;&lt;img title=&quot;&quot; src=&quot;https://s2.ax1x.com/2019/03/20/AlLWj0.png&quot; alt=&quot;&quot;/&gt;&lt;h4 id=&quot;h336bug&quot;&gt;&lt;span&gt;&lt;strong&gt;3.3.6、bug 解决&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;ul&gt;&lt;li&gt;&lt;span&gt;1、Mysql 连接的 URL 中加入了数据库，所以后边的表就不能使用：【数据库.表名】这样的形式了。&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;2、-libjars 这个属性，必须显示的指定到具体的 Mysql 驱动包的位置。&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;3、自己写的代码 ct_analysis.jar 类找不到，原因是因为该 jar 包没有添加到 hadoop 的 classpath 中。
&lt;ul&gt;&lt;li&gt;解决方案：将该 jar 包 拷贝到 HBase 的 lib 目录下（`注意`：&lt;strong&gt;添加 jar 后需要分发并重启 Hbase 集群&lt;/strong&gt;）。&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Wed, 20 Mar 2019 15:04:00 +0000</pubDate>
<dc:creator>黑泽君</dc:creator>
<og:description>3.3、数据分析3.3.1、Mysql 表结构设计3.3.2、需求：按照不同的维度统计通话3.3.3、环境准备3.3.4、编写代码：数据分析3.3.5、运行测试3.3.6、bug 解决 3.3、数据分</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/chenmingjun/p/10568720.html</dc:identifier>
</item>
<item>
<title>机器学习中的那些树——决策树(一) - iTryagain</title>
<link>http://www.cnblogs.com/csu-lmw/p/10567896.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/csu-lmw/p/10567896.html</guid>
<description>&lt;p&gt;从零基础开始参加了几场数据挖掘方面的比赛，每次比赛都会学到不少东西，自从上次在 &lt;code&gt;elo&lt;/code&gt; 的 kernel 中看见很多人都使用 &lt;code&gt;LightGBM、XGBoost&lt;/code&gt;，那之后我也开始用起了这些，但是却从未花时间去了解过这是究竟是什么，其内部工作原理是怎么样的，正好这段时间在参加&lt;code&gt;df平台&lt;/code&gt;的&lt;code&gt;消费者人群画像—信用智能评分&lt;/code&gt;这一比赛，做起了调参，但因为对其内部并不是很收悉，便准备好好学习有关树模型方面的内容，并写下这系列的博客。这里将从最基础的决策树开始讲起。&lt;/p&gt;

&lt;p&gt;决策树（decision tree）是一类常见的机器学习方法。类似于流程图，一颗决策树包含一个根节点、若干个内部节点和叶子节点，每一个树节点表示对一个特征或属性的测试，每一个分支代表一个属性的输出，每一个叶子节点对应一种决策结果。从根节点到每个叶节点的路径对应了一个判定测试序列。其学习的基本流程遵循分治（divide-and-conquer）策略。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;输入：&lt;/strong&gt;训练集&lt;span class=&quot;math inline&quot;&gt;\(D=\{(x_1,y_1),(x_2,y_2),... ,(x_n,y_n)\}\)&lt;/span&gt;&lt;br/&gt;属性集&lt;span class=&quot;math inline&quot;&gt;\(A=\{a_1,a_2,...,a_n\}\\\)&lt;/span&gt;&lt;br/&gt;&lt;strong&gt;过程：&lt;/strong&gt;函数&lt;span class=&quot;math inline&quot;&gt;\(TreeGenerate(D,A)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(1：生成节点 node;\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(2：if\)&lt;/span&gt; $ D $ $ 中样本全属于同一类别$ $ C$ $ then$&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(3：\quad将\)&lt;/span&gt; $ node$ &lt;span class=&quot;math inline&quot;&gt;\(标 记为\)&lt;/span&gt; $ C$ $ 类叶节点;$ $ return$&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(4：end\)&lt;/span&gt; $ if$&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(5：if\)&lt;/span&gt; $ A=\emptyset $ $ OR$ $ D$ $ 中样本在A上取值相同$ $ then $&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(6：\quad 将node标记为叶节点，其类别标记为D中样本数最多的类；then\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(7：end\)&lt;/span&gt; &lt;span class=&quot;math inline&quot;&gt;\(if\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(8:从A中选择最优划分属性\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;$9：for $ $ a_* $ &lt;span class=&quot;math inline&quot;&gt;\(的每一个值\)&lt;/span&gt; $ a_{*}^{v}$ $ do$&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(10:\quad 为node生成一个分支；令D_v表示D中在a_*上取值为a_{*}^{v} 的样本子集：\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;$11:\quad if $ &lt;span class=&quot;math inline&quot;&gt;\(D_v\)&lt;/span&gt; &lt;span class=&quot;math inline&quot;&gt;\(为空\)&lt;/span&gt; &lt;span class=&quot;math inline&quot;&gt;\(then\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(12：\quad\quad将分支节点标记为叶节点，其类别标记为D中样本最多的类；return\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(13：\quad else\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(14：\quad\quad以TreeGenerate(D_v,A\)&lt;/span&gt;  &lt;span class=&quot;math inline&quot;&gt;\(\{a_*\})为分支节点\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(15：\quad end\)&lt;/span&gt; &lt;span class=&quot;math inline&quot;&gt;\(if\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(16：end\)&lt;/span&gt; &lt;span class=&quot;math inline&quot;&gt;\(for\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;输出：&lt;/strong&gt;以&lt;span class=&quot;math inline&quot;&gt;\(node\)&lt;/span&gt;为节点的一颗决策树&lt;/p&gt;

&lt;p&gt;从上面的算法中可以看出，最重要的一步就是第8行选取最优划分，但我们该如何选取最优划分呢？这里就涉及到了信息增益的概念。在讲解信息增益前，先来了解了解信息熵和条件熵。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;信息熵&lt;/code&gt;（information entropy）是度量样本集合纯度最常用的一种指标，它可以衡量一个随机变量出现的期望值。如果信息的不确定性越大，熵的值也就越大，出现的各种情况也就越多。&lt;/p&gt;
&lt;p&gt;假设当前样本集合&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;中第&lt;span class=&quot;math inline&quot;&gt;\(k\)&lt;/span&gt;类样本所占比例为&lt;span class=&quot;math inline&quot;&gt;\(p_k(k=1,2,\cdots,|n|)\)&lt;/span&gt;，则&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;的信息熵为：&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ Ent(D）=-\sum_{k=1}^{|n|}p_k\log_2p_k \tag{1} \]&lt;/span&gt;&lt;br/&gt;&lt;em&gt;定义：&lt;span class=&quot;math inline&quot;&gt;\(0log0 = 0\)&lt;/span&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;条件熵&lt;/code&gt;（conditional entropy）表示在已知随机变量X的条件下随机变量Y的不确定性。定义随机变量X给定的条件下随机变量Y的概率分布的熵：&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ Ent(Y|X)=\sum_{k=1}^{n}p_kH(Y|X=x_k) \tag{2} \]&lt;/span&gt;&lt;br/&gt;假定离散属性（特征）a有V个可能取值&lt;span class=&quot;math inline&quot;&gt;\(\{a^1,a^2,\cdots,a^V\}\)&lt;/span&gt;，若使用a来对样本集D进行划分，则会产生V个分支节点，其中第&lt;span class=&quot;math inline&quot;&gt;\(v\)&lt;/span&gt;个分支节点包含了&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;中所有在属性（特征）a上取值为&lt;span class=&quot;math inline&quot;&gt;\(a^v\)&lt;/span&gt;的样本，记作&lt;span class=&quot;math inline&quot;&gt;\(D^v\)&lt;/span&gt;。那么，特征&lt;span class=&quot;math inline&quot;&gt;\(a^v\)&lt;/span&gt;的条件概率分布为 &lt;span class=&quot;math inline&quot;&gt;\(\frac{|D^v|}{|D|}\)&lt;/span&gt;，我们可得&lt;code&gt;信息增益&lt;/code&gt;（information gain）：&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ Gain(D,a)=Ent(D)-Ent(D|a) \tag{3} \\ =Ent(D)-\sum_{v=1}^{V}\frac{|D^v|}{D}Ent(D^v) \]&lt;/span&gt;&lt;br/&gt;由上式可知，信息增益是相对于特征而言的，定义为集合&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;的信息熵与特征&lt;span class=&quot;math inline&quot;&gt;\(a\)&lt;/span&gt;下&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;的条件熵之差。&lt;/p&gt;
&lt;p&gt;这里回到一开始的问题，如何选择最优划分？方法是对训练数据集&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;，计算其每个特征的信息增益，并比较它们的大小，选择信息增益最大的特征。&lt;/p&gt;
&lt;p&gt;然而，有时存在这么一个问题，以信息增益作为划分训练数据集的特征，存在&lt;u&gt;偏向于选择取值较多的特征&lt;/u&gt;的问题。对这一问题的解决方法是使用&lt;code&gt;信息增益比&lt;/code&gt;（information gain ratio）：&lt;/p&gt;
&lt;p&gt;​ 特征A对训练数据集D的信息增益比&lt;span class=&quot;math inline&quot;&gt;\(g_R(D,A)\)&lt;/span&gt;定义为其信息增益&lt;span class=&quot;math inline&quot;&gt;\(g(D,A)\)&lt;/span&gt;与训练数据集D关于A的值的熵&lt;span class=&quot;math inline&quot;&gt;\(H_A(D)\)&lt;/span&gt;之比，即&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ g_R(D,A)=\frac{g(D,A)}{H_A(D)} \tag{4} \]&lt;/span&gt;&lt;br/&gt;其中，&lt;span class=&quot;math inline&quot;&gt;\(H_A(D)=-\sum_{i=1}^n\frac{|D_i|}{|D|}log_2\frac{|D_i|}{|D|}\)&lt;/span&gt;，n是特征A取值的个数。&lt;/p&gt;

&lt;p&gt;这篇文章中介绍了决策树的一些基本理论，对于决策树的优化以及ID3、C4.5、CART的代码实现将在后面的文章中给出。&lt;/p&gt;
</description>
<pubDate>Wed, 20 Mar 2019 13:41:00 +0000</pubDate>
<dc:creator>iTryagain</dc:creator>
<og:description>从零基础开始参加了几场数据挖掘方面的比赛，每次比赛都会学到不少东西，自从上次在 的 kernel 中看见很多人都使用 ，那之后我也开始用起了这些，但是却从未花时间去了解过这是究竟是什么，其内部工作原理</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/csu-lmw/p/10567896.html</dc:identifier>
</item>
<item>
<title>设计模式之欢迎来到设计模式世界（一） - 小酒窝</title>
<link>http://www.cnblogs.com/dimple91/p/10567893.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/dimple91/p/10567893.html</guid>
<description>&lt;p&gt;亲爱的朋友，欢迎你来到对象村，开始走进设计模式的世界。这里的每个人都很熟练的使用设计模式，很快我和你们一起，都会学习的很好，通过设计模式，跻身上流社会。&lt;/p&gt;
&lt;p&gt;计划每一章节的学习，通过几个篇幅来完成，理论+实践的方式。书中很多地方用到了图形表示，小编尽量用图文的方式和大家互动。先用理论建立知识，再用图形象地描述巩固学习。每篇文章给出书中的思考题和大家互动，在后文给出答案。力争让没读过此书的朋友也能有个理解。小编第一次尝试书本跟读，希望大家多给意见，同大家一起进步。&lt;/p&gt;
&lt;p&gt;记得大学的时候，C++的老师在教我们面向对象的是就是用的鸭子会飞、会叫的例子，没想到《Head First 设计模式》里用的也是这个，没看过太多的书，可能鸭子比较特殊吧。前几个月，还出现各种鸭子的表情包，还有很出名的小黄鸭，让我不禁赞叹，鸭子才是人类比较好的朋友呀。&lt;/p&gt;
&lt;p&gt;那么第一个问题来了，一家公司想要设计一款关于鸭子的游戏，游戏中会出现各种鸭子，一边游泳戏水，一边呱呱叫。游戏的模型已经有了面向对象的思想，设计了一个鸭子的超类（Superclass），并让各种鸭子继承这个超类。现在想让鸭子会飞，你会怎么做呢？初始的鸭超类如下，随着我们一步步学习，我们将这个超类一步步优化，敬请期待。&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class Duck {
    public Duck() {
    
    }
    
    // 游泳
    public void swim() {
        System.out.println(&quot;I can swim&quot;);
    }
    
    // 呱呱叫
    public void quack() {
        
    }
    
    // 显示
    public void display() {
        
    }
    
    // 飞行
    public void fly() {
        
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;我第一个冒出来的想法就是继承，我也算是写了几年程序的老鸟了，没想到也只能想到这么low的想法，用继承来解决问题。在继承中加入fly()方法。好啦，现在所有的鸭子都会飞了，包括玩具鸭，天呐，这是什么情况，难道你还要给玩具鸭装发动机么。要知道，并不是所有的鸭子都会飞的呀。如果以后还有一只木头鸭，啥都不会，怎么办呢。或者说以后鸭子变异了，多了功能，也并不是所有的鸭子都需要有的功能呢。这就引出了继承的弊端，给大家留的第一个思考题，继承会有哪些缺点呢？期待在留言区看到你的答案（答案下期揭晓）。以下哪几个是缺点：&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;A 代码在多个子类中重复&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;B 运行时的行为不容易改变&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;C 我们不能让鸭子跳舞&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;D 很难知道所有鸭子的全部行为&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;E 鸭子不能同时又飞又叫&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;F 改变会牵一发动全身，造成其他鸭子不想要的改变&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;所以，我们还是不能用继承来解决刚提出来的问题。有些鸭子会飞，有些鸭子会叫，有些啥都不会，鸭子行为太过于繁杂，不能一以贯之。这就引出了我们需要接触到的设计原则「&lt;strong&gt;找到应用中可能需要变化之处，并把它们独立出来，不要和那些不需要变化的代码混在一起&lt;/strong&gt;」这样，代码变化引起的不经意后果变少，系统变得更有弹性。在刚才的例子中，我们就把鸭子会飞以及会叫的属性的分开，组建一个新类来表示。&lt;/p&gt;
&lt;p&gt;第二个重点来了，如何设计那组实现飞行和呱呱叫的行为的类呢。那就把鸭子的行为放在分开的类中，此类专门提供某行为接口的实现，这样鸭子类就不再需要知道行为的实现细节。鸭子的子类将实现接口，不会绑死在鸭子的子类中，做一些没必要的事情。这就是我们需要说的第二个设计原则「&lt;strong&gt;针对接口编程，而不是实现编程&lt;/strong&gt;」&lt;/p&gt;
&lt;p&gt;我们利用接口代表每个行为，在这里用FlyBehavior与QuackBehavior分别表示飞行行为和呱呱叫行为，并且行为的每个实现都将实现其中的一个接口。这样的好处就是飞行和呱呱叫的动作可以被其他对象复用，复用的同时这些行为彻底和鸭子类无关。前文说到的，鸭子还想增加其他的行为，也可以通过此方式来进行，既不会影响到既有的行为类，也不会影响到使用到飞行行为的鸭子类。整合之前鸭子的行为，在实践中就是把飞行和呱呱叫方法在之前的超类中删除，通过接口来实现，进行分离。&lt;br/&gt;飞行和呱呱叫接口如下：&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;// 飞行接口
public interface FlyBehavior {
    public void fly();
}

// 呱呱叫接口
public interface QuackBehavior {
    public void quack();
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;相应的实现类如下：&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;// 飞行类
public class FlyWithWings implements FlyBehavior {

    @Override
    public void fly() {
        // 实现鸭子的飞行
        System.out.println(&quot;I'm flying!!!&quot;);
    }

}

// 呱呱叫类
public class Quack implements QuackBehavior {

    @Override
    public void quack() {
        // 实现鸭子的呱呱叫
        System.out.println(&quot;Quack&quot;);
    }

}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;如果鸭子要动态设定行为呢？什么意思，就是说「&lt;strong&gt;模型鸭想飞，利用火箭动力飞&lt;/strong&gt;」。在我们现有的设计中，难不倒我们。我们可以在鸭子子类中通过设定方法「setter method」的方式来设定鸭子的行为，而不用在构造器中实例化。构造器中模型鸭不会飞，通过设定鸭子的行为，把火箭动力行为设定好，相当于把鸭子加了一个bug，设定好之后再给鸭子去飞。&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;// 在超类中添加动态设置的行为
public void setFlyBehavior(FlyBehavior fb) {
    flyBehavior = fb;
}

public void setQuackBehavior(QuackBehavior qb) {
    quackBehavior = qb;
}

// 通过一个测试类进行测试反馈
public class MiniDuckSimulator {
    public static void main(String[] args) {
        Duck mallard = new MallardDuck();
        // 这里调用MallardDuck继承来的performQuack()，进而委托给该对象的QuackBehavior对象处理，
        // 也就是说，调用继承来的QuackBehavior的quack(),performFly同理
        mallard.performQuack();
        mallard.performFly();
        
        Duck model = new ModelDuck();
        // 第一次调用，不会飞
        model.performFly();
        // 调用继承来的setter方法，把火箭动力飞行的行为定到模型鸭中，模型鸭能一飞冲天
        model.setFlyBehavior(new FlyRocketPowered());
        // 这样就成功的改变了行为
        model.performFly();
    }
}

// 运行结果，我们实现了火箭助力飞行
Quack
I'm flying!!!
I can't fly
I'm flying with a  rocket&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;好了，现在我们有鸭子超类，鸭子类，飞行行为实现FlyBehavior接口，呱呱叫行为实现QuackBehavior接口。之前继承的想法，就是IS-A（是一个）的关系，现在通过封装行为，实现接口，变成了HAS-A（有一个）的关系，将两个类结合起来，就成为了一个组合（composition）。区别显而易见，鸭子的行为是通过对象的「组合」来的，而不是「继承」而来。恭喜你，掌握了第三个设计原则「&lt;strong&gt;多用组合，少用继承&lt;/strong&gt;」。使用组合建立系统具有很大的弹性，只要组合的行为对象符合正确的接口标准，那就可以「在运行时动态的改变行为」。&lt;/p&gt;
&lt;p&gt;简单的学到这里，其实已经在无形之中引出了一个设计模式「&lt;strong&gt;策略模式&lt;/strong&gt;」，他定义了算法族，分别封装起来，让它们之间互相替换，此模式让算法的变化独立于使用算法的客户。有了这个策略模式，系统不需要担心遇到任何改变，通过上述的操作，就能灵活应对，神不神奇，意不意外，惊不惊喜。&lt;/p&gt;
&lt;p&gt;现在对之前的理论做个简单的总结：首先我们先用鸭子举个例子，引出超类Duck，子类的概念；第二，因为鸭子需要各自有行为，呱呱叫，飞行行为，我们设计出接口QuackBehavior和FlyBehavior，实现类FlyWithWings（实现鸭子飞行）等其他行为和Quack（实现鸭子呱呱叫等其他叫声）；第三，我们需要鸭子有火箭般的速度，继而引出FlyRocketPowered的行为，方便鸭子动态设定。自此三个步骤，把今天的行为实现，得出了三个设计原则和一个设计模式。最终的Duck类如下&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public abstract class Duck {
    // 为行为接口类型声明两个引用变量，所有 鸭子类都继承他们
    FlyBehavior flyBehavior;
    QuackBehavior quackBehavior;
    
    public Duck() {
        
    }
    
    public void setFlyBehavior(FlyBehavior fb) {
        flyBehavior = fb;
    }
    
    public void setQuackBehavior(QuackBehavior qb) {
        quackBehavior = qb;
    }
    
    abstract void display();
    
    public void performQuack() {
        // 委托给呱呱叫行为类
        quackBehavior.quack();
    }
    
    public void performFly() {
        // 委托给飞行行为类
        flyBehavior.fly();
    }
    
    public void swim() {
        System.out.println(&quot;I can swim&quot;);
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;代码流程部分就到这里，在学习的过程当中，还有很多类图，很多思考以及总结等我去完善。这是第一篇，下面一篇会把这次的转变通过图文的方式做一个总结，小伙伴们先别急，学习是一个循序渐进的过程，小编会把代码写好，测试好，开源到GayHub上，同大家一起进步。&lt;/p&gt;
&lt;p&gt;今天的内容就到这里，欢迎各位拍砖！&lt;/p&gt;
&lt;p&gt;为了让小伙伴免去找资料的麻烦，公众号「奔跑吧攻城狮」回复设计模式，获取最经典的两本书籍《Head First设计模式》以及《大话设计模式》，一同开启新篇章。&lt;/p&gt;
</description>
<pubDate>Wed, 20 Mar 2019 13:35:00 +0000</pubDate>
<dc:creator>小酒窝</dc:creator>
<og:description>亲爱的朋友，欢迎你来到对象村，开始走进设计模式的世界。这里的每个人都很熟练的使用设计模式，很快我和你们一起，都会学习的很好，通过设计模式，跻身上流社会。 计划每一章节的学习，通过几个篇幅来完成，理论+</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/dimple91/p/10567893.html</dc:identifier>
</item>
<item>
<title>并发系列（3）之 CLH、MCS 队列锁简介 - 三枣</title>
<link>http://www.cnblogs.com/sanzao/p/10567529.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/sanzao/p/10567529.html</guid>
<description>&lt;p&gt;这篇博客主要是作为 &lt;strong&gt;AbstractQueuedSynchronizer&lt;/strong&gt; 的背景知识介绍；平时接触也非常的少，如果你不感兴趣可以跳过；但是了解一下能更加的清楚 &lt;strong&gt;AQS&lt;/strong&gt; 的设计思路；&lt;/p&gt;
&lt;h2 id=&quot;一自旋锁简介&quot;&gt;一、自旋锁简介&lt;/h2&gt;
&lt;p&gt;通常情况下解决多线程共享资源逻辑一致性问题有两种方式：&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;互斥锁：当发现资源被占用的时候，会阻塞自己直到资源解除占用，然后再次尝试获取；&lt;/li&gt;
&lt;li&gt;自旋锁：当发现占用时，一直尝试获取锁（线程没有被挂起的过程，也就没有线程调度切换的消耗）；&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;对于这两种方式没有优劣之分，只有是否适合当前的场景；具体的对比就不在继续深入了，如果你很感兴趣可以查看 &lt;a href=&quot;https://pan.baidu.com/s/1-a0mLuyDU7ammnKrk0wyRg&quot;&gt;《多处理器编程的艺术》&lt;/a&gt; 提取码：rznn ；&lt;/p&gt;

&lt;p&gt;但是如果竞争非常激烈的时候，使用自旋锁就会产生一些额外的问题：&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;可能导致一些线程始终无法获取锁（争抢的时候必然是当前活跃线程获得锁的几率大），也就是饥饿现象；&lt;/li&gt;
&lt;li&gt;因为自旋锁会依赖一个共享的锁标识，所以竞争激烈的时候，锁标识的同步也需要消耗大量的资源；&lt;/li&gt;
&lt;li&gt;如果要用自旋锁实现公平锁（即先到先获取），此时就还需要额外的变量，也会比较麻烦；&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;解决这些问题其中的一种办法就是使用队列锁，简单来讲就是让这些线程排队获取；下面我们介绍常用的两种，即 &lt;strong&gt;CLH 锁&lt;/strong&gt; 和 &lt;strong&gt;MCS 锁&lt;/strong&gt;；&lt;/p&gt;

&lt;h2 id=&quot;二clh-锁&quot;&gt;二、CLH 锁&lt;/h2&gt;
&lt;p&gt;CLH 是 Craig、Landin 和 Hagersten 三位作者的缩写，具体内容在 &lt;a href=&quot;ftp://ftp.cs.washington.edu/tr/1993/02/UW-CSE-93-02-02.pdf&quot;&gt;《Building FIFO and Priority-Queuing Spin Locks from Atomic Swap》&lt;/a&gt; 论文中有详细介绍，大家可以自行查看；我们 JDK 中 &lt;code&gt;java.util.concurrent.locks.AbstractQueuedSynchronizer&lt;/code&gt; 就是根据 CLH 锁的变种实现的；&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;简单实现：&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class CLH implements Lock {
  private final ThreadLocal&amp;lt;Node&amp;gt; preNode = ThreadLocal.withInitial(() -&amp;gt; null);
  private final ThreadLocal&amp;lt;Node&amp;gt; node = ThreadLocal.withInitial(Node::new);
  private final AtomicReference&amp;lt;Node&amp;gt; tail = new AtomicReference&amp;lt;&amp;gt;(new Node());

  private static class Node {
    private volatile boolean locked;
  }

  @Override
  public void lock() {
    final Node node = this.node.get();
    node.locked = true;
    Node pre = this.tail.getAndSet(node);
    this.preNode.set(pre);
    while (pre.locked) ;
  }

  @Override
  public void unlock() {
    final Node node = this.node.get();
    node.locked = false;
    this.node.set(this.preNode.get());
  }
}&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1119937/201903/1119937-20190320204856495-984046694.png&quot; width=&quot;800&quot; alt=&quot;clh&quot; align=&quot;center&quot;/&gt;&lt;/p&gt;

&lt;h2 id=&quot;三mcs-锁&quot;&gt;三、MCS 锁&lt;/h2&gt;
&lt;p&gt;同样 MCS 是 John M. Mellor-Crummey 和 Michael L. Scott 名字的缩写，具体内容可以在 &lt;a href=&quot;http://web.mit.edu/6.173/www/currentsemester/readings/R06-scalable-synchronization-1991.pdf&quot;&gt;《Algorithms for Scalable Synchronization on Shared-Memory Multiprocessors》&lt;/a&gt; 论文中查看；&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;简单实现：&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class MCS implements Lock {
  private final ThreadLocal&amp;lt;Node&amp;gt; node = ThreadLocal.withInitial(Node::new);
  private final AtomicReference&amp;lt;Node&amp;gt; tail = new AtomicReference&amp;lt;&amp;gt;();

  private static class Node {
    private volatile boolean locked = false;
    private volatile Node next = null;
  }

  @Override
  public void lock() {
    Node node = this.node.get();
    node.locked = true;
    Node pre = tail.getAndSet(node);
    if (pre != null) {
      pre.next = node;
      while (node.locked) ;
    }
  }

  @Override
  public void unlock() {
    Node node = this.node.get();
    if (node.next == null) {
      if (tail.compareAndSet(node, null)) {
        return;
      }
      while (node.next == null) ;
    }
    node.next.locked = false;
    node.next = null;
  }
}&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1119937/201903/1119937-20190320204131282-1895850438.png&quot; width=&quot;800&quot; alt=&quot;clh&quot; align=&quot;center&quot;/&gt;&lt;/p&gt;

&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;
&lt;ul&gt;&lt;li&gt;以上的代码我已经测试过，大家可以直接拿下来自行实验；&lt;/li&gt;
&lt;li&gt;CLH 锁和 MCS 锁区别主要有两点：1. 链表结构的区别；2. 自旋对象的区别，CLH 是在前驱节点上自旋，而 MCS 是在自身节点上自旋；这里第二点才是最重要的，主要体现在 &lt;strong&gt;SMP(Symmetric Multi-Processor)&lt;/strong&gt; 和 &lt;strong&gt;NUMA(Non-Uniform Memory Access)&lt;/strong&gt; 不同的处理器架构上；这里大家可以自行 Google；&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Wed, 20 Mar 2019 12:42:00 +0000</pubDate>
<dc:creator>三枣</dc:creator>
<og:description>这篇博客主要是作为 AbstractQueuedSynchronizer 的背景知识介绍；平时接触也非常的少，如果你不感兴趣可以跳过；但是了解一下能更加的清楚 AQS 的设计思路； 一、自旋锁简介 通</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/sanzao/p/10567529.html</dc:identifier>
</item>
<item>
<title>SpringMvc请求处理流程与源码探秘 - 井传红</title>
<link>http://www.cnblogs.com/jingch/p/10567394.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/jingch/p/10567394.html</guid>
<description>&lt;p&gt;dispatcherServlet作为前端控制器的主要作用就是接受请求与处理响应。&lt;/p&gt;
&lt;p&gt;不过它不是传统意义上的servlet,它在接受到请求后采用转发的方式，将具体工作交给专业人士去做。&lt;/p&gt;
&lt;p&gt;参与角色主要有：&lt;/p&gt;
&lt;p&gt;前端控制器（DispatcherServlet）&lt;/p&gt;
&lt;p&gt;处理映射器(HandlerMapping)&lt;/p&gt;
&lt;p&gt;处理适配器(HandlerAdapter)&lt;/p&gt;
&lt;p&gt;处理器((Handler)Controller)&lt;/p&gt;
&lt;p&gt;视图解析器(ViewReslover)&lt;/p&gt;
&lt;p&gt;视图(View)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;81&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320153020109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1358&quot; height=&quot;819&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320153020109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320153020109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1358&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;819&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;找了一张图，把请求过程与步骤清晰的呈现了出来&lt;/p&gt;

&lt;p&gt;第一步：前端控制器dispatcher接受请求&lt;/p&gt;
&lt;p&gt;    Client---url---&amp;gt;Dispatcher&lt;/p&gt;
&lt;p&gt;第二步：前端控制器去发起handler映射查找请求&lt;/p&gt;
&lt;p&gt;    Dispatcher---HttpServletRequest---&amp;gt; HandlerMapping&lt;/p&gt;
&lt;p&gt;第三步：处理器映射器查找hanlder并返回HandlerExetuionChain&lt;/p&gt;
&lt;p&gt;     Dispatcher &amp;lt;---HandlerExeutionChain---HandlerMapping&lt;/p&gt;
&lt;p&gt;第四步：前端控制器发起请求处理器适配器请求执行&lt;/p&gt;
&lt;p&gt;  Dispatcher---Handler---&amp;gt; HandlerAdapter&lt;/p&gt;
&lt;p&gt;第五步：处理器适配器去调用handler执行&lt;/p&gt;
&lt;p&gt;HandlerAdapter---HttpServletRequest&amp;gt; Handler(Controller)&lt;/p&gt;
&lt;p&gt;第六步：处理器处理后返回ModelAndView给HandlerAdapter&lt;/p&gt;
&lt;p&gt;HandlerAdapter &amp;lt;---ModelAndView---Handler(Controller)&lt;/p&gt;
&lt;p&gt;第七步：处理器适配器将ModelAndView返回给前端控制器&lt;/p&gt;
&lt;p&gt;Dispatcher &amp;lt;---ModelAndView---HandlerAdapter&lt;/p&gt;
&lt;p&gt;第八步：前端控制器请求视图解析器解析ModelAndView&lt;/p&gt;
&lt;p&gt;Dispatcher---ModelAndView---&amp;gt; ViewReslover&lt;/p&gt;
&lt;p&gt;第九步：视图解析器解析视图后返回视图View给前端控制器&lt;/p&gt;
&lt;p&gt;Dispatcher &amp;lt;---View---ViewReslover&lt;/p&gt;
&lt;p&gt;第十步：前端控制器请求视图要求渲染视图&lt;/p&gt;
&lt;p&gt;Dispatcher---&amp;gt;View---&amp;gt;render&lt;/p&gt;
&lt;p&gt;第十一步：前端控制器返回响应&lt;/p&gt;
&lt;p&gt;Response &amp;lt;---Dispatcher&lt;/p&gt;

&lt;h2&gt;  第一步接受请求：&lt;/h2&gt;
&lt;p&gt;我们可以来看看DispatcherServlet的继承结构&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;80&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320171611549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;990&quot; height=&quot;563&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320171611549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320171611549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;990&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;563&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其实DispatcherServlet能处理请求是因为HttpServlet类的service方法，而HttpServlet又来自Servlet接口定义的规范。&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;79&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320173006109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1020&quot; height=&quot;840&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320173006109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320173006109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1020&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;840&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以看到抽象类HttpServlet实现了接口Servlet的service方法，根据请求类型不同执行了不同的方法（doGet,doPost）&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;78&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320173816513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1192&quot; height=&quot;896&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320173816513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320173816513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1192&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;896&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;当请进来后，由HttpServlet的子类FrameworkServlet重写的service方法执行请求，可以看到437行子类调用了父类的service方法，然后在父类执行doGet之类的方法时，由于子类FrameworkServlet重写了父类方法，交由子类执行，所以进到了我的doGet断点里面，它调用了处理请求方法。&lt;/p&gt;
&lt;p&gt;接下来我们看看ProcessRequest方法的源码&lt;/p&gt;

&lt;p&gt;前面一系列初始化工作我们先不管，看看重要的部分，try里面的doService方法&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;76&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320174237318.png&quot; alt=&quot;&quot; width=&quot;819&quot; height=&quot;46&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320174237318.png&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320174237318.png&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;819&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;46&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;跟踪进去看了一下，由于它是抽象方法，所以会由子类实现和执行，也就是我们的DispatchServlet类了&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;75&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320174338177.png&quot; alt=&quot;&quot; width=&quot;348&quot; height=&quot;179&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320174338177.png&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320174338177.png&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;348&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;179&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;老规矩，先贴上源码，它是DispatchServlet的doService方法--------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;所以第一步也就完成了，第一步的任务就是走进这里来。&lt;/p&gt;
&lt;h2&gt;第二步：前端控制器去发起handler映射查找请求&lt;/h2&gt;
&lt;p&gt;Dispatcher---HttpServletRequest---&amp;gt; HandlerMapping&lt;/p&gt;
&lt;p&gt;上面的源码中主要工作就是给request实例设置一系列参数，要注意的就是doDispatch方法，这里面就是mvc的核心了，前面第一张交互图里面的流程都是在这里实现的。&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;73&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320175351741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1007&quot; height=&quot;424&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320175351741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320175351741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1007&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;424&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以看到，通过HttpRequestServlet作为参数请求handlerMapping&lt;/p&gt;
&lt;h2&gt;第三步：处理器映射器查找hanlder并返回HandlerExetuionChain&lt;/h2&gt;
&lt;p&gt;     Dispatcher &amp;lt;---HandlerExeutionChain---HandlerMapping&lt;/p&gt;
&lt;p&gt;可以看到上图中返回了mappedHandler变量，就是HandlerExtuceChain类型&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;72&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320182052820.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;939&quot; height=&quot;386&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320182052820.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320182052820.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;939&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;386&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以看到，已经找到并返回了我们的HomeController处理器（Hanlder）&lt;/p&gt;
&lt;h2&gt;第四步：前端控制器发起请求处理器适配器请求执行&lt;/h2&gt;
&lt;p&gt;  Dispatcher---Handler---&amp;gt; HandlerAdapter&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;71&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320180002973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;916&quot; height=&quot;422&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320180002973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320180002973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;916&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;422&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;从508行可以看到，适配器传入handler对象和reaquest等信息，执行handler()方法&lt;/p&gt;
&lt;h2&gt;第五步：处理器适配器去调用handler执行&lt;/h2&gt;
&lt;p&gt;HandlerAdapter---HttpServletRequest&amp;gt; Handler(Controller)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;70&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320182500732.png&quot; alt=&quot;&quot; width=&quot;1082&quot; height=&quot;195&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320182500732.png&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320182500732.png&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1082&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;195&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;从这里可以看到，调用的handlerInternal是个抽象方法，会调用子类的实现方法，子类由RequestMappingHandlerAdapter实现，这个类也是我们经常在xml里面配置的类&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;69&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/201903201826320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1272&quot; height=&quot;828&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/201903201826320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/201903201826320.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1272&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;828&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;
通过invokeHandlerMethod方法执行进到controller里面
&lt;/pre&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;68&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320183455928.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;614&quot; height=&quot;254&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320183455928.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320183455928.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;614&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;254&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;方法执行后返回我们的index&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;67&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320184002937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1064&quot; height=&quot;612&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320184002937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320184002937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1064&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;612&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;第六步：处理器处理后返回ModelAndView给HandlerAdapter&lt;/h2&gt;
&lt;p&gt;HandlerAdapter &amp;lt;---ModelAndView---Handler(Controller)&lt;/p&gt;
&lt;pre&gt;
通过调用invokeHandlerMethod方法返回ModelAndView
&lt;/pre&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;83&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320194151969.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;770&quot; height=&quot;284&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320194151969.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320194151969.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;770&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;284&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;第七步：处理器适配器将ModelAndView返回给前端控制器&lt;/h2&gt;
&lt;p&gt;Dispatcher &amp;lt;---ModelAndView---HandlerAdapter&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;87&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320194314191.png&quot; alt=&quot;&quot; width=&quot;1042&quot; height=&quot;41&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320194314191.png&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320194314191.png&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1042&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;41&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;第八步：前端控制器请求视图解析器解析ModelAndView&lt;/h2&gt;
&lt;p&gt;Dispatcher---ModelAndView---&amp;gt; ViewReslover&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;91&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/2019032019553673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;903&quot; height=&quot;245&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/2019032019553673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/2019032019553673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:903,&amp;amp;quot;height&amp;amp;quot;:245,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;第九步：视图解析器解析视图后返回视图View给前端控制器&lt;/h2&gt;
&lt;p&gt;Dispatcher &amp;lt;---View---ViewReslover&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;99&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320200249232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1061&quot; height=&quot;467&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320200249232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320200249232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1061&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;467&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可以看到，返回的视图，url指向index.jsp页面&lt;/p&gt;
&lt;h2&gt;第十步：前端控制器请求视图要求渲染视图&lt;/h2&gt;
&lt;p&gt;Dispatcher---&amp;gt;View---&amp;gt;render&lt;/p&gt;
&lt;p&gt;如果View对象不为空，将会调用render方法渲染&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;93&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320195718606.png&quot; alt=&quot;&quot; width=&quot;583&quot; height=&quot;189&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320195718606.png&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320195718606.png&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;583&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;189&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;如果返回的是json对象，属于接口的，是不会走这里的&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;95&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320195916522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;550&quot; height=&quot;214&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320195916522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320195916522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;550&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;214&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;此时会找对应的视图解析器去渲染&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;101&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320200444438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1247&quot; height=&quot;453&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320200444438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320200444438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1247&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;453&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;里面其实也没干啥，就做了个跳转，到jsp页面去绑定数据&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;103&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320200633430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1042&quot; height=&quot;724&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320200633430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320200633430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1042&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;724&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;第十一步：前端控制器返回响应&lt;/h2&gt;
&lt;p&gt;Response &amp;lt;---Dispatcher&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;105&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320200921284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;824&quot; height=&quot;336&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320200921284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320200921284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;824&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;336&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;到这里也就基本上完了。&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;107&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320201354664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1091&quot; height=&quot;422&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320201354664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320201354664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1091&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;422&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;处理请求完成后做了个重置工作，然后发布一个事件，你可以选择监听这个事件，做相应处理。&lt;/p&gt;
&lt;p&gt;再看看response里面&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected&quot; data-cke-widget-wrapper=&quot;1&quot; data-cke-filter=&quot;off&quot; data-cke-display-name=&quot;图像&quot; data-cke-widget-id=&quot;109&quot;&gt;&lt;img class=&quot;cke_widget_element has&quot; src=&quot;https://img-blog.csdnimg.cn/20190320201754552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; alt=&quot;&quot; width=&quot;1197&quot; height=&quot;556&quot; data-cke-saved-src=&quot;https://img-blog.csdnimg.cn/20190320201754552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&quot; data-cke-widget-data=&quot;{&amp;amp;quot;hasCaption&amp;amp;quot;:false,&amp;amp;quot;src&amp;amp;quot;:&amp;amp;quot;https://img-blog.csdnimg.cn/20190320201754552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hvbnN0YXQ=,size_16,color_FFFFFF,t_70&amp;amp;quot;,&amp;amp;quot;alt&amp;amp;quot;:&amp;amp;quot;&amp;amp;quot;,&amp;amp;quot;width&amp;amp;quot;:&amp;amp;quot;1197&amp;amp;quot;,&amp;amp;quot;height&amp;amp;quot;:&amp;amp;quot;556&amp;amp;quot;,&amp;amp;quot;lock&amp;amp;quot;:true,&amp;amp;quot;align&amp;amp;quot;:&amp;amp;quot;none&amp;amp;quot;,&amp;amp;quot;classes&amp;amp;quot;:[]}&quot; data-cke-widget-upcasted=&quot;1&quot; data-cke-widget-keep-attr=&quot;0&quot; data-widget=&quot;image&quot;/&gt;&lt;span class=&quot;cke_reset cke_widget_drag_handler_container&quot;&gt;&lt;img class=&quot;cke_reset cke_widget_drag_handler&quot; title=&quot;点击并拖拽以移动&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==&quot; alt=&quot;&quot; width=&quot;15&quot; height=&quot;15&quot; data-cke-widget-drag-handler=&quot;1&quot;/&gt;&lt;span class=&quot;cke_image_resizer&quot; title=&quot;点击并拖拽以改变尺寸&quot;&gt;​&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;这个就是我们页面上的内容了。&lt;/p&gt;

</description>
<pubDate>Wed, 20 Mar 2019 12:25:00 +0000</pubDate>
<dc:creator>井传红</dc:creator>
<og:description>流程梳理 dispatcherServlet作为前端控制器的主要作用就是接受请求与处理响应。 不过它不是传统意义上的servlet,它在接受到请求后采用转发的方式，将具体工作交给专业人士去做。 参与角</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/jingch/p/10567394.html</dc:identifier>
</item>
</channel>
</rss>