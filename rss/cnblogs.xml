<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>ä¾èµ–æ³¨å…¥[5]: åˆ›å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„DIæ¡†æ¶[ä¸‹ç¯‡] - Artech</title>
<link>http://www.cnblogs.com/artech/p/net-core-di-05.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/artech/p/net-core-di-05.html</guid>
<description>&lt;p&gt;ä¸ºäº†è®©è¯»è€…æœ‹å‹ä»¬èƒ½å¤Ÿå¯¹.NET Core DIæ¡†æ¶çš„å®ç°åŸç†å…·æœ‰ä¸€ä¸ªæ·±åˆ»è€Œè®¤è¯†ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸ä¹‹ç±»ä¼¼çš„è®¾è®¡æ„æ¶äº†ä¸€ä¸ªåä¸ºCatçš„DIæ¡†æ¶ã€‚åœ¨ã€Š&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-04.html&quot;&gt;ä¾èµ–æ³¨å…¥[4]: åˆ›å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„DIæ¡†æ¶[ä¸Šç¯‡]&lt;/a&gt;ã€‹ä¸­æˆ‘ä»¬ä»‹ç»äº†Catçš„åŸºæœ¬ç¼–ç¨‹æ¨¡å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥èŠèŠCatçš„è®¾è®¡å’Œå®ç°ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;ç›®å½•&lt;br/&gt;ä¸€ã€æœåŠ¡æ³¨å†Œï¼šServiceRegistry&lt;br/&gt;äºŒã€DIå®¹å™¨ï¼šCat&lt;br/&gt;ä¸‰ã€æ‰©å±•æ–¹æ³•&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç”±äºä½œä¸ºDIå®¹å™¨çš„Catå¯¹è±¡æ€»æ˜¯åˆ©ç”¨é¢„å…ˆæ·»åŠ åˆ°æœåŠ¡æ³¨å†Œæ¥æä¾›å¯¹åº”çš„æœåŠ¡å®ä¾‹ï¼Œæ‰€ä»¥æœåŠ¡æ³¨å†Œè‡³å…³é‡è¦ã€‚å¦‚ä¸‹æ‰€ç¤ºçš„å°±æ˜¯è¡¨ç¤ºæœåŠ¡æ³¨å†Œçš„&lt;strong&gt;ServiceRegistry&lt;/strong&gt;çš„å®šä¹‰ï¼Œå®ƒå…·æœ‰ä¸‰ä¸ªæ ¸å¿ƒå±æ€§ï¼ˆServiceTypeã€Lifetimeå’ŒFactoryï¼‰åˆ†åˆ«ä»£è¡¨æœåŠ¡ç±»å‹ã€ç”Ÿå‘½å‘¨æœŸæ¨¡å¼å’Œç”¨æ¥åˆ›å»ºæœåŠ¡å®ä¾‹çš„å·¥å‚ã€‚æœ€ç»ˆç”¨æ¥åˆ›å»ºæœåŠ¡å®ä¾‹çš„å·¥å‚ä½“ç°ä¸ºä¸€ä¸ªç±»å‹ä¸ºFunc&amp;lt;Cat,Type[], object&amp;gt;çš„å§”æ‰˜å¯¹è±¡ï¼Œå®ƒå…·æœ‰çš„ä¸¤ä¸ªè¾“å…¥åˆ†åˆ«ä»£è¡¨å½“å‰ä½¿ç”¨çš„Catå¯¹è±¡ä»¥åŠæä¾›æœåŠ¡ç±»å‹çš„&lt;strong&gt;æ³›å‹å‚æ•°åˆ—è¡¨&lt;/strong&gt;ï¼Œå¦‚æœæä¾›çš„æœåŠ¡ç±»å‹å¹¶ä¸æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œè¿™ä¸ªå‚æ•°ä¼šæŒ‡å®šä¸ºç©ºçš„ç±»å‹æ•°ç»„ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ServiceRegistry
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Type                         ServiceType { &lt;span&gt;get&lt;/span&gt;&lt;span&gt;; }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Lifetime                     Lifetime { &lt;span&gt;get&lt;/span&gt;&lt;span&gt;; }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Func&amp;lt;Cat,Type[], &lt;span&gt;object&lt;/span&gt;&amp;gt;    Factory { &lt;span&gt;get&lt;/span&gt;&lt;span&gt;; }
    &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt; ServiceRegistry            Next { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; ServiceRegistry(Type serviceType, Lifetime lifetime, Func&amp;lt;Cat,Type[], &lt;span&gt;object&lt;/span&gt;&amp;gt;&lt;span&gt; factory)
    {
        ServiceType     &lt;/span&gt;=&lt;span&gt; serviceType;
        Lifetime        &lt;/span&gt;=&lt;span&gt; lifetime;
        Factory         &lt;/span&gt;=&lt;span&gt; factory;
    }
    &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt; IEnumerable&amp;lt;ServiceRegistry&amp;gt;&lt;span&gt; AsEnumerable()
    {
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; list = &lt;span&gt;new&lt;/span&gt; List&amp;lt;ServiceRegistry&amp;gt;&lt;span&gt;();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; self = &lt;span&gt;this&lt;/span&gt;; self!=&lt;span&gt;null&lt;/span&gt;; self=&lt;span&gt; self.Next)
        {
            list.Add(self);
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; list;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
æˆ‘ä»¬å°†é’ˆå¯¹åŒä¸€ä¸ªæœåŠ¡ç±»å‹ï¼ˆServiceTypeå±æ€§ç›¸åŒï¼‰çš„å¤šä¸ªServiceRegistryç»„æˆä¸€ä¸ª&lt;strong&gt;é“¾è¡¨&lt;/strong&gt;ï¼Œä½œä¸ºç›¸é‚»èŠ‚ç‚¹çš„ä¸¤ä¸ªServiceRegistryå¯¹è±¡é€šè¿‡&lt;strong&gt;Next&lt;/strong&gt;å±æ€§å…³è”èµ·æ¥ã€‚æˆ‘ä»¬ä¸ºServiceRegistryå®šä¹‰äº†ä¸€ä¸ªAsEnumerableæ–¹æ³•æ˜¯å®ƒè¿”å›ç”±å½“å‰ä»¥åŠåç»­èŠ‚ç‚¹ç»„æˆçš„ServiceRegistryé›†åˆã€‚å¦‚æœå½“å‰ServiceRegistryä¸ºé“¾è¡¨è¡¨å¤´ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•è¿”å›é“¾è¡¨æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚

&lt;p&gt;åœ¨äº†è§£äº†è¡¨ç¤ºæœåŠ¡æ³¨å†Œçš„ServiceRegistryä¹‹åï¼Œæˆ‘ä»¬æ¥ç€é‡ä»‹ç»è¡¨ç¤ºDIå®¹å™¨çš„&lt;strong&gt;Cat&lt;/strong&gt;ç±»å‹ã€‚å¦‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼ŒCatåŒæ—¶å®ç°äº†IServiceProviderå’ŒIDisposableæ¥å£ï¼Œå®šä¹‰åœ¨å‰è€…ä¸­çš„GetServiceç”¨äºæä¾›æœ€ç»ˆçš„æœåŠ¡å®ä¾‹ã€‚ä½œä¸ºæ ¹å®¹å™¨çš„Catå¯¹è±¡é€šè¿‡å…¬å…±æ„é€ å‡½æ•°åˆ›å»ºï¼Œå¦ä¸€ä¸ªå†…éƒ¨æ„é€ å‡½æ•°åˆ™ç”¨æ¥åˆ›å»ºä½œä¸ºå­å®¹å™¨çš„Catå¯¹è±¡ï¼ŒæŒ‡å®šçš„Catå¯¹è±¡å°†ä½œä¸ºçˆ¶å®¹å™¨ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Cat : IServiceProvider, IDisposable
{
    &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt;&lt;span&gt; Cat                                         _root;
    &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt; ConcurrentDictionary&amp;lt;Type, ServiceRegistry&amp;gt;&lt;span&gt;     _registries;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; ConcurrentDictionary&amp;lt;ServiceRegistry, &lt;span&gt;object&lt;/span&gt;&amp;gt;&lt;span&gt;    _services;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; ConcurrentBag&amp;lt;IDisposable&amp;gt;&lt;span&gt;                      _disposables;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;volatile&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt;&lt;span&gt;                                 _disposed;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Cat()
    {
        _registries   &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ConcurrentDictionary&amp;lt;Type, ServiceRegistry&amp;gt;&lt;span&gt;();
        _root         &lt;/span&gt;= &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        _services     &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ConcurrentDictionary&amp;lt;ServiceRegistry, &lt;span&gt;object&lt;/span&gt;&amp;gt;&lt;span&gt;();
        _disposables  &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ConcurrentBag&amp;lt;IDisposable&amp;gt;&lt;span&gt;();
    }
    &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt;&lt;span&gt; Cat(Cat parent)
    {
        _root         &lt;/span&gt;=&lt;span&gt; parent._root;
        _registries   &lt;/span&gt;=&lt;span&gt; _root._registries;
        _services     &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ConcurrentDictionary&amp;lt;ServiceRegistry, &lt;span&gt;object&lt;/span&gt;&amp;gt;&lt;span&gt;();
        _disposables  &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ConcurrentBag&amp;lt;IDisposable&amp;gt;&lt;span&gt;();
    }
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; EnsureNotDisposed()
    {
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (_disposed)
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ObjectDisposedException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Cat&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }  
    ...
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
ä½œä¸ºæ ¹å®¹å™¨çš„Catå¯¹è±¡é€šè¿‡&lt;strong&gt;_root&lt;/strong&gt;å­—æ®µè¡¨ç¤ºã€‚&lt;strong&gt;_registries&lt;/strong&gt;å­—æ®µè¿”å›çš„ä¸€ä¸ªConcurrentDictionaryå¯¹è±¡è¡¨ç¤ºæ‰€æœ‰æ·»åŠ çš„æœåŠ¡æ³¨å†Œï¼Œå­—å…¸å¯¹è±¡çš„Keyå’ŒValueåˆ†åˆ«è¡¨ç¤ºæœåŠ¡ç±»å‹å’ŒServiceRegistryé“¾è¡¨ã€‚ç”±å½“å‰Catå¯¹è±¡æä¾›çš„éTransientæœåŠ¡å®ä¾‹ä¿å­˜åœ¨ç”±&lt;strong&gt;_services&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„ä¸€ä¸ªConcurrentDictionaryå¯¹è±¡ä¸Šï¼Œè¯¥å­—å…¸å¯¹è±¡çš„Keyè¡¨ç¤ºåˆ›å»ºæœåŠ¡å®ä¾‹æ‰€ä½¿ç”¨çš„ServiceRegistryå¯¹è±¡ã€‚ç”±äºéœ€è¦è´Ÿè´£å®Œæˆå¯¹æä¾›æœåŠ¡å®ä¾‹çš„é‡Šæ”¾å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å®ç°äº†IDisposableæ¥å£çš„æœåŠ¡å®ä¾‹ä¿å­˜åœ¨é€šè¿‡&lt;strong&gt;_disposables&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„é›†åˆä¸­ã€‚
&lt;p&gt;è™½ç„¶æˆ‘ä»¬ä¸ºCatå®šä¹‰äº†è‹¥å¹²æ‰©å±•æ–¹æ³•æ¥æä¾›å¤šç§ä¸åŒçš„æœåŠ¡æ³¨å†Œï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•æœ€ç»ˆéƒ½ä¼šè°ƒç”¨å¦‚ä¸‹è¿™ä¸ª&lt;strong&gt;Register&lt;/strong&gt;æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå°†æä¾›çš„ServiceRegistryæ·»åŠ åˆ°&lt;strong&gt;_registries&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„å­—å…¸å¯¹è±¡ä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸è®ºæˆ‘ä»¬æ˜¯è°ƒç”¨é‚£ä¸ªCatå¯¹è±¡çš„Registeræ–¹æ³•ï¼ŒæŒ‡å®šçš„ServiceRegistryéƒ½ä¼šè¢«æ·»åŠ åˆ°ä½œä¸º&lt;strong&gt;æ ¹å®¹å™¨&lt;/strong&gt;çš„Catå¯¹è±¡ä¸Šã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Cat : IServiceProvider, IDisposable
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Cat Register(ServiceRegistry registry)
    {
        EnsureNotDisposed();
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (_registries.TryGetValue(registry.ServiceType, &lt;span&gt;out&lt;/span&gt; &lt;span&gt;var&lt;/span&gt;&lt;span&gt; existing))
        {
            _registries[registry.ServiceType] &lt;/span&gt;=&lt;span&gt; registry;
            registry.Next &lt;/span&gt;=&lt;span&gt; existing;
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
        {
            _registries[registry.ServiceType] &lt;/span&gt;=&lt;span&gt; registry;
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
}
...
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç”¨æ¥æä¾›æœåŠ¡å®ä¾‹çš„æ ¸å¿ƒæ“ä½œå®ç°åœ¨å¦‚ä¸‹è¿™ä¸ª&lt;strong&gt;GetServiceCore&lt;/strong&gt;æ–¹æ³•ä¸­ã€‚å¦‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨è¯¥æ–¹æ³•çš„æ—¶å€™éœ€è¦æŒ‡å®šå¯¹åº”çš„ServiceRegistryå’ŒæœåŠ¡å¯¹è±¡æ³›å‹å‚æ•°ã€‚å½“è¯¥æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯¹äº&lt;strong&gt;Transient&lt;/strong&gt;ç”Ÿå‘½å‘¨æœŸæ¨¡å¼ï¼Œå®ƒä¼šç›´æ¥åˆ©ç”¨ServiceRegistryæä¾›çš„å·¥å‚æ¥åˆ›å»ºæœåŠ¡å®ä¾‹ï¼Œå¦‚æœæœåŠ¡å®ä¾‹å®ç°äº†&lt;strong&gt;IDisposable&lt;/strong&gt;æ¥å£ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ°&lt;strong&gt;_disposables&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„å¾…é‡Šæ”¾æœåŠ¡å®ä¾‹åˆ—è¡¨ä¸­ã€‚å¯¹äº&lt;strong&gt;Root&lt;/strong&gt;å’Œ&lt;strong&gt;Self&lt;/strong&gt;ç”Ÿå‘½å‘¨æœŸæ¨¡å¼ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆæ ¹æ®æä¾›çš„ServiceRegistryåˆ¤æ–­æ˜¯å¦å¯¹åº”çš„æœåŠ¡å®ä¾‹å·²ç»å­˜åœ¨ï¼Œå­˜åœ¨çš„æœåŠ¡å®ä¾‹ä¼šç›´æ¥ä½œä¸ºè¿”å›å€¼ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Cat : IServiceProvider, IDisposable
{
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;object&lt;/span&gt;&lt;span&gt; GetServiceCore(ServiceRegistry registry, Type[] genericArguments)
    {
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; serviceType =&lt;span&gt; registry.ServiceType;
        &lt;/span&gt;&lt;span&gt;object&lt;/span&gt; GetOrCreate(ConcurrentDictionary&amp;lt;ServiceRegistry, &lt;span&gt;object&lt;/span&gt;&amp;gt; services, ConcurrentBag&amp;lt;IDisposable&amp;gt;&lt;span&gt; disposables)
        {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (services.TryGetValue(registry, &lt;span&gt;out&lt;/span&gt; &lt;span&gt;var&lt;/span&gt;&lt;span&gt; service))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; service;
            }
            service &lt;/span&gt;= registry.Factory(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;, genericArguments);
            services[registry] &lt;/span&gt;=&lt;span&gt; service;
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; disposable = service &lt;span&gt;as&lt;/span&gt;&lt;span&gt; IDisposable;
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (&lt;span&gt;null&lt;/span&gt; !=&lt;span&gt; disposable)
            {
                disposables.Add(disposable);
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; service;
        }
        &lt;/span&gt;&lt;span&gt;switch&lt;/span&gt;&lt;span&gt; (registry.Lifetime)
        {
            &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; Lifetime.Root: &lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetOrCreate(_root._services, _root._disposables);   
            &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; Lifetime.Self: &lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetOrCreate(_services, _disposables);
            &lt;/span&gt;&lt;span&gt;default&lt;/span&gt;&lt;span&gt;:
                {
                    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; service = registry.Factory(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;, genericArguments);
                    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; disposable = service &lt;span&gt;as&lt;/span&gt;&lt;span&gt; IDisposable;
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (&lt;span&gt;null&lt;/span&gt; !=&lt;span&gt; disposable)
                    {
                        _disposables.Add(disposable);
                    }
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; service;
                }
        }
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
GetServiceCoreæ–¹æ³•åªæœ‰åœ¨æŒ‡å®šServiceRegistryå¯¹åº”çš„æœåŠ¡å®ä¾‹ä¸å­˜åœ¨çš„æƒ…å†µä¸‹é‡‡ç”¨åˆ©ç”¨æä¾›çš„å·¥å‚æ¥åˆ›å»ºæœåŠ¡å®ä¾‹ï¼Œåˆ›å»ºçš„æœåŠ¡å®ä¾‹ä¼šæ ¹æ®ç”Ÿå‘½å‘¨æœŸæ¨¡å¼ä¿å­˜åˆ°ä½œä¸ºæ ¹å®¹å™¨çš„Catå¯¹è±¡æˆ–è€…å½“å‰Catå¯¹è±¡ä¸Šã€‚å¦‚æœæä¾›çš„æœåŠ¡å®ä¾‹å®ç°äº†IDisposableæ¥å£ï¼Œåœ¨é‡‡ç”¨&lt;strong&gt;Root&lt;/strong&gt;ç”Ÿå‘½å‘¨æœŸæ¨¡å¼ä¸‹ä¼šè¢«ä¿å­˜åˆ°ä½œä¸º&lt;strong&gt;æ ¹å®¹å™¨&lt;/strong&gt;çš„Catå¯¹è±¡çš„å¾…é‡Šæ”¾åˆ—è¡¨ä¸­ï¼Œå¦‚æœç”Ÿå‘½å‘¨æœŸæ¨¡å¼ä¸º&lt;strong&gt;Self&lt;/strong&gt;ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ°&lt;strong&gt;å½“å‰Cat&lt;/strong&gt;å¯¹è±¡çš„å¾…é‡Šæ”¾åˆ—è¡¨ä¸­ã€‚
&lt;p&gt;åœ¨å®ç°çš„&lt;strong&gt;GetService&lt;/strong&gt;æ–¹æ³•ä¸­ï¼ŒCatä¼šæ ¹æ®æŒ‡å®šçš„æœåŠ¡ç±»å‹æ‰¾åˆ°å¯¹åº”çš„ServiceRegistryå¯¹è±¡ï¼Œå¹¶æœ€ç»ˆè°ƒç”¨GetServiceCoreæ–¹æ³•æ¥æä¾›å¯¹åº”çš„æœåŠ¡å®ä¾‹ã€‚GetServiceæ–¹æ³•ä¼šè§£å†³ä¸€äº›ç‰¹æ®ŠæœåŠ¡æä¾›é—®é¢˜ï¼Œå¦‚æœæœåŠ¡ç±»å‹ä¸º&lt;strong&gt;Cat&lt;/strong&gt;æˆ–è€…&lt;strong&gt;IServiceProvider&lt;/strong&gt;ï¼Œè¯¥æ–¹æ³•è¿”å›çš„å°±æ˜¯å®ƒè‡ªå·±ã€‚å¦‚æœæœåŠ¡ç±»å‹ä¸º&lt;strong&gt;IEnumerable&amp;lt;T&amp;gt;&lt;/strong&gt;ï¼ŒGetServiceä¼šæ ¹æ®æ³›å‹å‚æ•°ç±»å‹Tæ‰¾åˆ°æ‰€æœ‰çš„ServiceRegistryå¹¶åˆ©ç”¨å®ƒä»¬æ¥åˆ›å»ºå¯¹åº”çš„æœåŠ¡å®ä¾‹ï¼Œæœ€ç»ˆè¿”å›çš„æ˜¯æœ‰è¿™äº›æœåŠ¡å®ä¾‹ç»„æˆçš„é›†åˆã€‚é™¤äº†è¿™äº›ï¼Œé’ˆå¯¹&lt;strong&gt;æ³›å‹&lt;/strong&gt;æœåŠ¡å®ä¾‹çš„æä¾›ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è§£å†³çš„ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;45&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Cat : IServiceProvider, IDisposable
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;object&lt;/span&gt;&lt;span&gt; GetService(Type serviceType)
    {
        EnsureNotDisposed();
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (serviceType == &lt;span&gt;typeof&lt;/span&gt;(Cat) || serviceType == &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(IServiceProvider))
        {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        }
        ServiceRegistry registry;
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (serviceType.IsGenericType &amp;amp;&amp;amp; serviceType.GetGenericTypeDefinition() == &lt;span&gt;typeof&lt;/span&gt;(IEnumerable&amp;lt;&amp;gt;&lt;span&gt;))
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; elementType = serviceType.GetGenericArguments()[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;];
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!_registries.TryGetValue(elementType, &lt;span&gt;out&lt;/span&gt;&lt;span&gt;  registry))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; Array.CreateInstance(elementType, &lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; registries =&lt;span&gt; registry.AsEnumerable();
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; services = registries.Select(it =&amp;gt; GetServiceCore(it,  &lt;span&gt;new&lt;/span&gt; Type[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;])).ToArray();
            Array array &lt;/span&gt;=&lt;span&gt; Array.CreateInstance(elementType, services.Length);
            services.CopyTo(array, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; array;
        }
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (serviceType.IsGenericType &amp;amp;&amp;amp; !&lt;span&gt;_registries.ContainsKey(serviceType))
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; definition =&lt;span&gt; serviceType.GetGenericTypeDefinition();
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; _registries.TryGetValue(definition, &lt;span&gt;out&lt;/span&gt;&lt;span&gt; registry)
                &lt;/span&gt;?&lt;span&gt; GetServiceCore(registry, serviceType.GetGenericArguments())
                : &lt;/span&gt;&lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; _registries.TryGetValue(serviceType, &lt;span&gt;out&lt;/span&gt;&lt;span&gt; registry)
                &lt;/span&gt;? GetServiceCore(registry, &lt;span&gt;new&lt;/span&gt; Type[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;])
                : &lt;/span&gt;&lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    }
    ...
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨å®ç°çš„&lt;strong&gt;Dispose&lt;/strong&gt;æ–¹æ³•ä¸­ï¼Œç”±äºæ‰€æœ‰å¾…é‡Šæ”¾çš„æœåŠ¡å®ä¾‹å·²ç»ä¿å­˜åˆ°&lt;strong&gt;_disposables&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„é›†åˆä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¾æ¬¡è°ƒç”¨å®ƒä»¬çš„Disposeæ–¹æ³•å³å¯ã€‚åœ¨é‡Šæ”¾äº†æ‰€æœ‰æœåŠ¡å®ä¾‹å¹¶æ¸…ç©ºå¾…é‡Šæ”¾åˆ—è¡¨åï¼ŒDisposeæ–¹æ³•è¿˜ä¼šæ¸…ç©º&lt;strong&gt;_services&lt;/strong&gt;å­—æ®µè¡¨ç¤ºçš„æœåŠ¡å®ä¾‹åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Cat : IServiceProvider, IDisposable
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Dispose()
    {
        _disposed &lt;/span&gt;= &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;foreach&lt;/span&gt;(&lt;span&gt;var&lt;/span&gt; disposable &lt;span&gt;in&lt;/span&gt;&lt;span&gt; _disposables)
        {
            disposable.Dispose();
        }
        &lt;/span&gt;&lt;span&gt;while&lt;/span&gt; (!&lt;span&gt;_disposables.IsEmpty)
        {
            _disposables.TryTake(&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;&lt;span&gt; _);
        }
        _services.Clear();
    }
    ...
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æ³¨å†ŒæœåŠ¡ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹ä¸‰ä¸ª4ä¸ªæ‰©å±•æ–¹æ³•&lt;strong&gt;Register&lt;/strong&gt;ã€‚ç”±äºæœåŠ¡æ³¨å†Œçš„æ·»åŠ æ€»æ˜¯éœ€è¦è°ƒç”¨Catè‡ªèº«çš„Registeræ–¹æ³•æ¥å®Œæˆï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•æœ€ç»ˆéƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªä»£è¡¨æœåŠ¡æ³¨å†Œçš„&lt;strong&gt;ServiceRegistry&lt;/strong&gt;å¯¹è±¡ã€‚å¯¹äºä¸€ä¸ªServiceRegistryå¯¹è±¡æ¥è¯´ï¼Œå®ƒæœ€ä¸ºæ ¸å¿ƒçš„è«è¿‡äºè¡¨ç¤ºæœåŠ¡å®ä¾‹åˆ›å»ºå·¥å‚çš„&lt;strong&gt;Func&amp;lt;Cat,Type[], object&amp;gt;&lt;/strong&gt;å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šè¿°è¿™4ä¸ªæ‰©å±•æ–¹æ³•éœ€è¦è§£å†³çš„å°±æ˜¯åˆ›å»ºè¿™ä¹ˆä¸€ä¸ªå§”æ‰˜å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;65&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; CatExtensions
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Cat Register(&lt;span&gt;this&lt;/span&gt; Cat cat, Type &lt;span&gt;from&lt;/span&gt;&lt;span&gt;, Type to, Lifetime lifetime)
    {
        Func&lt;/span&gt;&amp;lt;Cat, Type[], &lt;span&gt;object&lt;/span&gt;&amp;gt; factory = (_, arguments) =&amp;gt;&lt;span&gt; Create(_, to, arguments);
        cat.Register(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt; ServiceRegistry(&lt;span&gt;from&lt;/span&gt;&lt;span&gt;, lifetime, factory));
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; cat;
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Cat Register&amp;lt;TFrom, TTo&amp;gt;(&lt;span&gt;this&lt;/span&gt; Cat cat, Lifetime lifetime) &lt;span&gt;where&lt;/span&gt;&lt;span&gt; TTo:TFrom
        &lt;/span&gt;=&amp;gt; cat. Register(&lt;span&gt;typeof&lt;/span&gt;(TFrom), &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(TTo), lifetime);
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Cat Register&amp;lt;TServiceType&amp;gt;(&lt;span&gt;this&lt;/span&gt;&lt;span&gt; Cat cat, TServiceType instance)
    {
        Func&lt;/span&gt;&amp;lt;Cat, Type[], &lt;span&gt;object&lt;/span&gt;&amp;gt; factory = (_, arguments) =&amp;gt;&lt;span&gt; instance;
        cat.Register(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt; ServiceRegistry(&lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(TServiceType),  Lifetime.Root, factory));
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; cat;
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Cat Register&amp;lt;TServiceType&amp;gt;(&lt;span&gt;this&lt;/span&gt; Cat cat, Func&amp;lt;Cat,TServiceType&amp;gt;&lt;span&gt; factory, Lifetime lifetime)
    {
        cat.Register(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt; ServiceRegistry(&lt;span&gt;typeof&lt;/span&gt;(TServiceType), lifetime, (_,arguments)=&amp;gt;&lt;span&gt;factory(_)));
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; cat;
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; HasRegistry&amp;lt;T&amp;gt;(&lt;span&gt;this&lt;/span&gt; Cat cat) =&amp;gt; cat.HasRegistry(&lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(T));
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; HasRegistry(&lt;span&gt;this&lt;/span&gt; Cat cat, Type serviceType) =&amp;gt;&lt;span&gt; cat._root._registries.ContainsKey(serviceType);
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;object&lt;/span&gt;&lt;span&gt; Create(Cat cat, Type type, Type[] genericArguments)
    {
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (genericArguments.Length &amp;gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
        {
            type &lt;/span&gt;=&lt;span&gt; type.MakeGenericType(genericArguments);
        }
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; constructors =&lt;span&gt; type.GetConstructors(BindingFlags.Instance);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (constructors.Length == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InvalidOperationException($&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Cannot create the instance of &lt;/span&gt;
                {type} which does not have an &lt;span&gt;public&lt;/span&gt; constructor.&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;); &lt;/span&gt;
&lt;span&gt;        }
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; constructor = constructors.FirstOrDefault(it =&amp;gt; it.GetCustomAttributes(&lt;span&gt;false&lt;/span&gt;).OfType&amp;lt;InjectionAttribute&amp;gt;&lt;span&gt;().Any());
        constructor &lt;/span&gt;= constructor ??&lt;span&gt; constructors.First();
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; parameters =&lt;span&gt; constructor.GetParameters();
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (parameters.Length == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
        {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Activator.CreateInstance(type);
        }
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; arguments = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;object&lt;/span&gt;&lt;span&gt;[parameters.Length];
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; index = &lt;span&gt;0&lt;/span&gt;; index &amp;lt; arguments.Length; index++&lt;span&gt;)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; parameter =&lt;span&gt; parameters[index];
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; parameterType =&lt;span&gt; parameter.ParameterType;
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (cat.HasRegistry(parameterType))
            {
                arguments[index] &lt;/span&gt;=&lt;span&gt; cat.GetService(parameterType);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (parameter.HasDefaultValue)
            {
                arguments[index] &lt;/span&gt;=&lt;span&gt; parameter.DefaultValue;
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InvalidOperationException($&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Cannot create the instance of {type} whose constructor has non-registered parameter type(s)&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Activator.CreateInstance(type, arguments);
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
ç¬¬ä¸‰ä¸ªæ‰©å±•æ–¹æ³•æ¥æŒ‡å®šçš„æ˜¯ä¸€ä¸ªç”¨æ¥æä¾›æœåŠ¡å®ä¾‹çš„Funcå¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæ‰©å±•æ–¹æ³•æŒ‡å®šçš„ç›´æ¥å°±æ˜¯æœåŠ¡å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°†æä¾›çš„å‚æ•°è½¬æ¢æˆä¸€ä¸ªFuncã€‚ç”±äºå‰ä¸¤ä¸ªé‡è½½æŒ‡å®šçš„æ˜¯æœåŠ¡å®ç°ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è°ƒç”¨å¯¹åº”çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºæœåŠ¡å®ä¾‹ï¼Œè¿™ä¸€é€»è¾‘å®ç°åœ¨ç§æœ‰çš„&lt;strong&gt;Create&lt;/strong&gt;æ–¹æ³•ä¸­ã€‚
&lt;p&gt;æˆ‘ä»¬åˆ»æ„ç®€åŒ–äº†æ„é€ å‡½æ•°çš„ç­›é€‰é€»è¾‘ã€‚ä¸ºäº†è§£å†³æ„é€ å‡½æ•°çš„é€‰æ‹©é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥å¦‚ä¸‹è¿™ä¸ª&lt;strong&gt;InjectionAttribute&lt;/strong&gt;ç‰¹æ€§ã€‚æˆ‘ä»¬å°†æ‰€æœ‰å…¬å…±å®ä¾‹æ„é€ å‡½æ•°ä½œä¸ºå€™é€‰çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¼šä¼˜å…ˆé€‰æ‹©æ ‡æ³¨äº†è¯¥ç‰¹æ€§çš„æ„é€ å‡½æ•°ã€‚å½“æ„é€ å‡½æ•°è¢«é€‰æ‹©å‡ºæ¥åï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡åˆ†æå…¶å‚æ•°ç±»å‹å¹¶åˆ©ç”¨Catå¯¹è±¡æ¥æä¾›å…·ä½“çš„å‚æ•°å€¼ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ã€‚æœ€ç»ˆæˆ‘ä»¬å°†é’ˆå¯¹æ„é€ å‡½æ•°çš„è°ƒç”¨è½¬æ¢æˆFunc&amp;lt;Cat,Type[], object&amp;gt;å¯¹è±¡ï¼Œè¿›è€Œåˆ›å»ºå‡ºè¡¨ç¤ºæœåŠ¡æ³¨å†Œçš„ServiceRegistryå¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;[AttributeUsage( AttributeTargets.Constructor)]
&lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; InjectionAttribute: Attribute {}
&lt;/pre&gt;&lt;/div&gt;
ä¸Šé¢ç»™å‡ºçš„ä»£ç ç‰‡æ®µè¿˜æä¾›äº†ä¸¤ä¸ª&lt;strong&gt;HasRegistry&lt;/strong&gt;å’Œ&lt;strong&gt;HasRegistry&amp;lt;T&amp;gt;&lt;/strong&gt;æ–¹æ³•æ¥ç¡®å®šæŒ‡å®šç±»å‹çš„æœåŠ¡æ³¨å†Œæ˜¯å¦å­˜åœ¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”¨äºæä¾›æœåŠ¡å®ä¾‹çš„æ³›å‹æ–¹æ³•GetServiceå’Œç”¨äºæä¾›æ‰€æœ‰æŒ‡å®šç±»å‹æœåŠ¡å®ä¾‹çš„GetServiceæ–¹æ³•é‡‡ç”¨äº†å¦‚ä¸‹çš„å®šä¹‰æ–¹å¼ã€‚
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; CatExtensions
{
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; GetServices&amp;lt;T&amp;gt;(&lt;span&gt;this&lt;/span&gt; Cat cat) =&amp;gt; cat.GetService&amp;lt;IEnumerable&amp;lt;T&amp;gt;&amp;gt;&lt;span&gt;();
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; T GetService&amp;lt;T&amp;gt;(&lt;span&gt;this&lt;/span&gt; Cat cat) =&amp;gt; (T)cat.GetService(&lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(T));
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-01.html&quot;&gt;ä¾èµ–æ³¨å…¥[1]: æ§åˆ¶åè½¬&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-02.html&quot;&gt;ä¾èµ–æ³¨å…¥[2]: åŸºäºIoCçš„è®¾è®¡æ¨¡å¼&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-03.html&quot;&gt;ä¾èµ–æ³¨å…¥[3]: ä¾èµ–æ³¨å…¥æ¨¡å¼&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-04.html&quot;&gt;ä¾èµ–æ³¨å…¥[4]: åˆ›å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„DIæ¡†æ¶[ä¸Šç¯‡]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-05.html&quot;&gt;ä¾èµ–æ³¨å…¥[5]: åˆ›å»ºä¸€ä¸ªç®€æ˜“ç‰ˆçš„DIæ¡†æ¶[ä¸‹ç¯‡]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-06.html&quot;&gt;ä¾èµ–æ³¨å…¥[6]: .NET Core DIæ¡†æ¶[ç¼–ç¨‹ä½“éªŒ]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-07.html&quot;&gt;ä¾èµ–æ³¨å…¥[7]: .NET Core DIæ¡†æ¶[æœåŠ¡æ³¨å†Œ]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/net-core-di-08html&quot;&gt;ä¾èµ–æ³¨å…¥[8]: .NET Core DIæ¡†æ¶[æœåŠ¡æ¶ˆè´¹]&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 23:29:00 +0000</pubDate>
<dc:creator>Artech</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/artech/p/net-core-di-05.html</dc:identifier>
</item>
<item>
<title>Apollo 8 â€” ConfigService å¼‚æ­¥è½®è¯¢æ¥å£çš„å®ç° - è«é‚£-é²é“</title>
<link>http://www.cnblogs.com/stateis0/p/9393871.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/stateis0/p/9393871.html</guid>
<description>&lt;h2 id=&quot;æºç &quot;&gt;æºç &lt;/h2&gt;
&lt;p&gt;Apollo é•¿è½®è¯¢çš„å®ç°ï¼Œæ˜¯é€šè¿‡å®¢æˆ·ç«¯è½®è¯¢ &lt;code&gt;/notifications/v2&lt;/code&gt; æ¥å£å®ç°çš„ã€‚å…·ä½“ä»£ç åœ¨ com.ctrip.framework.apollo.configservice.controller.NotificationControllerV2.javaã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç±»ä¹Ÿæ˜¯å®ç°äº† ReleaseMessageListener ç›‘æ§ï¼Œè¡¨æ˜ä»–æ˜¯ä¸€ä¸ªæ¶ˆæ¯ç›‘å¬å™¨ï¼Œå½“æœ‰æ–°çš„æ¶ˆæ¯æ—¶ï¼Œå°±ä¼šè°ƒç”¨ä»–çš„ hanlderMessage æ–¹æ³•ã€‚è¿™ä¸ªå…·ä½“æˆ‘ä»¬åé¢å†è¯´ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ç±»åªæœ‰ä¸€ä¸ª rest æ¥å£ï¼š pollNotification æ–¹æ³•ã€‚è¿”å›å€¼æ˜¯ DeferredResultï¼Œè¿™æ˜¯ Spring æ”¯æŒ Servlet 3 çš„ä¸€ä¸ªç±»ï¼Œå…³äºå¼‚æ­¥åŒæ­¥çš„ä¸åŒï¼Œå¯ä»¥çœ‹ç¬”è€…çš„å¦ä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;http://thinkinjava.cn/2018/07/%E5%BC%82%E6%AD%A5-Servlet-%E5%92%8C%E5%90%8C%E6%AD%A5-Servlet-%E7%9A%84%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/&quot;&gt;å¼‚æ­¥ Servlet å’ŒåŒæ­¥ Servlet çš„æ€§èƒ½æµ‹è¯•&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ¥å£æä¾›äº†å‡ ä¸ªå‚æ•°ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;appId appId&lt;/li&gt;
&lt;li&gt;cluster é›†ç¾¤åç§°&lt;/li&gt;
&lt;li&gt;notificationsAsString é€šçŸ¥å¯¹è±¡çš„ json å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;dataCenterï¼Œidc å±æ€§&lt;/li&gt;
&lt;li&gt;clientIp å®¢æˆ·ç«¯ IPï¼Œ éå¿…ä¼ ï¼Œä¸ºäº†æ‰©å±•å§ä¼°è®¡&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;å¤§å®¶æœ‰ä¹ˆæœ‰è§‰å¾—å°‘äº†ä»€ä¹ˆï¼Ÿ namespace ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæ²¡æœ‰ namespace è¿™ä¸ªé‡è¦çš„å‚æ•°æ˜¯ä¸å­˜åœ¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‚æ•°åœ¨ notificationsAsString ä¸­ã€‚å®¢æˆ·ç«¯ä¼šå°†è‡ªå·±æ‰€æœ‰çš„ namespace ä¼ é€’åˆ°æœåŠ¡ç«¯è¿›è¡ŒæŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯æ—¶å€™ä¸Šæºç äº†ã€‚&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;@RequestMapping(method = RequestMethod.GET)
  public DeferredResult&amp;lt;ResponseEntity&amp;lt;List&amp;lt;ApolloConfigNotification&amp;gt;&amp;gt;&amp;gt; pollNotification(
      @RequestParam(value = &quot;appId&quot;) String appId,// appId
      @RequestParam(value = &quot;cluster&quot;) String cluster,// default
      @RequestParam(value = &quot;notifications&quot;) String notificationsAsString,// json å¯¹è±¡ List&amp;lt;ApolloConfigNotification&amp;gt;
      @RequestParam(value = &quot;dataCenter&quot;, required = false) String dataCenter,// åŸºæœ¬ç”¨ä¸ä¸Š, idc å±æ€§
      @RequestParam(value = &quot;ip&quot;, required = false) String clientIp) {

    List&amp;lt;ApolloConfigNotification&amp;gt; notifications =// è½¬æ¢æˆå¯¹è±¡
          gson.fromJson(notificationsAsString, notificationsTypeReference);
          
    // Spring çš„å¼‚æ­¥å¯¹è±¡: timeout 60s, è¿”å›304
    DeferredResultWrapper deferredResultWrapper = new DeferredResultWrapper();
    Set&amp;lt;String&amp;gt; namespaces = Sets.newHashSet();
    Map&amp;lt;String, Long&amp;gt; clientSideNotifications = Maps.newHashMap();
    Map&amp;lt;String, ApolloConfigNotification&amp;gt; filteredNotifications = filterNotifications(appId, notifications);// è¿‡æ»¤ä¸€ä¸‹åå­—
    // å¾ªç¯
    for (Map.Entry&amp;lt;String, ApolloConfigNotification&amp;gt; notificationEntry : filteredNotifications.entrySet()) {
      // æ‹¿å‡º key
      String normalizedNamespace = notificationEntry.getKey();
      // æ‹¿å‡º value
      ApolloConfigNotification notification = notificationEntry.getValue();
      /* æ·»åŠ åˆ° namespaces Set */
      namespaces.add(normalizedNamespace);
      // æ·»åŠ åˆ° client ç«¯çš„é€šçŸ¥, key æ˜¯ namespace, values æ˜¯ messageId
      clientSideNotifications.put(normalizedNamespace, notification.getNotificationId());
      // å¦‚æœä¸ç›¸ç­‰, è®°å½•å®¢æˆ·ç«¯åå­—
      if (!Objects.equals(notification.getNamespaceName(), normalizedNamespace)) {
        // è®°å½• key = æ ‡å‡†åå­—, value = å®¢æˆ·ç«¯åå­—
        deferredResultWrapper.recordNamespaceNameNormalizedResult(notification.getNamespaceName(), normalizedNamespace);
      }
    }// è®°åœ¨ namespaces é›†åˆ, clientSideNotifications ä¹Ÿput (namespace, notificationId)

    // ç»„è£…å¾—åˆ°éœ€è¦è§‚å¯Ÿçš„ key,åŒ…æ‹¬å…¬å…±çš„.
    Multimap&amp;lt;String, String&amp;gt; watchedKeysMap =
        watchKeysUtil.assembleAllWatchKeys(appId, cluster, namespaces, dataCenter);// namespaces æ˜¯é›†åˆ
    // å¾—åˆ° value; è¿™ä¸ª value ä¹Ÿå°±æ˜¯ appId + cluster + namespace
    Set&amp;lt;String&amp;gt; watchedKeys = Sets.newHashSet(watchedKeysMap.values());
    // ä»ç¼“å­˜å¾—åˆ°æœ€æ–°çš„å‘å¸ƒæ¶ˆæ¯
    List&amp;lt;ReleaseMessage&amp;gt; latestReleaseMessages =// æ ¹æ® key ä»ç¼“å­˜å¾—åˆ°æœ€æ–°å‘å¸ƒçš„æ¶ˆæ¯.
        releaseMessageService.findLatestReleaseMessagesGroupByMessages(watchedKeys);

    /* å¦‚æœä¸å…³é—­, è¿™ä¸ªè¯·æ±‚å°†ä¼šä¸€ç›´æŒæœ‰ä¸€ä¸ªæ•°æ®åº“è¿æ¥. å½±å“å¹¶å‘èƒ½åŠ›. è¿™æ˜¯ä¸€ä¸ª hack æ“ä½œ*/
    entityManagerUtil.closeEntityManager();
    // è®¡ç®—å‡ºæ–°çš„é€šçŸ¥
    List&amp;lt;ApolloConfigNotification&amp;gt; newNotifications =
        getApolloConfigNotifications(namespaces, clientSideNotifications, watchedKeysMap,
            latestReleaseMessages);
    // ä¸æ˜¯ç©º, ç†è§£è¿”å›ç»“æœ, ä¸ç­‰å¾…
    if (!CollectionUtils.isEmpty(newNotifications)) {
      deferredResultWrapper.setResult(newNotifications);
    } else {
      // è®¾ç½® timeout å›è°ƒ:æ‰“å°æ—¥å¿—
      deferredResultWrapper
          .onTimeout(() -&amp;gt; logWatchedKeys(watchedKeys, &quot;Apollo.LongPoll.TimeOutKeys&quot;));
      // è®¾ç½®å®Œæˆå›è°ƒ:åˆ é™¤ key
      deferredResultWrapper.onCompletion(() -&amp;gt; {
        //å–æ¶ˆæ³¨å†Œ
        for (String key : watchedKeys) {
          deferredResults.remove(key, deferredResultWrapper);
        }
      });

      //register all keys æ³¨å†Œ
      for (String key : watchedKeys) {
        this.deferredResults.put(key, deferredResultWrapper);
      }
    }
    // ç«‹å³è¿”å›
    return deferredResultWrapper.getResult();/** @see DeferredResultHandler æ˜¯å…³é”® */
  }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ³¨é‡Šå†™äº†å¾ˆå¤šäº†ï¼Œå†ç®€å•è¯´è¯´é€»è¾‘ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;è§£æ JSON å­—ç¬¦ä¸²ä¸º List&amp;lt; ApolloConfigNotification&amp;gt; å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»º Spring å¼‚æ­¥å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å¤„ç†è¿‡æ»¤ namespaceã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ® namespace ç”Ÿæˆéœ€è¦ç›‘å¬çš„ keyï¼Œæ ¼å¼ä¸º appId + cluster + namespaceï¼ŒåŒ…æ‹¬å…¬å…± namespaceã€‚å¹¶è·å–æœ€æ–°çš„ Release ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;å…³é—­ Spring å®ä¾‹ç®¡ç†å™¨ï¼Œé‡Šæ”¾æ•°æ®åº“èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®åˆšåˆšå¾—åˆ°çš„ ReleaseMessageï¼Œå’Œå®¢æˆ·ç«¯çš„ ReleaseMessage çš„ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œç”Ÿæˆæ–°çš„é…ç½®é€šçŸ¥å¯¹è±¡é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ˜¯ç©º â€”â€” ç«‹å³è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç»“æŸæ­¤æ¬¡è°ƒç”¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿›å…¥ç¬¬ 8 æ­¥ã€‚&lt;/li&gt;
&lt;li&gt;è®¾ç½® timeout å›è°ƒæ–¹æ³• â€”â€” æ‰“å°æ—¥å¿—ã€‚å†è®¾ç½®å®Œæˆå›è°ƒæ–¹æ³•ï¼šåˆ é™¤æ³¨å†Œçš„ keyã€‚&lt;/li&gt;
&lt;li&gt;å¯¹å®¢æˆ·ç«¯æ„Ÿå…´è¶£çš„ key è¿›è¡Œæ³¨å†Œï¼Œè¿™äº› key éƒ½å¯¹åº”ç€ deferredResultWrapper å¯¹è±¡ï¼Œå¯ä»¥è®¤ä¸ºä»–å°±æ˜¯å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;è¿”å› Spring å¼‚æ­¥å¯¹è±¡ã€‚è¯¥è¯·æ±‚å°†è¢«å¼‚æ­¥æŒ‚èµ·ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;Apollo çš„ DeferredResultWrapper ä¿è¯äº† Spring çš„ DeferredResult å¯¹è±¡ï¼Œæ³›å‹å†…å®¹æ˜¯ Listï¼Œ æ„é€ è¿™ä¸ªå¯¹è±¡ï¼Œé»˜è®¤çš„ timeout æ˜¯ 60 ç§’ï¼Œå³æŒ‚èµ· 60 ç§’ã€‚åŒæ—¶ï¼Œå¯¹ setResult æ–¹æ³•è¿›è¡ŒåŒ…è£…ï¼ŒåŠ å…¥äº†å¯¹å®¢æˆ·ç«¯ key å’ŒæœåŠ¡ç«¯ key çš„ä¸€ä¸ªæ˜ å°„ï¼ˆå¤§å°å†™ä¸ä¸€è‡´ï¼‰ ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åˆšåˆšè¯´ï¼ŒApollo ä¼šå°†è¿™äº› key æ³¨å†Œèµ·æ¥ã€‚é‚£ä¹ˆä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘¢ï¼Œå¼‚æ­¥å¯¹è±¡è¢«æŒ‚èµ·ï¼Œåˆæ˜¯ä¸Šé¢æ—¶å€™è¢«å”¤é†’å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆå°±åœ¨ handleMessage æ–¹æ³•é‡Œã€‚æˆ‘ä»¬åˆšåˆšè¯´ä»–æ˜¯ä¸€ä¸ªç›‘å¬å™¨ï¼Œå½“æ¶ˆæ¯æ‰«æå™¨æ‰«æåˆ°æ–°çš„æ¶ˆæ¯æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„ç›‘å¬å™¨ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ handlerMessage æ–¹æ³•ã€‚æ–¹æ³•å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;@Override
public void handleMessage(ReleaseMessage message, String channel) {

  String content = message.getMessage();
  if (!Topics.APOLLO_RELEASE_TOPIC.equals(channel) || Strings.isNullOrEmpty(content)) {
    return;
  }
  String changedNamespace = retrieveNamespaceFromReleaseMessage.apply(content);

  //create a new list to avoid ConcurrentModificationException æ„é€ ä¸€ä¸ªæ–° list ,é˜²æ­¢å¹¶å‘å¤±è´¥
  List&amp;lt;DeferredResultWrapper&amp;gt; results = Lists.newArrayList(deferredResults.get(content));

  // åˆ›å»ºé€šçŸ¥å¯¹è±¡
  ApolloConfigNotification configNotification = new ApolloConfigNotification(changedNamespace, message.getId());
  configNotification.addMessage(content, message.getId());

  //do async notification if too many clients å¦‚æœæœ‰å¤§é‡çš„å®¢æˆ·ç«¯(100)åœ¨ç­‰å¾…,ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†
  if (results.size() &amp;gt; bizConfig.releaseMessageNotificationBatch()) {
    // å¤§é‡é€šçŸ¥æ‰¹é‡å¤„ç†
    largeNotificationBatchExecutorService.submit(() -&amp;gt; {
      for (int i = 0; i &amp;lt; results.size(); i++) { // å¾ªç¯
        /*
         * å‡è®¾ä¸€ä¸ªå…¬å…± Namespace æœ‰10W å°æœºå™¨ä½¿ç”¨ï¼Œå¦‚æœè¯¥å…¬å…± Namespace å‘å¸ƒæ—¶ç›´æ¥ä¸‹å‘é…ç½®æ›´æ–°æ¶ˆæ¯çš„è¯ï¼Œ
         * å°±ä¼šå¯¼è‡´è¿™ 10W å°æœºå™¨ä¸€ä¸‹å­éƒ½æ¥è¯·æ±‚é…ç½®ï¼Œè¿™åŠ¨é™å°±æœ‰ç‚¹å¤§äº†ï¼Œè€Œä¸”å¯¹ Config Service çš„å‹åŠ›ä¹Ÿä¼šæ¯”è¾ƒå¤§ã€‚
         * å³&quot;æƒŠç¾¤æ•ˆåº”&quot;
         */
        if (i &amp;gt; 0 &amp;amp;&amp;amp; i % bizConfig.releaseMessageNotificationBatch() == 0) {// å¦‚æœå¤„ç†äº†ä¸€æ‰¹å®¢æˆ·ç«¯,ä¼‘æ¯ä¸€ä¸‹(100ms)
            TimeUnit.MILLISECONDS.sleep(bizConfig.releaseMessageNotificationBatchIntervalInMilli());
        }
        results.get(i).setResult(configNotification);// é€šçŸ¥æ¯ä¸ªç­‰å¾…çš„ HTTP è¯·æ±‚
      }
    });
    return;
  }

  // å¦åˆ™,åŒæ­¥å¤„ç†
  for (DeferredResultWrapper result : results) {
    result.setResult(configNotification);
  }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç¬”è€…å»é™¤äº†ä¸€äº›æ—¥å¿—å’Œä¸€äº›æ•°æ®åˆ¤æ–­ã€‚å¤§è‡´çš„é€»è¾‘å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;æ¶ˆæ¯ç±»å‹å¿…é¡»æ˜¯ â€œapollo-releaseâ€ã€‚ç„¶åæ‹¿åˆ°æ¶ˆæ¯é‡Œçš„ namespace å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹æ® namespace ä»æ³¨å†Œå™¨é‡Œæ‹¿å‡º Spring å¼‚æ­¥å¯¹è±¡é›†åˆ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»ºé€šçŸ¥å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰è¶…è¿‡ 100 ä¸ªå®¢æˆ·ç«¯åœ¨ç­‰å¾…ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨çº¿ç¨‹æ± æ‰¹é‡æ‰§è¡Œé€šçŸ¥ã€‚å¦åˆ™å°±åŒæ­¥æ…¢æ…¢æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;æ¯å¤„ç† 100 ä¸ªå®¢æˆ·ç«¯å°±ä¼‘æ¯ 100msï¼Œé˜²æ­¢å‘ç”ŸæƒŠç¾¤æ•ˆåº”ï¼Œå¯¼è‡´å¤§é‡å®¢æˆ·ç«¯è°ƒç”¨é…ç½®è·å–æ¥å£ï¼Œå¼•èµ·æœåŠ¡æŠ–åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;å¾ªç¯è°ƒç”¨ Spring å¼‚æ­¥å¯¹è±¡çš„ setResult æ–¹æ³•ï¼Œè®©å…¶ç«‹å³è¿”å›ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;å…·ä½“çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/4236553-ca1bbe21c2a21b52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œç°è‰²åŒºåŸŸæ˜¯æ‰«æå™¨çš„å¼‚æ­¥çº¿ç¨‹ï¼Œé»„è‰²åŒºåŸŸæ˜¯æ¥å£çš„åŒæ­¥çº¿ç¨‹ã€‚ä»–ä»¬å…±äº« deferredResults è¿™ä¸ªçº¿ç¨‹å®‰å…¨çš„ Mapï¼Œå®ç°å¼‚æ­¥è§£è€¦å’Œå®æ—¶é€šçŸ¥å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å¥½äº†ï¼Œè¿™å°±æ˜¯ Apollo çš„é•¿è½®è¯¢æ¥å£ï¼Œå®¢æˆ·ç«¯ä¼šä¸æ–­çš„è½®è¯¢æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¼š Holdä½ 60 ç§’ï¼Œè¿™æ˜¯é€šè¿‡ Servlet 3 çš„å¼‚æ­¥ + NIO æ¥å®ç°çš„ï¼Œèƒ½å¤Ÿä¿æŒä¸‡çº§è¿æ¥ï¼ˆTomcat é»˜è®¤ 10000ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map + ç›‘å¬å™¨ï¼Œè®©æ‰«æå™¨çº¿ç¨‹å’Œ HTTP çº¿ç¨‹å…±äº« Spring å¼‚æ­¥å¯¹è±¡ï¼Œå³å®ç°äº†æ¶ˆæ¯å®æ—¶é€šçŸ¥ï¼Œä¹Ÿè®©åº”ç”¨ç¨‹åºå®ç°å¼‚æ­¥è§£è€¦ã€‚&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 22:12:00 +0000</pubDate>
<dc:creator>è«é‚£-é²é“</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/stateis0/p/9393871.html</dc:identifier>
</item>
<item>
<title>ã€javaä»£ç ä¹‹ç¾ã€‘---Lambda - é›¨ç‚¹çš„åå­—</title>
<link>http://www.cnblogs.com/qdhxhz/p/9393724.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/qdhxhz/p/9393724.html</guid>
<description>
&lt;h2&gt;&lt;span&gt;ä¸€ã€æ¦‚è¿°&lt;/span&gt;&lt;/h2&gt;
&lt;h4&gt;&lt;span&gt;1ã€ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;&lt;span&gt;Lambda è¡¨è¾¾å¼æ˜¯ä¸€ç§åŒ¿åå‡½æ•°ï¼Œç®€å•åœ°è¯´ï¼Œå®ƒæ˜¯æ²¡æœ‰å£°æ˜çš„æ–¹æ³•ï¼Œä¹Ÿå³æ²¡æœ‰è®¿é—®ä¿®é¥°ç¬¦ã€è¿”å›å€¼å£°æ˜å’Œåå­—ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å®ƒå¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´çµæ´»çš„ä»£ç ã€‚ä½œä¸ºä¸€ç§æ›´ç´§å‡‘çš„ä»£ç é£æ ¼ï¼Œä½¿ Java è¯­è¨€çš„è¡¨è¾¾èƒ½åŠ›å¾—åˆ°äº†æå‡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h4&gt;&lt;span&gt;2ã€&lt;strong&gt;Lambdaè¡¨è¾¾å¼çš„è¯­æ³•&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;åŸºæœ¬è¯­æ³•:Â Â (parameters) -&amp;gt; expression&lt;/p&gt;
&lt;p&gt;Â  Â  Â æˆ–è€…ï¼š(parameters) -&amp;gt;{ statements;Â &lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1. ä¸éœ€è¦å‚æ•°,è¿”å›å€¼ä¸º 5  &lt;/span&gt;
() -&amp;gt; 5  
  
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 2. æ¥æ”¶ä¸€ä¸ªå‚æ•°(æ•°å­—ç±»å‹),è¿”å›å…¶2å€çš„å€¼  &lt;/span&gt;
x -&amp;gt; 2 *&lt;span&gt; x  
  
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 3. æ¥å—2ä¸ªå‚æ•°(æ•°å­—),å¹¶è¿”å›ä»–ä»¬çš„å·®å€¼  &lt;/span&gt;
(x, y) -&amp;gt;&lt;span&gt; x â€“ y  
  
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 4. æ¥æ”¶2ä¸ªintå‹æ•´æ•°,è¿”å›ä»–ä»¬çš„å’Œ  &lt;/span&gt;
(&lt;span&gt;int&lt;/span&gt; x, &lt;span&gt;int&lt;/span&gt; y) -&amp;gt; x +&lt;span&gt; y  
  
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 5. æ¥å—ä¸€ä¸ª string å¯¹è±¡,å¹¶åœ¨æ§åˆ¶å°æ‰“å°,ä¸è¿”å›ä»»ä½•å€¼(çœ‹èµ·æ¥åƒæ˜¯è¿”å›void)  &lt;/span&gt;
(String s) -&amp;gt; System.out.print(s)  
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;span&gt;3ã€ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Â  å†å¯¹ä¸Šé¢è¿›è¡Œä¸¾ä¾‹è¯´æ˜ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ¥ç†è§£ä¸‹å‡½æ•°å¼æ¥å£ï¼Œå› ä¸ºLambdaæ˜¯å»ºç«‹åœ¨å‡½æ•°å¼æ¥å£çš„åŸºç¡€ä¸Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Â è®°ä½ï¼&lt;/strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Â  Â ï¼ˆ1ï¼‰&lt;span&gt;åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œç§°ä¸ºå‡½æ•°å¼æ¥å£ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Â  ï¼ˆ2ï¼‰&lt;span&gt;ä½ å¯ä»¥é€šè¿‡ Lambda è¡¨è¾¾å¼æ¥åˆ›å»ºè¯¥æ¥å£çš„å¯¹è±¡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Â  ï¼ˆ3ï¼‰æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„å‡½æ•°å¼æ¥å£ä¸Šä½¿ç”¨ @FunctionalInterface æ³¨è§£ï¼Œè¿™æ ·åšå¯ä»¥æ£€æµ‹å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼ŒåŒæ—¶ javadoc ä¹Ÿä¼šåŒ…å«ä¸€æ¡å£°æ˜ï¼Œè¯´æ˜è¿™ä¸ªæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…å¼€å‘è€…ğŸˆ¶ï¸ä¸¤ä¸ªæ¯”è¾ƒå¸¸è§çš„å‡½æ•°å¼æ¥å£ï¼š&lt;strong&gt;Runnableæ¥å£ï¼ŒComparatoræ¥å£&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â  Â å…ˆä¸¾ä¾‹&lt;strong&gt;Runnableæ¥å£ç›¸å…³&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Test {
    
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
        
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1.1ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»  &lt;/span&gt;
        &lt;span&gt;new&lt;/span&gt; Thread(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Runnable() {  
            @Override  
            &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; run() {  
                System.out.println(&lt;/span&gt;&quot;Hello world !&quot;&lt;span&gt;);  
            }  
        }).start();  
          
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1.2ä½¿ç”¨ lambda è·å¾—Runnableæ¥å£å¯¹è±¡  &lt;/span&gt;
        &lt;span&gt;new&lt;/span&gt; Thread(() -&amp;gt; System.out.println(&quot;Hello world !&quot;&lt;span&gt;)).start();  
        
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;=============================================================================
        
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 2.1ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»  &lt;/span&gt;
        Runnable race1 = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Runnable() {  
            @Override  
            &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; run() {  
                System.out.println(&lt;/span&gt;&quot;Hello world !&quot;&lt;span&gt;);  
            }  
        };  
          
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 2.2ä½¿ç”¨ lambdaç›´æ¥è·å¾—æ¥å£å¯¹è±¡ &lt;/span&gt;
        Runnable race2 = () -&amp;gt; System.out.println(&quot;Hello world !&quot;&lt;span&gt;);          
        
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç›´æ¥è°ƒç”¨ run æ–¹æ³•(æ²¡å¼€æ–°çº¿ç¨‹å“¦!)  &lt;/span&gt;
&lt;span&gt;        race1.run();  
        race2.run();  
    }
}
&lt;/span&gt;&lt;span&gt;/*è¾“å‡ºç»“æœ&lt;/span&gt;&lt;span&gt;
 * Hello world !
 * Hello world !
 * Hello world !
 * Hello world !
 *ï¼&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é€šè¿‡ä¸Šé¢æ¡ˆä¾‹å¯ä»¥çœ‹å‡ºï¼šé€šè¿‡Lambdaè¡¨è¾¾å¼çœ‹å»èˆ’æœæ¸…çˆ½å¤šäº†ï¼Œ2è€Œé€šè¿‡åŒ¿åå†…éƒ¨ç±»ä»£ç æ€»æ˜¯ä¸å¤Ÿæ•´æ´ã€‚&lt;/p&gt;
&lt;p&gt;å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š&lt;strong&gt;ä½¿ç”¨Lambdaå¯¹æ•°ç»„æ’åº&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;55&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; TestArray {
    
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
        String[] players &lt;/span&gt;= {&quot;zhansgan&quot;, &quot;lisi&quot;, &quot;wangwu&quot;, &quot;zhaoliu&quot;,  &quot;wangmazi&quot;&lt;span&gt;};  

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1.1 ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ ¹æ® surname æ’åº players  &lt;/span&gt;
        Arrays.sort(players, &lt;span&gt;new&lt;/span&gt; Comparator&amp;lt;String&amp;gt;&lt;span&gt;() {  
            @Override  
            &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compare(String s1, String s2) {  
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; (s1.compareTo(s2));  
            }  
        });  
        
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1.2 ä½¿ç”¨ lambda æ’åº,æ ¹æ® surname  &lt;/span&gt;
        Arrays.sort(players, (String s1, String s2) -&amp;gt;&lt;span&gt;  s1.compareTo(s2));  
         
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;================================================================================================
          
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 2.1 ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ ¹æ® name lenght æ’åº players  &lt;/span&gt;
        Arrays.sort(players, &lt;span&gt;new&lt;/span&gt; Comparator&amp;lt;String&amp;gt;&lt;span&gt;() {  
            @Override  
            &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compare(String s1, String s2) {  
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; (s1.length() -&lt;span&gt; s2.length());  
            }  
        });  

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 2.2ä½¿ç”¨Lambda,æ ¹æ®name length  &lt;/span&gt;
        Arrays.sort(players, (String s1, String s2) -&amp;gt; (s1.length() -&lt;span&gt; s2.length()));  
    
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;==================================================================================================    
        
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 3.1 ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ’åº players, æ ¹æ®æœ€åä¸€ä¸ªå­—æ¯  &lt;/span&gt;
        Arrays.sort(players, &lt;span&gt;new&lt;/span&gt; Comparator&amp;lt;String&amp;gt;&lt;span&gt;() {  
            @Override  
            &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compare(String s1, String s2) {  
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; (s1.charAt(s1.length() - 1) - s2.charAt(s2.length() - 1&lt;span&gt;));  
            }  
        });  

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 3.2 ä½¿ç”¨Lambda,æ ¹æ®æœ€åä¸€ä¸ªå­—æ¯&lt;/span&gt;
        Arrays.sort(players, (String s1, String s2) -&amp;gt; (s1.charAt(s1.length() - 1) - s2.charAt(s2.length() - 1&lt;span&gt;)));  
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é€šè¿‡ä¸Šé¢ä¾‹å­æˆ‘ä»¬å†æ¥æ€è€ƒä¸ºä»€ä¹ˆLambdaè¡¨è¾¾å¼éœ€è¦å‡½æ•°å¼æ¥å£ï¼Ÿå…¶å®å¾ˆç®€å•ç›®çš„å°±æ˜¯ä¸ºæ¥ä¿è¯å”¯ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½ çš„&lt;/strong&gt;Runnableæ¥å£åªè¦ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ç”¨() -&amp;gt; System.out.println(&quot;Hello world !&quot;)ï¼Œå°±åªèƒ½ä»£è¡¨runæ–¹æ³•ï¼Œå¦‚æœä½ ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé‚£æˆ‘ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œé‚£é¬¼æ‰çŸ¥é“è¦è°ƒç”¨å“ªä¸ªæŠ½è±¡æ–¹æ³•å‘¢ã€‚&lt;/p&gt;

&lt;h2&gt;&lt;span&gt;&lt;strong&gt;äºŒã€æ–¹æ³•å¼•ç”¨&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;h4&gt;&lt;span&gt;&lt;strong&gt;1ã€åŸºæœ¬ä»‹ç»&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;é¦–å…ˆæ³¨æ„ï¼š&lt;/strong&gt;æ–¹æ³•å¼•ç”¨ï¼Œä¸æ˜¯æ–¹æ³•è°ƒç”¨ï¼æ–¹æ³•å¼•ç”¨ï¼Œä¸æ˜¯æ–¹æ³•è°ƒç”¨ï¼æ–¹æ³•å¼•ç”¨ï¼Œä¸æ˜¯æ–¹æ³•è°ƒç”¨ï¼&lt;/p&gt;
&lt;p&gt;å‡½æ•°å¼æ¥å£çš„å®ä¾‹å¯ä»¥é€šè¿‡ lambda è¡¨è¾¾å¼ã€ æ–¹æ³•å¼•ç”¨ã€æ„é€ æ–¹æ³•å¼•ç”¨æ¥åˆ›å»ºã€‚æ–¹æ³•å¼•ç”¨æ˜¯ lambda è¡¨è¾¾å¼çš„è¯­æ³•ç³–ï¼Œä»»ä½•ç”¨æ–¹æ³•å¼•ç”¨çš„åœ°æ–¹éƒ½å¯ç”±lambdaè¡¨è¾¾å¼æ›¿æ¢ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„lambdaè¡¨è¾¾å¼éƒ½å¯ä»¥ç”¨æ–¹æ³•å¼•ç”¨æ¥æ›¿æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸€ä¸ªæ‰“å°é›†åˆæ‰€æœ‰å…ƒç´ çš„ä¾‹å­ï¼Œvalue -&amp;gt; System.out.println(value) æ˜¯ä¸€ä¸ªConsumerå‡½æ•°å¼æ¥å£ï¼ŒÂ è¿™ä¸ªå‡½æ•°å¼æ¥å£å¯ä»¥é€šè¿‡æ–¹æ³•å¼•ç”¨æ¥æ›¿æ¢ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; TestArray {
    
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
         List&lt;/span&gt;&amp;lt;String&amp;gt; list = Arrays.asList(&quot;xuxiaoxiao&quot;, &quot;xudada&quot;, &quot;xuzhongzhong&quot;&lt;span&gt;);
           list.forEach(value &lt;/span&gt;-&amp;gt;&lt;span&gt; System.out.println(value));
    }
    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt; è¾“å‡ºï¼š
     * xuxiaoxiao
     * xudada
     * xuzhongzhong
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½¿ç”¨æ–¹æ³•å¼•ç”¨çš„æ–¹å¼ï¼Œå’Œä¸Šé¢çš„è¾“å‡ºæ˜¯ä¸€æ ·çš„ï¼Œ&lt;span&gt;æ–¹æ³•å¼•ç”¨ä½¿ç”¨çš„æ˜¯åŒå†’å·ï¼ˆ::ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
list.forEach(System.out::println);
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;span&gt;2ã€åˆ†ç±»&lt;/span&gt;&lt;/h4&gt;
&lt;table align=&quot;left&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;ç±»åˆ«&lt;/th&gt;
&lt;th&gt;&lt;span&gt;ä½¿ç”¨å½¢å¼&lt;/span&gt;&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;3&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;é™æ€æ–¹æ³•å¼•ç”¨&lt;/td&gt;
&lt;td&gt;&lt;span&gt;ç±»å :: é™æ€æ–¹æ³•å&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;å®ä¾‹æ–¹æ³•å¼•ç”¨&lt;/td&gt;
&lt;td&gt;&lt;span&gt;å¯¹è±¡å(å¼•ç”¨å) :: å®ä¾‹æ–¹æ³•å&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;ç±»æ–¹æ³•å¼•ç”¨&lt;/td&gt;
&lt;td&gt;&lt;span&gt;ç±»å :: å®ä¾‹æ–¹æ³•å&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;æ„é€ æ–¹æ³•å¼•ç”¨&lt;/td&gt;
&lt;td&gt;&lt;span&gt;ç±»å :: new&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;





&lt;p&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1ï¼‰é™æ€æ–¹æ³•å¼•ç”¨&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Apple {

    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String name;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String color;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;double&lt;/span&gt;&lt;span&gt; weight;

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Apple(String name, String color, &lt;span&gt;double&lt;/span&gt;&lt;span&gt; weight) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.color =&lt;span&gt; color;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.weight =&lt;span&gt; weight;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compareByWeight(Apple a1, Apple a2) {
        &lt;/span&gt;&lt;span&gt;double&lt;/span&gt; diff = a1.getWeight() -&lt;span&gt; a2.getWeight();
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Double(diff).intValue();
    }

    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è¿˜æœ‰getter setter toString&lt;/span&gt;
}    
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªè‹¹æœçš„Listï¼Œç°åœ¨éœ€è¦æ ¹æ®è‹¹æœçš„é‡é‡è¿›è¡Œæ’åºã€‚List çš„ sort å‡½æ•°æ¥æ”¶ä¸€ä¸ª Comparator ç±»å‹çš„å‚æ•°ï¼ŒComparator æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªintå€¼ã€‚&lt;/p&gt;
&lt;p&gt;Appleçš„é™æ€æ–¹æ³•compareByWeightæ­£å¥½ç¬¦åˆComparatorå‡½æ•°å¼æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;Apple::compareByWeightÂ &lt;span&gt;é™æ€æ–¹æ³•å¼•ç”¨&lt;/span&gt;æ¥æ›¿ä»£lambdaè¡¨è¾¾å¼&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;55&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LambdaTest {

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {

        Apple apple1 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;çº¢å¯Œå£«&quot;, &quot;Red&quot;, 280&lt;span&gt;);
        Apple apple2 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å†¯å¿ƒ&quot;, &quot;Yello&quot;, 470&lt;span&gt;);
        Apple apple3 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å¤§ç‰›&quot;, &quot;Red&quot;, 320&lt;span&gt;);
        Apple apple4 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å°å°&quot;, &quot;Green&quot;, 300&lt;span&gt;);

        List&lt;/span&gt;&amp;lt;Apple&amp;gt; appleList =&lt;span&gt; Arrays.asList(apple1, apple2, apple3, apple4);

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;lambda è¡¨è¾¾å¼å½¢å¼
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;appleList.sort((Apple a1, Apple a2) -&amp;gt; {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;    return new Double(a1.getWeight() - a2.getWeight()).intValue();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;});

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é™æ€æ–¹æ³•å¼•ç”¨å½¢å¼ï¼ˆå¯ä»¥çœ‹å‡ºå¼•ç”¨æ–¹æ³•æ¯”ä¸Šé¢çš„æ›´åŠ ç®€å•&lt;/span&gt;
&lt;span&gt;        appleList.sort(Apple::compareByWeight);

        appleList.forEach(apple &lt;/span&gt;-&amp;gt;&lt;span&gt; System.out.println(apple));

    }
}
è¾“å‡ºï¼š
Apple{category&lt;/span&gt;='çº¢å¯Œå£«', color='Red', weight=280.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å°å°', color='Green', weight=300.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å¤§ç‰›', color='Red', weight=320.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å†¯å¿ƒ', color='Yello', weight=470.0}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;&lt;/span&gt;Apple.compareByWeightæ˜¯æ–¹æ³•çš„è°ƒç”¨ï¼Œè€ŒApple::compareByWeightæ–¹æ³•å¼•ç”¨ï¼Œè¿™ä¸¤è€…å®Œå…¨ä¸æ˜¯ä¸€å›äº‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ï¼ˆ2ï¼‰&lt;/span&gt;å®ä¾‹æ–¹æ³•å¼•ç”¨&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªcompareByWeightæ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; AppleComparator {

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compareByWeight(Apple a1, Apple a2) {
        &lt;/span&gt;&lt;span&gt;double&lt;/span&gt; diff = a1.getWeight() -&lt;span&gt; a2.getWeight();
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Double(diff).intValue();
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸‹é¢çš„ä¾‹å­é€šè¿‡&lt;span&gt;å®ä¾‹å¯¹è±¡çš„æ–¹æ³•å¼•ç”¨&lt;/span&gt;Â comparator::compareByWeight æ¥ä»£æ›¿lambdaè¡¨è¾¾å¼&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;55&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LambdaTest {

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {

        Apple apple1 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;çº¢å¯Œå£«&quot;, &quot;Red&quot;, 280&lt;span&gt;);
        Apple apple2 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å†¯å¿ƒ&quot;, &quot;Yello&quot;, 470&lt;span&gt;);
        Apple apple3 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å“ˆå“ˆ&quot;, &quot;Red&quot;, 320&lt;span&gt;);
        Apple apple4 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å°å°&quot;, &quot;Green&quot;, 300&lt;span&gt;);


        List&lt;/span&gt;&amp;lt;Apple&amp;gt; appleList =&lt;span&gt; Arrays.asList(apple1, apple2, apple3, apple4);

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;lambda è¡¨è¾¾å¼å½¢å¼
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;appleList.sort((Apple a1, Apple a2) -&amp;gt; {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;    return new Double(a1.getWeight() - a2.getWeight()).intValue();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;});

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®ä¾‹æ–¹æ³•å¼•ç”¨&lt;/span&gt;
        AppleComparator comparator = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; AppleComparator();
        appleList.sort(comparator::compareByWeight);

        appleList.forEach(apple &lt;/span&gt;-&amp;gt;&lt;span&gt; System.out.println(apple));

    }
}
è¾“å‡ºï¼š
Apple{category&lt;/span&gt;='çº¢å¯Œå£«', color='Red', weight=280.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å°å°', color='Green', weight=300.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å“ˆå“ˆ', color='Red', weight=320.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å†¯å¿ƒ', color='Yello', weight=470.0}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œé™æ€æ–¹æ³•å¼•ç”¨å’Œå®ä¾‹æ–¹æ³•å¼•ç”¨éƒ½æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ï¼ˆ3ï¼‰ç±»æ–¹æ³•å¼•ç”¨&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼ŒåŒç±»å‹å¯¹è±¡çš„æ¯”è¾ƒï¼Œåº”è¯¥å½“å‰è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡ä¸å¦å¤–ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼Œå¥½çš„è®¾è®¡åº”è¯¥åƒä¸‹é¢ï¼šÂ &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Apple {

    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String category;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String color;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;double&lt;/span&gt;&lt;span&gt; weight;

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Apple(String category, String color, &lt;span&gt;double&lt;/span&gt;&lt;span&gt; weight) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.category =&lt;span&gt; category;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.color =&lt;span&gt; color;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.weight =&lt;span&gt; weight;
    }
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è¿™é‡Œå’Œä¸Šé¢é™æ€æ–¹å¼å”¯ä¸€åŒºåˆ«å°±æ˜¯è¿™ä¸ªå‚æ•°å°±ä¸€ä¸ªï¼Œéœ€è¦å®ä¾‹å¯¹è±¡è°ƒè¿™ä¸ªæ–¹æ³•&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; compareByWeight(Apple other) {
        &lt;/span&gt;&lt;span&gt;double&lt;/span&gt; diff = &lt;span&gt;this&lt;/span&gt;.getWeight() -&lt;span&gt; other.getWeight();
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Double(diff).intValue();
    }

    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;getter setter toString&lt;/span&gt;
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Â  Â  è¿˜æ˜¯ä¹‹å‰Listæ’åºçš„ä¾‹å­ï¼Œçœ‹çœ‹ä½¿ç”¨ç±»æ–¹æ³•å¼•ç”¨å¦‚ä½•å†™ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;55&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LambdaTest {

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {

        Apple apple1 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;çº¢å¯Œå£«&quot;, &quot;Red&quot;, 280&lt;span&gt;);
        Apple apple2 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;é»„å…ƒå¸…&quot;, &quot;Yello&quot;, 470&lt;span&gt;);
        Apple apple3 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;çº¢å°†å†›&quot;, &quot;Red&quot;, 320&lt;span&gt;);
        Apple apple4 &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Apple(&quot;å›½å…‰&quot;, &quot;Green&quot;, 300&lt;span&gt;);


        List&lt;/span&gt;&amp;lt;Apple&amp;gt; appleList =&lt;span&gt; Arrays.asList(apple1, apple2, apple3, apple4);

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;lambda è¡¨è¾¾å¼å½¢å¼
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;appleList.sort((Apple a1, Apple a2) -&amp;gt; {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;    return new Double(a1.getWeight() - a2.getWeight()).intValue();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;});

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è¿™é‡Œæ˜¯ç±»æ–¹æ³•å¼•ç”¨&lt;/span&gt;
&lt;span&gt;        appleList.sort(Apple::compareByWeight);

        appleList.forEach(apple &lt;/span&gt;-&amp;gt;&lt;span&gt; System.out.println(apple));

    }
}
è¾“å‡ºï¼š
Apple{category&lt;/span&gt;='çº¢å¯Œå£«', color='Red', weight=280.0&lt;span&gt;}
Apple{category&lt;/span&gt;='å›½å…‰', color='Green', weight=300.0&lt;span&gt;}
Apple{category&lt;/span&gt;='çº¢å°†å†›', color='Red', weight=320.0&lt;span&gt;}
Apple{category&lt;/span&gt;='é»„å…ƒå¸…', color='Yello', weight=470.0}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Â  Â  Â è¿™é‡Œä½¿ç”¨çš„æ˜¯ï¼š&lt;span&gt;ç±»å::å®ä¾‹æ–¹æ³•å&lt;/span&gt;ã€‚é¦–å…ˆè¦è¯´æ˜çš„æ˜¯ï¼Œæ–¹æ³•å¼•ç”¨ä¸æ˜¯æ–¹æ³•è°ƒç”¨ã€‚compareByWeightä¸€å®šæ˜¯æŸä¸ªå®ä¾‹è°ƒç”¨çš„ï¼Œå°±æ˜¯lambdaè¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶ålambdaè¡¨è¾¾å¼å‰©ä¸‹çš„å‚æ•°ä½œä¸ºÂ &lt;/p&gt;
&lt;p&gt;compareByWeightçš„å‚æ•°ï¼Œè¿™æ ·compareByWeightæ­£å¥½ç¬¦åˆlambdaè¡¨è¾¾å¼çš„å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼š&lt;/p&gt;
&lt;p&gt;(Apple a1, Apple a2) -&amp;gt; { return new Double(a1.getWeight() - a2.getWeight()).intValue(); }&lt;/p&gt;
&lt;p&gt;int compareByWeight(Apple other) éœ€è¦å½“å‰å¯¹è±¡è°ƒç”¨ï¼Œç„¶åä¸å¦å¤–ä¸€ä¸ªå¯¹è±¡æ¯”è¾ƒï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªintå€¼ã€‚å¯ä»¥ç†è§£ä¸ºlambdaè¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªå‚æ•° a1 èµ‹å€¼ç»™å½“å‰å¯¹è±¡ï¼Œ ç„¶å a2 èµ‹å€¼ç»™ otherå¯¹è±¡ï¼Œç„¶åè¿”å›intå€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ4ï¼‰æ„é€ æ–¹æ³•å¼•ç”¨&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ConstructionMethodTest {

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; String getString(Supplier&amp;lt;String&amp;gt;&lt;span&gt; supplier) {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; supplier.get();
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {

        ConstructionMethodTest test &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ConstructionMethodTest();

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;lambdaè¡¨è¾¾å¼å½¢å¼&lt;/span&gt;
        System.out.println(test.getString(() -&amp;gt; { &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; String();}));

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ„é€ æ–¹æ³•å¼•ç”¨å½¢å¼&lt;/span&gt;
        System.out.println(test.getString(String::&lt;span&gt;new&lt;/span&gt;&lt;span&gt;));

    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;getString æ–¹æ³•æ¥æ”¶ä¸€ä¸ªSupplierç±»å‹çš„å‚æ•°ï¼ŒSupplier ä¸æ¥æ”¶å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªStringã€‚lambdaè¡¨è¾¾å¼åº”è¯¥è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
() -&amp;gt; { &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; String();}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ›¿æ¢æˆæ–¹æ³•å¼•ç”¨çš„å½¢å¼å¦‚ä¸‹ï¼š å®é™…ä¸Šè°ƒç”¨çš„æ˜¯String æ— å‚æ„é€ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot;&gt;
&lt;pre&gt;
String::&lt;span&gt;new&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;&lt;span&gt;å‚è€ƒ&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;Â  Â  1ã€&lt;/span&gt;&lt;a id=&quot;cb_post_title_url&quot; class=&quot;postTitle2&quot; href=&quot;https://www.cnblogs.com/franson-2016/p/5593080.html&quot;&gt;Javaä¸­Lambdaè¡¨è¾¾å¼çš„ä½¿ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Â  Â  2ã€&lt;a href=&quot;https://blog.csdn.net/yitian_66/article/details/80652656&quot; target=&quot;_blank&quot;&gt;java8ç‰¹æ€§æ¦‚è¦ä»¥åŠdemoåˆ†æ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Â  Â  3&lt;a href=&quot;https://blog.csdn.net/yitian_66/article/details/80652656&quot; target=&quot;_blank&quot;&gt;ã€&lt;/a&gt;&lt;a href=&quot;https://blog.csdn.net/yitian_66/article/details/80652656&quot; target=&quot;_blank&quot;&gt;java8 ç¬”è®° - æ–¹æ³•å¼•ç”¨ï¼ˆå››ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;æƒ³å¤ªå¤šï¼Œåšå¤ªå°‘ï¼Œä¸­é—´çš„è½å·®å°±æ˜¯çƒ¦æ¼ã€‚æƒ³æ²¡æœ‰çƒ¦æ¼ï¼Œè¦ä¹ˆåˆ«æƒ³ï¼Œè¦ä¹ˆå¤šåšã€‚ä¸­æ ¡ã€9ã€‘&lt;/strong&gt;Â &lt;/span&gt;&lt;/p&gt;

</description>
<pubDate>Mon, 30 Jul 2018 17:21:00 +0000</pubDate>
<dc:creator>é›¨ç‚¹çš„åå­—</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/qdhxhz/p/9393724.html</dc:identifier>
</item>
<item>
<title>ç±»çš„ç»§æ‰¿ - æˆ‘æ˜¯leon</title>
<link>http://www.cnblogs.com/walls/p/9393686.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/walls/p/9393686.html</guid>
<description>&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;æœ¬æ–‡è®²è¿°JavaScriptä¸­ç±»ç»§æ‰¿çš„å®ç°æ–¹å¼ï¼Œå¹¶æ¯”è¾ƒå®ç°æ–¹å¼çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;ä¸€ä½•ä¸ºç»§æ‰¿&quot;&gt;ä¸€ã€ä½•ä¸ºç»§æ‰¿&lt;/h2&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;ç»§æ‰¿ï¼Œæ˜¯å­ç±»ç»§æ‰¿çˆ¶ç±»çš„ç‰¹å¾å’Œè¡Œä¸ºï¼Œä½¿å¾—å­ç±»å¯¹è±¡å…·æœ‰çˆ¶ç±»çš„å®ä¾‹åŸŸå’Œæ–¹æ³•ã€‚&lt;br/&gt;ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ä¼˜ç‚¹&quot;&gt;1.1 ä¼˜ç‚¹&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;å‡å°‘ä»£ç å†—ä½™&lt;/code&gt; çˆ¶ç±»å¯ä»¥ä¸ºå­ç±»æä¾›é€šç”¨çš„å±æ€§ï¼Œè€Œä¸å¿…å› ä¸ºå¢åŠ åŠŸèƒ½ï¼Œè€Œé€ä¸ªä¿®æ”¹å­ç±»çš„å±æ€§&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ä»£ç å¤ç”¨&lt;/code&gt; åŒä¸Š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ä»£ç æ˜“äºç®¡ç†å’Œæ‰©å±•&lt;/code&gt; å­ç±»åœ¨çˆ¶ç±»åŸºç¡€ä¸Šï¼Œå¯ä»¥å®ç°è‡ªå·±çš„ç‹¬ç‰¹åŠŸèƒ½&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;ç¼ºç‚¹&quot;&gt;1.2 ç¼ºç‚¹&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;è€¦åˆåº¦é«˜&lt;/code&gt; å¦‚æœä¿®æ”¹çˆ¶ç±»ä»£ç ï¼Œå°†å½±å“æ‰€æœ‰ç»§æ‰¿äºå®ƒçš„å­ç±»&lt;/li&gt;
&lt;li&gt;&lt;code&gt;å½±å“æ€§èƒ½&lt;/code&gt; å­ç±»ç»§æ‰¿äºçˆ¶ç±»çš„æ•°æ®æˆå‘˜ï¼Œæœ‰äº›æ˜¯æ²¡æœ‰ä½¿ç”¨ä»·å€¼çš„ã€‚ä½†æ˜¯ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå·²ç»åˆ†é…äº†å†…å­˜ã€‚æ‰€ä»¥ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå½±å“ç¨‹åºæ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;äºŒä¾‹å­&quot;&gt;äºŒã€ä¾‹å­&lt;/h2&gt;
&lt;p&gt;ä¾‹å­ä»¥å›¾ä¹¦é¦†ä¸­çš„ä¹¦å…¥åº“å½’ç±»ä¸ºä¾‹ã€‚&lt;br/&gt;ä»¥ä¸‹æ˜¯ç®€åŒ–åçš„çˆ¶ç±»&lt;code&gt;Book&lt;/code&gt;ï¼ˆä¹Ÿå¯ç§°ä¸ºåŸºç±»ï¼‰ã€‚&lt;br/&gt;ç›®çš„æ˜¯é€šè¿‡ç»§æ‰¿è¯¥çˆ¶ç±»ï¼Œäº§å‡º&lt;code&gt;Computer&lt;/code&gt;ï¼ˆè®¡ç®—æœºï¼‰å­ç±»ã€‚&lt;br/&gt;å¹¶ä¸”ï¼Œå­ç±»æ‹¥æœ‰æ–°æ–¹æ³•&lt;code&gt;say&lt;/code&gt;ï¼Œè¾“å‡ºè‡ªå·±çš„ä¹¦åã€‚&lt;/p&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;function Book(){
    this.name = ''; // ä¹¦å
    this.page = 0; // é¡µæ•°
    this.classify = ''; // ç±»å‹
}
Book.prototype = {
    constructor: Book,
    init: function(option){
        this.name = option.name || '';
        this.page = option.page || 0;
        this.classify = option.classify || '';
    },
    getName: function(){
        console.log(this.name);
    },
    getPage: function(){
        console.log(this.page);
    },
    getClassify: function(){
        console.log(this.classify);
    }
};&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä¼šè®²è§£å­ç±»&lt;code&gt;Computer&lt;/code&gt;å‡ ç§ç»§æ‰¿æ–¹å¼çš„å®ç°å’Œä¼˜åŒ–æ–¹æ³•ã€‚å¼€å§‹é£™è½¦~&lt;/p&gt;
&lt;h2 id=&quot;ä¸‰å®ä¾‹å¼ç»§æ‰¿&quot;&gt;ä¸‰ã€å®ä¾‹å¼ç»§æ‰¿&lt;/h2&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;function Computer(){
    Book.apply(this, arguments);
}
Computer.prototype = new Book();
Computer.prototype.constructor = Computer;
Computer.prototype.init = function(option){
    option.classify = 'computer';
    Book.prototype.init.call(this, option);
};
Computer.prototype.say = function(){
    console.log('I\'m '+ this.name);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;è°ƒç”¨çˆ¶ç±»æ„é€ å™¨è¿›è¡Œåˆå§‹åŒ–&quot;&gt;3.1 è°ƒç”¨çˆ¶ç±»æ„é€ å™¨è¿›è¡Œåˆå§‹åŒ–&lt;/h3&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;function Computer(){
    Book.apply(this, arguments);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;Computer&lt;/code&gt;çš„æ„é€ å‡½æ•°é‡Œï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–æ“ä½œã€‚ä½¿å­ç±»æ‹¥æœ‰çˆ¶ç±»ä¸€æ ·çš„åˆå§‹åŒ–å±æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å°†çˆ¶ç±»çš„åŸå‹ä¼ é€’ç»™å­ç±»&quot;&gt;3.2 å°†çˆ¶ç±»çš„åŸå‹ä¼ é€’ç»™å­ç±»&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Computer.prototype = new Book();&lt;/code&gt;ä½¿ç”¨newæ“ä½œç¬¦å¯¹çˆ¶ç±»&lt;code&gt;Book&lt;/code&gt;è¿›è¡Œå®ä¾‹åŒ–,å¹¶å°†å®ä¾‹å¯¹è±¡èµ‹å€¼ç»™å­ç±»çš„&lt;code&gt;prototype&lt;/code&gt;ã€‚&lt;br/&gt;è¿™æ ·ï¼Œå­ç±»&lt;code&gt;Computer&lt;/code&gt;å°±å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°çˆ¶ç±»çš„å±æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ç¼ºç‚¹-1&quot;&gt;3.3 ç¼ºç‚¹&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;çˆ¶ç±»&lt;code&gt;Book&lt;/code&gt;çš„æ„é€ å‡½æ•°è¢«æ‰§è¡Œäº†2æ¬¡&lt;/strong&gt;
&lt;ul&gt;&lt;li&gt;ä¸€æ¬¡æ˜¯åœ¨&lt;code&gt;Computer&lt;/code&gt;çš„æ„é€ å‡½æ•°é‡Œ&lt;code&gt;Book.apply(this, arguments);&lt;/code&gt;&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;ä¸€æ¬¡æ˜¯åœ¨&lt;code&gt;Computer.prototype = new Book();&lt;/code&gt;&lt;br/&gt;è¿™ç§æ¨¡å¼ï¼Œå­˜åœ¨ä¸€å®šçš„æ€§èƒ½æµªè´¹ã€‚&lt;br/&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çˆ¶ç±»å®ä¾‹åŒ–æ— æ³•ä¼ å‚&lt;/strong&gt;&lt;br/&gt;&lt;code&gt;Computer.prototype = new Book();&lt;/code&gt;ï¼Œè¿™ç§å®ä¾‹åŒ–æ–¹å¼ï¼Œæ— æ³•è®©&lt;code&gt;Book&lt;/code&gt;çˆ¶ç±»æ¥æ”¶ä¸å›ºå®šçš„å‚æ•°é›†åˆã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;å››åŸå‹å¼ç»§æ‰¿&quot;&gt;å››ã€åŸå‹å¼ç»§æ‰¿&lt;/h2&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;function Computer(){
    Book.apply(this, arguments);
}
Computer.prototype = Object.create(Book.prototype);
Computer.prototype.constructor = Computer;
Computer.prototype.init = function(option){
    option.classify = 'computer';
    Book.prototype.init(option);
};
Computer.prototype.say = function(){
    console.log('I\'m '+ this.name);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œçš„æ”¹è¿›ï¼šæ˜¯ä½¿ç”¨&lt;code&gt;Object.create(Book.prototype)&lt;/code&gt;ã€‚å®ƒçš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªç»§æ‰¿è‡ªåŸå‹å¯¹è±¡&lt;code&gt;Book.prototype&lt;/code&gt;çš„æ–°å¯¹è±¡ã€‚ä¸”è¯¥å¯¹è±¡ä¸‹çš„å±æ€§å·²ç»åˆå§‹åŒ–ã€‚&lt;br/&gt;ç”¨&lt;code&gt;Object.create&lt;/code&gt;ç”Ÿæˆæ–°å¯¹è±¡ï¼Œå¹¶ä¸ä¼šè°ƒç”¨åˆ°&lt;code&gt;Book&lt;/code&gt;çš„æ„é€ å‡½æ•°ã€‚&lt;br/&gt;è¿™ç§æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ã€‚&lt;/p&gt;
&lt;h2 id=&quot;äº”object.createçš„ç®€å•ç‰ˆå…¼å®¹&quot;&gt;äº”ã€Object.createçš„ç®€å•ç‰ˆå…¼å®¹&lt;/h2&gt;
&lt;p&gt;ç”±äºä½ç‰ˆæœ¬çš„æµè§ˆå™¨æ˜¯ä¸æ”¯æŒ&lt;code&gt;Object.create&lt;/code&gt;çš„ã€‚æ‰€ä»¥è¿™é‡Œç®€å•ä»‹ç»ä¸‹å…¼å®¹ç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;Object.create = function(prototype){
    function F(){}
    F.prototype = prototype;
    return new F();
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åŸç†æ˜¯å®šä¹‰ä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°ï¼Œç„¶åä¿®æ”¹å…¶åŸå‹ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªè·³æ¿ï¼Œå¯ä»¥å°†åŸå‹é“¾ä¼ é€’åˆ°çœŸæ­£çš„prototypeã€‚&lt;/p&gt;
&lt;h2 id=&quot;å…­å‡½æ•°åŒ–ç»§æ‰¿&quot;&gt;å…­ã€å‡½æ•°åŒ–ç»§æ‰¿&lt;/h2&gt;
&lt;p&gt;ä¸Šè¿°ä¸¤ç§å®ç°æ–¹å¼ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šä¸å­˜åœ¨&lt;code&gt;ç§æœ‰å±æ€§&lt;/code&gt;å’Œ&lt;code&gt;ç§æœ‰æ–¹æ³•&lt;/code&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚&lt;br/&gt;æ¥ä¸‹æ¥å°±ç”¨å‡½æ•°åŒ–æ¥åŒ–è§£è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;function book(spec, my){
    var that = {};

    // ç§æœ‰å˜é‡
    spec.name = spec.name || ''; // ä¹¦å
    spec.page = spec.page || 0; // é¡µæ•°
    spec.classify = spec.classify || ''; // ç±»å‹

    var getName = function(){
        console.log(spec.name);
    };
    var getPage = function(){
        console.log(spec.page);
    };
    var getClassify = function(){
        console.log(spec.classify);
    };

    that.getName = getName;
    that.getPage = getPage;
    that.getClassify = getClassify;

    return that;
}

function computer(spec, my){
    spec = spec || {};
    spec.classify = 'computer';
    var that = book(spec, my);

    var say = function(){
        console.log('I\'m '+ spec.name);
    };
    that.say = say;

    return that;
}

var Ninja = computer({name: 'JavaScriptå¿è€…ç§˜ç±', page: 350});&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°åŒ–çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯å¯ä»¥æ›´å¥½åœ°è¿›è¡Œå°è£…å’Œä¿¡æ¯éšè—ã€‚&lt;/strong&gt;&lt;br/&gt;ä¹Ÿè®¸æœ‰äººç–‘æƒ‘ä¸ºä»€ä¹ˆç”¨ä»¥ä¸‹è¿™ç§æ–¹å¼å£°æ˜å’Œæš´éœ²æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;var say = function(){
    console.log('I\'m '+ spec.name);
};
that.say = say;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶å®æ˜¯ä¸ºäº†ä¿æŠ¤å¯¹è±¡è‡ªèº«çš„å®Œæ•´æ€§ã€‚å³ä½¿&lt;code&gt;that.say&lt;/code&gt;è¢«å¤–éƒ¨ç¯¡æ”¹æˆ–ç ´åæ‰ï¼Œ&lt;code&gt;function computer&lt;/code&gt;å†…éƒ¨çš„&lt;code&gt;say&lt;/code&gt;æ–¹æ³•ä»ç„¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚&lt;br/&gt;å¦å¤–ï¼Œè§£é‡Šä¸‹&lt;code&gt;that&lt;/code&gt;ã€&lt;code&gt;spec&lt;/code&gt;å’Œ&lt;code&gt;my&lt;/code&gt;çš„ä½œç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;that&lt;/code&gt;æ˜¯ä¸€ä¸ªå…¬å¼€æ•°æ®å­˜å‚¨å®¹å™¨ï¼Œæš´éœ²å‡ºå»çš„æ•°æ®æ¥å£ï¼Œéƒ½æ”¾åˆ°è¿™ä¸ªå®¹å™¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;spec&lt;/code&gt;æ˜¯ç”¨æ¥å­˜å‚¨åˆ›å»ºæ–°å®ä¾‹æ‰€éœ€çš„ä¿¡æ¯ï¼Œå±äºå®ä¾‹ä¹‹é—´å…±åŒç¼–è¾‘çš„æ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;my&lt;/code&gt;æ˜¯ç”¨æ¥å­˜å‚¨çˆ¶ç±»ã€å­ç±»ä¹‹é—´å…±äº«çš„ç§å¯†æ•°æ®å®¹å™¨ï¼Œå¤–éƒ¨æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;ä¸ƒes6ç»§æ‰¿&quot;&gt;ä¸ƒã€ES6ç»§æ‰¿&lt;/h2&gt;
&lt;p&gt;æœ€åï¼Œçœ‹ä¸‹ç°ä»£ç‰ˆES6çš„ç±»ç»§æ‰¿ã€‚ä¸ç¦æ„Ÿæ…¨ä»¥å‰çš„åˆ€è€•ç«ç§ï¼Œæ˜¯å¤šä¹ˆæŠ˜ç£¨äººğŸŒš&lt;/p&gt;
&lt;pre class=&quot;javascript&quot;&gt;
&lt;code&gt;class Book {
    constructor(){
        this.name = ''; // ä¹¦å
        this.page = 0; // é¡µæ•°
        this.classify = ''; // ç±»å‹
    }
    init(option) {
        this.name = option.name || '';
        this.page = option.page || 0;
        this.classify = option.classify || '';
    }
    getName() {
        console.log(this.name);
    }
    getPage (){
        console.log(this.page);
    }
    getClassify (){
        console.log(this.classify);
    }
}
class Computer extends Book{
    constructor(...args){
        super(...args);
    }
    init(option) {
        super.init(option);
        this.classify = 'computer';
    }
    say() {
        console.log('I\'m '+ this.name);
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;ç»“è¯­&quot;&gt;ç»“è¯­&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ES5ç»ˆç©¶ä¼šè¢«æ·˜æ±°ï¼Œä½†æ˜¯äº†è§£ä¸‹å…¶å·¥ä½œåŸç†ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¿…è¦ã€‚å› ä¸ºå¾ˆå¤šæºç è¿˜æ˜¯æœ‰ç”¨åˆ°é‡Œé¢çš„æ¨¡å¼ã€‚&lt;br/&gt;é™„å¸¦çš„ä»·å€¼å°±æ˜¯ï¼ŒES5çš„ç»§æ‰¿ç©åˆ°é£èµ·ï¼ŒES6çš„ç»§æ‰¿å°±æ˜¯å°èœä¸€ç¢Ÿã€‚&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 16:46:00 +0000</pubDate>
<dc:creator>æˆ‘æ˜¯leon</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/walls/p/9393686.html</dc:identifier>
</item>
<item>
<title>Pythonå­¦ä¹ ï¼š19.Pythonè®¾è®¡æ¨¡å¼-å•ä¾‹æ¨¡å¼ - BD-ld-2017</title>
<link>http://www.cnblogs.com/liudi2017/p/9393614.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/liudi2017/p/9393614.html</guid>
<description>&lt;p&gt;&lt;span&gt;ä¸€ã€å•ä¾‹æ¨¡å¼å­˜åœ¨çš„æ„ä¹‰&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€åœ¨è¿™é‡Œçš„å•ä¾‹å°±æ˜¯åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆè¿™é‡Œçš„å®ä¾‹å°±åƒåœ¨é¢å‘å¯¹è±¡çš„æ—¶å€™ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ä¹Ÿå¯ä»¥è¯´åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼‰ï¼Œåªç”¨ä¸€ä¸ªå®ä¾‹è¿›è¡Œç¨‹åºè®¾è®¡ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™ä¸é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç±»åŒæ—¶åˆ›å»ºå¤šä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¸”æ¯ä¸ªå¯¹è±¡ä¸­å°è£…äº†ä¸åŒçš„æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¸èƒ½ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;class&lt;/span&gt;&lt;span&gt; Person:
    &lt;/span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;(self,name,age):
        self.name &lt;/span&gt;=&lt;span&gt; name
        self.age &lt;/span&gt;=&lt;span&gt; age
        
mingming &lt;/span&gt;= Person(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;æ˜æ˜&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,19&lt;span&gt;)
mingyue &lt;/span&gt;= Person(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;æ˜æœˆ&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,30&lt;span&gt;)
mingri &lt;/span&gt;= Person(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;æ˜æ—¥&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;,20)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€é‚£ä¹ˆä»€ä¹ˆæ—¶å€™é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå¦‚æœæ¯ä¸ªå¯¹è±¡ä¸­å°è£…äº†ç›¸åŒçš„æ•°æ®ï¼Œä½†æ˜¯éœ€è¦åˆ›å»ºå¤šä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªå®ä¾‹æ‰€æœ‰çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå®ä¾‹å®Œæˆï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå¦‚ä¸‹&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;class&lt;/span&gt;&lt;span&gt; Person:
    &lt;/span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;(self):
        self.name &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;123123&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;
        self.age &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;

    &lt;span&gt;def&lt;/span&gt;&lt;span&gt; f1(self):
        &lt;/span&gt;&lt;span&gt;pass&lt;/span&gt;

    &lt;span&gt;def&lt;/span&gt;&lt;span&gt; f2(self):
        &lt;/span&gt;&lt;span&gt;pass&lt;/span&gt;&lt;span&gt;

mingming &lt;/span&gt;=&lt;span&gt; Person()
mingming.f1()

mingyue &lt;/span&gt;=&lt;span&gt; Person()
mingyue.f1()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œå°±æ˜¯ä¸ºäº†åœ¨å°è£…æ•°æ®ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œè€Œä¸”æ¯ä¸ªå®ä¾‹å¯æ‰§è¡Œçš„æ–¹æ³•ç›¸åŒçš„æ—¶å€™ï¼Œä¸å¿…åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå®ä¾‹ï¼Œæ¥å®Œæˆå¤šä¸ªç›¸åŒå®ä¾‹æ‰€å®Œæˆçš„åŠŸèƒ½ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;äºŒã€å•ä¾‹æ¨¡å¼åº”ç”¨çš„åœºæ™¯&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;éœ€è¦é¢‘ç¹çš„è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤šï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;å·¥å…·ç±»å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;span&gt;ä¸‰ã€å•ä¾‹æ¨¡å¼çš„ä¼˜ç‚¹ä»¥åŠç¼ºç‚¹&lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;p&gt;ç³»ç»Ÿå†…å­˜ä¸­è¯¥ç±»åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå•ä¾‹æ¨¡å¼åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ã€‚Â &lt;br/&gt;å•ä¾‹æ¨¡å¼å¯ä»¥é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼Œä¾‹å¦‚ä¸€ä¸ªå†™æ–‡ä»¶æ—¶ï¼Œç”±äºåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨å†…å­˜ä¸­ï¼Œé¿å…å¯¹åŒä¸€ä¸ªèµ„æºæ–‡ä»¶çš„åŒæ—¶å†™æ“ä½œã€‚Â &lt;br/&gt;å•ä¾‹æ¨¡å¼å¯ä»¥å†ç³»ç»Ÿè®¾ç½®å…¨å±€çš„è®¿é—®ç‚¹ï¼Œä¼˜åŒ–å’Œå…±äº«èµ„æºè®¿é—®ã€‚Â &lt;br/&gt;å…¶ä¸­ä½¿ç”¨åˆ°å•ä¾‹æ¨¡å¼æ—¶ï¼Œè€ƒè™‘è¾ƒå¤šçš„å°±æ˜¯å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹å¦‚ä½•é˜²æ­¢è¢«å¤šçº¿ç¨‹åŒæ—¶åˆ›å»ºç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;con&quot;&gt;å½“è¿™ä¸ªç±»çš„å¯¹è±¡åœ¨å¤šä¸ªåœ°æ–¹åˆ›å»ºçš„æ—¶å€™ï¼Œä½¿å¾—å†…éƒ¨çš„æ–¹æ³•å¤šæ¬¡è°ƒç”¨ï¼Œä½†æ˜¯å¸Œæœ›åªè¦ä¸€ä¸ªå¯¹è±¡æ“ä½œè¿™ä¸ªæ–¹æ³•ï¼Œæˆ–è€…ä¸å¸Œæœ›å¤šä¸ªåœ°æ–¹åŒæ—¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œéœ€è¦ä¿æŒè¿™ä¸ªæ–¹æ³•çš„å•ä¸€æ€§è´¨ï¼Œå°±ç”¨å•åˆ©æ¨¡å¼&lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œæ‰©å±•å¾ˆå›°éš¾ï¼Œè‹¥è¦æ‰©å±•ï¼Œé™¤äº†ä¿®æ”¹ä»£ç åŸºæœ¬ä¸Šæ²¡æœ‰ç¬¬äºŒç§é€”å¾„å¯ä»¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å››ã€å•ä¾‹æ¨¡å¼ä»£ç ç¼–å†™&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¨¡æ‹Ÿä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± æ¥å®ç°å•ä¾‹æ¨¡å¼&lt;br/&gt;é¦–å…ˆæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹æ•°æ®åº“è¿æ¥æ± &lt;br/&gt;æˆ‘ä»¬é€šè¿‡ç¨‹åºè¿›è¡Œæ•°æ®åº“çš„æ“ä½œçš„æ—¶å€™ï¼Œæ¯æ¬¡éƒ½éœ€è¦è¿æ¥æ•°æ®åº“ï¼Œä½†æ˜¯è¿æ¥æ•°æ®åº“éœ€è¦æ¶ˆè€—è¾ƒå¤šçš„æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬ä¸»æœºçš„å†…å­˜é‡Œç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œåœ¨è¿™ä¸ªè¿æ¥æ± ä¸­æœ‰è‹¥å¹²ä¸ªå·²ç»è¿æ¥æ•°æ®åº“çš„è¿æ¥ï¼Œæˆ‘ä»¬æƒ³è¦è¿æ¥æ•°æ®åº“çš„æ—¶å€™ç›´æ¥åˆ°è¿æ¥æ± ä¸­å–å‡ºä¸€ä¸ªè¿æ¥å³å¯ï¼Œçœå»äº†è¿æ¥çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;éå•ä¾‹æ¨¡å¼&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;45&quot;&gt;
&lt;pre&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; random

&lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt; SqlConnectionPool:

    &lt;/span&gt;&lt;span&gt;__instance&lt;/span&gt; =&lt;span&gt; None

    &lt;/span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;(self):
        self.ip &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;127.0.0.1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
        self.port &lt;/span&gt;= 3306&lt;span&gt;
        self.pwd &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;123456&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;
        self.username &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;alexsel&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;
        &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å»è¿æ¥&lt;/span&gt;
        self.conn_list = [1,2,3,4,5,6,7,8,9,10&lt;span&gt;]

    &lt;/span&gt;&lt;span&gt;def&lt;/span&gt;&lt;span&gt; get_connection(self):
        &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è·å–è¿æ¥&lt;/span&gt;
        r = random.randrange(1,11&lt;span&gt;)
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; r


&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æˆ‘ä»¬åˆ›å»ºå¤šä¸ªå¯¹è±¡å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜æ‹¿åˆ°çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡&lt;/span&gt;
obj =&lt;span&gt; SqlConnectionPool()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj)
obj1 &lt;/span&gt;=&lt;span&gt; SqlConnectionPool()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj1)
obj2 &lt;/span&gt;=&lt;span&gt; SqlConnectionPool()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj2)

è¾“å‡ºç»“æœï¼š
&lt;/span&gt;&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x0000000002630788&amp;gt;
&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x0000000002630888&amp;gt;
&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x00000000026308C8&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;éå•ä¾‹æ¨¡å¼æ¯æ¬¡å†…å­˜è¾“å‡ºçš„ç»“æœéƒ½ä¸åŒï¼Œä¸‹é¢æ˜¯å•ä¾‹æ¨¡å¼ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;45&quot;&gt;
&lt;pre&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; random

&lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt; SqlConnectionPool:

    &lt;/span&gt;&lt;span&gt;__instance&lt;/span&gt; =&lt;span&gt; None

    &lt;/span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;(self):
        self.ip &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;127.0.0.1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
        self.port &lt;/span&gt;= 3306&lt;span&gt;
        self.pwd &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;123456&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;
        self.username &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;alexsel&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;
        &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å»è¿æ¥&lt;/span&gt;
        self.conn_list = [1,2,3,4,5,6,7,8,9,10&lt;span&gt;]

    @staticmethod   &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;é™æ€æ–¹æ³•æ˜¯ç”±ç±»è°ƒç”¨çš„&lt;/span&gt;
    &lt;span&gt;def&lt;/span&gt;&lt;span&gt; get_instance():
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; SqlConnectionPool.&lt;span&gt;__instance&lt;/span&gt;&lt;span&gt;:
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; SqlConnectionPool.&lt;span&gt;__instance&lt;/span&gt;
        &lt;span&gt;else&lt;/span&gt;&lt;span&gt;:
            &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡èµ‹å€¼ç»™é™æ€å­—æ®µ__instance&lt;/span&gt;
            SqlConnectionPool.&lt;span&gt;__instance&lt;/span&gt; =&lt;span&gt; SqlConnectionPool()
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; SqlConnectionPool.&lt;span&gt;__instance&lt;/span&gt;

    &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å•ä¾‹æ¨¡å¼å…³é”®ä»£ç è§£æ&lt;/span&gt;
    &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å½“ç¬¬ä¸€æ¬¡è°ƒç”¨è¿™ä¸ªé™æ€æ–¹æ³•çš„æ—¶å€™ï¼Œåˆ¤æ–­__instacneçš„å€¼æ˜¯Noneæ‰€ä»¥æ‰§è¡Œelseï¼Œç„¶ååœ¨elseä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡èµ‹ç»™é™æ€å­—æ®µ__instanceï¼Œç„¶åè¿”å›è¿™ä¸ªé™æ€å­—æ®µ&lt;/span&gt;
    &lt;span&gt;#&lt;/span&gt;&lt;span&gt;ç¬¬äºŒæ¬¡è°ƒç”¨è¿™ä¸ªä»Šé™æ€æ–¹æ³•çš„æ—¶å€™ï¼Œåˆ¤æ–­__instanceçš„å€¼ä¸ºçœŸï¼Œæ‰€ä»¥ç›´æ¥è¿”å›è¿™ä¸ªé™æ€å­—æ®µï¼Œè€Œè¿™ä¸ªé™æ€å­—æ®µä¸­åŒ…å«çš„æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºçš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ä»¥åè°ƒç”¨è¿™ä¸ªæ–¹æ³•&lt;/span&gt;
    &lt;span&gt;#&lt;/span&gt;&lt;span&gt;å°±åªä¼šè°ƒç”¨ç¬¬ä¸€æ¬¡åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿™å°±æ˜¯å•ä¾‹æ¨¡å¼&lt;/span&gt;

    &lt;span&gt;def&lt;/span&gt;&lt;span&gt; get_connection(self):
        &lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è·å–è¿æ¥&lt;/span&gt;
        r = random.randrange(1,11&lt;span&gt;)
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; r


&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æˆ‘ä»¬åˆ›å»ºå¤šä¸ªå¯¹è±¡å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œè¯´æ˜æ‹¿åˆ°çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡&lt;/span&gt;
obj =&lt;span&gt; SqlConnectionPool.get_instance()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj)
obj1 &lt;/span&gt;=&lt;span&gt; SqlConnectionPool.get_instance()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj1)
obj2 &lt;/span&gt;=&lt;span&gt; SqlConnectionPool.get_instance()
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(obj2)


è¾“å‡ºç»“æœï¼š
&lt;/span&gt;&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x000000000260C808&amp;gt;
&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x000000000260C808&amp;gt;
&amp;lt;&lt;span&gt;__main__&lt;/span&gt;.SqlConnectionPool instance at 0x000000000260C808&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Â ä»¥ä¸Šæ˜¯åŸºäºç±»ï¼Œä½¿ç”¨é™æ€å­—æ®µå’Œé™æ€æ–¹æ³•å®ç°çš„ä¸€ä¸ªå•ä¾‹æ¨¡å¼ã€‚&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 16:11:00 +0000</pubDate>
<dc:creator>BD-ld-2017</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/liudi2017/p/9393614.html</dc:identifier>
</item>
<item>
<title>è®¾è®¡æ¨¡å¼-----Builderæ¨¡å¼ - JJian</title>
<link>http://www.cnblogs.com/jian0110/p/9393573.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/jian0110/p/9393573.html</guid>
<description>&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;è¿‘æ—¥ï¼Œçœ‹åˆ°Myabtisä¸­ç»„ä»¶ä¸­SqlSessionFactoryç”±SqlSessionFactoryBuilder().build()ç”Ÿæˆæ—¶ï¼Œä¸”é‡‡ç”¨Builderæ¨¡å¼ï¼Œé‚è®°å½•å­¦ä¹ ä¹‹ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
SqlSessionFactory sqlSessionFactory = &lt;span&gt;new&lt;/span&gt; SqlSessionFactoryBuilder().build(inputStream);
&lt;/pre&gt;&lt;/div&gt;

&lt;hr/&gt;
&lt;h2&gt;1ã€ä»€ä¹ˆæ˜¯Builderæ¨¡å¼ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;ã€€ã€€ï¼ˆ1ï¼‰å¯¹äºå¤æ‚çš„å¯¹è±¡ï¼Œå¦‚æœåªæ˜¯ç”¨æ„é€ æ–¹æ³•åˆ›å»ºçš„è¯ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼šå­˜åœ¨å¾ˆå¤šçš„é€»è¾‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸€æ­¥æ­¥æœ‰ç§©åºæ„å»ºå®ƒï¼Œä»è€Œé™ä½å¤æ‚åº¦ï¼›&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ã€€ã€€ï¼ˆ2ï¼‰å¯¹äºå¤æ‚çš„å¯¹è±¡ï¼Œä½¿ç”¨è€…ä¸å¿…çŸ¥é“å…¶å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„æ¸…ä¸‹ï¼Œé€æ­¥æ„é€ éœ€è¦çš„å®ä¾‹å¯¹è±¡ï¼›&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;2ã€ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨Builderæ¨¡å¼ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ã€€ã€€ï¼ˆ1ï¼‰å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œå³ç›¸åŒçš„æ„é€ è¿‡ç¨‹å¯ä»¥æœ‰ä¸åŒè¡¨ç¤ºï¼›&lt;/p&gt;
&lt;p&gt;ã€€ã€€ï¼ˆ2ï¼‰å½“æœ‰å¤šä¸ªæ„é€ å™¨ä¸”éœ€è¦ä¼ å…¥ä¸åŒçš„å‚æ•°è¡¨ç¤ºä¸åŒçš„äº§å“æ—¶ï¼ˆå³å¯ä»¥å¼¥è¡¥å·¥å‚æ¨¡å¼ç­‰æ— æ³•é€‰æ‹©å¤šå‚æ•°çš„ç¼ºç‚¹ï¼‰&lt;/p&gt;
&lt;p&gt;ã€€ã€€ï¼ˆ3ï¼‰ä¼ å…¥å‚æ•°æƒ…å†µæ¯”è¾ƒçµæ´»ä¸”å¤æ‚çš„æƒ…å†µï¼Œæˆ–è€…è¯´ä¸€å¼€å§‹ä¸éœ€è¦æ˜ç¡®å‚æ•°çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ï¼ˆ4ï¼‰æ¡†æ¶ä¸­å¾ˆå¤šConfigurationé…ç½®éƒ½ä¼šç”¨åˆ°Builderæ¨¡å¼ã€‚&lt;/p&gt;
&lt;h2&gt;3ã€å…·ä½“ä½¿ç”¨Builderä¾‹å­&lt;/h2&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ä»¥å‰ç»å¸¸é€šè¿‡ä¸åŒæ„é€ å™¨ä¼ å…¥ä¸åŒçš„å‚æ•°æ„é€ ä¸åŒå¤æ‚çš„å¯¹è±¡ï¼Œæ¯”å¦‚æˆ‘ä»¬ç°åœ¨éœ€è¦ä¸€ä¸ªUserçš„ä¸åŒæƒ…å†µå¯¹è±¡&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åªæœ‰idå’Œname&lt;/li&gt;
&lt;li&gt;æœ‰idã€nameã€age&lt;/li&gt;
&lt;li&gt;æœ‰idã€nameã€ageã€address&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; User {
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; id;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String name;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; age;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String address;
    
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸åŒçš„æ„é€ å™¨ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼Œåˆ›é€ ä¸åŒçš„å¤æ‚çš„äº§å“&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; User(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; id, String name) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; User(&lt;span&gt;int&lt;/span&gt; id, String name, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; age) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.age =&lt;span&gt; age;
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; User(&lt;span&gt;int&lt;/span&gt; id, String name, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; age, String address) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.age=&lt;span&gt; age;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.address =&lt;span&gt; address;
    }
    
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getId() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; id;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; setId(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; id) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getName() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; name;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setName(String name) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getAge() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; age;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; setAge(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; age) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.age =&lt;span&gt; age;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getAddress() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; address;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setAddress(String address) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.address =&lt;span&gt; address;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æµ‹è¯•ç±»è¿™æ ·ç¼–å†™ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Main {
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ1ï¼šidã€å§“å&lt;/span&gt;
        User user = &lt;span&gt;new&lt;/span&gt; User(1, &quot;Zhangsan&quot;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ2ï¼šidã€å§“åã€å¹´é¾„&lt;/span&gt;
        User user2 = &lt;span&gt;new&lt;/span&gt; User(2,&quot;Lisi&quot;,22&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ3ï¼šidã€å§“åã€å¹´é¾„ã€åœ°å€&lt;/span&gt;
        User user3 = &lt;span&gt;new&lt;/span&gt; User(3,&quot;Wangwu&quot;,23,&quot;Beijing&quot;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ4ï¼šidä¸å¹´é¾„ä¸æ¸…æ¥šï¼Œå¾ˆå®¹æ˜“æ··æ·†ï¼Œå¿…é¡»å¾—æŸ¥çœ‹æºç æˆ–è€…æ–‡æ¡£æ‰èƒ½çŸ¥é“å“ªä¸ªå‚æ•°ä½ç½®id/å¹´é¾„&lt;/span&gt;
        User user4 = &lt;span&gt;new&lt;/span&gt; User(24,&quot;Wangwu&quot;,24,&quot;Beijing&quot;&lt;span&gt;);
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;OKï¼Œè¿™æ ·æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ä¼šæœ‰ä»¥ä¸‹å¼Šç«¯ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å°±å¥½æ¯”æƒ…å†µ4ã€‚å½“ä¼ å…¥çš„å‚æ•°å¾ˆå¤šå¹¶ä¸”æ²¡æœ‰è¯´æ˜æ–‡æ¡£çš„æƒ…å†µä¸‹ï¼Œä¹‹åé˜…è¯»å®Œæºç åæ‰èƒ½æ›´å¥½åœ°ä½¿ç”¨ã€‚é‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¹æºç è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·å°±è¿èƒŒäº†åœ¨åº”ç”¨ä¸­ä¸€ä¸ªå¥½çš„è®¾è®¡æ¨¡å—çš„åŸåˆ™ï¼Œå³è®¾è®¡æ¨¡å¼ä¸­çš„å¼€é—­åŸåˆ™(Open-Closed Principle, OCPï¼Œå¯¹ä¿®æ”¹å°é—­)&lt;/li&gt;
&lt;li&gt;æ¯ç§æƒ…å†µéƒ½å¾—ç¼–å†™ä¸€ä¸ªçš„æ„é€ å™¨ï¼Œæ²¡æœ‰ä¸€ç‚¹çš„çµæ´»åº¦ã€‚å†æ¯”å¦‚è¿™é‡Œaddresså±æ€§æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥ä¸ä¼ å…¥ï¼Œé‚£ä¹ˆçµæ´»åº¦åŒæ ·å¾ˆä½ï¼&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;ï¼ˆ2ï¼‰æ¥ä¸‹æ¥å°±ä½¿ç”¨Builderæ¨¡å¼åˆ›å»ºï¼Œæ³¨æ„ï¼šBuilderä¸»è¦é‡‡ç”¨Javaé™æ€å†…éƒ¨ç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
 * åˆ©ç”¨Buileræ¨¡å¼çµæ´»é¢å¯¹å¤æ‚å¯¹è±¡çš„åˆ›å»º
 * &lt;/span&gt;&lt;span&gt;@author&lt;/span&gt;&lt;span&gt; Lijian
 *
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; User2 {
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; id;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String name;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; age;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String address;
    
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; User2(Builder builder) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; builder.id;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; builder.name;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.age =&lt;span&gt; builder.age;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.address =&lt;span&gt; builder.address;
    }
    &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Builder{
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; id;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String name;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; age;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String address;
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;çµæ´»é€‰æ‹©å‚æ•°&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; Builder setId(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; id) {
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.id =&lt;span&gt; id;
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Builder setName(String name) {
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.name =&lt;span&gt; name;
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Builder setAddress(String address) {
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.address =&lt;span&gt; address;
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Builder setAge(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; age) {
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.age =&lt;span&gt; age;
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æœ€åbuildè¿”å›User2å¯¹è±¡&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; User2 build() {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; User2(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
        }
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æµ‹è¯•ç±»ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Main {
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡buildåˆ›å»ºäº†User2å¯¹è±¡,ä¹‹åé€šè¿‡setXXXæ–¹æ³•å¯çµæ´»åˆå§‹åŒ–å±æ€§ï¼Œæœ€åbuildè¿”å›å¯¹è±¡&lt;/span&gt;
        User2 user = &lt;span&gt;new&lt;/span&gt; User2.Builder().setId(1).setName(&quot;Lijian&quot;).setAge(22&lt;span&gt;).build();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ1ï¼šidã€å§“å&lt;/span&gt;
        User2 user2 = &lt;span&gt;new&lt;/span&gt; User2.Builder().setId(2).setName(&quot;Zhangsan&quot;&lt;span&gt;).build();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ2ï¼šidã€å§“åã€å¹´è½»ã€åœ°å€&lt;/span&gt;
        User2 user3 = &lt;span&gt;new&lt;/span&gt; User2.Builder().setId(2).setName(&quot;Lisi&quot;&lt;span&gt;).build();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æƒ…å†µ3ï¼šidä¸ageå¾ˆæ˜æ˜¾èƒ½åŒºåˆ†&lt;/span&gt;
        User2 user4 = &lt;span&gt;new&lt;/span&gt; User2.Builder().setId(23).setAge(23&lt;span&gt;).build();
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é€šè¿‡setXXX()æ–¹æ³•çµæ´»é€‰æ‹©å‚æ•°ï¼Œæœ€åbuild()æ–¹æ³•â€œé—­åˆâ€è¿”å›å¯¹è±¡ã€‚å¾ˆé€‚ç”¨äºå¤æ‚å¯¹è±¡çš„åˆ›å»ºï¼Œæ­¤å¤„è®©æˆ‘æƒ³èµ·Java8æ–°ç‰¹æ€§ä¸­çš„Stream APIï¼ˆ&lt;a href=&quot;https://blog.csdn.net/mynewclass/article/details/80393308&quot; target=&quot;_blank&quot;&gt;https://blog.csdn.net/mynewclass/article/details/80393308&lt;/a&gt;ï¼‰çš„ä¸€ä¸ªç‰¹ç‚¹ï¼šæ‡’åŠ è½½ã€‚æ˜¯çš„ï¼Œæœ‰ç‚¹â€œæ‡’åŠ è½½â€çš„å‘³é“ï¼Œä¸éœ€è¦ç«‹é©¬æŒ‡å®šå±æ€§ï¼Œä¹Ÿä¸ä¼šç«‹é©¬ç”Ÿæ•ˆï¼Œä¹‹åæœ€åçš„æ“ä½œbuild()æ‰ä¼šç”Ÿæ•ˆï¼&lt;/p&gt;

</description>
<pubDate>Mon, 30 Jul 2018 15:59:00 +0000</pubDate>
<dc:creator>JJian</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/jian0110/p/9393573.html</dc:identifier>
</item>
<item>
<title>å¤§æ•°æ®è‡ªåŠ¨åŒ–å®‰è£…éƒ¨ç½²æ–¹æ¡ˆ(ä¸€)â€”â€”é›†ç¾¤ç³»ç»Ÿç¯å¢ƒè®¾ç½® - ç‰§æ¢¦è€…</title>
<link>http://www.cnblogs.com/swordfall/p/9330063.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/swordfall/p/9330063.html</guid>
<description>&lt;h2&gt;1.1ç³»ç»Ÿå’Œyumæºé•œåƒå‡†å¤‡&lt;/h2&gt;
&lt;p&gt;éœ€è¦çš„æ¡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;â‘  è‡³å°‘ä¸‰å°åˆšè£…ä¸ŠCentos7.0ç³»ç»Ÿçš„ç‰©ç†æœºæˆ–è€…è™šæ‹Ÿæœºï¼›&lt;/p&gt;
&lt;p&gt;â‘¡Â CentOS-7.0-x86_64-bin-DVD1.isoé•œåƒï¼Œç”¨äºåˆ¶ä½œæœ¬åœ°yumæºï¼›&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;&lt;/span&gt;æœ¬æ–‡ä¸‰å°ç‰©ç†æœºæˆ–è™šæ‹Ÿæœºçš„æ“ä½œç³»ç»Ÿé•œåƒæ˜¯CentOS-7-x86_64-Minimal-1804.isoã€‚&lt;/p&gt;
&lt;p&gt;ç”¨äºåˆ¶ä½œæœ¬åœ°yumæºçš„CentOS-7.0-x86_64-bin-DVD1.isoé•œåƒé»˜è®¤å­˜æ”¾äºç¬¬ä¸€èŠ‚ç‚¹node1çš„/opt/systemä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/1217276/201807/1217276-20180731001031240-1574899925.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;1.2Â é…ç½®æ–‡ä»¶host_ip.txtå’Œframes.txå‡†å¤‡&lt;/h2&gt;
&lt;p&gt;host_ip.txtæ–‡ä»¶ä¸ºé›†ç¾¤ipã€hostnameã€rootè´¦å·å¯†ç é…ç½®ï¼›è€Œframes.txtä¸ºæ‰€éœ€è¦å®‰è£…çš„è½¯ä»¶é…ç½®è¯´æ˜ï¼Œå…¶ä¸­falseä¸ºä¸å®‰è£…ï¼Œtrueä¸ºå®‰è£…&lt;/p&gt;
&lt;p&gt;host_ip.txtå†…å®¹ä¸ºï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;187.201&lt;/span&gt;&lt;span&gt; node1 root hadoop
&lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;187.202&lt;/span&gt;&lt;span&gt; node2 root hadoop
&lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;187.203&lt;/span&gt; node3 root hadoop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;frames.txtå†…å®¹ä¸ºï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
jdk-8u181-linux-x64.&lt;span&gt;tar&lt;/span&gt;.gz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
scala&lt;/span&gt;-&lt;span&gt;2.11&lt;/span&gt;.&lt;span&gt;0&lt;/span&gt;.tgz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
hadoop&lt;/span&gt;-&lt;span&gt;2.7&lt;/span&gt;.&lt;span&gt;6&lt;/span&gt;.&lt;span&gt;tar&lt;/span&gt;.gz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
hbase&lt;/span&gt;-&lt;span&gt;2.0&lt;/span&gt;.&lt;span&gt;1&lt;/span&gt;-bin.&lt;span&gt;tar&lt;/span&gt;.gz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
apache&lt;/span&gt;-hive-&lt;span&gt;2.3&lt;/span&gt;.&lt;span&gt;3&lt;/span&gt;-bin.&lt;span&gt;tar&lt;/span&gt;.gz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
zookeeper&lt;/span&gt;-&lt;span&gt;3.4&lt;/span&gt;.&lt;span&gt;13&lt;/span&gt;.&lt;span&gt;tar&lt;/span&gt;.gz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
spark&lt;/span&gt;-&lt;span&gt;2.3&lt;/span&gt;.&lt;span&gt;1&lt;/span&gt;-bin-hadoop2.&lt;span&gt;7&lt;/span&gt;.tgz &lt;span&gt;true&lt;/span&gt;&lt;span&gt;
kafka_2.&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;-&lt;span&gt;1.1&lt;/span&gt;.&lt;span&gt;1&lt;/span&gt;.tgz &lt;span&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;1.3Â å®‰è£…è½¯ä»¶å‡†å¤‡&lt;/h2&gt;
&lt;p&gt;éœ€è¦åœ¨å®˜ç½‘ä¸Šä¸‹è½½frames.txtæ‰€åˆ—çš„è½¯ä»¶å®‰è£…åŒ…ï¼Œå¯ä»¥è‡ªè¡Œä¸‹è½½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œé»˜è®¤æ‰€æœ‰çš„è½¯ä»¶å®‰è£…åŒ…æ”¾åœ¨ç¬¬ä¸€èŠ‚ç‚¹node1çš„/opt/framesç›®å½•ä¸‹ï¼Œä¸‹é¢æ¶‰åŠè½¯ä»¶éƒ¨åˆ†çš„shellæ“ä½œéƒ½ä¼šæ ¹æ®/opt/frames/ç›®å½•ä¸‹æ˜¯å¦æœ‰è¯¥è½¯ä»¶å†è¿›è¡Œè‡ªåŠ¨å®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/1217276/201807/1217276-20180730235114197-79060640.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;1.4 shellå‘½ä»¤æ–‡æœ¬å‡†å¤‡&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹shellæ–‡æœ¬æ–‡ä»¶ï¼Œä»¥åŠhost_ip.txtå’Œframes.txtæ–‡ä»¶ï¼Œéƒ½é»˜è®¤æ”¾ç½®åœ¨ç¬¬ä¸€èŠ‚ç‚¹node1çš„&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy&lt;/em&gt;&lt;span&gt;ç›®å½•ä¸‹ï¼Œå¦‚å›¾ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Â &lt;img src=&quot;https://images2018.cnblogs.com/blog/1217276/201807/1217276-20180730234854393-1698634637.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;&lt;/span&gt;ä»¥ä¸‹æ‰€æœ‰shellå‘½ä»¤çš„æ‰§è¡Œï¼Œéƒ½éœ€è¦ä»¥rootç”¨æˆ·æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;æ¨¡å—åŒ–è‡ªåŠ¨å®‰è£…éƒ¨ç½²åŒ…æ‹¬IPåœ°å€è®¾ç½®ã€æœºå™¨åhostnameä¿®æ”¹ã€hosté…ç½®æ–‡ä»¶ä¿®æ”¹ã€å…³é—­é˜²ç«å¢™/SELINUXã€æ·»åŠ bigdataç”¨æˆ·åã€é…ç½®yumæºã€é…ç½®SSHæ— å¯†ç ç™»å½•ã€é…ç½®JDKç¯å¢ƒã€é…ç½®Scalaç¯å¢ƒå…±9ä¸ªæ¨¡å—ã€‚&lt;/p&gt;
&lt;h2&gt;2.1Â é›†ç¾¤ä¸­æ¯å°æœºå™¨IPåœ°å€çš„è®¾ç½®&lt;/h2&gt;
&lt;p&gt;é›†ç¾¤ä¸­æ¯å°æœºå™¨é¦–å…ˆéœ€è¦è®¾ç½®IPåœ°å€ï¼Œä¿è¯æœºå™¨ä¸æœºå™¨ä¹‹é—´å¯ä»¥ç›´æ¥é€šè¿‡ipåœ°å€è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;IPåœ°å€è®¾ç½®shellå‘½ä»¤æ–‡ä»¶editIpAddr.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash
################
#é’ˆå¯¹Centos&lt;/span&gt;-&lt;span&gt;7.0&lt;/span&gt;&lt;span&gt;
################

#å¤„ç†æ¶‰åŠåˆ°IPåœ°å€è®¾ç½®çš„ç½‘ç»œæ–‡ä»¶ï¼Œå¤‡ä»½å¹¶åˆ›å»ºæ–°çš„
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; doWithNetworkFile()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;.æŸ¥æ‰¾/etc/sysconfig/network-scripts/ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨ifcfg-&lt;span&gt;ens33æ–‡ä»¶ï¼Œå­˜åœ¨åˆ™é‡å‘½åä¸º.bakç»“å°¾çš„
 fileResult&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /etc/sysconfig/network-scripts/ -name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ifcfg-ens33&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;`

 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $fileResult != &lt;span&gt;&quot;&quot;&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.åˆ›å»ºä¸€ä¸ªifcfg-&lt;span&gt;ens33æ–‡ä»¶ç”¨äºé…ç½®ç½‘ç»œè®¾ç½®
     result&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /etc/sysconfig/network-scripts -&lt;span&gt;wholename $fileResult.bak`
     &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ -&lt;span&gt;z $result ]]  
     &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;        
         &lt;span&gt;mv&lt;/span&gt;&lt;span&gt; $fileResult $fileResult.bak
     &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
     &lt;span&gt;cp&lt;/span&gt;&lt;span&gt; $fileResult.bak $fileResult
 &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;
     &lt;span&gt;touch&lt;/span&gt; /etc/sysconfig/network-scripts/ifcfg-&lt;span&gt;ens33
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
}

#é…ç½®ipåœ°å€
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; configureIpAddr()
{ 
 ip&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 gateway&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
 fileUrl&lt;/span&gt;=/etc/sysconfig/network-scripts/ifcfg-&lt;span&gt;ens33 

 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;.æŠŠifcfg-&lt;span&gt;ens33æ–‡ä»¶é#å¼€å¤´çš„è¡Œæ³¨é‡Šæ‰
 &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;'&lt;/span&gt;&lt;span&gt;s/^[^#]/#&amp;amp;/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt; $fileUrl
 
 UUID&lt;/span&gt;=`&lt;span&gt;grep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^#UUID=*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; $fileUrl | &lt;span&gt;head&lt;/span&gt; -&lt;span&gt;1&lt;/span&gt;&lt;span&gt;`
 
 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.é…ç½®å†…ç½‘IPåœ°å€
 #è¿æ¥ç±»å‹
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;TYPE=Ethernet&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #é™æ€IP
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;BOOTPROTO=static&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;DEFROUTE=yes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;IPV4_FAILURE_FATAL=no&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #IPV6å…³é—­
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;IPV6INIT=no&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #é…ç½®åå­—
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;NAME=ens33&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #å”¯ä¸€æ ‡è¯†
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;${UUID:1}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #ç½‘å¡åç§°
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;DEVICE=ens33&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #å¼€æœºå³å¯åŠ¨ç½‘ç»œ
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ONBOOT=yes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #IPåœ°å€
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;IPADDR=$ip&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;PREFIX=24&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #ç½‘ç»œæ©ç 
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;NETMASK=255.255.255.0&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl
 #ç½‘å…³
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;GATEWAY=$gateway&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $fileUrl 
}

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; editIpAddr()
{
 ip&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 gateway&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
 
 #å¤„ç†æ¶‰åŠåˆ°IPåœ°å€è®¾ç½®çš„ç½‘ç»œæ–‡ä»¶ï¼Œå¤‡ä»½å¹¶åˆ›å»ºæ–°çš„
 doWithNetworkFile
 #åœ¨&lt;/span&gt;/etc/sysconfig/network-scripts/ifcfg-&lt;span&gt;ens33ä¸Šè®¾ç½®IPåœ°å€
 configureIpAddr $ip $gateway 
 
 #é‡å¯ç½‘ç»œæœåŠ¡
 service network restart
}

ip&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
gateway&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
editIpAddr $ip $gateway&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åˆ†åˆ«åœ¨ä¸‰å°æœºå™¨ä¸Šä»¥rootç”¨æˆ·æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/editIpAddr.sh 192.168.187.*** 192.168.187.2&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Â æ³¨æ„ï¼š&lt;/p&gt;
&lt;p&gt;â‘ ç½‘å…³192.168.187.2éœ€è¦é€šè¿‡Â &lt;span&gt;&lt;em&gt;route -nÂ &lt;/em&gt;&lt;/span&gt;å‘½ä»¤(CentOS7ä»¥ä¸Šä½¿ç”¨)æŸ¥çœ‹ï¼Œå¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/1217276/201807/1217276-20180730194437114-1999413222.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;â‘¡ä¸åŒæœºå™¨çš„ipåœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™é‡ŒæŒ‡IPåœ°å€çš„å‰ä¸‰ä¸ªæ•°å€¼æ˜¯ä¸€æ ·ï¼Œå‰ä¸‰ä¸ªæ•°å€¼ä¸ç½‘å…³çš„å‰ä¸‰ä¸ªæ•°å€¼æ˜¯ä¸€è‡´çš„ï¼›åªæœ‰æœ€åä¸€ä¸ª***æ˜¯æ ¹æ®éœ€æ±‚è®¾ç½®ï¼Œä¸€èˆ¬åœ¨0~255ä¹‹é—´ã€‚è¿™é‡Œæˆ‘å‡å®šä¸‰ä¸ªèŠ‚ç‚¹node1ã€node2ã€node3çš„IPåˆ†åˆ«ä¸º192.168.187.201ï¼Œ192.168.187.202ï¼Œ192.168.187.203ã€‚&lt;/p&gt;
&lt;h2&gt;2.2Â ä¿®æ”¹æœºå™¨åhostname&lt;/h2&gt;
&lt;p&gt;changeHostname.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

#ä¿®æ”¹æœºå™¨åhostname
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; changeHostname()
{
 &lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 #&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;change the hostname $1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
 
 &lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^HOSTNAME=&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/sysconfig/network &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [ $? -eq &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
      #å­˜åœ¨åˆ™åˆ é™¤æ—§çš„hostname
      &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^HOSTNAME=/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/sysconfig/&lt;span&gt;network
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 #æ·»åŠ æ–°çš„hostname
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;HOSTNAME=$hostname&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysconfig/&lt;span&gt;network
 
 #&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;change the hostname $1 successfully&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
}

#è·å–å‚æ•°
node&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;

&lt;span&gt;if&lt;/span&gt; [ -&lt;span&gt;z $node ]
&lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
    &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å‚æ•°ä¸ºç©ºï¼Œè¯·è¾“å…¥å‚æ•°node1,node2,node3...&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
    changeHostname $node
&lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œ$hostnameä¸ºå‚æ•°ä¼ å€¼ï¼Œè®¾ä¸ºnode1ã€node2ã€node3....&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/changeHostname.sh $hostname&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span&gt;Â 2.3Â hosté…ç½®æ–‡ä»¶ä¿®æ”¹&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;addClusterIps.shä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

#æ·»åŠ Ipã€hostnameåˆ°&lt;/span&gt;/etc/&lt;span&gt;hostsæ–‡ä»¶é‡Œé¢
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; addIpToHostFile()
{
 ip&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;
 &lt;span&gt;hostname&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
 #æŸ¥è¯¢$ipæ˜¯å¦å­˜åœ¨äº&lt;/span&gt;/etc/&lt;span&gt;hostsé‡Œé¢
 &lt;/span&gt;&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^$ip&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/hosts &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [ $? -eq &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     #$&lt;/span&gt;?æ˜¯ä¸Šä¸€ä¸ªç¨‹åºæ‰§è¡Œæ˜¯å¦æˆåŠŸçš„æ ‡å¿—ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™$?&lt;span&gt;ä¸º0ï¼Œå¦åˆ™ä¸ä¸º0ï¼Œå­˜åœ¨åˆ™å…ˆæŠŠå°±çš„ipè®¾ç½®åˆ é™¤æ‰
     &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^$ip/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/&lt;span&gt;hosts
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #æŠŠipã€hostnameæ·»åŠ åˆ°&lt;/span&gt;/etc/&lt;span&gt;hostsä¸­
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$ip $hostname&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/&lt;span&gt;hosts
}

#æ‰§è¡Œsshå…å¯†ç™»å½•ä¹‹å‰ï¼Œhostsæ–‡ä»¶é‡Œé¢éœ€è¦å­˜å‚¨æ¯å°æœºå™¨çš„ipåœ°å€
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; editHostFile()
{
 #&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;edit the host file&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;./home/hadoop/&lt;span&gt;host_ip.txtæ–‡ä»¶ä¸­è¯»å–ipå’Œhostname
 &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; read line
 &lt;/span&gt;&lt;span&gt;do&lt;/span&gt;&lt;span&gt;
   #æå–æ–‡ä»¶ä¸­çš„ip
   ip&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f1`
   #æå–æ–‡ä»¶ä¸­çš„ç”¨æˆ·å
   &lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`

   addIpToHostFile $ip $&lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;
 &lt;span&gt;done&lt;/span&gt; &amp;lt; /home/hadoop/automaticDeploy/&lt;span&gt;host_ip.txt #è¯»å–å­˜å‚¨ipçš„æ–‡ä»¶

 #&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;edit the host file successfully&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
}

editHostFile&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œå‘½ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/addClusterIps.sh&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Â 2.4Â å…³é—­é˜²ç«å¢™ã€SELINUX&lt;/h2&gt;
&lt;p&gt;closeFirewall.shå‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; closeFirewallAndGetenforce()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.å…³é—­é˜²ç«å¢™
 firewallStatus&lt;/span&gt;=`firewall-cmd --&lt;span&gt;state`
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $firewallStatus = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;running&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     systemctl stop firewalld.service &lt;/span&gt;&amp;amp;&amp;amp;&lt;span&gt;systemctl disable firewalld.service
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.å…³é—­getenforce
 getenforceStatus&lt;/span&gt;=&lt;span&gt;`getenforce`
 &lt;/span&gt;&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^SELINUX=enforcing&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/selinux/config &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [[ $getenforceStatus = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Enforcing&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; || $? -eq &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
     &lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;'&lt;/span&gt;&lt;span&gt;s/^SELINUX=enforcing/SELINUX=disabled/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; /etc/selinux/&lt;span&gt;config 
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.é‡å¯ï¼Œä½¿è®¾ç½®ç”Ÿæ•ˆ
 #reboot
}

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; startFirewallAndGetenforce()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.å¼€å¯é˜²ç«å¢™
 firewallStatus&lt;/span&gt;=`firewall-cmd --&lt;span&gt;state`
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $firewallStatus != &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;running&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
    systemctl enable firewalld.service &lt;/span&gt;&amp;amp;&amp;amp;&lt;span&gt; systemctl start firewalld.service
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.å¼€å¯getenforce
 getenforceStatus&lt;/span&gt;=&lt;span&gt;`getenforce`
 &lt;/span&gt;&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^SELINUX=disabled&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/selinux/config &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [[ $getenforceStatus = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Disabled&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; || $? -eq &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
    &lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;'&lt;/span&gt;&lt;span&gt;s/^SELINUX=disabled/SELINUX=enforcing/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; /etc/selinux/&lt;span&gt;config
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.é‡å¯ï¼Œä½¿è®¾ç½®ç”Ÿæ•ˆ
 #reboot
}

operate&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;

&lt;span&gt;if&lt;/span&gt; [ -&lt;span&gt;z $operate ]
&lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
    &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å‚æ•°ä¸ºç©ºï¼Œè¯·è¾“å…¥å‚æ•°closeæˆ–start&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;else&lt;/span&gt;
    &lt;span&gt;if&lt;/span&gt; [[ $operate = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;close&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
    &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
        closeFirewallAndGetenforce
    &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
    &lt;span&gt;if&lt;/span&gt; [[ $operate = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;start&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
    &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
        startFirewallAndGetenforce
    &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
&lt;span&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™é‡Œæä¾›å¼€å¯å’Œå…³é—­é˜²ç«å¢™ä¸¤ç§åŠŸèƒ½ï¼Œæ–¹ä¾¿æ“ä½œã€‚ä»¥rootç”¨æˆ·æ‰§è¡Œè¯¥shellå‘½ä»¤æ—¶ï¼Œéœ€è¦è¾“å…¥å‚æ•°closeæˆ–startï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/closeFirewall.sh close&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;2.5Â æ·»åŠ ç³»ç»Ÿbigdataç”¨æˆ·&lt;/h2&gt;
&lt;p&gt;autoCreateUser.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

#åˆ›å»ºbigdataç”¨æˆ·ç»„ï¼Œåˆ›å»ºbigdataç”¨æˆ·å¹¶è®¾ç½®å¯†ç 
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; createUserAndGroup()
{
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;start to create user 'bigdata'!&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;

 user&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 group&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;

 #create group &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; not exists
 #åœ¨&lt;/span&gt;/etc/groupä¸­æŸ¥æ‰¾ç”¨æˆ·ç»„æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æŠŠé”™è¯¯è¾“å‡ºè¾“åˆ°/dev/&lt;span&gt;nullä¸­
 &lt;/span&gt;&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^$group&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/group &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;&lt;span&gt;
 # åˆ¤æ–­ä¸Šä¸€å‘½ä»¤æ˜¯å¦ç­‰äº0ï¼Œä¸ç­‰äºåˆ™åˆ›å»ºç”¨æˆ·ç»„
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [ $? -ne &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     groupadd $group
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #create user &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; not exists
 &lt;/span&gt;&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^$user&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /etc/&lt;span&gt;passwd&lt;/span&gt; &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [ $? -ne &lt;span&gt;0&lt;/span&gt;&lt;span&gt; ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     useradd &lt;/span&gt;-&lt;span&gt;g $group $user
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #åœ¨shellä¸­ä½¿ç”¨expectå®ç°è‡ªåŠ¨è¾“å…¥å¯†ç ï¼Œé€šå¸¸éœ€è¦ä¸&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;expect &amp;lt;&amp;lt;EOF EOF&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;ã€spawnã€å­expectä¸€èµ·ä½¿ç”¨
 expect &lt;/span&gt;&amp;lt;&amp;lt;&lt;span&gt; EOF
 spawn &lt;/span&gt;&lt;span&gt;passwd&lt;/span&gt;&lt;span&gt; $user
 expect &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;New password:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
 send &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;${user}\r&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
 expect &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Retype new password:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
 send &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;${user}\r&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
 expect eof;
EOF
}

#åˆ é™¤bigdataç”¨æˆ·ï¼Œåˆ é™¤bigdataç”¨æˆ·ç»„
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; deleteUserAndGroup()
{
 user&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 group&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;

 &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;delete the user:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; $user &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; and the userGroup:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $group
 userdel &lt;/span&gt;-&lt;span&gt;r $user
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [ $user !=&lt;span&gt; $group ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     groupdel $group
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
}

operate&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;

&lt;span&gt;if&lt;/span&gt; [ -&lt;span&gt;z $operate ]
&lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
    &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å‚æ•°ä¸ºç©ºï¼Œè¯·è¾“å…¥å‚æ•°createæˆ–delete&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
&lt;span&gt;else&lt;/span&gt;
    &lt;span&gt;if&lt;/span&gt; [[ $operate = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;create&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
    &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
        createUserAndGroup bigdata bigdata
    &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
    &lt;span&gt;if&lt;/span&gt; [[ $operate = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;delete&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
    &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
        deleteUserAndGroup bigdata bigdata
    &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
&lt;span&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™é‡Œæä¾›åˆ›å»ºã€åˆ é™¤ç”¨æˆ·ä¸¤ç§æ“ä½œï¼Œä»¥rootç”¨æˆ·æ‰§è¡Œè¯¥å‘½ä»¤éœ€è¦è¾“å…¥å‚æ•°createæˆ–è€…deleteï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/autoCreateUser.sh create&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span&gt;2.6Â é…ç½®yumæº&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;ç”±äºå¤§æ•°æ®å¹³å°ä¸€èˆ¬æ˜¯åœ¨å†…ç½‘ç¯å¢ƒä¸‹æ­å»ºçš„ï¼Œæ‰€ä»¥éœ€è¦é…ç½®æœ¬åœ°yumæºï¼Œç”¨ä»¥è§£å†³ä¸€äº›ä¾èµ–åŒ…ç¼ºå°‘çš„é—®é¢˜ï¼Œè¿™é‡Œä»¥node1èŠ‚ç‚¹ä½œä¸ºæœ¬åœ°yumæºæ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œä»¥CentOS-7.0-x86_64-bin-DVD1.isoä½œä¸ºyumæºçš„sourceã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;configureYum.shä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

#é…ç½®yumæº
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; configureYumSource()
{
 yumUrl&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt; 
 yumFile&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;.æŠŠCentOS-&lt;span&gt;Media.repoæ–‡ä»¶é#å¼€å¤´çš„è¡Œæ³¨é‡Šæ‰
 &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;'&lt;/span&gt;&lt;span&gt;s/^[^#]/#&amp;amp;/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt; $yumFile
 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.é…ç½®æœ¬åœ°æº
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;[base]&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;name=CentOS-Local&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;baseurl=$yumUrl&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;gpgcheck=0&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;enabled=1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $yumFile
 #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.æ¸…é™¤YUMç¼“å­˜
 &lt;/span&gt;&lt;span&gt;yum&lt;/span&gt; clean all &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt; &lt;span&gt;2&lt;/span&gt;&amp;gt;&amp;amp;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 #&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;.åˆ—å‡ºå¯ç”¨çš„YUMæº
 &lt;/span&gt;&lt;span&gt;yum&lt;/span&gt; repolist &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt; &lt;span&gt;2&lt;/span&gt;&amp;gt;&amp;amp;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
}

#å¤„ç†å¹¶ä¿è¯åªæœ‰ä¸€ä¸ªCentOS&lt;/span&gt;-&lt;span&gt;Media.repoæ–‡ä»¶å­˜åœ¨
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; doWithRepoFile()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.è¿›å…¥åˆ°yum.repos.dç›®å½•
 cd &lt;/span&gt;/etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.æŸ¥æ‰¾/etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/&lt;span&gt;ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨.repoç»“å°¾çš„æ–‡ä»¶ï¼Œå­˜åœ¨åˆ™é‡å‘½åä¸º.repo.bakç»“å°¾çš„
 fileResult&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/ -name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;*.repo&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;`
 &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; &lt;span&gt;file&lt;/span&gt; &lt;span&gt;in&lt;/span&gt;&lt;span&gt; $fileResult
 &lt;/span&gt;&lt;span&gt;do&lt;/span&gt;&lt;span&gt;
   onlyFile&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /etc/&lt;span&gt;yum&lt;/span&gt;.repos.d -wholename $&lt;span&gt;file&lt;/span&gt;&lt;span&gt;.bak`
   &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ -&lt;span&gt;z $onlyFile ]]
   &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
        &lt;span&gt;mv&lt;/span&gt; $&lt;span&gt;file&lt;/span&gt; $&lt;span&gt;file&lt;/span&gt;&lt;span&gt;.bak
   &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
 &lt;span&gt;done&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.åªåˆ›å»ºä¸€ä¸ª.repoæ–‡ä»¶ç”¨äºé…ç½®æœ¬åœ°yumæº
 result&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/ -name CentOS-&lt;span&gt;Media.repo.bak`
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ -&lt;span&gt;z $result ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
     &lt;span&gt;touch&lt;/span&gt; CentOS-&lt;span&gt;Media.repo
 &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;
     &lt;span&gt;cp&lt;/span&gt; CentOS-Media.repo.bak CentOS-&lt;span&gt;Media.repo
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
}

#############################################################################
#åŒä¸€å‡½æ•°åŠå…¶è°ƒç”¨çš„å­å‡½æ•°ï¼Œçˆ¶å‡½æ•°ä¸å­å‡½æ•°å‡æœ‰ä¸€æ ·çš„å˜é‡åï¼Œè€Œå†…å®¹ä¸ä¸€æ ·ä¼šæŠ¥é”™
#############################################################################

#é…ç½®æœ¬åœ°æº
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; localYumSource()
{
 systemUrl&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 ip&lt;/span&gt;=$&lt;span&gt;2&lt;/span&gt;&lt;span&gt;
 yumFile&lt;/span&gt;=/etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/CentOS-&lt;span&gt;Media.repo

 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.ä¸å­˜åœ¨åˆ™åˆ›å»ºmountçš„ç›®å½•
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [ ! -d /var/&lt;span&gt;iso ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
      &lt;span&gt;mkdir&lt;/span&gt; /var/&lt;span&gt;iso
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #æŒ‚è½½ç³»ç»Ÿï¼Œå·²æŒ‚è½½åˆ™ä¸å†æ¬¡æŒ‚è½½
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [ ! -d /var/iso/&lt;span&gt;CentOS_BuildTag ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt; 
     &lt;span&gt;mount&lt;/span&gt; -o loop $systemUrl /var/&lt;span&gt;iso
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.å¤„ç†å¹¶ä¿è¯åªæœ‰ä¸€ä¸ªCentOS-&lt;span&gt;Media.repoçš„æ–‡ä»¶ç”¨äºé…ç½®æœ¬åœ°yumæº
 doWithRepoFile 

 #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.é…ç½®yumæº
 configureYumSource &lt;/span&gt;&lt;span&gt;file&lt;/span&gt;:&lt;span&gt;///&lt;/span&gt;&lt;span&gt;var/iso $yumFile&lt;/span&gt;
&lt;span&gt;
 #&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;.å®‰è£…ç›¸åº”çš„è½¯ä»¶
 httpdIsExists&lt;/span&gt;=`rpm -qa | &lt;span&gt;grep&lt;/span&gt;&lt;span&gt; http`
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ -&lt;span&gt;z $httpdIsExists ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
     &lt;span&gt;yum&lt;/span&gt; &lt;span&gt;install&lt;/span&gt; -&lt;span&gt;y httpd
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;&lt;span&gt;.å¼€å¯httpdä½¿ç”¨æµè§ˆå™¨è®¿é—®
 #service httpd start
 httpdStatus&lt;/span&gt;=&lt;span&gt;`systemctl status httpd.service`
 result&lt;/span&gt;=$(&lt;span&gt;echo&lt;/span&gt; $httpdStatus | &lt;span&gt;grep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Active: active (running)&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $result = &lt;span&gt;&quot;&quot;&lt;/span&gt;&lt;span&gt; ]]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     systemctl start httpd.service
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;6&lt;/span&gt;&lt;span&gt;.å°†YUMæºé…ç½®åˆ°httpdä¸­ï¼Œå…¶ä»–çš„æœåŠ¡å™¨å¯é€šè¿‡ç½‘ç»œè®¿é—®è¿™ä¸ªå†…ç½‘ä¸­çš„YUMæº
 httpUrl&lt;/span&gt;=/var/www/html/CentOS-&lt;span&gt;7.0&lt;/span&gt;
 &lt;span&gt;if&lt;/span&gt; [ ! -e $httpUrl/&lt;span&gt;lock ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
     &lt;span&gt;cp&lt;/span&gt; -r /var/&lt;span&gt;iso $httpUrl
     &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;lock&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt; $httpUrl/&lt;span&gt;lock
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;&lt;span&gt;.å–æ¶ˆå…ˆå‰æŒ‚è½½çš„é•œåƒ å¼ºåˆ¶å–æ¶ˆï¼Œå“ˆå“ˆå“ˆå“ˆ
 &lt;/span&gt;&lt;span&gt;umount&lt;/span&gt; -fl /var/&lt;span&gt;iso
 
 #&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;.ä¿®æ”¹yumæºæŒ‡å‘çš„åœ°å€
 &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;'&lt;/span&gt;&lt;span&gt;s/^baseurl\=file:\/\/\/var\/iso/baseurl\=http:\/\/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;$ip&lt;span&gt;'&lt;/span&gt;&lt;span&gt;\/CentOS-7.0/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt; $yumFile
 
 #&lt;/span&gt;&lt;span&gt;9&lt;/span&gt;&lt;span&gt;.æ¸…é™¤YUMç¼“å­˜
 &lt;/span&gt;&lt;span&gt;yum&lt;/span&gt; clean all &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt; &lt;span&gt;2&lt;/span&gt;&amp;gt;&amp;amp;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 
 #&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;&lt;span&gt;.åˆ—å‡ºå¯ç”¨çš„YUMæº
 &lt;/span&gt;&lt;span&gt;yum&lt;/span&gt; repolist &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt; &lt;span&gt;2&lt;/span&gt;&amp;gt;&amp;amp;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 #&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;create the local yum source successfully&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
}

#é…ç½®è¿œç¨‹yumæº
&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; remoteYumSource()
{
 ip&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;
 yumUrl&lt;/span&gt;=http:&lt;span&gt;//&lt;/span&gt;&lt;span&gt;$ip/CentOS-7.0&lt;/span&gt;
 yumFile=/etc/&lt;span&gt;yum&lt;/span&gt;.repos.d/CentOS-&lt;span&gt;Media.repo 

 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;.å¤„ç†å¹¶ä¿è¯åªæœ‰ä¸€ä¸ªCentOS-&lt;span&gt;Media.repoçš„æ–‡ä»¶ç”¨äºé…ç½®yumæº
 doWithRepoFile

 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.é…ç½®yumæº
 configureYumSource $yumUrl $yumFile
}

&lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;

&lt;span&gt;if&lt;/span&gt; [[ $&lt;span&gt;hostname&lt;/span&gt; = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;node1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
&lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
    localYumSource &lt;/span&gt;/opt/system/CentOS-&lt;span&gt;7&lt;/span&gt;-x86_64-DVD-&lt;span&gt;1804&lt;/span&gt;.iso &lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;187.201&lt;/span&gt;
&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
    remoteYumSource &lt;/span&gt;&lt;span&gt;192.168&lt;/span&gt;.&lt;span&gt;187.201&lt;/span&gt;
&lt;span&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼Œå‚æ•°$hostnameä¸€èˆ¬ä¸ºnode1ã€node2ã€node3ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/configureYum.sh $hostname&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;2.7Â é…ç½®SSHæ— å¯†ç ç™»å½•&lt;/h2&gt;
&lt;p&gt;sshFreeLoginä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; sshFreeLogin()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.æ£€æµ‹expectæœåŠ¡æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™ä½¿ç”¨yumå®‰è£…expect
 expectIsExists&lt;/span&gt;=`rpm -qa | &lt;span&gt;grep&lt;/span&gt;&lt;span&gt; expect` 
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [ -&lt;span&gt;z $expectIsExists ]
 &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;
      &lt;span&gt;yum&lt;/span&gt; -y &lt;span&gt;install&lt;/span&gt;&lt;span&gt; expect
 &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

 #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.å¯†é’¥å¯¹ä¸å­˜åœ¨åˆ™åˆ›å»ºå¯†é’¥
 [ &lt;/span&gt;! -f /root/.&lt;span&gt;ssh&lt;/span&gt;/id_rsa.pub ] &amp;amp;&amp;amp; &lt;span&gt;ssh-keygen&lt;/span&gt; -t rsa -P &lt;span&gt;&quot;&quot;&lt;/span&gt; -f /root/.&lt;span&gt;ssh&lt;/span&gt;/&lt;span&gt;id_rsa

 &lt;/span&gt;&lt;span&gt;while&lt;/span&gt; read line;&lt;span&gt;do&lt;/span&gt;&lt;span&gt;
       #æå–æ–‡ä»¶ä¸­çš„ip
       &lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`
       #æå–æ–‡ä»¶ä¸­çš„ç”¨æˆ·å
       user_name&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f3`
       #æå–æ–‡ä»¶ä¸­çš„å¯†ç 
       pass_word&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f4`
          
       expect &lt;/span&gt;&amp;lt;&amp;lt;&lt;span&gt;EOF
              #å¤åˆ¶å…¬é’¥åˆ°ç›®æ ‡ä¸»æœº
              spawn &lt;/span&gt;&lt;span&gt;ssh&lt;/span&gt;-copy-&lt;span&gt;id&lt;/span&gt; $&lt;span&gt;hostname&lt;/span&gt;&lt;span&gt;
              expect {
                      #expectå®ç°è‡ªåŠ¨è¾“å…¥å¯†ç 
                      &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;yes/no&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; { send &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;yes\n&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;exp_continue } 
                      &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;password&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; { send &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;$pass_word\n&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;exp_continue }
                      eof
              }
EOF
 # è¯»å–å­˜å‚¨ipçš„æ–‡ä»¶ 
 &lt;/span&gt;&lt;span&gt;done&lt;/span&gt; &amp;lt; /home/hadoop/automaticDeploy/&lt;span&gt;host_ip.txt
 
}

sshFreeLogin&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/sshFreeLogin.sh&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;2.8Â é…ç½®JDKç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;configureJDK.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; configureJDK()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.åœ¨frames.txtä¸­æŸ¥çœ‹æ˜¯å¦éœ€è¦å®‰è£…java
 javaInfo&lt;/span&gt;=`&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^jdk&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /home/hadoop/automaticDeploy/&lt;span&gt;frames.txt`
 
 java&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $javaInfo | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f1`
 isInstall&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $javaInfo | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`

 #æ˜¯å¦å®‰è£…
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $isInstall = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; ]];&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
 
    #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.æŸ¥çœ‹/opt/&lt;span&gt;framesç›®å½•ä¸‹æ˜¯å¦æœ‰javaå®‰è£…åŒ…
    javaIsExists&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /opt/frames -&lt;span&gt;name $java`
    
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ ${#javaIsExists} -ne &lt;span&gt;0&lt;/span&gt; ]];&lt;span&gt;then&lt;/span&gt;
        
        &lt;span&gt;if&lt;/span&gt; [ -d /usr/lib/java ];&lt;span&gt;then&lt;/span&gt;
              &lt;span&gt;rm&lt;/span&gt; -rf /usr/lib/&lt;span&gt;java
        &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
 
        &lt;span&gt;mkdir&lt;/span&gt; /usr/lib/java &amp;amp;&amp;amp; &lt;span&gt;chmod&lt;/span&gt; -R &lt;span&gt;777&lt;/span&gt; /usr/lib/&lt;span&gt;java
   
        #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶å¤¹/usr/lib/&lt;span&gt;javaä¸­ 
        &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å¼€å¯è§£å‹jdkå®‰è£…åŒ…&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
        &lt;span&gt;tar&lt;/span&gt; -zxvf $javaIsExists -C /usr/lib/java &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
        &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;jdkå®‰è£…åŒ…è§£å‹å®Œæ¯•&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
    
        java_home&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /usr/lib/java -maxdepth &lt;span&gt;1&lt;/span&gt; -name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;jdk*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;`

        #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;.åœ¨/etc/&lt;span&gt;profileé…ç½®JAVA_HOME
        profile&lt;/span&gt;=/etc/&lt;span&gt;profile
        &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^export JAVA_HOME/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $profile
        &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;export JAVA_HOME=$java_home&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $profile
 
        #&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;.åœ¨/etc/&lt;span&gt;profileé…ç½®PATH
        &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^export PATH=\$PATH:\$JAVA_HOME\/bin/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $profile
        &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;export PATH=\$PATH:\$JAVA_HOME/bin&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $profile
        &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^export CLASSPATH=.:\$JAVA_HOME/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $profile
        &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;export CLASSPATH=.:\$JAVA_HOME/lib/dt.jar:\$JAVA_HOME/lib/tools.jar&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $profile

        #&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;.æ›´æ–°/etc/&lt;span&gt;profileæ–‡ä»¶
        source &lt;/span&gt;/etc/profile &amp;amp;&amp;amp; source /etc/&lt;span&gt;profile
    &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;
         &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/opt/framesç›®å½•ä¸‹æ²¡æœ‰jdkå®‰è£…åŒ…&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
    &lt;span&gt;fi&lt;/span&gt;
 &lt;span&gt;else&lt;/span&gt;
     &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/opt/framesç›®å½•ä¸‹æ²¡æœ‰jdkå®‰è£…åŒ…&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
 &lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
}

configureJDK&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/configureJDK.sh&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;2.9Â é…ç½®Scalaç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;configureScala.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; configureScala()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.åœ¨frames.txtä¸­æŸ¥çœ‹æ˜¯å¦éœ€è¦å®‰è£…scala
 scalaInfo&lt;/span&gt;=`&lt;span&gt;egrep&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;^scala&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /home/hadoop/automaticDeploy/&lt;span&gt;frames.txt`
 
 scala&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $scalaInfo | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f1`
 isInstall&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $scalaInfo | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`

 #æ˜¯å¦å®‰è£…
 &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $isInstall = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; ]];&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
     
     #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;.æŸ¥æ‰¾/opt/&lt;span&gt;framesç›®å½•ä¸‹æ˜¯å¦æœ‰Scalaå®‰è£…åŒ…
     scalaIsExists&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /opt/frames -&lt;span&gt;name $scala`

    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ ${#scalaIsExists} -ne &lt;span&gt;0&lt;/span&gt; ]];&lt;span&gt;then&lt;/span&gt;
    
       &lt;span&gt;if&lt;/span&gt; [ -d /usr/lib/scala ];&lt;span&gt;then&lt;/span&gt;
            &lt;span&gt;rm&lt;/span&gt; -rf /usr/lib/&lt;span&gt;scala
       &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;

       &lt;span&gt;mkdir&lt;/span&gt; /usr/lib/scala &amp;amp;&amp;amp; &lt;span&gt;chmod&lt;/span&gt; -R &lt;span&gt;777&lt;/span&gt; /usr/lib/&lt;span&gt;scala

       #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;.è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶å¤¹/usr/lib/&lt;span&gt;scalaä¸­
       &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å¼€å§‹è§£å‹scalaå®‰è£…åŒ…&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
       &lt;span&gt;tar&lt;/span&gt; -zxvf $scalaIsExists -C /usr/lib/scala &amp;gt;&amp;amp; /dev/&lt;span&gt;null&lt;/span&gt;
       &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;scalaå®‰è£…åŒ…è§£å‹å®Œæ¯•&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;

       scala_home&lt;/span&gt;=`&lt;span&gt;find&lt;/span&gt; /usr/lib/scala -maxdepth &lt;span&gt;1&lt;/span&gt; -name &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;scala-*&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;`
    
       #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;.åœ¨/etc/&lt;span&gt;profileé…ç½®SCALA_HOME
       profile&lt;/span&gt;=/etc/&lt;span&gt;profile
       &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^export SCALA_HOME/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $profile
       &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;export SCALA_HOME=$scala_home&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $profile

       #&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;.åœ¨/etc/&lt;span&gt;profileé…ç½®PATH
       &lt;/span&gt;&lt;span&gt;sed&lt;/span&gt; -i &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/^export PATH=\$PATH:\$SCALA_HOME\/bin/d&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; $profile
       &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;export PATH=\$PATH:\$SCALA_HOME/bin&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;&amp;gt;&lt;span&gt; $profile

       #&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;.æ›´æ–°/etc/&lt;span&gt;profileæ–‡ä»¶
       source &lt;/span&gt;/etc/profile &amp;amp;&amp;amp; source /etc/&lt;span&gt;profile  
    &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; 
        &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/opt/framesç›®å½•ä¸‹æ²¡æœ‰scalaå®‰è£…åŒ…1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
    &lt;span&gt;fi&lt;/span&gt;
 &lt;span&gt;else&lt;/span&gt;
       &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/opt/framesç›®å½•ä¸‹æ²¡æœ‰scalaå®‰è£…åŒ…2&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
 &lt;span&gt;fi&lt;/span&gt;&lt;span&gt;

}

configureScala&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/configureScala.sh&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;

&lt;h2&gt;3.1Â å•æœºä¸Šæ•´åˆç¬¬2ç‚¹çš„9ä¸ªæ¨¡å—è‡ªåŠ¨åŒ–æ‰¹é‡æ‰§è¡Œ&lt;/h2&gt;
&lt;p&gt;batchOperate.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;hostname&lt;/span&gt;=$&lt;span&gt;1&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.ipåœ°å€ä¿®æ”¹ï¼Œç›®å‰åªèƒ½æ¯å°æœºå™¨ç‹¬è‡ªä¿®æ”¹ipåœ°å€
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;1&lt;/span&gt;&lt;span&gt;.ipåœ°å€ä¿®æ”¹æš‚æ— &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.ä¿®æ”¹æœºå™¨åhostname
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;2&lt;/span&gt;&lt;span&gt;.ä¿®æ”¹hostnameä¸ºnode1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/changeHostname.&lt;span&gt;sh&lt;/span&gt; $&lt;span&gt;hostname&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.hosté…ç½®æ–‡ä»¶ä¿®æ”¹
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;3.æŠŠé›†ç¾¤ipåŠå…¶æ˜ å°„çš„hostnameæ·»åŠ åˆ°/etc/hostsä¸­&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/addClusterIps.&lt;span&gt;sh&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;.å…³é—­é˜²ç«å¢™ã€SELINUX ï¼Œéœ€è¦è¾“å…¥å‚æ•°closeæˆ–start
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;4.å…³é—­é˜²ç«å¢™ã€SELINUX&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/closeFirewall.&lt;span&gt;sh&lt;/span&gt;&lt;span&gt; close

#&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;&lt;span&gt;.æ·»åŠ bigdataç”¨æˆ·å ï¼Œéœ€è¦è¾“å…¥å‚æ•°createæˆ–delete
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;5.æ·»åŠ bigdataç”¨æˆ·å&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/autoCreateUser.&lt;span&gt;sh&lt;/span&gt;&lt;span&gt; create

#&lt;/span&gt;&lt;span&gt;6&lt;/span&gt;&lt;span&gt;.é…ç½®yumæº
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;6.é…ç½®yumæº&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/configureYum.&lt;span&gt;sh&lt;/span&gt; $&lt;span&gt;hostname&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;&lt;span&gt;.é…ç½®SSHæ— å¯†ç ç™»å½•
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;7.é›†ç¾¤å„èŠ‚ç‚¹ä¹‹é—´é…ç½®SSHæ— å¯†ç ç™»å½•&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/sshFreeLogin.&lt;span&gt;sh&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;.é…ç½®JDKç¯å¢ƒ
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;8.é…ç½®jdkç¯å¢ƒ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/configureJDK.&lt;span&gt;sh&lt;/span&gt;&lt;span&gt;

#&lt;/span&gt;&lt;span&gt;9&lt;/span&gt;&lt;span&gt;.é…ç½®SCALAç¯å¢ƒ
&lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;9.é…ç½®scalaç¯å¢ƒ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
/home/hadoop/automaticDeploy/systems/configureScala.&lt;span&gt;sh&lt;/span&gt;

&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥rootç”¨æˆ·æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼Œå‚æ•°$hostnameä¸€èˆ¬ä¸ºnode1ã€node2ã€node3ï¼šï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/batchOperate.sh $hostname&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;åœ¨ä¸€å°æœºå™¨ä¸Šæ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œå¯ä»¥è¿…é€Ÿè®¾ç½®è¯¥å°æœºå™¨çš„ç³»ç»Ÿç¯å¢ƒã€‚ä½†æ˜¯å¦‚æœé›†ç¾¤æœºå™¨è¿‡å¤šï¼Œåˆ™éœ€è¦æ¯å°æœºå™¨éƒ½è¦æ‰§è¡Œ&lt;em&gt;batchOperate.shï¼Œ&lt;/em&gt;æ‰€ä»¥éœ€è¦3.2ç‚¹åœ¨é›†ç¾¤ä¸Šä¸€æ¬¡æ€§éƒ¨ç½²æ•´ä¸ªé›†ç¾¤ä¸Šæœºå™¨çš„ç³»ç»Ÿç¯å¢ƒï¼Œè€Œä¸éœ€è¦æ¯å°æœºå™¨éƒ½é‡å¤éƒ¨ç½²ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;3.2Â é›†ç¾¤ä¸Šè‡ªåŠ¨åŒ–éƒ¨ç½²å®‰è£…&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œä»¥node1ä¸ºåŸºç‚¹ï¼Œé›†ç¾¤ä¸Šçš„æ‰€æœ‰æ“ä½œè§¦å‘ç‚¹éƒ½åœ¨node1ä¸Šï¼Œæ“ä½œåŸç†ä¸ºï¼šåœ¨clusterOperate.shä»£ç é‡Œï¼Œnode1ä¸Šæœ¬åœ°æ‰§è¡ŒbatchOperate.shè®¾ç½®æœ¬åœ°æœºå™¨çš„ç³»ç»Ÿç¯å¢ƒï¼Œè€Œåˆ©ç”¨sshè¿œç¨‹æ‰§è¡ŒbatchOperate.shè®¾ç½®è¿œç¨‹æœºå™¨çš„ç³»ç»Ÿç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;clusterOperate.shä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
#! /bin/&lt;span&gt;bash

&lt;/span&gt;&lt;span&gt;function&lt;/span&gt;&lt;span&gt; clusterOperate()
{
 #&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;.è¿œç¨‹å¤åˆ¶æ–‡ä»¶
  &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; read line;
  &lt;/span&gt;&lt;span&gt;do&lt;/span&gt;
    &lt;span&gt;hostname&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $line | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`
    &lt;/span&gt;&lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç›®å‰æ­£åœ¨è®¾ç½®$hostnameèŠ‚ç‚¹çš„ç³»ç»Ÿç¯å¢ƒ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
    
    #é»˜è®¤node1ä¸ºæœ¬åœ°ä¸»æœº
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $&lt;span&gt;hostname&lt;/span&gt; = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;node1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; ]]
    &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
        #&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;.æœ¬åœ°ä¸»æœºæ“ä½œ
        &lt;/span&gt;/home/hadoop/automaticDeploy/systems/batchOperate.&lt;span&gt;sh&lt;/span&gt; $&lt;span&gt;hostname&lt;/span&gt;
    &lt;span&gt;else&lt;/span&gt;&lt;span&gt;
        #&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;.è¿œç¨‹ä¸»æœºæ“ä½œ
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; test -e /home/hadoop/&lt;span&gt;automaticDeploy
        &lt;/span&gt;&lt;span&gt;then&lt;/span&gt;&lt;span&gt;
             #&lt;/span&gt;&lt;span&gt;3.1&lt;/span&gt;&lt;span&gt; å­˜åœ¨åˆ™å…ˆåˆ é™¤æ—§çš„
             &lt;/span&gt;&lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;rm -rf /home/hadoop/automaticDeploy&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
        &lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
 
        #&lt;/span&gt;&lt;span&gt;3.2&lt;/span&gt;&lt;span&gt; æŠŠæœ¬åœ°çš„automaticDeployé‡Œé¢çš„è„šæœ¬æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºä¸Š
        &lt;/span&gt;&lt;span&gt;scp&lt;/span&gt; -r /home/hadoop/automaticDeploy/ $&lt;span&gt;hostname&lt;/span&gt;:/home/hadoop/&lt;span&gt;automaticDeploy

        #&lt;/span&gt;&lt;span&gt;3.3&lt;/span&gt; æŠŠæœ¬åœ°çš„/opt/framesé‡Œçš„è½¯ä»¶å®‰è£…åŒ…å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºçš„/opt/&lt;span&gt;framesä¸Š
        #åˆ¤æ–­è¿œç¨‹ä¸»æœºä¸Š&lt;/span&gt;/opt/&lt;span&gt;framesæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º 
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; test -e /opt/frames/;&lt;span&gt;then&lt;/span&gt;
            &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å­˜åœ¨&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt;
        &lt;span&gt;else&lt;/span&gt;
            &lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;mkdir /opt/frames&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;
        &lt;span&gt;fi&lt;/span&gt;&lt;span&gt;
   
        #éå†éœ€è¦å®‰è£…çš„è½¯ä»¶
        &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; read lineString;
        &lt;/span&gt;&lt;span&gt;do&lt;/span&gt;&lt;span&gt;
          software&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $lineString | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f1`
          isInstall&lt;/span&gt;=`&lt;span&gt;echo&lt;/span&gt; $lineString | &lt;span&gt;cut&lt;/span&gt; -d &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; -&lt;span&gt;f2`
          &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; [[ $isInstall = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; ]];&lt;span&gt;then&lt;/span&gt;
              &lt;span&gt;if&lt;/span&gt; &lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; test -e /opt/frames/$software;&lt;span&gt;then&lt;/span&gt;
                  &lt;span&gt;echo&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å­˜åœ¨&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt; /dev/&lt;span&gt;null&lt;/span&gt;
              &lt;span&gt;else&lt;/span&gt;  
                  &lt;span&gt;scp&lt;/span&gt; /opt/frames/$software $&lt;span&gt;hostname&lt;/span&gt;:/opt/frames/&lt;span&gt;$software
              &lt;/span&gt;&lt;span&gt;fi&lt;/span&gt;
          &lt;span&gt;fi&lt;/span&gt;
        &lt;span&gt;done&lt;/span&gt; &amp;lt; /home/hadoop/automaticDeploy/&lt;span&gt;frames.txt
 
        #&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;.è¿œç¨‹æ‰§è¡Œæ–‡ä»¶
        &lt;/span&gt;&lt;span&gt;ssh&lt;/span&gt; -n $&lt;span&gt;hostname&lt;/span&gt; /home/hadoop/automaticDeploy/systems/batchOperate.&lt;span&gt;sh&lt;/span&gt; $&lt;span&gt;hostname&lt;/span&gt;
    &lt;span&gt;fi&lt;/span&gt;
  &lt;span&gt;done&lt;/span&gt; &amp;lt; /home/hadoop/automaticDeploy/&lt;span&gt;host_ip.txt

}

clusterOperate&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨node1èŠ‚ç‚¹ä¸Šï¼Œä»¥rootç”¨æˆ·æ‰§è¡ŒclusterOperate.shï¼Œä¸€æ¬¡æ€§éƒ¨ç½²é›†ç¾¤ä¸‰ä¸ªèŠ‚ç‚¹çš„ç³»ç»Ÿç¯å¢ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;em&gt;/home/hadoop/automaticDeploy/systems/clusterOperate.sh&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;åˆ°æ­¤ï¼Œé›†ç¾¤ä¸­æ¯å°æœºå™¨çš„ç¯å¢ƒè‡ªåŠ¨åŒ–è®¾ç½®å®Œæˆï¼Œä¸‹ä¸€ç¯‡ä»‹ç»å¦‚ä½•è‡ªåŠ¨åŒ–éƒ¨ç½²å¤§æ•°æ®ç»„ä»¶hadoopã€sparkã€hbaseã€hiveã€kafkaç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;æ‰€æœ‰shellæ–‡ä»¶ä»£ç å­˜æ”¾åœ¨githubä¸Šï¼Œä»£ç å¯èƒ½å†™å¾—ä¸æ˜¯å¾ˆå®Œç¾ï¼Œæ¬¢è¿æŒ‡å‡ºé”™è¯¯ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;githubåœ°å€&lt;/strong&gt;&lt;/span&gt;ä¸ºï¼š&lt;a title=&quot;https://github.com/qiushangwenyue/BigData_AutomaticDeploy&quot; href=&quot;https://github.com/qiushangwenyue/BigData_AutomaticDeploy&quot; target=&quot;_blank&quot;&gt;https://github.com/qiushangwenyue/BigData_AutomaticDeploy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://zhidao.baidu.com/question/502381951517702724.html&quot; rel=&quot;nofollow&quot;&gt;https://zhidao.baidu.com/question/502381951517702724.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq_34685846/article/details/72825587&quot; rel=&quot;nofollow&quot;&gt;https://blog.csdn.net/qq_34685846/article/details/72825587&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/cute/archive/2011/08/26/2154137.html&quot; rel=&quot;nofollow&quot;&gt;https://www.cnblogs.com/cute/archive/2011/08/26/2154137.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/mark-zhou/p/5976222.html&quot; rel=&quot;nofollow&quot;&gt;https://www.cnblogs.com/mark-zhou/p/5976222.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/kinger0/article/details/52251847&quot; rel=&quot;nofollow&quot;&gt;https://blog.csdn.net/kinger0/article/details/52251847&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/wyl9527/article/details/72831567&quot; rel=&quot;nofollow&quot;&gt;https://blog.csdn.net/wyl9527/article/details/72831567&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/hello_hwc/article/details/40118129&quot; rel=&quot;nofollow&quot;&gt;https://blog.csdn.net/hello_hwc/article/details/40118129&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.codebelief.com/article/2017/02/26-examples-of-find-command-on-linux/&quot; rel=&quot;nofollow&quot;&gt;http://www.codebelief.com/article/2017/02/26-examples-of-find-command-on-linux/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://hadesmo.com/2015/07/20/sed.html&quot; rel=&quot;nofollow&quot;&gt;http://hadesmo.com/2015/07/20/sed.html&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 15:57:00 +0000</pubDate>
<dc:creator>ç‰§æ¢¦è€…</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/swordfall/p/9330063.html</dc:identifier>
</item>
<item>
<title>Nettyæºç â€”ä¸ƒã€å†…å­˜é‡Šæ”¾ - lacker</title>
<link>http://www.cnblogs.com/sunshine-2015/p/9393410.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/sunshine-2015/p/9393410.html</guid>
<description>&lt;p&gt;Nettyæœ¬èº«åœ¨å†…å­˜åˆ†é…ä¸Šæ”¯æŒå †å†…å­˜å’Œç›´æ¥å†…å­˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€‰ç”¨ç›´æ¥å†…å­˜ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„é…ç½®ã€‚æ‰€ä»¥è¦ç†è§£Nettyå†…å­˜çš„é‡Šæ”¾æˆ‘ä»¬å¾—å…ˆçœ‹ä¸‹ç›´æ¥å†…å­˜çš„é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;h2 id=&quot;javaç›´æ¥å†…å­˜é‡Šæ”¾&quot;&gt;Javaç›´æ¥å†…å­˜é‡Šæ”¾&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ç›´æ¥å†…å­˜æ˜¯æ€ä¹ˆä½¿ç”¨çš„&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;ByteBuffer.allocateDirect(capacity)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç”³è¯·çš„è¿‡ç¨‹æ˜¯å…¶å®å°±æ˜¯åˆ›å»ºä¸€ä¸ªDirectByteBufferå¯¹è±¡çš„è¿‡ç¨‹ï¼ŒDirectByteBufferå¯¹è±¡åªç›¸å½“äºä¸€ä¸ªholderï¼ŒåŒ…å«ä¸€ä¸ªaddressï¼Œè¿™ä¸ªæ˜¯ç›´æ¥å†…å­˜çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è°ƒç”¨nativeæ–¹æ³•ç”³è¯·å†…å­˜&lt;/li&gt;
&lt;li&gt;åˆå§‹åŒ–cleaner&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public static ByteBuffer allocateDirect(int capacity) {
    return new DirectByteBuffer(capacity);
}

DirectByteBuffer(int cap) {                   // package-private
    // çœç•¥ä¸­é—´ä»£ç ...
    // åˆ›å»ºä¸€ä¸ªcleanerï¼Œæœ€åä¼šè°ƒç”¨Deallocator.runæ¥é‡Šæ”¾å†…å­˜
    cleaner = Cleaner.create(this, new Deallocator(base, size, cap));
    att = null;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Cleanerè¿™ä¸ªç±»ç»§æ‰¿è‡ªPhantomReferenceï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„è™šå¼•ç”¨ï¼Œè¿™ç§ç±»å‹å¼•ç”¨çš„ç‰¹ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ä½¿ç”¨getæ–¹æ³•ä¸èƒ½è·å–åˆ°å¯¹è±¡&lt;/li&gt;
&lt;li&gt;åªè¦å¼•ç”¨çš„å¯¹è±¡é™¤äº†PhantomReferenceä¹‹å¤–æ²¡æœ‰å…¶ä»–å¼•ç”¨äº†ï¼ŒJVMéšæ—¶å¯ä»¥å°†PhantomReferenceå¼•ç”¨çš„å¯¹è±¡å›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;JVMåœ¨å›å‰ä¼šå°†å°†è¦è¢«å›æ”¶çš„å¯¹è±¡æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç”±äºCleanerç»§æ‰¿è‡ªPhantomReferenceï¼Œé˜Ÿåˆ—çš„å®ç°æ˜¯ä½¿ç”¨cleanerçš„&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;private static final ReferenceQueue&amp;lt;Object&amp;gt; dummyQueue = new ReferenceQueue&amp;lt;&amp;gt;();&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªé˜Ÿåˆ—åœ¨PhantomReferenceçš„çˆ¶ç±»Referenceä¸­ä½¿ç”¨åˆ°äº†ï¼ŒReferenceè¿™ä¸ªç±»åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥è°ƒç”¨cleaner.cleanæ–¹æ³•ï¼Œåœ¨Referenceçš„é™æ€ä»£ç å—ä¸­å¯åŠ¨çº¿ç¨‹&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;// java.lang.ref.Reference
static {
    ThreadGroup tg = Thread.currentThread().getThreadGroup();
    for (ThreadGroup tgn = tg;
         tgn != null;
         tg = tgn, tgn = tg.getParent());
    Thread handler = new ReferenceHandler(tg, &quot;Reference Handler&quot;);
    /* If there were a special system-only priority greater than
         * MAX_PRIORITY, it would be used here
         */
    handler.setPriority(Thread.MAX_PRIORITY);
    handler.setDaemon(true);
    // å¯åŠ¨ReferenceHandlerçº¿ç¨‹
    handler.start();
    // çœç•¥ä¸­é—´ä»£ç ...
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¥çº¿ç¨‹çš„ä¸»è¦ä½œç”¨å°±æ˜¯è°ƒç”¨tryHandlePending&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;// java.lang.ref.Reference#tryHandlePending
static boolean tryHandlePending(boolean waitForNotify) {
        Reference&amp;lt;Object&amp;gt; r;
        Cleaner c;
        try {
            synchronized (lock) {
                if (pending != null) {
                    r = pending;
                    // 'instanceof' might throw OutOfMemoryError sometimes
                    // so do this before un-linking 'r' from the 'pending' chain...
                    c = r instanceof Cleaner ? (Cleaner) r : null;
                    // unlink 'r' from 'pending' chain
                    pending = r.discovered;
                    r.discovered = null;
                } else {
                    // The waiting on the lock may cause an OutOfMemoryError
                    // because it may try to allocate exception objects.
                    if (waitForNotify) {
                        lock.wait();
                    }
                    // retry if waited
                    return waitForNotify;
                }
            }
        } catch (OutOfMemoryError x) {
            // Give other threads CPU time so they hopefully drop some live references
            // and GC reclaims some space.
            // Also prevent CPU intensive spinning in case 'r instanceof Cleaner' above
            // persistently throws OOME for some time...
            Thread.yield();
            // retry
            return true;
        } catch (InterruptedException x) {
            // retry
            return true;
        }

        // Fast path for cleaners
        if (c != null) {
            // è°ƒç”¨cleanæ–¹æ³•
            c.clean();
            return true;
        }

        ReferenceQueue&amp;lt;? super Object&amp;gt; q = r.queue;
        if (q != ReferenceQueue.NULL) q.enqueue(r);
        return true;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;System.gcä¸èƒ½å›æ”¶å †å¤–å†…å­˜ï¼Œä½†æ˜¯ä¼šå›æ”¶å·²ç»æ²¡æœ‰ä½¿ç”¨äº†DirectByteBufferå¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¢«å›æ”¶çš„æ—¶å€™ä¼šå°†cleanerå¯¹è±¡æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨Referenceçš„çº¿ç¨‹ä¸­è°ƒç”¨cleanæ–¹æ³•æ¥å›æ”¶å †å¤–å†…å­˜ ã€‚cleaner.runæ‰§è¡Œçš„æ˜¯ä¼ å…¥å‚æ•°çš„thunk.runæ–¹æ³•ï¼Œè¿™é‡Œthunkæ˜¯Deallocatorï¼Œæ‰€ä»¥æœ€åæ‰§è¡Œçš„Deallocator.runæ–¹æ³•&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public void run() {
    if (address == 0) {
        // Paranoia
        return;
    }
    // é‡Šæ”¾å†…å­˜
    unsafe.freeMemory(address);
    address = 0;
    Bits.unreserveMemory(size, capacity);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥æœ€åé€šè¿‡unsafe.freeMemoryé‡Šæ”¾äº†ç”³è¯·åˆ°çš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨ç”³è¯·å†…å­˜çš„æ—¶å€™è°ƒç”¨çš„æ˜¯&lt;code&gt;java.nio.ByteBuffer#allocateDirect&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¼šnew DirectByteBufferï¼Œé€šè¿‡Cleaner.createåˆ›å»ºCleanerï¼ŒåŒæ—¶ä¼ å…¥Deallocatorä½œä¸ºRunnableå‚æ•°ï¼Œåœ¨Cleaner.cleançš„æ—¶å€™ä¼šè°ƒç”¨è¯¥Deallocator.runæ¥å¤„ç†&lt;/p&gt;
&lt;p&gt;Cleanerç»§æ‰¿è‡ªPhantomReferenceï¼ŒåŒ…å«ä¸€ä¸ªReferenceQueueï¼Œåœ¨DirectByteBufferä¸å†ä½¿ç”¨çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡æ˜¯å¤„äºJavaå †çš„ï¼Œé™¤äº†è¯¥PhantomReferenceå¼•ç”¨äº†DirectByteBufferå¤–ï¼Œæ²¡æœ‰å…¶ä»–å¼•ç”¨çš„æ—¶å€™ï¼Œjvmä¼šæŠŠcleanerå¯¹è±¡æ”¾å…¥ReferenceQueueé˜Ÿåˆ—ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;PhantomReferenceç»§æ‰¿äº†Referenceï¼ŒReferenceä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼ˆjava.lang.ref.Reference.ReferenceHandler#runï¼‰å»è°ƒç”¨é˜Ÿåˆ—ä¸­çš„cleaner.cleanæ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&quot;nettyå†…å­˜é‡Šæ”¾&quot;&gt;Nettyå†…å­˜é‡Šæ”¾&lt;/h2&gt;
&lt;p&gt;Nettyä½¿ç”¨çš„ç›´æ¥å†…å­˜çš„é‡Šæ”¾æ–¹å¼å’ŒJDKçš„é‡Šæ”¾æ–¹å¼ç•¥æœ‰ä¸åŒã€‚Nettyå¼€å§‹é‡Šæ”¾å†…å­˜çš„æ—¶å€™æ˜¯è°ƒç”¨freeæ–¹æ³•çš„æ—¶å€™&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;io.netty.buffer.PoolArena#free
io.netty.buffer.PoolArena.DirectArena#destroyChunk&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æœ€ç»ˆé‡Šæ”¾å†…å­˜çš„æ–¹æ³•æœ‰ä¸¤ç§&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;åˆ©ç”¨åå°„è·å–unsafeï¼Œè°ƒç”¨Unsafe#freeMemory&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨åå°„è·å–DirectByteBuffer#cleanerï¼Œé€šè¿‡åå°„è°ƒç”¨cleaner.cleanæ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;ä¸¤ç§ä¸åŒçš„æ–¹å¼ä¾èµ–çš„æ¡ä»¶ä¸åŒï¼Œä½¿ç”¨åœºæ™¯ä¹Ÿä¸åŒ&lt;/p&gt;
&lt;h3 id=&quot;ä½¿ç”¨åå°„è°ƒç”¨cleaner.clean&quot;&gt;ä½¿ç”¨åå°„è°ƒç”¨cleaner.clean&lt;/h3&gt;
&lt;p&gt;è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€çš„æ—¶å€™ä½¿ç”¨è¿™ç§æ–¹å¼&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;æ²¡æœ‰å¯ä½¿ç”¨çš„ç›´æ¥å†…å­˜&lt;/li&gt;
&lt;li&gt;ä¸èƒ½è·å–unsafe&lt;/li&gt;
&lt;li&gt;directBufferæ²¡æœ‰ä¼ å…¥longã€intçš„æ„é€ æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;&lt;h3 id=&quot;ä½¿ç”¨unsafe&quot;&gt;ä½¿ç”¨unsafe&lt;/h3&gt;
&lt;p&gt;ä¸èƒ½ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹å¼çš„éƒ½ä½¿ç”¨unsafe&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 15:14:00 +0000</pubDate>
<dc:creator>lacker</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/sunshine-2015/p/9393410.html</dc:identifier>
</item>
<item>
<title>ç›˜ç‚¹ Python ä¸­çš„é‚£äº›å†·çŸ¥è¯†ï¼ˆä¸€ï¼‰ - ç«™åœ¨ä¸¤ä¸ªä¸–ç•Œçš„è¾¹ç¼˜</title>
<link>http://www.cnblogs.com/wongbingming/p/9393186.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/wongbingming/p/9393186.html</guid>
<description>&lt;div class=&quot;output_wrapper&quot; id=&quot;output_wrapper_id&quot; readability=&quot;89&quot;&gt;
&lt;p&gt;å°æ˜åœ¨æ—¥å¸¸Codeä¸­é‡åˆ°ä¸€äº›å¥½ç©ï¼Œå†·é—¨çš„äº‹æƒ…ï¼Œé€šå¸¸éƒ½ä¼šè®°å½•ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å·²ç»ç§¯æ”’äº†ä¸€äº›äº†ï¼Œæœ€è¿‘æ‰“ç®—æ•´ç†ä¸€æ³¢ï¼Œå‘å‡ºæ¥ç»™å¤§å®¶è¡¥è¡¥ã€‚ä¸€ç¯‡åªåˆ†äº«äº”ä¸ªï¼Œæœ‰æ—¶é—´äº†å°±æ•´ç†ã€‚ä¸æƒ³é”™è¿‡çš„ï¼Œåƒä¸‡è®°å¾—å…³æ³¨ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h3 id=&quot;h1&quot;&gt;&lt;span&gt;1. çœç•¥å·ä¹Ÿæ˜¯å¯¹è±¡&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;...&lt;/code&gt; è¿™æ˜¯çœç•¥å·ï¼Œåœ¨Pythonä¸­ï¼Œä¸€åˆ‡çš†å¯¹è±¡ã€‚å®ƒä¹Ÿä¸ä¾‹å¤–ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Python ä¸­ï¼Œå®ƒå«åš Ellipsis ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Python 3 ä¸­ä½ å¯ä»¥ç›´æ¥å†™â€¦æ¥å¾—åˆ°è¿™ç©æ„ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;python language-python hljs&quot;&gt;&amp;gt;&amp;gt;&amp;gt; ...&lt;br/&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;Ellipsis&lt;/span&gt;&lt;br/&gt;&amp;gt;&amp;gt;&amp;gt; type(...)&lt;br/&gt;&amp;lt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; '&lt;span class=&quot;hljs-title&quot;&gt;ellipsis&lt;/span&gt;'&amp;gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è€Œåœ¨ 2 ä¸­æ²¡æœ‰â€¦è¿™ä¸ªè¯­æ³•ï¼Œåªèƒ½ç›´æ¥å†™Ellipsisæ¥è·å–ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;python language-python hljs&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Ellipsis&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;Ellipsis&lt;/span&gt;&lt;br/&gt;&amp;gt;&amp;gt;&amp;gt; type(&lt;span class=&quot;hljs-built_in&quot;&gt;Ellipsis&lt;/span&gt;)&lt;br/&gt;&amp;lt;type &lt;span class=&quot;hljs-string&quot;&gt;'ellipsis'&lt;/span&gt;&amp;gt;&lt;br/&gt;&amp;gt;&amp;gt;&amp;gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å®ƒè½¬ä¸ºå¸ƒå°”å€¼æ—¶ä¸ºçœŸ&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;python language-python hljs&quot;&gt;&amp;gt;&amp;gt;&amp;gt; bool(...)&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;True&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æœ€åï¼Œè¿™ä¸œè¥¿æ˜¯ä¸€ä¸ªå•ä¾‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;python language-python hljs&quot;&gt;&amp;gt;&amp;gt;&amp;gt; id(...)&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;4362672336&lt;/span&gt;&lt;br/&gt;&amp;gt;&amp;gt;&amp;gt; id(...)&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;4362672336&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™ä¸œè¥¿æœ‰å•¥ç”¨å‘¢ï¼Ÿæ®è¯´å®ƒæ˜¯Numpyçš„è¯­æ³•ç³–ï¼Œä¸ç© Numpy çš„äººï¼Œå¯ä»¥è¯´æ˜¯æ²¡å•¥ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç½‘ä¸Šåªçœ‹åˆ°è¿™ä¸ª ç”¨ &lt;code&gt;...&lt;/code&gt; ä»£æ›¿ pass ï¼Œç¨å¾®æœ‰ç‚¹ç”¨ï¼Œä½†åˆä¸æ˜¯å¿…é¡»ä½¿ç”¨çš„ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs python&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;:&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;/&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;except&lt;/span&gt; ZeroDivisionError:&lt;br/&gt;...&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;h2&quot;&gt;&lt;span&gt;2. ç±»é¦–å­—æ¯ä¸ä¸€å®šæ˜¯å¤§å†™&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰€ç¼–å†™çš„æ‰€è§åˆ°çš„ä»£ç ï¼Œå¥½åƒéƒ½é»˜è®¸äº†ç±»åé¦–å­—æ¯å¤§å†™ï¼Œè€Œå®ä¾‹ç”¨å°å†™çš„è¿™ä¸€å‡†åˆ™ã€‚ä½†è¿™å¹¶ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œå³ä½¿ä½ åè¿‡æ¥çš„ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æœ‰ä¸€äº›å†…ç½®çš„ç±»ï¼Œé¦–å­—æ¯éƒ½æ˜¯å°å†™ï¼Œè€Œå®ä¾‹éƒ½æ˜¯å¤§å†™ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ bool æ˜¯ç±»åï¼Œè€Œ Trueï¼ŒFalse æ˜¯å…¶å®ä¾‹ï¼›&lt;br/&gt;æ¯”å¦‚ ellipsis æ˜¯ç±»åï¼ŒEllipsisæ˜¯å®ä¾‹ï¼›&lt;br/&gt;è¿˜æœ‰ intï¼Œstringï¼Œfloatï¼Œlistï¼Œtupleï¼Œdict ç­‰ä¸€ç³»åˆ—æ•°æ®ç±»å‹éƒ½æ˜¯ç±»åï¼Œå®ƒä»¬éƒ½æ˜¯å°å†™ã€‚&lt;/p&gt;
&lt;h3 id=&quot;h3&quot;&gt;&lt;span&gt;3. å¢é‡èµ‹å€¼çš„æ€§èƒ½æ›´å¥½&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;è¯¸å¦‚ &lt;code&gt;+=&lt;/code&gt; å’Œ &lt;code&gt;*=&lt;/code&gt; è¿™äº›è¿ç®—ç¬¦ï¼Œå«åš å¢é‡èµ‹å€¼è¿ç®—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨ç”¨ += ä¸¾ä¾‹ï¼Œä»¥ä¸‹ä¸¤ç§å†™æ³•ï¼Œåœ¨æ•ˆæœä¸Šæ˜¯ç­‰ä»·çš„ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs ini&quot;&gt;&lt;br/&gt;&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; ; a += &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;p&gt;&lt;br/&gt;&lt;span class=&quot;hljs-attr&quot;&gt;a&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; a = a + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;/p&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;+=&lt;/code&gt; å…¶èƒŒåä½¿ç”¨çš„é­”æ³•æ–¹æ³•æ˜¯ __iadd__ï¼Œå¦‚æœæ²¡æœ‰å®ç°è¿™ä¸ªæ–¹æ³•åˆ™ä¼šé€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨ __add__ ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤ç§å†™æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç”¨åˆ—è¡¨ä¸¾ä¾‹ a += bï¼Œä½¿ç”¨ __iadd__ çš„è¯å°±åƒæ˜¯ä½¿ç”¨äº†a.extend(b),å¦‚æœä½¿ç”¨ __add__ çš„è¯ï¼Œåˆ™æ˜¯ a = a+b,å‰è€…æ˜¯ç›´æ¥åœ¨åŸåˆ—è¡¨ä¸Šè¿›è¡Œæ‰©å±•ï¼Œè€Œåè€…æ˜¯å…ˆä»åŸåˆ—è¡¨ä¸­å–å‡ºå€¼ï¼Œåœ¨ä¸€ä¸ªæ–°çš„åˆ—è¡¨ä¸­è¿›è¡Œæ‰©å±•ï¼Œç„¶åå†å°†æ–°çš„åˆ—è¡¨å¯¹è±¡è¿”å›ç»™å˜é‡ï¼Œæ˜¾ç„¶åè€…çš„æ¶ˆè€—è¦å¤§äº›ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åœ¨èƒ½ä½¿ç”¨å¢é‡èµ‹å€¼çš„æ—¶å€™å°½é‡ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;h3 id=&quot;h4andor&quot;&gt;&lt;span&gt;4. and å’Œ or çš„å–å€¼é¡ºåº&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;and å’Œ or æ˜¯æˆ‘ä»¬å†ç†Ÿæ‚‰ä¸è¿‡çš„ä¸¤ä¸ªé€»è¾‘è¿ç®—ç¬¦ã€‚è€Œæˆ‘ä»¬é€šå¸¸åªç”¨å®ƒæ¥åšåˆ¤æ–­ï¼Œå¾ˆå°‘ç”¨å®ƒæ¥å–å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªorè¡¨è¾¾å¼ä¸­æ‰€æœ‰å€¼éƒ½ä¸ºçœŸï¼ŒPythonä¼šé€‰æ‹©ç¬¬ä¸€ä¸ªå€¼ï¼Œè€Œandè¡¨è¾¾å¼åˆ™ä¼šé€‰æ‹©ç¬¬äºŒä¸ªã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs coffeescript&quot;&gt;&amp;gt;&amp;gt;&amp;gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) * (&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;)&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;14&lt;/span&gt;  &lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;h5&quot;&gt;&lt;span&gt;5. å¦‚ä½•ä¿®æ”¹è§£é‡Šå™¨æç¤ºç¬¦&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªå½“åšä»Šå¤©çš„ä¸€ä¸ªå°å½©è›‹å§ã€‚åº”è¯¥ç®—æ˜¯æ¯”è¾ƒå†·é—¨çš„ï¼Œä¼°è®¡çŸ¥é“çš„äººå¾ˆå°‘äº†å§ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨ ç»ˆç«¯ä¸‹ æ‰§è¡ŒPython å‘½ä»¤æ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs r&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; range(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;):&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;...&lt;/span&gt;     print (i)&lt;br/&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;...&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä½ æ˜¯å¦æƒ³è¿‡ &lt;code&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt; å’Œ &lt;code&gt;...&lt;/code&gt; è¿™ä¸¤ä¸ªæç¤ºç¬¦ä¹Ÿæ˜¯å¯ä»¥ä¿®æ”¹çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;hljs ruby&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&amp;gt; import sys                      &lt;br/&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&amp;gt; sys.ps1                         &lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'&amp;gt;&amp;gt;&amp;gt; '&lt;/span&gt;                              &lt;br/&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&amp;gt; sys.ps2                         &lt;br/&gt;&lt;span class=&quot;hljs-string&quot;&gt;'... '&lt;/span&gt;                              &lt;br/&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&amp;gt;                                 &lt;br/&gt;&amp;gt;&amp;gt;&amp;gt; sys.ps2 = &lt;span class=&quot;hljs-string&quot;&gt;'................'&lt;/span&gt;                 &lt;br/&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&amp;gt; sys.ps1 = &lt;span class=&quot;hljs-string&quot;&gt;'Pythonç¼–ç¨‹æ—¶å…‰&amp;gt;&amp;gt;&amp;gt;'&lt;/span&gt;       &lt;br/&gt;Pythonç¼–ç¨‹æ—¶å…‰&lt;span class=&quot;hljs-meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;for i in range(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;):     &lt;br/&gt;................    print (i)                    &lt;br/&gt;................                                 &lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;                                   &lt;br/&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;                                   &lt;br/&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å°æ˜ä¼šç»§ç»­åšæŒå†™è¿™ä¸ªç³»åˆ—ï¼Œå¦‚æœä½ è§‰å¾—å†™å¾—è¿˜å¯ä»¥çš„ï¼Œä¸é˜²å…³æ³¨ä¸€ä¸‹ï¼Œä»¥å…æ‰é˜Ÿï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œè¯·åˆ†äº«ç»™èº«è¾¹çš„å°ä¼™ä¼´ä»¬ã€‚&lt;/p&gt;
&lt;hr/&gt;&lt;img src=&quot;http://ovzwokrcz.bkt.clouddn.com/5b29283fdd19f.png&quot; alt=&quot;&quot; title=&quot;&quot;/&gt;&lt;/div&gt;
</description>
<pubDate>Mon, 30 Jul 2018 14:25:00 +0000</pubDate>
<dc:creator>ç«™åœ¨ä¸¤ä¸ªä¸–ç•Œçš„è¾¹ç¼˜</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/wongbingming/p/9393186.html</dc:identifier>
</item>
<item>
<title>å¾®ä¿¡å°ç¨‹åºå¼€å‘03-è¿™æ˜¯ä¸€ä¸ªç»„ä»¶ - å¶å°é’—</title>
<link>http://www.cnblogs.com/yexiaochai/p/9382862.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/yexiaochai/p/9382862.html</guid>
<description>&lt;h2&gt;åŸºæœ¬ç»“æ„&lt;/h2&gt;
&lt;p&gt;æ¥ä¸Šæ–‡ï¼š&lt;a href=&quot;http://www.cnblogs.com/yexiaochai/p/9374374.html&quot;&gt;å¾®ä¿¡å°ç¨‹åºå¼€å‘02-å°ç¨‹åºåŸºæœ¬ä»‹ç»&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä»Šå¤©å…ˆæ¥å®ç°è¿™ä¸ªå¼¹å‡ºå±‚ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730105755788-2057483691.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰è¿™ä¸ªç»„ä»¶æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ç»„ä»¶ï¼Œå¼¹å‡ºå±‚å¯è®¾ç½®è½½å…¥çš„htmlç»“æ„ï¼Œç„¶åå†è®¾ç½®å„ç§äº‹ä»¶å³å¯ï¼Œè¿™ç§ç»„ä»¶æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;â‘  åªæä¾›Headeréƒ¨åˆ†ä»¥åŠå®¹å™¨éƒ¨åˆ†&lt;/p&gt;
&lt;p&gt;â‘¡ å®¹å™¨éƒ¨åˆ†çš„HTMLç»“æ„ç”±ä¸šåŠ¡å±‚æä¾›&lt;/p&gt;
&lt;p&gt;â‘¢ å®¹å™¨éƒ¨åˆ†å¯¹åº”æ ·å¼ç”±ä¸šåŠ¡å±‚æä¾›&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¦‚æœè¦åœ¨å°ç¨‹åºä¸­å®ç°è¿™ç±»ç»„ä»¶ï¼Œæ„å‘³ç€æˆ‘ä»¬éœ€è¦å¾€å°ç¨‹åºä¸­åŠ¨æ€æ’å…¥WXMLç»“æ„ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆåšä¸ªdemoï¼Œè¯•è¯•å¾€åŠ¨æ€æ’å…¥WXMLæ˜¯ä¸æ˜¯å¯è¡Œ&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;.setData({'wxml'&lt;span&gt;: `
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;   &amp;lt;my-component&amp;gt;
&lt;span&gt;3&lt;/span&gt;   &amp;lt;view&amp;gt;åŠ¨æ€æ’å…¥çš„èŠ‚ç‚¹&amp;lt;/view&amp;gt; 
&lt;span&gt;4&lt;/span&gt;   &amp;lt;/my-component&amp;gt;
&lt;span&gt;5&lt;/span&gt; `});
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730112527535-973564966.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å°ç¨‹åºå¯¹åº”è®¾ç½®çš„æ•°æ®è¿›è¡Œäº†è½¬ä¹‰ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½åŠ¨æ€è§£æï¼Œå¦‚æœç«™åœ¨æ€§èƒ½è§’åº¦æ€è€ƒï¼Œä¸è¿›è¡ŒåŠ¨æ€è§£æä¹Ÿä¸æ˜¯é”™è¯¯çš„ï¼›å¦ä¸€æ–¹é¢ï¼Œä¸€æ—¦å°ç¨‹åºèƒ½åŠ¨æ€è§£æwxmlï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ¶Œå‡ºå„ç§èŠ±å¼ç”¨æ³•ï¼Œæ§åˆ¶åŠ›ä¼šå‡ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘æƒ³çš„æ˜¯ï¼Œç›´æ¥å°†ä¸šåŠ¡çº§wxmlç»“æ„æ”¾åˆ°é¡µé¢é‡Œé¢ï¼Œéšè—èµ·æ¥ï¼Œéœ€è¦ä½¿ç”¨å¼¹å‡ºå±‚çš„æ—¶å€™ï¼Œç›´æ¥å°†ä¹‹è£…è½½è¿›å»ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯å¦å¯è¡Œï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬éœ€è¦å±•ç¤ºçš„ç»“æ„æ”¾åˆ°ä¸€ä¸ªæ¨¡æ¿å½“ä¸­ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;template &lt;/span&gt;&lt;span&gt;name&lt;/span&gt;&lt;span&gt;=&quot;searchbox&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;2&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;my-component&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;3&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;åŠ¨æ€ç»„ä»¶éƒ¨åˆ†&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt; 
&lt;span&gt;4&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;my-component&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;5&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬åœ¨æˆ‘ä»¬ä¸»ç•Œé¢ä¸­è½½å…¥æ¨¡æ¿ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;import &lt;/span&gt;&lt;span&gt;src&lt;/span&gt;&lt;span&gt;=&quot;mod.searchbox.wxml&quot;&lt;/span&gt;&lt;span&gt;/&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;my-component&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;&amp;lt;!--&lt;/span&gt;&lt;span&gt; è¿™éƒ¨åˆ†å†…å®¹å°†è¢«æ”¾ç½®åœ¨ç»„ä»¶ &amp;lt;slot&amp;gt; çš„ä½ç½®ä¸Š &lt;/span&gt;&lt;span&gt;--&amp;gt;&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;      &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;è¿™é‡Œæ˜¯æ’å…¥åˆ°ç»„ä»¶slotä¸­çš„å†…å®¹&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;my-component&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;template &lt;/span&gt;&lt;span&gt;is&lt;/span&gt;&lt;span&gt;=&quot;searchbox&quot;&lt;/span&gt; &lt;span&gt;/&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730115024406-1960508341.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¸»ä½“ç»“æ„æ”¾åˆ°é¡µé¢ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥æ•°æ®æ¨¡å‹æˆ–è€…æ§åˆ¶æ˜¾ç¤ºå³å¯ï¼Œçœ‹èµ·æ¥æ˜¯å¯è¡Œçš„ï¼Œäºæ˜¯æˆ‘ä»¬å…ˆå®ç°æˆ‘ä»¬åŸºæœ¬çš„æ ·å¼ï¼Œå› ä¸ºä¸šåŠ¡æ¨¡å—çš„æ ·å­åº”è¯¥ç”±ä¸šåŠ¡æä¾›ï¼Œæ‰€ä»¥å¯¹åº”æ ·å¼å†™åˆ°index.wxssé‡Œé¢ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('6907da97-8061-4f4f-a18d-9851dc0a27d4')&quot; readability=&quot;34&quot;&gt;&lt;img id=&quot;code_img_closed_6907da97-8061-4f4f-a18d-9851dc0a27d4&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_6907da97-8061-4f4f-a18d-9851dc0a27d4&quot; class=&quot;code_img_opened&quot; onclick=&quot;cnblogs_code_hide('6907da97-8061-4f4f-a18d-9851dc0a27d4',event)&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_6907da97-8061-4f4f-a18d-9851dc0a27d4&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;63&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;.btn-primary &lt;/span&gt;{
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;    background-color&lt;/span&gt;:&lt;span&gt; #00b358&lt;/span&gt;;
&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;    color&lt;/span&gt;:&lt;span&gt; #fff&lt;/span&gt;;
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;    border&lt;/span&gt;:&lt;span&gt; 0 none&lt;/span&gt;;
&lt;span&gt; 5&lt;/span&gt; }
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;.btn, .btn-primary, .btn-secondary, .btn-sub &lt;/span&gt;{
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    line-height&lt;/span&gt;:&lt;span&gt; 88rpx&lt;/span&gt;;
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    height&lt;/span&gt;:&lt;span&gt; 88rpx&lt;/span&gt;;
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    padding&lt;/span&gt;:&lt;span&gt; 0 20rpx&lt;/span&gt;;
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;    display&lt;/span&gt;:&lt;span&gt; inline-block&lt;/span&gt;;
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    vertical-align&lt;/span&gt;:&lt;span&gt; middle&lt;/span&gt;;
&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    text-align&lt;/span&gt;:&lt;span&gt; center&lt;/span&gt;;
&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    border-radius&lt;/span&gt;:&lt;span&gt; 8rpx&lt;/span&gt;;
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;    cursor&lt;/span&gt;:&lt;span&gt; pointer&lt;/span&gt;;
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    font-size&lt;/span&gt;:&lt;span&gt; 32rpx&lt;/span&gt;;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    -webkit-box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;17&lt;/span&gt; &lt;span&gt;    box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;18&lt;/span&gt; }
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;.full-width &lt;/span&gt;{
&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    width&lt;/span&gt;:&lt;span&gt; 100%&lt;/span&gt;;
&lt;span&gt;21&lt;/span&gt; &lt;span&gt;    -webkit-box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;22&lt;/span&gt; &lt;span&gt;    box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;23&lt;/span&gt; }
&lt;span&gt;24&lt;/span&gt; 
&lt;span&gt;25&lt;/span&gt; 
&lt;span&gt;26&lt;/span&gt; &lt;span&gt;.c-row &lt;/span&gt;{
&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    width&lt;/span&gt;:&lt;span&gt; auto&lt;/span&gt;;
&lt;span&gt;28&lt;/span&gt; &lt;span&gt;    display&lt;/span&gt;:&lt;span&gt; -webkit-box&lt;/span&gt;;
&lt;span&gt;29&lt;/span&gt; &lt;span&gt;    -webkit-box-orient&lt;/span&gt;:&lt;span&gt; horizontal&lt;/span&gt;;
&lt;span&gt;30&lt;/span&gt; &lt;span&gt;    -webkit-box-direction&lt;/span&gt;:&lt;span&gt; normal&lt;/span&gt;;
&lt;span&gt;31&lt;/span&gt; &lt;span&gt;    -webkit-box-pack&lt;/span&gt;:&lt;span&gt; justify&lt;/span&gt;;
&lt;span&gt;32&lt;/span&gt; &lt;span&gt;    -webkit-box-align&lt;/span&gt;:&lt;span&gt; stretch&lt;/span&gt;;
&lt;span&gt;33&lt;/span&gt; &lt;span&gt;    -webkit-box-lines&lt;/span&gt;:&lt;span&gt; single&lt;/span&gt;;
&lt;span&gt;34&lt;/span&gt; &lt;span&gt;    display&lt;/span&gt;:&lt;span&gt; -webkit-flex&lt;/span&gt;;
&lt;span&gt;35&lt;/span&gt; &lt;span&gt;    -webkit-flex-direction&lt;/span&gt;:&lt;span&gt; row&lt;/span&gt;;
&lt;span&gt;36&lt;/span&gt; &lt;span&gt;    -webkit-justify-content&lt;/span&gt;:&lt;span&gt; space-between&lt;/span&gt;;
&lt;span&gt;37&lt;/span&gt; &lt;span&gt;    -webkit-align-items&lt;/span&gt;:&lt;span&gt; strecth&lt;/span&gt;;
&lt;span&gt;38&lt;/span&gt; &lt;span&gt;    -webkit-align-content&lt;/span&gt;:&lt;span&gt; flex-start&lt;/span&gt;;
&lt;span&gt;39&lt;/span&gt; &lt;span&gt;    -webkit-flex-wrap&lt;/span&gt;:&lt;span&gt; nowrap&lt;/span&gt;;
&lt;span&gt;40&lt;/span&gt; &lt;span&gt;    padding&lt;/span&gt;:&lt;span&gt; 20rpx 40rpx&lt;/span&gt;;
&lt;span&gt;41&lt;/span&gt; }
&lt;span&gt;42&lt;/span&gt; 
&lt;span&gt;43&lt;/span&gt; &lt;span&gt;.c-span3 &lt;/span&gt;{
&lt;span&gt;44&lt;/span&gt; &lt;span&gt;    width&lt;/span&gt;:&lt;span&gt; 25%&lt;/span&gt;;
&lt;span&gt;45&lt;/span&gt; &lt;span&gt;    -webkit-box-flex&lt;/span&gt;:&lt;span&gt; 3&lt;/span&gt;;
&lt;span&gt;46&lt;/span&gt; &lt;span&gt;    -webkit-flex&lt;/span&gt;:&lt;span&gt; 3 3 auto&lt;/span&gt;;
&lt;span&gt;47&lt;/span&gt; }
&lt;span&gt;48&lt;/span&gt; 
&lt;span&gt;49&lt;/span&gt; &lt;span&gt;.c-span9 &lt;/span&gt;{
&lt;span&gt;50&lt;/span&gt; &lt;span&gt;    width&lt;/span&gt;:&lt;span&gt; 75%&lt;/span&gt;;
&lt;span&gt;51&lt;/span&gt; &lt;span&gt;    -webkit-box-flex&lt;/span&gt;:&lt;span&gt; 9&lt;/span&gt;;
&lt;span&gt;52&lt;/span&gt; &lt;span&gt;    -webkit-flex&lt;/span&gt;:&lt;span&gt; 9 9 auto&lt;/span&gt;;
&lt;span&gt;53&lt;/span&gt; }
&lt;span&gt;54&lt;/span&gt; 
&lt;span&gt;55&lt;/span&gt; &lt;span&gt;.search-line &lt;/span&gt;{
&lt;span&gt;56&lt;/span&gt; &lt;span&gt;    position&lt;/span&gt;:&lt;span&gt; relative&lt;/span&gt;;
&lt;span&gt;57&lt;/span&gt; &lt;span&gt;    height&lt;/span&gt;:&lt;span&gt; 96rpx&lt;/span&gt;;
&lt;span&gt;58&lt;/span&gt; &lt;span&gt;    line-height&lt;/span&gt;:&lt;span&gt; 96rpx&lt;/span&gt;;
&lt;span&gt;59&lt;/span&gt; &lt;span&gt;    font-size&lt;/span&gt;:&lt;span&gt; 30rpx&lt;/span&gt;;
&lt;span&gt;60&lt;/span&gt; &lt;span&gt;    font-weight&lt;/span&gt;:&lt;span&gt; 600&lt;/span&gt;;
&lt;span&gt;61&lt;/span&gt; &lt;span&gt;    border-bottom&lt;/span&gt;:&lt;span&gt; 1rpx solid #e6e6e6&lt;/span&gt;;
&lt;span&gt;62&lt;/span&gt; }
&lt;span&gt;63&lt;/span&gt; 
&lt;span&gt;64&lt;/span&gt; &lt;span&gt;.search-line::after &lt;/span&gt;{
&lt;span&gt;65&lt;/span&gt; &lt;span&gt;    content&lt;/span&gt;:&lt;span&gt; &quot;&quot;&lt;/span&gt;;
&lt;span&gt;66&lt;/span&gt; &lt;span&gt;    display&lt;/span&gt;:&lt;span&gt; inline-block&lt;/span&gt;;
&lt;span&gt;67&lt;/span&gt; &lt;span&gt;    vertical-align&lt;/span&gt;:&lt;span&gt; middle&lt;/span&gt;;
&lt;span&gt;68&lt;/span&gt; &lt;span&gt;    width&lt;/span&gt;:&lt;span&gt; 20rpx&lt;/span&gt;;
&lt;span&gt;69&lt;/span&gt; &lt;span&gt;    height&lt;/span&gt;:&lt;span&gt; 20rpx&lt;/span&gt;;
&lt;span&gt;70&lt;/span&gt; &lt;span&gt;    border-top&lt;/span&gt;:&lt;span&gt; 4rpx solid #00b358&lt;/span&gt;;
&lt;span&gt;71&lt;/span&gt; &lt;span&gt;    border-right&lt;/span&gt;:&lt;span&gt; 4rpx solid #00b358&lt;/span&gt;;
&lt;span&gt;72&lt;/span&gt; &lt;span&gt;    position&lt;/span&gt;:&lt;span&gt; absolute&lt;/span&gt;;
&lt;span&gt;73&lt;/span&gt; &lt;span&gt;    right&lt;/span&gt;:&lt;span&gt; 60rpx&lt;/span&gt;;
&lt;span&gt;74&lt;/span&gt; &lt;span&gt;    top&lt;/span&gt;:&lt;span&gt; 50%&lt;/span&gt;;
&lt;span&gt;75&lt;/span&gt; &lt;span&gt;    margin-top&lt;/span&gt;:&lt;span&gt; -4rpx&lt;/span&gt;;
&lt;span&gt;76&lt;/span&gt; &lt;span&gt;    -webkit-transform&lt;/span&gt;:&lt;span&gt; rotate(45deg) translateY(-50%)&lt;/span&gt;;
&lt;span&gt;77&lt;/span&gt; &lt;span&gt;    transform&lt;/span&gt;:&lt;span&gt; rotate(45deg) translateY(-50%)&lt;/span&gt;;
&lt;span&gt;78&lt;/span&gt; &lt;span&gt;    -webkit-box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;79&lt;/span&gt; &lt;span&gt;    box-sizing&lt;/span&gt;:&lt;span&gt; border-box&lt;/span&gt;;
&lt;span&gt;80&lt;/span&gt; }
&lt;span&gt;81&lt;/span&gt; 
&lt;span&gt;82&lt;/span&gt; &lt;span&gt;.search-line-txt &lt;/span&gt;{
&lt;span&gt;83&lt;/span&gt; &lt;span&gt;    text-align&lt;/span&gt;:&lt;span&gt; right&lt;/span&gt;;
&lt;span&gt;84&lt;/span&gt; &lt;span&gt;    padding-right&lt;/span&gt;:&lt;span&gt; 60rpx&lt;/span&gt;;
&lt;span&gt;85&lt;/span&gt; &lt;span&gt;    overflow&lt;/span&gt;:&lt;span&gt; hidden&lt;/span&gt;;
&lt;span&gt;86&lt;/span&gt; &lt;span&gt;    text-overflow&lt;/span&gt;:&lt;span&gt; ellipsis&lt;/span&gt;;
&lt;span&gt;87&lt;/span&gt; &lt;span&gt;    white-space&lt;/span&gt;:&lt;span&gt; nowrap&lt;/span&gt;;
&lt;span&gt;88&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;template &lt;/span&gt;&lt;span&gt;name&lt;/span&gt;&lt;span&gt;=&quot;searchbox&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-row search-line&quot;&lt;/span&gt;&lt;span&gt; data-flag&lt;/span&gt;&lt;span&gt;=&quot;start&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-span3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;           å‡ºå‘&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-span9 js-start search-line-txt&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;           è¯·é€‰æ‹©å‡ºå‘åœ°&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-row search-line&quot;&lt;/span&gt;&lt;span&gt; data-flag&lt;/span&gt;&lt;span&gt;=&quot;arrive&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-span3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;           åˆ°è¾¾&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-span9 js-arrive search-line-txt&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;           è¯·é€‰æ‹©åˆ°è¾¾åœ°&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;c-row &quot;&lt;/span&gt;&lt;span&gt; data-flag&lt;/span&gt;&lt;span&gt;=&quot;arrive&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt;       &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;span &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;btn-primary full-width js_search_list&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;æŸ¥è¯¢&lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;span&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730143834259-444680510.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬åŸºæœ¬çš„å¼¹å‡ºå±‚æ ·å¼å°±ä¸ƒä¸ƒå…«å…«äº†ï¼Œè¿™é‡Œå¯ä»¥çœ‹å‡ºä¸€äº›ç‰¹ç‚¹ï¼šå°ç¨‹åºä¸å¹³æ—¶æˆ‘ä»¬çš„æ ·å¼å·®è·ä¸å¤§ï¼Œç¨å¾®æ”¹ç‚¹å°±èƒ½ç”¨ï¼Œç”šè‡³èƒ½ç›´æ¥é€šç”¨ï¼›å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå…¬å…±éƒ¨åˆ†çš„CSSè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿå…¶å®æˆ‘è¿™é‡Œéœ€è¦è§£å†³çš„ä¸åªæ˜¯å…¬å…±çš„æ ·å¼éƒ¨åˆ†ï¼Œè¿˜éœ€è¦è§£å†³å…¬å…±çš„ç»„ä»¶éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¿™é‡Œæƒ³çš„æ˜¯å°†æ‰€æœ‰å…¬å…±éƒ¨åˆ†çš„CSSæ”¾åˆ°ä¸€ä¸ªå…¨å±€çš„æ–‡ä»¶global.wxssä¸­ï¼Œç„¶ååœ¨æ¯ä¸ªä¸šåŠ¡çº§é¡µé¢importå³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œéœ€è¦å½¢æˆä¸€ä¸ªå…¬å…±çš„WXSSåº“ï¼Œè¿™ä¸ªä¸çº¯webæ˜ å°„èµ·æ¥å³å¯ï¼Œæˆ‘ä»¬è¿™é‡Œä¾¿ä¸æ·±å…¥ã€‚&lt;/p&gt;
&lt;h2&gt;å…¬å…±ç»„ä»¶åº“&lt;/h2&gt;
&lt;p&gt;è¦æé«˜å¼€å‘æ•ˆç‡çš„ç¬¬ä¸€ä¸ªå‰æå°±æ˜¯è¦æœ‰è¶³å¤Ÿå¤šçš„UIç»„ä»¶ï¼Œå°ç¨‹åºæœ¬èº«æä¾›äº†ä¸€äº›å®šåˆ¶åŒ–çš„ç»„ä»¶ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šç”¨åˆ°çš„ç»„ä»¶æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;â‘  alertç±»å¼¹å‡ºå±‚&lt;/p&gt;
&lt;p&gt;â‘¡ loadingç±»å¼¹å‡ºå±‚&lt;/p&gt;
&lt;p&gt;â‘¢ æ—¥å†ç»„ä»¶&lt;/p&gt;
&lt;p&gt;â‘£ toast&amp;amp;messageç±»æç¤ºå¼¹å‡ºç»„ä»¶&lt;/p&gt;
&lt;p&gt;â‘¤ å®¹å™¨ç±»ç»„ä»¶&lt;/p&gt;
&lt;p&gt;â‘¥ ......&lt;/p&gt;
&lt;p&gt;ä¹‹å‰çš„åšæ³•ï¼Œæ˜¯æˆ‘ä»¬å°†htmlå®ä½“å’Œç»„ä»¶å®ç°ç›´æ¥æ”¾åˆ°ä¸€èµ·ï¼Œcssæ”¾åˆ°å…¨å±€globalé‡Œé¢å»ï¼Œç°åœ¨å°ç¨‹åºå¹¶ä¸æ”¯æŒåŠ¨æ€å±•ç¤ºwxmlï¼Œæ‰€ä»¥åŠ¨æ€æ’å…¥çš„æ–¹å¼è¡Œä¸é€šäº†ï¼Œæˆ‘ä»¬éœ€è¦å°†ç»„ä»¶çš„wxmlæ”¾åˆ°é¡µé¢é‡Œé¢åšé¢„åŠ è½½ï¼Œè¿™é‡Œæˆ‘æƒ³çš„æ˜¯æä¾›ä¸€ä¸ªé€šç”¨global.ui.wxmlæ–‡ä»¶ç”¨ä»¥è£…è½½æ‰€æœ‰çš„wxmlå®ä½“ï¼Œå¸¸ç”¨çš„ç»„ä»¶æˆ‘ä»¬é»˜è®¤å…¨å±€å¼•å…¥ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆæŒ‘ç‚¹è½¯æŸ¿å­æ¥æï¼Œæˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªalertç±»å¼¹å‡ºå±‚ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†åŸæ¥å¼¹å‡ºå±‚ç±»ä¼šç”¨åˆ°çš„CSSå…¨éƒ¨ç¿»è¯‘ä¸ºWXSSï¼Œæ”¾å…¥global.wxssä¸­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730153231580-1762280558.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æ¯ä¸ªç»„ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªå›ºå®šçš„ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»º-&amp;gt;æ˜¾ç¤º-&amp;gt;éšè—ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ˜¯æ¯ä¸ªç»„ä»¶éƒ½å…·æœ‰çš„ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåº”è¯¥å¼•å…¥ç»§æ‰¿æ¦‚å¿µå®ç°ç»„ä»¶ï¼Œä½†æ˜¯å°ç¨‹åºå®˜æ–¹æä¾›çš„Componentså¹¶æ²¡æœ‰æä¾›ç»§æ‰¿æ¦‚å¿µï¼Œè€Œæ˜¯æä¾›äº†behaviorsæ¦‚å¿µï¼Œç”¨ä»¥å°†ç»„ä»¶é—´çš„å…¬å…±éƒ¨åˆ†å¤„ç†æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¹Ÿä½¿ç”¨behaviorsï¼Œå› ä¸ºä¸èƒ½æ“ä½œdomï¼Œæˆ‘ä»¬çš„ç»„ä»¶æŠ½è±¡ä¼šå˜å¾—ç›¸å¯¹ç®€å•ï¼Œä¸ç”¨è®°å½•å¤ªå¤šdomèŠ‚ç‚¹äº†ï¼Œå¦å¤–å°ç¨‹åºçš„ç»„ä»¶ä¸æˆ‘ä»¬ä¹‹å‰çš„â€œç»„ä»¶â€ä»å®šä¹‰åˆ°ä½¿ç”¨ä¸Šæœ‰å¾ˆå¤§çš„ä¸åŒï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯ä»¥jsä½œä¸ºæ§åˆ¶å™¨ï¼Œç°åœ¨æ˜¯ä»¥æ ‡ç­¾wxmlä½œä¸ºæ§åˆ¶å™¨ï¼Œæ ¹æœ¬æ²¡æœ‰åŠæ³•åœ¨jsä¸­è·å–å®ä¾‹ï¼Œè€Œå°ç¨‹åºç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸åŒ…å«æ˜¾ç¤ºéšè—ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥ä»–çš„ç»„ä»¶å’Œæˆ‘ä»¬ä»¥ä¸ºçš„ç»„ä»¶æœ‰å¾ˆå¤§çš„ä¸åŒ&lt;/p&gt;
&lt;p&gt;æˆ‘æ€è€ƒäº†ä¸‹ä¸ºä»€ä¹ˆå°ç¨‹åºä¸­ï¼Œjsä¸èƒ½è·å–ç»„ä»¶çš„å®ä¾‹ï¼Œè¿™é‡Œå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;å°ç¨‹åºä¸­æ‰€æœ‰çš„WXMLå¿…é¡»åœ¨é¡µé¢ä¸­è¿›è¡Œé¢„åŠ è½½é€»è¾‘ï¼Œä¸èƒ½åŠ¨æ€æ’å…¥DOMçš„æ–¹å¼æ’å…¥WXMLï¼Œæ‰€ä»¥å°ç¨‹åºæ²¡æœ‰æä¾›ç»„ä»¶å®ä¾‹ç»™æˆ‘ä»¬æ§åˆ¶&lt;br/&gt;æ‰€ä»¥åœ¨å°ç¨‹åºä¸­æƒ³å®Œæˆç»„ä»¶åº“ï¼Œé‚£ä¹ˆä¾¿åªèƒ½æŠŠç»„ä»¶åšæ ‡ç­¾ä½¿ç”¨ï¼ˆè€Œä¸”æ˜¯jsä¸èƒ½è·å–çš„æ ‡ç­¾ï¼‰ï¼Œè€Œä¸æ˜¯jsç»„ä»¶ï¼Œè¿™æ ·ä¼šæœ‰æ•ˆå¸®åŠ©æˆ‘ä»¬ç†è§£&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬è¿™é‡Œå°è¯•å®ç°ä¸€ä¸ªé®ç›–å±‚çš„æ ‡ç­¾ï¼ˆè¿™é‡Œå¼€å§‹ä¸ç”¨ç»„ä»¶è¿™ä¸ªè¯ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ­§ä¹‰ï¼‰:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730175337355-1540724229.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä»£ç éå¸¸ç®€å•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;cm-overlay&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;.cm-overlay &lt;/span&gt;{&lt;span&gt;
    background&lt;/span&gt;:&lt;span&gt; rgba(0, 0, 0, 0.5)&lt;/span&gt;;&lt;span&gt;
    position&lt;/span&gt;:&lt;span&gt; fixed&lt;/span&gt;;&lt;span&gt;
    top&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt;
    right&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt;
    bottom&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt;
    left&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;
}
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; let LayerView = require('behavior-layer-view'&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;Component({
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;  behaviors: [LayerView],
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;  data: {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    myData: {}
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;   attached: &lt;span&gt;function&lt;/span&gt;&lt;span&gt; () { },
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;  methods: {
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; })
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªé®ç›–å±‚maskæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œè€Œä¸”ä¸€èˆ¬æ¥è¯´maskä¹Ÿä¸ä¼šå•ç‹¬å­˜åœ¨ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªç»„ä»¶ï¼ˆæ¯”å¦‚å¼¹å‡ºå±‚çš„loadingï¼‰ä¼šåŒ…å«ä¸€ä¸ªé®ç›–å±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¦æ”¹é€ ä¸‹Maskçš„ç»“æ„ï¼Œè®©ä»–å¯ä»¥è£…è½½ç»„ä»¶ï¼Œæˆ‘ä»¬ä»jsç»„ä»¶é€»è¾‘æ¥è¯´æ˜¯maskåº”è¯¥æ˜¯loadingçš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æ˜¯æˆ‘ä»¬ç«™åœ¨æ ‡ç­¾è§’åº¦æ¥è¯´ï¼Œä»–ä»¬ä¸¤ä¸ªåº”è¯¥æ˜¯ç‹¬ç«‹çš„ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;cm-overlay&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;2&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;slot&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;slot&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;3&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬è¿™é‡Œå®ç°ä¸€ä¸ªloadingçš„ç»„ä»¶ï¼ˆPSï¼šCSS3åŠ¨ç”»ç¨å¾®è¦åšç‚¹å…¼å®¹è°ƒè¯•ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730205513326-945900149.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('c308b17e-5b47-4949-9399-a68d757e73a1')&quot; readability=&quot;35.5&quot;&gt;&lt;img id=&quot;code_img_closed_c308b17e-5b47-4949-9399-a68d757e73a1&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_c308b17e-5b47-4949-9399-a68d757e73a1&quot; class=&quot;code_img_opened&quot; onclick=&quot;cnblogs_code_hide('c308b17e-5b47-4949-9399-a68d757e73a1',event)&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_c308b17e-5b47-4949-9399-a68d757e73a1&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;66&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;.spinner &lt;/span&gt;{
&lt;span&gt;  2&lt;/span&gt; &lt;span&gt;  width&lt;/span&gt;:&lt;span&gt; 140rpx&lt;/span&gt;;
&lt;span&gt;  3&lt;/span&gt; &lt;span&gt;  height&lt;/span&gt;:&lt;span&gt; 140rpx&lt;/span&gt;;
&lt;span&gt;  4&lt;/span&gt; &lt;span&gt;  position&lt;/span&gt;:&lt;span&gt; fixed&lt;/span&gt;;
&lt;span&gt;  5&lt;/span&gt; &lt;span&gt;  align-items&lt;/span&gt;:&lt;span&gt; center&lt;/span&gt;;
&lt;span&gt;  6&lt;/span&gt; &lt;span&gt;  display&lt;/span&gt;:&lt;span&gt; flex&lt;/span&gt;;
&lt;span&gt;  7&lt;/span&gt; &lt;span&gt;  top&lt;/span&gt;:&lt;span&gt; 50%&lt;/span&gt;;
&lt;span&gt;  8&lt;/span&gt; &lt;span&gt;  left&lt;/span&gt;:&lt;span&gt; 50%&lt;/span&gt;;
&lt;span&gt;  9&lt;/span&gt; &lt;span&gt;  margin-left&lt;/span&gt;:&lt;span&gt; -70rpx&lt;/span&gt;;
&lt;span&gt; 10&lt;/span&gt; &lt;span&gt;  margin-top&lt;/span&gt;:&lt;span&gt; -70rpx&lt;/span&gt;;
&lt;span&gt; 11&lt;/span&gt; }
&lt;span&gt; 12&lt;/span&gt;  
&lt;span&gt; 13&lt;/span&gt; &lt;span&gt;.container1 &amp;gt; view, .container2 &amp;gt; view, .container3 &amp;gt; view &lt;/span&gt;{
&lt;span&gt; 14&lt;/span&gt; &lt;span&gt;  width&lt;/span&gt;:&lt;span&gt; 24rpx&lt;/span&gt;;
&lt;span&gt; 15&lt;/span&gt; &lt;span&gt;  height&lt;/span&gt;:&lt;span&gt; 24rpx&lt;/span&gt;;
&lt;span&gt; 16&lt;/span&gt; &lt;span&gt;  background-color&lt;/span&gt;:&lt;span&gt; #00b358&lt;/span&gt;;
&lt;span&gt; 17&lt;/span&gt; &lt;span&gt;  border-radius&lt;/span&gt;:&lt;span&gt; 100%&lt;/span&gt;;
&lt;span&gt; 18&lt;/span&gt; &lt;span&gt;  position&lt;/span&gt;:&lt;span&gt; absolute&lt;/span&gt;;
&lt;span&gt; 19&lt;/span&gt; &lt;span&gt;  -webkit-animation&lt;/span&gt;:&lt;span&gt; bouncedelay 1.2s infinite ease-in-out&lt;/span&gt;;
&lt;span&gt; 20&lt;/span&gt; &lt;span&gt;  animation&lt;/span&gt;:&lt;span&gt; bouncedelay 1.2s infinite ease-in-out&lt;/span&gt;;
&lt;span&gt; 21&lt;/span&gt; &lt;span&gt;  -webkit-animation-fill-mode&lt;/span&gt;:&lt;span&gt; both&lt;/span&gt;;
&lt;span&gt; 22&lt;/span&gt; &lt;span&gt;  animation-fill-mode&lt;/span&gt;:&lt;span&gt; both&lt;/span&gt;;
&lt;span&gt; 23&lt;/span&gt; }
&lt;span&gt; 24&lt;/span&gt;  
&lt;span&gt; 25&lt;/span&gt; &lt;span&gt;.spinner .spinner-container &lt;/span&gt;{
&lt;span&gt; 26&lt;/span&gt; &lt;span&gt;  position&lt;/span&gt;:&lt;span&gt; absolute&lt;/span&gt;;
&lt;span&gt; 27&lt;/span&gt; &lt;span&gt;  width&lt;/span&gt;:&lt;span&gt; 66%&lt;/span&gt;;
&lt;span&gt; 28&lt;/span&gt; &lt;span&gt;  height&lt;/span&gt;:&lt;span&gt; 66%&lt;/span&gt;;
&lt;span&gt; 29&lt;/span&gt; &lt;span&gt;  top&lt;/span&gt;:&lt;span&gt; 10%&lt;/span&gt;;
&lt;span&gt; 30&lt;/span&gt; &lt;span&gt;  left&lt;/span&gt;:&lt;span&gt; 10%&lt;/span&gt;;
&lt;span&gt; 31&lt;/span&gt; }
&lt;span&gt; 32&lt;/span&gt;  
&lt;span&gt; 33&lt;/span&gt; &lt;span&gt;.container2 &lt;/span&gt;{
&lt;span&gt; 34&lt;/span&gt; &lt;span&gt;  -webkit-transform&lt;/span&gt;:&lt;span&gt; rotateZ(45deg)&lt;/span&gt;;
&lt;span&gt; 35&lt;/span&gt; &lt;span&gt;  transform&lt;/span&gt;:&lt;span&gt; rotateZ(45deg)&lt;/span&gt;;
&lt;span&gt; 36&lt;/span&gt; }
&lt;span&gt; 37&lt;/span&gt;  
&lt;span&gt; 38&lt;/span&gt; &lt;span&gt;.container3 &lt;/span&gt;{
&lt;span&gt; 39&lt;/span&gt; &lt;span&gt;  -webkit-transform&lt;/span&gt;:&lt;span&gt; rotateZ(90deg)&lt;/span&gt;;
&lt;span&gt; 40&lt;/span&gt; &lt;span&gt;  transform&lt;/span&gt;:&lt;span&gt; rotateZ(90deg)&lt;/span&gt;;
&lt;span&gt; 41&lt;/span&gt; }
&lt;span&gt; 42&lt;/span&gt;  
&lt;span&gt; 43&lt;/span&gt; &lt;span&gt;.circle1 &lt;/span&gt;{&lt;span&gt; top&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt; left&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;; }
&lt;span&gt; 44&lt;/span&gt; &lt;span&gt;.circle2 &lt;/span&gt;{&lt;span&gt; top&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt; right&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;; }
&lt;span&gt; 45&lt;/span&gt; &lt;span&gt;.circle3 &lt;/span&gt;{&lt;span&gt; right&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt; bottom&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;; }
&lt;span&gt; 46&lt;/span&gt; &lt;span&gt;.circle4 &lt;/span&gt;{&lt;span&gt; left&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;;&lt;span&gt; bottom&lt;/span&gt;:&lt;span&gt; 0&lt;/span&gt;; }
&lt;span&gt; 47&lt;/span&gt;  
&lt;span&gt; 48&lt;/span&gt; &lt;span&gt;.container2 .circle1 &lt;/span&gt;{
&lt;span&gt; 49&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -1.1s&lt;/span&gt;;
&lt;span&gt; 50&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -1.1s&lt;/span&gt;;
&lt;span&gt; 51&lt;/span&gt; }
&lt;span&gt; 52&lt;/span&gt;  
&lt;span&gt; 53&lt;/span&gt; &lt;span&gt;.container3 .circle1 &lt;/span&gt;{
&lt;span&gt; 54&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -1.0s&lt;/span&gt;;
&lt;span&gt; 55&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -1.0s&lt;/span&gt;;
&lt;span&gt; 56&lt;/span&gt; }
&lt;span&gt; 57&lt;/span&gt;  
&lt;span&gt; 58&lt;/span&gt; &lt;span&gt;.container1 .circle2 &lt;/span&gt;{
&lt;span&gt; 59&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.9s&lt;/span&gt;;
&lt;span&gt; 60&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.9s&lt;/span&gt;;
&lt;span&gt; 61&lt;/span&gt; }
&lt;span&gt; 62&lt;/span&gt;  
&lt;span&gt; 63&lt;/span&gt; &lt;span&gt;.container2 .circle2 &lt;/span&gt;{
&lt;span&gt; 64&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.8s&lt;/span&gt;;
&lt;span&gt; 65&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.8s&lt;/span&gt;;
&lt;span&gt; 66&lt;/span&gt; }
&lt;span&gt; 67&lt;/span&gt;  
&lt;span&gt; 68&lt;/span&gt; &lt;span&gt;.container3 .circle2 &lt;/span&gt;{
&lt;span&gt; 69&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.7s&lt;/span&gt;;
&lt;span&gt; 70&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.7s&lt;/span&gt;;
&lt;span&gt; 71&lt;/span&gt; }
&lt;span&gt; 72&lt;/span&gt;  
&lt;span&gt; 73&lt;/span&gt; &lt;span&gt;.container1 .circle3 &lt;/span&gt;{
&lt;span&gt; 74&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.6s&lt;/span&gt;;
&lt;span&gt; 75&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.6s&lt;/span&gt;;
&lt;span&gt; 76&lt;/span&gt; }
&lt;span&gt; 77&lt;/span&gt;  
&lt;span&gt; 78&lt;/span&gt; &lt;span&gt;.container2 .circle3 &lt;/span&gt;{
&lt;span&gt; 79&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.5s&lt;/span&gt;;
&lt;span&gt; 80&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.5s&lt;/span&gt;;
&lt;span&gt; 81&lt;/span&gt; }
&lt;span&gt; 82&lt;/span&gt;  
&lt;span&gt; 83&lt;/span&gt; &lt;span&gt;.container3 .circle3 &lt;/span&gt;{
&lt;span&gt; 84&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.4s&lt;/span&gt;;
&lt;span&gt; 85&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.4s&lt;/span&gt;;
&lt;span&gt; 86&lt;/span&gt; }
&lt;span&gt; 87&lt;/span&gt;  
&lt;span&gt; 88&lt;/span&gt; &lt;span&gt;.container1 .circle4 &lt;/span&gt;{
&lt;span&gt; 89&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.3s&lt;/span&gt;;
&lt;span&gt; 90&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.3s&lt;/span&gt;;
&lt;span&gt; 91&lt;/span&gt; }
&lt;span&gt; 92&lt;/span&gt;  
&lt;span&gt; 93&lt;/span&gt; &lt;span&gt;.container2 .circle4 &lt;/span&gt;{
&lt;span&gt; 94&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.2s&lt;/span&gt;;
&lt;span&gt; 95&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.2s&lt;/span&gt;;
&lt;span&gt; 96&lt;/span&gt; }
&lt;span&gt; 97&lt;/span&gt;  
&lt;span&gt; 98&lt;/span&gt; &lt;span&gt;.container3 .circle4 &lt;/span&gt;{
&lt;span&gt; 99&lt;/span&gt; &lt;span&gt;  -webkit-animation-delay&lt;/span&gt;:&lt;span&gt; -0.1s&lt;/span&gt;;
&lt;span&gt;100&lt;/span&gt; &lt;span&gt;  animation-delay&lt;/span&gt;:&lt;span&gt; -0.1s&lt;/span&gt;;
&lt;span&gt;101&lt;/span&gt; }
&lt;span&gt;102&lt;/span&gt; 
&lt;span&gt;103&lt;/span&gt; &lt;span&gt;@-webkit-keyframes bouncedelay &lt;/span&gt;{
&lt;span&gt;104&lt;/span&gt; &lt;span&gt;  0%, 80%, 100% { -webkit-transform&lt;/span&gt;:&lt;span&gt; scale(0.0) &lt;/span&gt;}
&lt;span&gt;105&lt;/span&gt; &lt;span&gt;  40% &lt;/span&gt;{&lt;span&gt; -webkit-transform&lt;/span&gt;:&lt;span&gt; scale(1.0) &lt;/span&gt;}
&lt;span&gt;106&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;107&lt;/span&gt;  
&lt;span&gt;108&lt;/span&gt; &lt;span&gt;@keyframes bouncedelay &lt;/span&gt;{
&lt;span&gt;109&lt;/span&gt; &lt;span&gt;  0%, 80%, 100% {
&lt;/span&gt;&lt;span&gt;110&lt;/span&gt; &lt;span&gt;    transform&lt;/span&gt;:&lt;span&gt; scale(0.0)&lt;/span&gt;;
&lt;span&gt;111&lt;/span&gt; &lt;span&gt;    -webkit-transform&lt;/span&gt;:&lt;span&gt; scale(0.0)&lt;/span&gt;;
&lt;span&gt;112&lt;/span&gt;   }&lt;span&gt; 40% &lt;/span&gt;{
&lt;span&gt;113&lt;/span&gt; &lt;span&gt;    transform&lt;/span&gt;:&lt;span&gt; scale(1.0)&lt;/span&gt;;
&lt;span&gt;114&lt;/span&gt; &lt;span&gt;    -webkit-transform&lt;/span&gt;:&lt;span&gt; scale(1.0)&lt;/span&gt;;
&lt;span&gt;115&lt;/span&gt;   }
&lt;span&gt;116&lt;/span&gt; &lt;span&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;loadingæ ·å¼&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;ui-mask &lt;/span&gt;&lt;span&gt;z-index&lt;/span&gt;&lt;span&gt;=&quot;{{maskzIndex}}&quot;&lt;/span&gt; &lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;ui-mask&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner&quot;&lt;/span&gt;&lt;span&gt; style&lt;/span&gt;&lt;span&gt;=&quot;z-index: {{meIndex}}&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; const util = require('../utils/util.js'&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; let LayerView = require('behavior-layer-view'&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;Component({
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;  behaviors: [LayerView],
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;  data: {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    maskzIndex: util.getBiggerzIndex(),
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    meIndex: util.getBiggerzIndex()
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;   attached: &lt;span&gt;function&lt;/span&gt;&lt;span&gt; () { 
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     console.log('loading'&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;  methods: {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; })
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;indexè°ƒç”¨æƒ…å†µï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;import &lt;/span&gt;&lt;span&gt;src&lt;/span&gt;&lt;span&gt;=&quot;./mod.searchbox.wxml&quot;&lt;/span&gt; &lt;span&gt;/&amp;gt;&lt;/span&gt;
&lt;span&gt;2&lt;/span&gt; 
&lt;span&gt;3&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;4&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;template &lt;/span&gt;&lt;span&gt;is&lt;/span&gt;&lt;span&gt;=&quot;searchbox&quot;&lt;/span&gt; &lt;span&gt;/&amp;gt;&lt;/span&gt;
&lt;span&gt;5&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;ui-loading&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;ui-loading&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;6&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://images2018.cnblogs.com/blog/294743/201807/294743-20180730205742364-1104989176.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åç»­å°†å®Œæ•´çš„é¡¹ç›®ä»£ç æ”¾åˆ°githubä¸Šå»ï¼Œè¿™é‡Œä¾¿ç»§ç»­ä»£ç äº†&lt;/p&gt;
&lt;h2&gt;æ·»åŠ äº‹ä»¶&lt;/h2&gt;
&lt;p&gt;äºæ˜¯ï¼Œæˆ‘ä»¬å¼€å§‹æ·»åŠ äº‹ä»¶äº†ï¼Œè¿™é‡Œæ·»åŠ ä¸€ä¸ªç‚¹å‡»é®ç›–å±‚å…³é—­æ•´ä¸ªç»„ä»¶çš„åŠŸèƒ½ï¼Œè¿™é‡Œæœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬ç‚¹å‡»é®ç›–å±‚äº‹å®ä¸Šå…³é—­çš„æ˜¯é®ç›–ä»¥åŠloadingä¸¤ä¸ªæ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œçš„isShowå±æ€§ä¾¿æ´¾ä¸Šäº†ç”¨å¤„ï¼Œæˆ‘ä»¬ç°åœ¨pageä¸­è®¾ç½®ä¸‹å±æ€§ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;ui-loading &lt;/span&gt;&lt;span&gt;is-show&lt;/span&gt;&lt;span&gt;=&quot;{{isLoadingShow}}&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;ui-loading&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; onShow: &lt;span&gt;function&lt;/span&gt;&lt;span&gt;() {
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;   &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.setData({
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;     isLoadingShow: ''
&lt;span&gt;4&lt;/span&gt; &lt;span&gt;  });
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; },
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æ”¹é€ maskä»¥åŠloadingæ·»åŠ äº‹ä»¶ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;cm-overlay&quot;&lt;/span&gt;&lt;span&gt; style&lt;/span&gt;&lt;span&gt;=&quot;z-index: {{zIndex}}; display: {{isShow}}&quot;&lt;/span&gt;&lt;span&gt; bindtap&lt;/span&gt;&lt;span&gt;=&quot;onTap&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;2&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; let LayerView = require('behavior-layer-view'&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; 
&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;Component({
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;  behaviors: [LayerView],
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; 
&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;  data: {
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;    myData: {}
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;   attached: &lt;span&gt;function&lt;/span&gt;&lt;span&gt; () { 
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     console.log('mask'&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;  methods: {
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     onTap: &lt;span&gt;function&lt;/span&gt;&lt;span&gt;() {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;       &lt;span&gt;this&lt;/span&gt;.triggerEvent('customevent'&lt;span&gt;, {}, {})
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; })
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;ui-mask &lt;/span&gt;&lt;span&gt;z-index&lt;/span&gt;&lt;span&gt;=&quot;{{maskzIndex}}&quot;&lt;/span&gt;&lt;span&gt; is-show&lt;/span&gt;&lt;span&gt;=&quot;{{isShow}}&quot;&lt;/span&gt;&lt;span&gt; bindcustomevent&lt;/span&gt;&lt;span&gt;=&quot;onMaskEvent&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;ui-mask&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner&quot;&lt;/span&gt;&lt;span&gt; style&lt;/span&gt;&lt;span&gt;=&quot;z-index: {{meIndex}}; display: {{isShow}}; &quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt;   &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;spinner-container container3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle1&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle2&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle3&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;view &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;=&quot;circle4&quot;&lt;/span&gt;&lt;span&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt;   &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt; &lt;span&gt;&amp;lt;/&lt;/span&gt;&lt;span&gt;view&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; const util = require('../utils/util.js'&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; let LayerView = require('behavior-layer-view'&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;Component({
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;  behaviors: [LayerView],
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;  data: {
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;    maskzIndex: util.getBiggerzIndex(),
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    meIndex: util.getBiggerzIndex()
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;   attached: &lt;span&gt;function&lt;/span&gt;&lt;span&gt; () { 
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     console.log('loading'&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;  methods: {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;     onMaskEvent: &lt;span&gt;function&lt;/span&gt;&lt;span&gt; (e) {
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;      console.log(e);
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;       &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.setData({
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         isShow: 'none'
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;      });
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; })
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»é®ç›–å±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ•´ä¸ªç»„ä»¶ä¾¿å…³é—­äº†ã€‚&lt;/p&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»Šå¤©èŠ±äº†å¾ˆå¤šåŠŸå¤«å†™ä¸€ä¸ªloadingï¼Œå‘ç°å°ç¨‹åºä¸­çš„ç»„ä»¶äº‹å®ä¸Šæ˜¯æ ‡ç­¾ï¼Œæˆ‘ä»¬æ²¡æ³•ä½¿ç”¨jsè·å–åˆ°æˆ‘ä»¬â€œç»„ä»¶â€çš„å®ä¾‹ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šæœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä½†æ˜¯ä»€ä¹ˆéƒ½ä¸èƒ½é˜»ç¢æˆ‘ä»¬å†™é€šç”¨ç»„ä»¶çš„å†³å¿ƒï¼Œäºæ˜¯æˆ‘ä»¬æ˜å¤©æ¥å†™ä¸€äº›é€šç”¨çš„ç»„ä»¶åº“ï¼Œå¹¶ä¸”å½¢æˆä¸€ä¸ªå°ç¨‹åºçš„ä½“ç³»ï¼Œè¿™é‡Œæƒ³çš„æ˜¯æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;â‘  æ¶ˆæ¯æ¡†&lt;/p&gt;
&lt;p&gt;â‘¡ toastæç¤º&lt;/p&gt;
&lt;p&gt;â‘¢ æ—¥å†ç»„ä»¶&lt;/p&gt;
&lt;p&gt;â‘£ ç„¶åå†åšä¸€ä¸ªéœ€è¦å®šä½çš„æ°”æ³¡ç»„ä»¶&lt;/p&gt;
</description>
<pubDate>Mon, 30 Jul 2018 14:20:00 +0000</pubDate>
<dc:creator>å¶å°é’—</dc:creator>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/yexiaochai/p/9382862.html</dc:identifier>
</item>
</channel>
</rss>