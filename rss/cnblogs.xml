<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>Ubuntuè™šæ‹Ÿæœºé…ç½®WiFiè¿æ¥ - ä¸œå°ä¸œ</title>
<link>http://www.cnblogs.com/dongxiaodong/p/9678416.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/dongxiaodong/p/9678416.html</guid>
<description>&lt;p&gt;Â  Â  Â  èº«å¤„å­¦æ ¡çš„ç¯å¢ƒä¸­ï¼Œå¾ˆéš¾æƒ³è±¡å­¦æ ¡å†…ç½‘è¿æ¥äº’è”ç½‘å±…ç„¶è¦è´­ä¹°æµé‡åŒ…ï¼Œå“ˆå“ˆï¼Œè€Œä¸”ä»·æ ¼å¾ˆä¸åšé“ã€‚&lt;/p&gt;
&lt;p&gt;Â  Â  Â  æ’ä¸Šç½‘çº¿æ˜¯ä¸ºäº†è¿æ¥å­¦æ ¡å†…ç½‘ä¸‹è½½è¯¾ä»¶è¿œç¨‹ä»€ä¹ˆçš„ï¼Œä½†åŒæ—¶ä¹Ÿè¿ä¸Šæ‰‹æœºçƒ­ç‚¹æ˜¯æ—¥å¸¸æ“ä½œï¼Œç”µè„‘æ˜¯é»˜è®¤æœ‰çº¿ç½‘ä¼˜å…ˆï¼Œæ‰€ä»¥ç”µè„‘æ˜¯æ ¡å†…ç½‘è¿æ¥ï¼Œä½†æ—¢ç„¶å¯ä»¥åŒæ—¶è¿ä¸Šæ‰‹æœºçƒ­ç‚¹ï¼Œä½†æœ‰è¯¥æ€ä¹ˆè®¿é—®å¤–ç½‘ã€‚æ¥ä¸‹æ¥è™šæ‹Ÿæœºçš„å‡ºç°ï¼š&lt;/p&gt;
&lt;p&gt;Â  Â  Â  Â å·¥å…·ï¼šVMware Workstation Pro&lt;/p&gt;
&lt;p&gt;Â  Â  Â  Â  Â  Â  Â  Â  Â  Ubuntu ç³»ç»Ÿé•œåƒ&lt;/p&gt;
&lt;p&gt;Â  Â  Â  Â Â &lt;img src=&quot;https://img2018.cnblogs.com/blog/1485202/201809/1485202-20180919234624098-393110055.png&quot; alt=&quot;&quot; width=&quot;629&quot; height=&quot;412&quot;/&gt;&lt;/p&gt;



&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1485202/201809/1485202-20180919234640209-2101599403.png&quot; alt=&quot;&quot; width=&quot;602&quot; height=&quot;549&quot;/&gt;&lt;/p&gt;


&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1485202/201809/1485202-20180919234654611-603136344.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1485202/201809/1485202-20180919234706539-841255065.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â  æ¡¥æ¥æˆåŠŸï¼Œå¯ä»¥æ‰“å¼€æµè§ˆå™¨www.baidu.comçœ‹çœ‹&lt;/p&gt;

</description>
<pubDate>Wed, 19 Sep 2018 15:50:00 +0000</pubDate>
<dc:creator>ä¸œå°ä¸œ</dc:creator>
<og:description>èº«å¤„å­¦æ ¡çš„ç¯å¢ƒä¸­ï¼Œå¾ˆéš¾æƒ³è±¡å­¦æ ¡å†…ç½‘è¿æ¥äº’è”ç½‘å±…ç„¶è¦è´­ä¹°æµé‡åŒ…ï¼Œå“ˆå“ˆï¼Œè€Œä¸”ä»·æ ¼å¾ˆä¸åšé“ã€‚ æ’ä¸Šç½‘çº¿æ˜¯ä¸ºäº†è¿æ¥å­¦æ ¡å†…ç½‘ä¸‹è½½è¯¾ä»¶è¿œç¨‹ä»€ä¹ˆçš„ï¼Œä½†åŒæ—¶ä¹Ÿè¿ä¸Šæ‰‹æœºçƒ­ç‚¹æ˜¯æ—¥å¸¸æ“ä½œï¼Œç”µè„‘æ˜¯é»˜è®¤æœ‰çº¿ç½‘ä¼˜å…ˆï¼Œæ‰€ä»¥ç”µè„‘æ˜¯æ ¡</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/dongxiaodong/p/9678416.html</dc:identifier>
</item>
<item>
<title>iOS æ¨¡å—åˆ†è§£â€”ã€ŒRuntimeé¢è¯•ã€å·¥ä½œã€çœ‹æˆ‘å°± ğŸ’ äº† ^_^. - public-ä¸çŸ¥åå¼€å‘è€…</title>
<link>http://www.cnblogs.com/Plainboiledwater/p/9678287.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/Plainboiledwater/p/9678287.html</guid>
<description>&lt;h4 id=&quot;å¼•å¯¼&quot;&gt;å¼•å¯¼&lt;/h4&gt;
&lt;hr/&gt;&lt;blockquote readability=&quot;12&quot;&gt;
&lt;p&gt;ç›¸ä¿¡å¯¹äºä»äº‹å¼€å‘äººå‘˜æ¥è¯´ runtime è¿™ä¸ªåç§°éƒ½ä¸é™Œç”Ÿï¼Œå°±åƒæˆ‘èµ·åˆåªçŸ¥é“ã€Œ runtime å«è¿è¡Œæ—¶ ã€ï¼Œåæ¥çŸ¥é“ runtime åŒæ ·å¯ä»¥åƒ KVC ä¸€æ ·è®¿é—®ç§æœ‰æˆå‘˜å˜é‡ï¼Œè¿˜æœ‰ã€Œ ç»™ç±»åŠ¨æ€æ·»åŠ å±æ€§ï¼šLNTextField.placeholderColor || äº¤æ¢æ–¹æ³•ï¼šimageNamed =&amp;gt; ln_imageNamed ã€ï¼Œè¿˜æœ‰æ·±å…¥çš„ ã€Œ æ¶ˆæ¯æœºåˆ¶çš„è°ƒç”¨æµç¨‹ || å­—å…¸è½¬æ¨¡å‹ || å®ç°NSCodingå½’è§£æ¡£ ã€ä»¥åŠæˆ‘ä»¬å¸¸è¯´çš„â€œé»‘é­”æ³•â€ æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;runtime æ˜¯ç¼–ç¨‹ä¸­æ¯”è¾ƒéš¾çš„æ¨¡å—ï¼Œæƒ³è¦æ·±å…¥å­¦ä¹ ï¼Œè¿™ä¸ªæ¨¡å—ä½ å¿…é¡»æŒæ¡ï¼ŒåŒæ ·è¿˜æœ‰å†™çš„å¦ä¸€ç¯‡ runloop æ¨¡å—ï¼Œä¸‹é¢æ˜¯æˆ‘å¯¹ runtime çš„æ•´ç†ï¼Œä»é›¶å¼€å§‹ï¼Œç”±æµ…å…¥æ·±ï¼Œä¸”å¸¦äº†å‡ ä¸ª Runtime å®è·µåœºæ™¯ --&amp;gt; å¤§å‚æ¥çš„å·¥å‹ä»¬å¯é€‰æ‹©æ€§è·¯è¿‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote readability=&quot;3.7875150060024&quot;&gt;
&lt;p&gt;ç›®å½•ï¼š &lt;a href=&quot;https://github.com/CoderLN/Apple-GitHub-Codeidea&quot;&gt;ğŸ¤¡&lt;/a&gt; ã€ &lt;a href=&quot;https://github.com/CoderLN/Framework-Codeidea&quot;&gt;ğŸ‘¨â€ğŸ’»&lt;/a&gt;ã€&lt;a href=&quot;http://upload-images.jianshu.io/upload_images/2230763-93b83d5b7a7b0a49.gif?imageMogr2/auto-orient/strip&quot;&gt;ğŸ‘™&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://github.com/CoderLN/Framework-Codeidea/tree/master/Framework-Codeidea/LNOtherFrameworks-Annotations/Runtime&quot;&gt;runtime.h&lt;/a&gt; é‡Šä¹‰&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯æœºåˆ¶&lt;br/&gt;1.isaæŒ‡é’ˆé‡Šä¹‰&lt;br/&gt;2.æ–¹æ³•è°ƒç”¨ï¼Œæ˜¯å¦çœŸçš„æ˜¯è½¬æ¢ä¸ºæ¶ˆæ¯æœºåˆ¶ï¼Ÿ&lt;br/&gt;2.objc_msgSend å‚æ•°æ¦‚å¿µé‡Šä¹‰&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯æœºåˆ¶ï¼ˆæ–¹æ³•è°ƒç”¨æµç¨‹ï¼‰&lt;/li&gt;
&lt;li&gt;å¸¸è§ä½œç”¨&lt;/li&gt;
&lt;li&gt;å¼€å‘åœºæ™¯ã€Œå·¥ä½œæŒæ¡ã€&lt;br/&gt;1.äº¤æ¢æ–¹æ³•&lt;br/&gt;2.ç»™ç³»ç»Ÿåˆ†ç±»åŠ¨æ€æ·»åŠ å±æ€§&lt;br/&gt;3.å­—å…¸è½¬æ¨¡å‹ï¼ˆRuntime è€ƒè™‘ä¸‰ç§æƒ…å†µå®ç°ï¼‰&lt;/li&gt;
&lt;li&gt;å…¶å®ƒä½œç”¨ã€Œé¢è¯•ç†Ÿæ‚‰ã€&lt;br/&gt;1.åŠ¨æ€æ·»åŠ æ–¹æ³•&lt;br/&gt;2.åŠ¨æ€å˜é‡æ§åˆ¶&lt;br/&gt;3.å®ç°NSCodingçš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£&lt;br/&gt;4.runtime éƒ¨åˆ†å‡½æ•°&lt;br/&gt;5.method swizzlingï¼ˆä¿—ç§°é»‘é­”æ³•ï¼‰&lt;/li&gt;
&lt;li&gt;ä¸€é“é¢è¯•é¢˜çš„æ³¨è§£&lt;/li&gt;
&lt;li&gt;æ¨¡å—åšæ–‡æ¨è(â¤ï¸æ•°é‡è¾ƒå¤š)&lt;/li&gt;
&lt;li&gt;Runtime &amp;amp; Runloop å¸¸é¢é—®é¢˜æ•´ç†ï¼ˆé™„ç­”æ¡ˆï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/CustomPBWaters/runtime-Learning&quot;&gt;Demo é‡è¦çš„éƒ¨åˆ†ä»£ç ä¸­éƒ½æœ‰ç›¸åº”çš„æ³¨è§£å’Œæ–‡å­—æ‰“å°ï¼Œè¿è¡Œç¨‹åºå¯ä»¥å¾ˆç›´è§‚çš„è¡¨ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;iOS æ¨¡å—æ³¨è§£â€”ã€ŒRunloopé¢è¯•ã€å·¥ä½œã€çœ‹æˆ‘å°± ğŸ’ äº† ^_^.&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;h4 id=&quot;é‡Šä¹‰&quot;&gt;é‡Šä¹‰&lt;/h4&gt;
&lt;hr/&gt;&lt;p&gt;Objective-C æ˜¯åŸºäº C çš„ï¼Œå®ƒä¸º C æ·»åŠ äº†é¢å‘å¯¹è±¡çš„ç‰¹æ€§ã€‚å®ƒå°†å¾ˆå¤šé™æ€è¯­è¨€åœ¨ç¼–è¯‘å’Œé“¾æ¥æ—¶æœŸåšçš„äº‹æ”¾åˆ°äº† runtime è¿è¡Œæ—¶æ¥å¤„ç†ï¼Œå¯ä»¥è¯´ runtime æ˜¯æˆ‘ä»¬ Objective-C å¹•åå·¥ä½œè€…ã€‚&lt;br/&gt;1.&lt;strong&gt;runtime&lt;/strong&gt;ï¼ˆ&lt;code&gt;ç®€ç§°è¿è¡Œæ—¶&lt;/code&gt;ï¼‰ï¼Œæ˜¯ä¸€å¥— çº¯C(Cå’Œæ±‡ç¼–)å†™çš„APIã€‚è€Œ &lt;strong&gt;OC å°±æ˜¯è¿è¡Œæ—¶æœºåˆ¶&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿è¡Œæ—¶å€™çš„ä¸€äº›æœºåˆ¶ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯ &lt;strong&gt;æ¶ˆæ¯æœºåˆ¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;2.å¯¹äº C è¯­è¨€ï¼Œ&lt;strong&gt;å‡½æ•°çš„è°ƒç”¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;3.&lt;strong&gt;è¿è¡Œæ—¶æœºåˆ¶åŸç†&lt;/strong&gt;ï¼šOCçš„å‡½æ•°è°ƒç”¨ç§°ä¸ºæ¶ˆæ¯å‘é€ï¼Œå±äº &lt;strong&gt;åŠ¨æ€è°ƒç”¨è¿‡ç¨‹&lt;/strong&gt;ã€‚åœ¨ &lt;strong&gt;ç¼–è¯‘çš„æ—¶å€™&lt;/strong&gt; å¹¶ä¸èƒ½å†³å®šçœŸæ­£è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œåªæœ‰åœ¨çœŸ &lt;strong&gt;æ­£è¿è¡Œçš„æ—¶å€™&lt;/strong&gt; æ‰ä¼šæ ¹æ®å‡½æ•°çš„åç§°æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°æ¥è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;4.&lt;strong&gt;äº‹å®è¯æ˜ï¼šåœ¨ç¼–è¯‘é˜¶æ®µï¼ŒOC å¯ä»¥ è°ƒç”¨ä»»ä½•å‡½æ•°ï¼Œå³ä½¿è¿™ä¸ªå‡½æ•°å¹¶æœªå®ç°ï¼Œåªè¦å£°æ˜è¿‡å°±ä¸ä¼šæŠ¥é”™ï¼Œåªæœ‰å½“è¿è¡Œçš„æ—¶å€™æ‰ä¼šæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºOCæ˜¯è¿è¡Œæ—¶åŠ¨æ€è°ƒç”¨çš„ã€‚è€Œ C è¯­è¨€ è°ƒç”¨æœªå®ç°çš„å‡½æ•° å°±ä¼šæŠ¥é”™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&quot;æ¶ˆæ¯æœºåˆ¶&quot;&gt;æ¶ˆæ¯æœºåˆ¶&lt;/h4&gt;
&lt;hr/&gt;&lt;p&gt;æˆ‘ä»¬å†™ OC ä»£ç ï¼Œå®ƒåœ¨è¿è¡Œçš„æ—¶å€™ä¹Ÿæ˜¯è½¬æ¢æˆäº† &lt;code&gt;runtime&lt;/code&gt; æ–¹å¼è¿è¡Œçš„ã€‚ä»»ä½•æ–¹æ³•è°ƒç”¨æœ¬è´¨ï¼šå°±æ˜¯å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼ˆç”¨ &lt;code&gt;runtime&lt;/code&gt;å‘é€æ¶ˆæ¯ï¼ŒOC åº•å±‚å®ç°é€šè¿‡ &lt;code&gt;runtime&lt;/code&gt; å®ç°ï¼‰ï¼Œæ¯ä¸€ä¸ª OC çš„æ–¹æ³•ï¼Œåº•å±‚å¿…ç„¶æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ &lt;code&gt;runtime&lt;/code&gt; æ–¹æ³•ã€‚&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-c544843cabe32e0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;/&gt;&lt;/p&gt;
&lt;h5 id=&quot;éªŒè¯ç¤ºä¾‹æ–¹æ³•è°ƒç”¨æ˜¯å¦çœŸçš„æ˜¯è½¬æ¢ä¸ºæ¶ˆæ¯æœºåˆ¶&quot;&gt;éªŒè¯ç¤ºä¾‹ï¼šæ–¹æ³•è°ƒç”¨ï¼Œæ˜¯å¦çœŸçš„æ˜¯è½¬æ¢ä¸ºæ¶ˆæ¯æœºåˆ¶ï¼Ÿ&lt;/h5&gt;
&lt;p&gt;æ¶ˆæ¯æœºåˆ¶åŸç†ï¼šå¯¹è±¡æ ¹æ®æ–¹æ³•ç¼–å·SELå»æ˜ å°„è¡¨æŸ¥æ‰¾å¯¹åº”çš„æ–¹æ³•å®ç°ã€‚&lt;br/&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;ï¼š&lt;br/&gt;1.å¿…é¡»è¦å¯¼å…¥å¤´æ–‡ä»¶ &lt;code&gt;#import &amp;lt;objc/message.h&amp;gt;&lt;/code&gt;&lt;br/&gt;2.æˆ‘ä»¬å¯¼å…¥ç³»ç»Ÿçš„å¤´æ–‡ä»¶ï¼Œä¸€èˆ¬ç”¨å°–æ‹¬å·ã€‚&lt;br/&gt;3.OC è§£å†³æ¶ˆæ¯æœºåˆ¶æ–¹æ³•æç¤ºæ­¥éª¤ã€æŸ¥æ‰¾&lt;code&gt;build setting&lt;/code&gt; -&amp;gt; æœç´¢&lt;code&gt;msg&lt;/code&gt; -&amp;gt; &lt;code&gt;objc_msgSend&lt;/code&gt;ï¼ˆYES --&amp;gt; NOï¼‰ã€‘&lt;br/&gt;4.æœ€ç»ˆç”Ÿæˆæ¶ˆæ¯æœºåˆ¶ï¼Œç¼–è¯‘å™¨åšçš„äº‹æƒ…ï¼Œæœ€ç»ˆä»£ç ï¼Œéœ€è¦æŠŠå½“å‰ä»£ç ç”¨xcodeé‡æ–°ç¼–è¯‘ï¼Œã€&lt;code&gt;clang -rewrite-objc main.m&lt;/code&gt; æŸ¥çœ‹æœ€ç»ˆç”Ÿæˆä»£ç ã€‘ï¼Œç¤ºä¾‹ï¼š&lt;code&gt;cd main.m --&amp;gt; è¾“å…¥å‰é¢æŒ‡ä»¤ï¼Œå°±ä¼šç”Ÿæˆ .oppæ–‡ä»¶(C++ä»£ç )&lt;/code&gt;&lt;br/&gt;5.è¿™é‡Œä¸€èˆ¬ä¸ä¼šç›´æ¥å¯¼å…¥&lt;code&gt;&amp;lt;objc/runtime.h&amp;gt;&lt;/code&gt;&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-6ebbe2c7584b7285.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹ä»£ç &lt;/strong&gt;ï¼šOC æ–¹æ³• &amp;lt;--&amp;gt; runtime æ–¹æ³•&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;è¯´æ˜ï¼š
eat(æ— å‚) å’Œ run(æœ‰å‚NSInteger) æ˜¯ LNPersonæ¨¡å‹ç±»ä¸­çš„ç§æœ‰æ–¹æ³•ã€Œruntime ä½œç”¨ï¼šå¯ä»¥è°ƒç”¨ç§æœ‰æ–¹æ³•ã€
ç¤ºä¾‹åˆ†åˆ«ä»¥ OCå†™æ³• å’Œ æœ€åº•å±‚å†™æ³• å¯¹ç…§éªŒè¯.
- (void)msgSend
{
    // æ–¹æ³•ä¸€ï¼š
    //id objc = [NSObject alloc];
    LNPerson *person = objc_msgSend(objc_getClass(&quot;LNPerson&quot;), sel_registerName(&quot;alloc&quot;));
    
    //objc = [objc init];
    person = objc_msgSend(person, sel_registerName(&quot;init&quot;));
    
    // è°ƒç”¨
    //[objc eat];
    //[objc run:10];
    objc_msgSend(person,@selector(eat)); // æ— å‚
    objc_msgSend(person,@selector(run:),10); // æœ‰æ®‹
}
/
 æ³¨è§£ï¼š
    // ç”¨æœ€åº•å±‚å†™
    objc_getClass(const char *name) è·å–å½“å‰ç±»
    sel_registerName(const char *str) æ³¨å†Œä¸ªæ–¹æ³•ç¼–å·
    objc_msgSend(id selfï¼šè°å‘é€æ¶ˆæ¯, SEL opï¼šå‘é€ä»€ä¹ˆæ¶ˆæ¯, ...)
    è®©LNPersonè¿™ä¸ªç±»å¯¹è±¡å‘é€äº†ä¸€ä¸ªallocæ¶ˆæ¯ï¼Œè¿”å›ä¸€ä¸ªåˆ†é…å¥½çš„å†…å­˜å¯¹è±¡ç»™ä½ ï¼Œå†å‘é€ä¸€ä¸ªæ¶ˆæ¯åˆå§‹åŒ–.
 */

// æ–¹æ³•äºŒï¼š
#pragma mark - ä¹Ÿè®¸ä¸‹é¢è¿™ç§å¥½ç†è§£ä¸€ç‚¹
- (void)test
{
    // id objc = [NSObject alloc];
    id objc = objc_msgSend([NSObject class], @selector(alloc));
    
    // objc = [objc init];
    objc = objc_msgSend(objc, @selector(eat));
    
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h5 id=&quot;objc_msgsend-å‚æ•°æ¦‚å¿µ&quot;&gt;objc_msgSend å‚æ•°æ¦‚å¿µ&lt;/h5&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;/
 objc_msgSend(&amp;lt;#id  _Nullable self#&amp;gt;, &amp;lt;#SEL  _Nonnull op, ...#&amp;gt;)

 1ã€objc_msgSend
    è¿™æ˜¯ä¸ªæœ€åŸºæœ¬çš„ç”¨äºå‘é€æ¶ˆæ¯çš„å‡½æ•°ã€‚
    å…¶å®ç¼–è¯‘å™¨ä¼šæ ¹æ®æƒ…å†µåœ¨`objc_msgSend`ï¼Œ `objc_msgSend_stret`,ï¼Œ`objc_msgSendSuper`ï¼Œ æˆ– `objc_msgSendSuper_stret` å››ä¸ªæ–¹æ³•ä¸­é€‰æ‹©ä¸€ä¸ªæ¥è°ƒç”¨ã€‚å¦‚æœæ¶ˆæ¯æ˜¯ä¼ é€’ç»™è¶…ç±»ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨åå­—å¸¦æœ‰ `Super` çš„å‡½æ•°ï¼›å¦‚æœæ¶ˆæ¯è¿”å›å€¼æ˜¯æ•°æ®ç»“æ„è€Œä¸æ˜¯ç®€å•å€¼æ—¶ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨åå­—å¸¦æœ‰`stret`çš„å‡½æ•°ã€‚
 
 2ã€SEL
    `objc_msgSend`å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸º`SEL`ï¼Œå®ƒæ˜¯`selector`åœ¨Objcä¸­çš„è¡¨ç¤ºç±»å‹ï¼ˆSwiftä¸­æ˜¯Selectorç±»ï¼‰ã€‚`selector`æ˜¯æ–¹æ³•é€‰æ‹©å™¨ï¼Œå¯ä»¥ç†è§£ä¸ºåŒºåˆ†æ–¹æ³•çš„ `ID`ï¼Œè€Œè¿™ä¸ª `ID` çš„æ•°æ®ç»“æ„æ˜¯`SEL`:
    `typedef struct objc_selector *SEL;`
    å…¶å®å®ƒå°±æ˜¯ä¸ªæ˜ å°„åˆ°æ–¹æ³•çš„Cå­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥ç”¨ Objc ç¼–è¯‘å™¨å‘½ä»¤`@selector()``æˆ–è€… Runtime` ç³»ç»Ÿçš„`sel_registerName`å‡½æ•°æ¥è·å¾—ä¸€ä¸ª`SEL`ç±»å‹çš„æ–¹æ³•é€‰æ‹©å™¨ã€‚
 
 3ã€id
    `objc_msgSend`ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º`id`ï¼Œå¤§å®¶å¯¹å®ƒéƒ½ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘ç±»å®ä¾‹çš„æŒ‡é’ˆï¼š
    `typedef struct objc_object *id;`
    é‚£`objc_object`åˆæ˜¯å•¥å‘¢ï¼š
    `struct objc_object { Class isa; };`
    `objc_object`ç»“æ„ä½“åŒ…å«ä¸€ä¸ª`isa`æŒ‡é’ˆï¼Œæ ¹æ®`isa`æŒ‡é’ˆå°±å¯ä»¥é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°å¯¹è±¡æ‰€å±çš„ç±»ã€‚
 */&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;æ¶ˆæ¯æœºåˆ¶æ–¹æ³•è°ƒç”¨æµç¨‹&quot;&gt;æ¶ˆæ¯æœºåˆ¶ã€Œæ–¹æ³•è°ƒç”¨æµç¨‹ã€&lt;/h4&gt;
&lt;hr/&gt;&lt;p&gt;&lt;strong&gt;é¢è¯•ï¼šæ¶ˆæ¯æœºåˆ¶æ–¹æ³•è°ƒç”¨æµç¨‹â“&lt;/strong&gt;&lt;br/&gt;æ€ä¹ˆå»è°ƒç”¨&lt;code&gt;eat&lt;/code&gt;æ–¹æ³•ï¼Œ&lt;br/&gt;å¯¹è±¡æ–¹æ³•ï¼š(ä¿å­˜åˆ°ç±»å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨) ï¼Œç±»æ–¹æ³•ï¼š(ä¿å­˜åˆ°å…ƒç±»(&lt;code&gt;Meta Class&lt;/code&gt;)ä¸­æ–¹æ³•åˆ—è¡¨)ã€‚&lt;/p&gt;
&lt;p&gt;1.OC åœ¨å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯æ—¶ï¼Œruntime åº“ä¼šæ ¹æ®å¯¹è±¡çš„ isaæŒ‡é’ˆæ‰¾åˆ°è¯¥å¯¹è±¡å¯¹åº”çš„ç±»æˆ–å…¶çˆ¶ç±»ä¸­æŸ¥æ‰¾æ–¹æ³•ã€‚ã€‚&lt;br/&gt;2.æ³¨å†Œæ–¹æ³•ç¼–å·ï¼ˆè¿™é‡Œç”¨æ–¹æ³•ç¼–å·çš„å¥½å¤„ï¼Œå¯ä»¥å¿«é€ŸæŸ¥æ‰¾ï¼‰ã€‚&lt;br/&gt;3.æ ¹æ®æ–¹æ³•ç¼–å·å»æŸ¥æ‰¾å¯¹åº”æ–¹æ³•ã€‚&lt;br/&gt;4.æ‰¾åˆ°åªæ˜¯æœ€ç»ˆå‡½æ•°å®ç°åœ°å€ï¼Œæ ¹æ®åœ°å€å»æ–¹æ³•åŒºè°ƒç”¨å¯¹åº”å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¡¥å……&lt;/strong&gt;ï¼šä¸€ä¸ªobjc å¯¹è±¡çš„ isa çš„æŒ‡é’ˆæŒ‡å‘ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ&lt;br/&gt;æ¯ä¸€ä¸ªå¯¹è±¡å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæ˜¯æŒ‡å‘å®ƒçš„çœŸå®ç±»å‹ï¼Œæ ¹æ®è¿™ä¸ªæŒ‡é’ˆå°±èƒ½çŸ¥é“å°†æ¥è°ƒç”¨å“ªä¸ªç±»çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h5 id=&quot;isaæŒ‡é’ˆç›¸å…³é‡Šä¹‰&quot;&gt;isaæŒ‡é’ˆç›¸å…³é‡Šä¹‰&lt;/h5&gt;
&lt;p&gt;ä¸Šé¢ä¹Ÿæåˆ°OCåº•å±‚éƒ½æ˜¯è½¬åŒ–ä¸ºruntimeæ–¹å¼æ¥å®ç°çš„ï¼Œ&lt;strong&gt;ç±»å’Œç±»çš„å®ä¾‹ï¼ˆå¯¹è±¡ï¼‰éƒ½ç›¸å¯¹äºçš„isaæŒ‡é’ˆ&lt;/strong&gt;ã€‚&lt;br/&gt;æˆ‘ä»¬å¯ä»¥åœ¨Xcodeä¸­ä½¿ç”¨ [Shiftï¼‹Cmdï¼‹O ] å¿«é€Ÿæ‰“å¼€æ–‡ä»¶objc.h èƒ½çœ‹åˆ°ç±»çš„å®šä¹‰ï¼š&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-f3b6e5b8f10fff71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;objc.h&quot;/&gt;&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-2ab976db7139cade.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;isaï¼šæ˜¯ä¸€ä¸ªClass ç±»å‹çš„æŒ‡é’ˆ&quot;/&gt;&lt;br/&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-c44c51bdc34f8645.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;runtime å¯¹è±¡ï¼Œç±»ï¼Œå…ƒç±»çš„isaæŒ‡é’ˆå…³ç³»å›¾.png&quot;/&gt;&lt;br/&gt;&lt;strong&gt;æ€»ç»“ï¼šruntime å¯¹è±¡ï¼Œç±»ï¼Œå…ƒç±»çš„isaæŒ‡é’ˆå…³ç³»å›¾&lt;/strong&gt;&lt;br/&gt;1ã€æ¯ä¸€ä¸ªå¯¹è±¡æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ã€‚å…¶ä¸­ç±»å®šä¹‰äº†æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•çš„åˆ—è¡¨ã€‚&lt;strong&gt;å¯¹è±¡é€šè¿‡å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘æ‰€å±ç±»&lt;/strong&gt;ã€‚&lt;br/&gt;2ã€æ¯ä¸€ä¸ªç±»æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç±»å…¶å®æ˜¯å…ƒç±»ï¼ˆmeteClassï¼‰çš„å®ä¾‹ã€‚å…ƒç±»å®šä¹‰äº†ç±»æ–¹æ³•çš„åˆ—è¡¨ã€‚&lt;strong&gt;ç±»é€šè¿‡ç±»çš„isaæŒ‡é’ˆæŒ‡å‘å…ƒç±»&lt;/strong&gt;ã€‚&lt;br/&gt;3ã€å…ƒç±»ä¿å­˜äº†ç±»æ–¹æ³•çš„åˆ—è¡¨ã€‚å½“ç±»æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå…ˆä¼šä»æœ¬èº«æŸ¥æ‰¾ç±»æ–¹æ³•çš„å®ç°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå…ƒç±»ä¼šå‘ä»–çˆ¶ç±»æŸ¥æ‰¾è¯¥æ–¹æ³•ã€‚åŒæ—¶æ³¨æ„çš„æ˜¯ï¼šå…ƒç±»ï¼ˆmeteClassï¼‰ä¹Ÿæ˜¯ç±»ï¼Œå®ƒä¹Ÿæ˜¯å¯¹è±¡ã€‚&lt;strong&gt;å…ƒç±»é€šè¿‡isaæŒ‡é’ˆæœ€ç»ˆæŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ ¹å…ƒç±»(root meteClass)&lt;/strong&gt;ã€‚&lt;br/&gt;4ã€&lt;strong&gt;æ ¹å…ƒç±»çš„isaæŒ‡é’ˆæŒ‡å‘æœ¬èº«ï¼Œè¿™æ ·å½¢æˆäº†ä¸€ä¸ªå°é—­çš„å†…å¾ªç¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å¸¸è§ä½œç”¨&quot;&gt;å¸¸è§ä½œç”¨&lt;/h4&gt;
&lt;hr/&gt;&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;/
 1.åŠ¨æ€äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°
 2.åŠ¨æ€æ·»åŠ å±æ€§
 3.å®ç°å­—å…¸è½¬æ¨¡å‹çš„è‡ªåŠ¨è½¬æ¢
 4.åŠ¨æ€æ·»åŠ æ–¹æ³•
 5.æ‹¦æˆªå¹¶æ›¿æ¢æ–¹æ³•
 6.å®ç° NSCoding çš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£

è¡¥å……å¸¸ç”¨runtimeç¤ºä¾‹ï¼šDemoä¸­æœ‰ä½“ç°
    1.æ·»åŠ å±æ€§å’Œäº¤æ¢æ–¹æ³•ç¤ºä¾‹ï¼šUITextFieldå ä½æ–‡å­—é¢œè‰²placeholderColor
    2.äº¤æ¢æ–¹æ³•ç¤ºä¾‹ï¼šäº¤æ¢deallocæ–¹æ³•å®ç°ï¼Œæ·»åŠ åŠŸèƒ½é‚£ä¸ªæ§åˆ¶å™¨è¢«é”€æ¯äº†
 */&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;å¼€å‘åœºæ™¯å·¥ä½œæŒæ¡&quot;&gt;å¼€å‘åœºæ™¯ã€Œå·¥ä½œæŒæ¡ã€&lt;/h4&gt;
&lt;hr/&gt;&lt;h5 id=&quot;runtime-äº¤æ¢æ–¹æ³•&quot;&gt;runtime äº¤æ¢æ–¹æ³•&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå½“ç¬¬ä¸‰æ–¹æ¡†æ¶ æˆ–è€… ç³»ç»ŸåŸç”Ÿæ–¹æ³•åŠŸèƒ½ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿æŒç³»ç»ŸåŸæœ‰æ–¹æ³•åŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šåŠ è½½ä¸€å¼ å›¾ç‰‡ç›´æ¥ç”¨&lt;code&gt;[UIImage imageNamed:@&quot;image&quot;];&lt;/code&gt;æ˜¯æ— æ³•çŸ¥é“åˆ°åº•æœ‰æ²¡æœ‰åŠ è½½æˆåŠŸã€‚ç»™ç³»ç»Ÿçš„&lt;code&gt;imageNamed&lt;/code&gt;æ·»åŠ é¢å¤–åŠŸèƒ½ï¼ˆæ˜¯å¦åŠ è½½å›¾ç‰‡æˆåŠŸï¼‰ã€‚&lt;br/&gt;æ–¹æ¡ˆä¸€ï¼šç»§æ‰¿ç³»ç»Ÿçš„ç±»ï¼Œé‡å†™æ–¹æ³•.ï¼ˆå¼Šç«¯ï¼šæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦å¯¼å…¥ï¼‰&lt;br/&gt;æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ runtimeï¼Œäº¤æ¢æ–¹æ³•.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ­¥éª¤&lt;/strong&gt;ï¼š&lt;br/&gt;1.ç»™ç³»ç»Ÿçš„æ–¹æ³•æ·»åŠ åˆ†ç±»&lt;br/&gt;2.è‡ªå·±å®ç°ä¸€ä¸ªå¸¦æœ‰æ‰©å±•åŠŸèƒ½çš„æ–¹æ³•&lt;br/&gt;3.äº¤æ¢æ–¹æ³•,åªéœ€è¦äº¤æ¢ä¸€æ¬¡,&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯ä»£ç &lt;/strong&gt;ï¼šæ–¹æ³•+è°ƒç”¨+æ‰“å°è¾“å‡º&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &quot;UIImage+Image.h&quot;
#import &amp;lt;objc/message.h&amp;gt;

@implementation UIImage (Image)

/
 çœ‹æ¸…æ¥šä¸‹é¢æ˜¯ä¸ä¼šæœ‰æ­»å¾ªç¯çš„
    è°ƒç”¨ imageNamed =&amp;gt; ln_imageNamed
    è°ƒç”¨ ln_imageNamed =&amp;gt; imageNamed
 */
// åŠ è½½å›¾ç‰‡ ä¸” å¸¦åˆ¤æ–­æ˜¯å¦åŠ è½½æˆåŠŸ
+ (UIImage *)ln_imageNamed:(NSString *)name {
    
    UIImage *image = [UIImage ln_imageNamed:name];
    if (image) {
        NSLog(@&quot;runtimeäº¤äº’æ–¹æ³• -&amp;gt; å›¾ç‰‡åŠ è½½æˆåŠŸ&quot;);
    } else {
        NSLog(@&quot;runtimeäº¤äº’æ–¹æ³• -&amp;gt; å›¾ç‰‡åŠ è½½å¤±è´¥&quot;);
    }
    return image;
}

/
 æ³¨è§£ï¼š
    ä¸èƒ½åœ¨åˆ†ç±»ä¸­é‡å†™ç³»ç»Ÿæ–¹æ³•imageNamedï¼Œå› ä¸ºä¼šæŠŠç³»ç»Ÿçš„åŠŸèƒ½ç»™è¦†ç›–æ‰ï¼Œè€Œä¸”åˆ†ç±»ä¸­ä¸èƒ½è°ƒç”¨super
    æ‰€ä»¥ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬è¦ è‡ªå·±å®ç°ä¸€ä¸ªå¸¦æœ‰æ‰©å±•åŠŸèƒ½çš„æ–¹æ³•.
 + (UIImage *)imageNamed:(NSString *)name {
 
 }
 */

/
 ä½œç”¨ï¼šæŠŠç±»åŠ è½½è¿›å†…å­˜çš„æ—¶å€™è°ƒç”¨,åªä¼šè°ƒç”¨ä¸€æ¬¡
 è°ƒç”¨ï¼šæ–¹æ³•åº”å…ˆäº¤æ¢ï¼Œå†å»è°ƒç”¨
 */
+ (void)load {
    
    // 1.è·å– imageNamedæ–¹æ³•åœ°å€
    Method imageNamedMethod = class_getClassMethod(self, @selector(imageNamed:));
    // 2.è·å– ln_imageNamedæ–¹æ³•åœ°å€
    Method ln_imageNamedMethod = class_getClassMethod(self, @selector(ln_imageNamed:));
    
    // 3.äº¤æ¢æ–¹æ³•åœ°å€ï¼Œç›¸å½“äºäº¤æ¢å®ç°æ–¹å¼;ã€Œmethod_exchangeImplementations äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ã€
    method_exchangeImplementations(imageNamedMethod, ln_imageNamedMethod);
}

- - -
//æ–¹æ¡ˆä¸€ï¼šå…ˆæä¸ªåˆ†ç±»ï¼Œå®šä¹‰ä¸€ä¸ªèƒ½åŠ è½½å›¾ç‰‡å¹¶ä¸”èƒ½æ‰“å°çš„æ–¹æ³•+ (instancetype)imageWithName:(NSString *)name;
//æ–¹æ¡ˆäºŒï¼šäº¤æ¢ imageNamed å’Œ ln_imageNamed çš„å®ç°ï¼Œå°±èƒ½è°ƒç”¨ imageNamedï¼Œé—´æ¥è°ƒç”¨ ln_imageNamed çš„å®ç°ã€‚
- (void)viewDidLoad
{
    [super viewDidLoad];
    
    self.imageView.image = [UIImage imageNamed:@&quot;CoerLN&quot;];
}

- - -
// æ‰“å°è¾“å‡º
2016-03-17 17:52:14.693 runtime[12761:543574] runtimeäº¤äº’æ–¹æ³• -&amp;gt; å›¾ç‰‡åŠ è½½æˆåŠŸ&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;br/&gt;æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯åœ¨æ–¹æ³•è°ƒç”¨æµç¨‹ç¬¬ä¸‰æ­¥çš„æ—¶å€™ï¼Œäº¤æ¢ä¸¤ä¸ªæ–¹æ³•åœ°å€æŒ‡å‘ã€‚è€Œä¸”æˆ‘ä»¬æ”¹å˜æŒ‡å‘è¦åœ¨ç³»ç»Ÿçš„&lt;code&gt;imageNamed:&lt;/code&gt;æ–¹æ³•è°ƒç”¨å‰ï¼Œæ‰€ä»¥å°†ä»£ç å†™åœ¨äº†åˆ†ç±»çš„&lt;code&gt;load&lt;/code&gt;æ–¹æ³•é‡Œã€‚æœ€åå½“è¿è¡Œçš„æ—¶å€™ç³»ç»Ÿçš„æ–¹æ³•å°±ä¼šå»æ‰¾æˆ‘ä»¬çš„æ–¹æ³•çš„å®ç°ã€‚&lt;/p&gt;
&lt;h5 id=&quot;ç»™ç³»ç»Ÿåˆ†ç±»åŠ¨æ€æ·»åŠ å±æ€§&quot;&gt;ç»™ç³»ç»Ÿåˆ†ç±»åŠ¨æ€æ·»åŠ å±æ€§&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šç»™ç³»ç»Ÿçš„ç±»æ·»åŠ é¢å¤–å±æ€§çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨runtimeåŠ¨æ€æ·»åŠ å±æ€§æ–¹æ³•ã€‚&lt;br/&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç»™ä¸€ä¸ªç±»å£°æ˜å±æ€§ï¼Œå…¶å®æœ¬è´¨å°±æ˜¯ç»™è¿™ä¸ªç±»æ·»åŠ å…³è”ï¼Œå¹¶ä¸æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå€¼çš„å†…å­˜ç©ºé—´æ·»åŠ åˆ°ç±»å­˜ç©ºé—´ã€‚&lt;br/&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;ï¼šç»™ç³»ç»Ÿ &lt;code&gt;NSObject&lt;/code&gt; æ·»åŠ ä¸€ä¸ªåˆ†ç±»ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åˆ†ç±»ä¸­æ˜¯ä¸èƒ½å¤Ÿæ·»åŠ æˆå‘˜å±æ€§çš„ï¼Œè™½ç„¶æˆ‘ä»¬ç”¨äº†&lt;code&gt;@property&lt;/code&gt;ï¼Œä½†æ˜¯ä»…ä»…ä¼šè‡ªåŠ¨ç”Ÿæˆ&lt;code&gt;get&lt;/code&gt;å’Œ&lt;code&gt;set&lt;/code&gt;æ–¹æ³•çš„å£°æ˜ï¼Œå¹¶æ²¡æœ‰å¸¦ä¸‹åˆ’çº¿çš„å±æ€§å’Œæ–¹æ³•å®ç°ç”Ÿæˆã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code&gt;runtime&lt;/code&gt;å°±å¯ä»¥åšåˆ°ç»™å®ƒæ–¹æ³•çš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šç»™ç³»ç»Ÿ NSObject ç±»åŠ¨æ€æ·»åŠ å±æ€§ &lt;code&gt;name&lt;/code&gt; å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯ä»£ç &lt;/strong&gt;ï¼šæ–¹æ³•+è°ƒç”¨+æ‰“å°&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &amp;lt;Foundation/Foundation.h&amp;gt;
@interface NSObject (Property)

@property NSString *name;
@end

- - -
#import &quot;NSObject+Property.h&quot;
#import &amp;lt;objc/message.h&amp;gt;
//#import &amp;lt;objc/runtime.h&amp;gt;

@implementation NSObject (Property)

- (NSString *)name
{
    // åˆ©ç”¨å‚æ•°key å°†å¯¹è±¡objectä¸­å­˜å‚¨çš„å¯¹åº”å€¼å–å‡ºæ¥
    return objc_getAssociatedObject(self, @&quot;name&quot;);
}

- (void)setName:(NSString *)name
{
    /**
     å°†æŸä¸ªå€¼è·ŸæŸä¸ªå¯¹è±¡å…³è”èµ·æ¥ï¼Œå°†æŸä¸ªå€¼å­˜å‚¨åˆ°æŸä¸ªå¯¹è±¡ä¸­
     objc_setAssociatedObject(&amp;lt;#id  _Nonnull object#&amp;gt;ï¼šç»™å“ªä¸ªå¯¹è±¡æ·»åŠ å±æ€§, &amp;lt;#const void * _Nonnull key#&amp;gt;ï¼šå±æ€§åç§°, &amp;lt;#id  _Nullable value#&amp;gt;ï¼šå±æ€§å€¼, &amp;lt;#objc_AssociationPolicy policy#&amp;gt;ï¼šä¿å­˜ç­–ç•¥)
     */
    objc_setAssociatedObject(self, @&quot;name&quot;, name, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
    NSLog(@&quot;name----&amp;gt;%p&quot;,name);
}
@end

// è°ƒç”¨
NSObject *objc = [[NSObject alloc] init];
objc.name = @&quot;CoderLN&quot;;
NSLog(@&quot;runtimeåŠ¨æ€æ·»åŠ å±æ€§name==%@&quot;,objc.name);

// æ‰“å°è¾“å‡º
2016-03-17 19:37:10.530 runtime[12761:543574] runtimeåŠ¨æ€æ·»åŠ å±æ€§name == CoderLN&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;br/&gt;å…¶å®ï¼Œ&lt;strong&gt;å±æ€§èµ‹å€¼çš„æœ¬è´¨ï¼Œå°±æ˜¯è®©å±æ€§ä¸ä¸€ä¸ªå¯¹è±¡äº§ç”Ÿå…³è”&lt;/strong&gt;ï¼Œæ‰€ä»¥è¦ç»™&lt;code&gt;NSObject&lt;/code&gt;çš„åˆ†ç±»çš„&lt;code&gt;name&lt;/code&gt;å±æ€§èµ‹å€¼å°±æ˜¯è®©&lt;code&gt;name&lt;/code&gt;å’Œ&lt;code&gt;NSObject&lt;/code&gt;äº§ç”Ÿå…³è”ï¼Œè€Œ&lt;code&gt;runtime&lt;/code&gt;å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;h5 id=&quot;å­—å…¸è½¬æ¨¡å‹&quot;&gt;å­—å…¸è½¬æ¨¡å‹&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;å­—å…¸è½¬æ¨¡å‹çš„æ–¹å¼&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ç»™æ¨¡å‹ä¸­å±æ€§ï¼Œåœ¨ .m ä¾æ¬¡èµ‹å€¼ï¼ˆåˆå­¦è€…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­—å…¸è½¬æ¨¡å‹ KVC å®ç°&lt;/strong&gt;
&lt;ul&gt;&lt;li&gt;KVC å­—å…¸è½¬æ¨¡å‹å¼Šç«¯ï¼šå¿…é¡»ä¿è¯ï¼Œæ¨¡å‹ä¸­çš„å±æ€§å’Œå­—å…¸ä¸­çš„&lt;code&gt;key&lt;/code&gt; ä¸€ä¸€å¯¹åº”ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸ä¸€è‡´ï¼Œå°±ä¼šè°ƒç”¨&lt;code&gt;[&amp;lt;Status 0x7fa74b545d60&amp;gt; setValue:forUndefinedKey:]&lt;/code&gt; æŠ¥&lt;code&gt;key&lt;/code&gt;æ‰¾ä¸åˆ°çš„é”™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ†æ&lt;/strong&gt;ï¼šæ¨¡å‹ä¸­çš„å±æ€§å’Œå­—å…¸çš„&lt;code&gt;key&lt;/code&gt;ä¸ä¸€ä¸€å¯¹åº”ï¼Œç³»ç»Ÿå°±ä¼šè°ƒç”¨&lt;code&gt;setValue:forUndefinedKey:&lt;/code&gt;æŠ¥é”™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£å†³&lt;/strong&gt;ï¼šé‡å†™å¯¹è±¡çš„&lt;code&gt;setValue:forUndefinedKey:&lt;/code&gt;ï¼ŒæŠŠç³»ç»Ÿçš„æ–¹æ³•è¦†ç›–ï¼Œå°±èƒ½ç»§ç»­ä½¿ç”¨KVCï¼Œå­—å…¸è½¬æ¨¡å‹äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å­—å…¸è½¬æ¨¡å‹ Runtime å®ç°&lt;/strong&gt;
&lt;ul readability=&quot;1.5&quot;&gt;&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;&lt;strong&gt;æ€è·¯&lt;/strong&gt;ï¼šåˆ©ç”¨è¿è¡Œæ—¶ï¼Œéå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§ï¼Œæ ¹æ®æ¨¡å‹çš„å±æ€§åï¼Œå»å­—å…¸ä¸­æŸ¥æ‰¾&lt;code&gt;key&lt;/code&gt;ï¼Œå–å‡ºå¯¹åº”çš„å€¼ï¼Œç»™æ¨¡å‹çš„å±æ€§èµ‹å€¼ï¼ˆä»æé†’ï¼šå­—å…¸ä¸­å–å€¼ï¼Œä¸ä¸€å®šè¦å…¨éƒ¨å–å‡ºæ¥ï¼‰ï¼›æä¾›ä¸€ä¸ªNSObjectåˆ†ç±»ï¼Œä¸“é—¨å­—å…¸è½¬æ¨¡å‹ï¼Œä»¥åæ‰€æœ‰æ¨¡å‹éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªåˆ†ç±»å®ç°å­—å…¸è½¬æ¨¡å‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;&lt;strong&gt;è€ƒè™‘æƒ…å†µ&lt;/strong&gt;ï¼š&lt;br/&gt;1.å½“å­—å…¸çš„&lt;code&gt;key&lt;/code&gt;å’Œæ¨¡å‹çš„å±æ€§åŒ¹é…ä¸ä¸Šã€‚&lt;br/&gt;2.æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹ï¼ˆæ¨¡å‹å±æ€§æ˜¯å¦å¤–ä¸€ä¸ªæ¨¡å‹å¯¹è±¡ï¼‰ã€‚&lt;br/&gt;3.æ•°ç»„ä¸­è£…ç€æ¨¡å‹ï¼ˆæ¨¡å‹çš„å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ˜¯ä¸€ä¸ªä¸ªæ¨¡å‹å¯¹è±¡ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;ï¼š&lt;br/&gt;æ ¹æ®ä¸Šé¢çš„ä¸‰ç§ç‰¹æ®Šæƒ…å†µï¼Œå…ˆæ˜¯å­—å…¸çš„&lt;code&gt;key&lt;/code&gt;å’Œæ¨¡å‹çš„å±æ€§ä¸å¯¹åº”çš„æƒ…å†µã€‚ä¸å¯¹åº”æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å­—å…¸çš„é”®å€¼å¤§äºæ¨¡å‹å±æ€§æ•°é‡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•å¤„ç†ï¼Œå› ä¸º&lt;code&gt;runtime&lt;/code&gt;æ˜¯å…ˆéå†æ¨¡å‹æ‰€æœ‰å±æ€§ï¼Œå†å»å­—å…¸ä¸­æ ¹æ®å±æ€§åæ‰¾å¯¹åº”å€¼è¿›è¡Œèµ‹å€¼ï¼Œå¤šä½™çš„é”®å€¼å¯¹ä¹Ÿå½“ç„¶ä¸ä¼šå»çœ‹äº†ï¼›å¦å¤–ä¸€ç§æ˜¯æ¨¡å‹å±æ€§æ•°é‡å¤§äºå­—å…¸çš„é”®å€¼å¯¹ï¼Œè¿™æ—¶å€™ç”±äºå±æ€§æ²¡æœ‰å¯¹åº”å€¼ä¼šè¢«èµ‹å€¼ä¸º&lt;code&gt;nil&lt;/code&gt;ï¼Œå°±ä¼šå¯¼è‡´&lt;code&gt;crash&lt;/code&gt;ï¼Œæˆ‘ä»¬åªéœ€åŠ ä¸€ä¸ªåˆ¤æ–­å³å¯ã€‚è€ƒè™‘ä¸‰ç§æƒ…å†µä¸‹é¢ä¸€ä¸€æ³¨è§£&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MJExtension å­—å…¸è½¬æ¨¡å‹å®ç°&lt;/strong&gt;
&lt;ul&gt;&lt;li&gt;åº•å±‚ä¹Ÿæ˜¯å¯¹ &lt;code&gt;runtime&lt;/code&gt; çš„å°è£…ï¼Œæ‰å¯ä»¥æŠŠä¸€ä¸ªæ¨¡å‹ä¸­æ‰€æœ‰å±æ€§éå†å‡ºæ¥ã€‚ï¼ˆæˆ‘ä¹‹æ‰€ä»¥çœ‹ä¸æ‡‚ï¼Œæ˜¯MJå°è£…äº†å¾ˆå¤šå±‚è€Œå·²^_^.ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹ï¼šruntime å­—å…¸è½¬æ¨¡å‹è€ƒè™‘ä¸‰ç§æƒ…å†µ&lt;/strong&gt;&lt;br/&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2230763-90c4b9e71267bef4.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;Runtime å­—å…¸è½¬æ¨¡å‹&quot;/&gt;&lt;/p&gt;
&lt;h6 id=&quot;runtime-å­—å…¸è½¬æ¨¡å‹--å­—å…¸çš„-key-å’Œæ¨¡å‹çš„å±æ€§ä¸åŒ¹é…æ¨¡å‹å±æ€§æ•°é‡å¤§äºå­—å…¸é”®å€¼å¯¹æ•°è¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹&quot;&gt;1ã€runtime å­—å…¸è½¬æ¨¡å‹--&amp;gt;å­—å…¸çš„ key å’Œæ¨¡å‹çš„å±æ€§ä¸åŒ¹é…ã€Œæ¨¡å‹å±æ€§æ•°é‡å¤§äºå­—å…¸é”®å€¼å¯¹æ•°ã€ï¼Œè¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹ï¼š&lt;/h6&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &quot;NSObject+Model.h&quot;
#import &amp;lt;objc/message.h&amp;gt;

@implementation NSObject (Model)

// æ€è·¯ï¼šåˆ©ç”¨runtime éå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§ï¼Œæ ¹æ®æ¨¡å‹ä¸­å±æ€§,å»å­—å…¸ä¸­å–å‡ºå¯¹åº”çš„valueç»™æ¨¡å‹å±æ€§èµ‹å€¼
+ (instancetype)modelWithDict:(NSDictionary *)dict
{
    // 1.åˆ›å»ºå¯¹åº”çš„å¯¹è±¡
    id objc = [[self alloc] init];
    
    // 2.åˆ©ç”¨runtimeç»™å¯¹è±¡ä¸­çš„å±æ€§èµ‹å€¼
    /**
      è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡
        class_copyIvarList(Class _Nullable clsï¼šè¡¨ç¤ºè·å–å“ªä¸ªç±»ä¸­çš„æˆå‘˜å˜é‡, unsigned int * _Nullable outCountï¼šè¡¨ç¤ºè¿™ä¸ªç±»æœ‰å¤šå°‘æˆå‘˜å˜é‡ï¼Œä¼ å…¥ä¸€ä¸ªIntå˜é‡åœ°å€ï¼Œä¼šè‡ªåŠ¨ç»™è¿™ä¸ªå˜é‡èµ‹å€¼)
      è¿”å›å€¼Ivar * =
        æŒ‡çš„æ˜¯ä¸€ä¸ªivaræ•°ç»„ï¼Œä¼šæŠŠæ‰€æœ‰æˆå‘˜å±æ€§æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œé€šè¿‡è¿”å›çš„æ•°ç»„å°±èƒ½å…¨éƒ¨è·å–åˆ°
     */
    // æˆå‘˜å˜é‡ä¸ªæ•°
    unsigned int count = 0;
    // è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡
    Ivar *ivarList = class_copyIvarList(self, &amp;amp;count);

    // éå†æ‰€æœ‰æˆå‘˜å˜é‡
    for (int i = 0; i &amp;lt; count; i++) {
        // æ ¹æ®è§’æ ‡ï¼Œä»æ•°ç»„å–å‡ºå¯¹åº”çš„æˆå‘˜å˜é‡ï¼ˆIvarï¼šæˆå‘˜å˜é‡,ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰
        Ivar ivar = ivarList[i];
        
        // è·å–æˆå‘˜å˜é‡åå­—
        NSString *ivarName = [NSString stringWithUTF8String:ivar_getName(ivar)];
        
        // å¤„ç†æˆå‘˜å˜é‡åï¼Œå­—å…¸ä¸­çš„key(å»æ‰ _ ,ä»ç¬¬ä¸€ä¸ªè§’æ ‡å¼€å§‹æˆªå–)
        NSString *key = [ivarName substringFromIndex:1];
        
        // æ ¹æ®æˆå‘˜å±æ€§åå»å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„value
        id value = dict[key];
        
        //ã€å¦‚æœæ¨¡å‹å±æ€§æ•°é‡å¤§äºå­—å…¸é”®å€¼å¯¹æ•°ç†ï¼Œæ¨¡å‹å±æ€§ä¼šè¢«èµ‹å€¼ä¸ºnilã€‘
        // è€ŒæŠ¥é”™ (could not set nil as the value for the key age.)
        if (value) {
            // ç»™æ¨¡å‹ä¸­å±æ€§èµ‹å€¼
            [objc setValue:value forKey:key];
        }
    }
    return objc;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;ï¼š&lt;br/&gt;è¿™é‡Œåœ¨è·å–æ¨¡å‹ç±»ä¸­çš„æ‰€æœ‰å±æ€§åï¼Œæ˜¯é‡‡å– &lt;code&gt;class_copyIvarList&lt;/code&gt; å…ˆè·å–æˆå‘˜å˜é‡ï¼ˆ&lt;code&gt;ä»¥ä¸‹åˆ’çº¿å¼€å¤´&lt;/code&gt;ï¼‰ ï¼Œç„¶åå†å¤„ç†æˆå‘˜å˜é‡åï¼Œå­—å…¸ä¸­çš„key(&lt;code&gt;å»æ‰ _ ,ä»ç¬¬ä¸€ä¸ªè§’æ ‡å¼€å§‹æˆªå–&lt;/code&gt;) å¾—åˆ°å±æ€§åã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸå› &lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;{
    int _a; // æˆå‘˜å˜é‡
}
@property (nonatomic, assign) NSInteger attitudes_count; // å±æ€§

`Ivarï¼šæˆå‘˜å˜é‡ï¼Œä»¥ä¸‹åˆ’çº¿å¼€å¤´`ï¼Œ
`Property å±æ€§`
`class_copyPropertyList` è·å–ç±»é‡Œé¢å±æ€§ 
`class_copyIvarList` è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡ 
è¿™é‡Œæœ‰æˆå‘˜å˜é‡ï¼Œå°±ä¸ä¼šæ¼æ‰å±æ€§ï¼›å¦‚æœæœ‰å±æ€§ï¼Œå¯èƒ½ä¼šæ¼æ‰æˆå‘˜å˜é‡ï¼›
ä½¿ç”¨`runtime`å­—å…¸è½¬æ¨¡å‹è·å–æ¨¡å‹å±æ€§åçš„æ—¶å€™ï¼Œæœ€å¥½è·å–æˆå‘˜å±æ€§å`Ivar`å› ä¸ºå¯èƒ½ä¼šæœ‰ä¸ªå±æ€§æ˜¯æ²¡æœ‰`setter`å’Œ`getter`æ–¹æ³•çš„ã€‚&lt;/code&gt;
&lt;/pre&gt;
&lt;h6 id=&quot;runtime-å­—å…¸è½¬æ¨¡å‹--æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹æ¨¡å‹å±æ€§æ˜¯å¦å¤–ä¸€ä¸ªæ¨¡å‹å¯¹è±¡è¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹&quot;&gt;2ã€runtime å­—å…¸è½¬æ¨¡å‹--&amp;gt;æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹ã€Œæ¨¡å‹å±æ€§æ˜¯å¦å¤–ä¸€ä¸ªæ¨¡å‹å¯¹è±¡ã€ï¼Œè¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹ï¼š&lt;/h6&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;// æ€è·¯ï¼šåˆ©ç”¨runtime éå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§ï¼Œæ ¹æ®æ¨¡å‹ä¸­å±æ€§,å»å­—å…¸ä¸­å–å‡ºå¯¹åº”çš„valueç»™æ¨¡å‹å±æ€§èµ‹å€¼
+ (instancetype)modelWithDict2:(NSDictionary *)dict
{
    // 1.åˆ›å»ºå¯¹åº”çš„å¯¹è±¡
    id objc = [[self alloc] init];
    
    // 2.åˆ©ç”¨runtimeç»™å¯¹è±¡ä¸­çš„å±æ€§èµ‹å€¼
    // æˆå‘˜å˜é‡ä¸ªæ•°
    unsigned int count = 0;
    // è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡
    Ivar *ivarList = class_copyIvarList(self, &amp;amp;count);
    
    // éå†æ‰€æœ‰æˆå‘˜å˜é‡
    for (int i = 0; i &amp;lt; count; i++) {
        // æ ¹æ®è§’æ ‡ï¼Œä»æ•°ç»„å–å‡ºå¯¹åº”çš„æˆå‘˜å˜é‡ï¼ˆIvarï¼šæˆå‘˜å˜é‡,ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰
        Ivar ivar = ivarList[i];
        
        // è·å–æˆå‘˜å˜é‡åå­—
        NSString *ivarName = [NSString stringWithUTF8String:ivar_getName(ivar)];
        // è·å–æˆå‘˜å˜é‡ç±»å‹
        NSString *ivarType = [NSString stringWithUTF8String:ivar_getTypeEncoding(ivar)];
        
        // æ›¿æ¢: @\&quot;User\&quot; -&amp;gt; User
        ivarType = [ivarType stringByReplacingOccurrencesOfString:@&quot;\&quot;&quot; withString:@&quot;&quot;];
        ivarType = [ivarType stringByReplacingOccurrencesOfString:@&quot;@&quot; withString:@&quot;&quot;];
        
        // å¤„ç†æˆå‘˜å˜é‡å-&amp;gt;å­—å…¸ä¸­çš„key(å»æ‰ _ ,ä»ç¬¬ä¸€ä¸ªè§’æ ‡å¼€å§‹æˆªå–)
        NSString *key = [ivarName substringFromIndex:1];
        
        // æ ¹æ®æˆå‘˜å±æ€§åå»å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„value
        id value = dict[key];
        
        // äºŒçº§è½¬æ¢ï¼šå¦‚æœå­—å…¸ä¸­è¿˜æœ‰å­—å…¸ï¼Œä¹Ÿéœ€è¦æŠŠå¯¹åº”çš„å­—å…¸è½¬æ¢æˆæ¨¡å‹
        // åˆ¤æ–­ä¸‹valueæ˜¯å¦æ˜¯å­—å…¸,å¹¶ä¸”æ˜¯è‡ªå®šä¹‰å¯¹è±¡æ‰éœ€è¦è½¬æ¢
        if ([value isKindOfClass:[NSDictionary class]] &amp;amp;&amp;amp; ![ivarType hasPrefix:@&quot;NS&quot;]) {
            
            // å­—å…¸è½¬æ¢æˆæ¨¡å‹ userDict =&amp;gt; Useræ¨¡å‹, è½¬æ¢æˆå“ªä¸ªæ¨¡å‹
            // æ ¹æ®å­—ç¬¦ä¸²ç±»åç”Ÿæˆç±»å¯¹è±¡
            Class modelClass = NSClassFromString(ivarType);
            
            if (modelClass) { // æœ‰å¯¹åº”çš„æ¨¡å‹æ‰éœ€è¦è½¬
                // æŠŠå­—å…¸è½¬æ¨¡å‹
                value = [modelClass modelWithDict2:value];
            }
        }
        
        // ç»™æ¨¡å‹ä¸­å±æ€§èµ‹å€¼
        if (value) {
            [objc setValue:value forKey:key];
        }
    }
    return objc;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h6 id=&quot;runtime-å­—å…¸è½¬æ¨¡å‹--æ•°ç»„ä¸­è£…ç€æ¨¡å‹æ¨¡å‹çš„å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„æ•°ç»„ä¸­æ˜¯å­—å…¸æ¨¡å‹å¯¹è±¡è¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹&quot;&gt;3ã€runtime å­—å…¸è½¬æ¨¡å‹--&amp;gt;æ•°ç»„ä¸­è£…ç€æ¨¡å‹ã€Œæ¨¡å‹çš„å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ˜¯å­—å…¸æ¨¡å‹å¯¹è±¡ã€ï¼Œè¿™ç§æƒ…å†µå¤„ç†å¦‚ä¸‹ï¼š&lt;/h6&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;// æ€è·¯ï¼šåˆ©ç”¨runtime éå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§ï¼Œæ ¹æ®æ¨¡å‹ä¸­å±æ€§,å»å­—å…¸ä¸­å–å‡ºå¯¹åº”çš„valueç»™æ¨¡å‹å±æ€§èµ‹å€¼
+ (instancetype)modelWithDict3:(NSDictionary *)dict
{
    // 1.åˆ›å»ºå¯¹åº”çš„å¯¹è±¡
    id objc = [[self alloc] init];
    
    // 2.åˆ©ç”¨runtimeç»™å¯¹è±¡ä¸­çš„å±æ€§èµ‹å€¼
    // æˆå‘˜å˜é‡ä¸ªæ•°
    unsigned int count = 0;
    // è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡
    Ivar *ivarList = class_copyIvarList(self, &amp;amp;count);
    
    // éå†æ‰€æœ‰æˆå‘˜å˜é‡
    for (int i = 0; i &amp;lt; count; i++) {
        // æ ¹æ®è§’æ ‡ï¼Œä»æ•°ç»„å–å‡ºå¯¹åº”çš„æˆå‘˜å˜é‡ï¼ˆIvarï¼šæˆå‘˜å˜é‡,ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰
        Ivar ivar = ivarList[i];
        
        // è·å–æˆå‘˜å˜é‡åå­—
        NSString *ivarName = [NSString stringWithUTF8String:ivar_getName(ivar)];
        
        // å¤„ç†æˆå‘˜å±æ€§å-&amp;gt;å­—å…¸ä¸­çš„key(å»æ‰ _ ,ä»ç¬¬ä¸€ä¸ªè§’æ ‡å¼€å§‹æˆªå–)
        NSString *key = [ivarName substringFromIndex:1];
        
        // æ ¹æ®æˆå‘˜å±æ€§åå»å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„value
        id value = dict[key];
        
        
        //--------------------------- &amp;lt;#æˆ‘æ˜¯åˆ†å‰²çº¿#&amp;gt; ------------------------------//
        //
        
        // ä¸‰çº§è½¬æ¢ï¼šNSArrayä¸­ä¹Ÿæ˜¯å­—å…¸ï¼ŒæŠŠæ•°ç»„ä¸­çš„å­—å…¸è½¬æ¢æˆæ¨¡å‹.
        // åˆ¤æ–­å€¼æ˜¯å¦æ˜¯æ•°ç»„
        if ([value isKindOfClass:[NSArray class]]) {
            // åˆ¤æ–­å¯¹åº”ç±»æœ‰æ²¡æœ‰å®ç°å­—å…¸æ•°ç»„è½¬æ¨¡å‹æ•°ç»„çš„åè®®
            // arrayContainModelClass æä¾›ä¸€ä¸ªåè®®ï¼Œåªè¦éµå®ˆè¿™ä¸ªåè®®çš„ç±»ï¼Œéƒ½èƒ½æŠŠæ•°ç»„ä¸­çš„å­—å…¸è½¬æ¨¡å‹
            if ([self respondsToSelector:@selector(arrayContainModelClass)]) {
                
                // è½¬æ¢æˆidç±»å‹ï¼Œå°±èƒ½è°ƒç”¨ä»»ä½•å¯¹è±¡çš„æ–¹æ³•
                id idSelf = self;
                
                // è·å–æ•°ç»„ä¸­å­—å…¸å¯¹åº”çš„æ¨¡å‹
                NSString *type =  [idSelf arrayContainModelClass][key];
                
                // ç”Ÿæˆæ¨¡å‹
                Class classModel = NSClassFromString(type);
                NSMutableArray *arrM = [NSMutableArray array];
                // éå†å­—å…¸æ•°ç»„ï¼Œç”Ÿæˆæ¨¡å‹æ•°ç»„
                for (NSDictionary *dict in value) {
                    // å­—å…¸è½¬æ¨¡å‹
                    id model =  [classModel modelWithDict3:dict];
                    [arrM addObject:model];
                }
                
                // æŠŠæ¨¡å‹æ•°ç»„èµ‹å€¼ç»™value
                value = arrM;     
            }
        }
        
        // å¦‚æœæ¨¡å‹å±æ€§æ•°é‡å¤§äºå­—å…¸é”®å€¼å¯¹æ•°ç†ï¼Œæ¨¡å‹å±æ€§ä¼šè¢«èµ‹å€¼ä¸ºnil,è€ŒæŠ¥é”™
        if (value) {
            // ç»™æ¨¡å‹ä¸­å±æ€§èµ‹å€¼
            [objc setValue:value forKey:key];
        }
    }
    return objc;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2230763-339901c56acf905a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼š&lt;br/&gt;æˆ‘ä»¬æ—¢ç„¶èƒ½è·å–åˆ°å±æ€§ç±»å‹ï¼Œé‚£å°±å¯ä»¥æ‹¦æˆªåˆ°æ¨¡å‹çš„é‚£ä¸ªæ•°ç»„å±æ€§ï¼Œè¿›è€Œå¯¹æ•°ç»„ä¸­æ¯ä¸ªæ¨¡å‹éå†å¹¶å­—å…¸è½¬æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æ•°ç»„ä¸­çš„æ¨¡å‹éƒ½æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç›®çš„ä¸æ˜¯è®©å…¶è°ƒç”¨ï¼Œè€Œæ˜¯è®©å…¶å®ç°å¹¶è¿”å›æ¨¡å‹çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæåˆ°çš„ä½ å¦‚æœä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå»ºè®®å‚è€ƒæˆ‘çš„Demoï¼Œé‡è¦çš„éƒ¨åˆ†ä»£ç ä¸­éƒ½æœ‰ç›¸åº”çš„æ³¨è§£å’Œæ–‡å­—æ‰“å°ï¼Œè¿è¡Œç¨‹åºå¯ä»¥å¾ˆç›´è§‚çš„è¡¨ç°ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å…¶å®ƒä½œç”¨é¢è¯•ç†Ÿæ‚‰&quot;&gt;å…¶å®ƒä½œç”¨ã€Œé¢è¯•ç†Ÿæ‚‰ã€&lt;/h4&gt;
&lt;hr/&gt;&lt;h5 id=&quot;åŠ¨æ€æ·»åŠ æ–¹æ³•&quot;&gt;åŠ¨æ€æ·»åŠ æ–¹æ³•&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šå¦‚æœä¸€ä¸ªç±»æ–¹æ³•éå¸¸å¤šï¼ŒåŠ è½½ç±»åˆ°å†…å­˜çš„æ—¶å€™ä¹Ÿæ¯”è¾ƒè€—è´¹èµ„æºï¼Œéœ€è¦ç»™æ¯ä¸ªæ–¹æ³•ç”Ÿæˆæ˜ å°„è¡¨ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€ç»™æŸä¸ªç±»ï¼Œæ·»åŠ æ–¹æ³•è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;ï¼šOC ä¸­æˆ‘ä»¬å¾ˆä¹ æƒ¯çš„ä¼šç”¨æ‡’åŠ è½½ï¼Œå½“ç”¨åˆ°çš„æ—¶å€™æ‰å»åŠ è½½å®ƒï¼Œä½†æ˜¯å®é™…ä¸Šåªè¦ä¸€ä¸ªç±»å®ç°äº†æŸä¸ªæ–¹æ³•ï¼Œå°±ä¼šè¢«åŠ è½½è¿›å†…å­˜ã€‚å½“æˆ‘ä»¬ä¸æƒ³åŠ è½½è¿™ä¹ˆå¤šæ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šä½¿ç”¨åˆ° &lt;code&gt;runtime&lt;/code&gt; åŠ¨æ€çš„æ·»åŠ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;éœ€æ±‚&lt;/strong&gt;ï¼šruntime åŠ¨æ€æ·»åŠ æ–¹æ³•å¤„ç†è°ƒç”¨ä¸€ä¸ªæœªå®ç°çš„æ–¹æ³• å’Œ å»é™¤æŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœºæ™¯ä»£ç &lt;/strong&gt;ï¼šæ–¹æ³•+è°ƒç”¨+æ‰“å°è¾“å‡º&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &quot;Person.h&quot;
#import &amp;lt;objc/message.h&amp;gt;

@implementation Person

/**
 è°ƒç”¨ï¼šåªè¦ä¸€ä¸ªå¯¹è±¡è°ƒç”¨äº†ä¸€ä¸ªæœªå®ç°çš„æ–¹æ³•å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•,è¿›è¡Œå¤„ç†
 ä½œç”¨ï¼šåŠ¨æ€æ·»åŠ æ–¹æ³•,å¤„ç†æœªå®ç°
 æ³¨è§£ï¼šä»»ä½•æ–¹æ³•é»˜è®¤éƒ½æœ‰ä¸¤ä¸ªéšå¼å‚æ•°,self,_cmdï¼ˆå½“å‰æ–¹æ³•çš„æ–¹æ³•ç¼–å·ï¼‰
 */
+ (BOOL)resolveInstanceMethod:(SEL)sel {
    
    if (sel == NSSelectorFromString(@&quot;roll:&quot;)) {
        /**
         class_addMethod(&amp;lt;#Class  _Nullable __unsafe_unretained cls#&amp;gt;ï¼šç»™å“ªä¸ªç±»æ·»åŠ æ–¹æ³•, &amp;lt;#SEL  _Nonnull name#&amp;gt;ï¼šæ·»åŠ å“ªä¸ªæ–¹æ³•ï¼Œå³æ·»åŠ æ–¹æ³•çš„æ–¹æ³•ç¼–å·, &amp;lt;#IMP  _Nonnull imp#&amp;gt;ï¼šæ–¹æ³•å®ç° =&amp;gt; å‡½æ•° =&amp;gt; å‡½æ•°å…¥å£ =&amp;gt; å‡½æ•°åï¼ˆæ·»åŠ æ–¹æ³•çš„å‡½æ•°å®ç°ï¼ˆå‡½æ•°åœ°å€ï¼‰ï¼‰, &amp;lt;#const char * _Nullable types#&amp;gt;ï¼šæ–¹æ³•ç±»å‹ï¼Œ(è¿”å›å€¼+å‚æ•°ç±»å‹) v:void @:å¯¹è±¡-&amp;gt;self :è¡¨ç¤ºSEL-&amp;gt;_cmd)
         */
        // ç»™ç±»æ·»åŠ roll:æ»šäº†å¤šè¿œæ–¹æ³•
        class_addMethod(self, sel, (IMP)LNRoll, &quot;v@:@&quot;);
        
        return YES;
    }
    
    if ([NSStringFromSelector(sel) isEqualToString:@&quot;go:&quot;]) {
        // ç»™ç±»æ·»åŠ go:èµ°äº†å¤šè¿œæ–¹æ³•
        class_addMethod(self, sel, (IMP)LNGO, &quot;v@:@&quot;);
        return YES;
    }
    
    return [super resolveInstanceMethod:sel];
}

// è°ƒç”¨
Person *p = [[Person alloc] init];
// æ‰§è¡ŒæŸä¸ªæ–¹æ³•
[p performSelector:@selector(roll:) withObject:@&quot;11&quot;];
[p performSelector:@selector(go:) withObject:@10];

// æ‰“å°è¾“å‡º
2016-03-17 19:05:03.917 runtime[12761:543574] æˆ‘æ»šäº† 11 ç±³è¿œçš„å±è›‹
2016-03-17 19:05:04.617 runtime[12761:543574] æˆ‘èµ°äº† 10 å…¬é‡Œæ‰åˆ°çš„å®¶ &lt;/code&gt;
&lt;/pre&gt;
&lt;hr/&gt;&lt;h5 id=&quot;å®ç°nscodingçš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£&quot;&gt;å®ç°NSCodingçš„è‡ªåŠ¨å½’æ¡£å’Œè§£æ¡£&lt;/h5&gt;
&lt;p&gt;å¦‚æœä½ å®ç°è¿‡è‡ªå®šä¹‰æ¨¡å‹æ•°æ®æŒä¹…åŒ–çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆä½ ä¹Ÿè‚¯å®šæ˜ç™½ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å‹æœ‰è®¸å¤šä¸ªå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå±æ€§éƒ½å®ç°ä¸€é&lt;code&gt;encodeObject&lt;/code&gt; å’Œ &lt;code&gt;decodeObjectForKey&lt;/code&gt;æ–¹æ³•ï¼Œå¦‚æœè¿™æ ·çš„æ¨¡å‹åˆæœ‰å¾ˆå¤šä¸ªï¼Œè¿™è¿˜çœŸçš„æ˜¯ä¸€ä¸ªååˆ†éº»çƒ¦çš„äº‹æƒ…ã€‚ä¸‹é¢æ¥çœ‹çœ‹ç®€å•çš„å®ç°æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª&lt;code&gt;Movie&lt;/code&gt;ç±»ï¼Œæœ‰3ä¸ªå±æ€§ã€‚å…ˆçœ‹ä¸‹ .hæ–‡ä»¶&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;// Movie.hæ–‡ä»¶
//1. å¦‚æœæƒ³è¦å½“å‰ç±»å¯ä»¥å®ç°å½’æ¡£ä¸åå½’æ¡£ï¼Œéœ€è¦éµå®ˆä¸€ä¸ªåè®®NSCoding
@interface Movie : NSObject&amp;lt;NSCoding&amp;gt;

@property (nonatomic, copy) NSString *movieId;
@property (nonatomic, copy) NSString *movieName;
@property (nonatomic, copy) NSString *pic_url;
@end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ˜¯æ­£å¸¸å†™æ³•ï¼Œ.m æ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;// Movie.mæ–‡ä»¶
@implementation Movie

- (void)encodeWithCoder:(NSCoder *)aCoder
{
    [aCoder encodeObject:_movieId forKey:@&quot;id&quot;];
    [aCoder encodeObject:_movieName forKey:@&quot;name&quot;];
    [aCoder encodeObject:_pic_url forKey:@&quot;url&quot;];

}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    if (self = [super init]) {
        self.movieId = [aDecoder decodeObjectForKey:@&quot;id&quot;];
        self.movieName = [aDecoder decodeObjectForKey:@&quot;name&quot;];
        self.pic_url = [aDecoder decodeObjectForKey:@&quot;url&quot;];
    }
    return self;
}
@end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¿™é‡Œæœ‰100ä¸ªå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿåªèƒ½æŠŠ100ä¸ªå±æ€§éƒ½ç»™å†™ä¸€éå—ã€‚&lt;br/&gt;ä¸è¿‡ä½ ä¼šä½¿ç”¨&lt;code&gt;runtime&lt;/code&gt;åï¼Œè¿™é‡Œå°±æœ‰æ›´ç®€ä¾¿çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &quot;Movie.h&quot;
#import &amp;lt;objc/runtime.h&amp;gt;
@implementation Movie

- (void)encodeWithCoder:(NSCoder *)encoder

{
    unsigned int count = 0;
    Ivar *ivars = class_copyIvarList([Movie class], &amp;amp;count);

    for (int i = 0; i&amp;lt;count; i++) {
        // å–å‡ºiä½ç½®å¯¹åº”çš„æˆå‘˜å˜é‡
        Ivar ivar = ivars[i];
        // æŸ¥çœ‹æˆå‘˜å˜é‡
        const char *name = ivar_getName(ivar);
        // å½’æ¡£
        NSString *key = [NSString stringWithUTF8String:name];
        id value = [self valueForKey:key];
        [encoder encodeObject:value forKey:key];
    }
    free(ivars);
}

- (id)initWithCoder:(NSCoder *)decoder
{
    if (self = [super init]) {
        unsigned int count = 0;
        Ivar *ivars = class_copyIvarList([Movie class], &amp;amp;count);
        for (int i = 0; i&amp;lt;count; i++) {
        // å–å‡ºiä½ç½®å¯¹åº”çš„æˆå‘˜å˜é‡
        Ivar ivar = ivars[i];
        // æŸ¥çœ‹æˆå‘˜å˜é‡
        const char *name = ivar_getName(ivar);
       // å½’æ¡£
       NSString *key = [NSString stringWithUTF8String:name];
      id value = [decoder decodeObjectForKey:key];
       // è®¾ç½®åˆ°æˆå‘˜å˜é‡èº«ä¸Š
        [self setValue:value forKey:key];

        }
        free(ivars);
    } 
    return self;
}
@end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ ·çš„æ–¹å¼å®ç°ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªå±æ€§ï¼Œå†™è¿™å‡ è¡Œä»£ç å°±æå®šäº†ã€‚&lt;br/&gt;ä¸‹é¢çœ‹çœ‹æ›´åŠ ç®€ä¾¿çš„æ–¹æ³•ï¼šä¸¤å¥ä»£ç æå®šã€‚&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#import &quot;Movie.h&quot;
#import &amp;lt;objc/runtime.h&amp;gt;

#define encodeRuntime(A) \
\
unsigned int count = 0;\
Ivar *ivars = class_copyIvarList([A class], &amp;amp;count);\
for (int i = 0; i&amp;lt;count; i++) {\
Ivar ivar = ivars[i];\
const char *name = ivar_getName(ivar);\
NSString *key = [NSString stringWithUTF8String:name];\
id value = [self valueForKey:key];\
[encoder encodeObject:value forKey:key];\
}\
free(ivars);\
\

#define initCoderRuntime(A) \
\
if (self = [super init]) {\
unsigned int count = 0;\
Ivar *ivars = class_copyIvarList([A class], &amp;amp;count);\
for (int i = 0; i&amp;lt;count; i++) {\
Ivar ivar = ivars[i];\
const char *name = ivar_getName(ivar);\
NSString *key = [NSString stringWithUTF8String:name];\
id value = [decoder decodeObjectForKey:key];\
[self setValue:value forKey:key];\
}\
free(ivars);\
}\
return self;\
\

- - -
@implementation Movie
- (void)encodeWithCoder:(NSCoder *)encoder {
    encodeRuntime(Movie)
}

- (id)initWithCoder:(NSCoder *)decoder {
    initCoderRuntime(Movie)
}
@end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜åŒ–&lt;/strong&gt;ï¼š&lt;br/&gt;ä¸Šé¢æ˜¯&lt;code&gt;encodeWithCoder&lt;/code&gt; å’Œ &lt;code&gt;initWithCoder&lt;/code&gt;è¿™ä¸¤ä¸ªæ–¹æ³•æŠ½æˆå®ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ä¸ªå®å•ç‹¬æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè¿™é‡Œä»¥åéœ€è¦è¿›è¡Œæ•°æ®æŒä¹…åŒ–çš„æ¨¡å‹éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªå®ã€‚&lt;/p&gt;
&lt;h5 id=&quot;runtime-ä¸‹classçš„å„é¡¹æ“ä½œ&quot;&gt;runtime ä¸‹Classçš„å„é¡¹æ“ä½œ&lt;/h5&gt;
&lt;p&gt;&lt;strong&gt;1.runtime éƒ¨åˆ†å‡½æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;#warning - ä»¥ä¸‹ä¸ºåŠŸèƒ½æ¨¡å—ç›¸å…³çš„æ–¹æ³•ç¤ºä¾‹, å…·ä½“æ–¹æ³•ä½œç”¨ã€ä½¿ç”¨ã€æ³¨è§£è¯·ç§»æ­¥ -&amp;gt; github.com/CoderLN
ä»¥ä¸‹çš„è¿™äº›æ–¹æ³•åº”è¯¥ç®—æ˜¯`runtime`åœ¨å®é™…åœºæ™¯ä¸­æ‰€åº”ç”¨çš„å¤§éƒ¨åˆ†çš„æƒ…å†µäº†ï¼Œå¹³å¸¸çš„ç¼–ç ä¸­å·®ä¸å¤šè¶³å¤Ÿç”¨äº†ã€‚

 0ã€class_copyPropertyList è·å–ç±»ä¸­æ‰€æœ‰çš„å±æ€§
        objc_property_t *propertyList = class_copyPropertyList([self class], &amp;amp;count);
        for (unsigned int i=0; i&amp;lt;count; i++) {
            const char *propertyName = property_getName(propertyList[i]);
            NSLog(@&quot;property----&amp;gt;%@&quot;, [NSString stringWithUTF8String:propertyName]);
        }

 0ã€class_copyMethodList è·å–ç±»çš„æ‰€æœ‰æ–¹æ³•
        Method *methodList = class_copyMethodList([self class], &amp;amp;count);
        for (unsigned int i; i&amp;lt;count; i++) {
            Method method = methodList[i];
            NSLog(@&quot;method----&amp;gt;%@&quot;, NSStringFromSelector(method_getName(method)));
        }

 0ã€class_copyIvarList è·å–ç±»ä¸­æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼ˆoutCount ä¼šè¿”å›æˆå‘˜å˜é‡çš„æ€»æ•°ï¼‰
        Ivar *ivarList = class_copyIvarList([self class], &amp;amp;count);
        for (unsigned int i; i&amp;lt;count; i++) {
            Ivar myIvar = ivarList[i];
            const char *ivarName = ivar_getName(myIvar);
            NSLog(@&quot;Ivar----&amp;gt;%@&quot;, [NSString stringWithUTF8String:ivarName]);
        }
 
 0ã€class_copyProtocolList è·å–åè®®åˆ—è¡¨
    __unsafe_unretained Protocol **protocolList = class_copyProtocolList([self class], &amp;amp;count);
    for (unsigned int i; i&amp;lt;count; i++) {
        Protocol *myProtocal = protocolList[i];
        const char *protocolName = protocol_getName(myProtocal);
        NSLog(@&quot;protocol----&amp;gt;%@&quot;, [NSString stringWithUTF8String:protocolName]);
    }
 
 0ã€object_getClass è·å¾—ç±»æ–¹æ³•
        Class PersonClass = object_getClass([Person class]);
        SEL oriSEL = @selector(test1);
        Method oriMethod = _class_getMethod(xiaomingClass, oriSEL);
 
 0ã€class_getInstanceMethod è·å¾—å®ä¾‹æ–¹æ³•
        Class PersonClass = object_getClass([xiaoming class]);
        SEL oriSEL = @selector(test2);
        Method cusMethod = class_getInstanceMethod(xiaomingClass, oriSEL);
 
 0ã€class_addMethod åŠ¨æ€æ·»åŠ æ–¹æ³•
        BOOL addSucc = class_addMethod(xiaomingClass, oriSEL, method_getImplementation(cusMethod), method_getTypeEncoding(cusMethod));
 
 0ã€class_replaceMethod æ›¿æ¢åŸæ–¹æ³•å®ç°
        class_replaceMethod(toolClass, cusSEL, method_getImplementation(oriMethod), method_getTypeEncoding(oriMethod));
 
 0ã€method_exchangeImplementations äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°
        method_exchangeImplementations(method1, method2);

 0ã€æ ¹æ®åå­—å¾—åˆ°ç±»å˜é‡çš„IvaræŒ‡é’ˆï¼Œä½†æ˜¯è¿™ä¸ªåœ¨OCä¸­å¥½åƒæ¯«æ— æ„ä¹‰
    Ivar oneCVIvar = class_getClassVariable([Person class], name);

 0ã€æ ¹æ®åå­—å¾—åˆ°å®ä¾‹å˜é‡çš„IvaræŒ‡é’ˆ
    Ivar oneIVIvar = class_getInstanceVariable([Person class], name);

 0ã€æ‰¾åˆ°åå¯ä»¥ç›´æ¥å¯¹ç§æœ‰æˆå‘˜å˜é‡èµ‹å€¼ï¼ˆå¼ºåˆ¶ä¿®æ”¹nameå±æ€§ï¼‰
    object_setIvar(_per, oneIVIvar, @&quot;age&quot;);


 0ã€åŠ¨æ€æ·»åŠ æ–¹æ³•
    class_addMethod([person class]ï¼šClass cls ç±»å‹, @selector(eat)ï¼šå¾…è°ƒç”¨çš„æ–¹æ³•åç§°, (IMP)myAddingFunctionï¼š(IMP)myAddingFunctionï¼ŒIMPæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œè¿™é‡Œè¡¨ç¤ºæŒ‡å®šå…·ä½“å®ç°æ–¹æ³•myAddingFunction, 0ï¼š0ä»£è¡¨æ²¡æœ‰å‚æ•°);

 0ã€è·å¾—æŸä¸ªç±»çš„ç±»æ–¹æ³•
    Method class_getClassMethod(Class cls , SEL name)

 0ã€è·å¾—æˆå‘˜å˜é‡çš„åå­—
    const char *ivar_getName(Ivar v);

 0ã€å°†æŸä¸ªå€¼è·ŸæŸä¸ªå¯¹è±¡å…³è”èµ·æ¥ï¼Œå°†æŸä¸ªå€¼å­˜å‚¨åˆ°æŸä¸ªå¯¹è±¡ä¸­
    void objc_setAssociatedObject(id objectï¼šè¡¨ç¤ºå…³è”è€…ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå˜é‡åç†æ‰€å½“ç„¶ä¹Ÿæ˜¯object , const void *keyï¼šè·å–è¢«å…³è”è€…çš„ç´¢å¼•key ,id value ï¼šè¢«å…³è”è€… ,objc_AssociationPolicy policyï¼šå…³è”æ—¶é‡‡ç”¨çš„åè®®ï¼Œæœ‰assignï¼Œretainï¼Œcopyç­‰åè®®ï¼Œä¸€èˆ¬ä½¿ç”¨OBJC_ASSOCIATION_RETAIN_NONATOMIC)

 0ã€åˆ©ç”¨å‚æ•°key å°†å¯¹è±¡objectä¸­å­˜å‚¨çš„å¯¹åº”å€¼å–å‡ºæ¥
    id objc_getAssociatedObject(id object , const void *key)
 */&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;method-swizzlingä¿—ç§°é»‘é­”æ³•&quot;&gt;method swizzlingï¼ˆä¿—ç§°é»‘é­”æ³•ï¼‰&lt;/h4&gt;
&lt;hr/&gt;&lt;ul&gt;&lt;li&gt;ç®€å•è¯´å°±æ˜¯è¿›è¡Œæ–¹æ³•äº¤æ¢&lt;/li&gt;
&lt;li&gt;åœ¨&lt;code&gt;Objective-C&lt;/code&gt;ä¸­è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œå…¶å®æ˜¯å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯ï¼ŒæŸ¥æ‰¾æ¶ˆæ¯çš„å”¯ä¸€ä¾æ®æ˜¯&lt;code&gt;selector&lt;/code&gt;çš„åå­—ã€‚åˆ©ç”¨&lt;code&gt;Objective-C&lt;/code&gt;çš„åŠ¨æ€ç‰¹æ€§ï¼Œå¯ä»¥å®ç°åœ¨è¿è¡Œæ—¶å·æ¢&lt;code&gt;selector&lt;/code&gt;å¯¹åº”çš„æ–¹æ³•å®ç°ï¼Œè¾¾åˆ°ç»™æ–¹æ³•æŒ‚é’©çš„ç›®çš„&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•åˆ—è¡¨ï¼Œå­˜æ”¾ç€æ–¹æ³•çš„åå­—å’Œæ–¹æ³•å®ç°çš„æ˜ å°„å…³ç³»ï¼Œ&lt;code&gt;selector&lt;/code&gt;çš„æœ¬è´¨å…¶å®å°±æ˜¯æ–¹æ³•åï¼Œ&lt;code&gt;IMP&lt;/code&gt;æœ‰ç‚¹ç±»ä¼¼å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å…·ä½“çš„&lt;code&gt;Method&lt;/code&gt;å®ç°ï¼Œé€šè¿‡&lt;code&gt;selector&lt;/code&gt;å°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„&lt;code&gt;IMP&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2230763-6a0a0fbe675edfba.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;selector --&amp;gt; å¯¹åº”çš„IMP&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;äº¤æ¢æ–¹æ³•çš„å‡ ç§å®ç°æ–¹å¼
&lt;ul&gt;&lt;li&gt;åˆ©ç”¨ &lt;code&gt;method_exchangeImplementations&lt;/code&gt; äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨ &lt;code&gt;class_replaceMethod&lt;/code&gt; æ›¿æ¢æ–¹æ³•çš„å®ç°&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨ &lt;code&gt;method_setImplementation&lt;/code&gt; æ¥ç›´æ¥è®¾ç½®æŸä¸ªæ–¹æ³•çš„&lt;code&gt;IMP&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2230763-4324f35bfc814f69.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;äº¤æ¢æ–¹æ³•&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå¯ä»¥å‚è€ƒç®€å‹è¿™ç¯‡ï¼š&lt;a href=&quot;http://www.jianshu.com/p/f6dad8e1b848&quot;&gt;Runtime Method Swizzlingå¼€å‘å®ä¾‹æ±‡æ€»&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;ä¸€é“é¢è¯•é¢˜çš„æ³¨è§£&quot;&gt;ä¸€é“é¢è¯•é¢˜çš„æ³¨è§£&lt;/h4&gt;
&lt;hr/&gt;&lt;p&gt;&lt;strong&gt;ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ?&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;@implementation Son : NSObject
- (id)init
{
    self = [super init];
    if (self) {
        NSLog(@&quot;%@&quot;, NSStringFromClass([self class]));
        NSLog(@&quot;%@&quot;, NSStringFromClass([super class]));
    }
    return self;
}
@end&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…ˆæ€è€ƒä¸€ä¸‹ï¼Œä¼šæ‰“å°å‡ºæ¥ä»€ä¹ˆâ“&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;ç­”æ¡ˆï¼šéƒ½è¾“å‡º Son&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;class&lt;/code&gt; è·å–å½“å‰æ–¹æ³•çš„è°ƒç”¨è€…çš„ç±»ï¼Œ&lt;code&gt;superClass&lt;/code&gt; è·å–å½“å‰æ–¹æ³•çš„è°ƒç”¨è€…çš„çˆ¶ç±»ï¼Œ&lt;code&gt;super&lt;/code&gt; ä»…ä»…æ˜¯ä¸€ä¸ªç¼–è¯‘æŒ‡ç¤ºå™¨ï¼Œå°±æ˜¯ç»™ç¼–è¯‘å™¨çœ‹çš„ï¼Œä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;æœ¬è´¨ï¼šåªè¦ç¼–è¯‘å™¨çœ‹åˆ°&lt;code&gt;super&lt;/code&gt;è¿™ä¸ªæ ‡å¿—ï¼Œå°±ä¼šè®©å½“å‰å¯¹è±¡å»è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼Œæœ¬è´¨è¿˜æ˜¯å½“å‰å¯¹è±¡åœ¨è°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;è¿™ä¸ªé¢˜ç›®ä¸»è¦æ˜¯è€ƒå¯Ÿå…³äº&lt;code&gt;objc&lt;/code&gt;ä¸­å¯¹ &lt;code&gt;self&lt;/code&gt; å’Œ &lt;code&gt;super&lt;/code&gt; çš„ç†è§£ï¼š&lt;/p&gt;
&lt;ul readability=&quot;2&quot;&gt;&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;&lt;code&gt;self&lt;/code&gt; æ˜¯ç±»çš„éšè—å‚æ•°ï¼ŒæŒ‡å‘å½“å‰è°ƒç”¨æ–¹æ³•çš„è¿™ä¸ªç±»çš„å®ä¾‹ã€‚è€Œ &lt;code&gt;super&lt;/code&gt; æœ¬è´¨æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨æ ‡ç¤ºç¬¦ï¼Œå’Œ &lt;code&gt;self&lt;/code&gt; æ˜¯æŒ‡å‘çš„åŒä¸€ä¸ªæ¶ˆæ¯æ¥å—è€…&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;å½“ä½¿ç”¨ &lt;code&gt;self&lt;/code&gt; è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šä»å½“å‰ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¼€å§‹æ‰¾ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä»çˆ¶ç±»ä¸­å†æ‰¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;è€Œå½“ä½¿ç”¨ &lt;code&gt;super&lt;/code&gt;æ—¶ï¼Œåˆ™ä»çˆ¶ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¼€å§‹æ‰¾ã€‚ç„¶åè°ƒç”¨çˆ¶ç±»çš„è¿™ä¸ªæ–¹æ³•&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;è°ƒç”¨ &lt;code&gt;[self class]&lt;/code&gt; æ—¶ï¼Œä¼šè½¬åŒ–æˆ &lt;code&gt;objc_msgSend&lt;/code&gt; å‡½æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;objc&quot;&gt;
&lt;code&gt;id objc_msgSend(id self, SEL op, ...)
- è°ƒç”¨ `[super class]`æ—¶ï¼Œä¼šè½¬åŒ–æˆ `objc_msgSendSuper` å‡½æ•°.

id objc_msgSendSuper(struct objc_super *super, SEL op, ...)
ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ objc_super è¿™æ ·ä¸€ä¸ªç»“æ„ä½“ï¼Œå…¶å®šä¹‰å¦‚ä¸‹
 struct objc_super {
 __unsafe_unretained id receiver;
 __unsafe_unretained Class super_class;
 };

ç¬¬ä¸€ä¸ªæˆå‘˜æ˜¯ receiver, ç±»ä¼¼äºä¸Šé¢çš„ objc_msgSendå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°self
ç¬¬äºŒä¸ªæˆå‘˜æ˜¯è®°å½•å½“å‰ç±»çš„çˆ¶ç±»æ˜¯ä»€ä¹ˆï¼Œå‘Šè¯‰ç¨‹åºä»çˆ¶ç±»ä¸­å¼€å§‹æ‰¾æ–¹æ³•ï¼Œæ‰¾åˆ°æ–¹æ³•åï¼Œæœ€åå†…éƒ¨æ˜¯ä½¿ç”¨ objc_msgSend(objc_super-&amp;gt;receiver, @selector(class))å»è°ƒç”¨ï¼Œ æ­¤æ—¶å·²ç»å’Œ[self class]è°ƒç”¨ç›¸åŒäº†ï¼Œæ•…ä¸Šè¿°è¾“å‡ºç»“æœä»ç„¶è¿”å› Son

objc Runtime å¼€æºä»£ç å¯¹- (Class)classæ–¹æ³•çš„å®ç°
-(Class)class { return object_getClass(self); 
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h4 id=&quot;runtime-æ¨¡å—åšæ–‡æ¨è-æ•°é‡è¾ƒå¤š&quot;&gt;Runtime æ¨¡å—åšæ–‡æ¨è (â¤ï¸æ•°é‡è¾ƒå¤š)&lt;/h4&gt;
&lt;hr/&gt;&lt;table&gt;&lt;thead/&gt;&lt;tbody readability=&quot;7.4623824451411&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;1.7894736842105&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;è¥¿æœ¨&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å®Œæ•´æ€»ç»“ http://www.jianshu.com/p/6b905584f536&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;1.5454545454545&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;å¤©å£ä¸‰æ°´ç¾Š&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;objc_msgSend http://www.jianshu.com/p/9e1bc8d890f9&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;odd&quot; readability=&quot;1.5789473684211&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;å¤œåƒå¯»å¢¨&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;è¯¦è§£ http://www.jianshu.com/p/46dd81402f63&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;1.59375&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;è¢å³¥Seemygo&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å¿«é€Ÿä¸Šæ‰‹ http://www.jianshu.com/p/e071206103a4&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;odd&quot; readability=&quot;1.7142857142857&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;éƒ‘é’¦æ´ª_&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å®ç°è‡ªåŠ¨åŒ–å½’æ¡£ http://www.jianshu.com/p/bd24c3f3cd0a&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;1.672131147541&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;HenryCheng&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ¶ˆæ¯æœºåˆ¶ http://www.jianshu.com/p/f6300eb3ec3d&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;odd&quot; readability=&quot;1.5368421052632&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;å–æŠ¥çš„å°ç”»å®¶Sure&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Method Swizzlingå¼€å‘å®ä¾‹æ±‡æ€» http://www.jianshu.com/p/f6dad8e1b848&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;1.76&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;æ»•å¤§é¸Ÿ&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;OCæœ€å®ç”¨çš„runtimeæ€»ç»“ http://www.jianshu.com/p/ab966e8a82e2&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;odd&quot; readability=&quot;1.7176470588235&quot;&gt;&lt;td&gt;&lt;a href=&quot;http://www.cnblogs.com/Plainboiledwater/p/9678287.html&quot;&gt;é»‘èŠ±ç™½èŠ±&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Runtimeåœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ http://www.jianshu.com/p/851b21870d91&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h4 id=&quot;runtime-runloop-å¸¸é¢é—®é¢˜æ•´ç†é™„ç­”æ¡ˆ&quot;&gt;Runtime &amp;amp; Runloop å¸¸é¢é—®é¢˜æ•´ç†ï¼ˆé™„ç­”æ¡ˆï¼‰&lt;/h4&gt;
&lt;p&gt;åŒä¸€ä¸ªé¢è¯•é—®é¢˜å¹¶éåªæœ‰ä¸€ä¸ªç­”æ¡ˆï¼Œè€ŒåŒä¸€ä¸ªç­”æ¡ˆå¹¶ä¸æ˜¯åœ¨ä»»ä½•é¢è¯•åœºåˆéƒ½æœ‰æ•ˆï¼Œå…³é”®åœ¨äºåº”è˜è€…æŒæ¡äº†è§„å¾‹åï¼Œå¯¹é¢è¯•çš„å…·ä½“æƒ…å†µè¿›è¡ŒæŠŠæ¡ï¼Œæœ‰æ„è¯†åœ°æ£æ‘©é¢è¯•å®˜æå‡ºé—®é¢˜çš„å¿ƒç† (&lt;strong&gt;çœŸå®é—®ç­”&lt;/strong&gt;)ï¼Œè¦ get çš„åˆ°é—®çš„ç‚¹ï¼Œç„¶åç­”å…¶æ‰€é—®ï¼Œç®—æ˜¯â€œ æŠ•å…¶æ‰€å¥½ â€å§ã€‚&lt;br/&gt;æ‘˜å½•ï¼š&lt;br/&gt;http://www.jianshu.com/p/56e40ea56813&lt;br/&gt;http://www.jianshu.com/p/f9eb6b315c08&lt;/p&gt;
&lt;h5 id=&quot;runtime&quot;&gt;Runtime&lt;/h5&gt;
&lt;table&gt;&lt;tbody readability=&quot;5&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;2&quot;&gt;&lt;td&gt;01 / objcåœ¨å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯æ—¶ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;8&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šæ ¹æ®å¯¹è±¡çš„ isa æŒ‡é’ˆæ‰¾åˆ°ç±»å¯¹è±¡ idï¼Œåœ¨æŸ¥è¯¢ç±»å¯¹è±¡é‡Œé¢çš„ methodLists æ–¹æ³•å‡½æ•°åˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰åœ¨å¥½åˆ°ï¼Œåœ¨æ²¿ç€ superClass ,å¯»æ‰¾çˆ¶ç±»ï¼Œå†åœ¨çˆ¶ç±» methodLists æ–¹æ³•åˆ—è¡¨é‡Œé¢æŸ¥è¯¢ï¼Œæœ€ç»ˆæ‰¾åˆ° SEL ,æ ¹æ® id å’Œ SEL ç¡®è®¤ IMPï¼ˆæŒ‡é’ˆå‡½æ•°ï¼‰,åœ¨å‘é€æ¶ˆæ¯ï¼›&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;3&quot;&gt;&lt;td&gt;02 / é—®é¢˜ï¼šä»€ä¹ˆæ—¶å€™ä¼šæŠ¥unrecognized selectoré”™è¯¯ï¼ŸiOSæœ‰å“ªäº›æœºåˆ¶æ¥é¿å…èµ°åˆ°è¿™ä¸€æ­¥ï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;5&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šå½“å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®ç±»é‡Œé¢çš„ methodLists åˆ—è¡¨å»æŸ¥è¯¢æˆ‘ä»¬è¦åŠ¨ç”¨çš„SELï¼Œå½“æŸ¥è¯¢ä¸åˆ°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä¸€ç›´æ²¿ç€çˆ¶ç±»æŸ¥è¯¢ï¼Œå½“æœ€ç»ˆæŸ¥è¯¢ä¸åˆ°çš„æ—¶å€™æˆ‘ä»¬ä¼šæŠ¥ &lt;code&gt;unrecognized selector&lt;/code&gt; é”™è¯¯ï¼Œå½“ç³»ç»ŸæŸ¥è¯¢ä¸åˆ°æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ &lt;code&gt;+(BOOL)resolveInstanceMethod:(SEL)sel&lt;/code&gt; åŠ¨æ€è§£é‡Šçš„æ–¹æ³•æ¥ç»™æˆ‘ä¸€æ¬¡æœºä¼šæ¥æ·»åŠ ï¼Œè°ƒç”¨ä¸åˆ°çš„æ–¹æ³•ã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨ &lt;code&gt;-(id)forwardingTargetForSelector:(SEL)aSelector&lt;/code&gt; é‡å®šå‘çš„æ–¹æ³•æ¥å‘Šè¯‰ç³»ç»Ÿï¼Œè¯¥è°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Œä¸€æ¥ä¿è¯ä¸ä¼šå´©æºƒã€‚&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;6.5&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;3&quot;&gt;&lt;td&gt;03 / é—®é¢˜ï¼šèƒ½å¦å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡ï¼Ÿèƒ½å¦å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;3&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼š1ã€ä¸èƒ½å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»å¢åŠ å®ä¾‹å˜é‡ 2ã€èƒ½å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ã€‚&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;odd&quot; readability=&quot;7&quot;&gt;&lt;td&gt;åˆ†æï¼š1. ç¼–è¯‘åçš„ç±»å·²ç»æ³¨å†Œåœ¨ runtime ä¸­,ç±»ç»“æ„ä½“ä¸­çš„ objc_ivar_list å®ä¾‹å˜é‡çš„é“¾è¡¨å’Œ instance_size å®ä¾‹å˜é‡çš„å†…å­˜å¤§å°å·²ç»ç¡®å®šï¼Œruntimeä¼šè°ƒç”¨ class_setvarlayout æˆ– class_setWeaklvarLayout æ¥å¤„ç†strong weak å¼•ç”¨.æ‰€ä»¥ä¸èƒ½å‘å­˜åœ¨çš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ã€‚2. è¿è¡Œæ—¶åˆ›å»ºçš„ç±»æ˜¯å¯ä»¥æ·»åŠ å®ä¾‹å˜é‡ï¼Œè°ƒç”¨class_addIvarå‡½æ•°. ä½†æ˜¯çš„åœ¨è°ƒç”¨ objc_allocateClassPair ä¹‹åï¼Œobjc_registerClassPair ä¹‹å‰,åŸå› åŒä¸Š.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;3.5&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;2&quot;&gt;&lt;td&gt;04 / é—®é¢˜ï¼šruntimeå¦‚ä½•å®ç°weakå˜é‡çš„è‡ªåŠ¨ç½®nilï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;5&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šruntime å¯¹æ³¨å†Œçš„ç±»ï¼Œ ä¼šè¿›è¡Œå¸ƒå±€ï¼Œå¯¹äº weak å¯¹è±¡ä¼šæ”¾å…¥ä¸€ä¸ª hash è¡¨ä¸­ã€‚ ç”¨ weak æŒ‡å‘çš„å¯¹è±¡å†…å­˜åœ°å€ä½œä¸º keyï¼Œå½“æ­¤å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0çš„æ—¶å€™ä¼š deallocï¼Œå‡å¦‚ weak æŒ‡å‘çš„å¯¹è±¡å†…å­˜åœ°å€æ˜¯aï¼Œé‚£ä¹ˆå°±ä¼šä»¥aä¸ºé”®ï¼Œ åœ¨è¿™ä¸ª weak è¡¨ä¸­æœç´¢ï¼Œæ‰¾åˆ°æ‰€æœ‰ä»¥aä¸ºé”®çš„ weak å¯¹è±¡ï¼Œä»è€Œè®¾ç½®ä¸º nilã€‚&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;2&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;2&quot;&gt;&lt;td&gt;05 / é—®é¢˜ï¼šç»™ç±»æ·»åŠ ä¸€ä¸ªå±æ€§åï¼Œåœ¨ç±»ç»“æ„ä½“é‡Œå“ªäº›å…ƒç´ ä¼šå‘ç”Ÿå˜åŒ–ï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;2&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šinstance_size ï¼šå®ä¾‹çš„å†…å­˜å¤§å°ï¼›objc_ivar_list *ivars:å±æ€§åˆ—è¡¨&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h5 id=&quot;runloop&quot;&gt;RunLoop&lt;/h5&gt;
&lt;table&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;3&quot;&gt;&lt;td&gt;01 / é—®é¢˜ï¼šrunloopæ˜¯æ¥åšä»€ä¹ˆçš„ï¼Ÿrunloopå’Œçº¿ç¨‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿä¸»çº¿ç¨‹é»˜è®¤å¼€å¯äº†runloopä¹ˆï¼Ÿå­çº¿ç¨‹å‘¢ï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;5&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šrunloop: ä»å­—é¢æ„æ€çœ‹ï¼šè¿è¡Œå¾ªç¯ã€è·‘åœˆï¼Œå…¶å®å®ƒå†…éƒ¨å°±æ˜¯do-whileå¾ªç¯ï¼Œåœ¨è¿™ä¸ªå¾ªç¯å†…éƒ¨ä¸æ–­åœ°å¤„ç†å„ç§ä»»åŠ¡ï¼ˆæ¯”å¦‚Sourceã€Timerã€Observerï¼‰äº‹ä»¶ã€‚runloopå’Œçº¿ç¨‹çš„å…³ç³»ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªRunLoopï¼Œä¸»çº¿ç¨‹çš„RunLoopé»˜è®¤åˆ›å»ºå¹¶å¯åŠ¨ï¼Œå­çº¿ç¨‹çš„RunLoopéœ€æ‰‹åŠ¨åˆ›å»ºä¸”æ‰‹åŠ¨å¯åŠ¨ï¼ˆè°ƒç”¨runæ–¹æ³•ï¼‰ã€‚RunLoopåªèƒ½é€‰æ‹©ä¸€ä¸ªModeå¯åŠ¨ï¼Œå¦‚æœå½“å‰Modeä¸­æ²¡æœ‰ä»»ä½•Source(Sources0ã€Sources1)ã€Timerï¼Œé‚£ä¹ˆå°±ç›´æ¥é€€å‡ºRunLoopã€‚&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;3.5&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;2&quot;&gt;&lt;td&gt;02 / é—®é¢˜ï¼šrunloopçš„modeæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿæœ‰å‡ ç§modeï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;5&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šmodel:æ˜¯runloopé‡Œé¢çš„è¿è¡Œæ¨¡å¼ï¼Œä¸åŒçš„æ¨¡å¼ä¸‹çš„runloopå¤„ç†çš„äº‹ä»¶å’Œæ¶ˆæ¯æœ‰ä¸€å®šçš„å·®åˆ«ã€‚ç³»ç»Ÿé»˜è®¤æ³¨å†Œäº†5ä¸ªMode:ï¼ˆ1ï¼‰kCFRunLoopDefaultMode: Appçš„é»˜è®¤ Modeï¼Œé€šå¸¸ä¸»çº¿ç¨‹æ˜¯åœ¨è¿™ä¸ª Mode ä¸‹è¿è¡Œçš„ã€‚ï¼ˆ2ï¼‰UITrackingRunLoopMode: ç•Œé¢è·Ÿè¸ª Modeï¼Œç”¨äº ScrollView è¿½è¸ªè§¦æ‘¸æ»‘åŠ¨ï¼Œä¿è¯ç•Œé¢æ»‘åŠ¨æ—¶ä¸å—å…¶ä»– Mode å½±å“ã€‚ï¼ˆ3ï¼‰UIInitializationRunLoopMode: åœ¨åˆšå¯åŠ¨ App æ—¶ç¬¬è¿›å…¥çš„ç¬¬ä¸€ä¸ª Modeï¼Œå¯åŠ¨å®Œæˆåå°±ä¸å†ä½¿ç”¨ã€‚ï¼ˆ4ï¼‰GSEventReceiveRunLoopMode: æ¥å—ç³»ç»Ÿäº‹ä»¶çš„å†…éƒ¨ Modeï¼Œé€šå¸¸ç”¨ä¸åˆ°ã€‚ï¼ˆ5ï¼‰kCFRunLoopCommonModes: è¿™æ˜¯ä¸€ä¸ªå ä½çš„ Modeï¼Œæ²¡æœ‰å®é™…ä½œç”¨ã€‚æ³¨æ„iOS å¯¹ä»¥ä¸Š5ä¸­modelè¿›è¡Œäº†å°è£… NSDefaultRunLoopModeã€NSRunLoopCommonModes&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;3&quot;&gt;&lt;td&gt;03 / é—®é¢˜ï¼šä¸ºä»€ä¹ˆæŠŠNSTimerå¯¹è±¡ä»¥NSDefaultRunLoopModeï¼ˆkCFRunLoopDefaultModeï¼‰æ·»åŠ åˆ°ä¸»è¿è¡Œå¾ªç¯ä»¥åï¼Œæ»‘åŠ¨scrollviewçš„æ—¶å€™NSTimerå´ä¸åŠ¨äº†ï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;5&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šnstimeå¯¹è±¡æ˜¯åœ¨ NSDefaultRunLoopModeä¸‹é¢è°ƒç”¨æ¶ˆæ¯çš„ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æ»‘åŠ¨scrollviewçš„æ—¶å€™ï¼ŒNSDefaultRunLoopModeæ¨¡å¼å°±è‡ªåŠ¨åˆ‡æ¢åˆ°UITrackingRunLoopModeæ¨¡å¼ä¸‹é¢ï¼Œå´ä¸å¯ä»¥ç»§ç»­å“åº”nstimeå‘é€çš„æ¶ˆæ¯ã€‚æ‰€ä»¥å¦‚æœæƒ³åœ¨æ»‘åŠ¨scrollviewçš„æƒ…å†µä¸‹é¢è¿˜è°ƒç”¨nstimeçš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠnsrunloopçš„æ¨¡å¼æ›´æ”¹ä¸ºNSRunLoopCommonModes.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table&gt;&lt;tbody readability=&quot;3&quot;&gt;&lt;tr class=&quot;odd&quot; readability=&quot;2&quot;&gt;&lt;td&gt;04 / é—®é¢˜ï¼šè‹¹æœæ˜¯å¦‚ä½•å®ç°Autorelease Poolçš„ï¼Ÿ&lt;/td&gt;
&lt;/tr&gt;&lt;tr class=&quot;even&quot; readability=&quot;4&quot;&gt;&lt;td&gt;å‚è€ƒ1ï¼šAutorelease Poolä½œç”¨ï¼šç¼“å­˜æ± ï¼Œå¯ä»¥é¿å…æˆ‘ä»¬ç»å¸¸å†™relaseçš„ä¸€ç§æ–¹å¼ã€‚å…¶å®å°±æ˜¯å»¶è¿Ÿreleaseï¼Œå°†åˆ›å»ºçš„å¯¹è±¡ï¼Œæ·»åŠ åˆ°æœ€è¿‘çš„autoreleasePoolä¸­ï¼Œç­‰åˆ°autoreleasePoolä½œç”¨åŸŸç»“æŸçš„æ—¶å€™ï¼Œä¼šå°†é‡Œé¢æ‰€æœ‰çš„å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ - autorelease.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/CustomPBWaters/runtime-Learning&quot;&gt;é™„ä¸Šå†™çš„å°æ · Demoï¼Œé‡è¦çš„éƒ¨åˆ†ä»£ç ä¸­éƒ½æœ‰ç›¸åº”çš„æ³¨è§£å’Œæ–‡å­—æ‰“å°ï¼Œè¿è¡Œç¨‹åºå¯ä»¥å¾ˆç›´è§‚çš„è¡¨ç°&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;reading&quot;&gt;Reading&lt;/h4&gt;
&lt;hr/&gt;&lt;ul&gt;&lt;li&gt;å„ä½å‚å‹ï¼Œç”±äºã€Œæ—¶é—´ &amp;amp; çŸ¥è¯†ã€æœ‰é™ï¼Œæ€»ç»“çš„æ–‡ç« éš¾å…æœ‰ã€Œæœªå…¨ã€ä¸è¶³ã€ï¼Œè¯¥æ¨¡å—å°†ç³»ç»ŸåŒ–å­¦ä¹ ï¼Œåæ›¿æ¢ã€è¡¥å……æ–‡ç« å†…å®¹ ~&lt;/li&gt;
&lt;li&gt;ç†¬å¤œå†™è€…ä¸æ˜“ï¼Œ&lt;a href=&quot;https://upload-images.jianshu.io/upload_images/2230763-5407990be8e69fff.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;&gt;ä¸çŸ¥åå¼€å‘è€…ï¼Œæ›´å¤šæ¨¡å—æ–‡ç« &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Wed, 19 Sep 2018 15:14:00 +0000</pubDate>
<dc:creator>public-ä¸çŸ¥åå¼€å‘è€…</dc:creator>
<og:description>å¼•å¯¼ ç›¸ä¿¡å¯¹äºä»äº‹å¼€å‘äººå‘˜æ¥è¯´ runtime è¿™ä¸ªåç§°éƒ½ä¸é™Œç”Ÿï¼Œå°±åƒæˆ‘èµ·åˆåªçŸ¥é“ã€Œ runtime å«è¿è¡Œæ—¶ ã€ï¼Œåæ¥çŸ¥é“ runtime åŒæ ·å¯ä»¥åƒ KVC ä¸€æ ·è®¿é—®ç§æœ‰æˆå‘˜å˜é‡ï¼Œè¿˜æœ‰ã€Œ ç»™ç±»åŠ¨æ€</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/Plainboiledwater/p/9678287.html</dc:identifier>
</item>
<item>
<title>pythonæ–‡ä»¶æµ - é£ä½</title>
<link>http://www.cnblogs.com/whych/p/9678249.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/whych/p/9678249.html</guid>
<description>&lt;p&gt;&lt;span&gt;æ‰“å¼€æ–‡ä»¶&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;æ–‡ä»¶çš„åŸºæœ¬æ–¹æ³•&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;è¿­ä»£æ–‡ä»¶å†…å®¹&lt;/span&gt;&lt;/p&gt;

&lt;h2&gt;æ‰“å¼€æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;æ‰“å¼€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨è‡ªåŠ¨å¯¼å…¥çš„æ¨¡å—ioä¸­çš„å‡½æ•°openã€‚å‡½æ•°openå°†æ–‡ä»¶åä½œä¸ºå”¯ä¸€å¿…ä¸å¯å°‘çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ã€‚å¦‚æœåªæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼Œåˆ™è·å¾—ä¸€ä¸ªå¯è¯»å–çš„æ–‡ä»¶å¯¹è±¡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å¦‚æœå½“å‰ç›®å½•ä¸­æœ‰æ­¤æ–‡ä»¶åˆ™å¯ä»¥æ‰“å¼€ï¼Œå¦‚æœä½äºå…¶ä»–ä½ç½®åˆ™éœ€è¦æŒ‡å®šå®Œæ•´çš„è·¯å¾„ï¼Œå¦‚æœæŒ‡å®šæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å¦‚ä¸‹æŠ¥é”™ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230302618-723640688.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ–‡ä»¶æ¨¡å¼&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å¦‚æœéœ€è¦å†™å…¥æ–‡ä»¶ï¼Œåˆ™éœ€è¦é€šè¿‡æŒ‡å®šæ¨¡å¼ã€‚å‡½æ•°opençš„å‚æ•°æ¨¡å¼å¸¸è§æœ‰å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;table border=&quot;0&quot;&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody valign=&quot;top&quot; readability=&quot;6&quot;&gt;&lt;tr&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ¨¡å¼&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'r'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td&gt;
&lt;p&gt;&lt;span&gt;è¯»å–æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'w'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;å†™å…¥æ¨¡å¼ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨æ—¶åˆ›å»ºå®ƒï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'t'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤ï¼Œä¸å…¶ä»–æ¨¡å¼ç»“åˆä½¿ç”¨ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'x'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;ç‹¬å å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šæŠ¥é”™ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'a'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;é™„åŠ æ¨¡å¼ï¼ˆåœ¨æ—¢æœ‰æ–‡ä»¶æœ«å°¾ç»§ç»­å†™å…¥ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'b'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;äºŒè¿›åˆ¶æ¨¡å¼ï¼ˆä¸å…¶ä»–æ¨¡å¼ç»“åˆä½¿ç”¨ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;
&lt;p&gt;&lt;span&gt;'+'&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;td readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;span&gt;æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ–°ï¼ˆå¯è¯»å¯å†™ï¼Œä¸å…¶ä»–æ¨¡å¼ç»“åˆä½¿ç”¨ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;&lt;span&gt;é»˜è®¤æ¨¡å¼ä¸º'rt'ï¼Œè¯»å–æ—¶å°†è‡ªåŠ¨æ›¿æ¢å…¶ä»–è¡Œå°¾å­—ç¬¦ï¼ˆ'\r','\r\n'ï¼‰ï¼Œå†™å…¥æ—¶å°†'\n'æ›¿æ¢ä¸ºç³»ç»Ÿçš„é»˜è®¤è¡Œå°¾å­—ç¬¦ï¼ˆos.linesepï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;è¦æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå¯ä½¿ç”¨'r+',ä½†æ˜¯ä¼šå°†æ—¢æœ‰å†…å®¹åˆ é™¤ï¼Œè€Œ'w+'ä¸ä¼šã€‚&lt;/span&gt;&lt;/p&gt;

&lt;h2&gt;æ–‡ä»¶çš„åŸºæœ¬æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;è¯»å–å’Œå†™å…¥&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ç®¡é“é‡å®šå‘è¾“å‡º&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;éšæœºå­˜å–&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;è¯»å–å’Œå†™å…¥è¡Œ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å…³é—­æ–‡ä»¶&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;æ–‡ä»¶æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯æä¾›å’Œæ¥æ”¶æ•°æ®ã€‚åœ¨æ–‡æœ¬å’ŒäºŒè¿›åˆ¶æ¨¡å¼ä¸‹ï¼ŒåŸºæœ¬ä¸Šåˆ†åˆ«å°†strå’Œbytesç±»ç”¨ä½œæ•°æ®ã€‚&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;è¯»å–å’Œå†™å…¥ï¼š&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230303009-1069883659.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ä½¿ç”¨readè¯»å–æ•°æ®ï¼Œé»˜è®¤è¯»å–å…¨éƒ¨å†…å®¹ã€‚è¿˜å¯ä»¥æŒ‡å®šå‚æ•°ï¼Œç„¶åè¯»å–å‰©ä¸‹çš„å…¨éƒ¨å†…å®¹ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230303256-1739546988.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;ç®¡é“é‡å®šå‘è¾“å‡º&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å°†ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºé“¾æ¥åˆ°ä¸‹ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼š&lt;/span&gt;&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#&lt;/span&gt;&lt;span&gt;cat some.txt&lt;/span&gt;
&lt;span&gt;
you are bad boy

 

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;cat some.py&lt;/span&gt;

&lt;span&gt;#&lt;/span&gt;&lt;span&gt;!/usr/bin/evn python&lt;/span&gt;

&lt;span&gt;#&lt;/span&gt;&lt;span&gt; è®¡ç®—sys.stdinä¸­åŒ…å«å¤šå°‘ä¸ªå•è¯çš„è„šæœ¬&lt;/span&gt;

&lt;span&gt;import&lt;/span&gt;&lt;span&gt; sys

text &lt;/span&gt;=&lt;span&gt; sys.stdin.read()

words &lt;/span&gt;=&lt;span&gt; text.split()

wordcount &lt;/span&gt;=&lt;span&gt; len(words)

&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(wordcount)

 

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;cat some.txt | python3 some.py&lt;/span&gt;

4
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;éšæœºå­˜å–&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å¯ä»¥ä½¿ç”¨æ–¹æ³•seekå’Œtellã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;seek(offset,[, whence])å°†å½“å‰ä½ç½®ç§»åˆ°offsetï¼ˆæŒ‡å®šå­—èŠ‚æ•°ï¼‰å’ŒwhenceæŒ‡å®šçš„åœ°æ–¹ï¼ˆå‚æ•°whenceé»˜è®¤ä¸ºio.SEEK_SET(0)ï¼Œåç§»é‡æ˜¯ç›¸å¯¹äºæ–‡ä»¶å¼€å¤´çš„ï¼Œè€Œio.SEEK_SET(1)ï¼Œç›¸å¯¹äºå½“å‰ä½ç½®è¿›è¡Œç§»åŠ¨ï¼Œio.SEEK_SET(2)ï¼Œç›¸å¯¹äºæ–‡ä»¶æœ«å°¾è¿›è¡Œç§»åŠ¨ï¼‰&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;tell()è¿”å›å½“å‰ä½äºæ–‡ä»¶çš„ä»€ä¹ˆä½ç½®ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230303545-955579702.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;å¯¹è¡Œçš„è¯»å–å’Œå†™å…¥&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;å¯ä»¥ä½¿ç”¨æ–¹æ³•readlineï¼Œä¸æŒ‡å®šå‚æ•°é»˜è®¤è¯»å–ä¸€è¡Œå¹¶è¿”å›ï¼ŒæŒ‡å®šå‚æ•°ä¸ºæœ€å¤šè¯»å–å¤šå°‘ä¸ªå­—ç¬¦ã€‚è¦è¯»å–æ–‡ä»¶ä¸­æ‰€æœ‰çš„è¡Œï¼Œå¹¶&lt;strong&gt;ä»¥åˆ—è¡¨çš„æ–¹å¼è¿”å›&lt;/strong&gt;å®ƒä»¬ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•readlinesã€‚æ–¹æ³•writelines&lt;strong&gt;æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨&lt;/strong&gt;å†™å…¥æ–‡ä»¶ä¸­ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230303803-431184671.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230304006-580327125.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;# ä¿®æ”¹æ–‡ä»¶&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1387124/201809/1387124-20180919230304299-194107194.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;å…³é—­æ–‡ä»¶&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;é¿å…é”å®šæ–‡ä»¶ä»¥é˜²æ­¢ä¿®æ”¹ï¼Œé¿å…ç”¨å®Œç³»ç»Ÿå¯èƒ½æŒ‡å®šçš„æ–‡ä»¶æ‰“å¼€é…é¢ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ç¡®ä¿æ–‡ä»¶å…³é—­ï¼Œå¯ä»¥ä½¿ç”¨try/finallyè¯­å¥ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;try&lt;/span&gt;&lt;span&gt;ï¼š

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­&lt;/span&gt;

&lt;span&gt;finally&lt;/span&gt;&lt;span&gt;ï¼š

file.close()


withè¯­å¥å¯ä»¥è®©ä½ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶èµ‹å€¼åˆ°ä¸€ä¸ªå˜é‡ï¼Œåˆ°è¾¾è¯¥å¥æœ«å°¾æ—¶ï¼Œå°†è‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼Œå³ä¾¿å‡ºç°å¼‚å¸¸ã€‚

with open(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;somefile.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as somefile

do_something(somefile)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;è¿­ä»£æ–‡ä»¶å†…å®¹&lt;/h2&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;def&lt;/span&gt;&lt;span&gt; process(string):
&lt;/span&gt;&lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;Processing:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;, string)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; æ¯æ¬¡è¿­ä»£ä¸€ä¸ªå­—ç¬¦&lt;/span&gt;
with open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as f:
ã€€ã€€&lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; True:
        char &lt;/span&gt;= f.read(1&lt;span&gt;)
ã€€ã€€&lt;/span&gt;&lt;span&gt;if&lt;/span&gt; &lt;span&gt;not&lt;/span&gt; char: &lt;span&gt;break&lt;/span&gt;&lt;span&gt;
ã€€ã€€process(char)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;æ¯æ¬¡è¿­ä»£ä¸€è¡Œå­—ç¬¦&lt;/span&gt;
with open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as f:
    &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; True:
    line &lt;/span&gt;=&lt;span&gt; f.readline()
&lt;/span&gt;&lt;span&gt;                                                                                                                                                          process(line)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;è¯»å–æ‰€æœ‰å†…å®¹ï¼Œä½¿ç”¨read&lt;/span&gt;
with open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as f:                                                                                                                                                                                          &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; char &lt;span&gt;in&lt;/span&gt;&lt;span&gt; f.read():
    process(char)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;ä½¿ç”¨readlines&lt;/span&gt;
with open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as f:                                                                                                                                                                                                                                    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; char &lt;span&gt;in&lt;/span&gt;&lt;span&gt; f.readlines():
    process(char)

&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt; ä½¿ç”¨fileinputå®ç°å»¶è¿Ÿè¿­ä»£ï¼Œè¯»å–å®é™…éœ€è¦æ–‡æœ¬çš„éƒ¨åˆ†&lt;/span&gt;
&lt;span&gt;import&lt;/span&gt;&lt;span&gt; fileinput
&lt;/span&gt;&lt;span&gt;for&lt;/span&gt; line &lt;span&gt;in&lt;/span&gt; fileinput.input(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;):
    process(line)
 &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ–‡ä»¶è¿­ä»£å™¨&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;è¿­ä»£æ–‡ä»¶&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
with open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;) as f:&lt;br/&gt;ã€€ã€€&lt;/span&gt;&lt;span&gt;for&lt;/span&gt; line &lt;span&gt;in&lt;/span&gt;&lt;span&gt; f:&lt;br/&gt;ã€€ã€€process(line)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span&gt;ä¸å°†æ–‡ä»¶å¯¹è±¡èµ‹ç»™å˜é‡è¿­ä»£æ–‡ä»¶&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;for&lt;/span&gt; line &lt;span&gt;in&lt;/span&gt;&lt;span&gt; open(fileone.txt):
    process(line)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span&gt;å¯¹è¿­ä»£å™¨çš„æ“ä½œä¹Ÿå¯ä»¥å¯¹æ–‡ä»¶åšï¼Œå¦‚list(open(fileone.txt))ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&amp;gt;&amp;gt;&amp;gt; f = open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;w&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)

&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;First&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;line&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, file=&lt;span&gt;f)

&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;Second&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;line&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, file=&lt;span&gt;f)

&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt;&lt;span&gt; f.close()


&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; lines = list(open(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;fileone.txt&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;))

&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt;&lt;span&gt; lines

[&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;First line\n&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;Second line\n&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;]
&lt;/pre&gt;&lt;/div&gt;

</description>
<pubDate>Wed, 19 Sep 2018 15:09:00 +0000</pubDate>
<dc:creator>é£ä½</dc:creator>
<og:description>æ‰“å¼€æ–‡ä»¶ æ–‡ä»¶çš„åŸºæœ¬æ–¹æ³• è¿­ä»£æ–‡ä»¶å†…å®¹ æ‰“å¼€æ–‡ä»¶ æ‰“å¼€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨è‡ªåŠ¨å¯¼å…¥çš„æ¨¡å—ioä¸­çš„å‡½æ•°openã€‚å‡½æ•°openå°†æ–‡ä»¶åä½œä¸ºå”¯ä¸€å¿…ä¸å¯å°‘çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ã€‚å¦‚æœåªæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼Œåˆ™è·å¾—ä¸€ä¸ª</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/whych/p/9678249.html</dc:identifier>
</item>
<item>
<title>åˆ†å¸ƒå¼ç³»åˆ—äº”: RMIé€šä¿¡ - ç½ªæ¶æ–¯å·´å…‹</title>
<link>http://www.cnblogs.com/walkinhalo/p/9678139.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/walkinhalo/p/9678139.html</guid>
<description>&lt;h2 id=&quot;rpcremote-procedure-callåè®®&quot;&gt;RPC(Remote Procedure Call)åè®®&lt;/h2&gt;
&lt;p&gt;RPCåè®®æ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œä»è¿œç¨‹è®¡ç®—æœºä¸Šè¯·æ±‚æœåŠ¡, è€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®, åœ¨OSIæ¨¡å‹ä¸­å¤„åœ¨åº”ç”¨å±‚å’Œç½‘ç»œå±‚.&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªè§„èŒƒ, ä½¿ç”¨RPCåè®®çš„æ¡†æ¶æœ‰å¾ˆå¤š, Dubbo,Hessianç­‰å‡ä½¿ç”¨è¿™ä¸ªåè®®, RMIä¹Ÿä½¿ç”¨è¯¥åè®®å®ç°.&lt;/p&gt;
&lt;h2 id=&quot;rmiremote-method-invocation-è¿œç¨‹æ–¹æ³•è°ƒç”¨&quot;&gt;RMI(Remote Method Invocation) è¿œç¨‹æ–¹æ³•è°ƒç”¨&lt;/h2&gt;
&lt;p&gt;RMIä½¿ç”¨Javaè¿œç¨‹æ¶ˆæ¯äº¤æ¢åè®®JRMPï¼ˆJava Remote Messaging Protocolï¼‰è¿›è¡Œé€šä¿¡,JRMPæ˜¯çº¯javaçš„.&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;å®šä¹‰æ¥å£, ä½¿å…¶extends &lt;code&gt;Remote&lt;/code&gt;æ¥å£, æ–¹æ³•éœ€è¦æŠ›å‡ºå¼‚å¸¸&lt;code&gt;RemoteException&lt;/code&gt;, Remoteæ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public interface IRmiTest extends Remote {
    String hello() throws RemoteException;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;å®ç°æ¥å£, ä½¿å…¶extends &lt;code&gt;UnicastRemoteObject&lt;/code&gt;, éœ€è¦æœ‰æ„é€ æ–¹æ³•, å¹¶æŠ›å‡ºå¼‚å¸¸&lt;code&gt;RemoteException&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class RmiTest extends UnicastRemoteObject implements IRmiTest {

    public RmiTest() throws RemoteException {

    }

    @Override
    public String hello() {
        return &quot;Hello ....&quot;;
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;å®šä¹‰æœåŠ¡ç«¯, æ³¨å†Œå’Œç»‘å®š&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class TestServer {
    public static void main(String[] args) throws RemoteException, AlreadyBoundException, MalformedURLException {
        IRmiTest rmiTest = new RmiTest();
        LocateRegistry.createRegistry(8888);
        Naming.bind(&quot;rmi://localhost:8888/hello&quot;,rmiTest);
        System.out.println(&quot;server started&quot;);
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;å®šä¹‰å®¢æˆ·ç«¯, lookupæ–¹æ³•çš„å‚æ•°urlä¸æœåŠ¡ç«¯bindçš„å¿…é¡»ä¸€è‡´. æ¥å£éœ€è¦å®šä¹‰ä¸ºä¸æœåŠ¡ç«¯ä¸€è‡´.&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public class TestClient {
    public static void main(String[] args) throws RemoteException,  MalformedURLException, NotBoundException {
        IRmiTest rmiTest = (IRmiTest) Naming.lookup(&quot;rmi://localhost:8888/hello&quot;);
        System.out.println(rmiTest.hello());
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;rmiå®ç°æœºåˆ¶&quot;&gt;RMIå®ç°æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;RMIå±è”½äº†åº•å±‚å¤æ‚çš„ç½‘ç»œè°ƒç”¨, ä½¿å¾—è¿œç¨‹å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨å˜å¾—é€æ˜, å°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·æ–¹ä¾¿.&lt;br/&gt;ä¸‹é¢æ·±å…¥æ¢ç©¶ä¸‹jdkä¸­rmiçš„å®ç°åŸç†, çœ‹çœ‹åº•å±‚æ˜¯å¦‚ä½•å®ç°è¿œç¨‹è°ƒç”¨çš„.&lt;br/&gt;é¦–å…ˆ, éœ€è¦äº†è§£ä¸‹æ¯”è¾ƒé‡è¦çš„ä¸¤ä¸ªè§’è‰²stubå’Œskeleton, è¿™ä¸¤ä¸ªè§’è‰²å°è£…äº†ä¸ç½‘ç»œç›¸å…³çš„ä»£ç . åŸå§‹çš„äº¤äº’å¼è¿™æ ·çš„,å®¢æˆ·ç«¯--ç½‘ç»œ--æœåŠ¡å™¨--å…·ä½“æœåŠ¡. æœ‰äº†è¿™ä¸¤ä¸ªè§’è‰²ä¹‹åçš„æ¨¡å‹å˜ä¸º: å®¢æˆ·ç«¯--stub--ç½‘ç»œ--skeleton--æœåŠ¡å™¨--æœåŠ¡.å¯ä»¥å‚è€ƒçš„å›¾&lt;a href=&quot;https://en.wikipedia.org/wiki/Java_remote_method_invocation&quot;&gt;ç»´åŸºç™¾ç§‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ¥çœ‹æºç ...&lt;/p&gt;
&lt;h3 id=&quot;ä¸€.å®ä¾‹åŒ–registryimplåˆå§‹åŒ–&quot;&gt;ä¸€.å®ä¾‹åŒ–RegistryImpl,åˆå§‹åŒ–&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;LocateRegistry.createRegistry(8888);&lt;/code&gt;è¿™å¥ä»£ç å¯åŠ¨äº†ä¸€ä¸ªæ³¨å†Œå™¨(å…¶ä¸­æœ‰ä¸ªMapå¯¹è±¡æ¥å­˜å‚¨åç§°å’ŒæœåŠ¡çš„æ˜ å°„,è¿™ä¸ªåé¢å†ç»†çœ‹)&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public static Registry createRegistry(int port) throws RemoteException {
    return new RegistryImpl(port);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•å®ä¾‹åŒ–äº†ä¸€ä¸ª&lt;code&gt;RegistryImpl&lt;/code&gt;çš„å®ä¾‹,&lt;code&gt;RegistryImpl&lt;/code&gt;å®ç°äº†&lt;code&gt;Registry&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public RegistryImpl(final int var1) throws RemoteException {
    if(var1 == 1099 &amp;amp;&amp;amp; System.getSecurityManager() != null) {
        try {
            AccessController.doPrivileged(new PrivilegedExceptionAction() {
                public Void run() throws RemoteException {
                    LiveRef var1x = new LiveRef(RegistryImpl.id, var1);
                    RegistryImpl.this.setup(new UnicastServerRef(var1x));
                    return null;
                }
            }, (AccessControlContext)null, new Permission[]{new SocketPermission(&quot;localhost:&quot; + var1, &quot;listen,accept&quot;)});
        } catch (PrivilegedActionException var3) {
            throw (RemoteException)var3.getException();
        }
    } else {
        LiveRef var2 = new LiveRef(id, var1);
        this.setup(new UnicastServerRef(var2));
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸¤ä¸ªåˆ†æ”¯æœ€ç»ˆéƒ½è°ƒç”¨äº†&lt;code&gt;setup()&lt;/code&gt;æ–¹æ³•, ä¸»è¦å…³æ³¨è¯¥æ–¹æ³•.ifåˆ†æ”¯ä¸­var1=1099æ˜¯æŒ‡é»˜è®¤ç«¯å£å¹¶ä¸”å­˜åœ¨å®‰å…¨ç®¡ç†å™¨çš„æ—¶å€™ä¸åšæ ¡éªŒ, è¿™æ˜¯ä¸ºäº†æ€§èƒ½è€ƒè™‘.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;private void setup(UnicastServerRef var1) throws RemoteException {
    this.ref = var1; // UnicastServerRefç»§æ‰¿äº†RemoteRef,this.refçš„ç±»å‹å°±æ˜¯RemoteRef
    var1.exportObject(this, (Object)null, true); 
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;setupæ–¹æ³•çš„å‚æ•°æ˜¯åŒ…è£…åçš„&lt;code&gt;UnicastServerRef&lt;/code&gt;å¯¹è±¡, &lt;code&gt;UnicastServerRef&lt;/code&gt;ç»§æ‰¿äº†&lt;code&gt;RemoteRef&lt;/code&gt;å› æ­¤å¯ä»¥èµ‹å€¼ç»™refå˜é‡. è¯¥æ–¹æ³•å°†è°ƒç”¨å§”æ‰˜ç»™&lt;code&gt;UnicastServerRef&lt;/code&gt;çš„æ–¹æ³•&lt;code&gt;exportObject()&lt;/code&gt;&lt;br/&gt;å¦‚æœæ˜¯æ‹¿æ–‡ç« å¼€å¤´çš„ä»£ç è¿›è¡Œè°ƒè¯•, ä¼šå‘ç°è¿™ä¸ªæ–¹æ³•ä¼šèµ°ä¸¤æ¬¡, é™¤äº†&lt;code&gt;RegistryImpl&lt;/code&gt;, è¿˜æœ‰ä¸€æ¬¡æ˜¯&lt;code&gt;RmiTest&lt;/code&gt;ä¹Ÿä¼šèµ°è¿™ä¸ªæ–¹æ³•.ä¸åŒçš„æ˜¯&lt;code&gt;RegistryImpl&lt;/code&gt;ä¼šèµ°ä¸‹é¢ä»£ç ä¸­çš„&lt;code&gt;if(var5 instanceof RemoteStub)&lt;/code&gt;åˆ†æ”¯è¯­å¥, è¿™ä¸ªè¯­å¥æœ€ç»ˆå°†ç”Ÿæˆä¸€ä¸ªSkeletonå®ä¾‹å¹¶è®¾ç½®ç»™å½“å‰å®ä¾‹çš„åŸŸå˜é‡skel, ä¸è¿‡è‡ªjdk1.2ä¹‹åskeletonå°±æ²¡ä»€ä¹ˆç”¨äº†.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public Remote exportObject(Remote var1, Object var2, boolean var3) throws RemoteException {
    Class var4 = var1.getClass();

    Remote var5;
    try {
        var5 = Util.createProxy(var4, this.getClientRef(), this.forceStubUse);
    } catch (IllegalArgumentException var7) {
        throw new ExportException(&quot;remote object implements illegal remote interface&quot;, var7);
    }

    if(var5 instanceof RemoteStub) {
        // ç”ŸæˆSkeletonå®ä¾‹å¹¶è®¾ç½®ç»™å½“å‰å®ä¾‹çš„åŸŸå˜é‡skel
        this.setSkeleton(var1);
    }

    Target var6 = new Target(var1, this, var5, this.ref.getObjID(), var3);
    this.ref.exportObject(var6);  //refæ˜¯å®ä¾‹åŒ–UnicastServerRefçš„æ—¶å€™ä¼ å…¥çš„
    this.hashToMethod_Map = (Map)hashToMethod_Maps.get(var4);
    return var5;
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢æ–¹æ³•é¦–å…ˆæ ¹æ®&lt;code&gt;Remote&lt;/code&gt;çš„å‚æ•°var1åˆ›å»ºäº†ä¸€ä¸ªä»£ç†å¯¹è±¡var5, var1æ˜¯&lt;code&gt;RegistryImpl&lt;/code&gt;ç±»çš„å®ä¾‹. ç„¶åå®ä¾‹åŒ–ä¸€ä¸ª&lt;code&gt;Target&lt;/code&gt;çš„å®ä¾‹, ä»å‚æ•°å¯ä»¥çœ‹åˆ°,Targetå¯¹è±¡åŒ…å«äº†å‡ ä¹ä¹‹å‰ä»£ç çš„æ‰€æœ‰å¯¹è±¡.ç„¶åå°†è¿™ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°,è°ƒç”¨&lt;code&gt;LiveRef&lt;/code&gt;å®ä¾‹refçš„&lt;code&gt;exportObject()&lt;/code&gt;æ–¹æ³•.&lt;/p&gt;
&lt;h3 id=&quot;äºŒ.-ç½‘ç»œè¿æ¥å’Œå¯¹è±¡ä¼ è¾“&quot;&gt;äºŒ. ç½‘ç»œè¿æ¥å’Œå¯¹è±¡ä¼ è¾“&lt;/h3&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public void exportObject(Target var1) throws RemoteException {
    this.ep.exportObject(var1);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥ä¸Šä¸€æ­¥, &lt;code&gt;RemoteRef&lt;/code&gt;çš„æ–¹æ³•æœ€ç»ˆå§”æ‰˜ç»™&lt;code&gt;TCPEndpoint&lt;/code&gt;çš„åŒåæ–¹æ³•(å§”æ‰˜æ¨¡å¼), åˆ°æ­¤ä»£ç å°†æ§åˆ¶æƒä¼ é€’ç»™ä¼ è¾“å±‚.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;    public void exportObject(Target var1) throws RemoteException {
        synchronized(this) {
            this.listen();
            ++this.exportCount;
        }

        boolean var2 = false;
        boolean var12 = false;

        try {
            var12 = true;
            super.exportObject(var1);
            var2 = true;
            var12 = false;
        } finally {
            if (var12) {
                if (!var2) {
                    synchronized(this) {
                        this.decrementExportCount();
                    }
                }

            }
        }

        if (!var2) {
            synchronized(this) {
                this.decrementExportCount();
            }
        }

    }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•å®ç°äº†ç½‘ç»œé€šä¿¡, é¦–å…ˆ&lt;code&gt;linsten()&lt;/code&gt;å¯åŠ¨äº†ä¸€ä¸ª&lt;code&gt;ServerSocket&lt;/code&gt;çš„çº¿ç¨‹,å¹¶å¼€å§‹ç›‘å¬ç«¯å£. ç„¶åè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å°†&lt;code&gt;Target&lt;/code&gt;å¯¹è±¡æš´éœ²å‡ºå», æ­¤æ—¶æœåŠ¡ç«¯çš„åˆå§‹åŒ–å°±å®Œæˆäº†.&lt;/p&gt;
&lt;h3 id=&quot;ä¸‰.-æ³¨å†ŒæœåŠ¡&quot;&gt;ä¸‰. æ³¨å†ŒæœåŠ¡&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Naming.bind(&quot;rmi://localhost:8888/hello&quot;,rmiTest);&lt;/code&gt; å®Œæˆåç§°å’ŒæœåŠ¡å¯¹è±¡çš„ç»‘å®š.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public static void bind(String name, Remote obj)
    throws AlreadyBoundException,
        java.net.MalformedURLException,
        RemoteException
{
    ParsedNamingURL parsed = parseURL(name);
    Registry registry = getRegistry(parsed);

    if (obj == null)
        throw new NullPointerException(&quot;cannot bind to null&quot;);

    registry.bind(parsed.name, obj);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢ä»£ç &lt;code&gt;Naming&lt;/code&gt;ç±», è°ƒç”¨çš„æ˜¯æ³¨å†Œå™¨&lt;code&gt;Registry&lt;/code&gt;çš„&lt;code&gt;bind()&lt;/code&gt;æ–¹æ³•&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public void bind(String var1, Remote var2) throws RemoteException, AlreadyBoundException, AccessException {
    Hashtable var3 = this.bindings;
    synchronized(this.bindings) {
        Remote var4 = (Remote)this.bindings.get(var1);
        if (var4 != null) {
            throw new AlreadyBoundException(var1);
        } else {
            this.bindings.put(var1, var2);
        }
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ³¨å†Œä½¿ç”¨çš„å®¹å™¨æ˜¯ä¸€ä¸ª&lt;code&gt;HashTable&lt;/code&gt;, æœ€ç»ˆæœåŠ¡çš„åç§°å’ŒæœåŠ¡ä¼šè¢«æ³¨å†Œåˆ°è¿™ä¸ªmapå®¹å™¨ä¸­.&lt;/p&gt;
&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢, æœåŠ¡ç«¯çš„åˆå§‹åŒ–å®Œæˆ. é¦–å…ˆå®ä¾‹åŒ–äº†ä¸€ä¸ªå®ç°&lt;code&gt;Register&lt;/code&gt;æ³¨å†Œå™¨çš„å®ä¾‹, é€šè¿‡å±‚å±‚ç»„è£…, æœ€ç»ˆç”Ÿæˆä¸€ä¸ª&lt;code&gt;Target&lt;/code&gt;å¯¹è±¡, å…¶ä¸­åŒ…å«äº†ç»„è£…è¿‡ç¨‹ä¸­ç”Ÿæˆçš„å…¨éƒ¨çŠ¶æ€, æœ€åè°ƒç”¨&lt;code&gt;RemoteRef&lt;/code&gt;çš„æ–¹æ³•å°†å¯¹è±¡è½¬äº¤ç»™ä¼ è¾“å±‚å¯¹è±¡&lt;code&gt;TCPEndpoint&lt;/code&gt;çš„å®ä¾‹, æœ€ç»ˆç”±è¿™ä¸ªå¯¹è±¡å¯åŠ¨Socketå¼€å¯é€šä¿¡è¿æ¥. æ³¨å†ŒæœåŠ¡æ˜¯é€šè¿‡&lt;code&gt;Naming&lt;/code&gt;çš„æ–¹æ³•å§”æ‰˜è°ƒç”¨&lt;code&gt;Register&lt;/code&gt;æ³¨å†Œå™¨çš„æ–¹æ³•å®ç°, å¹¶å°†ç»“æœæœ€ç»ˆæ³¨å†Œåˆ°&lt;code&gt;Register&lt;/code&gt;åŸŸçš„mapå¯¹è±¡ä¸­.&lt;/p&gt;
&lt;h3 id=&quot;å››.-å®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨&quot;&gt;å››. å®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;IRmiTest rmiTest = (IRmiTest) Naming.lookup(&quot;rmi://localhost:8888/hello&quot;);&lt;/code&gt; å®¢æˆ·ç«¯é€šè¿‡&lt;code&gt;Naming&lt;/code&gt;çš„æ–¹æ³•è·å–æœåŠ¡çš„å®ä¾‹&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public static Remote lookup(String name)
    throws NotBoundException,
        java.net.MalformedURLException,
        RemoteException{
    ParsedNamingURL parsed = parseURL(name);
    Registry registry = getRegistry(parsed);

    if (parsed.name == null)
        return registry;
    return registry.lookup(parsed.name);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸æœåŠ¡ç«¯æ³¨å†Œæ—¶å€™ä½¿ç”¨&lt;code&gt;Naming.bind()&lt;/code&gt;æ–¹æ³•ä¸€æ ·, è¿™é‡Œ&lt;code&gt;lookup()&lt;/code&gt;æœ€ç»ˆä¹Ÿä¼šå§”æ‰˜ç»™&lt;code&gt;Registry&lt;/code&gt;çš„å®ä¾‹. è¿™ä¸ªå®ä¾‹çš„å®ç°ä¸æ˜¯ç”¨çš„æœåŠ¡ç«¯çš„&lt;code&gt;Register_Impl&lt;/code&gt;, è€Œæ˜¯ä½¿ç”¨&lt;code&gt;RegistryImpl_Stub&lt;/code&gt;, ä¸‹é¢ä»£ç æ˜¯&lt;code&gt;lookup()&lt;/code&gt;çš„å®ç°, å¯ä»¥çœ‹å‡ºè¿™é‡Œå°è£…äº†ç½‘ç»œioçš„ä¸€äº›é€»è¾‘.&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;public Remote lookup(String var1) throws AccessException, NotBoundException, RemoteException {
    try {
        RemoteCall var2 = this.ref.newCall(this, operations, 2, 4905912898345647071L);

        try {
            ObjectOutput var3 = var2.getOutputStream();
            var3.writeObject(var1);
        } catch (IOException var17) {
            throw new MarshalException(&quot;error marshalling arguments&quot;, var17);
        }

        this.ref.invoke(var2);

        Remote var22;
        try {
            ObjectInput var4 = var2.getInputStream();
            var22 = (Remote)var4.readObject();
        } catch (IOException var14) {
            throw new UnmarshalException(&quot;error unmarshalling return&quot;, var14);
        } catch (ClassNotFoundException var15) {
            throw new UnmarshalException(&quot;error unmarshalling return&quot;, var15);
        } finally {
            this.ref.done(var2);
        }

        return var22;
    } catch (RuntimeException var18) {
        throw var18;
    } catch (RemoteException var19) {
        throw var19;
    } catch (NotBoundException var20) {
        throw var20;
    } catch (Exception var21) {
        throw new UnexpectedException(&quot;undeclared checked exception&quot;, var21);
    }
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤, æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„è¿æ¥å®Œæˆ, å¯ä»¥å¼€å§‹é€šä¿¡äº†.&lt;/p&gt;
&lt;p&gt;RMIè‡ªJDK1.1å°±å·²ç»æä¾›äº†, å®ƒæä¾›äº†Javaè¯­è¨€è‡ªå·±çš„RPCè°ƒç”¨æ–¹å¼, è™½ç„¶æœ‰äº›è€æ—§, ä½†ä¾ç„¶ç»å…¸. ç›®å‰æœ‰å¾ˆå¤šè·¨è¯­è¨€çš„æŠ€æœ¯æˆ–æ¡†æ¶, å¦‚åæ¥çš„WebService, å†åˆ°ç›®å‰çš„netty,shriftç­‰åŸºæœ¬å·²ç»å–ä»£äº†è¿™ç§åŸå§‹çš„è°ƒç”¨æ–¹å¼, ä»–ä»¬æ˜¯éé˜»å¡çš„,ä¸”è¿˜èƒ½è·¨è¯­è¨€è°ƒç”¨. ä½†ç†Ÿæ‚‰RMIçš„å®ç°æ–¹å¼å¯¹äº†è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šä¿¡çš„å®ç°åŸç†æœ‰å¾ˆå¤§å¸®åŠ©.&lt;/p&gt;
</description>
<pubDate>Wed, 19 Sep 2018 14:41:00 +0000</pubDate>
<dc:creator>ç½ªæ¶æ–¯å·´å…‹</dc:creator>
<og:description>RPC(Remote Procedure Call)åè®® RPCåè®®æ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œä»è¿œç¨‹è®¡ç®—æœºä¸Šè¯·æ±‚æœåŠ¡, è€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®, åœ¨OSIæ¨¡å‹ä¸­å¤„åœ¨åº”ç”¨å±‚å’Œç½‘ç»œå±‚. ä½œä¸ºä¸€ä¸ªè§„èŒƒ, ä½¿ç”¨R</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/walkinhalo/p/9678139.html</dc:identifier>
</item>
<item>
<title>ES6è¯­æ³•çš„å­¦ä¹ ä¸å®è·µ - Peerless1029</title>
<link>http://www.cnblogs.com/peerless1029/p/9678130.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/peerless1029/p/9678130.html</guid>
<description>&lt;p&gt;ã€€ã€€ES6æ˜¯JavaScriptè¯­è¨€çš„æ–°ä¸€ä»£æ ‡å‡†ï¼Œæ˜¯ECMAScriptçš„ç¬¬å…­ä¸ªç‰ˆæœ¬ï¼ŒåŠ å…¥äº†å¾ˆå¤šæ–°çš„åŠŸèƒ½å’Œè¯­æ³•ï¼Œåœ¨å¾ˆå¤šæ¡†æ¶ï¼Œå¦‚åœ¨ä½¿ç”¨Vue,Reactç­‰æ¡†æ¶çš„é¡¹ç›®ä¸­ä¸€èˆ¬éƒ½é‡‡ç”¨ES6è¯­æ³•æ¥ç¼–å†™çš„ï¼Œä¸‹é¢å¯¹ç»å¸¸ç”¨åˆ°çš„ES6è¯­æ³•åšç®€è¦çš„ä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€1.let,const&lt;/p&gt;
&lt;p&gt;ã€€ã€€letå’Œconstæ˜¯ES6ä¸­æ–°å¢çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œç”¨æ¥ç”Ÿå‘½å˜é‡ï¼Œletå’Œconstéƒ½æ˜¯å—çº§ä½œç”¨åŸŸã€‚letå£°æ˜çš„å˜é‡åªåœ¨letå‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚constå£°æ˜ä¸€ä¸ªåªè¯»å˜é‡ï¼Œä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸å¯æ›´æ”¹ã€‚ä¸varå£°æ˜çš„å˜é‡ä¸åŒï¼Œvarå£°æ˜çš„æ˜¯å‡½æ•°ä½œç”¨åŸŸï¼Œä¸”å­˜åœ¨å˜é‡æå‡ã€‚ä¾‹å¦‚ï¼šã€€&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; letç¤ºä¾‹&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;   &lt;span&gt;var&lt;/span&gt; a=1&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; 
&lt;span&gt; 5&lt;/span&gt;   let b=2&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; a;  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 1&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt; b;  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ReferenceError:b is not undefined.&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; 
&lt;span&gt;10&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; constç¤ºä¾‹&lt;/span&gt;
&lt;span&gt;11&lt;/span&gt; const c=3&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; c=4; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;  Assignment to constant variable.&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt; 
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; var ç¤ºä¾‹&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt; console.log(d); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; undefined&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; d=3&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; console.log(d); &lt;span&gt;//&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;å£°æ˜æå‰åæµè§ˆå™¨æ‰§è¡Œé¡ºåºä¸ºï¼š
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;var&lt;/span&gt;&lt;span&gt; d;
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; console.log(d); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; undefined&lt;/span&gt;
&lt;span&gt;21&lt;/span&gt; d=3&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; console.log(d); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€2.ç®­å¤´å‡½æ•°&lt;/p&gt;
&lt;p&gt;ã€€ã€€ES6å…è®¸ä½¿ç”¨â€œç®­å¤´â€ï¼ˆ=&amp;gt;ï¼‰å®šä¹‰å‡½æ•°ã€‚è¿™ç§å‡½æ•°åˆ›å»ºçš„å‡½æ•°ä¸éœ€è¦å‡½æ•°å…³é”®å­—ï¼Œå¹¶ä¸”è¿˜å¯ä»¥çœç•¥returnå…³é”®å­—ã€‚ä¸æ­¤åŒæ—¶ï¼Œç®­å¤´å‡½æ•°å†…çš„thisæŒ‡å‘å‡½æ•°å®šä¹‰æ—¶æ‰€åœ¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;42&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; foo1=(a,b)=&amp;gt;a+1&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç­‰ä»·äº &lt;/span&gt;
&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; foo1=&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(a,b){
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;   &lt;span&gt;return&lt;/span&gt; a+&lt;span&gt;b;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åœ¨returnåªæœ‰ä¸€ä¸ªè¡¨è¾¾å¼æ—¶ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°å¯ä»¥çœç•¥returnå’Œ{}&lt;/span&gt;
&lt;span&gt; 7&lt;/span&gt; 
&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; name='jhon'&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; obj=&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;   name:&quot;tom&quot;&lt;span&gt;,
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;   sayName1:&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;     setTimeout(&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;       console.log(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name)
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;     },500&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;  sayName2:&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     setTimeout(()=&amp;gt;&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;       console.log(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name)
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     },500&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;  },
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; obj.sayName1(); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; jhon&lt;/span&gt;
&lt;span&gt;23&lt;/span&gt; obj.sayName2(); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; tom&lt;/span&gt;
&lt;span&gt;24&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç¬¬ä¸€ä¸ªthiså€¼windowå¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ–¹æ³•é‡Œé¢æŒ‡å‘å½“å‰çš„objå¯¹è±¡ï¼Œ&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€å°ç»“ï¼š1.ä½¿ç”¨ç®­å¤´å‡½æ•°å¯ä»¥ç®€å†™ä»£ç é‡ï¼›2.å¯ä»¥æ”¹å˜thisçš„æŒ‡å‘ï¼Œå¯ä»¥æ›¿ä»£apply,call,bindä¸€äº›æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€3.æ¨¡æ¿å­—ç¬¦ä¸²&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç›¸ä¿¡è®¸å¤šå°ä¼™ä¼´åœ¨jsé‡Œé¢ç”¨â€˜â€™ï¼Œ+æ‹¼æ¥å­—ç¬¦ä¸²å¾ˆè®©äººå¤´ç–¼äº†ï¼Œå¦‚æœå­—ç¬¦ä¸²é‡æ¯”è¾ƒå°‘è¿˜å¥½ï¼Œä¸€æ—¦æ¯”è¾ƒå¤šï¼Œæœ€åæ‹¼çš„è‡ªå·±éƒ½ä¸è®¤è¯†äº†ï¼Œè€Œä¸”ä¸¥é‡å½±å“ä»£ç çš„æ•´æ´ä¼˜é›…åº¦ã€‚ES6çš„åå¼•å·ï¼ˆ``ï¼‰æ ‡è¯†å­—ç¬¦ä¸²ï¼Œé™¤äº†å¯ä»¥å½“åšæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨å¤–ï¼Œè¿˜å¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œä»¥åŠåœ¨å­—ç¬¦ä¸²å†…åµŒå…¥å˜é›¶ï¼ŒåŠŸèƒ½å¾ˆå¼ºå¤§ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ™®é€šå­—ç¬¦ä¸²&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;`Hello World`
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¤šè¡Œå­—ç¬¦ä¸²&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;`Hello Worldï¼Œ
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;   Hello JavaScript!
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;`
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å­—ç¬¦ä¸²å†…åµŒå…¥å˜é‡&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; let name='Peer'&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; `Hello,${name}`
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€4.è§£æ„èµ‹å€¼&lt;/p&gt;
&lt;p&gt;ã€€ã€€ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;div class=&quot;cnblogs_code&quot; readability=&quot;53&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ•°ç»„è§£æ„&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; [a,b,c]=[1,2,3&lt;span&gt;];
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; a &lt;span&gt;//&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt; b &lt;span&gt;//&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; c &lt;span&gt;//&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;
&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯¹è±¡è§£æ„&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt; let name='Peer'&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; let age=23&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; let person=&lt;span&gt;{name,age};
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; person &lt;span&gt;//&lt;/span&gt;&lt;span&gt;{name:&quot;Peer&quot;,age:23}&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt; 
&lt;span&gt;13&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å‡½æ•°çš„å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ï¼Œä¾‹å¦‚ï¼š&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ•°ç»„çš„å‚æ•°è§£æ„&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; sum([x,y]){
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;   &lt;span&gt;return&lt;/span&gt; x+&lt;span&gt;y;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; sum([1,2]); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯¹è±¡çš„å‚æ•°è§£æ„&lt;/span&gt;
&lt;span&gt;20&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; sum2({x,y}){
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;   &lt;span&gt;return&lt;/span&gt; x+&lt;span&gt;y;
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; sum2({x:5,y:6}); &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 11&lt;/span&gt;
&lt;span&gt;24&lt;/span&gt; 
&lt;span&gt;25&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è§£æ„åŒæ ·é€‚ç”¨äºåµŒå¥—çš„æ•°ç»„ä¸å¯¹è±¡&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åµŒå¥—æ•°ç»„è§£æ„&lt;/span&gt;
&lt;span&gt;27&lt;/span&gt; let [a,[b],c]=[1,[2],3&lt;span&gt;]
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; a; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;
&lt;span&gt;29&lt;/span&gt; b; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;
&lt;span&gt;30&lt;/span&gt; c: &lt;span&gt;//&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;
&lt;span&gt;31&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åµŒå¥—å¯¹è±¡è§£æ„&lt;/span&gt;
&lt;span&gt;32&lt;/span&gt; let {person:{name,age},foo}={person:{name:&quot;Peer&quot;,age:23},foo:&quot;foo&quot;&lt;span&gt;}
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; name;  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; &quot;Peer&quot;&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt; age;  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 23&lt;/span&gt;
&lt;span&gt;35&lt;/span&gt; foo; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; &quot;foo&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€å°ç»“ï¼šå¯¹è±¡å’Œæ•°ç»„çš„è§£æ„åªéœ€å’Œå£°æ˜å¥½çš„å¯¹è±¡æ•°ç»„å½¢å¼ä¿æŒä¸€è‡´å³å¯ï¼Œåœ¨è·å–å¯¹è±¡é‡Œé¢çš„å±æ€§å€¼è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œåœ¨Vueï¼ŒReactç­‰æ¡†æ¶çš„å¼€å‘ä¸­ä¹Ÿç”¨çš„æ¯”è¾ƒå¤šï¼Œå¦‚:import { a , b , c } from 'component',æ‰€ä»¥ä¸éš¾ç†è§£è¿™æ®µä»£ç ï¼Œå°±æ˜¯æŠŠcomponentè¿™ä¸ªæ¨¡å—é‡Œé¢çš„å•Šï¼Œa,b,cå±æ€§å¯¹åº”çš„å€¼å–å‡ºæ¥å†åˆ†åˆ«èµ‹å€¼ç»™a,b,cå˜é‡ï¼Œç¡®å®å¤§å¤§ç®€åŒ–äº†ä»£ç ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;5.restå‚æ•°&lt;/p&gt;
&lt;p&gt;ã€€ã€€restæ‰“å¼€è½¯ä»¶ç¿»è¯‘ä¸ºï¼šä¼‘æ¯; å‰©ä½™éƒ¨åˆ†; æ”¯æŒç‰©; å®é™ï¼Œå®‰å®ã€‚ES6å¼•å…¥restå‚æ•°ï¼ˆå½¢å¼ä¸º...å˜é›¶åï¼‰ç”¨äºè·å–å¤šæ•°çš„å¤šä½™å‚æ•°ï¼Œä»¥æ›¿ä»£argumentså¯¹è±¡çš„ä½¿ç”¨ã€‚restå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¤šä½™çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; printName(a,...names){
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt; &lt;span&gt;  console.log(a);
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; &lt;span&gt;  console.log(names)
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; printName(&quot;Peer&quot;,&quot;jhon&quot;,&quot;toom&quot;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;6&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; Peer&lt;/span&gt;
&lt;span&gt;7&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;[&quot;jhon&quot;, &quot;toom&quot;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;6.æ‰©å±•è¿ç®—ç¬¦&lt;/p&gt;
&lt;p&gt;ã€€ã€€æ‰©å±•è¿ç®—ç¬¦æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆ...ï¼‰,å®ƒå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ï¼Œç±»ä¼¼äºrestå‚æ•°çš„é€†è¿ç®—ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;1&lt;/span&gt; &lt;span&gt;function&lt;/span&gt;&lt;span&gt; sum(a,b,c){
&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;   &lt;span&gt;return&lt;/span&gt; a+b+&lt;span&gt;c;
&lt;/span&gt;&lt;span&gt;3&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;4&lt;/span&gt; sum(...[1,2,3&lt;span&gt;])
&lt;/span&gt;&lt;span&gt;5&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;7.import ,export&lt;/p&gt;
&lt;p&gt;ã€€ã€€ES6å®ç°äº†è‡ªå·±çš„æ¨¡å—åŒ–è¡¨æ ‡å‡†ï¼Œåœ¨è¯­è¨€å±‚é¢ä¸Šå®ç°äº†æ¨¡å—åŒ–ï¼Œå®ƒé€æ¸å–ä»£äº†CommonJSå’ŒAMDè§„èŒƒã€‚ES6çš„æ¨¡å—åŠŸèƒ½ä¸»è¦æœ‰ä¸¤ä¸ªå…³é”®å­—æ„æˆï¼šexportå’Œimportã€‚exportç”¨äºè§„å®šæ¨¡å—å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œimportç”¨äºå¼•å…¥å…¶ä»–æ¨¡å—æä¾›çš„æ¥å£ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; a.js&lt;/span&gt;
const a=&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
  &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; 'this is a.js'&lt;span&gt;
}
export &lt;/span&gt;&lt;span&gt;default&lt;/span&gt;&lt;span&gt; a;
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; b.js&lt;/span&gt;
const b=&lt;span&gt;function&lt;/span&gt;&lt;span&gt;(){
  &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; 'this is b.js'&lt;span&gt;
}
export {b}
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; c.js&lt;/span&gt;
import a from './a'&lt;span&gt;;
import {b} from &lt;/span&gt;'./b'&lt;span&gt;;
console.log(a,b); &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; 'this is a.js', 'this is b.js'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€å°ç»“ï¼šES6çš„æ¨¡å—åŒ–è§£å†³äº†JavaScriptæ²¡æœ‰æ¨¡å—åŒ–ç³»ç»Ÿçš„ç¼ºé™·ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾—å„ä¸ªæ¨¡å—ç›¸äº’ç‹¬ç«‹ï¼Œæœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸã€‚&lt;/p&gt;
&lt;p&gt;8.Class&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å®šä¹‰ä¸€ä¸ªç±»&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;class Person{
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;  constructor(name,age){
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.name=&lt;span&gt;name;
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;     &lt;span&gt;this&lt;/span&gt;.age=&lt;span&gt;age;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;  getName(){
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.name;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; person=&lt;span&gt;new&lt;/span&gt; Person(&quot;Peer&quot;,23&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; 
&lt;span&gt;13&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é€šè¿‡extends å…³é”®å­—å®ç°ç»§æ‰¿&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;class Man extends Person{
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;  constructor(anme,age){
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    super(name,age)
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;  getGender(){
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; 'male'
&lt;span&gt;20&lt;/span&gt; &lt;span&gt;  }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;var&lt;/span&gt; man=&lt;span&gt;new&lt;/span&gt; Man(&quot;Peer&quot;,23&lt;span&gt;)ï¼›&lt;br/&gt;23 man.getName(); //Peer&lt;br/&gt;&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; console.dir(man);
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1103967/201809/1103967-20180919221404440-969472432.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä»æ‰“å°manå¯¹è±¡çš„ç»“æ„æ¥çœ‹ï¼ŒgetGenderæ˜¯ManåŸå‹çš„æ–¹æ³•ï¼ŒgetNameæ˜¯Manç»§æ‰¿Personçš„æ„é€ æ–¹æ³•ï¼Œman.getName()æ–¹æ³•é¦–å…ˆå†man.__proto__çš„åŸå‹ä¸ŠæŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å°±åœ¨man.__proto__.proto__ä¸ŠæŸ¥æ‰¾ï¼Œäºæ˜¯ä¸€çº§ä¸€çº§å°±æ„æˆäº†ä½œç”¨åŸŸé“¾ã€‚&lt;/p&gt;
&lt;p&gt;è¯è¯´å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œä¹¦å†™æ–‡ç« ä¹Ÿæ˜¯è‡ªæˆ‘åæ€ä¸æ€»ç»“çš„è¿‡ç¨‹ã€‚ä»¥ä¸Šå°±æ˜¯ä¸ªäººåœ¨é¡¹ç›®å¼€å‘ä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„åœ°æ–¹åˆ†äº«ç»™å¤§å®¶ï¼Œä¸è¶³ä¹‹å¤„ï¼Œå¤šå¤šæŒ‡æ­£ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒä¹¦ç±ï¼šã€ŠReactè¿›é˜¶ä¹‹è·¯ã€‹ï¼Œã€Šæ·±å…¥æµ…å‡ºWebpackã€‹&lt;/p&gt;



</description>
<pubDate>Wed, 19 Sep 2018 14:39:00 +0000</pubDate>
<dc:creator>Peerless1029</dc:creator>
<og:description>ES6æ˜¯JavaScriptè¯­è¨€çš„æ–°ä¸€ä»£æ ‡å‡†ï¼Œæ˜¯ECMAScriptçš„ç¬¬å…­ä¸ªç‰ˆæœ¬ï¼ŒåŠ å…¥äº†å¾ˆå¤šæ–°çš„åŠŸèƒ½å’Œè¯­æ³•ï¼Œåœ¨å¾ˆå¤šæ¡†æ¶ï¼Œå¦‚åœ¨ä½¿ç”¨Vue,Reactç­‰æ¡†æ¶çš„é¡¹ç›®ä¸­ä¸€èˆ¬éƒ½é‡‡ç”¨ES6è¯­æ³•æ¥ç¼–å†™çš„ï¼Œä¸‹é¢å¯¹ç»å¸¸</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/peerless1029/p/9678130.html</dc:identifier>
</item>
<item>
<title>æµ…è°ˆfinalä¿®é¥°çš„å˜é‡ - å…»ç é’å¹´</title>
<link>http://www.cnblogs.com/zhenghengbin/p/9678123.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zhenghengbin/p/9678123.html</guid>
<description>&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;ä¸€ç›´å¤§æ¦‚çš„çŸ¥é“finalå…³é”®å­—çš„ä½œç”¨ï¼Œä½†æ˜¯è‡ªå·±å®é™…å·¥ä½œä¸­å´å¾ˆå°‘ç”¨ï¼Œé™¤éåœ¨å£°æ˜ä¸€äº›å¸¸é‡å€¼çš„æ—¶å€™ï¼Œä»Šå¤©å¿½ç„¶è‡ªå·±åœ¨é¡¹ç›®ä¸­ç”¨ä¸€ä¸ªmapè¿›è¡Œå­˜å‚¨ä¸€äº›å€¼ã€‚ä¸€å¼€å§‹æˆ‘åªæ˜¯ç”¨privateä¿®é¥°çš„ï¼Œå¿ƒé‡Œæƒ³çš„æ˜¯å¦‚æœfinalä¿®é¥°çš„è¯ï¼Œåº”è¯¥ä¸èƒ½ä¿®æ”¹äº†ã€‚æ¯•ç«Ÿè¢«finalä¿®é¥°çš„å˜é‡ä¸å¯å˜ã€‚ä»Šå¤©å›å®¶åï¼Œåšäº†ä¸‹é¢çš„å°è¯•ï¼Œå½»åº•æš´éœ²å‡ºè‡ªå·±åŸºç¡€çš„ä¸æ‰å®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;finalçš„ä½œç”¨&quot;&gt;finalçš„ä½œç”¨&lt;/h3&gt;
&lt;ul readability=&quot;0&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;è¢«finalä¿®é¥°çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;è¢«finalä¿®é¥°çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;strong&gt;è¢«finalä¿®é¥°çš„å˜é‡ä¸å¯å˜&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;å®æˆ˜æ¼”ç¤º&quot;&gt;å®æˆ˜æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;1ã€é¦–å…ˆçœ‹ä¸‹é¢ä»£ç &lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;public class FinalDemo {
    private static final Map&amp;lt;String, Object&amp;gt; NAME = new HashMap&amp;lt;&amp;gt;(16);
    private static final List&amp;lt;String&amp;gt; LIST = new ArrayList&amp;lt;&amp;gt;(10);
    private static final String[] TYPE = new String[15];
    private static final StringBuilder SB = new StringBuilder(&quot;22&quot;);
    private static final StringBuffer SBU = new StringBuffer(&quot;22&quot;);
    private static final String S = &quot;44&quot;;
    private static final int num = 44;
    private static final String S1 = new String();



    public void setName() {
        NAME.put(&quot;1&quot;, &quot;maomao&quot;);
        LIST.add(&quot;11&quot;);
        TYPE[0] = &quot;1&quot;;
        SB.append(&quot;12&quot;);
        SBU.append(&quot;32&quot;);
        System.out.println(NAME);
        System.out.println(LIST);
        System.out.println(Arrays.asList(TYPE));
        System.out.println(SB.toString());
        System.out.println(SBU.toString());
    }

    public static void main(String[] args) {
        FinalDemo finalDemo = new FinalDemo();
        finalDemo.setName();
    }


}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;2ã€è¿è¡Œç»“æœ&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{1=maomao}
[11]
[1, null, null, null, null, null, null, null, null, null, null, null, null, null, null]
2212
2232
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;3ã€ç”±æ­¤å¯è§ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ç”¨äº†mapã€listã€æ•°ç»„ã€StringBuilder ã€StringBuffer .å®ƒä»¬çš„å†…å®¹æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚&lt;/li&gt;
&lt;li&gt;Stringå’ŒåŸºæœ¬æ•°æ®ç±»å‹ä¿®é¥°çš„å˜é‡ã€‚åŒæ ·finalè¡¨ç¤ºåœ°å€ä¸èƒ½ä¿®æ”¹ï¼Œä½†æ˜¯åœ°å€çš„å­˜å‚¨è·Ÿå¸¸é‡çš„å€¼æœ‰å…³ï¼Œç»™ä»–é‡æ–°èµ‹å€¼ä¼šæŒ‡å‘å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œåœ°å€å°±æ”¹å˜äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;è¢«finalä¿®é¥°çš„å˜é‡ï¼Œä¸å¯å˜çš„æ˜¯&lt;strong&gt;å˜é‡çš„å¼•ç”¨&lt;/strong&gt;ï¼Œè€Œä¸æ˜¯å˜é‡çš„å†…å®¹&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œfinalè¿˜æœ‰å…¶ä»–ä½œç”¨ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è¢«finalä¿®é¥°çš„å¸¸é‡ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;è¿™ä¸€å—æš‚æ—¶ä¸å…ˆæ¢è®¨ï¼Œç°åœ¨è‡ªå·±æ°´å¹³è¿˜æ²¡åˆ°ã€‚è¿˜éœ€è¦ç»§ç»­åŠªåŠ›ã€‚&lt;/p&gt;
</description>
<pubDate>Wed, 19 Sep 2018 14:38:00 +0000</pubDate>
<dc:creator>å…»ç é’å¹´</dc:creator>
<og:description>æµ…è°ˆfinalä¿®é¥°çš„å˜é‡</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/zhenghengbin/p/9678123.html</dc:identifier>
</item>
<item>
<title>åŸºäº.net core webapiå’Œmongodbçš„æ—¥å¿—ç³»ç»Ÿ - å»æµ·è¾¹ç”Ÿæ´»</title>
<link>http://www.cnblogs.com/betterlife/p/9676033.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/betterlife/p/9676033.html</guid>
<description>&lt;p&gt;å¼€å‘ç¯å¢ƒvs2017,æ•°æ®å†™å…¥åˆ°mongodbã€‚æ€è·¯å°±æ˜¯1.æä¾›æ¥å£å†™å…¥æ—¥å¿—ï¼Œ2.åŸºäºæ¥å£å°è£…ç±»åº“ã€‚3.å¼•å…¥ç±»åº“ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆè¦å†™å®ƒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šå¼€æºé¡¹ç›®åƒnlogã€log4netã€elkã€exceptionlessç­‰éƒ½æŒºå¥½çš„ã€‚å°±æ˜¯é™¤äº†å¼•å…¥æ‰€éœ€ç±»åº“ï¼Œè¿˜è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ é…ç½®ï¼Œä¸å–œæ¬¢ã€‚elkåœ¨åˆ†å¸ƒå¼æµ·é‡æ•°æ®æ”¶é›†å’Œæ£€ç´¢æ–¹é¢å¯èƒ½æ›´èƒ½å‘æŒ¥å®ƒçš„ä¼˜åŠ¿ï¼Œå•çº¯è®°æ—¥å¿—ä¹Ÿå¯ä»¥ï¼Œexceptionlesså°±æ˜¯åŸºäºelkçš„ã€‚å°±æƒ³ç€å†™ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ã€å¯ä»¥å‘é‚®ä»¶æŠ¥è­¦çš„ï¼Œç›´æ¥å¼•å…¥ç±»åº“å°±èƒ½ç”¨çš„ä¸€ä¸ªè®°æ—¥å¿—å·¥å…·ï¼Œæ‰€æœ‰çš„é…ç½®ä¿¡æ¯å’Œå…¥åº“éƒ½äº¤ç»™web apiã€‚è¿™æ˜¯å½“æ—¶é—®çš„é—®é¢˜ï¼Œhttps://q.cnblogs.com/q/109489/ã€‚å¹²è„†å°±å®ç°äº†å…ˆ&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹é‡Œçš„ä»£ç å¯èƒ½æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œå¦‚æœæœ‰äº›åœ°æ–¹è§‰å¾—ä¸å¦¥æˆ–è€…å¯ä»¥ç”¨æ›´å¥½çš„æ–¹å¼å®ç°æˆ–ç»„ç»‡ä»£ç ï¼Œè¯·å‘Šè¯‰è¯´ï¼Œæˆ‘æ”¹ã€‚å¦å¤–å®ç°å®Œçš„æ¥å£æ²¡æœ‰åŠ è®¿é—®é™åˆ¶ï¼Œå…ˆé»˜è®¤å†…ç½‘ä½¿ç”¨ï¼Œå½“ç„¶æœ‰çƒ­å¿ƒç½‘å‹ç»™å‡ºå®ç°çš„è¯å°±æ›´å¥½äº†ï¼Œåƒipé™åˆ¶æˆ–è€…ç­¾åç­‰ç­‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ã€å®ç°Web Api&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Â æ–°å»º.net core web apié¡¹ç›® ã€LogWebApiã€‘&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å› ä¸ºè¦å‘é‚®ä»¶å’Œå†™å…¥mongodbï¼Œå…ˆæ”¹é…ç½®æ–‡ä»¶appsettings.json&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43&quot;&gt;
&lt;pre&gt;
{
  &quot;ConnectionStrings&quot;: {
    &quot;ConnectionString&quot;: &quot;mongodb://yourmongoserver&quot;,
    &quot;Database&quot;: &quot;logdb&quot;,
    &quot;LogCollection&quot;: &quot;logdata&quot;
  },
  &quot;AllowedHosts&quot;: &quot;*&quot;,
  &quot;AppSettings&quot;: {
    &quot;SendMailInfo&quot;: {
      &quot;SMTPServerName&quot;: &quot;smtp.qiye.163.com&quot;,
      &quot;SendEmailAdress&quot;: &quot;å‘é€äººé‚®ç®±&quot;,
      &quot;SendEmailPwd&quot;: &quot;&quot;,
      &quot;SiteName&quot;: &quot;é‚®ä»¶ä¸»é¢˜&quot;,
      &quot;SendEmailPort&quot;: &quot;123&quot;
    }
  }
}
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;å®ç°ä¾èµ–æ³¨å…¥è·å–é…ç½®æ–‡ä»¶ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;åˆ›å»ºç›®å½•ç»“æ„å¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919153536967-1336343169.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;AppSettingsç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_8507c80f-ea46-4b10-bad7-6e374e3f52bb&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_8507c80f-ea46-4b10-bad7-6e374e3f52bb&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_8507c80f-ea46-4b10-bad7-6e374e3f52bb&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; AppSettings
    {
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; SendMailInfo SendMailInfo { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; SendMailInfo
    {
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; SMTPServerName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; SendEmailAdress { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; SendEmailPwd { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; SiteName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; SendEmailPort { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;DBSettingsç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_02697d33-de1e-438e-a908-414036b32e0a&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_02697d33-de1e-438e-a908-414036b32e0a&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_02697d33-de1e-438e-a908-414036b32e0a&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ•°æ®åº“é…ç½®ä¿¡æ¯
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; DBSettings
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; mongodb connectionstring
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; ConnectionString { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; mongodb database
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Database { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—collection
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LogCollection { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;Â æ¥ä¸‹æ¥Here is how we modify Startup.cs to inject Settings in the Options accessor model:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_8a96d4d5-b8e7-428e-81f9-ae969c8eb9c8&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_8a96d4d5-b8e7-428e-81f9-ae969c8eb9c8&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_8a96d4d5-b8e7-428e-81f9-ae969c8eb9c8&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; ConfigureServices(IServiceCollection services)
        {            
            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);

            services.Configure&lt;/span&gt;&amp;lt;DBSettings&amp;gt;(Configuration.GetSection(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ConnectionStrings&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ•°æ®åº“è¿æ¥ä¿¡æ¯&lt;/span&gt;
            services.Configure&amp;lt;AppSettings&amp;gt;(Configuration.GetSection(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AppSettings&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å…¶ä»–é…ç½®ä¿¡æ¯            &lt;/span&gt;
&lt;span&gt;
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;åœ¨é¡¹ç›®ä¸­å°†é€šè¿‡IOptions æ¥å£æ¥è·å–é…ç½®ä¿¡æ¯ï¼Œåé¢çœ‹ä»£ç å§&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
IOptions&amp;lt;AppSettings&amp;gt;&lt;span&gt;
IOptions&lt;/span&gt;&amp;lt;DBSettings&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶ä¿¡æ¯è·å–ç®—æ˜¯å‡†å¤‡å®Œäº†&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºæ—¥å¿—ä¿¡æ¯Model&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;åœ¨Modelæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç±»LogEventDataï¼Œä¹Ÿå°±æ˜¯å­˜åˆ°mongodbçš„ä¿¡æ¯&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33.5&quot;&gt;&lt;img id=&quot;code_img_closed_5dbea430-9234-468e-8a62-3608941b66a6&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_5dbea430-9234-468e-8a62-3608941b66a6&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_5dbea430-9234-468e-8a62-3608941b66a6&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;62&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogEventData
    {
        [BsonId]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; ObjectId Id { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¶é—´
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        [BsonDateTimeOptions(Representation = BsonType.DateTime, Kind =&lt;span&gt; DateTimeKind.Local)]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; DateTime Date { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é”™è¯¯çº§åˆ«
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Level { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ¥æº
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LogSource { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—ä¿¡æ¯
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Message { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç±»å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; ClassName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ–¹æ³•å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; MethodName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; å®Œæ•´ä¿¡æ¯
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; FullInfo { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¡Œå·
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LineNumber { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ–‡ä»¶å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; FileName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ip
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; IP { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡é€—å·éš”å¼€
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;        [JsonIgnore]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Emails { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;override&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; ToString()
        {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; JsonConvert.SerializeObject(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;å®šä¹‰database Context&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;ç«™ç‚¹æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶å¤¹Contextå’Œç±»ï¼Œåˆ«å¿˜äº†å¼•ç”¨ MongoDB.DriverÂ  nugetåŒ…&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919161111480-1002467753.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_8e5fb65f-f9b6-45b8-8258-f3d8084adb26&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_8e5fb65f-f9b6-45b8-8258-f3d8084adb26&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_8e5fb65f-f9b6-45b8-8258-f3d8084adb26&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; MongoContext
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; IMongoDatabase _database = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; _logCollection;
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; MongoContext(IOptions&amp;lt;DBSettings&amp;gt;&lt;span&gt; settings)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; client = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MongoClient(settings.Value.ConnectionString);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (client != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                _database &lt;/span&gt;=&lt;span&gt; client.GetDatabase(settings.Value.Database);
            _logCollection &lt;/span&gt;=&lt;span&gt; settings.Value.LogCollection;
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; IMongoCollection&amp;lt;LogEventData&amp;gt;&lt;span&gt; LogEventDatas
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; _database.GetCollection&amp;lt;LogEventData&amp;gt;&lt;span&gt;(_logCollection);
            }
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;æ·»åŠ Repository&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;åˆ«çº ç»“ä¸ºä»€ä¹ˆå«è¿™ä¸ªåäº†ï¼Œå°±æ˜¯æ•°æ®è®¿é—®ç±»ï¼Œåƒæ˜¯å¸¸ç”¨çš„DALï¼Œåˆ›å»ºç›®å½•å¦‚ä¸‹ï¼Œä¹‹åå¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥æ¥è®¿é—®å…·ä½“å®ç°&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919162605014-1431221088.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;IRepositoryç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;&lt;img id=&quot;code_img_closed_705243c8-cdad-4d4b-8da6-68f361130671&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_705243c8-cdad-4d4b-8da6-68f361130671&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_705243c8-cdad-4d4b-8da6-68f361130671&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;59&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; IRepository&amp;lt;T&amp;gt; &lt;span&gt;where&lt;/span&gt; T:&lt;span&gt;class&lt;/span&gt;&lt;span&gt;
    {
        Task&lt;/span&gt;&amp;lt;IEnumerable&amp;lt;T&amp;gt;&amp;gt;&lt;span&gt; GetAll();
        Task&lt;/span&gt;&amp;lt;T&amp;gt; Get(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; id);
        Task Add(T item);
        Task&lt;/span&gt;&amp;lt;&lt;span&gt;bool&lt;/span&gt;&amp;gt; Remove(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; id);
        Task&lt;/span&gt;&amp;lt;&lt;span&gt;bool&lt;/span&gt;&amp;gt; Update(&lt;span&gt;string&lt;/span&gt; id, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; body);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;LogRepositoryç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35.5&quot;&gt;&lt;img id=&quot;code_img_closed_5dcd2d27-7f81-4f83-9c3d-74e9e0707e2b&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_5dcd2d27-7f81-4f83-9c3d-74e9e0707e2b&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_5dcd2d27-7f81-4f83-9c3d-74e9e0707e2b&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;66&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; LogRepository : IRepository&amp;lt;LogEventData&amp;gt;&lt;span&gt;
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; MongoContext _context = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; LogRepository(IOptions&amp;lt;DBSettings&amp;gt;&lt;span&gt; settings)
        {
            _context &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MongoContext(settings);
        }


        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;async&lt;/span&gt;&lt;span&gt; Task Add(LogEventData item)
        {
            &lt;/span&gt;&lt;span&gt;await&lt;/span&gt;&lt;span&gt; _context.LogEventDatas.InsertOneAsync(item);
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; Task&amp;lt;IEnumerable&amp;lt;LogEventData&amp;gt;&amp;gt;&lt;span&gt; GetList(QueryLogModel model)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; builder = Builders&amp;lt;LogEventData&amp;gt;&lt;span&gt;.Filter;
            FilterDefinition&lt;/span&gt;&amp;lt;LogEventData&amp;gt; filter =&lt;span&gt; builder.Empty;
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(model.Level))
            {
                filter &lt;/span&gt;= builder.Eq(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Level&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, model.Level);
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(model.LogSource))
            {
                filter &lt;/span&gt;= filter &amp;amp; builder.Eq(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;LogSource&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, model.LogSource);
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(model.Message))
            {
                filter &lt;/span&gt;= filter &amp;amp; builder.Regex(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Message&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;new&lt;/span&gt; BsonRegularExpression(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Regex(model.Message)));
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (DateTime.MinValue !=&lt;span&gt; model.StartTime)
            {
                filter &lt;/span&gt;= filter &amp;amp; builder.Gte(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Date&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, model.StartTime);
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(DateTime.MinValue !=&lt;span&gt; model.EndTime)
            {
                filter &lt;/span&gt;= filter &amp;amp; builder.Lte(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Date&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, model.EndTime);
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;await&lt;/span&gt;&lt;span&gt; _context.LogEventDatas.Find(filter)
                 .SortByDescending(log &lt;/span&gt;=&amp;gt;&lt;span&gt; log.Date)
                 .Skip((model.PageIndex &lt;/span&gt;- &lt;span&gt;1&lt;/span&gt;) *&lt;span&gt; model.PageSize)
                 .Limit(model.PageSize).ToListAsync();
        }
        &lt;/span&gt;&lt;span&gt;#region&lt;/span&gt; æœªå®ç°æ–¹æ³•
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; Task&amp;lt;LogEventData&amp;gt; Get(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; id)
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NotImplementedException();
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; Task&amp;lt;IEnumerable&amp;lt;LogEventData&amp;gt;&amp;gt;&lt;span&gt; GetAll()
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NotImplementedException();
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Task&amp;lt;&lt;span&gt;bool&lt;/span&gt;&amp;gt; Remove(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; id)
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NotImplementedException();
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Task&amp;lt;&lt;span&gt;bool&lt;/span&gt;&amp;gt; Update(&lt;span&gt;string&lt;/span&gt; id, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; body)
        {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NotImplementedException();
        } 
        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;&lt;span&gt;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;Â ä¸ºäº†é€šè¿‡DI modelæ¥è®¿é—®LogRepositoryï¼Œä¿®æ”¹Startup.cs ï¼ŒConfigureServicesæ·»åŠ å¦‚ä¸‹ä»£ç &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
services.AddTransient&amp;lt;IRepository&amp;lt;LogEventData&amp;gt;, LogRepository&amp;gt;();//æ•°æ®è®¿é—®
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Â åˆ°è¿™åŸºæœ¬çš„æ•°æ®å†™å…¥å’ŒæŸ¥è¯¢ç®—æ˜¯å†™å®Œäº†ï¼Œä¸‹é¢æ¥å®ç°Controller&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºLogController&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919164153001-1121233476.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;&lt;img id=&quot;code_img_closed_9a7f5f69-c08c-4ac8-a9de-382718ebb7fc&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_9a7f5f69-c08c-4ac8-a9de-382718ebb7fc&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_9a7f5f69-c08c-4ac8-a9de-382718ebb7fc&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;63&quot;&gt;
&lt;pre&gt;
[Route(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;api/[controller]&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
    [ApiController]
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogController : ControllerBase
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt;&lt;span&gt; LogRepository _logRepository;
        IOptions&lt;/span&gt;&amp;lt;AppSettings&amp;gt;&lt;span&gt; _appsettings;        
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; LogController(IRepository&amp;lt;LogEventData&amp;gt; logRepository,IOptions&amp;lt;AppSettings&amp;gt;&lt;span&gt; appsettings)
        {
            _logRepository &lt;/span&gt;=&lt;span&gt; (LogRepository)logRepository;
            _appsettings &lt;/span&gt;=&lt;span&gt; appsettings;
        }

        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;trace&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Trace([FromBody] LogEventData value)
        {
            Add(value);
        }
        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;debug&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Debug([FromBody] LogEventData value)
        {
            Add(value);

        }
        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;info&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Info([FromBody] LogEventData value)
        {
            Add(value);
        }
        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;warn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Warn([FromBody] LogEventData value)
        {
            Add(value);
        }
        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Error([FromBody] LogEventData value)
        {
            Add(value);
        }
        [Route(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        [HttpPost]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Fatal([FromBody] LogEventData value)
        {
            Add(value);
        }
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; Add(LogEventData data)
        {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (data != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;await&lt;/span&gt;&lt;span&gt; _logRepository.Add(data);
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(data.Emails))
                {
                    &lt;/span&gt;&lt;span&gt;new&lt;/span&gt; EmailHelpers(_appsettings).SendMailAsync(data.Emails, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç›‘æµ‹é‚®ä»¶&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, data.ToString());
                }
            }
        }

        [HttpGet(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;getlist&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; Task&amp;lt;ResponseModel&amp;lt;IEnumerable&amp;lt;LogEventData&amp;gt;&amp;gt;&amp;gt;&lt;span&gt; GetList([FromQuery] QueryLogModel model)
        {
            ResponseModel&lt;/span&gt;&amp;lt;IEnumerable&amp;lt;LogEventData&amp;gt;&amp;gt; resp = &lt;span&gt;new&lt;/span&gt; ResponseModel&amp;lt;IEnumerable&amp;lt;LogEventData&amp;gt;&amp;gt;&lt;span&gt;();
            resp.Data &lt;/span&gt;= &lt;span&gt;await&lt;/span&gt;&lt;span&gt; _logRepository.GetList(model);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; resp;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;æ§åˆ¶å™¨é‡Œæ•´ä¸ªé€»è¾‘å¾ˆç®€å•ï¼Œé™¤äº†å‘å¤–æä¾›ä¸åŒæ—¥å¿—çº§åˆ«çš„å†™å…¥æ¥å£ï¼Œä¹Ÿå®ç°äº†æ—¥å¿—æŸ¥è¯¢æ¥å£ç»™æ—¥å¿—æŸ¥çœ‹ç«™ç‚¹ç”¨ï¼ŒåŸºæœ¬ä¸Šå¤Ÿç”¨äº†ã€‚åˆ°è¿™ç¼–è¯‘çš„è¯ä¼šæŠ¥é”™ï¼Œæœ‰ä¸€äº›ç±»è¿˜æ²¡åŠ ä¸Šï¼Œç¨ååŠ ä¸Šã€‚åœ¨Addæ–¹æ³•å†…éƒ¨ï¼Œç”¨åˆ°äº†newÂ EmailHelpersã€‚è®²é“ç†æŒ‰.net core å¯¹ä¾èµ–æ³¨å…¥çš„ä½¿ç”¨ ï¼Œè¿™ä¸ª newæ˜¯ä¸åº”è¯¥å‡ºç°åœ¨è¿™çš„ï¼Œå°±å…ˆè¿™ä¹ˆç€å§ï¼Œä¸‹é¢è¡¥ç±»ï¼š&lt;/p&gt;
&lt;p&gt;å…ˆåˆ›å»ºModelæ–‡ä»¶å¤¹ä¸‹çš„ä¸¤ä¸ªç±»ï¼Œå¾ˆç®€å•å°±ä¸è§£é‡Šäº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919165246984-1420520706.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;QueryLogModelç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_ba539ee6-18c6-41eb-98bb-a53ec6318429&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_ba539ee6-18c6-41eb-98bb-a53ec6318429&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_ba539ee6-18c6-41eb-98bb-a53ec6318429&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; QueryLogModel
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; _pageindex = &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; _pagesize = &lt;span&gt;20&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; PageIndex
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; _pageindex; }
            &lt;/span&gt;&lt;span&gt;set&lt;/span&gt; { _pageindex =&lt;span&gt; value; }
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; PageSize
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; _pagesize; }
            &lt;/span&gt;&lt;span&gt;set&lt;/span&gt; { _pagesize =&lt;span&gt; value; }
        }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Level { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LogSource { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Message { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; DateTime StartTime { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; DateTime EndTime { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ResponseModelç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_148dd8d0-31e4-4d39-9a5a-3d95edd7b6f8&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_148dd8d0-31e4-4d39-9a5a-3d95edd7b6f8&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_148dd8d0-31e4-4d39-9a5a-3d95edd7b6f8&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; ResponseModel&amp;lt;T&amp;gt;&lt;span&gt;
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; HttpStatusCode _resultCode =&lt;span&gt; HttpStatusCode.OK;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _message = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;è¯·æ±‚æˆåŠŸ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;        
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; T _data = &lt;span&gt;default&lt;/span&gt;&lt;span&gt;(T);
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¿”å›ç 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; HttpStatusCode ResultCode
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;._resultCode; }
            &lt;/span&gt;&lt;span&gt;set&lt;/span&gt; { &lt;span&gt;this&lt;/span&gt;._resultCode =&lt;span&gt; value; }
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç»“æœè¯´æ˜
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; Message
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;._message; }
            &lt;/span&gt;&lt;span&gt;set&lt;/span&gt; { &lt;span&gt;this&lt;/span&gt;._message =&lt;span&gt; value; }
        }        
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¿”å›çš„æ•°æ®
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; T Data
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;._data; }
            &lt;/span&gt;&lt;span&gt;set&lt;/span&gt; { &lt;span&gt;this&lt;/span&gt;._data =&lt;span&gt; value; }
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;Â åˆ›å»ºEmailHelpersç±»&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919165724474-827162712.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37.5&quot;&gt;&lt;img id=&quot;code_img_closed_d2e1413e-5009-46a9-8f10-caec19768dfe&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_d2e1413e-5009-46a9-8f10-caec19768dfe&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_d2e1413e-5009-46a9-8f10-caec19768dfe&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;70&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; EmailHelpers
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; SendMailInfo _mailinfo;
        
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; EmailHelpers(IOptions&amp;lt;AppSettings&amp;gt;&lt;span&gt; appsettings)
        {
            _mailinfo &lt;/span&gt;=&lt;span&gt; appsettings.Value.SendMailInfo;
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; å¼‚æ­¥å‘é€é‚®ä»¶
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;emailåœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;subject&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é‚®ä»¶æ ‡é¢˜&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;content&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é‚®ä»¶å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; SendMailAsync(&lt;span&gt;string&lt;/span&gt; emails, &lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; content)
        {
            Task.Factory.StartNew(() &lt;/span&gt;=&amp;gt;&lt;span&gt;
            {
                SendEmail(emails, subject, content);
            });
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é‚®ä»¶å‘é€æ–¹æ³•
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;emailåœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;subject&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é‚®ä»¶æ ‡é¢˜&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;content&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é‚®ä»¶å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; SendEmail(&lt;span&gt;string&lt;/span&gt; emails, &lt;span&gt;string&lt;/span&gt; subject, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; content)
        {
            &lt;/span&gt;&lt;span&gt;string&lt;/span&gt;[] emailArray = emails.Split(&lt;span&gt;new&lt;/span&gt; &lt;span&gt;char&lt;/span&gt;[] { &lt;span&gt;'&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt; }, StringSplitOptions.RemoveEmptyEntries);
            &lt;/span&gt;&lt;span&gt;string&lt;/span&gt; fromSMTP = _mailinfo.SMTPServerName;        &lt;span&gt;//&lt;/span&gt;&lt;span&gt;é‚®ä»¶æœåŠ¡å™¨&lt;/span&gt;
            &lt;span&gt;string&lt;/span&gt; fromEmail = _mailinfo.SendEmailAdress;      &lt;span&gt;//&lt;/span&gt;&lt;span&gt;å‘é€æ–¹é‚®ä»¶åœ°å€&lt;/span&gt;
            &lt;span&gt;string&lt;/span&gt; fromEmailPwd = _mailinfo.SendEmailPwd;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å‘é€æ–¹é‚®ä»¶åœ°å€å¯†ç &lt;/span&gt;
            &lt;span&gt;string&lt;/span&gt; fromEmailName = _mailinfo.SiteName;   &lt;span&gt;//&lt;/span&gt;&lt;span&gt;å‘é€æ–¹ç§°å‘¼&lt;/span&gt;
            &lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ–°å»ºä¸€ä¸ªMailMessageå¯¹è±¡&lt;/span&gt;
                MailMessage aMessage = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MailMessage();
                aMessage.From &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MailAddress(fromEmail, fromEmailName);
                &lt;/span&gt;&lt;span&gt;foreach&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; item &lt;span&gt;in&lt;/span&gt;&lt;span&gt; emailArray)
                {
                    aMessage.To.Add(item);
                }
                aMessage.Subject &lt;/span&gt;=&lt;span&gt; subject;
                aMessage.Body &lt;/span&gt;=&lt;span&gt; content;
                System.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);
                aMessage.BodyEncoding &lt;/span&gt;= Encoding.GetEncoding(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;utf-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                aMessage.IsBodyHtml &lt;/span&gt;= &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
                aMessage.Priority &lt;/span&gt;=&lt;span&gt; MailPriority.High;                
                aMessage.ReplyToList.Add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; MailAddress(fromEmail, fromEmailName));
                SmtpClient smtp &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; SmtpClient();

                smtp.Host &lt;/span&gt;=&lt;span&gt; fromSMTP;
                smtp.Timeout &lt;/span&gt;= &lt;span&gt;20000&lt;/span&gt;&lt;span&gt;;
                smtp.UseDefaultCredentials &lt;/span&gt;= &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
                smtp.EnableSsl &lt;/span&gt;= &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
                smtp.DeliveryMethod &lt;/span&gt;=&lt;span&gt; SmtpDeliveryMethod.Network;
                smtp.Credentials &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; NetworkCredential(fromEmail, fromEmailPwd); &lt;span&gt;//&lt;/span&gt;&lt;span&gt;å‘é‚®ä»¶çš„EMIALå’Œå¯†ç &lt;/span&gt;
                smtp.Port = &lt;span&gt;int&lt;/span&gt;&lt;span&gt;.Parse(_mailinfo.SendEmailPort);                
                smtp.Send(aMessage);
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
            {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex;
            }
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;åˆ°è¿™æ¥å£åŸºæœ¬ä¸Šå°±å¯ä»¥ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å†åŠ ä¸‰ä¸ªä¸œè¥¿&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Â æ·»åŠ å…¨å±€å¼‚å¸¸æ•è·æœåŠ¡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919171820883-1418685616.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ExceptionMiddlewareExtensionsç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34.5&quot;&gt;&lt;img id=&quot;code_img_closed_d20ae6fc-c41f-48d3-9ff2-de5c0569acde&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_d20ae6fc-c41f-48d3-9ff2-de5c0569acde&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_d20ae6fc-c41f-48d3-9ff2-de5c0569acde&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;64&quot;&gt;
&lt;pre&gt;
&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;///&lt;/span&gt;&lt;span&gt; å…¨å±€å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ExceptionMiddlewareExtensions
    {
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; ConfigureExceptionHandler(&lt;span&gt;this&lt;/span&gt; IApplicationBuilder app, IOptions&amp;lt;DBSettings&amp;gt;&lt;span&gt; settings)
        {
            LogRepository _repository &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LogRepository(settings);
            app.UseExceptionHandler(appError &lt;/span&gt;=&amp;gt;&lt;span&gt;
            {
                appError.Run(&lt;/span&gt;&lt;span&gt;async&lt;/span&gt; context =&amp;gt;&lt;span&gt;
                {
                    context.Response.StatusCode &lt;/span&gt;= (&lt;span&gt;int&lt;/span&gt;&lt;span&gt;)HttpStatusCode.InternalServerError;
                    context.Response.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

                    &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; contextFeature = context.Features.Get&amp;lt;IExceptionHandlerFeature&amp;gt;&lt;span&gt;();
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (contextFeature != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                    {
                        &lt;/span&gt;&lt;span&gt;await&lt;/span&gt; _repository.Add(&lt;span&gt;new&lt;/span&gt;&lt;span&gt; LogEventData
                        {
                            Message&lt;/span&gt;=&lt;span&gt; contextFeature.Error.ToString(),
                            Date&lt;/span&gt;=&lt;span&gt;DateTime.Now,
                            Level&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,
                            LogSource&lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;LogWebApi&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
                        }); 
                        &lt;/span&gt;&lt;span&gt;await&lt;/span&gt; context.Response.WriteAsync(context.Response.StatusCode + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;-Internal Server Error.&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                    }
                });
            });
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ä¿®æ”¹Startup.cs&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_e18ed40d-d0dd-4216-ada4-f5e869df95ab&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_e18ed40d-d0dd-4216-ada4-f5e869df95ab&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_e18ed40d-d0dd-4216-ada4-f5e869df95ab&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Configure(IApplicationBuilder app, IHostingEnvironment env,IOptions&amp;lt;DBSettings&amp;gt;&lt;span&gt; settings)
        {            
            app.ConfigureExceptionHandler(settings);
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;æ·»åŠ &lt;a href=&quot;https://msgpack.org/&quot; target=&quot;_blank&quot;&gt;MessagePack&lt;/a&gt;æ‰©å±•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;messagepackå¯ä»¥è®©æˆ‘ä»¬åœ¨postæ•°æ®çš„æ—¶å€™åºåˆ—åŒ–æ•°æ®ï¼Œâ€œå‹ç¼©â€æ•°æ®ä¼ è¾“å¤§å°,è¿™ä¸ªä¼šç»“åˆé’ˆå¯¹æ¥å£å°è£…çš„ç±»åº“é…åˆä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¼•ç”¨nuget: WebApiContrib.Core.Formatter.MessagePack&lt;/p&gt;
&lt;p&gt;åœ¨ConfigureServicesæ·»åŠ ä»£ç &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
&lt;span&gt;services.AddMvcCore().AddMessagePackFormatters();
services.AddMvc().AddMessagePackFormatters();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ‰©å±•äº†&lt;a class=&quot;message&quot; title=&quot;corrected typo and added =&amp;gt; &amp;quot;application/msgpack&amp;quot; media type&quot; href=&quot;https://github.com/WebApiContrib/WebAPIContrib.Core/commit/f0d31ef6a6f4e9a3176586a97fea72b14d5eb5f7&quot; data-pjax=&quot;true&quot;&gt;media type&lt;/a&gt;ï¼Œç”¨ä»¥æ”¯æŒ&lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;&quot;application/x-msgpack&lt;span class=&quot;pl-pds&quot;&gt;&quot;,Â &lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;&quot;application/msgpack&lt;span class=&quot;pl-pds&quot;&gt;&quot;ï¼Œåœ¨æ¥ä¸‹æ¥å°è£…çš„ç±»åº“ä¸­ä¼šä½¿ç”¨&quot;application/x-msgpack&lt;span class=&quot;pl-pds&quot;&gt;&quot;ï¼Œåœ¨web apiæ¥å¼•å…¥è¿™ä¸ªä¸œè¥¿å°±æ˜¯ä¸ºäº†èƒ½è§£æä»å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ·»åŠ Swaggeræ”¯æŒ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;pl-s&quot;&gt;å¼•ç”¨nuget:Swashbuckle.AspNetCore&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;pl-s&quot;&gt;ä¿®æ”¹ConfigureServices&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
services.AddSwaggerGen(c =&amp;gt;&lt;span&gt;
            {
                c.SwaggerDoc(&quot;v1&quot;, new Info { Title = &quot;My API&quot;, Version = &quot;v1&quot;&lt;span&gt; });
            });&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¿®æ”¹Configure&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;&lt;img id=&quot;code_img_closed_9637ab2b-88a9-41f9-b01d-21153c2377bf&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_9637ab2b-88a9-41f9-b01d-21153c2377bf&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_9637ab2b-88a9-41f9-b01d-21153c2377bf&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;65&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Enable middleware to serve generated Swagger as a JSON endpoint.&lt;/span&gt;
&lt;span&gt;            app.UseSwagger();

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Enable middleware to serve swagger-ui (HTML, JS, CSS, etc.), 
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; specifying the Swagger JSON endpoint.&lt;/span&gt;
            app.UseSwaggerUI(c =&amp;gt;&lt;span&gt;
            {
                c.SwaggerEndpoint(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;/swagger/v1/swagger.json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;My API V1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                c.RoutePrefix &lt;/span&gt;= &lt;span&gt;string&lt;/span&gt;.Empty;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åœ¨åº”ç”¨çš„æ ¹ (&lt;/span&gt;&lt;span&gt;http://localhost&lt;/span&gt;&lt;span&gt;:&amp;lt;port&amp;gt;/) å¤„æä¾› Swagger UI&lt;/span&gt;
            });
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™æ•´ä¸ªweb apiç«™ç‚¹ç®—æ˜¯å†™å®Œäº†ï¼Œç¼–è¯‘ä¸å‡ºé”™å°±okäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919175124625-1668291958.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;hr/&gt;&lt;hr/&gt;&lt;p class=&quot;postTitle&quot;&gt;&lt;strong&gt;äºŒã€å®ç°ç±»åº“&lt;/strong&gt;&lt;/p&gt;
&lt;p class=&quot;postTitle&quot;&gt;ç±»åº“æ•´ä½“ç›®å½•ç»“æ„å¦‚ä¸‹&lt;/p&gt;
&lt;p class=&quot;postTitle&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919213903454-1280239758.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p class=&quot;postTitle&quot;&gt;1.æ–°å»ºç±»åº“LogApiHandler&lt;/p&gt;
&lt;p class=&quot;postTitle&quot;&gt;2.å®ç°&lt;/p&gt;
&lt;ul&gt;&lt;li class=&quot;postTitle&quot;&gt;åˆ›å»ºæ—¥å¿—ä¿¡æ¯ç±»ï¼Œå’ŒWebApié‚£ä¸ªå¯¹åº”ï¼ŒLogEventData&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_0fb924f3-aa6f-4624-907a-157a25f37c6c&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_0fb924f3-aa6f-4624-907a-157a25f37c6c&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_0fb924f3-aa6f-4624-907a-157a25f37c6c&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ•°æ®
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; poståˆ°æ—¥å¿—æ¥å£çš„æ•°æ®
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogEventData
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¶é—´
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; DateTime Date { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é”™è¯¯çº§åˆ«
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Level { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ¥æº
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LogSource { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—ä¿¡æ¯
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Message { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç±»å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; ClassName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ–¹æ³•å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; MethodName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; å®Œæ•´ä¿¡æ¯
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; FullInfo { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¡Œå·
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LineNumber { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ–‡ä»¶å
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; FileName { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ip
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; IP { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å· ; éš”å¼€
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Emails { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }    &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºæ—¥å¿—çº§åˆ«ç±»ï¼Œå°±æ˜¯å…¶ä»–å¼€æºé¡¹ç›®å¸¸è§çš„Level&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;&lt;img id=&quot;code_img_closed_1911653e-a40f-4302-b077-25472cf561db&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_1911653e-a40f-4302-b077-25472cf561db&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_1911653e-a40f-4302-b077-25472cf561db&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;73&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogLevel
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Trace log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Trace = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Trace&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;&lt;span&gt;);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Debug log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Debug = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Debug&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Info log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Info = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;2&lt;/span&gt;&lt;span&gt;);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Warn log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Warn = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Warn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;3&lt;/span&gt;&lt;span&gt;);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Error log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Error = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;4&lt;/span&gt;&lt;span&gt;);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Fatal log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;        
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; LogLevel Fatal = &lt;span&gt;new&lt;/span&gt; LogLevel(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;5&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; _ordinal;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; _name;
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Initializes a new instance of &lt;/span&gt;&lt;span&gt;&amp;lt;see cref=&quot;LogLevel&quot;/&amp;gt;&lt;/span&gt;&lt;span&gt;.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;name&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The log level name.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ordinal&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The log level ordinal number.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; LogLevel(&lt;span&gt;string&lt;/span&gt; name, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; ordinal)
        {
            _name &lt;/span&gt;=&lt;span&gt; name;
            _ordinal &lt;/span&gt;=&lt;span&gt; ordinal;
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the name of the log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Name =&amp;gt;&lt;span&gt; _name;
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the ordinal of the log level.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; Ordinal =&amp;gt;&lt;span&gt; _ordinal;
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¯·æ±‚åœ°å€
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; LogApi
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;switch&lt;/span&gt;&lt;span&gt; (_name)
                {
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Trace&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/trace&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Debug&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/debug&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/info&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Warn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/warn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;case&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://localhost:56503/api/log/fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;                        
                    &lt;/span&gt;&lt;span&gt;default&lt;/span&gt;&lt;span&gt;:
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&quot;&lt;/span&gt;&lt;span&gt;;
                }
            }
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Returns the &lt;/span&gt;&lt;span&gt;&amp;lt;see cref=&quot;T:NLog.LogLevel&quot;/&amp;gt;&lt;/span&gt;&lt;span&gt; that corresponds to the supplied &lt;/span&gt;&lt;span&gt;&amp;lt;see langword=&quot;string&quot; /&amp;gt;&lt;/span&gt;&lt;span&gt;.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;levelName&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The textual representation of the log level.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;The enumeration value.&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; LogLevel FromString(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; levelName)
        {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ArgumentNullException(nameof(levelName));
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Trace&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Trace;
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Debug&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Debug;
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Info&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Info;
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Warn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Warn;
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Error;
            }

            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (levelName.Equals(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Fatal&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, StringComparison.OrdinalIgnoreCase))
            {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Fatal;
            }

            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArgumentException($&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Unknown log level: {levelName}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä»£ç æ˜¯NLog Levelæºç ,ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œå› ä¸ºè¿™ä¸ªé¡¹ç›®å¹¶ä¸å¤æ‚ï¼Œä¹Ÿä¸éœ€è¦è¯»é…ç½®ã€‚ç±»é‡Œé¢æœ‰ä¸ªLogApiå±æ€§ä¼šæ ¹æ®çº§åˆ«è¿”å›ç›¸åº”çš„æ—¥å¿—æ¥å£ï¼Œç”Ÿäº§ç¯å¢ƒå¾—åœ¨éƒ¨ç½²å®ŒWebApiç«™ç‚¹ä»¥åï¼Œå°†é‡Œé¢çš„æ¥å£ä¿¡æ¯æ›¿æ¢æ‰ç„¶åç¼–è¯‘å‘å¸ƒå†ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºæ—¥å¿—è¿½è¸ªä¿¡æ¯ç±»ï¼Œè¡Œå·ã€ç±»åã€æ–‡ä»¶ç­‰ç­‰&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;LogEventDataç±»ä¸­æœ‰å‡ ä¸ªå±æ€§å¦‚ä¸‹å›¾ï¼Œæ¥ä¸‹æ¥åˆ›å»ºçš„ç±»å°±æ˜¯ä¸ºäº†è·å–å®ƒä»¬&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919211738917-643555445.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é¡¹ç›®ä¸­åˆ›å»ºæ–‡ä»¶å¤¹Core,ç»“æ„å¦‚ä¸‹ï¼Œåˆ›å»ºé¡ºåºä¸ºMethodItemã€StackFrameItemã€LocationInfoï¼Œå®ƒä»¬å±‚å±‚ç›¸æ‰£ï¼Œæœ€ç»ˆç”±LocationInfoæä¾›æ‰€éœ€ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919211949080-1307514662.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;MethodItemç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34.5&quot;&gt;&lt;img id=&quot;code_img_closed_bd616671-b3ad-4c8d-b271-7c8e4029db3a&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_bd616671-b3ad-4c8d-b271-7c8e4029db3a&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_bd616671-b3ad-4c8d-b271-7c8e4029db3a&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;64&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; MethodItem
    {
        &lt;/span&gt;&lt;span&gt;#region&lt;/span&gt; Public Instance Constructors

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; constructs a method item for an unknown method.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; MethodItem()
        {
            m_name &lt;/span&gt;=&lt;span&gt; NA;
            m_parameters &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;];
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; constructs a method item from the name of the method.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;name&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; MethodItem(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; name)
            : &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;()
        {
            m_name &lt;/span&gt;=&lt;span&gt; name;
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; constructs a method item from the name of the method and its parameters.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;name&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;parameters&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; MethodItem(&lt;span&gt;string&lt;/span&gt; name, &lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] parameters)
            : &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;(name)
        {
            m_parameters &lt;/span&gt;=&lt;span&gt; parameters;
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; constructs a method item from a method base by determining the method name and its parameters.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;methodBase&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; MethodItem(System.Reflection.MethodBase methodBase)
            : &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;(methodBase.Name, GetMethodParameterNames(methodBase))
        {
        }

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;

        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] GetMethodParameterNames(System.Reflection.MethodBase methodBase)
        {
            ArrayList methodParameterNames &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ArrayList();
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                System.Reflection.ParameterInfo[] methodBaseGetParameters &lt;/span&gt;=&lt;span&gt; methodBase.GetParameters();

                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; methodBaseGetParametersCount = methodBaseGetParameters.GetUpperBound(&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);

                &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt;= methodBaseGetParametersCount; i++&lt;span&gt;)
                {
                    methodParameterNames.Add(methodBaseGetParameters[i].ParameterType &lt;/span&gt;+ &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; methodBaseGetParameters[i].Name);
                }
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
            {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;LogLog.Error(declaringType, &quot;An exception ocurred while retreiving method parameters.&quot;, ex);&lt;/span&gt;
&lt;span&gt;            }

            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; (&lt;span&gt;string&lt;/span&gt;[])methodParameterNames.ToArray(&lt;span&gt;typeof&lt;/span&gt;(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;));
        }

        &lt;/span&gt;&lt;span&gt;#region&lt;/span&gt; Public Instance Properties

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The method name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; Name
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_name; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method parameters of the caller making
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; the logging request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The method parameters of the caller making
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; the logging request
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method parameters of the caller making
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; the logging request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] Parameters
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_parameters; }
        }

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;

        &lt;span&gt;#region&lt;/span&gt; Private Instance Fields

        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_name;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] m_parameters;

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;

        &lt;span&gt;#region&lt;/span&gt; Private Static Fields

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The fully qualified type of the StackFrameItem class.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Used by the internal logger to record the Type of the
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; log message.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Type declaringType = &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(MethodItem);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; When location information is not available the constant
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;NA&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;&lt;span&gt; is returned. Current value of this string
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; constant is &lt;/span&gt;&lt;span&gt;&amp;lt;b&amp;gt;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;&lt;span&gt;.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;const&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; NA = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt; Private Static Fields&lt;span&gt;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;StackFrameItemç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33.5&quot;&gt;&lt;img id=&quot;code_img_closed_ee1e5376-65e2-45e3-846a-75d0679820f7&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_ee1e5376-65e2-45e3-846a-75d0679820f7&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_ee1e5376-65e2-45e3-846a-75d0679820f7&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;62&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; StackFrameItem
    {
        &lt;/span&gt;&lt;span&gt;#region&lt;/span&gt; Public Instance Constructors

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; returns a stack frame item from a stack frame. This 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;frame&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; StackFrameItem(StackFrame frame)
        {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; set default values&lt;/span&gt;
            m_lineNumber =&lt;span&gt; NA;
            m_fileName &lt;/span&gt;=&lt;span&gt; NA;
            m_method &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MethodItem();
            m_className &lt;/span&gt;=&lt;span&gt; NA;

            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; get frame values&lt;/span&gt;
                m_lineNumber =&lt;span&gt; frame.GetFileLineNumber().ToString(System.Globalization.NumberFormatInfo.InvariantInfo);
                m_fileName &lt;/span&gt;=&lt;span&gt; frame.GetFileName();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; get method values&lt;/span&gt;
                MethodBase method =&lt;span&gt; frame.GetMethod();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                {
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method.DeclaringType != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                        m_className &lt;/span&gt;=&lt;span&gt; method.DeclaringType.FullName;
                    m_method &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MethodItem(method);
                }
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
            {

            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; set full info&lt;/span&gt;
            m_fullInfo = m_className + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_method.Name + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_fileName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_lineNumber + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
        }

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;

        &lt;span&gt;#region&lt;/span&gt; Public Instance Properties

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; ClassName
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_className; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; FileName
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_fileName; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; LineNumber
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_lineNumber; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; MethodItem Method
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_method; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets all available caller information
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; All available caller information, in the format
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;fully.qualified.classname.of.caller.methodName(Filename:line)&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets all available caller information, in the format
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;fully.qualified.classname.of.caller.methodName(Filename:line)&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; FullInfo
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_fullInfo; }
        }

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt; Public Instance Properties

        &lt;span&gt;#region&lt;/span&gt; Private Instance Fields

        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_lineNumber;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_fileName;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_className;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_fullInfo;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt;&lt;span&gt; MethodItem m_method;

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt;

        &lt;span&gt;#region&lt;/span&gt; Private Static Fields

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The fully qualified type of the StackFrameItem class.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Used by the internal logger to record the Type of the
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; log message.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Type declaringType = &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(StackFrameItem);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; When location information is not available the constant
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;NA&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;&lt;span&gt; is returned. Current value of this string
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; constant is &lt;/span&gt;&lt;span&gt;&amp;lt;b&amp;gt;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;&lt;span&gt;.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;const&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; NA = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt; Private Static Fields
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;LocationInfoç±»&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37.5&quot;&gt;&lt;img id=&quot;code_img_closed_3d288c5b-8919-431f-afa0-486738822534&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_3d288c5b-8919-431f-afa0-486738822534&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_3d288c5b-8919-431f-afa0-486738822534&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;70&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LocationInfo
    {
        &lt;/span&gt;&lt;span&gt;#region&lt;/span&gt; Public Instance Constructors

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Constructor
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;callerStackBoundaryDeclaringType&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The declaring type of the method that is
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; the stack boundary into the logging system for this call.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Initializes a new instance of the &lt;/span&gt;&lt;span&gt;&amp;lt;see cref=&quot;LocationInfo&quot; /&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; class based on the current thread.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; LocationInfo(Type callerStackBoundaryDeclaringType)
        {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Initialize all fields&lt;/span&gt;
            m_className =&lt;span&gt; NA;
            m_fileName &lt;/span&gt;=&lt;span&gt; NA;
            m_lineNumber &lt;/span&gt;=&lt;span&gt; NA;
            m_methodName &lt;/span&gt;=&lt;span&gt; NA;
            m_fullInfo &lt;/span&gt;=&lt;span&gt; NA;

&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; !(NETCF || NETSTANDARD1_3) &lt;span&gt;//&lt;/span&gt;&lt;span&gt; StackTrace isn't fully implemented for NETSTANDARD1_3 &lt;/span&gt;&lt;span&gt;https://github.com/dotnet/corefx/issues/1797&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (callerStackBoundaryDeclaringType != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
                {
                    StackTrace st &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; StackTrace(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
                    &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; frameIndex = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;

                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; skip frames not from fqnOfCallingClass&lt;/span&gt;
                    &lt;span&gt;while&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        StackFrame frame &lt;/span&gt;=&lt;span&gt; st.GetFrame(frameIndex);
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frame != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; frame.GetMethod().DeclaringType ==&lt;span&gt; callerStackBoundaryDeclaringType)
                        {
                            &lt;/span&gt;&lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
                        }
                        frameIndex&lt;/span&gt;++&lt;span&gt;;
                    }

                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; skip frames from fqnOfCallingClass&lt;/span&gt;
                    &lt;span&gt;while&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        StackFrame frame &lt;/span&gt;=&lt;span&gt; st.GetFrame(frameIndex);
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frame != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; frame.GetMethod().DeclaringType !=&lt;span&gt; callerStackBoundaryDeclaringType)
                        {
                            &lt;/span&gt;&lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
                        }
                        frameIndex&lt;/span&gt;++&lt;span&gt;;
                    }

                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; take into account the frames we skip above&lt;/span&gt;
                        &lt;span&gt;int&lt;/span&gt; adjustedFrameCount = st.FrameCount -&lt;span&gt; frameIndex;
                        ArrayList stackFramesList &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ArrayList(adjustedFrameCount);
                        m_stackFrames &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StackFrameItem[adjustedFrameCount];
                        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = frameIndex; i &amp;lt; st.FrameCount; i++&lt;span&gt;)
                        {
                            stackFramesList.Add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; StackFrameItem(st.GetFrame(i)));
                        }

                        stackFramesList.CopyTo(m_stackFrames, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);

                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; now frameIndex is the first 'user' caller frame&lt;/span&gt;
                        StackFrame locationFrame =&lt;span&gt; st.GetFrame(frameIndex);

                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (locationFrame != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                        {
                            System.Reflection.MethodBase method &lt;/span&gt;=&lt;span&gt; locationFrame.GetMethod();

                            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                            {
                                m_methodName &lt;/span&gt;=&lt;span&gt; method.Name;
                                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method.DeclaringType != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                                {
                                    m_className &lt;/span&gt;=&lt;span&gt; method.DeclaringType.FullName;
                                }
                            }
                            m_fileName &lt;/span&gt;=&lt;span&gt; locationFrame.GetFileName();
                            m_lineNumber &lt;/span&gt;=&lt;span&gt; locationFrame.GetFileLineNumber().ToString(System.Globalization.NumberFormatInfo.InvariantInfo);

                            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Combine all location info&lt;/span&gt;
                            m_fullInfo = m_className + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_methodName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_fileName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_lineNumber + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
                        }
                    }
                }
                &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (System.Security.SecurityException)
                {
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; This security exception will occur if the caller does not have 
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; some undefined set of SecurityPermission flags.
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;LogLog.Debug(declaringType, &quot;Security exception while trying to get caller stack frame. Error Ignored. Location Information Not Available.&quot;);&lt;/span&gt;
&lt;span&gt;                }
            }
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;&lt;span&gt;
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è‡ªå®šä¹‰è·å–ä½ç½®ä¿¡æ¯ï¼Œå¼‚æ­¥çº¿ç¨‹å†…è·å–æœŸæœ›å€¼
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;callerStackBoundaryDeclaringType&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;st&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; LocationInfo(Type callerStackBoundaryDeclaringType,StackTrace st)
        {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Initialize all fields&lt;/span&gt;
            m_className =&lt;span&gt; NA;
            m_fileName &lt;/span&gt;=&lt;span&gt; NA;
            m_lineNumber &lt;/span&gt;=&lt;span&gt; NA;
            m_methodName &lt;/span&gt;=&lt;span&gt; NA;
            m_fullInfo &lt;/span&gt;=&lt;span&gt; NA;

&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; !(NETCF || NETSTANDARD1_3) &lt;span&gt;//&lt;/span&gt;&lt;span&gt; StackTrace isn't fully implemented for NETSTANDARD1_3 &lt;/span&gt;&lt;span&gt;https://github.com/dotnet/corefx/issues/1797&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (callerStackBoundaryDeclaringType != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
                {
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;StackTrace st = new StackTrace(true);&lt;/span&gt;
                    &lt;span&gt;int&lt;/span&gt; frameIndex = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;

                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; skip frames not from fqnOfCallingClass&lt;/span&gt;
                    &lt;span&gt;while&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        StackFrame frame &lt;/span&gt;=&lt;span&gt; st.GetFrame(frameIndex);
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frame != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; frame.GetMethod().DeclaringType ==&lt;span&gt; callerStackBoundaryDeclaringType)
                        {
                            &lt;/span&gt;&lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
                        }
                        frameIndex&lt;/span&gt;++&lt;span&gt;;
                    }

                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; skip frames from fqnOfCallingClass&lt;/span&gt;
                    &lt;span&gt;while&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        StackFrame frame &lt;/span&gt;=&lt;span&gt; st.GetFrame(frameIndex);
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frame != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; frame.GetMethod().DeclaringType !=&lt;span&gt; callerStackBoundaryDeclaringType)
                        {
                            &lt;/span&gt;&lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
                        }
                        frameIndex&lt;/span&gt;++&lt;span&gt;;
                    }

                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (frameIndex &amp;lt;&lt;span&gt; st.FrameCount)
                    {
                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; take into account the frames we skip above&lt;/span&gt;
                        &lt;span&gt;int&lt;/span&gt; adjustedFrameCount = st.FrameCount -&lt;span&gt; frameIndex;
                        ArrayList stackFramesList &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ArrayList(adjustedFrameCount);
                        m_stackFrames &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StackFrameItem[adjustedFrameCount];
                        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = frameIndex; i &amp;lt; st.FrameCount; i++&lt;span&gt;)
                        {
                            stackFramesList.Add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; StackFrameItem(st.GetFrame(i)));
                        }

                        stackFramesList.CopyTo(m_stackFrames, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);

                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; now frameIndex is the first 'user' caller frame&lt;/span&gt;
                        StackFrame locationFrame =&lt;span&gt; st.GetFrame(frameIndex);

                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (locationFrame != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                        {
                            System.Reflection.MethodBase method &lt;/span&gt;=&lt;span&gt; locationFrame.GetMethod();

                            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                            {
                                m_methodName &lt;/span&gt;=&lt;span&gt; method.Name;
                                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (method.DeclaringType != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                                {
                                    m_className &lt;/span&gt;=&lt;span&gt; method.DeclaringType.FullName;
                                }
                            }
                            m_fileName &lt;/span&gt;=&lt;span&gt; locationFrame.GetFileName();
                            m_lineNumber &lt;/span&gt;=&lt;span&gt; locationFrame.GetFileLineNumber().ToString(System.Globalization.NumberFormatInfo.InvariantInfo);

                            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Combine all location info&lt;/span&gt;
                            m_fullInfo = m_className + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_methodName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_fileName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_lineNumber + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
                        }
                    }
                }
                &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (System.Security.SecurityException)
                {
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; This security exception will occur if the caller does not have 
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; some undefined set of SecurityPermission flags.
                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;LogLog.Debug(declaringType, &quot;Security exception while trying to get caller stack frame. Error Ignored. Location Information Not Available.&quot;);&lt;/span&gt;
&lt;span&gt;                }
            }
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;&lt;span&gt;
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Constructor
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;className&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The fully qualified class name.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;methodName&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The method name.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;fileName&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The file name.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;lineNumber&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;The line number of the method within the file.&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Initializes a new instance of the &lt;/span&gt;&lt;span&gt;&amp;lt;see cref=&quot;LocationInfo&quot; /&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; class with the specified data.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; LocationInfo(&lt;span&gt;string&lt;/span&gt; className, &lt;span&gt;string&lt;/span&gt; methodName, &lt;span&gt;string&lt;/span&gt; fileName, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; lineNumber)
        {
            m_className &lt;/span&gt;=&lt;span&gt; className;
            m_fileName &lt;/span&gt;=&lt;span&gt; fileName;
            m_lineNumber &lt;/span&gt;=&lt;span&gt; lineNumber;
            m_methodName &lt;/span&gt;=&lt;span&gt; methodName;
            m_fullInfo &lt;/span&gt;= m_className + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_methodName + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_fileName +
                &lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + m_lineNumber + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
        }

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt; Public Instance Constructors

        &lt;span&gt;#region&lt;/span&gt; Public Instance Properties

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the fully qualified class name of the caller making the logging 
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; request.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; ClassName
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_className; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the file name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; FileName
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_fileName; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the line number of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; LineNumber
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_lineNumber; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the method name of the caller.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; MethodName
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_methodName; }
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets all available caller information
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; All available caller information, in the format
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;fully.qualified.classname.of.caller.methodName(Filename:line)&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets all available caller information, in the format
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;fully.qualified.classname.of.caller.methodName(Filename:line)&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; FullInfo
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_fullInfo; }
        }

&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; !(NETCF || NETSTANDARD1_3)
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Gets the stack frames from the stack trace of the caller making the log request
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt;&lt;span&gt; StackFrameItem[] StackFrames
        {
            &lt;/span&gt;&lt;span&gt;get&lt;/span&gt; { &lt;span&gt;return&lt;/span&gt;&lt;span&gt; m_stackFrames; }
        }
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;

        &lt;span&gt;#endregion&lt;/span&gt; Public Instance Properties

        &lt;span&gt;#region&lt;/span&gt; Private Instance Fields

        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_className;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_fileName;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_lineNumber;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_methodName;
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;&lt;span&gt; m_fullInfo;
&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; !(NETCF || NETSTANDARD1_3)
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt;&lt;span&gt; StackFrameItem[] m_stackFrames;
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;

        &lt;span&gt;#endregion&lt;/span&gt; Private Instance Fields

        &lt;span&gt;#region&lt;/span&gt; Private Static Fields

        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; The fully qualified type of the LocationInfo class.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Used by the internal logger to record the Type of the
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; log message.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/remarks&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Type declaringType = &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(LocationInfo);

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; When location information is not available the constant
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;c&amp;gt;&lt;/span&gt;&lt;span&gt;NA&lt;/span&gt;&lt;span&gt;&amp;lt;/c&amp;gt;&lt;/span&gt;&lt;span&gt; is returned. Current value of this string
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; constant is &lt;/span&gt;&lt;span&gt;&amp;lt;b&amp;gt;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;&lt;span&gt;.
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;const&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; NA = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;#endregion&lt;/span&gt; Private Static Fields
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šè‹±æ–‡æ³¨é‡Šå‘¢ï¼Œå› ä¸ºè¿™æ˜¯copyçš„log4netæºç ã€‚ã€‚ã€‚ä½†æ˜¯LocationInfoä¸­é‡è½½äº†æ„é€ å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919212635520-2008789140.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘éœ€è¦å…ˆè·å–è°ƒç”¨æ—¥å¿—æ–¹æ³•çš„StackTraceï¼Œç„¶åä¼ å…¥æ–¹æ³•ï¼Œä¸»è¦å› ä¸ºå†™å…¥æ—¥å¿—ç”¨åˆ°å¼‚æ­¥ï¼Œå¦‚æœåœ¨å¼‚æ­¥çº¿ç¨‹å†…ç”¨LocationInfo(Type callerStackBoundaryDeclaringType)ï¼Œä¼šå¯¼è‡´è·å–ä¸åˆ°æˆ‘ä»¬æœŸæœ›çš„é‚£å‡ ä¸ªè¿½è¸ªä¿¡æ¯ï¼Œå› ä¸ºStackFrameæ˜¯åœ¨å®ƒå†…éƒ¨newçš„ï¼Œè¿™ä¼šå¯¼è‡´è·å–çš„æ˜¯å¼‚æ­¥çº¿ç¨‹çš„ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘è¦åœ¨è¿›å…¥å¼‚æ­¥çº¿ç¨‹å‰å°†StackTraceè·å–åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919213136854-1890994238.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä¹Ÿå°±æœ‰äº†ä¸‹é¢è¿™ä¸ªç±»ï¼ˆLogEventDataAsyncï¼‰ï¼Œä¸€ä¸ªä¼ å…¥å¼‚æ­¥çº¿ç¨‹çš„æ•°æ®å¯¹è±¡ï¼Œé‡Œé¢ä¿å­˜ç€ä¸€äº›åŸºæœ¬çš„åˆå§‹æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºLogEventDataAsync&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32.5&quot;&gt;&lt;img id=&quot;code_img_closed_ae86b0cf-4731-4ff2-a6dc-d8f6220f2920&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_ae86b0cf-4731-4ff2-a6dc-d8f6220f2920&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_ae86b0cf-4731-4ff2-a6dc-d8f6220f2920&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;60&quot;&gt;
&lt;pre&gt;
&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ•°æ®ï¼Œä¼ å…¥å¼‚æ­¥æ‰§è¡Œæ–¹æ³•çš„æ•°æ®
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; ä¸»è¦ä¸ºæå‰è·å–CallerStackBoundaryDeclaringTypeå’ŒCallerStackTraceï¼Œé¿å…Coreï¼ˆlog4netæºç ï¼‰ä¸‹è¿½è¸ªä¿¡æ¯åœ¨å¼‚æ­¥çº¿ç¨‹å†…ä¸æœŸæœ›ä¸ä¸€è‡´
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogEventDataAsync
    {
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Message { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é”™è¯¯çº§åˆ«
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Level { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ¥æº
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; LogSource { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è°ƒç”¨æ—¥å¿—æ–¹æ³•å®ä¾‹ç±»å‹
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; Type CallerStackBoundaryDeclaringType { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; StackTrace
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; StackTrace CallerStackTrace { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡é€—å·éš”å¼€
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; Emails { &lt;span&gt;get&lt;/span&gt;; &lt;span&gt;set&lt;/span&gt;&lt;span&gt;; }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢æ—¥å¿—ä¿¡æ¯çš„å‡†å¤‡å·¥ä½œå°±åšå®Œäº†ï¼Œä¸‹é¢æ¥èµ‹å€¼å†™å…¥mongodb&lt;/p&gt;
&lt;p&gt;å…ˆæ¥åˆ›å»ºä¸¤ä¸ªå¸®åŠ©ç±»å§ï¼Œä¸€ä¸ªç”¨äºå¼‚æ­¥ï¼Œä¸€ä¸ªæ˜¯æ¯”è¾ƒå¸¸è§çš„è¯·æ±‚ç±»ï¼Œéƒ½å¾ˆç®€å•&lt;/p&gt;
&lt;p&gt;åˆ›å»ºCommonæ–‡ä»¶å¤¹ï¼Œåœ¨ä¸‹é¢åˆ›å»ºä¸¤ä¸ªç±»&lt;/p&gt;
&lt;p&gt;AsyncHelpersï¼ˆNLogæºç ï¼‰&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35.5&quot;&gt;&lt;img id=&quot;code_img_closed_d807c133-5b6e-4ecc-be04-77fa82facabd&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_d807c133-5b6e-4ecc-be04-77fa82facabd&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_d807c133-5b6e-4ecc-be04-77fa82facabd&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;66&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; AsyncHelpers
    {
        &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt; GetManagedThreadId()
        {
&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; NETSTANDARD1_3
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; System.Environment.CurrentManagedThreadId;
&lt;/span&gt;&lt;span&gt;#else&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; Thread.CurrentThread.ManagedThreadId;
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;&lt;span&gt;
        }

        &lt;/span&gt;&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; StartAsyncTask(Action&amp;lt;&lt;span&gt;object&lt;/span&gt;&amp;gt; action, &lt;span&gt;object&lt;/span&gt;&lt;span&gt; state)
        {
&lt;/span&gt;&lt;span&gt;#if&lt;/span&gt; NET4_0 || NET4_5 || NETSTANDARD&lt;span&gt;
            System.Threading.Tasks.Task.Factory.StartNew(action, state, CancellationToken.None, System.Threading.Tasks.TaskCreationOptions.None, System.Threading.Tasks.TaskScheduler.Default);
&lt;/span&gt;&lt;span&gt;#else&lt;/span&gt;&lt;span&gt;
            ThreadPool.QueueUserWorkItem(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; WaitCallback(action), state);
&lt;/span&gt;&lt;span&gt;#endif&lt;/span&gt;&lt;span&gt;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;RequestHelpers&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;50.5&quot;&gt;&lt;img id=&quot;code_img_closed_89f00a74-684c-45c5-b3d8-ca9696fac7ba&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_89f00a74-684c-45c5-b3d8-ca9696fac7ba&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_89f00a74-684c-45c5-b3d8-ca9696fac7ba&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;96&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RequestHelpers
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç»„è£…æ™®é€šæ–‡æœ¬è¯·æ±‚å‚æ•°ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;parameters&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;Key-Valueå½¢å¼è¯·æ±‚å‚æ•°å­—å…¸&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;URLç¼–ç åçš„è¯·æ±‚æ•°æ®&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String BuildQuery(IDictionary&amp;lt;String, String&amp;gt;&lt;span&gt; parameters)
        {
            StringBuilder postData &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuilder();
            &lt;/span&gt;&lt;span&gt;bool&lt;/span&gt; hasParam = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;

            IEnumerator&lt;/span&gt;&amp;lt;KeyValuePair&amp;lt;String, String&amp;gt;&amp;gt; dem =&lt;span&gt; parameters.GetEnumerator();
            &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; (dem.MoveNext())
            {
                String name &lt;/span&gt;=&lt;span&gt; dem.Current.Key;
                String value &lt;/span&gt;=&lt;span&gt; dem.Current.Value;
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¿½ç•¥å‚æ•°åæˆ–å‚æ•°å€¼ä¸ºç©ºçš„å‚æ•°&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (!String.IsNullOrEmpty(name) &amp;amp;&amp;amp; !&lt;span&gt;String.IsNullOrEmpty(value))
                {
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (hasParam)
                    {
                        postData.Append(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                    }

                    postData.Append(name);
                    postData.Append(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                    postData.Append(HttpUtility.UrlEncode(value));
                    hasParam &lt;/span&gt;= &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
                }
            }

            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; postData.ToString();
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒHTTP POSTè¯·æ±‚ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; å¯¹å‚æ•°å€¼æ‰§è¡ŒUrlEncode
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;url&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚åœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;parameters&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚å‚æ•°&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;HTTPå“åº”&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String DoPost(String url, IDictionary&amp;lt;String, String&amp;gt;&lt;span&gt; parameters)
        {
            HttpWebRequest req &lt;/span&gt;= GetWebRequest(url, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;POST&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            req.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/x-www-form-urlencoded;charset=utf-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

            Byte[] postData &lt;/span&gt;=&lt;span&gt; Encoding.UTF8.GetBytes(BuildQuery(parameters));
            Stream reqStream &lt;/span&gt;=&lt;span&gt; req.GetRequestStream();
            reqStream.Write(postData, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;, postData.Length);
            reqStream.Close();

            HttpWebResponse rsp &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            rsp &lt;/span&gt;=&lt;span&gt; (HttpWebResponse)req.GetResponse();

            Encoding encoding &lt;/span&gt;=&lt;span&gt; Encoding.GetEncoding(rsp.CharacterSet);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetResponseAsString(rsp, encoding);
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒHTTP POSTè¯·æ±‚ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¯¥æ–¹æ³•åœ¨æ‰§è¡Œpostæ—¶ä¸å¯¹è¯·æ±‚æ•°æ®è¿›è¡Œä»»ä½•ç¼–ç ï¼ˆUrlEncodeï¼‰
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;url&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚åœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;data&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚æ•°æ®&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;HTTPå“åº”&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String DoPost(String url, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; data)
        {
            HttpWebRequest req &lt;/span&gt;= GetWebRequest(url, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;POST&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            req.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/x-www-form-urlencoded;charset=utf-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

            Byte[] postData &lt;/span&gt;=&lt;span&gt; Encoding.UTF8.GetBytes(data);
            Stream reqStream &lt;/span&gt;=&lt;span&gt; req.GetRequestStream();
            reqStream.Write(postData, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;, postData.Length);
            reqStream.Close();

            HttpWebResponse rsp &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            rsp &lt;/span&gt;=&lt;span&gt; (HttpWebResponse)req.GetResponse();

            Encoding encoding &lt;/span&gt;=&lt;span&gt; Encoding.GetEncoding(rsp.CharacterSet);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetResponseAsString(rsp, encoding);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; postæ•°æ® T messagepackåºåˆ—åŒ–æ ¼å¼ å‡å°‘ä¼ è¾“æ•°æ®å¤§å°
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;typeparam name=&quot;T&quot;&amp;gt;&amp;lt;/typeparam&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;url&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;model&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; DoPost&amp;lt;T&amp;gt;&lt;span&gt;(String url, T model)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; client = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; HttpClient();
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;MessagePack.Resolvers.CompositeResolver.RegisterAndSetAsDefault(
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        NativeDateTimeResolver.Instance,
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        ContractlessStandardResolver.Instance);&lt;/span&gt;
            &lt;span&gt;var&lt;/span&gt; messagePackMediaTypeFormatter = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; MessagePackMediaTypeFormatter(ContractlessStandardResolver.Instance);
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; request = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; HttpRequestMessage(HttpMethod.Post, url);
            request.Content &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ObjectContent&amp;lt;T&amp;gt;&lt;span&gt;(
                model,messagePackMediaTypeFormatter);            
            request.Content.Headers.ContentType.MediaType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/x-msgpack&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;client.Timeout = new TimeSpan(0,0,5);&lt;/span&gt;
&lt;span&gt;            client.SendAsync(request);
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒHTTP POSTè¯·æ±‚ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; è¯¥æ–¹æ³•åœ¨æ‰§è¡Œpostæ—¶ä¸å¯¹è¯·æ±‚æ•°æ®è¿›è¡Œä»»ä½•ç¼–ç ï¼ˆUrlEncodeï¼‰
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;url&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚åœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;data&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚æ•°æ®&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;HTTPå“åº”&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String DoPostJson(String url, &lt;span&gt;string&lt;/span&gt;&lt;span&gt; data)
        {
            HttpWebRequest req &lt;/span&gt;= GetWebRequest(url, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;POST&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            req.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/json;charset=UTF-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
            req.Accept &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/json&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
            Byte[] postData &lt;/span&gt;=&lt;span&gt; Encoding.UTF8.GetBytes(data);
            Stream reqStream &lt;/span&gt;=&lt;span&gt; req.GetRequestStream();
            reqStream.Write(postData, &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;, postData.Length);
            reqStream.Close();

            HttpWebResponse rsp &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            rsp &lt;/span&gt;=&lt;span&gt; (HttpWebResponse)req.GetResponse();

            Encoding encoding &lt;/span&gt;=&lt;span&gt; Encoding.GetEncoding(rsp.CharacterSet);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetResponseAsString(rsp, encoding);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒHTTP GETè¯·æ±‚ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;url&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚åœ°å€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;parameters&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;è¯·æ±‚å‚æ•°&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;HTTPå“åº”&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String DoGet(String url, IDictionary&amp;lt;String, String&amp;gt;&lt;span&gt; parameters)
        {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (parameters != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; parameters.Count &amp;gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
            {
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (url.Contains(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;))
                {
                    url &lt;/span&gt;= url + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; BuildQuery(parameters);
                }
                &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
                {
                    url &lt;/span&gt;= url + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; BuildQuery(parameters);
                }
            }

            HttpWebRequest req &lt;/span&gt;= GetWebRequest(url, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;GET&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            req.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;application/x-www-form-urlencoded;charset=utf-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

            HttpWebResponse rsp &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            rsp &lt;/span&gt;=&lt;span&gt; (HttpWebResponse)req.GetResponse();

            Encoding encoding &lt;/span&gt;=&lt;span&gt; Encoding.GetEncoding(rsp.CharacterSet);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; GetResponseAsString(rsp, encoding);
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; HttpWebRequest GetWebRequest(String url, String method)
        {
            HttpWebRequest req &lt;/span&gt;=&lt;span&gt; (HttpWebRequest)WebRequest.Create(url);
            req.Method &lt;/span&gt;=&lt;span&gt; method;
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; req;
        }

        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æŠŠå“åº”æµè½¬æ¢ä¸ºæ–‡æœ¬ã€‚
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;rsp&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å“åº”æµå¯¹è±¡&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;encoding&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;ç¼–ç æ–¹å¼&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;&lt;span&gt;å“åº”æ–‡æœ¬&lt;/span&gt;&lt;span&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; String GetResponseAsString(HttpWebResponse rsp, Encoding encoding)
        {
            Stream stream &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            StreamReader reader &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;

            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä»¥å­—ç¬¦æµçš„æ–¹å¼è¯»å–HTTPå“åº”&lt;/span&gt;
                stream =&lt;span&gt; rsp.GetResponseStream();
                reader &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StreamReader(stream, encoding);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; reader.ReadToEnd();
            }
            &lt;/span&gt;&lt;span&gt;finally&lt;/span&gt;&lt;span&gt;
            {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡Šæ”¾èµ„æº&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (reader != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) reader.Close();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (stream != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) stream.Close();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (rsp != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) rsp.Close();
            }
        }

        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; GetUrlData(&lt;span&gt;string&lt;/span&gt; url, &lt;span&gt;string&lt;/span&gt; encoding, &lt;span&gt;out&lt;/span&gt; &lt;span&gt;long&lt;/span&gt;&lt;span&gt; logSize)
        {
            logSize &lt;/span&gt;= &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
            &lt;/span&gt;&lt;span&gt;string&lt;/span&gt; return_value = &lt;span&gt;string&lt;/span&gt;&lt;span&gt;.Empty;
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                HttpWebRequest wq &lt;/span&gt;= WebRequest.Create(url) &lt;span&gt;as&lt;/span&gt;&lt;span&gt; HttpWebRequest;
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (wq == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
                {
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; return_value;
                }
                wq.Credentials &lt;/span&gt;=&lt;span&gt; CredentialCache.DefaultCredentials;
                wq.CookieContainer &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; CookieContainer();
                wq.ContentType &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text/html&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
                wq.Method &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;GET&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
                wq.UserAgent &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
                wq.Host &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Uri(url).Host;
                wq.Timeout &lt;/span&gt;= &lt;span&gt;10000&lt;/span&gt;&lt;span&gt;;
                &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
                {
                    HttpWebResponse rep &lt;/span&gt;= wq.GetResponse() &lt;span&gt;as&lt;/span&gt;&lt;span&gt; HttpWebResponse;
                    logSize &lt;/span&gt;=&lt;span&gt; rep.ContentLength;
                    Stream responseStream &lt;/span&gt;=&lt;span&gt; rep.GetResponseStream();
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (rep.ContentEncoding.ToLower().Contains(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;gzip&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;))
                    {
                        responseStream &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; GZipStream(responseStream, CompressionMode.Decompress);
                    }
                    &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (rep.ContentEncoding.ToLower().Contains(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;deflate&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;))
                    {
                        responseStream &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DeflateStream(responseStream, CompressionMode.Decompress);
                    }
                    StreamReader reader &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StreamReader(responseStream, Encoding.GetEncoding(encoding));
                    return_value &lt;/span&gt;=&lt;span&gt; reader.ReadToEnd();

                    responseStream.Close();
                    reader.Close();
                    rep.Close();
                }
                &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception)
                {
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;nolog&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
                }
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (WebException ex)
            {
                return_value &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;error_error&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; return_value;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;åœ¨RequestHelpersä¸­çœŸæ­£ç”¨åˆ°çš„æ˜¯public static void DoPost&amp;lt;T&amp;gt;(String url, T model)æ–¹æ³•ï¼Œé‡Œé¢ç”¨åˆ°äº†MessagePackä»¥åŠæ‰©å±•çš„MediaTypeÂ &quot;application/x-msgpack&quot;,æ‰€ä»¥è¿™é‡Œè¦å¼•ç”¨ä¸¤ä¸ªnugetåŒ…&lt;/p&gt;
&lt;p&gt;MessagePackå’ŒSketch7.MessagePack.MediaTypeFormatter&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºLogWriter&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;LogWriterä¸ºè°ƒç”¨Postæ–¹æ³•çš„ç±»ï¼Œé‡Œé¢ä¸»è¦æä¾›äº†å¼‚æ­¥è°ƒç”¨çš„æ–¹æ³•ä»¥åŠåˆ›å»ºå®Œæ•´çš„æ—¥å¿—ä¿¡æ¯åŠŸèƒ½&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38.5&quot;&gt;&lt;img id=&quot;code_img_closed_39ef63e2-6584-4257-a5a1-774dd73dcce4&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_39ef63e2-6584-4257-a5a1-774dd73dcce4&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_39ef63e2-6584-4257-a5a1-774dd73dcce4&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;72&quot;&gt;
&lt;pre&gt;
&lt;span&gt;internal&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LogWriter
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç§æœ‰æ„é€ å‡½æ•°
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt;&lt;span&gt; LogWriter() { }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è·å–LogWriterå®ä¾‹
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; LogWriter GetLogWriter()
        {            
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LogWriter();
        }        
        
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Writer(&lt;span&gt;object&lt;/span&gt;&lt;span&gt; logEventDataAsync)
        {
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; led =&lt;span&gt; GetLoggingEventData((LogEventDataAsync)logEventDataAsync);
            &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; level =&lt;span&gt; LogLevel.FromString(led.Level);
            &lt;/span&gt;&lt;span&gt;string&lt;/span&gt; logapi =&lt;span&gt; level.LogApi;
            RequestHelpers.DoPost&lt;/span&gt;&amp;lt;LogEventData&amp;gt;(logapi, led);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;MessagePackè¿›è¡Œæ•°æ®å‹ç¼©ï¼Œå‡å°ä¼ è¾“æ•°æ®&lt;/span&gt;
&lt;span&gt;        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è·å–æ—¥å¿—æ•°æ®
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;logEventDataAsync&quot;&amp;gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt;&lt;span&gt; LogEventData GetLoggingEventData(LogEventDataAsync logEventDataAsync)
        {
            LocationInfo locationInfo &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LocationInfo(logEventDataAsync.CallerStackBoundaryDeclaringType, logEventDataAsync.CallerStackTrace);
            LogEventData logData &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LogEventData
            {
                Message &lt;/span&gt;=&lt;span&gt; logEventDataAsync.Message,
                Date &lt;/span&gt;=&lt;span&gt; DateTime.Now,
                Level &lt;/span&gt;=&lt;span&gt; logEventDataAsync.Level,
                LogSource &lt;/span&gt;= &lt;span&gt;string&lt;/span&gt;.IsNullOrEmpty(logEventDataAsync.LogSource) ?&lt;span&gt; locationInfo.ClassName : logEventDataAsync.LogSource,
                ClassName &lt;/span&gt;=&lt;span&gt; locationInfo.ClassName,
                MethodName &lt;/span&gt;=&lt;span&gt; locationInfo.MethodName,
                LineNumber &lt;/span&gt;=&lt;span&gt; locationInfo.LineNumber,
                FileName &lt;/span&gt;=&lt;span&gt; locationInfo.FileName,
                IP &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;NA&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,
                Emails &lt;/span&gt;=&lt;span&gt; logEventDataAsync.Emails,
                FullInfo&lt;/span&gt;=&lt;span&gt;locationInfo.FullInfo
            };
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; logData;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;GetLoggingEventDataæ–¹æ³•ä¸­å°±åŒ…å«äº†LocationInfoçš„å®ä¾‹åŒ–ï¼Œä¹‹æ‰€ä»¥æ”¾è¿™é‡Œæ˜¯å› ä¸ºè¿™é‡Œå¼‚æ­¥æ‰§è¡Œï¼Œè€Œè·å–è¿½è¸ªä¿¡æ¯éœ€è¦å„ç§åå°„æ¯”è¾ƒè€—æ—¶ï¼Œä¸ç„¶ä¹Ÿå°±æ²¡æœ‰LogEventDataAsyncè¿™ä¸ªç±»äº†ï¼Œè·å–IPçš„æ–¹æ³•æ²¡å®ç°ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºLoggerç±»&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;è¿™ä¸ªç±»æ˜¯çœŸæ­£æš´éœ²ç»™å¼€å‘è€…ä½¿ç”¨çš„ç±»ï¼Œå°±åƒå¼€æºé¡¹ç›®log.debugè¿™æ ·çš„æ–¹å¼&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;61&quot;&gt;&lt;img id=&quot;code_img_closed_f028b8b5-9317-4829-aaae-fdf1a99e4bdd&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_f028b8b5-9317-4829-aaae-fdf1a99e4bdd&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_f028b8b5-9317-4829-aaae-fdf1a99e4bdd&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;117&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Logger
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;readonly&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Type declaringType = &lt;span&gt;typeof&lt;/span&gt;&lt;span&gt;(Logger);
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—å†™å…¥å®ä¾‹
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; LogWriter _logWriter = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æ¥æº
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; é»˜è®¤ä¸ºè°ƒç”¨æ–¹æ³•æ‰€åœ¨ç±»
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;string&lt;/span&gt; _logSource = &lt;span&gt;string&lt;/span&gt;&lt;span&gt;.Empty;
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç§æœ‰æ„é€ å‡½æ•°
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt;&lt;span&gt; Logger()
        {
            _logWriter &lt;/span&gt;=&lt;span&gt; LogWriter.GetLogWriter();
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ç§æœ‰æ„é€ å‡½æ•°
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;logSource&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—æ¥æº&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; Logger(&lt;span&gt;string&lt;/span&gt; logSource):&lt;span&gt;this&lt;/span&gt;&lt;span&gt;()
        {
            _logSource &lt;/span&gt;=&lt;span&gt; logSource;
        }        
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è·å–Loggerå®ä¾‹
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt;&lt;span&gt; é»˜è®¤æ—¥å¿—æ¥æºä¸ºè°ƒç”¨æ–¹æ³•æ‰€åœ¨ç±»ï¼šnamespace.classname
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;logSource&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—æ¥æº&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; Logger GetLogger(&lt;span&gt;string&lt;/span&gt; logSource=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {            
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Logger(logSource);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Trace
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Trace(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Trace, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Trace
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Trace(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            
            WriterToTargets(ex.ToString(), LogLevel.Trace, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Debug
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Debug(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Debug, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Debug
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Debug(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(ex.ToString(), LogLevel.Debug, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Info
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Info(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Info, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Info
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Info(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(ex.ToString(), LogLevel.Info, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Warn
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Warn(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Warn, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Warn
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Warn(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(ex.ToString(), LogLevel.Warn, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Error
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Error(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Error, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Error
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Error(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(ex.ToString(), LogLevel.Error, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Fatal
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—å†…å®¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Fatal(&lt;span&gt;string&lt;/span&gt; message, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(message, LogLevel.Fatal, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Fatal
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;ex&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;å¼‚å¸¸ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Fatal(Exception ex, &lt;span&gt;string&lt;/span&gt; emails = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            WriterToTargets(ex.ToString(), LogLevel.Fatal, emails);
        }
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; å†™æ—¥å¿—
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;message&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—ä¿¡æ¯&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;level&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;çº§åˆ«&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;emails&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ˜¯å¦å‘é€é‚®ä»¶,ä¸ä¸ºç©ºåˆ™å‘é€é‚®ä»¶ï¼Œå¤šä¸ªæ¥æ”¶äººç”¨è‹±æ–‡åˆ†å·;éš”å¼€&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; WriterToTargets(&lt;span&gt;string&lt;/span&gt; message, LogLevel level,&lt;span&gt;string&lt;/span&gt; emails=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;
            {
                LogEventDataAsync leda &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; LogEventDataAsync
                {
                    LogSource &lt;/span&gt;=&lt;span&gt; _logSource,
                    Level &lt;/span&gt;=&lt;span&gt; level.Name,
                    CallerStackBoundaryDeclaringType &lt;/span&gt;= GetType(),&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–å½“å‰å®ä¾‹&lt;/span&gt;
                    CallerStackTrace = &lt;span&gt;new&lt;/span&gt; StackTrace(&lt;span&gt;true&lt;/span&gt;),&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–å½“å‰StackTrace&lt;/span&gt;
                    Message =&lt;span&gt; message,
                    Emails &lt;/span&gt;=&lt;span&gt; emails
                };

                AsyncHelpers.StartAsyncTask(_logWriter.Writer, leda);&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ‰§è¡Œå¼‚æ­¥å†™æ—¥å¿—&lt;/span&gt;
&lt;span&gt;            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt;
            {
            }            
        }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;ä»£ç éå¸¸ç®€å•ï¼Œé‡è½½äº†æœ€å¸¸ç”¨çš„è‡ªå®šä¹‰ä¿¡æ¯å’Œexceptionä¿¡æ¯ï¼Œä»¥åŠé‚®ä»¶è”ç³»äººã€‚æ—¥å¿—æ¥æºä¸»è¦ä¸ºäº†åˆ†ç±»æ—¥å¿—ï¼Œåƒä¸åŒçš„æœåŠ¡ã€ç«™ç‚¹ç­‰ç­‰ï¼Œå¯ä»¥æ–¹ä¾¿å…¥åº“åæŸ¥è¯¢ã€‚åˆ°è¿™å·²ç»å¯ä»¥ç¼–è¯‘ä½¿ç”¨äº†ï¼Œä½†æ˜¯ä¸ºäº†åœ¨.net coreä¸­å¯ä»¥ä¾èµ–æ³¨å…¥è¿™ä¸ªLoggerï¼Œæœ€åæ·»åŠ ä¸€ä¸ªæ‰©å±•æ–¹æ³•&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;åˆ›å»ºExtensionsæ–‡ä»¶å¤¹åŠLoggerServiceExtensionç±»&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;&lt;img id=&quot;code_img_closed_5f176f2f-37a2-450d-a261-8ada56cd21f1&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_5f176f2f-37a2-450d-a261-8ada56cd21f1&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_5f176f2f-37a2-450d-a261-8ada56cd21f1&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;61&quot;&gt;
&lt;pre&gt;
&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ—¥å¿—æœåŠ¡æ³¨å…¥æ‰©å±•ç±»
    &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; LoggerServiceExtension
    {
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ³¨å…¥æ—¥å¿—æœåŠ¡
        &lt;/span&gt;&lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;service&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;IServiceCollection&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;logSource&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;æ—¥å¿—æ¥æºï¼Œé»˜è®¤æ—¥å¿—æ¥æºä¸ºè°ƒç”¨æ–¹æ³•æ‰€åœ¨ç±»ï¼šnamespace.classname&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
        &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IServiceCollection AddLoggerService(&lt;span&gt;this&lt;/span&gt; IServiceCollection service, &lt;span&gt;string&lt;/span&gt; logSource=&lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; service.AddTransient(factory =&amp;gt;&lt;span&gt; Logger.GetLogger(logSource));
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;3.ä½¿ç”¨ï¼ˆå¼•å…¥ç±»åº“ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬é¡¹ç›®ä½¿ç”¨å¯ä»¥è¿™æ ·ï¼Œæ¯”å¦‚æ§åˆ¶å°&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;31.5&quot;&gt;&lt;img id=&quot;code_img_closed_8189e5e6-d761-4478-a5b0-6ca8b57c4297&quot; class=&quot;code_img_closed&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; alt=&quot;&quot;/&gt;&lt;img id=&quot;code_img_opened_8189e5e6-d761-4478-a5b0-6ca8b57c4297&quot; class=&quot;code_img_opened&quot; src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; alt=&quot;&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_8189e5e6-d761-4478-a5b0-6ca8b57c4297&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;58&quot;&gt;
&lt;pre&gt;
&lt;span&gt;class&lt;/span&gt;&lt;span&gt; Program
    {
        &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; Logger logger = LogApiHandler.Logger.GetLogger(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;logSource&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Main(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] args)
        {
            logger.Debug(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);

            Console.ReadLine();
        }        
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;.net coreçš„è¯æ¯”å¦‚webé¡¹ç›®å¯ä»¥è¿™æ ·ç”¨ä¾èµ–æ³¨å…¥&lt;/p&gt;
&lt;p&gt;åœ¨Startupä¸­ï¼ŒConfigureServicesæ·»åŠ ä¸€è¡Œä»£ç &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;32&quot;&gt;
&lt;pre&gt;
services.AddLoggerService(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;TestApi&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;);
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶ååœ¨å…¶ä»–ç±»ä¸­å°±å¯ä»¥è¿™ä¹ˆç”¨äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨newçš„æ–¹å¼ä½¿ç”¨&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ValuesController : ControllerBase
    {
        &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; Logger _logger;
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; ValuesController(Logger logger)
        {
            _logger &lt;/span&gt;=&lt;span&gt; logger;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; GET api/values&lt;/span&gt;
&lt;span&gt;        [HttpGet]
        &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; ActionResult&amp;lt;IEnumerable&amp;lt;&lt;span&gt;string&lt;/span&gt;&amp;gt;&amp;gt;&lt;span&gt; Get()
        {
            _logger.Error(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;æµ‹è¯•ä¾èµ–æ³¨å…¥logger&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ddd@ddd.com&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; &lt;span&gt;string&lt;/span&gt;[] { &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;value1&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;value2&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; };
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¤§ä½“ä½¿ç”¨æ–¹å¼å°±æ˜¯è¿™æ ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;Â æœ€åå¾—éœ€è¦è‡ªå·±å†™ä¸€ä¸ªé¡µé¢æ¥è°ƒç”¨web apiçš„api/log/getlistæ¥å£æŸ¥è¯¢æ˜¾ç¤ºæ—¥å¿—&lt;/p&gt;
&lt;p&gt;mongodbå®¢æˆ·ç«¯ç”¨çš„Robo 3Tï¼Œå®‰è£…å®Œè®°å¾—ä¿®æ”¹Options--Display Dates in--Local Timezone,ä¸ç„¶é»˜è®¤utc,å­˜å…¥æ—¶çš„æ—¶é—´å°‘8å°æ—¶ã€‚mongodbå­˜å…¥æ•°æ®å°±æ˜¯ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/656769/201809/656769-20180919225438906-468150384.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 19 Sep 2018 14:16:00 +0000</pubDate>
<dc:creator>å»æµ·è¾¹ç”Ÿæ´»</dc:creator>
<og:description>å¼€å‘ç¯å¢ƒvs2017,æ•°æ®å†™å…¥åˆ°mongodbã€‚æ€è·¯å°±æ˜¯1.æä¾›æ¥å£å†™å…¥æ—¥å¿—ï¼Œ2.åŸºäºæ¥å£å°è£…ç±»åº“ã€‚3.å¼•å…¥ç±»åº“ä½¿ç”¨ ä¸ºä»€ä¹ˆè¦å†™å®ƒ å¾ˆå¤šå¼€æºé¡¹ç›®åƒnlogã€log4netã€elkã€exceptionl</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/betterlife/p/9676033.html</dc:identifier>
</item>
<item>
<title>.NetCoreå®è·µç¯‡ï¼šåˆ†å¸ƒå¼ç›‘æ§ZipkinæŒä¹…åŒ–ä¹‹æ®‡ - èŒƒå­˜å¨</title>
<link>http://www.cnblogs.com/fancunwei/p/9677952.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/fancunwei/p/9677952.html</guid>
<description>&lt;p&gt;æœ¬ç³»åˆ—å·²å†™äº†å››ç¯‡æ–‡ç« ï¼Œè¯»æœ¬ç¯‡ä¹‹å‰ï¼Œå¯ä»¥å…ˆè¯»å‰é¢å‡ ç¯‡ã€‚&lt;br/&gt;æ€è€ƒå¤§çº²ï¼š&lt;a href=&quot;https://www.cnblogs.com/fancunwei/p/9625841.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;.Netæ¶æ„ç¯‡:æ€è€ƒå¦‚ä½•è®¾è®¡ä¸€æ¬¾å®ç”¨çš„åˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿï¼Ÿ&lt;/a&gt;&lt;br/&gt;å®è·µç¯‡ä¸€ï¼š&lt;a href=&quot;https://www.cnblogs.com/fancunwei/p/9637247.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;.NetCoreå®è·µç¯‡ï¼šåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯ZipkinTracerä»å…¥é—¨åˆ°æ”¾å¼ƒä¹‹è·¯&lt;/a&gt;&lt;br/&gt;å®è·µç¯‡äºŒï¼š&lt;a href=&quot;https://www.cnblogs.com/fancunwei/p/9649192.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;.NetCoreå®è·µç¯‡ï¼šåˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿzipkinè¸©å‘ä¹‹è·¯ï¼ˆäºŒï¼‰&lt;/a&gt;&lt;br/&gt;å®è·µç¯‡ä¸‰ï¼š&lt;a href=&quot;https://www.cnblogs.com/fancunwei/p/9664749.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;.NetCoreå®è·µç¯‡ï¼šæˆåŠŸè§£å†³åˆ†å¸ƒå¼ç›‘æ§ZipKinèšåˆä¾èµ–é—®é¢˜ï¼ˆä¸‰ï¼‰&lt;/a&gt;&lt;/p&gt;

&lt;h2&gt;zipkin&lt;/h2&gt;
&lt;p&gt;Zipkinæ˜¯ä¸€ç§åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿã€‚å®ƒæœ‰åŠ©äºæ”¶é›†è§£å†³å¾®æœåŠ¡æ¶æ„ä¸­çš„å»¶è¿Ÿé—®é¢˜æ‰€éœ€çš„æ—¶åºæ•°æ®&lt;br/&gt;&lt;a href=&quot;https://zipkin.io/&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkinå®˜ç½‘&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;zipkin4Net&lt;/h2&gt;
&lt;p&gt;zipkin4netæ˜¯.NETå®¢æˆ·ç«¯åº“ã€‚&lt;br/&gt;&lt;a href=&quot;https://github.com/openzipkin/zipkin4net&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkin4net&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;zipkin-dependencies&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªSparkä½œä¸šï¼Œå®ƒå°†ä»æ‚¨çš„æ•°æ®å­˜å‚¨åŒºæ”¶é›†è·¨åº¦ï¼Œåˆ†ææœåŠ¡ä¹‹é—´çš„é“¾æ¥ï¼Œå¹¶å­˜å‚¨å®ƒä»¬ä»¥ä¾›ä»¥ååœ¨&lt;a href=&quot;https://github.com/openzipkin/zipkin/tree/master/zipkin-ui&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;Web UIä¸­&lt;/a&gt;å‘ˆç°ã€‚&lt;/p&gt;
&lt;h3&gt;ä½¿ç”¨æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;å¦‚æœå†…å­˜ä¸è¶³æ—¶ï¼Œjavaåè·Ÿä¸Š-Xmx1024m -Xms1024må‚æ•°ï¼ŒJAVA_OPTSçš„ä¸€äº›å‚æ•°å¯å‚è€ƒOracleå®˜æ–¹è¯´æ˜&lt;a href=&quot;https://docs.oracle.com/cd/E22289_01/html/821-1274/configuring-the-default-jvm-and-java-arguments.html#scrolltoc&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;é…ç½®é»˜è®¤JVMå’ŒJavaå‚æ•°&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;
$ STORAGE_TYPE=cassandra3 java -jar zipkin-dependencies.jar &lt;span class=&quot;hljs-string&quot;&gt;`date -uv-1d +%F`&lt;/span&gt;

$ STORAGE_TYPE=cassandra3 java -jar zipkin-dependencies.jar &lt;span class=&quot;hljs-string&quot;&gt;`date -u -d '1 day ago' +%F`&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;MySQL å­˜å‚¨&lt;/h3&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;* &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_DB`&lt;/span&gt;: ä½¿ç”¨çš„æ•°æ®åº“ï¼Œé»˜è®¤æ˜¯ &lt;span class=&quot;hljs-string&quot;&gt;&quot;zipkin&quot;&lt;/span&gt;.
* &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_USER`&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_PASS`&lt;/span&gt;: MySQLæˆæƒ, é»˜è®¤æ˜¯ç©º.
* &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_HOST`&lt;/span&gt;: é»˜è®¤ä¸»æœºï¼ˆåŸŸå/ipï¼‰æ˜¯localhost
* &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_TCP_PORT`&lt;/span&gt;: é»˜è®¤ç«¯å£æ˜¯ &lt;span class=&quot;hljs-number&quot;&gt;3306&lt;/span&gt;
* &lt;span class=&quot;hljs-string&quot;&gt;`MYSQL_USE_SSL`&lt;/span&gt;: éªŒè¯ &lt;span class=&quot;hljs-string&quot;&gt;`javax.net.ssl.trustStore`&lt;/span&gt; å’Œ &lt;span class=&quot;hljs-string&quot;&gt;`javax.net.ssl.trustStorePassword`&lt;/span&gt;,é»˜è®¤ä¸éªŒè¯ã€‚
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4&gt;ç¤ºä¾‹&lt;/h4&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;$ STORAGE_TYPE=mysql MYSQL_USER=root java -jar zipkin-dependencies.jar
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¦æƒ…å‚è€ƒï¼š&lt;br/&gt;&lt;a href=&quot;https://github.com/openzipkin/zipkin-dependencies&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkin-dependencies&lt;/a&gt;&lt;/p&gt;

&lt;h2&gt;åˆ›å»ºä½¿ç”¨æ•°æ®åº“&lt;/h2&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;mysql&amp;gt; create database mytestdb;
Query OK, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; row affected (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;01&lt;/span&gt; sec)
mysql&amp;gt; show databases;
+--------------------+
&lt;span class=&quot;hljs-params&quot;&gt;| Database |&lt;/span&gt;
+--------------------+
&lt;span class=&quot;hljs-params&quot;&gt;| information_schema |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| mysql |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| mytestdb |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| performance_schema |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| sys |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| ttt |&lt;/span&gt;
+--------------------+
&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt; rows &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; set (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; sec)
mysql&amp;gt; use mytestdb
Database changed
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;ä½¿ç”¨sqlè¯­å¥åˆ›å»ºzipkinè¡¨&lt;/h2&gt;
&lt;pre class=&quot;hljs javascript&quot;&gt;
&lt;code class=&quot;javascript&quot;&gt;CREATETABLE IF NOT EXISTS zipkin_spans (
&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt; BIGINT NOT NULL DEFAULT &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'If non zero, this means the trace uses 128 bit traceIds instead of 64bit'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt; BIGINT NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt; BIGINT NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`name`&lt;/span&gt; VARCHAR(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`parent_id`&lt;/span&gt; BIGINT,
&lt;span class=&quot;hljs-string&quot;&gt;`debug`&lt;/span&gt; BIT(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;),
&lt;span class=&quot;hljs-string&quot;&gt;`start_ts`&lt;/span&gt; BIGINT COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Span.timestamp():epoch micros used for endTs query and to implement TTL'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`duration`&lt;/span&gt; BIGINT COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Span.duration():micros used for minDuration and maxDuration query'&lt;/span&gt;
)ENGINE=InnoDB ROW_FORMAT=COMPRESSED CHARACTER SET=utf8 COLLATE utf8_general_ci;
ALTERTABLE zipkin_spans ADD UNIQUE KEY(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt;) COMMENT&lt;span class=&quot;hljs-string&quot;&gt;'ignore insert on duplicate'&lt;/span&gt;;
ALTERTABLE zipkin_spans ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`id`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'forjoining with zipkin_annotations'&lt;/span&gt;;
ALTERTABLE zipkin_spans ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'forgetTracesByIds'&lt;/span&gt;;
ALTERTABLE zipkin_spans ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`name`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'for getTraces and getSpanNames'&lt;/span&gt;;
ALTERTABLE zipkin_spans ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`start_ts`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'for getTraces ordering andrange'&lt;/span&gt;;
CREATETABLE IF NOT EXISTS zipkin_annotations (
&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt; BIGINT NOT NULL DEFAULT &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'If non zero, this means the trace uses 128 bit traceIds instead of 64bit'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt; BIGINT NOT NULL COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'coincideswith zipkin_spans.trace_id'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`span_id`&lt;/span&gt; BIGINT NOT NULL COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'coincideswith zipkin_spans.id'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`a_key`&lt;/span&gt; VARCHAR(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) NOT NULL COMMENT&lt;span class=&quot;hljs-string&quot;&gt;'BinaryAnnotation.key or Annotation.value if type == -1'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`a_value`&lt;/span&gt; BLOB COMMENT&lt;span class=&quot;hljs-string&quot;&gt;'BinaryAnnotation.value(), which must be smaller than 64KB'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`a_type`&lt;/span&gt; INT NOT NULL COMMENT&lt;span class=&quot;hljs-string&quot;&gt;'BinaryAnnotation.type() or -1 if Annotation'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`a_timestamp`&lt;/span&gt; BIGINT COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Used toimplement TTL; Annotation.timestamp or zipkin_spans.timestamp'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`endpoint_ipv4`&lt;/span&gt; INT COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Null whenBinary/Annotation.endpoint is null'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`endpoint_ipv6`&lt;/span&gt; BINARY(&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Null whenBinary/Annotation.endpoint is null, or no IPv6 address'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`endpoint_port`&lt;/span&gt; SMALLINT COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Null whenBinary/Annotation.endpoint is null'&lt;/span&gt;,
&lt;span class=&quot;hljs-string&quot;&gt;`endpoint_service_name`&lt;/span&gt; VARCHAR(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) COMMENT&lt;span class=&quot;hljs-string&quot;&gt;'Null when Binary/Annotation.endpoint is null'&lt;/span&gt;
)ENGINE=InnoDB ROW_FORMAT=COMPRESSED CHARACTER SET=utf8 COLLATE utf8_general_ci;
ALTERTABLE zipkin_annotations ADD UNIQUE KEY(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`span_id`&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;`a_key`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`a_timestamp`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'Ignore insert on duplicate'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`span_id`&lt;/span&gt;)COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'for joining with zipkin_spans'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id_high`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'forgetTraces/ByIds'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`endpoint_service_name`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'forgetTraces and getServiceNames'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`a_type`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'for getTraces'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`a_key`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'for getTraces'&lt;/span&gt;;
ALTERTABLE zipkin_annotations ADD INDEX(&lt;span class=&quot;hljs-string&quot;&gt;`trace_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`span_id`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`a_key`&lt;/span&gt;) COMMENT &lt;span class=&quot;hljs-string&quot;&gt;'fordependencies job'&lt;/span&gt;;
CREATETABLE IF NOT EXISTS zipkin_dependencies (
&lt;span class=&quot;hljs-string&quot;&gt;`day`&lt;/span&gt; DATE NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`parent`&lt;/span&gt; VARCHAR(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`child`&lt;/span&gt; VARCHAR(&lt;span class=&quot;hljs-number&quot;&gt;255&lt;/span&gt;) NOT NULL,
&lt;span class=&quot;hljs-string&quot;&gt;`call_count`&lt;/span&gt; BIGINT
)ENGINE=InnoDB ROW_FORMAT=COMPRESSED CHARACTER SET=utf8 COLLATE utf8_general_ci;
ALTERTABLE zipkin_dependencies ADD UNIQUE KEY(&lt;span class=&quot;hljs-string&quot;&gt;`day`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`parent`&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;`child`&lt;/span&gt;);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åˆ›å»ºæˆåŠŸåï¼ŒæŸ¥è¯¢ç»“æœã€‚&lt;/p&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;mysql&amp;gt; show tables;
+---------------------+
&lt;span class=&quot;hljs-params&quot;&gt;| Tables_in_mytestdb |&lt;/span&gt;
+---------------------+
&lt;span class=&quot;hljs-params&quot;&gt;| zipkin_annotations |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| zipkin_dependencies |&lt;/span&gt;
&lt;span class=&quot;hljs-params&quot;&gt;| zipkin_spans |&lt;/span&gt;
+---------------------+
&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; rows &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; set (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; sec)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;å¯åŠ¨zipkin-dependencies&lt;/h2&gt;
&lt;p&gt;æœ€å¼€å§‹æˆ‘çš„å¯†ç æ˜¯ã€å››ä¸ªå­—æ¯ä¸€ä¸ªæ„Ÿå¹å·ä¸€ä¸ªæ•°å­—ã€‘ï¼Œå†æ‰§è¡Œå¯åŠ¨å‘½ä»¤æ—¶ï¼Œ&lt;span&gt;å¯†ç é‚£å—ç»™æˆ‘æŠ¥é”™è‡ªåŠ¨æ¢æˆã€å››ä¸ªå­—æ¯rm -fã€‘&lt;/span&gt;ï¼Œæˆ‘ä¿®æ”¹æˆã€å››ä¸ªå­—æ¯ä¸€ä¸ª#å·ä¸€ä¸ªæ•°å­—ã€‘å°±èƒ½æ‰§è¡Œäº†&lt;/p&gt;
&lt;p&gt;æ‰§è¡ŒæˆåŠŸåï¼Œä¾ç„¶æç¤º&lt;span&gt;Access denied for user 'root'@'localhost' (using password: NO)&lt;/span&gt;,ä½†æˆ‘åœ¨linuxçš„å‘½ä»¤ä¸­ç›´æ¥ç”¨mysql -u root -pç›¸åŒå¯†ç æ˜¯å¯ä»¥ç™»å½•æˆåŠŸçš„ã€‚æ‰€ä»¥é—®é¢˜å‡ºç°åœ¨å“ªå‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre class=&quot;hljs bash&quot;&gt;
&lt;code class=&quot;bash&quot;&gt;[root@izwz9fwifc2eniq3lbdzmgz cusD]
Exception &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; thread &lt;span class=&quot;hljs-string&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.RuntimeException: java.sql.SQLInvalidAuthorizationSpecException: Access denied &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; user &lt;span class=&quot;hljs-string&quot;&gt;'root'&lt;/span&gt;@&lt;span class=&quot;hljs-string&quot;&gt;'localhost'&lt;/span&gt; (using password: NO)
at zipkin2.dependencies.mysql.MySQLDependenciesJob.hasTraceIdHigh(MySQLDependenciesJob.java:233)
at zipkin2.dependencies.mysql.MySQLDependenciesJob.run(MySQLDependenciesJob.java:184)
at zipkin2.dependencies.ZipkinDependenciesJob.main(ZipkinDependenciesJob.java:65)
Caused by: java.sql.SQLInvalidAuthorizationSpecException: Access denied &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; user &lt;span class=&quot;hljs-string&quot;&gt;'root'&lt;/span&gt;@&lt;span class=&quot;hljs-string&quot;&gt;'localhost'&lt;/span&gt; (using password: NO)
at org.mariadb.jdbc.internal.util.exceptions.ExceptionMapper.get(ExceptionMapper.java:173)
at org.mariadb.jdbc.internal.util.exceptions.ExceptionMapper.getException(ExceptionMapper.java:110)
at org.mariadb.jdbc.internal.protocol.AbstractConnectProtocol.connectWithoutProxy(AbstractConnectProtocol.java:1115)
at org.mariadb.jdbc.internal.util.Utils.retrieveProxy(Utils.java:502)
at org.mariadb.jdbc.MariaDbConnection.newConnection(MariaDbConnection.java:154)
at org.mariadb.jdbc.Driver.connect(Driver.java:86)
at java.sql.DriverManager.getConnection(DriverManager.java:664)
at java.sql.DriverManager.getConnection(DriverManager.java:247)
at zipkin2.dependencies.mysql.MySQLDependenciesJob.hasTraceIdHigh(MySQLDependenciesJob.java:229)
... 2 more
Caused by: java.sql.SQLException: Access denied &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; user &lt;span class=&quot;hljs-string&quot;&gt;'root'&lt;/span&gt;@&lt;span class=&quot;hljs-string&quot;&gt;'localhost'&lt;/span&gt; (using password: NO)
Current charset is UTF-8. If password has been &lt;span class=&quot;hljs-built_in&quot;&gt;set&lt;/span&gt; using other charset, consider using option &lt;span class=&quot;hljs-string&quot;&gt;'passwordCharacterEncoding'&lt;/span&gt;
at org.mariadb.jdbc.internal.protocol.AbstractConnectProtocol.authentication(AbstractConnectProtocol.java:862)
at org.mariadb.jdbc.internal.protocol.AbstractConnectProtocol.handleConnectionPhases(AbstractConnectProtocol.java:785)
at org.mariadb.jdbc.internal.protocol.AbstractConnectProtocol.connect(AbstractConnectProtocol.java:456)
at org.mariadb.jdbc.internal.protocol.AbstractConnectProtocol.connectWithoutProxy(AbstractConnectProtocol.java:1111)
... 8 more
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;è¿½æº¯æºç &lt;/h2&gt;
&lt;p&gt;é€¼ä¸å¾—å·²ï¼Œèµ°ä¸ŠæŸ¥çœ‹æºç ä¹‹è·¯ï¼ŒIdeaæ‰“å¼€zipkin-dependencies/mysqlæºç ï¼ŒæŸ¥çœ‹ç›¸å…³éƒ¨åˆ†ä»£ç ã€‚&lt;/p&gt;
&lt;pre class=&quot;hljs java&quot;&gt;
&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Builder&lt;/span&gt; &lt;/span&gt;{
Map&amp;lt;String, String&amp;gt; sparkProperties = ImmutableMap.of(
&lt;span class=&quot;hljs-string&quot;&gt;&quot;spark.ui.enabled&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;false&quot;&lt;/span&gt;
);
String db = getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_DB&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;zipkin&quot;&lt;/span&gt;);
String host = getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_HOST&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;localhost&quot;&lt;/span&gt;);
&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; port = Integer.parseInt(getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_TCP_PORT&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;3306&quot;&lt;/span&gt;));
String user = getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_USER&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);
String password = getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_PASS&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);
&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; maxConnections = Integer.parseInt(getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_MAX_CONNECTIONS&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;10&quot;&lt;/span&gt;));
&lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; useSsl = Boolean.parseBoolean(getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MYSQL_USE_SSL&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;false&quot;&lt;/span&gt;));

String sparkMaster = getEnv(&lt;span class=&quot;hljs-string&quot;&gt;&quot;SPARK_MASTER&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;local[*]&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-keyword&quot;&gt;long&lt;/span&gt; day = midnightUTC(System.currentTimeMillis());

&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; MySQLDependenciesJob &lt;span class=&quot;hljs-title&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{
&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; MySQLDependenciesJob(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;);
}
}

MySQLDependenciesJob(Builder builder) {
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.db = builder.db;
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.day = builder.day;
SimpleDateFormat df = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; SimpleDateFormat(&lt;span class=&quot;hljs-string&quot;&gt;&quot;yyyy-MM-dd&quot;&lt;/span&gt;);
df.setTimeZone(TimeZone.getTimeZone(&lt;span class=&quot;hljs-string&quot;&gt;&quot;UTC&quot;&lt;/span&gt;));
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.dateStamp = df.format(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Date(builder.day));
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.url = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; StringBuilder(&lt;span class=&quot;hljs-string&quot;&gt;&quot;jdbc:mysql://&quot;&lt;/span&gt;)
.append(builder.host).append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;:&quot;&lt;/span&gt;).append(builder.port)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;/&quot;&lt;/span&gt;).append(builder.db)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;?autoReconnect=true&quot;&lt;/span&gt;)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;useSSL=&quot;&lt;/span&gt;).append(builder.useSsl).toString();
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.user = builder.user;
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.password = builder.password;
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.conf = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; SparkConf(&lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;)
.setMaster(builder.sparkMaster)
.setAppName(getClass().getName());
&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (builder.jars != &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;) conf.setJars(builder.jars);
&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;String, String&amp;gt; entry : builder.sparkProperties.entrySet()) {
conf.set(entry.getKey(), entry.getValue());
}
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.logInitializer = builder.logInitializer;
}
&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;saveToMySQL&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(List&amp;lt;DependencyLink&amp;gt; links)&lt;/span&gt; &lt;/span&gt;{
&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; (Connection con = DriverManager.getConnection(url, user, password)) {
PreparedStatement replace = con.prepareStatement(
&lt;span class=&quot;hljs-string&quot;&gt;&quot;REPLACE INTO zipkin_dependencies (day, parent, child, call_count, error_count) VALUES (?,?,?,?,?)&quot;&lt;/span&gt;);
&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (DependencyLink link : links) {
replace.setDate(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; java.sql.Date(day));
replace.setString(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, link.parent());
replace.setString(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, link.child());
replace.setLong(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, link.callCount());
replace.setLong(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, link.errorCount());
replace.executeUpdate();
}
} &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {
&lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Could not save links &quot;&lt;/span&gt; + links, e);
}
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶å¹¶åµï¼Œçœ‹å®Œä¹‹åï¼Œæ²¡çœ‹å‡ºæ˜æ˜¾é—®é¢˜ã€‚éš¾é“è¿˜æ˜¯æˆ‘è‡ªå·±çš„mysqlé…ç½®é—®é¢˜ï¼Ÿè¿˜æ˜¯å¯åŠ¨éƒ¨åˆ†çš„å‚æ•°é—®é¢˜ï¼Ÿä»£ç éƒ¨åˆ†ä¹Ÿæ˜¯æœ‰äº›ç–‘æƒ‘,passwordå’Œrootä¸ºä»€ä¹ˆæ²¡æ”¾è¿›urlé‡Œï¼Œéš¾é“æ˜¯ä¸ºäº†å®‰å…¨è€ƒè™‘ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;pre class=&quot;hljs cpp&quot;&gt;
&lt;code class=&quot;cpp&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.url = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; StringBuilder(&lt;span class=&quot;hljs-string&quot;&gt;&quot;jdbc:mysql://&quot;&lt;/span&gt;)
.append(builder.host).append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;:&quot;&lt;/span&gt;).append(builder.port)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;/&quot;&lt;/span&gt;).append(builder.db)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;?autoReconnect=true&quot;&lt;/span&gt;)
.append(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;useSSL=&quot;&lt;/span&gt;).append(builder.useSsl).toString();
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.user = builder.user;
&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.password = builder.password;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ–‡ä¸­è¿˜æåˆ° Current charset is UTF-8. If password has been set using other charset, consider using option 'passwordCharacterEncoding'ï¼Œç¼–ç æ ¼å¼æ˜¯å¦æœ‰ä¸åŒå‘¢ï¼Ÿ&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/shootercheng/p/5836657.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;æŸ¥çœ‹mysqlæ•°æ®åº“åŠè¡¨ç¼–ç æ ¼å¼&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;hljs ruby&quot;&gt;
&lt;code class=&quot;ruby&quot;&gt;mysql&amp;gt; show variables like &lt;span class=&quot;hljs-string&quot;&gt;'character_set_database'&lt;/span&gt;;
+------------------------+---------+
&lt;span class=&quot;hljs-params&quot;&gt;| Variable_name |&lt;/span&gt; Value &lt;span class=&quot;hljs-params&quot;&gt;|
+------------------------+---------+
|&lt;/span&gt; character_set_database &lt;span class=&quot;hljs-params&quot;&gt;| utf8mb4 |&lt;/span&gt;
+------------------------+---------+
&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; set (&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;hljs-number&quot;&gt;01&lt;/span&gt; sec)
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;a href=&quot;https://jira.mariadb.org/browse/CONJ-480&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;https://jira.mariadb.org/browse/CONJ-480&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://samebug.io/exceptions/2980875/java.sql.SQLInvalidAuthorizationSpecException/could-not-connect-access-denied-for-user&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;https://samebug.io/exceptions/2980875/java.sql.SQLInvalidAuthorizationSpecException/could-not-connect-access-denied-for-user&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://stackoverflow.com/questions/11002827/passing-request-parameters-as-utf-8-encoded-strings&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;å°†è¯·æ±‚å‚æ•°ä½œä¸ºUTF-8ç¼–ç çš„å­—ç¬¦ä¸²ä¼ é€’[é‡å¤]&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/liaokailin/article/details/52077620&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkin&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://blog.csdn.net/lindan1984/article/details/79325124&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkiné›†æˆåˆ°nodeï¼ŒC#&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://blog.csdn.net/jek123456/article/details/78077112&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;å¾®æœåŠ¡ä¹‹åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿï¼ˆspringboot+zipkin+mysqlï¼‰&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/java-zhao/p/5858138.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;ç¬¬äºŒåä¹ç«  springboot + zipkin + mysql&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://blog.csdn.net/qq_41186788/article/details/80462916&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;Linuxä¸‹çš„Mysqlç”¨å‘½ä»¤æ‰§è¡Œsqlæ–‡ä»¶&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://docs.bitnami.com/installer/apps/liferay/administration/change-reset-password/&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;ä¿®æ”¹MySQLç®¡ç†å‘˜å¯†ç &lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://github.com/openzipkin/zipkin/tree/master/zipkin-server&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;zipkin-server&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç”±äºå¯åŠ¨zipkin-dependenciesé“¾æ¥mysqlæŠ¥&lt;span&gt;Access denied for user 'root'@'localhost' (using password: NO)&lt;/span&gt;é”™è¯¯ï¼Œæœ¬æ¬¡æŒä¹…åŒ–ä¹‹è·¯æœ€ç»ˆå¤±è´¥ã€‚ä½†ç”±äºæˆ‘ç›´æ¥ä½¿ç”¨ã€mysql -u ç”¨æˆ· -pã€‘æ˜¯èƒ½ç™»å½•æˆåŠŸçš„ï¼Œæ‰€ä»¥æˆ‘çŒœæµ‹äº†ä»¥ä¸‹åŸå› ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å®¢æˆ·ç«¯è‡ªå·±çš„bug,å’Œæˆ‘æœåŠ¡å™¨mysqlç‰ˆæœ¬ä¸å…¼å®¹ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ç¼–ç é—®é¢˜ï¼Œç¼–ç ä¸¤è€…ä¸ç¬¦ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·åå’Œå¯†ç æ²¡æœ‰å…±äº«å…¨å±€ï¼Œåªå¯¹ä¸€ä¸ªæ•°æ®åº“æœ‰æ•ˆï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;åˆ«äººçš„åšæ–‡æ˜¯é¢å‘æ•™å­¦æˆåŠŸç¼–ç¨‹ï¼Œæˆ‘çš„æ˜¯é¢å‘å¤±è´¥ç¼–ç¨‹ï¼Œä¹Ÿåˆ«æœ‰ä¸€ç•ªè¶£å‘³ã€‚ç•™ä¸‹ç–‘é—®ï¼Œå¾…æ—¥åè§£å†³è°ƒã€‚è™½ç„¶å¤±è´¥äº†ï¼Œä½†æˆ‘åˆæ”¶é›†äº†ä¸€å †é“¾æ¥ï¼Œå¢æ·»äº†mysqlä¸€äº›æ•…éšœè§£å†³çš„è®¤è¯†ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå¤©æ¢äº†ä¸€æ¬¾ä¸ªäººå¾ˆå–œæ¬¢çš„çš®è‚¤ï¼Œä¼šæ ¹æ®h1,h2è‡ªåŠ¨ç”Ÿæˆç›®å½•ï¼Œä¹‹å‰çš„åšæ–‡æˆ‘ä¹Ÿéƒ½æ£€æŸ¥äº†ä¸‹ï¼Œæœ‰å¾ˆå¤§å¤±ä½çš„æˆ‘éƒ½è°ƒæ•´äº†è¿‡æ¥ï¼Œä¸æ ‡å‡†çš„æš‚æ—¶ä¸æ”¹äº†ï¼Œæˆ‘ä»¥åçš„åšæ–‡éƒ½æŒ‰ç…§è¦æ±‚çš„æ ¼å¼å†™ï¼Œæ’ç‰ˆç¾è§‚åº¦æå‡äº†å¾ˆå¤šï¼Œæ„Ÿè°¢ä½œè€…&lt;a href=&quot;https://www.cnblogs.com/bndong/&quot; title=&quot;bndong&quot;&gt;bndong&lt;/a&gt;ï¼Œå¦‚æœæœ‰æ‰“ç®—ä½¿ç”¨è¿™ä¸ªçš®è‚¤çš„ï¼Œä¸€å®šè¦å¼€å¯&lt;strong&gt;æ§ä»¶æ˜¾ç¤ºå…¬å‘Šã€‚&lt;/strong&gt;&lt;/p&gt;
</description>
<pubDate>Wed, 19 Sep 2018 14:06:00 +0000</pubDate>
<dc:creator>èŒƒå­˜å¨</dc:creator>
<og:description>å‰è¨€ æœ¬ç³»åˆ—å·²å†™äº†å››ç¯‡æ–‡ç« ï¼Œè¯»æœ¬ç¯‡ä¹‹å‰ï¼Œå¯ä»¥å…ˆè¯»å‰é¢å‡ ç¯‡ã€‚ æ€è€ƒå¤§çº²ï¼š.Netæ¶æ„ç¯‡:æ€è€ƒå¦‚ä½•è®¾è®¡ä¸€æ¬¾å®ç”¨çš„åˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿï¼Ÿ å®è·µç¯‡ä¸€ï¼š.NetCoreå®è·µç¯‡ï¼šåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯ZipkinTracer</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/fancunwei/p/9677952.html</dc:identifier>
</item>
<item>
<title>æœºå™¨å­¦ä¹ ï¼šé›†æˆå­¦ä¹ ï¼ˆensemble learningï¼‰ï¼ˆä¸€ï¼‰â€”â€”åŸç†æ¦‚è¿° - æµå½±å¿ƒ</title>
<link>http://www.cnblogs.com/lyxML/p/9670627.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/lyxML/p/9670627.html</guid>
<description>&lt;h3 id=&quot;é›†æˆå­¦ä¹ ensemble-learning&quot;&gt;é›†æˆå­¦ä¹ ï¼ˆensemble learningï¼‰&lt;/h3&gt;
&lt;p&gt;é›†æˆå­¦ä¹ é€šè¿‡æ„å»ºå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨ï¼Œç„¶åå†ç”¨æŸç§ç­–ç•¥å°†ä»–ä»¬ç»“åˆèµ·æ¥ï¼Œäº§ç”Ÿä¸€ä¸ªæœ‰è¾ƒå¥½æ•ˆæœçš„å¼ºå­¦ä¹ å™¨æ¥å®Œæˆä»»åŠ¡ã€‚åŸºæœ¬åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™é‡Œä¸»è¦æœ‰ä¸‰ä¸ªå…³é”®ç‚¹ï¼šä¸ªä½“å­¦ä¹ å™¨çš„åŒè´¨å¼‚è´¨ã€ä¸ªä½“å­¦ä¹ å™¨çš„ç”Ÿæˆæ–¹å¼ã€ç»“åˆç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1453066/201809/1453066-20180919165340759-844441675.png&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;åŒè´¨å¼‚è´¨&lt;/strong&gt;ã€‚é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ä¸ªä½“å­¦ä¹ å™¨è‡³å°‘ä¸å·®äºå¼±å­¦ä¹ å™¨ã€‚å¼±å­¦ä¹ å™¨å¸¸æŒ‡æ³›åŒ–æ€§èƒ½ç•¥ä¼˜äºéšæœºçŒœæµ‹çš„å­¦ä¹ å™¨ï¼Œä¾‹å¦‚äºŒåˆ†ç±»é—®é¢˜ä¸­ç²¾åº¦ç•¥é«˜äº50%çš„åˆ†ç±»å™¨ã€‚å¯¹äºè®­ç»ƒæ•°æ®è‹¥é›†æˆä¸­çš„ä¸ªä½“å­¦ä¹ å™¨ä¸ºåŒä¸€ç±»å‹ï¼Œä¾‹å¦‚éƒ½ä¸ºBPç¥ç»ç½‘ç»œæˆ–è€…éƒ½ä¸ºå†³ç­–æ ‘ï¼Œåˆ™ç§°åŒè´¨é›†æˆã€‚åŒæ ·çš„é“ç†ï¼Œè‹¥ä¸ªä½“å­¦ä¹ å™¨ç±»å‹ä¸åŒï¼Œä¾‹å¦‚æ—¢æœ‰å†³ç­–æ ‘åˆæœ‰ç¥ç»ç½‘ç»œï¼Œåˆ™ç§°å¼‚è´¨é›†æˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ªä½“å­¦ä¹ å™¨çš„ç”Ÿæˆæ–¹å¼&lt;/strong&gt;ã€‚ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ã€å¿…é¡»ä¸²è¡Œç”Ÿæˆçš„åºåˆ—åŒ–æ–¹æ³•ï¼Œä»¥åŠä¸ªä½“å­¦ä¹ å™¨ä»¶ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ã€å¯åŒæ—¶ç”Ÿæˆçš„å¹¶è¡ŒåŒ–æ–¹æ³•ã€‚å‰è€…ä»£è¡¨æ˜¯Boostingï¼Œåè€…ä»£è¡¨æ˜¯Baggingå’Œéšæœºæ£®æ—ï¼ˆRandom Forestï¼‰ã€‚&lt;br/&gt;&lt;strong&gt;1.BoostingåŸºæœ¬åŸç†å¦‚å›¾æ‰€ç¤º&lt;/strong&gt;ã€‚å¤§å¤šæ•°æå‡æ–¹æ³•éƒ½æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œé’ˆå¯¹ä¸åŒè®­ç»ƒæ•°æ®åˆ†å¸ƒè·å¾—ä¸åŒä¸ªä½“å­¦ä¹ å™¨ï¼Œæœ€ç»ˆç»„åˆã€‚å› æ­¤éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯æ¯ä¸€è½®æ€æ ·æ”¹å˜æƒå€¼åˆ†å¸ƒçš„ï¼ŒäºŒæ˜¯å¦‚ä½•å°†ä¸ªä½“å­¦ä¹ å™¨è¿›è¡Œç»„åˆçš„ã€‚Adabooståšæ³•æ˜¯ï¼Œå¯¹äºå‰è€…æé«˜è¢«å‰ä¸€è½®é¢„æµ‹é”™è¯¯æ ·æœ¬çš„çš„æƒé‡ï¼Œé™ä½é¢„æµ‹æ­£ç¡®æ ·æœ¬çš„çš„æƒé‡ï¼Œå¯¹äºåè€…åŠ å¤§è¯¯å·®ç‡å°çš„ä¸ªä½“å­¦ä¹ å™¨çš„æƒå€¼ï¼Œå‡å°è¯¯å·®ç‡å°çš„ä¸ªä½“å­¦ä¹ ç‡çš„æƒå€¼ã€‚&lt;strong&gt;Boostingç®—æ³•è¦æ±‚ä¸ªä½“å­¦ä¹ å™¨èƒ½å¤Ÿå¯¹ç‰¹å®šçš„æ•°æ®åˆ†å¸ƒè¿›è¡Œå­¦ä¹ ï¼Œè¿™å¯ä»¥é€šè¿‡â€œé‡èµ‹æƒæ³•â€å®æ–½ï¼Œå³åœ¨è®­ç»ƒè¿‡ç¨‹æ¯ä¸€è½®ä¸­ï¼Œæ ¹æ®æ ·æœ¬åˆ†å¸ƒå¯¹æ¯ä¸ªæ ·æœ¬é‡æ–°èµ‹äºˆæƒé‡ã€‚å¯¹äºæ— æ³•æ¥å—å¸¦æƒæ ·æœ¬çš„ä¸ªä½“å­¦ä¹ å™¨ï¼ˆç®—æ³•ï¼‰ï¼Œå¯ä»¥é€šè¿‡â€œé‡é‡‡æ ·æ³•â€æ¥å¤„ç†ï¼Œå³åœ¨æ¯ä¸€è½®å­¦ä¹ ä¸­ï¼Œæ ¹æ®æ ·æœ¬åˆ†å¸ƒå¯¹è®­ç»ƒé›†é‡æ–°é‡‡æ ·ï¼Œå†ç”¨é‡é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬é›†å¯¹ä¸ªä½“å­¦ä¹ å™¨è¿›è¡Œè®­ç»ƒã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸¤è€…å·®åˆ«ä¸å¤§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ¯ä¸€è½®è®­ç»ƒä¸­éœ€è¦æ£€æŸ¥å½“å‰ç”Ÿæˆçš„å­¦ä¹ å™¨æ˜¯å¦æ»¡è¶³åŸºæœ¬æ¡ä»¶ï¼Œä¸€æ—¦ä¸æ»¡è¶³ï¼Œåˆ™è¢«æŠ›å¼ƒï¼Œå¹¶ä¸”å­¦ä¹ åœæ­¢ï¼Œæ­¤æ—¶å¯èƒ½è¿˜è¿œè¿œæ²¡æœ‰è¾¾åˆ°æœ€å¤§å­¦ä¹ è½®æ•°ï¼Œå¯¼è‡´æœ€ç»ˆå­¦ä¹ å™¨æ€§èƒ½æ¬ ä½³ã€‚è‹¥é‡‡ç”¨â€œé‡é‡‡æ ·æ³•â€ï¼Œåˆ™ä¼šâ€œé‡å¯åŠ¨â€ï¼Œä»¥é¿å…è¿‡æ—©åœæ­¢ã€‚&lt;/strong&gt;&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1453066/201809/1453066-20180919172903466-158489530.png&quot;/&gt;&lt;br/&gt;&lt;strong&gt;2.BaggingåŸºæœ¬åŸç†å¦‚å›¾æ‰€ç¤º&lt;/strong&gt;ã€‚è¦æƒ³å¾—åˆ°æ³›åæ€§è¾ƒå¼ºçš„é›†æˆï¼Œå…¶ä¸­æ¯ä¸ªå­¦ä¹ å™¨åº”å°½é‡ç‹¬ç«‹ï¼Œåœ¨ç°å®ä¸­æ— æ³•åšåˆ°ï¼Œä½†å¯ä»¥è®¾æ³•ä½¿ä¹‹å·®å¼‚è¾ƒå¤§ã€‚ä¸€ç§åšæ³•å°±æ˜¯å¯¹è®­ç»ƒé›†é‡‡æ ·äº§ç”Ÿå¤šä¸ªå­é›†ï¼Œå¯¹å„ä¸ªå­é›†è®­ç»ƒå­¦ä¹ å™¨ï¼Œä»è€Œå¾—åˆ°å·®å¼‚è¾ƒå¤§çš„å­¦ä¹ å™¨ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜å¸Œæœ›ä¸ªä½“å­¦ä¹ å™¨ä¸èƒ½å¤ªå·®ï¼Œå¦‚æœå­é›†éƒ½å®Œå…¨ä¸åŒï¼Œï¼Œæ¯ä¸ªå­¦ä¹ å™¨åªå­¦ä¹ åˆ°ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Œæ— æ³•ç¡®ä¿äº§ç”Ÿæ¯”è¾ƒå¥½çš„å­¦ä¹ å™¨ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ç›¸äº’é‡å çš„é‡‡ç”¨å­é›†ï¼ˆ&lt;strong&gt;æœ‰æ”¾å›é‡‡æ ·&lt;/strong&gt;ï¼‰ã€‚è‡ªä¸»é‡‡æ ·æ³•ï¼šç»™å®šåŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†ï¼Œå…ˆéšæœºå–å‡ºä¸€ä¸ªæ”¾å…¥é‡‡æ ·é›†ï¼Œå†æ”¾å›åˆå§‹è®­ç»ƒé›†ï¼Œä½¿å¾—ä¸‹æ¬¡é‡‡æ ·ä»ç„¶å¯èƒ½è¢«é€‰ä¸­ï¼Œè¿™æ ·ï¼Œç»è¿‡mæ¬¡éšæœºé‡‡æ ·ï¼Œå¯ä»¥å¾—åˆ°å«mä¸ªæ ·æœ¬çš„é‡‡æ ·é›†ï¼Œåˆå§‹è®­ç»ƒé›†ä¸­æœ‰æ ·æœ¬åœ¨é‡‡æ ·é›†é‡Œå¤šæ¬¡å‡ºç°ï¼Œæœ‰çš„åˆ™ä»æœªå‡ºç°ã€‚å…³äºæ¯”ä¾‹å¾ˆå¥½æ±‚ï¼Œæ±‚æé™ï¼Œ63.2%å‡ºç°åœ¨é‡‡æ ·é›†ä¸­ã€‚é¢„æµ‹è¾“å‡ºæ—¶ï¼Œå¯¹äºåˆ†ç±»ä»»åŠ¡ä½¿ç”¨ç®€å•æŠ•ç¥¨æ³•ï¼Œå›å½’ä»»åŠ¡ä½¿ç”¨ç®€å•å¹³å‡æ³•ã€‚&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1453066/201809/1453066-20180919180638156-1666982913.png&quot;/&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é›†æˆçš„ç»„åˆç­–ç•¥&lt;/strong&gt;ã€‚
&lt;ul&gt;&lt;li&gt;å¹³å‡æ³•ã€‚å¯¹äºå›å½’é—®é¢˜ä¸€èˆ¬ä½¿ç”¨å¹³å‡æ³•ï¼Œåˆ†ä¸ºç®—æœ¯å¹³å‡ä¸åŠ æƒå¹³å‡ç­‰ã€‚&lt;span class=&quot;math display&quot;&gt;\[\begin{array}{l} G(x) = \frac{1}{T}\sum\limits_{i = 1}^T {{G_i}} (x)\\ G(x) = \sum\limits_{i = 1}^T {{\alpha _i}{G_i}} (x),{\alpha _i} \ge 0\;\;\;\;\sum\limits_{i = 1}^T {{\alpha _i} = 1} \end{array}\]&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æŠ•ç¥¨æ³•ã€‚å¯¹äºåˆ†ç±»é—®é¢˜ä¸€èˆ¬ä½¿ç”¨æŠ•ç¥¨æ³•ã€‚ç›¸å¯¹å¤šæ•°æŠ•ç¥¨æ³•ï¼Œå–å­¦ä¹ å™¨åˆ†ç±»ç»“æœä¸­æ•°ç›®æœ€å¤šçš„ç±»ä¸ºæœ€ç»ˆç±»åˆ«ã€‚ç»å¯¹å¤šæ•°æŠ•ç¥¨æ³•ï¼Œç¥¨æ•°æœ€å¤šï¼Œä¸”å¿…é¡»å¤§äºåŠæ•°ã€‚åŠ æƒæŠ•ç¥¨æ³•ã€‚&lt;/li&gt;
&lt;li&gt;å­¦ä¹ æ³•ã€‚å³é€šè¿‡ä¸€ä¸ªå­¦ä¹ å™¨æ¥è¿›è¡Œç»„åˆã€‚Stackingä¸ºå…¸å‹ä»£è¡¨ã€‚å®é™…ä¸Šä¸Šé¢ä¸¤ç§æ–¹æ³•å¯ä»¥çœ‹åšå…¶ä¸­çš„ç‰¹ä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;åå·®æ–¹å·®ä¸æ³›åŒ–è¯¯å·®&quot;&gt;åå·®ã€æ–¹å·®ä¸æ³›åŒ–è¯¯å·®&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;â€œåå·®-æ–¹å·®åˆ†è§£â€æ˜¯è§£é‡Šå­¦ä¹ ç®—æ³•æ³›åŒ–æ€§èƒ½çš„ä¸€ç§é‡è¦å·¥å…·ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç®—æ³•åœ¨ä¸åŒè®­ç»ƒé›†ä¸Šå­¦å¾—çš„ç»“æœå¯èƒ½ä¸åŒï¼Œå³ä¾¿è¿™äº›è®­ç»ƒé›†æ¥è‡ªåŒä¸€åˆ†å¸ƒã€‚&lt;/li&gt;
&lt;li&gt;å¯¹æµ‹è¯•æ ·æœ¬&lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt;ï¼Œä»¤&lt;span class=&quot;math inline&quot;&gt;\(y_D\)&lt;/span&gt;ä¸ºå…¶åœ¨æ•°æ®é›†Dä¸Šçš„æ ‡è®°ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(y\)&lt;/span&gt;ä¸ºå…¶çœŸå®æ ‡è®°ï¼ˆå› ä¸ºç”±äºå™ªå£°å­˜åœ¨ï¼Œä¼šå‡ºç°ä¸¤è€…ä¸ç­‰æƒ…å†µï¼‰ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(f(x;D)\)&lt;/span&gt;ä¸ºåœ¨è®­ç»ƒé›†Dä¸Šå­¦å¾—å¾—æ¨¡å‹&lt;span class=&quot;math inline&quot;&gt;\(f\)&lt;/span&gt;åœ¨&lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt;ä¸Šçš„é¢„æµ‹è¾“å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ç”±ä¸Šæœ‰å­¦ä¹ ç®—æ³•çš„æœŸæœ›é¢„æµ‹&lt;span class=&quot;math display&quot;&gt;\[\bar f(x) = {{\rm E}_D}[f(x;D)]\]&lt;/span&gt;ä½¿ç”¨æ ·æœ¬æ•°ç›¸åŒçš„è®­ç»ƒé›†äº§ç”Ÿçš„æ–¹å·®ä¸º&lt;span class=&quot;math display&quot;&gt;\[{\mathop{\rm var}} ( \cdot ) = {{\rm E}_D}[{(f(x;D) - \bar f(x))^2}]\]&lt;/span&gt;å™ªå£°æ»¡è¶³&lt;span class=&quot;math display&quot;&gt;\[{\varepsilon ^2} = {{\rm E}_D}[{(\bar f(x) - {y_D})^2}]\]&lt;/span&gt;æœŸæœ›è¾“å‡ºä¸çœŸå®æ ‡è®°çš„å·®åˆ«ç§°ä¸ºåå·®,æ»¡è¶³&lt;span class=&quot;math display&quot;&gt;\[bia{s^2}( \cdot ) = {(\bar f(x) - y)^2}\]&lt;/span&gt;ä¸ºä¾¿äºè®¨è®ºï¼Œå‡å®šå™ªå£°æœŸæœ›ä¸º0ï¼Œé€šè¿‡ç®€å•å¤šé¡¹å¼è®¡ç®—ï¼Œå¯å¯¹ç®—æ³•çš„æœŸæœ›æ³›åè¯¯å·®è¿›è¡Œåˆ†è§£,æœ€åå¾—åˆ°&lt;span class=&quot;math display&quot;&gt;\[{\rm E}(f;D) = bia{s^2} + {\mathop{\rm var}} + {\varepsilon ^2}\]&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;å›é¡¾ä¸‰è€…å«ä¹‰ã€‚&lt;strong&gt;åå·®åº¦é‡å­¦ä¹ ç®—æ³•çš„æœŸæœ›é¢„æµ‹ä¸çœŸå®ç»“æœçš„åç¦»ç¨‹åº¦ï¼Œå³åˆ»ç”»äº†ç®—æ³•æœ¬èº«çš„æ‹Ÿåˆç¨‹åº¦ã€‚æ–¹å·®åº¦é‡äº†åŒæ ·å¤§å°çš„è®­ç»ƒé›†çš„å˜åŠ¨å¯¼è‡´çš„é¢„æµ‹åç¦»æœŸæœ›é¢„æµ‹çš„èƒ½åŠ›ï¼ˆå•çº¯ä»è®­ç»ƒé›†æ¥è¯´ï¼Œå¥½çš„ç®—æ³•åº”è¯¥æ˜¯å˜åŠ¨è¾ƒå°çš„ï¼‰ï¼Œåˆ»ç”»äº†æ•°æ®æ‰°åŠ¨é€ æˆçš„å½±å“ã€‚å™ªå£°åˆ™è¡¨è¾¾äº†åœ¨å½“å‰ä»»åŠ¡ä¸Šä»»ä½•å­¦ä¹ ç®—æ³•æ‰€èƒ½è¾¾åˆ°çš„æœŸæœ›æ³›åŒ–è¯¯å·®çš„ä¸‹ç•Œï¼Œå³åˆ»ç”»äº†å­¦ä¹ é—®é¢˜æœ¬èº«çš„éš¾åº¦ã€‚åå·®-æ–¹å·®åˆ†è§£è¯´æ˜ï¼Œæ³›åŒ–æ€§èƒ½ç”±å­¦ä¹ ç®—æ³•çš„èƒ½åŠ›ï¼Œæ•°æ®çš„å……åˆ†æ€§ä»¥åŠä»»åŠ¡æœ¬èº«çš„éš¾åº¦å…±åŒå†³å®šã€‚ç»™å®šä»»åŠ¡ï¼Œä¸ºå–å¾—è¾ƒå¥½çš„æ³›åŒ–æ€§èƒ½ï¼Œåˆ™éœ€åå·®è¾ƒå°ï¼Œå³èƒ½å……åˆ†æ‹Ÿåˆæ•°æ®ï¼Œå¹¶ä½¿æ–¹å·®è¾ƒå°ï¼Œå³ä½¿å¾—æ•°æ®æ‰°åŠ¨äº§ç”Ÿçš„è¯¯å·®è¾ƒå°ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ä¸€èˆ¬æ¥è¯´ï¼Œä¸¤è€…æ˜¯æœ‰å†²çªçš„ï¼Œç§°ä¸ºâ€œåå·®-æ–¹å·®çª˜å¢ƒâ€&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1453066/201809/1453066-20180919203153468-1219575055.png&quot;/&gt;&lt;/li&gt;
&lt;li&gt;åå·®-æ–¹å·®åˆ†è§£ï¼Œè¿™ç§ç®€å•ä¼˜ç¾å½¢å¼ç”±[Geman et al., 1992]ç»™å‡ºï¼Œä»…åœ¨åŸºäºå‡æ–¹è¯¯å·®çš„å›å½’ä»»åŠ¡ä¸­æ¨å¯¼å‡ºï¼Œç¡®å®å¯ä»¥åæ˜ å„ç§å­¦ä¹ ä»»åŠ¡ä¸­çš„è¯¯å·®å†³å®šå› ç´ ã€‚å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œç”±äº0/1æŸå¤±å‡½æ•°è·³å˜æ€§ï¼Œç†è®ºä¸Šæ¨å¯¼å‡ºåå·®-æ–¹å·®åˆ†è§£å¾ˆéš¾ã€‚ä½†æ˜¯å·²ç»æœ‰å¤šç§å…¶ä»–æ–¹æ³•å¯¹åå·®æ–¹å·®ä¼°è®¡ã€‚&lt;/li&gt;
&lt;li&gt;ä»åå·®-æ–¹å·®åˆ†è§£è§’åº¦çœ‹ï¼ŒBoostingä¸»è¦å…³æ³¨é™ä½åå·®ï¼ŒBaggingä¸»è¦å…³æ³¨é™ä½æ–¹å·®ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;h3 id=&quot;å…³äºé›†æˆå­¦ä¹ çš„é”™è¯¯ç‡åˆ†æä»¥åŠç ”ç©¶æ ¸å¿ƒ&quot;&gt;å…³äºé›†æˆå­¦ä¹ çš„é”™è¯¯ç‡åˆ†æä»¥åŠç ”ç©¶æ ¸å¿ƒ&lt;/h3&gt;
&lt;p&gt;ä¸ºä¾¿äºåˆ†æï¼Œæˆ‘ä»¬è€ƒè™‘äºŒåˆ†ç±»é—®é¢˜,æ­£ä¾‹ä¸º+1ï¼Œè´Ÿä¾‹ä¸º-1ï¼ŒçœŸå®å‡½æ•°ä¸º&lt;span class=&quot;math inline&quot;&gt;\(f\)&lt;/span&gt;ï¼Œå‡å®šåŸºåˆ†ç±»å™¨é”™è¯¯ç‡ä¸º&lt;span class=&quot;math inline&quot;&gt;\(e\)&lt;/span&gt;ï¼Œå³å¯¹æ¯ä¸ªåˆ†ç±»å™¨&lt;span class=&quot;math inline&quot;&gt;\(G_i\)&lt;/span&gt;ï¼Œæœ‰&lt;span class=&quot;math display&quot;&gt;\[P({G_i}(x) \ne f(x)) = e\]&lt;/span&gt;å‡è®¾é›†æˆé€šè¿‡ç›¸å¯¹å¤šæ•°æŠ•ç¥¨æ³•ç»“åˆTä¸ªåˆ†ç±»å™¨ï¼Œå› ä¸ºäºŒåˆ†ç±»ï¼Œé‚£ä¹ˆè¶…è¿‡åŠæ•°å­¦ä¹ å™¨åˆ†ç±»æ­£ç¡®ï¼Œé›†æˆåˆ†ç±»å™¨å°±æ­£ç¡®ï¼Œåˆ™é›†æˆåˆ†ç±»å™¨&lt;span class=&quot;math display&quot;&gt;\[G(x) = sign(\sum\limits_{i = 1}^T {{G_i}} (x))\]&lt;/span&gt;å‡è®¾ä¸ªä½“å­¦ä¹ å™¨é”™è¯¯ç‡ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç”±Hoeffdingä¸ç­‰å¼ï¼Œ&lt;span class=&quot;math display&quot;&gt;\[P(G(x) \ne f(x)) = \sum\limits_{i = 1}^{T/2} {\left( {\begin{array}{*{20}{c}} T\\ k \end{array}} \right)} {(1 - e)^k}{e^{T - k}} \le \exp ( - \frac{1}{2}T{(1 - 2e)^2})\]&lt;/span&gt;ä¸Šå¼è¡¨æ˜ï¼Œéšç€ä¸ªä½“å­¦ä¹ å™¨æ•°ç›®å¢å¤§ï¼Œé›†æˆé”™è¯¯ç‡å°†æŒ‡æ•°çº§ä¸‹é™ï¼Œæœ€ç»ˆè¶‹äºé›¶ã€‚&lt;br/&gt;å¦å¤–ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä¸Šé¢çš„å…³é”®å‡è®¾ï¼šå­¦ä¹ å™¨ç›¸äº’ç‹¬ç«‹ã€‚å®é™…ä¸Šä»–ä»¬ä¸ºè§£å†³åŒä¸€é—®é¢˜è®­ç»ƒå‡ºæ¥çš„ï¼Œæ˜¾ç„¶ä¸å¯èƒ½ç›¸äº’ç‹¬ç«‹ã€‚äº‹å®ä¸Šï¼Œä¸ªä½“å­¦ä¹ å™¨çš„å‡†ç¡®æ€§ä¸å¤šæ ·æ€§æœ¬èº«å°±å­˜åœ¨å†²çªï¼Œå¦‚ä½•äº§ç”Ÿå¹¶ç»„åˆâ€œå¥½è€Œä¸åŒâ€çš„å­¦ä¹ å™¨ï¼Œæ°æ°æ˜¯é›†æˆå­¦ä¹ çš„ç ”ç©¶æ ¸å¿ƒã€‚&lt;/p&gt;
</description>
<pubDate>Wed, 19 Sep 2018 13:28:00 +0000</pubDate>
<dc:creator>æµå½±å¿ƒ</dc:creator>
<og:description>é›†æˆå­¦ä¹ ï¼ˆensemble learningï¼‰ é›†æˆå­¦ä¹ é€šè¿‡æ„å»ºå¤šä¸ªä¸ªä½“å­¦ä¹ å™¨ï¼Œç„¶åå†ç”¨æŸç§ç­–ç•¥å°†ä»–ä»¬ç»“åˆèµ·æ¥ï¼Œäº§ç”Ÿä¸€ä¸ªæœ‰è¾ƒå¥½æ•ˆæœçš„å¼ºå­¦ä¹ å™¨æ¥å®Œæˆä»»åŠ¡ã€‚åŸºæœ¬åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™é‡Œä¸»è¦æœ‰ä¸‰ä¸ªå…³é”®ç‚¹ï¼šä¸ªä½“å­¦</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/lyxML/p/9670627.html</dc:identifier>
</item>
<item>
<title>æ­å»ºSpringBoot+dubbo+zookeeper+mavenæ¡†æ¶ï¼ˆå››ï¼‰ - ç‹è€…ä¹‹å·…</title>
<link>http://www.cnblogs.com/gaopengfirst/p/9677604.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/gaopengfirst/p/9677604.html</guid>
<description>&lt;p&gt;Â ä»Šå¤©æˆ‘ä»¬å®Œæˆæ¡†æ¶çš„thymeleafæ¨¡æ¿æ˜¾ç¤ºé¡µé¢åŠŸèƒ½ï¼Œé¡µé¢çš„ç”¨æˆ·ç™»é™†ï¼Œå¯†ç çš„AESåŠ å¯†è§£å¯†ï¼Œè¾“é”™3æ¬¡è¿›è¡ŒéªŒè¯ç éªŒè¯åŠŸèƒ½ï¼Œä¸œè¥¿å¯èƒ½æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªæ˜¯æˆ‘è¿™ä¸¤å¤©åœ¨ç½‘ä¸Šç»“åˆå„ç§èµ„æºæ•´åˆå‡ºæ¥çš„ï¼ŒåŸºæœ¬åŠŸèƒ½éƒ½å·²ç»å®ç°ï¼Œé¡¹ç›®ä»£ç æˆ‘ä¼šé™„åœ¨æ–‡ç« çš„æœ€åé¢ã€‚&lt;/p&gt;&lt;p&gt;ç®€å•è¯´ï¼Œ Thymeleaf æ˜¯ä¸€ä¸ªè·Ÿ Velocityã€FreeMarker ç±»ä¼¼çš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒå¯ä»¥å®Œå…¨æ›¿ä»£ JSP ã€‚ç›¸è¾ƒä¸å…¶ä»–çš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒæœ‰å¦‚ä¸‹ä¸‰ä¸ªæå¸å¼•äººçš„ç‰¹ç‚¹ï¼š&lt;/p&gt;&lt;p&gt;aã€Thymeleaf åœ¨æœ‰ç½‘ç»œå’Œæ— ç½‘ç»œçš„ç¯å¢ƒä¸‹çš†å¯è¿è¡Œï¼Œå³å®ƒå¯ä»¥è®©ç¾å·¥åœ¨æµè§ˆå™¨æŸ¥çœ‹é¡µé¢çš„é™æ€æ•ˆæœï¼Œä¹Ÿå¯ä»¥è®©ç¨‹åºå‘˜åœ¨æœåŠ¡å™¨æŸ¥çœ‹å¸¦æ•°æ®çš„åŠ¨æ€é¡µé¢æ•ˆæœã€‚è¿™æ˜¯ç”±äºå®ƒæ”¯æŒ html åŸå‹ï¼Œç„¶ååœ¨ html æ ‡ç­¾é‡Œå¢åŠ é¢å¤–çš„å±æ€§æ¥è¾¾åˆ°æ¨¡æ¿+æ•°æ®çš„å±•ç¤ºæ–¹å¼ã€‚æµè§ˆå™¨è§£é‡Š html æ—¶ä¼šå¿½ç•¥æœªå®šä¹‰çš„æ ‡ç­¾å±æ€§ï¼Œæ‰€ä»¥ thymeleaf çš„æ¨¡æ¿å¯ä»¥é™æ€åœ°è¿è¡Œï¼›å½“æœ‰æ•°æ®è¿”å›åˆ°é¡µé¢æ—¶ï¼ŒThymeleaf æ ‡ç­¾ä¼šåŠ¨æ€åœ°æ›¿æ¢æ‰é™æ€å†…å®¹ï¼Œä½¿é¡µé¢åŠ¨æ€æ˜¾ç¤ºã€‚&lt;/p&gt;&lt;p&gt;bã€Thymeleaf å¼€ç®±å³ç”¨çš„ç‰¹æ€§ã€‚å®ƒæä¾›æ ‡å‡†å’Œspringæ ‡å‡†ä¸¤ç§æ–¹è¨€ï¼Œå¯ä»¥ç›´æ¥å¥—ç”¨æ¨¡æ¿å®ç°JSTLã€ OGNLè¡¨è¾¾å¼æ•ˆæœï¼Œé¿å…æ¯å¤©å¥—æ¨¡æ¿ã€è¯¥jstlã€æ”¹æ ‡ç­¾çš„å›°æ‰°ã€‚åŒæ—¶å¼€å‘äººå‘˜ä¹Ÿå¯ä»¥æ‰©å±•å’Œåˆ›å»ºè‡ªå®šä¹‰çš„æ–¹è¨€ã€‚&lt;/p&gt;&lt;p&gt;cã€Thymeleaf æä¾›springæ ‡å‡†æ–¹è¨€å’Œä¸€ä¸ªä¸ SpringMVC å®Œç¾é›†æˆçš„å¯é€‰æ¨¡å—ï¼Œå¯ä»¥å¿«é€Ÿçš„å®ç°è¡¨å•ç»‘å®šã€å±æ€§ç¼–è¾‘å™¨ã€å›½é™…åŒ–ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;&lt;div readability=&quot;168&quot;&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.thymeleaf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;thymeleaf&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;&lt;span&gt;3.0&lt;/span&gt;.&lt;span&gt;9&lt;/span&gt;.RELEASE&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.thymeleaf&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;thymeleaf-spring4&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;&lt;span&gt;3.0&lt;/span&gt;.&lt;span&gt;9&lt;/span&gt;.RELEASE&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;spring-boot-starter-thymeleaf&amp;lt;/artifactId&amp;gt;
        &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨customeræ¨¡å—çš„resourcesä¸‹åˆ›å»ºstaticã€templatesæ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919181009516-958274237.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;åœ¨staticä¸‹æ”¾ç½®ä¸€äº›é¡µé¢æ ·å¼çš„jså’Œcssï¼Œåœ¨templatesæ–‡ä»¶å¤¹ä¸‹æ”¾ç½®htmlé¡µé¢ï¼Œæ­¤æ—¶åœ¨resourcesä¸‹çš„application.propertiesé…ç½®æ–‡ä»¶ä¸­é…ç½®thymeleafï¼Œ&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;#thymeleaæ¨¡æ¿é…ç½®
spring.thymeleaf.prefix&lt;/span&gt;=classpath:/templates/&lt;span&gt;
spring.thymeleaf.suffix&lt;/span&gt;=&lt;span&gt;.html
spring.thymeleaf.mode&lt;/span&gt;=&lt;span&gt;HTML5
spring.thymeleaf.encoding&lt;/span&gt;=UTF-&lt;span&gt;8&lt;/span&gt;&lt;span&gt;
#çƒ­éƒ¨ç½²æ–‡ä»¶ï¼Œé¡µé¢ä¸äº§ç”Ÿç¼“å­˜ï¼ŒåŠæ—¶æ›´æ–°
spring.thymeleaf.cache&lt;/span&gt;=&lt;span&gt;false&lt;/span&gt;&lt;span&gt;
spring.resources.chain.strategy.content.enabled&lt;/span&gt;=&lt;span&gt;true&lt;/span&gt;&lt;span&gt;
spring.resources.chain.strategy.content.paths&lt;/span&gt;=&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æ­¤æ—¶thymeleafæ¨¡æ¿å°±é…ç½®å®Œæˆäº†ã€‚&lt;/p&gt;

&lt;p&gt;2.é¡µé¢çš„ç”¨æˆ·ç™»é™†ï¼ŒAESåŠ å¯†è§£å¯†ï¼š&lt;/p&gt;
&lt;p&gt;å…³äºAESçš„åŠ å¯†è§£å¯†ï¼Œæˆ‘çš„å®ç°æ€è·¯æ˜¯ï¼šé¦–å…ˆç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œæ­¤æ—¶åœ¨é¡µé¢ä¸­å·²ç»ä¿å­˜äº†ä»åå°ä¼ è¿‡æ¥çš„keyï¼Œè¯¥keyå€¼æ˜¯åå°éšæœºç”Ÿæˆçš„ï¼Œåå°sessionä¸­ä¿å­˜keyå€¼ï¼Œå‰å°é¡µé¢çš„éšè—æ¡†ä¸­ä¹Ÿè¦ä¿å­˜keyå€¼ï¼Œç”¨äºå‰ç«¯é¡µé¢çš„å¯†ç åŠ å¯†ä»¥åŠåç«¯çš„å¯†ç è§£å¯†ï¼Œé¡µé¢åˆ·æ–°æˆ–ç”¨æˆ·åã€å¯†ç è¾“å…¥é”™è¯¯æ—¶ï¼Œéƒ½ä¼šé‡æ–°ç”Ÿæˆæ–°çš„keyå€¼æ¥æ›¿æ¢åŸæœ‰ä¿å­˜çš„keyã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨pom.xmlä¸­æ·»åŠ ä¾èµ–ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;fastjson&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;&lt;span&gt;1.2&lt;/span&gt;.&lt;span&gt;28&lt;/span&gt;&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;

        &amp;lt;!-- https:&lt;span&gt;//&lt;/span&gt;&lt;span&gt;mvnrepository.com/artifact/commons-codec/commons-codec --&amp;gt;&lt;/span&gt;
        &amp;lt;dependency&amp;gt;
            &amp;lt;groupId&amp;gt;commons-codec&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;commons-codec&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;&lt;span&gt;1.10&lt;/span&gt;&amp;lt;/version&amp;gt;
        &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç”¨AESåŠ å¯†è§£å¯†&lt;/p&gt;
&lt;pre&gt;
&lt;span&gt;a.å‰ç«¯åŠ å¯†ç”¨åˆ°çš„jsæœ‰ï¼šaes.jså’Œmode-ecb-min.jsï¼Œå°±ä¸ºäº†ä¸‹è½½è¿™ä¸¤ä¸ªjsèŠ±äº†æˆ‘30ä¸ªç§¯åˆ†å‘¢ï¼Œ[/å“­]ï¼Œå¯ä»¥åœ¨staticæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªaesæ–‡ä»¶å¤¹ï¼Œç”¨äºæ”¾ç½®è¿™ä¸¤ä¸ªjs&lt;/span&gt;&lt;br/&gt;&lt;span&gt;åœ¨templatesä¸‹åˆ›å»ºlogin.htmlï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;
&lt;/pre&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;42&quot;&gt;
&lt;pre&gt;
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;!--&amp;lt;html xmlns:th=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://www.thymeleaf.org&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;--&amp;gt;
&amp;lt;html xmlns=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://www.w3.org/1999/xhtml&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; xmlns:th=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://www.thymeleaf.org&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
      xmlns:sec&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;http://www.thymeleaf.org/thymeleaf-extras-springsecurity3&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;

&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;UTF-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;title&amp;gt;welcome&amp;lt;/title&amp;gt;
    &amp;lt;script type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text/javascript&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;../jquery/jquery-1.11.1.min.js&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text/javascript&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;../jquery/jquery.easyui.min.js&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text/javascript&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;../aes/aes.js&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;script type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text/javascript&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;../aes/mode-ecb-min.js&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;
    &amp;lt;!--&amp;lt;script th:src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;@{jquery/jquery-1.11.1.min.js}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;
    &amp;lt;!--&amp;lt;script th:src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;@{jquery/jquery-1.11.1.min.js}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;
    &amp;lt;!--&amp;lt;script th:src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;@{jquery/jquery-1.11.1.min.js}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;
    &amp;lt;!--&amp;lt;script th:src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;@{jquery/jquery-1.11.1.min.js}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;input type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;KEY&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; th:value=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;${model.loginToken}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;form action=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;signIn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; method=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;post&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;loginForm&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;form-group has-feedback&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;input type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;form-control&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; placeholder=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Email&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; name=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;username&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
               onkeydown&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;javascript:if(event.keyCode==13) $('#password').focus();&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;span &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;glyphicon glyphicon-envelope form-control-feedback&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;form-group has-feedback&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;input type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;password&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;form-control&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;password&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;
               onkeydown&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;javascript:if(event.keyCode==13) login();&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &amp;gt;
        &amp;lt;span &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;glyphicon glyphicon-lock form-control-feedback&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;&lt;span&gt;
    [[${session.SESSION_LOGIN_FAILURE_COUNT}]]
    &lt;/span&gt;&amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;form-group has-feedback&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; th:&lt;span&gt;if&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;${session.SESSION_LOGIN_FAILURE_COUNT}&amp;lt;=0&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;input name=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checkCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; onkeydown=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;javascript:if(event.keyCode==13)  login();&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;text&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checkCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; maxlength=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; style=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;width:120px;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;img src=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;getValidateCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;CreateCheckCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; align=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;middle&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; title=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç‚¹å‡»åˆ·æ–°éªŒè¯ç &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; onclick=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;getCode()&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;  style=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;cursor: pointer;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;span id=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checkCodeSpan&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; style=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;color: red;&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/span&amp;gt;
    &amp;lt;/div&amp;gt;
&amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;row&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;col-xs-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checkbox icheck&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;label&amp;gt;
                &amp;lt;input type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checkbox&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; name=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;remember&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;checked&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;checked&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;  &amp;gt;&lt;span&gt;è®°ä½å¯†ç 
            &lt;/span&gt;&amp;lt;/label&amp;gt;
        &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;!-- /.col --&amp;gt;
    &amp;lt;div &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;col-xs-4&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;button type=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;button&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; onclick=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;login()&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;  &lt;span&gt;class&lt;/span&gt;=&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;btn btn-primary btn-block btn-flat&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&amp;gt;ç™»å½•&amp;lt;/button&amp;gt;
    &amp;lt;/div&amp;gt;
    &amp;lt;!-- /.col --&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;script&amp;gt;&lt;span&gt;
    function login(){
        $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;).form(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;submit&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;,{
            onSubmit: function(param){
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; username = $(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm input[name=username]&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).val();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;($.trim(username)==&lt;span&gt;''&lt;/span&gt;&lt;span&gt;){
                    alert(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;è´¦å·ä¸èƒ½ä¸ºç©ºï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
                    $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm input[name=username]&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).focus();
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
                }
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; p = $(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm #password&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).val();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;($.trim(p)==&lt;span&gt;''&lt;/span&gt;&lt;span&gt;){
                    alert(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;å¯†ç ä¸èƒ½ä¸ºç©ºï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
                    $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm #password&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).focus();
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
                }
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; checkCodeInput = $(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm #checkCode&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(checkCodeInput.length&amp;gt;&lt;span&gt;0&lt;/span&gt;){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨&lt;/span&gt;
                    &lt;span&gt;var&lt;/span&gt; checkCode =&lt;span&gt; checkCodeInput.val();
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;($.trim(checkCode)==&lt;span&gt;''&lt;/span&gt; || checkCode.length!=&lt;span&gt;4&lt;/span&gt;&lt;span&gt; ){
                        alert(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;è¯·è¾“å…¥4ä½éªŒè¯ç ï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)
                        checkCodeInput.&lt;/span&gt;&lt;span&gt;select&lt;/span&gt;&lt;span&gt;();
                        checkCodeInput.focus();
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
                    }
                }
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; key = $(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#KEY&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).val();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; alert(&quot;keyçš„å€¼æ˜¯ï¼š  &quot;+key);&lt;/span&gt;
                key =&lt;span&gt; CryptoJS.enc.Utf8.parse(key);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; alert(&quot;åŠ å¯†åkeyçš„å€¼æ˜¯ï¼š  &quot;+key);&lt;/span&gt;
                p =&lt;span&gt; CryptoJS.enc.Utf8.parse($.trim(p));
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; encrypted =&lt;span&gt; CryptoJS.AES.encrypt(p, key, {mode:CryptoJS.mode.ECB,padding: CryptoJS.pad.Pkcs7});
                param.password &lt;/span&gt;=&lt;span&gt; encrypted.toString();
            },
            success:function(data){
                &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; data = eval(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt; + data + &lt;span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (data.success){
                    window.location.href &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;index&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
                }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;{
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(data.msg==&lt;span&gt;'&lt;/span&gt;&lt;span&gt;timeout&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¯èƒ½å·²ç»å°±ç™»å½•äº†ï¼Œæ— éœ€å†æ¬¡ç™»å½•&lt;/span&gt;
                        alert(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;ç™»å½•è¶…æ—¶æˆ–å·²ç»ç™»å½•ï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
                        window.location.href &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;${request.contextPath}/&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
                    }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;==data.msg){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éœ€è¦éªŒè¯ç äº†&lt;/span&gt;
                        alert(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
                        window.location.href &lt;/span&gt;= &lt;span&gt;'&lt;/span&gt;&lt;span&gt;login&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;;
                    }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt;(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;codeError&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;==data.msg){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éªŒè¯ç é”™è¯¯&lt;/span&gt;
&lt;span&gt;                        getCode();
                        $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#checkCodeSpan&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;).text(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;éªŒè¯ç é”™è¯¯&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
                        $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm #checkCode&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;).&lt;span&gt;select&lt;/span&gt;&lt;span&gt;();
                        $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#loginForm #checkCode&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).focus();
                    }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;{
                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•å¤±è´¥ï¼Œæ›´æ–°login_token&lt;/span&gt;
                        $(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#KEY&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;).val(data.data);
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;($(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#checkCodeSpan&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;)){
                            $(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;#checkCodeSpan&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;).text(&lt;span&gt;''&lt;/span&gt;&lt;span&gt;);
                        }
                        alert(data.msg);
                    }
                }
            },

        }) ;
    }

    function getCode(){
        &lt;/span&gt;&lt;span&gt;var&lt;/span&gt; img = document.getElementById(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;CreateCheckCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        img.src &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;getValidateCode?nocache=&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; + &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Date().getTime();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; $(&quot;#CreateCheckCode&quot;).attr('src',&quot;getValidateCode?nocache=&quot; + new Date().getTime());&lt;/span&gt;
&lt;span&gt;    }
&lt;/span&gt;&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯åœ¨htmlé¡µé¢ä¸­å¼•å…¥jsçš„æ—¶å€™è·¯å¾„çš„é—®é¢˜ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘åœ¨é¡µé¢ä¸­æ˜¯è¿™æ ·å†™çš„ï¼š&amp;lt;script type=&quot;text/javascript&quot; src=&quot;../jquery/jquery-1.11.1.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;ï¼Œä½†æ˜¯ä½ ä»”ç»†çœ‹åº”è¯¥æ˜¯&amp;lt;script type=&quot;text/javascript&quot; src=&quot;../static/jquery/jquery-1.11.1.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;æ‰å¯¹ï¼Œä¸ºä»€ä¹ˆä¼šå°‘ä¸€ä¸ªstaticå‘¢ï¼Œè¿™æ˜¯å› ä¸ºthymeleafæ¨¡æ¿æœ¬èº«å¼•å…¥jsæ—¶çš„è·¯å¾„å°±æ˜¯é»˜è®¤åœ¨staticä¸‹çš„ï¼Œè¦æ˜¯åŠ ä¸Šstaticåè€Œé¡µé¢ä¼šæŠ¥js404é”™è¯¯ï¼Œä¸ä¿¡å¤§å®¶å¯ä»¥è¯•è¯•çœ‹ã€‚&lt;/p&gt;
&lt;pre&gt;
var key = $('#KEY'&lt;span&gt;).val();
 // alert(&quot;keyçš„å€¼æ˜¯ï¼š  &quot;+key);
key =&lt;span&gt; CryptoJS.enc.Utf8.parse(key);
// alert(&quot;åŠ å¯†åkeyçš„å€¼æ˜¯ï¼š  &quot;+key);
p =&lt;span&gt; CryptoJS.enc.Utf8.parse($.trim(p));
var encrypted =&lt;span&gt; CryptoJS.AES.encrypt(p, key, {mode:CryptoJS.mode.ECB,padding: CryptoJS.pad.Pkcs7});
param.password =&lt;span&gt; encrypted.toString();&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ®µä»£ç å°±æ˜¯é€šè¿‡AESå°†ç”¨æˆ·è¾“å…¥çš„æ˜æ–‡å¯†ç å’Œåå°ä¼ è¿‡æ¥çš„keyåŠ å¯†æˆå¯†æ–‡ï¼Œæ”¾åˆ°inputæ¡†ä¸­æäº¤åˆ°åå°ã€‚&lt;/p&gt;
&lt;p&gt;b.åå°ç”Ÿæˆéšæœºçš„keyå€¼ï¼Œå¹¶å°†å‰å°ä¼ è¿‡æ¥çš„å¯†æ–‡è§£å¯†æˆæ˜æ–‡å¯†ç ï¼Œ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¦åœ¨commonæ¨¡å—ä¸­å†™å‡ ä¸ªå·¥å…·ç±»ï¼šEncryptUtilç”¨äºå¯†ç çš„åŠ å¯†è§£å¯†ï¼ŒHelperç”¨äºè®°å½•ä¸€äº›å¸¸é‡ï¼ŒRandomUtilç”¨äºéšæœºç”Ÿæˆkeyå€¼ï¼ŒResultç”¨äºå‘å‰å°è¿”å›ä¸€ä¸ªç»“æœå¯¹è±¡ï¼Œæ ·å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919202334580-866900058.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å·¥å…·ç±»ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;EncryptUtilï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt;package com.lj.common.util;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.spec.SecretKeySpec;

import org.apache.commons.codec.binary.Base64;

import sun.misc.BASE64Decoder;

import java.security.SecureRandom;

&lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
 * Created with IntelliJ IDEA.
 * User: gaopeng
 * Date: 2018/9/17 0017
 * Time: 17:30
 * Description:
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; EncryptUtil {
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String KEY = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;abcdefgabcdefg12&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String ALGORITHMSTR = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AES/ECB/PKCS5Padding&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String base64Encode(&lt;span&gt;byte&lt;/span&gt;&lt;span&gt;[] bytes){
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; Base64.encodeBase64String(bytes);
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;byte&lt;/span&gt;&lt;span&gt;[] base64Decode(String base64Code) throws Exception{
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; BASE64Decoder().decodeBuffer(base64Code);
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;byte&lt;/span&gt;&lt;span&gt;[] aesEncryptToBytes(String content, String encryptKey) throws Exception {
        KeyGenerator kgen &lt;/span&gt;= KeyGenerator.getInstance(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AES&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        kgen.init(&lt;/span&gt;&lt;span&gt;128&lt;/span&gt;&lt;span&gt;);
        Cipher cipher &lt;/span&gt;=&lt;span&gt; Cipher.getInstance(ALGORITHMSTR);
        cipher.init(Cipher.ENCRYPT_MODE, &lt;/span&gt;&lt;span&gt;new&lt;/span&gt; SecretKeySpec(encryptKey.getBytes(), &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AES&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));

        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; cipher.doFinal(content.getBytes(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;utf-8&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; String aesEncrypt(String content, String encryptKey) throws Exception {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; base64Encode(aesEncryptToBytes(content, encryptKey));
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String aesDecryptByBytes(&lt;span&gt;byte&lt;/span&gt;&lt;span&gt;[] encryptBytes, String decryptKey) throws Exception {
        KeyGenerator kgen &lt;/span&gt;= KeyGenerator.getInstance(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AES&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        SecureRandom secureRandom &lt;/span&gt;= SecureRandom.getInstance(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;SHA1PRNG&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt; );
        secureRandom.setSeed(decryptKey.getBytes());
        kgen.init(&lt;/span&gt;&lt;span&gt;128&lt;/span&gt;&lt;span&gt;,secureRandom);

        Cipher cipher &lt;/span&gt;=&lt;span&gt; Cipher.getInstance(ALGORITHMSTR);
        cipher.init(Cipher.DECRYPT_MODE, &lt;/span&gt;&lt;span&gt;new&lt;/span&gt; SecretKeySpec(decryptKey.getBytes(), &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;AES&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));
        &lt;/span&gt;&lt;span&gt;byte&lt;/span&gt;[] decryptBytes =&lt;span&gt; cipher.doFinal(encryptBytes);

        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; String(decryptBytes);
    }
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; String aesDecrypt(String encryptStr, String decryptKey) throws Exception {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; aesDecryptByBytes(base64Decode(encryptStr), decryptKey);
    }


    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * æµ‹è¯•
     *
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; main(String[] args) throws Exception {

        String content &lt;/span&gt;= &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Test Stringä¹ˆä¹ˆå“’&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;;  &lt;span&gt;//&lt;/span&gt;&lt;span&gt;0gqIDaFNAAmwvv3tKsFOFf9P9m/6MWlmtB8SspgxqpWKYnELb/lXkyXm7P4sMf3e&lt;/span&gt;
        System.&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;åŠ å¯†å‰ï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; content);

        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; KEY);

        String encrypt &lt;/span&gt;=&lt;span&gt; aesEncrypt(content, KEY);
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(encrypt.length()+&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;:åŠ å¯†åï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; encrypt);

        String decrypt &lt;/span&gt;=&lt;span&gt; aesDecrypt(encrypt, KEY);
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;è§£å¯†åï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; decrypt);
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Helper:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;package com.lj.common.util;

&lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
 * Created with IntelliJ IDEA.
 * User: gaopeng
 * Date: 2018/9/17 0017
 * Time: 17:08
 * Description:
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Helper {
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String SESSION_CHECKCODE = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;SESSION_CHECKCODE&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String SESSION_LOGIN_TOKEN = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;SESSION_LOGIN_TOKEN&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String SESSION_USER = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;SESSION_USER&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String SESSION_LOGIN_FAILURE_COUNT = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;SESSION_LOGIN_FAILURE_COUNT&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String logTypeSecurity = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;logTypeSecurity&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final Integer COUNT = &lt;span&gt;3&lt;/span&gt;&lt;span&gt;;
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;RandomUtil:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;package com.lj.common.util;

import java.util.Random;

&lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
 * Created with IntelliJ IDEA.
 * User: gaopeng
 * Date: 2018/9/17 0017
 * Time: 17:22
 * Description:
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RandomUtil {
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String ALLCHAR = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String LETTERCHAR = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;abcdefghijkllmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; final String NUMBERCHAR = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;0123456789&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * è¿”å›ä¸€ä¸ªå®šé•¿çš„éšæœºå­—ç¬¦ä¸²(åªåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—)
     *
     * @param length
     *            éšæœºå­—ç¬¦ä¸²é•¿åº¦
     * @return éšæœºå­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String generateString(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length) {
        StringBuffer sb &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuffer();
        Random random &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Random();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; length; i++&lt;span&gt;) {
            sb.append(ALLCHAR.charAt(random.nextInt(ALLCHAR.length())));
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; sb.toString();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * è¿”å›ä¸€ä¸ªå®šé•¿çš„éšæœºçº¯å­—æ¯å­—ç¬¦ä¸²(åªåŒ…å«å¤§å°å†™å­—æ¯)
     *
     * @param length
     *            éšæœºå­—ç¬¦ä¸²é•¿åº¦
     * @return éšæœºå­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String generateMixString(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length) {
        StringBuffer sb &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuffer();
        Random random &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Random();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; length; i++&lt;span&gt;) {
            sb.append(LETTERCHAR.charAt(random.nextInt(LETTERCHAR.length())));
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; sb.toString();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * è¿”å›ä¸€ä¸ªå®šé•¿çš„éšæœºçº¯å¤§å†™å­—æ¯å­—ç¬¦ä¸²(åªåŒ…å«å¤§å°å†™å­—æ¯)
     *
     * @param length
     *            éšæœºå­—ç¬¦ä¸²é•¿åº¦
     * @return éšæœºå­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String generateLowerString(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length) {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; generateMixString(length).toLowerCase();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * è¿”å›ä¸€ä¸ªå®šé•¿çš„éšæœºçº¯å°å†™å­—æ¯å­—ç¬¦ä¸²(åªåŒ…å«å¤§å°å†™å­—æ¯)
     *
     * @param length
     *            éšæœºå­—ç¬¦ä¸²é•¿åº¦
     * @return éšæœºå­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String generateUpperString(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length) {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; generateMixString(length).toUpperCase();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * ç”Ÿæˆä¸€ä¸ªå®šé•¿çš„çº¯0å­—ç¬¦ä¸²
     *
     * @param length
     *            å­—ç¬¦ä¸²é•¿åº¦
     * @return çº¯0å­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String generateZeroString(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length) {
        StringBuffer sb &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuffer();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; length; i++&lt;span&gt;) {
            sb.append(&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; sb.toString();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * æ ¹æ®æ•°å­—ç”Ÿæˆä¸€ä¸ªå®šé•¿çš„å­—ç¬¦ä¸²ï¼Œé•¿åº¦ä¸å¤Ÿå‰é¢è¡¥0
     *
     * @param num
     *            æ•°å­—
     * @param fixdlenth
     *            å­—ç¬¦ä¸²é•¿åº¦
     * @return å®šé•¿çš„å­—ç¬¦ä¸²
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; String toFixdLengthString(&lt;span&gt;long&lt;/span&gt; num, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; fixdlenth) {
        StringBuffer sb &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuffer();
        String strNum &lt;/span&gt;=&lt;span&gt; String.valueOf(num);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (fixdlenth - strNum.length() &amp;gt;= &lt;span&gt;0&lt;/span&gt;&lt;span&gt;) {
            sb.append(generateZeroString(fixdlenth &lt;/span&gt;-&lt;span&gt; strNum.length()));
        } &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RuntimeException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å°†æ•°å­—&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; + num + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;è½¬åŒ–ä¸ºé•¿åº¦ä¸º&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; fixdlenth
                    &lt;/span&gt;+ &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;çš„å­—ç¬¦ä¸²å‘ç”Ÿå¼‚å¸¸ï¼&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        }
        sb.append(strNum);
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; sb.toString();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     * æ¯æ¬¡ç”Ÿæˆçš„lenä½æ•°éƒ½ä¸ç›¸åŒ
     *
     * @param param
     * @return å®šé•¿çš„æ•°å­—
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; getNotSimple(&lt;span&gt;int&lt;/span&gt;[] param, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; len) {
        Random rand &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Random();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = param.length; i &amp;gt; &lt;span&gt;1&lt;/span&gt;; i--&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; index =&lt;span&gt; rand.nextInt(i);
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; tmp =&lt;span&gt; param[index];
            param[index] &lt;/span&gt;= param[i - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;];
            param[i &lt;/span&gt;- &lt;span&gt;1&lt;/span&gt;] =&lt;span&gt; tmp;
        }
        &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; result = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; len; i++&lt;span&gt;) {
            result &lt;/span&gt;= result * &lt;span&gt;10&lt;/span&gt; +&lt;span&gt; param[i];
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; result;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Result:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;package com.lj.common.util;

import java.util.Date;

&lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
 * Created with IntelliJ IDEA.
 * User: gaopeng
 * Date: 2018/9/17 0017
 * Time: 18:26
 * Description:
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; Result {
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; Boolean success;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String msg;
    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt; String key;

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Boolean getSuccess() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; success;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setSuccess(Boolean success) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.success =&lt;span&gt; success;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getMsg() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; msg;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setMsg(String msg) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.msg =&lt;span&gt; msg;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getKey() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; key;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setKey(String key) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.key =&lt;span&gt; key;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Result(Boolean b, String s){
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.success =&lt;span&gt; b;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.msg =&lt;span&gt; s;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; Result(Boolean b, String s, String k){
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.success =&lt;span&gt; b;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.msg =&lt;span&gt; s;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.key =&lt;span&gt; k;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨customeræ¨¡å—ä¸­çš„controllerä¸­æ‹¦æˆª/loginå’Œ/signInè·¯å¾„çš„ä»£ç å¦‚ä¸‹ï¼š&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;42&quot;&gt;
&lt;pre&gt;
    @GetMapping(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;login&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; ModelAndView login(HttpServletResponse response, HttpServletRequest request, Model model){
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç”Ÿæˆlogin_token&lt;/span&gt;
&lt;span&gt;
        HttpSession session &lt;/span&gt;=&lt;span&gt; request.getSession();
        String key &lt;/span&gt;= RandomUtil.generateString(&lt;span&gt;16&lt;/span&gt;&lt;span&gt;);
        session.setAttribute(Helper.SESSION_LOGIN_TOKEN, key);&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•ä»¤ç‰Œï¼Œç”¨äºå¯†ç åŠ å¯†çš„keyï¼Œ16ä½é•¿åº¦&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;(session.getAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT) == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;){
            session.setAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT, Helper.COUNT);&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•å‰©ä½™å¤±è´¥æ¬¡æ•°&lt;/span&gt;
&lt;span&gt;        }
        model.addAttribute(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;loginToken&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,key);
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ä¼ åˆ°å‰å°çš„keyå€¼ä¸ºï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+&lt;span&gt; key);
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;é¡µé¢è·³è½¬åˆ°login.html&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        return &quot;login&quot;;
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        if(session.getAttribute(Helper.SESSION_USER) == null){&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ModelAndView(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;login&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;model&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,model);
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;        else
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;            return &quot;redirect:/&quot;;&lt;/span&gt;
    }
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;65&quot;&gt;
&lt;pre&gt;
    @PostMapping(value = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;signIn&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
    @ResponseBody
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String signIn(String username,String password,boolean remember,String checkCode,HttpServletRequest request, HttpServletResponse response){
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(username+&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+password+&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+remember+&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+&lt;span&gt;checkCode);
        HttpSession session &lt;/span&gt;=&lt;span&gt; request.getSession();
        Object token &lt;/span&gt;= session.getAttribute(Helper.SESSION_LOGIN_TOKEN);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åŸå§‹ä»¤ç‰Œ&lt;/span&gt;

        &lt;span&gt;if&lt;/span&gt;(token==&lt;span&gt;null&lt;/span&gt;) &lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;timeout&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•æˆåŠŸåtokenå¤±æ•ˆï¼Œåˆ™é¡µé¢å¤±æ•ˆï¼Œå®¢æˆ·ç«¯éœ€è¦é‡å®šå‘åˆ°ä¸»ç•Œé¢&lt;/span&gt;
        Object countObj =&lt;span&gt; session.getAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT);
        &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; count = countObj==&lt;span&gt;null&lt;/span&gt;?&lt;span&gt;3&lt;/span&gt;&lt;span&gt;:Integer.parseInt(countObj.toString());
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å‰©ä½™æ¬¡æ•°ï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+&lt;span&gt;count);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éªŒè¯ç é€»è¾‘&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;(count&amp;lt;=&lt;span&gt;0&lt;/span&gt;){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éœ€è¦éªŒè¯ç &lt;/span&gt;
            Object oldCode =&lt;span&gt; session.getAttribute(Helper.SESSION_CHECKCODE);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(checkCode==&lt;span&gt;null&lt;/span&gt;||oldCode==&lt;span&gt;null&lt;/span&gt;){&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è¯¥ç™»å½•ç•Œé¢æ²¡æœ‰éªŒè¯ç å­—æ®µï¼Œä½†æ˜¯å·²ç»æ¶ˆè€—æ‰äº†å‰©ä½™æ¬¡æ•°ï¼Œè¯´æ˜è¯¥é¡µé¢æ˜¯è¿‡æœŸé¡µé¢ï¼Œéœ€è¦é‡æ–°ç™»å½•&lt;/span&gt;
                System.&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;chaoshila&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;timeout&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®¢æˆ·ç«¯éœ€è¦é‡å®šå‘åˆ°ä¸»ç•Œé¢&lt;/span&gt;
&lt;span&gt;            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(checkCode.trim().isEmpty()) &lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;è¯·è¾“å…¥éªŒè¯ç &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;(oldCode.toString().equalsIgnoreCase(checkCode)){
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éªŒè¯é€šè¿‡ï¼Œå¯ä¿¡å®¢æˆ·ç«¯ï¼Œç»™0æ¬¡å‰©ä½™æ¬¡æ•°&lt;/span&gt;
                count=&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
                session.setAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT,count);
            }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;{
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;codeError&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;éªŒè¯ç ä¸æ­£ç¡®ï¼Œå®¢æˆ·ç«¯éœ€è¦åˆ·æ–°éªŒè¯ç &lt;/span&gt;
&lt;span&gt;            }
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£å¯†&lt;/span&gt;
        &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
            password &lt;/span&gt;= EncryptUtil.aesDecrypt(password,token.toString());&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£å¯†å&lt;/span&gt;
            System.&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Decrypt:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;+&lt;span&gt;password);
        } &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
            e.printStackTrace();
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;timeout&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;));&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®¢æˆ·ç«¯éœ€è¦é‡å®šå‘åˆ°ä¸»ç•Œé¢&lt;/span&gt;
&lt;span&gt;        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•æ ¡éªŒ&lt;/span&gt;
        String loginKey = RandomUtil.generateString(&lt;span&gt;16&lt;/span&gt;);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é‡æ–°ç”Ÿæˆç™»å½•ä»¤ç‰Œ,ä»»ä½•ç™»å½•å¤±è´¥çš„æ“ä½œéƒ½éœ€è¦æ›´æ–°ç™»å½•ä»¤ç‰Œ&lt;/span&gt;
        User user =  &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(user == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;(user == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;){
            session.setAttribute(Helper.SESSION_LOGIN_TOKEN,loginKey);
            session.setAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT,&lt;/span&gt;--count);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å‰©ä½™æ¬¡æ•°-1&lt;/span&gt;
            System.&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;å‰©ä½™æ¬¡æ•°ï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; session.getAttribute(Helper.SESSION_LOGIN_FAILURE_COUNT));
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;if(count&amp;lt;=0) return JSON.toJSONString(new Result(false,&quot;checkCode&quot;,loginKey));&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®¢æˆ·ç«¯éœ€è¦é‡å®šå‘åˆ°ç™»å½•ç•Œé¢å°†éªŒè¯ç æ˜¾ç¤ºå‡ºæ¥&lt;/span&gt;
            System.&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;è¿™é‡Œç›´æ¥è¦è¿”å›äº†ï¼ï¼ï¼&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
            Result result &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,loginKey);
            System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;.println(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;resultå¯¹è±¡çš„å€¼æ˜¯ï¼š&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; result.getKey());
            System.&lt;/span&gt;&lt;span&gt;out&lt;/span&gt;&lt;span&gt;.println(JSON.toJSONString(result));
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;false&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,loginKey));
        }&lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;{
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;            if(user.getUserid()!=ConfigInfo.admin_id &amp;amp;&amp;amp; !user.getuStatus().equals(ConfigInfo.user_status_normal)) {
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;                session.setAttribute(Helper.SESSION_LOGIN_TOKEN,key);
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;                return JSON.toJSONString(new Result(false,&quot;ç™»å½•å¤±è´¥ï¼Œè¯¥è´¦å·å·²è¢«ç¦æ­¢ä½¿ç”¨ï¼&quot;,key));
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç™»å½•æˆåŠŸ&lt;/span&gt;
&lt;span&gt;            session.removeAttribute(Helper.SESSION_LOGIN_TOKEN);
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;            loginUser = user;&lt;/span&gt;
&lt;span&gt;            session.setAttribute(Helper.SESSION_USER,user);
&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;            sysEventService.insertEventLog(Helper.logTypeSecurity,username+&quot; ç™»å½•ç³»ç»Ÿ&quot;);&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt; JSON.toJSONString(&lt;span&gt;new&lt;/span&gt; Result(&lt;span&gt;true&lt;/span&gt;,&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;ç™»å½•æˆåŠŸï¼&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;));
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre readability=&quot;6&quot;&gt;
ä¸Šé¢ç”Ÿæˆkeyä»¥åŠè§£å¯†çš„éƒ¨åˆ†éƒ½æœ‰æ³¨è§£ï¼Œåº”è¯¥èƒ½çœ‹æ‡‚çš„ã€‚&lt;p&gt;c.&lt;span&gt;è¾“é”™3æ¬¡æ˜¾ç¤ºéªŒè¯ç &lt;br/&gt;&lt;/span&gt;è¿™é‡Œè¦å®ç°éªŒè¯ç åŠŸèƒ½ï¼Œé¦–å…ˆè¦åœ¨commonä¸­å†™ä¸€ä¸ªå·¥å…·ç±»ï¼Œç”¨äºç”ŸæˆéªŒè¯ç ï¼Œä»£ç å¦‚ä¸‹ï¼š
&lt;/p&gt;&lt;/pre&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;94&quot;&gt;
&lt;pre&gt;
&lt;span&gt;package com.lj.common.util;

import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.Random;

import javax.imageio.ImageIO;
&lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
 * Created with IntelliJ IDEA.
 * User: gaopeng
 * Date: 2018/9/17 0017
 * Time: 16:57
 * Description:
 &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; ValidateCode {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å›¾ç‰‡çš„å®½åº¦ã€‚&lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; width = &lt;span&gt;160&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å›¾ç‰‡çš„é«˜åº¦ã€‚&lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; height = &lt;span&gt;28&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; éªŒè¯ç å­—ç¬¦ä¸ªæ•°&lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; codeCount = &lt;span&gt;4&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; éªŒè¯ç å¹²æ‰°çº¿æ•°&lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; lineCount = &lt;span&gt;150&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; éªŒè¯ç &lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; String code = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; éªŒè¯ç å›¾ç‰‡Buffer&lt;/span&gt;
    &lt;span&gt;private&lt;/span&gt; BufferedImage buffImg = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;private&lt;/span&gt; &lt;span&gt;char&lt;/span&gt;[] codeSequence = { &lt;span&gt;'&lt;/span&gt;&lt;span&gt;A&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;B&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;C&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;D&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;E&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;F&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;G&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;H&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;I&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;J&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;K&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;L&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;M&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;N&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;P&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;Q&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;R&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;,
            &lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;S&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;T&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;U&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;V&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;W&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;X&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;Y&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;Z&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;3&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;4&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;5&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;6&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;7&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;, &lt;span&gt;'&lt;/span&gt;&lt;span&gt;9&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt; };

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; ValidateCode() {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.createCode();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     *
     * @param width
     *            å›¾ç‰‡å®½
     * @param height
     *            å›¾ç‰‡é«˜
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; ValidateCode(&lt;span&gt;int&lt;/span&gt; width, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; height) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.width =&lt;span&gt; width;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.height =&lt;span&gt; height;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.createCode();
    }

    &lt;/span&gt;&lt;span&gt;/*&lt;/span&gt;&lt;span&gt;*
     *
     * @param width
     *            å›¾ç‰‡å®½
     * @param height
     *            å›¾ç‰‡é«˜
     * @param codeCount
     *            å­—ç¬¦ä¸ªæ•°
     * @param lineCount
     *            å¹²æ‰°çº¿æ¡æ•°
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;public&lt;/span&gt; ValidateCode(&lt;span&gt;int&lt;/span&gt; width, &lt;span&gt;int&lt;/span&gt; height, &lt;span&gt;int&lt;/span&gt; codeCount, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; lineCount) {
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.width =&lt;span&gt; width;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.height =&lt;span&gt; height;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.codeCount =&lt;span&gt; codeCount;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.lineCount =&lt;span&gt; lineCount;
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.createCode();
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; createCode() {
        &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; x = &lt;span&gt;0&lt;/span&gt;, fontHeight = &lt;span&gt;0&lt;/span&gt;, codeY = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; red = &lt;span&gt;0&lt;/span&gt;, green = &lt;span&gt;0&lt;/span&gt;, blue = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;

        x &lt;/span&gt;= width / (codeCount + &lt;span&gt;2&lt;/span&gt;);&lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ¯ä¸ªå­—ç¬¦çš„å®½åº¦&lt;/span&gt;
        fontHeight = height - &lt;span&gt;2&lt;/span&gt;;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å­—ä½“çš„é«˜åº¦&lt;/span&gt;
        codeY = height - &lt;span&gt;4&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å›¾åƒbuffer&lt;/span&gt;
        buffImg = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
        Graphics2D g &lt;/span&gt;=&lt;span&gt; buffImg.createGraphics();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç”Ÿæˆéšæœºæ•°&lt;/span&gt;
        Random random = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Random();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°†å›¾åƒå¡«å……ä¸ºç™½è‰²&lt;/span&gt;
&lt;span&gt;        g.setColor(Color.WHITE);
        g.fillRect(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;&lt;span&gt;, width, height);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆ›å»ºå­—ä½“&lt;/span&gt;
        Font font = &lt;span&gt;new&lt;/span&gt; Font(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Fixedsys&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, Font.BOLD, fontHeight);
        g.setFont(font);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¹²æ‰°çº¿&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; lineCount; i++&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; xs =&lt;span&gt; random.nextInt(width);
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; ys =&lt;span&gt; random.nextInt(height);
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; xe = xs + random.nextInt(width / &lt;span&gt;8&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt; ye = ys + random.nextInt(height / &lt;span&gt;8&lt;/span&gt;&lt;span&gt;);
            red &lt;/span&gt;= random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            green &lt;/span&gt;= random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            blue &lt;/span&gt;= random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            g.setColor(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Color(red, green, blue));
            g.drawLine(xs, ys, xe, ye);
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; randomCodeè®°å½•éšæœºäº§ç”Ÿçš„éªŒè¯ç &lt;/span&gt;
        StringBuffer randomCode = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringBuffer();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; éšæœºäº§ç”ŸcodeCountä¸ªå­—ç¬¦çš„éªŒè¯ç ã€‚&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; codeCount; i++&lt;span&gt;) {
            String strRand &lt;/span&gt;=&lt;span&gt; String.valueOf(codeSequence[random.nextInt(codeSequence.length)]);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; äº§ç”Ÿéšæœºçš„é¢œè‰²å€¼ï¼Œè®©è¾“å‡ºçš„æ¯ä¸ªå­—ç¬¦çš„é¢œè‰²å€¼éƒ½å°†ä¸åŒã€‚&lt;/span&gt;
            red = random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            green &lt;/span&gt;= random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            blue &lt;/span&gt;= random.nextInt(&lt;span&gt;255&lt;/span&gt;&lt;span&gt;);
            g.setColor(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; Color(red, green, blue));
            g.drawString(strRand, (i &lt;/span&gt;+ &lt;span&gt;1&lt;/span&gt;) *&lt;span&gt; x, codeY);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°†äº§ç”Ÿçš„å››ä¸ªéšæœºæ•°ç»„åˆåœ¨ä¸€èµ·ã€‚&lt;/span&gt;
&lt;span&gt;            randomCode.append(strRand);
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°†å››ä½æ•°å­—çš„éªŒè¯ç ä¿å­˜åˆ°Sessionä¸­ã€‚&lt;/span&gt;
        code =&lt;span&gt; randomCode.toString();
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; write(String path) throws IOException {
        OutputStream sos &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; FileOutputStream(path);
        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.write(sos);
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; write(OutputStream sos) throws IOException {
        ImageIO.write(buffImg, &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;png&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, sos);
        sos.close();
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; BufferedImage getBuffImg() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; buffImg;
    }

    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getCode() {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; code;
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;
åœ¨customeræ¨¡å—ä¸­çš„controllerï¼Œç¼–å†™æ‹¦æˆª/getValidateCodeè·¯å¾„çš„è¯·æ±‚ï¼Œç”¨äºç”ŸæˆéªŒè¯ç ï¼Œä»£ç å¦‚ä¸‹ï¼š
&lt;/pre&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;43&quot;&gt;
&lt;pre&gt;
 @GetMapping(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;getValidateCode&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; getValidateCode(HttpServletRequest reqeust, HttpServletResponse response) throws IOException {
        response.setContentType(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;image/jpeg&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç¦æ­¢å›¾åƒç¼“å­˜ã€‚&lt;/span&gt;
        response.setHeader(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Pragma&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;no-cache&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        response.setHeader(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Cache-Control&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;no-cache&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
        response.setDateHeader(&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Expires&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;&lt;span&gt;);

        HttpSession session &lt;/span&gt;=&lt;span&gt; reqeust.getSession();

        ValidateCode vCode &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt; ValidateCode(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;28&lt;/span&gt;, &lt;span&gt;4&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;&lt;span&gt;);
        session.setAttribute(Helper.SESSION_CHECKCODE, vCode.getCode());
        vCode.write(response.getOutputStream());
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;éªŒè¯ç åœ¨3æ¬¡è¾“å…¥é”™è¯¯ç”¨æˆ·åå¯†ç åå¯åŠ¨çš„é€»è¾‘ä»£ç åœ¨ä¸Šé¢éƒ½å·²ç»è´´å‡ºæ¥äº†ï¼Œè¿™ä¸ª3æ¬¡æ˜¯å­˜å‚¨åœ¨sessionä¸­çš„ï¼Œå‰å°é¡µé¢è¦é€šè¿‡è·å–sessionä¸­çš„â€œå¯è¾“å…¥é”™è¯¯å‰©ä½™æ¬¡æ•°SESSION_LOGIN_FAILURE_COUNTâ€æ¥åˆ¤æ–­&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼Œé¡µé¢çš„ç”¨æˆ·ç™»é™†ï¼Œå¯†ç çš„AESåŠ å¯†è§£å¯†ï¼Œè¾“é”™3æ¬¡è¿›è¡ŒéªŒè¯ç éªŒè¯åŠŸèƒ½ã€‚æ¼”ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919205508529-1454803281.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ¬¡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919205637091-152215797.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ¬¡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919205708035-545752487.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ¬¡ä»¥åçš„é¡µé¢å°±æœ‰éªŒè¯ç äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1203840/201809/1203840-20180919205747421-1913339989.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯è¯¥é¡¹ç›®çš„æºç ä¸‹è½½åœ°å€ï¼šhttps://download.csdn.net/download/weixin_38340967/10677372&lt;/p&gt;
&lt;p&gt;æ–‡ç« å‚è€ƒæ–‡çŒ®ï¼šhttps://www.cnblogs.com/nicknailo/p/8947643.html&lt;/p&gt;
&lt;p&gt;http://itfish.net/article/64414.html&lt;/p&gt;





&lt;pre&gt;
&lt;/pre&gt;&lt;/div&gt;</description>
<pubDate>Wed, 19 Sep 2018 13:04:00 +0000</pubDate>
<dc:creator>ç‹è€…ä¹‹å·…</dc:creator>
<og:description>ä»Šå¤©æˆ‘ä»¬å®Œæˆæ¡†æ¶çš„thymeleafæ¨¡æ¿æ˜¾ç¤ºé¡µé¢åŠŸèƒ½ï¼Œé¡µé¢çš„ç”¨æˆ·ç™»é™†ï¼Œå¯†ç çš„AESåŠ å¯†è§£å¯†ï¼Œè¾“é”™3æ¬¡è¿›è¡ŒéªŒè¯ç éªŒè¯åŠŸèƒ½ï¼Œä¸œè¥¿å¯èƒ½æ¯”è¾ƒå¤šï¼Œè¿™ä¸ªæ˜¯æˆ‘è¿™ä¸¤å¤©åœ¨ç½‘ä¸Šç»“åˆå„ç§èµ„æºæ•´åˆå‡ºæ¥çš„ï¼ŒåŸºæœ¬åŠŸèƒ½éƒ½å·²ç»å®ç°ï¼Œ</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.cnblogs.com/gaopengfirst/p/9677604.html</dc:identifier>
</item>
</channel>
</rss>