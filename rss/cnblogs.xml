<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>ç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ï¼Œä½ åˆ†å¾—æ¸…å—ï¼Ÿ - tobeçš„å‘“è¯­</title>
<link>http://www.cnblogs.com/tobe98/p/11664779.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/tobe98/p/11664779.html</guid>
<description>&lt;p&gt;&lt;em&gt;è¿™ç¯‡æ–‡ç« æ˜¯ä¸Šä¸€ç¯‡åšå®¢çš„è¡¥å……ï¼Œæ—¨åœ¨æŠŠæ²¡æœ‰è®²æ¸…æ¥šçš„ã€Œç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ã€è¡¥å……å®Œæ•´ã€‚å¸Œæœ›è¯»è€…èƒ½å¯¹çº¿ç¨‹æœ‰æ›´è¿›ä¸€æ­¥çš„äº†è§£ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;å°ç™½æœ€è¿‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ä¸Šå…³äºå¤šçº¿ç¨‹çš„èµ„æ–™å¾ˆå¤šï¼Œå°ç™½å¾ˆå¿«å°±æŠŠçº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µå¼„æ‡‚äº†ï¼Œä½†å…³äºã€Œç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ã€çš„æ¦‚å¿µï¼Œå¥¹å´æ€ä¹ˆä¹Ÿæä¸æ¸…æ¥šï¼Œåªå¥½å‘æ“ä½œç³»ç»ŸåŸºç¡€æ‰å®çš„å°æ˜è¯·æ•™ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå°ç™½çš„é—®é¢˜ï¼Œå°æ˜æ€»ä¼šè€å¿ƒè§£ç­”ï¼šâ€œçº¿ç¨‹é‡Œé¢è¿™ä¸¤ä¸ªæ¦‚å¿µç¡®å®æ¯”è¾ƒéš¾ç†è§£ï¼Œæˆ‘å…ˆç»™ä½ è®²ç”¨æˆ·çº§çº¿ç¨‹å§ã€‚â€&lt;/p&gt;
&lt;h3 id=&quot;ç”¨æˆ·çº§çº¿ç¨‹&quot;&gt;ç”¨æˆ·çº§çº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;â€œæ—¢ç„¶ä½ è¯´ä½ å·²ç»çœ‹è¿‡çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µï¼Œé‚£æˆ‘å°±ç›´æ¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆä¹…å¾ˆä¹…ä¹‹å‰ï¼Œçº¿ç¨‹çš„æ¦‚å¿µæ˜¯å‡ºç°äº†ï¼Œä½†æ“ä½œç³»ç»Ÿå‚å•†å¯ä¸èƒ½ç›´æ¥å°±å»ä¿®æ”¹æ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œå› ä¸ºå¯¹ä»–ä»¬æ¥è¯´ï¼Œ&lt;strong&gt;ç¨³å®šæ€§&lt;/strong&gt;æ˜¯æœ€é‡è¦çš„ã€‚è´¸ç„¶æŠŠæœªç»éªŒè¯çš„ä¸œè¥¿åŠ å…¥å†…æ ¸ï¼Œå‡ºé—®é¢˜äº†æ€ä¹ˆåŠï¼Ÿæ‰€ä»¥æƒ³è¦éªŒè¯çº¿ç¨‹çš„å¯ç”¨æ€§ï¼Œå¾—å¦æƒ³åŠæ³•ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œæˆ‘çŸ¥é“æˆ‘çŸ¥é“ï¼Œé‚£äº›ç ”ç©¶äººå‘˜å°±ç¼–å†™äº†ä¸€ä¸ªå…³äºçº¿ç¨‹çš„å‡½æ•°åº“ï¼Œ&lt;strong&gt;ç”¨å‡½æ•°åº“æ¥å®ç°çº¿ç¨‹&lt;/strong&gt;ï¼â€å°ç™½å¾—æ„çš„è¯´ï¼šâ€œè¿™ä¸ªæˆ‘åˆšåˆšåœ¨ç½‘ä¸Šçœ‹åˆ°äº†ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œæ˜¯çš„ï¼Œä»–ä»¬æŠŠ&lt;strong&gt;åˆ›å»ºçº¿ç¨‹&lt;/strong&gt;ã€&lt;strong&gt;ç»ˆæ­¢çº¿ç¨‹&lt;/strong&gt;ç­‰åŠŸèƒ½æ”¾åœ¨äº†è¿™ä¸ª&lt;strong&gt;çº¿ç¨‹åº“&lt;/strong&gt;å†…ï¼Œç”¨æˆ·å°±å¯ä»¥é€šè¿‡è°ƒç”¨è¿™äº›å‡½æ•°æ¥å®ç°æ‰€éœ€è¦çš„åŠŸèƒ½ã€‚â€å°æ˜æ‰¾äº†å¼ çº¸ï¼Œå†™ä¸Šäº†å‡ ä¸ªå‡½æ•°ï¼š&lt;code&gt;pthread_creat&lt;/code&gt; ï¼Œ&lt;code&gt;pthread_exit&lt;/code&gt; ï¼Œ&lt;code&gt;pthread_join&lt;/code&gt; ï¼Œ&lt;code&gt;pthread_yield&lt;/code&gt; ï¼Œæ¥ç€è¯´ï¼šâ€œè¿™æ˜¯å‡ ä¸ªé‡è¦çš„å‡½æ•°ï¼Œä½ åº”è¯¥èƒ½å¤§æ¦‚çŒœå‡ºè¿™äº›å‡½æ•°çš„åŠŸèƒ½å§ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;â€œemmmmï¼Œè®©æˆ‘æƒ³æƒ³ï¼Œ&lt;code&gt;pthread_creat&lt;/code&gt; æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œ&lt;code&gt;pthread_exit&lt;/code&gt; æ˜¯ç»“æŸçº¿ç¨‹ï¼Œ&lt;code&gt;pthread_join&lt;/code&gt; å˜›ï¼Œæˆ‘çŒœæ˜¯å‡†å¤‡è¿è¡ŒæŸä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åæŠŠå®ƒåŠ è¿›&lt;strong&gt;å°±ç»ªé˜Ÿåˆ—&lt;/strong&gt;ã€‚æœ€åä¸€ä¸ªå‡½æ•°æˆ‘å°±ä¸çŸ¥é“äº†ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œä¸çŸ¥é“ä¹Ÿæ²¡å…³ç³»ï¼Œä¸€ä¼šä½ å°±æ¸…æ¥šäº†ã€‚â€å°æ˜æ¥ç€è®²ï¼šâ€œè¦çŸ¥é“ï¼Œåˆšåˆšæˆ‘ä»¬è¯´çš„çº¿ç¨‹åº“ï¼Œæ˜¯ä½äºç”¨æˆ·ç©ºé—´çš„ï¼Œ&lt;strong&gt;æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹è¿™ä¸ªåº“ä¸€æ— æ‰€çŸ¥&lt;/strong&gt;ï¼Œæ‰€ä»¥ä»å†…æ ¸çš„è§’åº¦çœ‹ï¼Œå®ƒè¿˜æ˜¯æŒ‰æ­£å¸¸çš„æ–¹å¼ç®¡ç†ã€‚â€&lt;/p&gt;
&lt;p&gt;å°ç™½é—®é“ï¼šâ€œä¹Ÿå°±æ˜¯è¯´&lt;strong&gt;æ“ä½œç³»ç»Ÿçœ¼é‡Œè¿˜æ˜¯åªæœ‰è¿›ç¨‹&lt;/strong&gt;å–½ï¼Ÿé‚£æˆ‘ç”¨çº¿ç¨‹åº“å†™çš„ä¸€ä¸ªå¤šçº¿ç¨‹è¿›ç¨‹ï¼Œåªèƒ½ä¸€æ¬¡åœ¨&lt;strong&gt;ä¸€ä¸ª CPU æ ¸å¿ƒ&lt;/strong&gt;ä¸Šè¿è¡Œï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;å°æ˜ç‚¹ç‚¹å¤´ï¼Œè¯´ï¼šâ€œä½ è¯´çš„æ²¡é”™ï¼Œè¿™å…¶å®æ˜¯ç”¨æˆ·çº§çº¿ç¨‹çš„ä¸€ä¸ªç¼ºç‚¹ï¼Œè¿™äº›çº¿ç¨‹åªèƒ½å ç”¨ä¸€ä¸ªæ ¸ï¼Œæ‰€ä»¥åšä¸åˆ°&lt;strong&gt;å¹¶è¡ŒåŠ é€Ÿ&lt;/strong&gt;ï¼Œè€Œä¸”ç”±äºç”¨æˆ·çº¿ç¨‹çš„&lt;strong&gt;é€æ˜æ€§&lt;/strong&gt;ï¼Œ&lt;strong&gt;æ“ä½œç³»ç»Ÿæ˜¯ä¸èƒ½ä¸»åŠ¨åˆ‡æ¢çº¿ç¨‹çš„&lt;/strong&gt;ï¼Œæ¢å¥è¯è®²ï¼Œå¦‚æœ Aï¼ŒB æ˜¯åŒä¸€ä¸ªè¿›ç¨‹çš„ä¸¤ä¸ªçº¿ç¨‹çš„è¯ï¼Œ A æ­£åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œçº¿ç¨‹ B æƒ³è¦è¿è¡Œçš„è¯ï¼Œåªèƒ½ç­‰å¾… A &lt;strong&gt;ä¸»åŠ¨æ”¾å¼ƒ&lt;/strong&gt; CPUï¼Œä¹Ÿå°±æ˜¯ä¸»åŠ¨è°ƒç”¨ &lt;code&gt;pthread_yield&lt;/code&gt; å‡½æ•°ã€‚â€&lt;/p&gt;
&lt;p&gt;&lt;em&gt;tobe æ³¨ï¼šå¯¹æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œç”¨æˆ·çº§çº¿ç¨‹å…·æœ‰&lt;strong&gt;ä¸å¯è§æ€§&lt;/strong&gt;ï¼Œä¹Ÿç§°&lt;strong&gt;é€æ˜æ€§&lt;/strong&gt;ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;â€œåœä¸€ä¸‹ï¼Œè®©æˆ‘æƒ³ä¸€æƒ³ï¼Œâ€å°ç™½é£é€Ÿæ€è€ƒç€å°æ˜çš„è¯ï¼Œâ€œæ˜¯ä¸æ˜¯è¯´ï¼Œå³ä½¿æœ‰çº¿ç¨‹åº“ï¼Œç”¨æˆ·çº§çº¿ç¨‹ä¹Ÿåšä¸åˆ°åƒè¿›ç¨‹é‚£æ ·çš„&lt;strong&gt;è½®è½¬è°ƒåº¦&lt;/strong&gt;ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;â€œéå¸¸æ­£ç¡®ï¼çœ‹æ¥ä½ å¯¹è¿›ç¨‹çš„æ¦‚å¿µå¾ˆæ¸…æ¥šå˜›ã€‚ä¸è¿‡å‘¢ï¼Œè™½ç„¶ä¸èƒ½åšåˆ°è½®è½¬è°ƒåº¦ï¼Œä½†ç”¨æˆ·çº§çº¿ç¨‹ä¹Ÿæœ‰ä»–è‡ªå·±çš„å¥½å¤„â€”â€”ä½ å¯ä»¥&lt;strong&gt;ä¸ºä½ çš„åº”ç”¨ç¨‹åºå®šåˆ¶è°ƒåº¦ç®—æ³•&lt;/strong&gt;ï¼Œæ¯•ç«Ÿä»€ä¹ˆæ—¶å€™é€€å‡ºçº¿ç¨‹ä½ è‡ªå·±è¯´äº†ç®—ã€‚åˆšåˆšè¯´äº†ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿåªèƒ½çœ‹åˆ°è¿›ç¨‹çš„å­˜åœ¨ï¼Œé‚£å¦‚æœ&lt;strong&gt;æŸä¸€ä¸ªçº¿ç¨‹é˜»å¡&lt;/strong&gt;äº†ï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;â€œåœ¨æ“ä½œç³»ç»Ÿçœ¼é‡Œï¼Œæ˜¯è¿›ç¨‹é˜»å¡äº†ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹å°±ä¼šè¿›å…¥&lt;strong&gt;é˜»å¡æ€&lt;/strong&gt;ï¼Œåœ¨é˜»å¡æ“ä½œç»“æŸå‰ï¼Œè¿™ä¸ªè¿›ç¨‹éƒ½æ— æ³•å¾—åˆ° CPU èµ„æºã€‚é‚£å°±ç›¸å½“äºï¼Œ&lt;strong&gt;æ‰€æœ‰çš„çº¿ç¨‹éƒ½è¢«é˜»å¡&lt;/strong&gt;äº†ã€‚â€å°ç™½å¾—æ„çš„å›ç­”ã€‚&lt;/p&gt;
&lt;p&gt;â€œæ²¡é”™ï¼Œæ‰€ä»¥å¦‚æœä»»ç”±çº¿ç¨‹è¿›è¡Œé˜»å¡æ“ä½œï¼Œè¿›ç¨‹çš„æ•ˆç‡å°†å—åˆ°å¾ˆå¤§çš„å½±å“ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆâ€”â€”&lt;strong&gt;jacket&lt;/strong&gt;ã€‚æ‰€è°“ jacketï¼Œå°±æ˜¯æŠŠä¸€ä¸ªäº§ç”Ÿé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨è½¬åŒ–æˆä¸€ä¸ªéé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ã€‚â€&lt;/p&gt;
&lt;p&gt;å°ç™½æƒŠè®¶åœ°é—®ï¼šâ€œè¿™æ€ä¹ˆåšå¾—åˆ°ï¼Ÿè¯¥é˜»å¡çš„è°ƒç”¨ï¼Œè¿˜èƒ½å˜å¾—ä¸é˜»å¡ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;å°æ˜ç­”é“ï¼šâ€œæˆ‘æ¥ä¸¾ä¸ªä¾‹å­å§ï¼Œä¸æ˜¯ç›´æ¥è°ƒç”¨ä¸€ä¸ªç³»ç»Ÿ I/O ä¾‹ç¨‹ï¼Œè€Œæ˜¯è°ƒç”¨ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„ I/O jacket ä¾‹ç¨‹ï¼Œè¿™ä¸ª jacket ä¾‹ç¨‹ä¸­çš„ä»£ç ä¼šæ£€æŸ¥å¹¶ä¸”ç¡®å®š I/O è®¾å¤‡æ˜¯ä¸æ˜¯æ­£å¿™ï¼Œå¦‚æœå¿™çš„è¯ï¼Œå°±åœ¨&lt;strong&gt;ç”¨æˆ·æ€&lt;/strong&gt;ä¸‹å°†è¯¥çº¿ç¨‹é˜»å¡ï¼Œç„¶åæŠŠæ§åˆ¶æƒäº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹ã€‚éš”ä¸€æ®µæ—¶é—´åå†æ¬¡æ£€æŸ¥ I/O è®¾å¤‡ã€‚å°±åƒä½ è¯´çš„ï¼Œæœ€åè¿˜æ˜¯ä¼šæ‰§è¡Œé˜»å¡è°ƒç”¨ï¼Œä½†ä½¿ç”¨ jacket å¯ä»¥ç¼©çŸ­è¢«é˜»å¡çš„æ—¶é—´ã€‚ä¸è¿‡æœ‰äº›æƒ…å†µä¸‹æ˜¯å¯ä»¥ä¸è¢«é˜»å¡çš„ï¼Œå–å†³äºå…·ä½“çš„å®ç°ã€‚â€&lt;/p&gt;
&lt;p&gt;å°æ˜åœé¡¿äº†ä¸€ä¼šï¼Œè¯´ï¼šâ€œç”¨æˆ·çº§çº¿ç¨‹çš„æ¦‚å¿µå¤§æ¦‚å°±è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è®²å†…æ ¸çº§çº¿ç¨‹å§ã€‚â€&lt;/p&gt;
&lt;h3 id=&quot;å†…æ ¸çº§çº¿ç¨‹&quot;&gt;å†…æ ¸çº§çº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;â€œæœ‰äº†ç”¨æˆ·çº§çº¿ç¨‹çš„é“ºå«ï¼Œå†…æ ¸çº§çº¿ç¨‹å°±å¥½è®²å¤šäº†ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“ï¼Œè®¸å¤šæ“ä½œç³»ç»Ÿéƒ½å·²ç»æ”¯æŒå†…æ ¸çº§çº¿ç¨‹äº†ã€‚ä¸ºäº†å®ç°çº¿ç¨‹ï¼Œå†…æ ¸é‡Œå°±éœ€è¦æœ‰ç”¨æ¥è®°å½•ç³»ç»Ÿé‡Œæ‰€æœ‰çº¿ç¨‹çš„çº¿ç¨‹è¡¨ã€‚å½“éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹çš„æ—¶å€™ï¼Œå°±éœ€è¦è¿›è¡Œä¸€ä¸ª&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼Œç„¶åç”±&lt;strong&gt;æ“ä½œç³»ç»Ÿ&lt;/strong&gt;è¿›è¡Œçº¿ç¨‹è¡¨çš„æ›´æ–°ã€‚å½“ç„¶äº†ï¼Œä¼ ç»Ÿçš„è¿›ç¨‹è¡¨ä¹Ÿè¿˜æ˜¯æœ‰çš„ã€‚ä½ æƒ³æƒ³çœ‹ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿã€Œçœ‹å¾—è§ã€çº¿ç¨‹ï¼Œæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿâ€œ&lt;/p&gt;
&lt;p&gt;å°ç™½è‡ªä¿¡çš„å›ç­”ï¼šâ€œæ“ä½œç³»ç»Ÿå†…æ ¸å¦‚æœçŸ¥é“çº¿ç¨‹çš„å­˜åœ¨ï¼Œå°±å¯ä»¥åƒè°ƒåº¦å¤šä¸ªè¿›ç¨‹ä¸€æ ·ï¼ŒæŠŠè¿™äº›çº¿ç¨‹æ”¾åœ¨å¥½å‡ ä¸ª CPU æ ¸å¿ƒä¸Šï¼Œå°±èƒ½åšåˆ°å®é™…ä¸Šçš„&lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;äº†ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œè¿˜æœ‰ä¸€ç‚¹ä½ æ²¡æœ‰è¯´åˆ°ï¼Œå¦‚æœçº¿ç¨‹å¯è§ï¼Œé‚£ä¹ˆ&lt;strong&gt;å‡å¦‚çº¿ç¨‹ A é˜»å¡äº†ï¼Œä¸ä»–åŒå±ä¸€ä¸ªè¿›ç¨‹çš„çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é˜»å¡&lt;/strong&gt;ã€‚è¿™æ˜¯å†…æ ¸çº§çº¿ç¨‹çš„ç»å¯¹ä¼˜åŠ¿ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œé‚£å†…æ ¸çº§çº¿ç¨‹å°±æ²¡æœ‰ä»€ä¹ˆç¼ºç‚¹å—ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;â€œç¼ºç‚¹å½“ç„¶æ˜¯æœ‰çš„ï¼Œä½ æƒ³æƒ³çœ‹ï¼Œè®©æ“ä½œç³»ç»Ÿè¿›è¡Œçº¿ç¨‹è°ƒåº¦ï¼Œé‚£æ„å‘³ç€æ¯æ¬¡åˆ‡æ¢çº¿ç¨‹ï¼Œå°±éœ€è¦ã€Œ&lt;strong&gt;é™·å…¥&lt;/strong&gt;ã€å†…æ ¸æ€ï¼Œè€Œæ“ä½œç³»ç»Ÿä»&lt;strong&gt;ç”¨æˆ·æ€åˆ°å†…æ ¸æ€&lt;/strong&gt;çš„è½¬å˜æ˜¯æœ‰å¼€é”€çš„ï¼Œæ‰€ä»¥è¯´&lt;strong&gt;å†…æ ¸çº§çº¿ç¨‹åˆ‡æ¢çš„ä»£ä»·è¦æ¯”ç”¨æˆ·çº§çº¿ç¨‹å¤§&lt;/strong&gt;ã€‚è¿˜æœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹â€”â€”çº¿ç¨‹è¡¨æ˜¯å­˜æ”¾åœ¨æ“ä½œç³»ç»Ÿå›ºå®šçš„&lt;strong&gt;è¡¨æ ¼ç©ºé—´&lt;/strong&gt;æˆ–è€…&lt;strong&gt;å †æ ˆç©ºé—´&lt;/strong&gt;é‡Œï¼Œæ‰€ä»¥å†…æ ¸çº§çº¿ç¨‹çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼Œæ‰©å±•æ€§æ¯”ä¸ä¸Šç”¨æˆ·çº§çº¿ç¨‹ã€‚â€&lt;/p&gt;
&lt;p&gt;&quot;å†…æ ¸çº§çº¿ç¨‹å°±è¿™ä¹ˆç‚¹ä¸œè¥¿ï¼Œæˆ‘æœ€åç»™ä½ ç•™ä¸€å¼ å›¾ï¼Œä½ è¦æ˜¯èƒ½çœ‹å¾—æ‡‚ï¼Œå°±è¯´æ˜ä½ ç†è§£ä»Šå¤©çš„æ¦‚å¿µäº†ã€‚&quot;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1780031/201910/1780031-20191013084019048-559447731.jpg&quot; alt=&quot;ä¸¤ä¸ªçº¿ç¨‹æ¨¡å‹&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å°ç™½å¾—æ„åœ°è¯´ï¼šâ€œæˆ‘å½“ç„¶çœ‹å¾—æ‡‚äº†ï¼Œè°¢è°¢å°æ˜ï¼â€&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;å¸Œæœ›ä½ åœ¨çœ‹å®Œæˆ‘çš„æ–‡ç« ä¹‹åæœ‰æ‰€æ”¶è·ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œæˆ‘ä»¬åä¼šæœ‰æœŸï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å£°æ˜ï¼šåŸåˆ›æ–‡ç« ï¼Œæœªç»æˆæƒï¼Œç¦æ­¢è½¬è½½&lt;/strong&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 13 Oct 2019 00:40:00 +0000</pubDate>
<dc:creator>tobeçš„å‘“è¯­</dc:creator>
<og:description>è¿™ç¯‡æ–‡ç« æ˜¯ä¸Šä¸€ç¯‡åšå®¢çš„è¡¥å……ï¼Œæ—¨åœ¨æŠŠæ²¡æœ‰è®²æ¸…æ¥šçš„ã€Œç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ã€è¡¥å……å®Œæ•´ã€‚å¸Œæœ›è¯»è€…èƒ½å¯¹çº¿ç¨‹æœ‰æ›´è¿›ä¸€æ­¥çš„äº†è§£ã€‚ å°ç™½æœ€è¿‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚ ç½‘ä¸Šå…³äºå¤šçº¿ç¨‹çš„èµ„æ–™å¾ˆå¤šï¼Œå°ç™½å¾ˆå¿«å°±æŠŠçº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µå¼„</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/tobe98/p/11664779.html</dc:identifier>
</item>
<item>
<title>[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Linux - Artech</title>
<link>http://www.cnblogs.com/artech/p/inside-asp-net-core-01-05.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/artech/p/inside-asp-net-core-01-05.html</guid>
<description>&lt;p&gt;å¦‚æœæƒ³ä½“éªŒLinuxç¯å¢ƒä¸‹å¼€å‘.NET Coreåº”ç”¨ï¼Œæˆ‘ä»¬æœ‰å¤šç§é€‰æ‹©ã€‚ä¸€ç§å°±æ˜¯åœ¨ä¸€å°ç‰©ç†æœºä¸Šå®‰è£…åŸç”Ÿçš„Linuxï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªèº«çš„å–œå¥½é€‰æ‹©æŸç§Linux Distributionï¼Œç›®å‰æ¥è¯´åƒRHELã€Ubuntuã€Debianã€Fedoraã€CentOSå’ŒSUSEè¿™äº›ä¸»æµçš„Distributionéƒ½æ˜¯æ”¯æŒçš„ã€‚å¦‚æœè¯»è€…æœ‹å‹ä»¬è§‰å¾—è¿™ç§æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨è™šæ‹Ÿæœºçš„å½¢å¼å®‰è£…ç›¸åº”çš„Linux Distributionï¼Œæ¯”å¦‚æˆ‘ç»å¸¸ä½¿ç”¨çš„éƒ½æ˜¯å®‰è£…åœ¨VirtualBoxä¸Šçš„Ubuntuã€‚å¯¹äºX64 Windows 10çš„ç”¨æˆ·æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰äº†ç¬¬ä¸‰ç§æ›´ä¸ºæ–¹ä¾¿å¿«æ·çš„é€‰æ‹©ï¼Œé‚£å°±æ˜¯ä½¿ç”¨Windows 10æä¾›çš„Linuxå­ç³»ç»Ÿï¼ˆWSLï¼šWindows Subsystem for Linuxï¼‰ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸ºWSL 2ã€‚&lt;/p&gt;

&lt;p&gt;WSL 2è¦æ±‚æ“ä½œç³»ç»Ÿå¿…é¡»æ˜¯â€œWindows 10 build 18917 â€æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ã€‚åœ¨Windows 10ä¸Šå¯ç”¨WSL 2åªéœ€è¦å°†â€œ&lt;strong&gt;Virtual Machine Platform&lt;/strong&gt;â€ å’Œâ€œ&lt;strong&gt;Windows Subsystem for Linux&lt;/strong&gt;â€è¿™ä¸¤ä¸ªç‰¹æ€§å¼€å¯å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹å¼æ¥å¯ç”¨è¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œç¬¬ä¸€ç§åœ¨PowerShellä¸­ä»¥å¦‚ä¸‹çš„æ–¹å¼æ‰§è¡ŒEnable-WindowsOptionalFeatureå‘½ä»¤ï¼ˆè¯¥å‘½ä»¤éœ€è¦ä»¥&lt;strong&gt;ç®¡ç†å‘˜&lt;/strong&gt;èº«ä»½æ‰§è¡Œï¼‰ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨å¯è§†åŒ–çš„æ–¹å¼æ¥å¼€å¯è¿™ä¸¤ä¸ªç‰¹æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡â€œæ§åˆ¶é¢æ¿ï¼ˆControl Panelï¼‰â€&amp;gt;â€œç¨‹åºä¸åŠŸèƒ½ï¼ˆPrograms and Featuresï¼‰â€æ‰“å¼€å¦‚ä¸‹å›¾æ‰€ç¤ºçš„â€œç¨‹åºä¸åŠŸèƒ½â€å¯¹è¯æ¡†ï¼Œå¹¶é€‰æ‹©â€œTurn Windows features on or offï¼‰â€æ‰“å¼€â€œWindows Featuresâ€å¯¹è¯æ¡†ã€‚åœ¨å‹¾é€‰äº†â€œVirtual Machine Platformâ€å’Œâ€œWindows Subsytem for Linuxâ€é€‰é¡¹å¹¶ç¡®å®šå¹¶é‡å¯æœºå™¨ä¹‹åï¼Œé’ˆå¯¹Linuxçš„Windowså­ç³»ç»Ÿå°±è¢«å¯ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081654124-908802529.png&quot;&gt;&lt;img width=&quot;453&quot; height=&quot;344&quot; title=&quot;1-17&quot; alt=&quot;1-17&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081654461-1774987907.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¯ç”¨WSLä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦å®‰è£…å¯¹åº”çš„Linux Distributionã€‚æœ€æ–¹ä¾¿çš„æ–¹å¼å°±æ˜¯ç›´æ¥åœ¨Microsoft Storeä¸­ä¸‹è½½å¹¶å®‰è£…å¯¹åº”çš„Linux Distributionï¼Œæ¯”å¦‚Microsoft Storeä¸ºæˆ‘ä»¬æä¾›äº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å…è´¹ç‰ˆUbuntu 18.04 LTSã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081655233-1806695439.png&quot;&gt;&lt;img width=&quot;445&quot; height=&quot;354&quot; title=&quot;1-18&quot; alt=&quot;1-18&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081656158-1179853662.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœMicrosoft Storeä¸å¯ç”¨ï¼ˆæ¯”å¦‚æˆ‘çš„æ“ä½œç³»ç»Ÿå°±æ˜¯æ²¡æœ‰Microsoft Storeçš„Windows 10 Enterprise LTSCç‰ˆæœ¬ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨curl.exe or the Invoke-WebRequestä»¥å‘½ä»¤è¡Œçš„æ–¹å¼ä¸‹è½½Linuxå®‰è£…åŒ…ã€‚ä¸‹é¢åˆ—å‡ºäº†å‡ ç§å¸¸ç”¨çš„Linux Distributionçš„ä¸‹è½½åœ°å€ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Ubuntu 18.04: https://aka.ms/wsl-ubuntu-1804&lt;/li&gt;
&lt;li&gt;Ubuntu 18.04 ARM: https://aka.ms/wsl-ubuntu-1804-arm&lt;/li&gt;
&lt;li&gt;Ubuntu 16.04: https://aka.ms/wsl-ubuntu-1604&lt;/li&gt;
&lt;li&gt;Debian GNU/Linux: https://aka.ms/wsl-debian-gnulinux&lt;/li&gt;
&lt;li&gt;Kali Linux: https://aka.ms/wsl-kali-linux&lt;/li&gt;
&lt;li&gt;OpenSUSE: https://aka.ms/wsl-opensuse-42&lt;/li&gt;
&lt;li&gt;SLES: https://aka.ms/wsl-sles-12&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å½“Linuxè¢«æˆåŠŸå®‰è£…ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨CMDå‘½ä»¤è¡Œä¸­æ‰§è¡Œ&lt;strong&gt;bash&lt;/strong&gt;å‘½ä»¤è¿›å…¥Linux Bash Shellã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨CMDå‘½ä»¤è¡Œä¸­æ‰§è¡Œbashå‘½ä»¤ä¹‹åä¼šè‡ªåŠ¨è¿›å…¥Linux Bash Shellã€‚æˆ‘ä»¬åœ¨Bash Shellä¸­æ‰§è¡Œâ€œ&lt;strong&gt;lsb_release -a&lt;/strong&gt;â€å‘½ä»¤è¾“å‡ºå½“å‰å®‰è£…çš„Linux Distributionçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæƒ³æ¢å¤åˆ°CMDå‘½ä»¤è¡Œæ¨¡å¼ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰§è¡Œexitå‘½ä»¤é€€å‡ºBash Shellå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081656435-874209395.png&quot;&gt;&lt;img width=&quot;461&quot; height=&quot;252&quot; title=&quot;1-19&quot; alt=&quot;1-19&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081656698-46494885.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸»ç³»ç»Ÿçš„Windowså’ŒLinuxå­ç³»ç»Ÿå¯ä»¥å…±äº«ç½‘ç»œç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿã€‚Windowsä¸‹çš„æ–‡ä»¶ç³»ç»Ÿç›´æ¥æŒ‚è½½åˆ°â€œ&lt;strong&gt;/mnt&lt;/strong&gt;â€ç›®å½•ä¸‹ï¼Œæ‰€ä»¥Windowsä¸‹çš„æ–‡ä»¶æˆ–è€…ç›®å½•è·¯å¾„åŠ ä¸Šâ€œ/mntâ€å‰ç¼€å°±å˜æˆäº†åŸºäºLinuxå­ç³»ç»Ÿä¸‹çš„è·¯å¾„ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒCMDå‘½ä»¤è¡Œç¯å¢ƒä¸‹çš„å½“å‰å·¥ä½œç›®å½•ä¸ºâ€œc:\Users\jinnanâ€ï¼Œå½“æˆ‘ä»¬åˆ‡æ¢åˆ°Bash Shellåï¼Œå½“å‰å·¥ä½œç›®å½•å…¶å®å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåªæ˜¯è·¯å¾„å˜æˆäº†â€œ/&lt;strong&gt;mnt/c/Users/jinnan&lt;/strong&gt;â€è€Œå·²ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æƒ³åœ¨Linuxä¸‹è¿è¡Œ.NET Coreåº”ç”¨ï¼Œæˆ‘ä»¬ä¹Ÿåªéœ€è¦å®‰è£….NET Core SDKå°±å¯ä»¥äº†ã€‚é’ˆå¯¹ä¸åŒçš„Linux Distributionï¼Œ.NET Core SDKçš„å®‰è£…ç•¥æœ‰ä¸åŒã€‚å¯¹äºä¸»æµçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼ˆRHELã€Ubuntuã€Debianã€Fedoraã€CentOSå’ŒSUSEç­‰ï¼‰ï¼Œ .NET Coreå®˜æ–¹ç«™ç‚¹ä¸Šç»™å‡ºäº†å®‰è£….NET Core SDKçš„è¯¦ç»†æ•™ç¨‹ã€‚å¯¹äºæˆ‘ä»¬å®‰è£…çš„Ubuntu 18.04 LTSï¼Œ.NET Core 3.0 SDKå¯ä»¥æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;~$ sudo apt-get update
~$ sudo apt-get install apt-transport-https
~$ sudo apt-get install dotnet-sdk-&lt;/span&gt;3.0
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œdotnet --infoå‘½ä»¤æŸ¥çœ‹å½“å‰.NET Core SDKçš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚æœå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¾“å‡ºç»“æœï¼Œé‚£å°±è¯æ˜.NET Core SDK 3.0è¢«æˆåŠŸå®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081657098-25149535.png&quot;&gt;&lt;img width=&quot;446&quot; height=&quot;305&quot; title=&quot;1-20&quot; alt=&quot;1-20&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081657513-1986108480.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;.NET Core SDKåŒæ ·ä¸ºLinuxæä¾›äº†dotnetè¿™ä¸ªé‡è¦çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åŒæ ·å¯ä»¥åˆ©ç”¨å®ƒæä¾›çš„è„šæ‰‹æ¶æ¨¡æ¿åˆ›å»ºç›¸åº”çš„.NET Coreåº”ç”¨ã€‚è¿™æ¬¡æˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ASP.NET Core åº”ç”¨ï¼Œä¸ºæ­¤æˆ‘ä»¬åœ¨æ‰§è¡Œ&lt;strong&gt;dotnet new&lt;/strong&gt;å‘½ä»¤çš„æ—¶å€™å°†æ¨¡æ¿åç§°æŒ‡å®šä¸ºâ€œwebâ€ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œdotnet newå‘½ä»¤æ—¶çš„å½“å‰å·¥ä½œç›®å½•ä¸ºâ€œ/mnt/c/helloworldâ€ï¼Œä¹Ÿå°±æ˜¯ä¸»ç³»ç»ŸWindowsä¸‹çš„â€œc:\helloworldâ€ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081657811-1941024937.png&quot;&gt;&lt;img width=&quot;471&quot; height=&quot;306&quot; title=&quot;1-21&quot; alt=&quot;1-21&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081658121-654461179.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’Œåœ¨Windowså’ŒMac OS Xä¸‹åˆ©ç”¨è„šæ‰‹æ¶å‘½ä»¤åˆ›å»ºçš„åº”ç”¨ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨Linuxä¸‹åŒæ ·å¯ä»¥åœ¨æ— éœ€å¯¹å®ƒä»¬ä½œä»»ä½•æ›´æ”¹çš„æƒ…å†µä¸‹ç›´æ¥è¿è¡Œå®ƒä»¬ï¼Œä¸ºæ­¤æˆ‘ä»¬åªéœ€è¦åœ¨å½“å‰åº”ç”¨æ‰€åœ¨çš„ç›®å½•ä¸‹æ‰§è¡Œ&lt;strong&gt;dotnet run&lt;/strong&gt;å‘½ä»¤å³å¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯åŠ¨åçš„ASP .NET Coreåº”ç”¨é»˜è®¤ä¼šç»‘å®šåœ¨5000ï¼ˆHTTPï¼‰å’Œ5001ï¼ˆHTTPSï¼‰ç«¯å£è¿›è¡Œè¯·æ±‚ç›‘å¬ï¼Œç”±äºLinuxæ˜¯å½“å‰Windowsçš„å­ç³»ç»Ÿè€Œéè™šæ‹Ÿæœºï¼Œæ‰€ä»¥ä¸»å­ç³»ç»Ÿå¯ä»¥å…±äº«ç½‘ç»œï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨æµè§ˆå™¨è¯·æ±‚åœ°å€â€œhttp://localhost:5000â€å¯ä»¥è®¿é—®è¿™ä¸ªåº”ç”¨çš„ä¸»é¡µã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081658475-498740560.png&quot;&gt;&lt;img width=&quot;458&quot; height=&quot;296&quot; title=&quot;1-22&quot; alt=&quot;1-22&quot; src=&quot;https://img2018.cnblogs.com/blog/19327/201910/19327-20191013081658847-1435886643.png&quot; border=&quot;0&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-01-01.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Windows [ä¸Šç¯‡]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-01-02.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Windows [ä¸­ç¯‡]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-01-03.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Windows [ä¸‹ç¯‡]&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-01-04.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Mac OS&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-01-05.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Linux&lt;/a&gt;&lt;br/&gt;&lt;a href=&quot;https://www.cnblogs.com/artech/p/inside-asp-net-core-061.html&quot;&gt;[ASP.NET Core 3æ¡†æ¶æ­ç§˜] è·¨å¹³å°å¼€å‘ä½“éªŒ: Docker&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 13 Oct 2019 00:17:00 +0000</pubDate>
<dc:creator>Artech</dc:creator>
<og:description>å¦‚æœæƒ³ä½“éªŒLinuxç¯å¢ƒä¸‹å¼€å‘.NET Coreåº”ç”¨ï¼Œæˆ‘ä»¬æœ‰å¤šç§é€‰æ‹©ã€‚ä¸€ç§å°±æ˜¯åœ¨ä¸€å°ç‰©ç†æœºä¸Šå®‰è£…åŸç”Ÿçš„Linuxï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªèº«çš„å–œå¥½é€‰æ‹©æŸç§Linux Distributionï¼Œç›®å‰æ¥è¯´åƒRHEL</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/artech/p/inside-asp-net-core-01-05.html</dc:identifier>
</item>
<item>
<title>ä¸€æ–‡æ•™ä½ å®‰å…¨çš„å…³é—­çº¿ç¨‹æ±  - good_andyxu</title>
<link>http://www.cnblogs.com/goodAndyxublog/p/11664742.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/goodAndyxublog/p/11664742.html</guid>
<description>&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1419561/201910/1419561-20191013074227785-2110660954.jpg&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šç¯‡æ–‡ç«  &lt;a href=&quot;https://studyidea.cn/articles/2019/09/03/1567504427330.html&quot;&gt;ShutdownHook- Java ä¼˜é›…åœæœºè§£å†³æ–¹æ¡ˆ&lt;/a&gt; æåˆ°åº”ç”¨åœæœºæ—¶éœ€è¦é‡Šæ”¾èµ„æºï¼Œå…³é—­è¿æ¥ã€‚å¯¹äºä¸€äº›å®šæ—¶ä»»åŠ¡æˆ–è€…ç½‘ç»œè¯·æ±‚æœåŠ¡å°†ä¼šä½¿ç”¨çº¿ç¨‹æ± ï¼Œå½“åº”ç”¨åœæœºæ—¶éœ€è¦æ­£ç¡®å®‰å…¨çš„å…³é—­çº¿ç¨‹æ± ï¼Œå¦‚æœå¤„ç†ä¸å½“ï¼Œå¯èƒ½é€ æˆæ•°æ®ä¸¢å¤±ï¼Œä¸šåŠ¡è¯·æ±‚ç»“æœä¸æ­£ç¡®ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å…³é—­çº¿ç¨‹æ± æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»€ä¹ˆéƒ½ä¸åšï¼ŒJVM å…³é—­æ—¶è‡ªç„¶çš„ä¼šæ¸…é™¤çº¿ç¨‹æ± å¯¹è±¡ã€‚å½“ç„¶è¿™ä¹ˆåšï¼Œå­˜åœ¨å¾ˆå¤§çš„å¼Šç«¯ï¼Œçº¿ç¨‹æ± ä¸­æ­£åœ¨æ‰§è¡Œæ‰§è¡Œçš„çº¿ç¨‹ä»¥åŠé˜Ÿåˆ—ä¸­è¿˜æœªæ‰§è¡Œä»»åŠ¡å°†ä¼šå˜å¾—æä¸å¯æ§ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•æ§åˆ¶åˆ°è¿™äº›æœªæ‰§è¡Œçš„ä»»åŠ¡ä»¥åŠæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹æ±  API æä¾›ä¸¤ä¸ªä¸»åŠ¨å…³é—­çš„æ–¹æ³• &lt;code&gt;ThreadPoolExecutor#shutdownNow&lt;/code&gt; ä¸ &lt;code&gt;ThreadPoolExecutor#shutdown&lt;/code&gt;ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥ç”¨äºå…³é—­çº¿ç¨‹æ± ï¼Œä½†æ˜¯å…·ä½“æ•ˆæœå´ä¸å¤ªä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2 id=&quot;çº¿ç¨‹æ± çš„çŠ¶æ€&quot;&gt;çº¿ç¨‹æ± çš„çŠ¶æ€&lt;/h2&gt;
&lt;p&gt;åœ¨è¯´çº¿ç¨‹æ± å…³é—­æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£çº¿ç¨‹æ± çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;çº¿ç¨‹æ± çŠ¶æ€å…³ç³»å›¾å¦‚ä¸‹ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1419561/201910/1419561-20191013074229123-952392180.png&quot; alt=&quot;çº¿ç¨‹æ± çŠ¶æ€.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä»ä¸Šå›¾æˆ‘ä»¬çœ‹åˆ°çº¿ç¨‹æ± æ€»å…±å­˜åœ¨ 5 ç§çŠ¶æ€ï¼Œåˆ†åˆ«ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;RUNNING&lt;/strong&gt;ï¼šçº¿ç¨‹æ± åˆ›å»ºä¹‹åçš„åˆå§‹çŠ¶æ€ï¼Œè¿™ç§çŠ¶æ€ä¸‹å¯ä»¥æ‰§è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SHUTDOWN&lt;/strong&gt;:è¯¥çŠ¶æ€ä¸‹çº¿ç¨‹æ± ä¸å†æ¥å—æ–°ä»»åŠ¡ï¼Œä½†æ˜¯ä¼šå°†å·¥ä½œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;STOP&lt;/strong&gt;: è¯¥çŠ¶æ€ä¸‹çº¿ç¨‹æ± ä¸å†æ¥å—æ–°ä»»åŠ¡ï¼Œä½†æ˜¯ä¸ä¼šå¤„ç†å·¥ä½œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å°†ä¼šä¸­æ–­çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TIDYING&lt;/strong&gt;ï¼šè¯¥çŠ¶æ€ä¸‹æ‰€æœ‰ä»»åŠ¡éƒ½å·²ç»ˆæ­¢ï¼Œå°†ä¼šæ‰§è¡Œ &lt;code&gt;terminated()&lt;/code&gt; é’©å­æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TERMINATED&lt;/strong&gt;ï¼šæ‰§è¡Œå®Œ &lt;code&gt;terminated()&lt;/code&gt; é’©å­æ–¹æ³•ä¹‹åã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;å½“æˆ‘ä»¬æ‰§è¡Œ &lt;code&gt;ThreadPoolExecutor#shutdown&lt;/code&gt; æ–¹æ³•å°†ä¼šä½¿çº¿ç¨‹æ± çŠ¶æ€ä» &lt;strong&gt;RUNNING&lt;/strong&gt; è½¬å˜ä¸º &lt;strong&gt;SHUTDOWN&lt;/strong&gt;ã€‚è€Œè°ƒç”¨ &lt;code&gt;ThreadPoolExecutor#shutdownNow&lt;/code&gt; ä¹‹åçº¿ç¨‹æ± çŠ¶æ€å°†ä¼šä» &lt;strong&gt;RUNNING&lt;/strong&gt; è½¬å˜ä¸º &lt;strong&gt;STOP&lt;/strong&gt;ã€‚ä»ä¸Šé¢çš„å›¾ä¸Šè¿˜å¯ä»¥çœ‹åˆ°ï¼Œå½“çº¿ç¨‹æ± å¤„äº &lt;strong&gt;SHUTDOWN&lt;/strong&gt;ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ç»§ç»­è°ƒç”¨ &lt;code&gt;ThreadPoolExecutor#shutdownNow&lt;/code&gt; æ–¹æ³•ï¼Œå°†å…¶çŠ¶æ€è½¬å˜ä¸º &lt;strong&gt;STOP&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;h2 id=&quot;threadpoolexecutorshutdown&quot;&gt;ThreadPoolExecutor#shutdown&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬çŸ¥é“çº¿ç¨‹æ± çŠ¶æ€ï¼Œè¿™é‡Œå…ˆè¯´è¯´ &lt;code&gt;shutdown&lt;/code&gt; æ–¹æ³•ã€‚&lt;code&gt;shutdown&lt;/code&gt; æ–¹æ³•æºç æ¯”è¾ƒç®€å•ï¼Œèƒ½æ¯”è¾ƒç›´è§‚ç†è§£å…¶è°ƒç”¨é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;code&gt;shutdown&lt;/code&gt; æ–¹æ³•æºç ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;    public void shutdown() {
        final ReentrantLock mainLock = this.mainLock;
        mainLock.lock();
        try {
       // æ£€æŸ¥æƒé™
            checkShutdownAccess();
            // è®¾ç½®çº¿ç¨‹æ± çŠ¶æ€
        advanceRunState(SHUTDOWN);
       // ä¸­æ–­ç©ºé—²çº¿ç¨‹
            interruptIdleWorkers();
            // é’©å­å‡½æ•°ï¼Œä¸»è¦ç”¨äºæ¸…ç†ä¸€äº›èµ„æº
            onShutdown(); 
        } finally {
            mainLock.unlock();
        }
        tryTerminate();
    }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;shutdown&lt;/code&gt; æ–¹æ³•é¦–å…ˆåŠ é”ï¼Œå…¶æ¬¡å…ˆæ£€æŸ¥ç³»ç»Ÿå®‰è£…çŠ¶æ€ã€‚æ¥ç€å°±ä¼šå°†çº¿ç¨‹æ± çŠ¶æ€å˜ä¸º &lt;strong&gt;SHUTDOWN&lt;/strong&gt;ï¼Œåœ¨è¿™ä¹‹åçº¿ç¨‹æ± ä¸å†æ¥å—æäº¤çš„æ–°ä»»åŠ¡ã€‚æ­¤æ—¶å¦‚æœè¿˜ç»§ç»­å¾€çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œå°†ä¼šä½¿ç”¨çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥å“åº”ï¼Œé»˜è®¤æƒ…å†µä¸‹å°†ä¼šä½¿ç”¨ &lt;code&gt;ThreadPoolExecutor.AbortPolicy&lt;/code&gt;ï¼ŒæŠ›å‡º &lt;code&gt;RejectedExecutionException&lt;/code&gt; å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;interruptIdleWorkers&lt;/code&gt; æ–¹æ³•åªä¼šä¸­æ–­ç©ºé—²çš„çº¿ç¨‹ï¼Œä¸ä¼šä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çš„çº¿ç¨‹ã€‚ç©ºé—²çš„çº¿ç¨‹å°†ä¼šé˜»å¡åœ¨çº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹æ± æ„é€ å‚æ•°éœ€è¦æŒ‡å®š &lt;strong&gt;coreSize&lt;/strong&gt;ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ± æ•°é‡ï¼‰ï¼Œ&lt;strong&gt;maximumPoolSize&lt;/strong&gt;ï¼ˆæœ€å¤§çš„çº¿ç¨‹æ± æ•°é‡ï¼‰ï¼Œ&lt;strong&gt;keepAliveTime&lt;/strong&gt;ï¼ˆå¤šä½™ç©ºé—²çº¿ç¨‹ç­‰å¾…æ—¶é—´ï¼‰ï¼Œ&lt;strong&gt;unit&lt;/strong&gt;ï¼ˆæ—¶é—´å•ä½ï¼‰ï¼Œ&lt;strong&gt;workQueue&lt;/strong&gt;ï¼ˆé˜»å¡é˜Ÿåˆ—ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“è°ƒç”¨çº¿ç¨‹æ± çš„ &lt;code&gt;execute&lt;/code&gt; æ–¹æ³•ï¼Œçº¿ç¨‹æ± å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;å¦‚æœæ­¤æ—¶çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡å°äº &lt;strong&gt;coreSize&lt;/strong&gt;ï¼Œå°†ä¼šæ–°å»ºçº¿ç¨‹æ‰§è¡Œæäº¤çš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ­¤æ—¶çº¿ç¨‹æ± çº¿ç¨‹æ•°é‡å·²ç»å¤§äº &lt;strong&gt;coreSize&lt;/strong&gt;ï¼Œå°†ä¼šç›´æ¥æŠŠä»»åŠ¡åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚çº¿ç¨‹å°†ä¼šä»å·¥ä½œé˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå·¥ä½œé˜Ÿåˆ—å·²æ»¡ï¼Œå°†ä¼šç»§ç»­æ–°å»ºçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå·¥ä½œé˜Ÿåˆ—å·²æ»¡ï¼Œä¸”çº¿ç¨‹æ•°ç­‰äº &lt;strong&gt;maximumPoolSize&lt;/strong&gt;ï¼Œæ­¤æ—¶å°†ä¼šä½¿ç”¨æ‹’ç»ç­–ç•¥æ‹’ç»ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;è¶…è¿‡ &lt;strong&gt;coreSize&lt;/strong&gt; æ•°é‡é‚£éƒ¨åˆ†çº¿ç¨‹ï¼Œå¦‚æœç©ºé—²äº† &lt;strong&gt;keepAliveTime&lt;/strong&gt; ï¼Œçº¿ç¨‹å°†ä¼šç»ˆæ­¢ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;&lt;em&gt;å·¥ä½œæµç¨‹å›¾å¦‚ä¸‹ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1419561/201910/1419561-20191013074230121-304502678.png&quot; alt=&quot;çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹å›¾.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å½“çº¿ç¨‹æ± å¤„äºç¬¬äºŒæ­¥æ—¶ï¼Œçº¿ç¨‹å°†ä¼šä½¿ç”¨ &lt;code&gt;workQueue#take&lt;/code&gt; è·å–é˜Ÿå¤´çš„ä»»åŠ¡ï¼Œç„¶åå®Œæˆä»»åŠ¡ã€‚å¦‚æœå·¥ä½œé˜Ÿåˆ—ä¸€ç›´æ²¡ä»»åŠ¡ï¼Œç”±äºé˜Ÿåˆ—ä¸ºé˜»å¡é˜Ÿåˆ—ï¼Œ&lt;code&gt;workQueue#take&lt;/code&gt; å°†ä¼šé˜»å¡çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;threadpoolexecutorshutdownnow&quot;&gt;ThreadPoolExecutor#shutdownNow&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;&lt;code&gt;ThreadPoolExecutor#shutdownNow&lt;/code&gt; æºç å¦‚ä¸‹ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;    public List&amp;lt;Runnable&amp;gt; shutdownNow() {
        List&amp;lt;Runnable&amp;gt; tasks;
        final ReentrantLock mainLock = this.mainLock;
        mainLock.lock();
        try {
        // æ£€æŸ¥çŠ¶æ€
            checkShutdownAccess();
        // å°†çº¿ç¨‹æ± çŠ¶æ€å˜ä¸º STOP
            advanceRunState(STOP);
            // ä¸­æ–­æ‰€æœ‰çº¿ç¨‹ï¼ŒåŒ…æ‹¬å·¥ä½œçº¿ç¨‹ä»¥åŠç©ºé—²çº¿ç¨‹
        interruptWorkers();
        // ä¸¢å¼ƒå·¥ä½œé˜Ÿåˆ—ä¸­å­˜é‡ä»»åŠ¡
            tasks = drainQueue();
        } finally {
            mainLock.unlock();
        }
        tryTerminate();
        return tasks;
    }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;shutdownNow&lt;/code&gt; æ–¹æ³•å°†ä¼šæŠŠçº¿ç¨‹æ± çŠ¶æ€è®¾ç½®ä¸º &lt;strong&gt;STOP&lt;/strong&gt;ï¼Œç„¶åä¸­æ–­æ‰€æœ‰çº¿ç¨‹ï¼Œæœ€åå–å‡ºå·¥ä½œé˜Ÿåˆ—ä¸­æ‰€æœ‰æœªå®Œæˆçš„ä»»åŠ¡è¿”å›ç»™è°ƒç”¨è€…ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æ¯” &lt;code&gt;shutdown&lt;/code&gt; æ–¹æ³•ï¼Œ&lt;code&gt;shutdownNow&lt;/code&gt; æ–¹æ³•æ¯”è¾ƒç²—æš´ï¼Œç›´æ¥ä¸­æ–­å·¥ä½œçº¿ç¨‹ã€‚ä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¸­æ–­çº¿ç¨‹å¹¶ä¸ä»£è¡¨çº¿ç¨‹ç«‹åˆ»ç»“æŸã€‚è¿™é‡Œéœ€è¦çº¿ç¨‹ä¸»åŠ¨é…åˆçº¿ç¨‹ä¸­æ–­å“åº”ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;çº¿ç¨‹ä¸­æ–­æœºåˆ¶ï¼š&lt;br/&gt;&lt;code&gt;thread#interrupt&lt;/code&gt; åªæ˜¯è®¾ç½®ä¸€ä¸ªä¸­æ–­æ ‡å¿—ï¼Œä¸ä¼šç«‹å³ä¸­æ–­æ­£å¸¸çš„çº¿ç¨‹ã€‚å¦‚æœæƒ³è®©ä¸­æ–­ç«‹å³ç”Ÿæ•ˆï¼Œå¿…é¡»åœ¨çº¿ç¨‹ å†…è°ƒç”¨ &lt;code&gt;Thread.interrupted()&lt;/code&gt; åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚&lt;br/&gt;å¯¹äºé˜»å¡çš„çº¿ç¨‹ï¼Œè°ƒç”¨ä¸­æ–­æ—¶ï¼Œçº¿ç¨‹å°†ä¼šç«‹åˆ»é€€å‡ºé˜»å¡çŠ¶æ€å¹¶æŠ›å‡º &lt;code&gt;InterruptedException&lt;/code&gt; å¼‚å¸¸ã€‚æ‰€ä»¥å¯¹äºé˜»å¡çº¿ç¨‹éœ€è¦æ­£ç¡®å¤„ç† &lt;code&gt;InterruptedException&lt;/code&gt; å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;awaittermination&quot;&gt;awaitTermination&lt;/h2&gt;
&lt;p&gt;çº¿ç¨‹æ±  &lt;code&gt;shutdown&lt;/code&gt; ä¸ &lt;code&gt;shutdownNow&lt;/code&gt; æ–¹æ³•éƒ½ä¸ä¼šä¸»åŠ¨ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„ç»“æŸï¼Œå¦‚æœéœ€è¦ç­‰åˆ°çº¿ç¨‹æ± ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œéœ€è¦è°ƒç”¨ &lt;code&gt;awaitTermination&lt;/code&gt; ä¸»åŠ¨ç­‰å¾…ä»»åŠ¡è°ƒç”¨ç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è°ƒç”¨æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;        threadPool.shutdown();
        try {
            while (!threadPool.awaitTermination(60,TimeUnit.SECONDS)){
                System.out.println(&quot;çº¿ç¨‹æ± ä»»åŠ¡è¿˜æœªæ‰§è¡Œç»“æŸ&quot;);
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚æœçº¿ç¨‹æ± ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œ&lt;code&gt;awaitTermination&lt;/code&gt; æ–¹æ³•å°†ä¼šè¿”å› &lt;code&gt;true&lt;/code&gt;ï¼Œå¦åˆ™å½“ç­‰å¾…æ—¶é—´è¶…è¿‡æŒ‡å®šæ—¶é—´åå°†ä¼šè¿”å› &lt;code&gt;false&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦ä½¿ç”¨è¿™ç§è¿›åˆ¶ï¼Œå»ºè®®åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šå¢åŠ ä¸€å®š&lt;strong&gt;é‡è¯•æ¬¡æ•°&lt;/strong&gt;ã€‚è¿™ä¸ªçœŸçš„å¾ˆé‡è¦ï¼ï¼ï¼&lt;/p&gt;
&lt;h2 id=&quot;ä¼˜é›…å…³é—­çº¿ç¨‹æ± &quot;&gt;ä¼˜é›…å…³é—­çº¿ç¨‹æ± &lt;/h2&gt;
&lt;p&gt;å›é¡¾ä¸Šé¢çº¿ç¨‹æ± çŠ¶æ€å…³ç³»å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¤„äº &lt;strong&gt;SHUTDOWN&lt;/strong&gt; çš„çŠ¶æ€ä¸‹çš„çº¿ç¨‹æ± ä¾æ—§å¯ä»¥è°ƒç”¨ &lt;code&gt;shutdownNow&lt;/code&gt;ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»“åˆ &lt;code&gt;shutdown&lt;/code&gt; ï¼Œ &lt;code&gt;shutdownNow&lt;/code&gt;ï¼Œ&lt;code&gt;awaitTermination&lt;/code&gt; ï¼Œæ›´åŠ ä¼˜é›…å…³é—­çº¿ç¨‹æ± ã€‚&lt;/p&gt;
&lt;pre class=&quot;java&quot;&gt;
&lt;code&gt;        threadPool.shutdown(); // Disable new tasks from being submitted
        // è®¾å®šæœ€å¤§é‡è¯•æ¬¡æ•°
        try {
            // ç­‰å¾… 60 s
            if (!threadPool.awaitTermination(60, TimeUnit.SECONDS)) {
                // è°ƒç”¨ shutdownNow å–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡
                threadPool.shutdownNow();
                // å†æ¬¡ç­‰å¾… 60 sï¼Œå¦‚æœè¿˜æœªç»“æŸï¼Œå¯ä»¥å†æ¬¡å°è¯•ï¼Œæˆ–åˆ™ç›´æ¥æ”¾å¼ƒ
                if (!threadPool.awaitTermination(60, TimeUnit.SECONDS))
                    System.err.println(&quot;çº¿ç¨‹æ± ä»»åŠ¡æœªæ­£å¸¸æ‰§è¡Œç»“æŸ&quot;);
            }
        } catch (InterruptedException ie) {
            // é‡æ–°è°ƒç”¨ shutdownNow
            threadPool.shutdownNow();
        }&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ–‡ç« é¦–å‘äº &lt;a href=&quot;https://studyidea.cn/articles/2019/09/08/1567940077280.html&quot;&gt;studyidea.cn/close..&lt;/a&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;5.5384615384615&quot;&gt;
&lt;p&gt;æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šç¨‹åºé€šäº‹ï¼Œè·å¾—æ—¥å¸¸å¹²è´§æ¨é€ã€‚å¦‚æœæ‚¨å¯¹æˆ‘çš„ä¸“é¢˜å†…å®¹æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„åšå®¢ï¼š&lt;a href=&quot;https://studyidea.cn&quot;&gt;studyidea.cn&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1419561/201910/1419561-20191013074232045-1488674648.png&quot; alt=&quot;å…¶ä»–å¹³å°.png&quot;/&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 12 Oct 2019 23:43:00 +0000</pubDate>
<dc:creator>good_andyxu</dc:creator>
<og:description>ä¸Šç¯‡æ–‡ç«  'ShutdownHook Java ä¼˜é›…åœæœºè§£å†³æ–¹æ¡ˆ' æåˆ°åº”ç”¨åœæœºæ—¶éœ€è¦é‡Šæ”¾èµ„æºï¼Œå…³é—­è¿æ¥ã€‚å¯¹äºä¸€äº›å®šæ—¶ä»»åŠ¡æˆ–è€…ç½‘ç»œè¯·æ±‚æœåŠ¡å°†ä¼šä½¿ç”¨çº¿ç¨‹æ± ï¼Œå½“åº”ç”¨åœæœºæ—¶éœ€è¦æ­£ç¡®å®‰å…¨çš„å…³é—­çº¿ç¨‹æ± ï¼Œå¦‚æœå¤„ç†</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/goodAndyxublog/p/11664742.html</dc:identifier>
</item>
<item>
<title>è°çš„å¤§å­¦ä¸è¿·èŒ«â€”â€”å¯»æ±‚è§£æ•‘ä¹‹é“ - æ³°æ–—è´¤è‹¥å¦‚</title>
<link>http://www.cnblogs.com/zyx110/p/11664377.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zyx110/p/11664377.html</guid>
<description>&lt;h3&gt;&lt;span class=&quot;md-plain md-expand&quot;&gt;å¤§å­¦å‰çš„å‡†å¤‡&lt;/span&gt;&lt;/h3&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;2017å¹´ï¼Œä»¤æˆ‘éš¾å¿˜çš„ä¸€å¹´ï¼Œå½“æ—¶çš„æˆ‘æ­£åœ¨è¡¥ä¹ ç­ä¸ºç¬¬äºŒæ¬¡é«˜è€ƒå¤‡æˆ˜ç€ã€‚æˆ‘ä»¬è¡¥ä¹ ç­çš„å¢™ä¸Šç²˜ç€ä¸€é“æ¨ªå¹…æ ¼å¤–æ˜¾çœ¼â€”â€”â€œåŠ æ²¹ï¼Œæˆ‘ä»¬ä¸€èµ·ä¸Šå¤§å­¦â€ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1640688/201910/1640688-20191012225201312-1293006280.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;åº”å±Šç­çš„é«˜ä¸‰åŒå­¦ä»¬å¬ç€å¼ æ°çš„â€œå¹´è½»çš„æˆ˜åœºâ€ç»™è‡ªå·±æ‰“æ°”ï¼Œè€Œèº«å¤„è¡¥ä¹ ç­çš„æˆ‘å“¼ç€æ°å“¥çš„â€œé€†æˆ˜â€ï¼Œä¸ºé«˜è€ƒé€†æˆ˜ï¼Œæš´é£å°‘å¹´è‚©è´Ÿç€æ¥è‡ªå­¦æ ¡å†…å¤–éƒ¨ã€å®¶åº­å†…å¤–éƒ¨ä»¥åŠå†…å¿ƒæ·±å¤„ç­‰æ–¹é¢çš„å±‚å±‚å‹åŠ›ï¼Œç”¨ç ´é‡œæ²‰èˆŸçš„å‹‡æ°”å’Œâ€œçœŸçš„ä¸æƒ³å†å¤è¯»â€çš„ä¿¡å¿µè¿æˆ˜é«˜è€ƒã€‚è‹å¤©ä¸è´Ÿæˆ‘ï¼Œâ€œå¡ç¿å¤±é©¬ï¼Œç„‰çŸ¥éç¦â€çš„ç»å…¸åœ¨æˆ‘èº«ä¸Šæœ¬è‰²å‡ºæ¼”â€”â€”é€†å¢ƒä¸­è‹¦è‹¦æŒ£æ‰çš„æˆ‘ç»ˆäºCä½å‡ºé“äº†ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;é«˜è€ƒå‰ï¼Œå¤§å­¦å¦‚â€œæ°´ä¸­æœˆï¼Œé•œä¸­èŠ±â€ï¼Œä¸€åˆ‡ä¸è¿‡æ˜¯å¿ƒä¸­çš„å¹»è±¡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;é«˜è€ƒåï¼Œå¤§å­¦å¦‚â€œé›¾é‡Œçœ‹èŠ±â€ï¼Œè™šè™šå®å®ï¼ŒçœŸçœŸå‡å‡ï¼Œä½ çš„æƒ³è±¡åŠ›æœ‰å¤šä¸°å¯Œï¼Œå¤§å­¦å°±æœ‰å¤šç¾å¥½ï¼Œå¯¹è‡ªç”±å’Œæœªæ¥å……æ»¡æ— é™çš„æ†§æ†¬å’Œå‘å¾€ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;Â &lt;/p&gt;
&lt;h3 class=&quot;md-end-block md-p md-focus&quot;&gt;ä¸Šå¤§å­¦äº†&lt;/h3&gt;
&lt;p&gt;&lt;span&gt;çœŸçš„ä¸Šå¤§å­¦äº†ï¼Œæˆ‘ä¸è¯´ç»å†ï¼Œæˆ‘ç”¨ä¸€å¼ å›¾ç‰‡æè¿°ä¸€ä¸‹ä¸Šå¤§å­¦çš„æ„Ÿæƒ³&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1640688/201910/1640688-20191012225537752-902836459.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ä¸‹é¢æˆ‘æ¥åˆ†äº«å‡ å¼ æˆ‘è§‰å¾—æ—¢çœŸå®åˆæç¬‘çš„å›¾ç‰‡ï¼Œçœ‹çœ‹å¤§å­¦ç‰ˆçš„ç†æƒ³å’Œç°å®(ğŸ¤­)&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1640688/201910/1640688-20191012225631312-322830771.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆçœŸå®ï¼Œå¯ä¸è¦é—®æˆ‘å›¾ä»å“ªæ¥ï¼Œå“ˆå“ˆï¼Œä¸€ç¬‘è€Œè¿‡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ç°åœ¨æˆ‘ä¹Ÿå¤§ä¸‰äº†ï¼Œä»å¤§ä¸€åˆ°ç°åœ¨æˆ‘ç»å†äº†å¾ˆå¤šï¼Œå¤§é“ç†ä¹Ÿæ€»ç»“äº†ä¸€æ•´å¥—ã€‚æˆé•¿æ˜¯æœ‰ä»£ä»·çš„ï¼Œå…¶ä¸­çš„è¾›é…¸åªæœ‰è‡ªå·±çŸ¥é“ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä½ èªæ˜æœ‰äººä¼šè¯´ä½ å¿ƒæœºé‡ï¼Œä½ é çš„æ˜¯åŠªåŠ›æœ‰äººä¼šè¯´ä½ è¿æ°”å¥½ï¼Œä½ è¯´è‡ªå·±å¤©ç”Ÿä¹è§‚æœ‰äººä¼šè¯´ä½ è™šå‡ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æœ‰æ—¶å€™ï¼Œä½ æ˜æ˜å°±æ˜¯ä¸€æ¯ç™½æ°´ï¼Œå´è¢«äººç¡¬ç”Ÿç”Ÿé€¼æˆäº†æ»¡è‚šå­æ†‹å±ˆçš„ç¢³é…¸é¥®æ–™ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;äººä¸€ç”Ÿè¦é‡è§å¤ªå¤šäººï¼Œå³ä½¿æœ‰äº›è¯å­—å­—è¯›å¿ƒï¼Œä¹Ÿæ²¡å¿…è¦æ´»åœ¨ä»–ä»¬çš„çœ¼ç¥é‡Œï¼Œåªè¦å†…å¿ƒæ¾„æ˜ï¼Œå°±æ°¸è¿œä¸ç”¨è®¨å¥½ä¸€ä¸ªä¸æ‡‚ä½ çš„äººã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å¹¸è¿çš„æ˜¯æˆ‘ä¸€ç›´åœ¨åšæŒåšæˆ‘è‡ªå·±ï¼Œæˆ‘æœ‰ç”¨è‡ªå·±çš„åŸåˆ™é€‰æ‹©é’Ÿæ„çš„æœ‹å‹ï¼Œä¹Ÿæœ‰ç‹ ä¸‹å†³å¿ƒåšæˆ‘å–œæ¬¢çš„äº‹ï¼Œä¹Ÿæ›¾ä¸ºäº†å¼¥è¡¥å†…å¿ƒçš„ä¸€ä¸é—æ†¾é»˜é»˜ç»™å­¦å¼Ÿå­¦å¦¹ä»˜å‡ºï¼Œå°½ç®¡å¾ˆå°‘æœ‰äººç†è§£æˆ‘ä¸ºä½•è¦è¿™æ ·åšï¼Œä½†æˆ‘å§‹ç»ˆåœ¨åšæŒï¼Œå¯èƒ½è¿™å°±æ˜¯æˆ‘åœ¨å¤§å­¦å­˜åœ¨çš„ä»·å€¼ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æ­¤ç¯‡åä¸ºè°çš„å¤§å­¦ä¸è¿·èŒ«ï¼Œå…¶å®è°éƒ½ä¼šè¿·èŒ«ï¼Œæˆ‘è§‰å¾—æˆ‘çš„å¤§å­¦ä¸€ç›´å¾ˆè¿·èŒ«ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½ä¼šæœ‰ä¸åŒçš„è¿·èŒ«ï¼Œä½†é‡è¦çš„æ˜¯ï¼Œæˆ‘æ²¡æœ‰åœ¨è¿·èŒ«ä¸­è¿·å¤±è‡ªå·±ï¼Œæˆ‘åšäº†å¾ˆå¤šå°è¯•ï¼Œä¸æ–­è·³å‡ºè‡ªå·±çš„èˆ’é€‚åŒºï¼Œå¯»æ‰¾é€‚åˆè‡ªå·±çš„æ–¹å‘ï¼Œè™½ç„¶åˆ°ç°åœ¨æˆ‘ä¾æ—§ä¸çŸ¥é“æˆ‘çœŸçš„æƒ³è¦ä»€ä¹ˆï¼Œä½†æ˜¯é€šè¿‡ä¸æ–­å°è¯•æˆ‘è‡³å°‘çŸ¥é“è‡ªå·±ä¸æƒ³è¦ä»€ä¹ˆï¼Œå³ä½¿åœ¨æˆ‘çš„äººç”Ÿé€‰é¡¹ä¸­åšæ’é™¤æ³•ï¼Œæˆ‘ä¹ŸçŸ¥é“æˆ‘çš„äººç”Ÿæ˜¯æˆ‘è¯•é”™è¯•å‡ºæ¥çš„ï¼Œæˆ‘æ— æ€¨æ— æ‚”ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä½ å¯ä»¥ä¸å¤Ÿå¼ºå¤§ï¼Œä½†æ˜¯ä¸èƒ½æ²¡æœ‰æ¢¦æƒ³ã€‚æœ‰æ¢¦æƒ³çš„äººï¼Œæ‰èƒ½æŒæ¡è‡ªå·±äººç”Ÿçš„ä¸»åŠ¨æƒï¼&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä½ æ˜¯å¦æ€è€ƒè¿‡ï¼Œä½ çš„å…´è¶£å’Œä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿä½ çš„ç›®æ ‡å’Œæ¢¦æƒ³æ—¶ä»€ä¹ˆï¼Ÿä½ çš„æœªæ¥çš„é“è·¯è¯¥æ€ä¹ˆèµ°ï¼Ÿå¦‚æœä½ æ²¡æœ‰æ¢¦æƒ³ï¼Œæ‰¾ä¸åˆ°ç²¾ç¥çš„å½’å±ï¼Œé‚£ä¹ˆå°†æ¥ä½ å°±åªèƒ½ä¸ºåˆ«äººçš„æ¢¦æƒ³æ‰“å·¥ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;çŸ¥ä¹ä¸Šæœ‰ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼šäººåœ¨è¿·èŒ«æ—¶è¯¥å¹²ä»€ä¹ˆï¼Ÿæœ€é«˜èµçš„å›ç­”å¾ˆç®€å•ï¼Œä¹Ÿå¾ˆç²¾è¾Ÿï¼šåšä¸¤ä»¶äº‹ï¼Œæ”¶å’Œæ”¾ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æ”¶ï¼Œæ˜¯åœæ‰æ‰€æœ‰ä¸æ˜¯å¿…é¡»è¦åšçš„äº‹ï¼ŒæŠŠæ—¶é—´å’Œç²¾åŠ›æ”¶å›æ¥ã€‚è¿·èŒ«ä¸æ˜¯æ— äº‹å¯åšï¼Œè€Œæ˜¯æ‰€åšçš„äº‹æ²¡æœ‰æ„ä¹‰ï¼Œæ²¡æœ‰æ„ä¹‰å°±åœæ‰ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æ”¾ï¼Œæ˜¯æ”¾å¼€è§†é‡ï¼Œæ”¾ä¸‹åŒ…è¢±ï¼Œå»å°è¯•æ–°äº‹ç‰©ï¼Œè®¤è¯†æ–°çš„äººã€‚èµ°å‡ºèˆ’é€‚åŒºï¼Œè®©è‡ªå·±çœ‹åˆ°æ›´å¤šçš„å¯èƒ½ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;&lt;span class=&quot;md-plain md-expand&quot;&gt;æˆ‘å‡ ä¸ªæœˆä¹‹å‰å†™äº†å…³äºè‡ªå·±çš„å‡ ç¯‡åšå®¢ï¼Œæƒ³ä»ä¸­æ‰¾åˆ°è‡ªå·±çš„åˆå¿ƒï¼Œè®¤æ¸…è‡ªæˆ‘ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ã€Š&lt;a href=&quot;https://www.cnblogs.com/zyx110/p/11005868.html&quot; target=&quot;_blank&quot;&gt;å¡ç¿å¤±é©¬ç„‰çŸ¥éç¦&lt;/a&gt;ã€‹&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ã€Š&lt;a href=&quot;https://www.cnblogs.com/zyx110/p/11008888.html&quot; target=&quot;_blank&quot;&gt;å¤§å­¦å†åŠªåŠ›ï¼ŒåŸ¹è®­æœºæ„åšå…„å¼Ÿ&lt;/a&gt;ã€‹&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ã€Š&lt;a href=&quot;https://www.cnblogs.com/zyx110/p/11609493.html&quot; target=&quot;_blank&quot;&gt;å¤§å­¦å·²è¿‡åŠï¼Œæ•¢é—®è·¯åœ¨ä½•æ–¹&lt;/a&gt;ã€‹&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä¸åŒçš„é˜¶æ®µï¼Œä¸åŒçš„è¿·èŒ«ï¼Œä¸åŒçš„æ”¹å˜ï¼Œè¿™å°±æ˜¯æˆ‘ï¼Œé‚£ä¹ˆä½ å‘¢ï¼Ÿ&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä½ åœ¨è¿·èŒ«æ—¶æ˜¯ç”¨æ¶ˆæçš„ç”Ÿæ´»æ··åƒç­‰æ­»è¿˜æ˜¯æˆ‘å‘½ç”±æˆ‘ä¸ç”±å¤©ï¼Œè¯•å›¾æ”¹å˜å‘¢ï¼Ÿ&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;Â &lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;strong&gt;è®©è‡ªå·±èµ°å‡ºè¿·èŒ«æœŸ&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å¦‚ä½•èµ°å‡ºè¿·èŒ«æœŸï¼Ÿåœ¨è¿™é‡Œç»™å¤§å®¶äº†èµ°å‡ºè¿·èŒ«çš„ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼Œä»¥åŠèµ°å‡ºè¿·èŒ«çš„åå…­å­—æ–¹é’ˆã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ç¬¬ä¸€é—®ï¼šæˆ‘ä¸ºä»€ä¹ˆè¯»å¤§å­¦ï¼Ÿé—®åˆ°æœ€ç»ˆç›®æ ‡ä¸ºæ­¢ï¼Œé—®åˆ°æ¸…æ™°ä¸ºæ­¢ï¼ï¼ˆé—®ç›®æ ‡ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;åšä»»ä½•äº‹æƒ…ï¼Œæˆ‘ä»¬é¦–å…ˆè¦é—®ä¸ºä»€ä¹ˆåšï¼Ÿé—®é—®é¢˜ç‰¹åˆ«å…³é”®ã€‚å½“è‡ªå·±æ²¡æœ‰åŠ¨åŠ›æ—¶é—®é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰åŠ¨åŠ›ï¼Ÿæ³¨æ„åŠ›ä¸é›†ä¸­æ—¶é—®é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿé—®è‡ªå·±ä¸ºä»€ä¹ˆï¼Œç„¶åå»è§£ç­”ï¼Œé—®é¢˜çš„ç­”æ¡ˆå°±åœ¨æˆ‘ä»¬èº«ä¸Šã€‚è¿™æ˜¯ç»™å¤§å®¶çš„ä¸€ä¸ªå¹³æ—¶å†…çœçš„å°æ–¹æ³•ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;é—®é—®è‡ªå·±ä¸ºä»€ä¹ˆè¦è¯»å¤§å­¦ï¼Œè¯»å¤§å­¦çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿå¾ˆå¤šäººè·Ÿæˆ‘è¯¢é—®å¤§å­¦è§„åˆ’æ—¶ï¼Œæˆ‘éƒ½ä¼šé—®ä»–ä»¬è¿™ä¸ªé—®é¢˜ã€‚ä¸€åˆ‡ä»¥ç›®æ ‡ä¸ºå¯¼å‘ï¼ŒçŸ¥é“äº†ç›®æ ‡æ‰çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œæ€ä¹ˆåšã€‚ç›®æ ‡æ˜¯åšä¸€åˆ‡äº‹æƒ…çš„å‰æã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å½“é—®è¿™ä¸ªé—®é¢˜æ—¶ï¼Œ&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ä½ å¯èƒ½ä¼šè¯´ï¼šä¸ºäº†ä»¥åæ›´å¥½çš„å‘å±•ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å¥½çš„ï¼Œé‚£ä¹ˆä»€ä¹ˆæ‰ç®—æ˜¯æ›´å¥½çš„å‘å±•å‘¢ï¼Ÿä½ å¯ä»¥æè¿°ä¸€ä¸‹å—ï¼Ÿ&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;è¿™æ—¶ä½ å¯èƒ½ä¼šè¯´ï¼šæœˆå·¥èµ„å¤šå°‘ï¼Ÿå¯ä»¥æ”¯æŒæ¯å¹´å‡ºå»æ—…è¡Œï¼Ÿå»å›½ä¼ï¼Œæˆ–è€…å»ä¸–ç•Œäº”ç™¾å¼ºã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å°±åƒè¿™æ ·ä¸€ç›´é—®åˆ°è‡ªå·±ç›®æ ‡ç‰¹åˆ«æ¸…æ™°ä¸ºæ­¢ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å†æ¯”å¦‚ä½ å¯èƒ½ä¼šè¯´è¦è€ƒç ”ï¼Œæ³¨æ„äº†ï¼Œè¿™æ˜¯è¿‡ç¨‹ï¼Œè€ƒç ”è¯»ç ”éƒ½æ˜¯ä¸€ä¸ªçŸ­æœŸçš„å­¦ä¹ ç›®æ ‡ï¼Œä¸æ˜¯æœ€ç»ˆçš„ç»“æœï¼Œç”šè‡³æœ‰å¯èƒ½è€ƒç ”éƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œè€Œæ˜¯å…¶ä»–äººç»™ä½ çš„ä¸€ä¸ªç›®æ ‡ã€‚ä¸€å®šå†æ¥ç€é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆè¦è€ƒç ”ï¼Œä¹‹åè¦åšä»€ä¹ˆï¼Ÿä¹Ÿå°±æ˜¯é—®åˆ°è‡ªå·±çš„æœ€ç»ˆç›®æ ‡ä¸ºæ­¢ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;é—®æ¸…æ¥šåå†è¿›è¡Œä¸‹ä¸€æ­¥ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ç¬¬äºŒé—®ï¼šå®ç°æˆ‘çš„ç›®æ ‡éœ€è¦è¾¾åˆ°ä»€ä¹ˆæ ‡å‡†ï¼Ÿï¼ˆæ¸…æ™°ç›®æ ‡ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;è¿™å°±åƒä½ é«˜ä¸‰è€ƒå¤§å­¦æ—¶ï¼Œä½ æ˜ç¡®ä¸‹æ¥è¦è€ƒåŒ—å¤§ï¼Œé‚£ä¹ˆä½ éœ€è¦è€ƒå¤šå°‘åˆ†ï¼Œâ€œå¤šå°‘åˆ†â€å°±æ˜¯å®ç°ç›®æ ‡çš„æ ‡å‡†ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;è¿˜æœ‰åƒå­¦è½¯ä»¶ç¼–ç¨‹çš„ï¼Œä½ æ˜¯è¦å»BATè¿˜æ˜¯å°å…¬å¸ï¼Œå¦‚æœå»BATï¼ŒBATçš„æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Œä½ èƒ½å¦è¾¾åˆ°å®ƒä»¬çš„æ ‡å‡†ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ç¬¬ä¸‰é—®ï¼šæˆ‘åº”è¯¥å¦‚ä½•åšï¼Ÿï¼ˆå¦‚ä½•å®ç°ç›®æ ‡ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;é€ç»™å¤§å®¶åå…­å­—æ–¹é’ˆï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;æ˜ç¡®ç›®æ ‡&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ç«‹å³è¡ŒåŠ¨&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ä¸æ‰¾å€Ÿå£&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;åˆ›é€ æˆå°±&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;em&gt;æ˜ç¡®ç›®æ ‡ï¼š&lt;/em&gt;&lt;/strong&gt;&lt;span class=&quot;md-plain&quot;&gt;æˆ‘ä»¬è¦æ˜ç¡®é•¿è¿œç›®æ ‡ï¼Œä¹Ÿè¦æ˜ç¡®é˜¶æ®µæ€§ç›®æ ‡ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;em&gt;ç«‹å³è¡ŒåŠ¨ï¼š&lt;/em&gt;&lt;/strong&gt;&lt;span class=&quot;md-plain&quot;&gt;è¡ŒåŠ¨ä¸­åªæƒ³ç€ç›®æ ‡ï¼Œå…¶ä»–çš„éƒ½æ˜¯éšœç¢ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;ä¸æ‰¾å€Ÿå£ï¼š&lt;/strong&gt;&lt;span class=&quot;md-plain&quot;&gt;çˆ±æ©æœ‰ä¸€å¥è¯å°±æ˜¯ï¼šæˆåŠŸå’Œå€Ÿå£æ°¸è¿œä¸åœ¨åŒä¸€ä¸ªå±‹æªä¸‹ï¼Œæ‰€ä»¥æƒ³è¦æˆåŠŸå°±ä¸è¦æœ‰å€Ÿå£ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span&gt;&lt;strong&gt;åˆ›é€ æˆå°±ï¼š&lt;/strong&gt;&lt;span class=&quot;md-plain&quot;&gt;å®Œæˆé˜¶æ®µæ€§çš„ç›®æ ‡å°±æ˜¯åœ¨åˆ›é€ æˆå°±çš„è¿‡ç¨‹ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p md-focus&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æˆ‘å½“æ—¶ä¹Ÿç»™å­¦å¼Ÿå­¦å¦¹å†™è¿‡ä¸€ç¯‡åšå®¢å«ã€Š&lt;a href=&quot;https://www.cnblogs.com/zyx110/p/10617265.html&quot; target=&quot;_blank&quot;&gt;åœ¨ä½ è¿·èŒ«æ—¶ä¸å¦‚å­¦å¥½ä¸€é—¨è¯­è¨€&lt;/a&gt;ã€‹&lt;span class=&quot;md-link&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;ï¼Œæ€»ä¹‹è¿·èŒ«æ˜¯æ­£å¸¸çš„ï¼Œä½†åƒä¸‡ä¸è¦å› ä¸ºè¿·èŒ«è€Œè¿·èŒ«ï¼Œè€½è¯¯äº†è‡ªå·±ï¼Œåˆ°å¤´æ¥ç«¹ç¯®æ‰“æ°´ä¸€åœºç©ºã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 class=&quot;md-end-block md-heading&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;æ­£å¦‚ã€Šè‚–ç”Ÿå…‹çš„æ•‘èµã€‹ä¸­çš„ä¸€å¥è¯ï¼Œè§£æ•‘ä¹‹é“å°±åœ¨å…¶ä¸­&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1640688/201910/1640688-20191012230128194-2145860094.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;md-end-block md-p&quot;&gt;&lt;span class=&quot;md-image md-img-loaded md-expand&quot; data-src=&quot;assets/2.png&quot;&gt;&lt;img src=&quot;file://c/Users/Lenovo/Desktop/assets/2.png?lastModify=1570892603&quot; alt=&quot;&quot; data-local-refresh=&quot;true&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 class=&quot;md-end-block md-heading md-focus&quot;&gt;&lt;span class=&quot;md-plain&quot;&gt;å°½äººäº‹å¬å¤©å‘½ï¼ŒåšæŒæ‰æ˜¯ç‹é“&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1640688/201910/1640688-20191012230138387-1013019363.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;md-plain&quot;&gt;&lt;strong&gt;ã€å°Šé‡åŸåˆ›ã€‘&lt;/strong&gt;&lt;span class=&quot;md-plain&quot;&gt;ï¼šæœ¬æ–‡å‡ºè‡ªåšå®¢å›­&lt;span class=&quot;md-link md-expand&quot;&gt;&lt;a href=&quot;https://www.cnblogs.com/zyx110/&quot;&gt;https://www.cnblogs.com/zyx110/&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 12 Oct 2019 22:12:00 +0000</pubDate>
<dc:creator>æ³°æ–—è´¤è‹¥å¦‚</dc:creator>
<og:description>è°çš„å¤§å­¦ä¸è¿·èŒ« å¤§å­¦å‰çš„å‡†å¤‡ 2017å¹´ï¼Œä»¤æˆ‘éš¾å¿˜çš„ä¸€å¹´ï¼Œå½“æ—¶çš„æˆ‘æ­£åœ¨è¡¥ä¹ ç­ä¸ºç¬¬äºŒæ¬¡é«˜è€ƒå¤‡æˆ˜ç€ã€‚æˆ‘ä»¬è¡¥ä¹ ç­çš„å¢™ä¸Šç²˜ç€ä¸€é“æ¨ªå¹…æ ¼å¤–æ˜¾çœ¼â€”â€”â€œåŠ æ²¹ï¼Œæˆ‘ä»¬ä¸€èµ·ä¸Šå¤§å­¦â€ã€‚ åº”å±Šç­çš„é«˜ä¸‰åŒå­¦ä»¬å¬ç€å¼ æ°çš„â€œå¹´è½»çš„</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/zyx110/p/11664377.html</dc:identifier>
</item>
<item>
<title>Springç³»åˆ—ï¼ˆå…­ï¼‰ï¼šSpringäº‹åŠ¡æºç è§£æ - toby.xu</title>
<link>http://www.cnblogs.com/toby-xu/p/11645162.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/toby-xu/p/11645162.html</guid>
<description>&lt;h2&gt;ä¸€ã€äº‹åŠ¡æ¦‚è¿°&lt;/h2&gt;
&lt;h3&gt;ã€€ã€€1.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡&lt;/h3&gt;
&lt;p&gt;ã€€ã€€äº‹åŠ¡æ˜¯ä¸€ç»„åŸå­æ€§çš„SQLæŸ¥è¯¢ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œå•å…ƒã€‚è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚&lt;/p&gt;
&lt;h3&gt;ã€€ã€€1.2 äº‹åŠ¡çš„ç‰¹æ€§(ACID)&lt;/h3&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘ åŸå­æ€§ï¼ˆ&lt;/strong&gt;atomicityï¼‰&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€ä¸€ä¸ªäº‹åŠ¡å¿…é¡»è¢«è§†ä¸ºä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡æ¥è¯´ï¼Œä¸å¯èƒ½åªæ‰§è¡Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†æ“ä½œ&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘¡ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€æ•°æ®åº“æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€è½¬æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘¢éš”ç¦»æ€§ï¼ˆisolationï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘£æŒä¹…æ€§ï¼ˆdurabilityï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°±ä¼šæ°¸ä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œæ¥ä¸‹æ¥å³ä½¿æ•°æ®åº“ç³»ç»Ÿå´©æºƒäº†ï¼Œä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±&lt;/p&gt;
&lt;h3&gt;ã€€ã€€1.3 äº‹åŠ¡çš„éš”ç¦»çº§åˆ«&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€â‘ è¯»æœªæäº¤ï¼ˆREAD UNCOMMITTEDï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€äº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´äº‹åŠ¡å¯ä»¥è¯»å–åˆ°æœªæäº¤çš„æ•°æ®ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸ºè„è¯»ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘¡&lt;/strong&gt;è¯»å·²æäº¤ï¼ˆREAD COMMITTEDï¼‰&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æäº¤ä¹‹å‰ï¼Œæ‰€åšçš„ä»»ä½•ä¿®æ”¹å¯¹å…¶ä»–äº‹åŠ¡éƒ½æ˜¯ä¸å¯è§çš„ï¼Œè¿™ä¸ªçº§åˆ«æœ‰æ—¶å€™ä¹Ÿå«ä¸å¯é‡å¤è¯»ï¼Œå› ä¸ºä¸¤æ¬¡æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘¢å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€è¯¥éš”ç¦»çº§åˆ«ä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·çš„è®°å½•çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯æ— æ³•è§£å†³å¦å¤–ä¸€ä¸ªå¹»è¯»çš„é—®é¢˜ï¼Œæ‰€è°“çš„å¹»è¯»å°±æ˜¯æŒ‡å½“æŸä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ˜¯ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶å°±ä¼šäº§ç”Ÿå¹»è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘£å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€SERIALIZABLEæ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œé€šè¿‡å¼ºåˆ¶äº‹åŠ¡çš„ä¸²è¡Œæ‰§è¡Œï¼Œé¿å…äº†å‰é¢è¯´çš„å¹»è¯»é—®é¢˜ï¼Œç®€å•æ¥è¯´ï¼ŒSERIALIZABLEä¼šåœ¨è¯»å–çš„æ¯ä¸€è¡Œæ•°æ®ä¸ŠåŠ ä¸Šé”ã€‚&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;äºŒã€Springäº‹åŠ¡å…³é”®æ¥å£&lt;/h2&gt;
&lt;h3&gt;ã€€ã€€1Â PlatformTransactionManager äº‹åŠ¡ç®¡ç†å™¨&lt;/h3&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; PlatformTransactionManager {

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è·å–äº‹åŠ¡
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
    TransactionStatus getTransaction(TransactionDefinition definition) &lt;/span&gt;&lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * æäº¤
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;void&lt;/span&gt; commit(TransactionStatus status) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * å›æ»š
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;void&lt;/span&gt; rollback(TransactionStatus status) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException;

}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;ã€€ã€€2Â TransactionDefinitionÂ äº‹åŠ¡å®šä¹‰ä¿¡æ¯&lt;/h3&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt;&lt;span&gt; TransactionDefinition {

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Support a current transaction; create a new one if none exists. æ”¯æŒå½“å‰äº‹ç‰©ï¼Œè‹¥å½“å‰æ²¡æœ‰äº‹ç‰©å°±åˆ›å»ºä¸€ä¸ªäº‹ç‰©
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_REQUIRED = 0&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Support a current transaction; execute non-transactionally if none exists. å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡çš„æ–¹å¼è¿è¡Œ
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_SUPPORTS = 1&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Support a current transaction; throw an exception if no current transaction exists. å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_MANDATORY = 2&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Create a new transaction, suspending the current transaction if one exists.åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_REQUIRES_NEW = 3&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Do not support a current transaction; rather always execute non-transactionally.ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_NOT_SUPPORTED = 4&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Do not support a current transaction; throw an exception if a current transaction exists. ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_NEVER = 5&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Execute within a nested transaction if a current transaction exists.å¦‚æœå¤–å±‚å­˜åœ¨äº‹åŠ¡ï¼Œå°±ä»¥åµŒå¥—äº‹åŠ¡è¿è¡Œï¼Œè¢«åµŒå¥—çš„äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå¤–å±‚äº‹åŠ¡è¿›è¡Œæäº¤æˆ–è€…å›æ»š(ä¿å­˜ç‚¹)ï¼Œ
å¦‚æœå¤–å±‚ä¸å­˜åœ¨äº‹åŠ¡,è¡Œä¸ºè·ŸPROPAGATION_REQUIRES_NEW
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; PROPAGATION_NESTED = 6&lt;span&gt;;


    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * Use the default isolation level of the underlying datastore. ä½¿ç”¨æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«&lt;br/&gt;ã€€ã€€ã€€&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; ISOLATION_DEFAULT = -1&lt;span&gt;;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è¯»æœªæäº¤&lt;br/&gt;ã€€ã€€ã€€&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; ISOLATION_READ_UNCOMMITTED =&lt;span&gt; Connection.TRANSACTION_READ_UNCOMMITTED;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è¯»å·²æäº¤&lt;br/&gt;ã€€ã€€  &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; ISOLATION_READ_COMMITTED =&lt;span&gt; Connection.TRANSACTION_READ_COMMITTED;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * å¯é‡å¤è¯»&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; ISOLATION_REPEATABLE_READ =&lt;span&gt; Connection.TRANSACTION_REPEATABLE_READ;

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * å¯ä¸²è¡ŒåŒ–&lt;br/&gt;ã€€ã€€ã€€&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; ISOLATION_SERIALIZABLE =&lt;span&gt; Connection.TRANSACTION_SERIALIZABLE;


    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * ä½¿ç”¨é»˜è®¤çš„è¶…æ—¶æ—¶é—´
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; TIMEOUT_DEFAULT = -1&lt;span&gt;;


    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è·å–äº‹ç‰©çš„ä¼ æ’­è¡Œä¸º&lt;br/&gt;&lt;/span&gt;&lt;span&gt;     */&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getPropagationBehavior();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è·å–äº‹ç‰©çš„éš”ç¦»çº§åˆ«&lt;br/&gt;ã€€ã€€ã€€&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getIsolationLevel();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è·å–äº‹ç‰©çš„è¶…æ—¶æ—¶é—´&lt;br/&gt;ã€€ã€€  &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt;&lt;span&gt; getTimeout();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * æ˜¯å¦ä¸ºåªè¯»äº‹ç‰©&lt;br/&gt;&lt;/span&gt;&lt;span&gt;     */&lt;/span&gt;
    &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isReadOnly();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è·å–å½“å‰äº‹ç‰©çš„åç§°&lt;br/&gt;&lt;/span&gt;&lt;span&gt;ã€€ã€€ã€€*/&lt;/span&gt;&lt;span&gt;
    String getName();

}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;ã€€ã€€3Â TransactionStatus äº‹åŠ¡è¿è¡ŒçŠ¶æ€&lt;/h3&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;interface&lt;/span&gt; TransactionStatus &lt;span&gt;extends&lt;/span&gt;&lt;span&gt; SavepointManager, Flushable {

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * æ˜¯å¦ä¸ºæ–°äº‹åŠ¡
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isNewTransaction();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * æ˜¯å¦æœ‰ä¿å­˜ç‚¹&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; hasSavepoint();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è®¾ç½®ä¸ºåªå›æ»š&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;void&lt;/span&gt;&lt;span&gt; setRollbackOnly();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * æ˜¯å¦ä¸ºåªå›æ»š
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isRollbackOnly();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * è®²ä¼šè¯åˆ·æ–°åˆ°æ•°æ®åº“ä¸­
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
    @Override
    &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt; flush();

    &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * å½“å‰äº‹åŠ¡æ˜¯å¦å·²ç»å®Œæˆ&lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
    &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isCompleted();

}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;ä¸‰ã€Springäº‹åŠ¡å¯åŠ¨è¿‡ç¨‹&lt;/h2&gt;
&lt;h3&gt;ã€€ã€€1Â @EnableTransactionManagement&lt;/h3&gt;
&lt;h4&gt;ã€€ã€€1.1 åœ¨ä¸»é…ç½®ç±»ä¸­æ·»åŠ @EnableTransactionManagementæ³¨è§£ï¼Œå¼€å¯Springäº‹åŠ¡çš„æ”¯æŒï¼Œé…ç½®å¦‚ä¸‹ï¼š&lt;/h4&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;@EnableTransactionManagement
@ComponentScan(basePackages &lt;/span&gt;= {&quot;com.toby&quot;&lt;span&gt;})
&lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; TransactionConfig {
    @Bean
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; DataSource dataSource() {
        DruidDataSource dataSource &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DruidDataSource();
        dataSource.setUsername(&lt;/span&gt;&quot;root&quot;&lt;span&gt;);
        dataSource.setPassword(&lt;/span&gt;&quot;123qwe&quot;&lt;span&gt;);
        dataSource.setUrl(&lt;/span&gt;&quot;jdbc:mysql://localhost:3306/demo_db?useUnicode=true&amp;amp;characterEncoding=utf-8&amp;amp;useSSL=false&quot;&lt;span&gt;);
        dataSource.setDriverClassName(&lt;/span&gt;&quot;com.mysql.jdbc.Driver&quot;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; dataSource;
    }

    @Bean
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; JdbcTemplate jdbcTemplate(DataSource dataSource) {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; JdbcTemplate(dataSource);
    }

    @Bean
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; PlatformTransactionManager transactionManager(DataSource dataSource) {
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DataSourceTransactionManager(dataSource);
    }
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;ã€€ã€€1.2 @EnableTransactionManagement åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ&lt;/h4&gt;
&lt;p&gt;ã€€ã€€æºç è§£æè·Ÿ&lt;strong&gt;&lt;span&gt;&lt;a href=&quot;https://www.cnblogs.com/toby-xu/p/11444288.html&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;Springç³»åˆ—ï¼ˆäº”ï¼‰ï¼šSpring AOPæºç è§£æ&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/strong&gt;ä¸­çš„@EnableAspectJAutoProxyæ³¨è§£ä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒä¸‹ã€‚ä¸»è¦ç»™Springå®¹å™¨åŠ å…¥å¦‚ä¸‹ç»„ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012213633172-1413922925.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;Â ã€€ã€€2Â InfrastructureAdvisorAutoProxyCreator&lt;span&gt;ï¼ˆé‡ç‚¹ï¼‰&lt;/span&gt;&lt;/h3&gt;
&lt;h4&gt;ã€€ã€€2.1 é¦–å…ˆçœ‹ä¸‹ç±»ç»§æ‰¿å›¾&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012213907676-2102553955.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h4&gt;Â ã€€ã€€2.2 å®ç°äº†InstantiationAwareBeanPostProcessoræ¥å£&lt;/h4&gt;
&lt;p&gt;ã€€ã€€è¯¥æ¥å£æœ‰2ä¸ªæ–¹æ³•postProcessBeforeInstantiationå’ŒpostProcessAfterInstantiationï¼Œå…¶ä¸­å®ä¾‹åŒ–ä¹‹å‰ä¼šæ‰§è¡ŒpostProcess BeforeInstantiationæ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;46&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; Object postProcessBeforeInstantiation(Class&amp;lt;?&amp;gt; beanClass, String beanName) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; BeansException {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ„å»ºæˆ‘ä»¬çš„ç¼“å­˜key&lt;/span&gt;
        Object cacheKey =&lt;span&gt; getCacheKey(beanClass, beanName);

        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!StringUtils.hasLength(beanName) || !&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.targetSourcedBeans.contains(beanName)) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¦‚æœè¢«è§£æè¿‡ç›´æ¥è¿”å›&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.containsKey(cacheKey)) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            }
            &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
             * åˆ¤æ–­æ˜¯ä¸æ˜¯åŸºç¡€çš„bean
             * åˆ¤æ–­æ˜¯ä¸æ˜¯åº”è¯¥è·³è¿‡ (æ­¤å¤„Spring Aopè§£æç›´æ¥è§£æå‡ºæˆ‘ä»¬çš„åˆ‡é¢ä¿¡æ¯(å¹¶ä¸”æŠŠæˆ‘ä»¬çš„åˆ‡é¢ä¿¡æ¯è¿›è¡Œç¼“å­˜)ï¼Œ&lt;br/&gt;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€* è€Œäº‹åŠ¡åœ¨è¿™é‡Œæ˜¯ä¸ä¼šè§£æçš„ï¼Œä¸ºä»€ä¹ˆï¼ŸåŸå› äº‹åŠ¡çš„è¯å·²ç»æŠŠäº‹åŠ¡æ‹¦æˆªå™¨é€šè¿‡@Beanï¼Œè€ŒAopçš„éœ€è¦å¯»æ‰¾)
             &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (isInfrastructureClass(beanClass) ||&lt;span&gt; shouldSkip(beanClass, beanName)) {
                &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.put(cacheKey, Boolean.FALSE);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            }
        }

        TargetSource targetSource &lt;/span&gt;=&lt;span&gt; getCustomTargetSource(beanClass, beanName);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (targetSource != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (StringUtils.hasLength(beanName)) {
                &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.targetSourcedBeans.add(beanName);
            }
            Object[] specificInterceptors &lt;/span&gt;=&lt;span&gt; getAdvicesAndAdvisorsForBean(beanClass, beanName, targetSource);
            Object proxy &lt;/span&gt;=&lt;span&gt; createProxy(beanClass, beanName, specificInterceptors, targetSource);
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.proxyTypes.put(cacheKey, proxy.getClass());
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; proxy;
        }

        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    }&lt;/span&gt;ã€€ã€€
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;ã€€ã€€2.3 å®ç°äº†BeanPostProcessoræ¥å£&lt;/h4&gt;
&lt;p&gt;Â ã€€ã€€è¯¥æ¥å£æœ‰2ä¸ªæ–¹æ³•postProcessBeforeInitializationå’ŒpostProcessAfterInitializationï¼Œå…¶ä¸­ç»„ä»¶åˆå§‹åŒ–ä¹‹åä¼šæ‰§è¡ŒpostProcessAfterInitializationï¼ˆè¯¥æ–¹æ³•åˆ›å»ºAopå’Œäº‹åŠ¡çš„ä»£ç†å¯¹è±¡ï¼‰æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
     * åœ¨è¯¥åç½®æ–¹æ³•ä¸­ æˆ‘ä»¬çš„äº‹åŠ¡å’Œaopçš„ä»£ç†å¯¹è±¡éƒ½æ˜¯åœ¨è¿™ç”Ÿæˆçš„
     * &lt;/span&gt;&lt;span&gt;@param&lt;/span&gt;&lt;span&gt; bean beanå®ä¾‹
     * &lt;/span&gt;&lt;span&gt;@param&lt;/span&gt;&lt;span&gt; beanName beançš„åç§°
     * &lt;/span&gt;&lt;span&gt;@return&lt;/span&gt;&lt;span&gt;
     * &lt;/span&gt;&lt;span&gt;@throws&lt;/span&gt;&lt;span&gt; BeansException
     &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
    @Override
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; Object postProcessAfterInitialization(@Nullable Object bean, String beanName) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; BeansException {
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (bean != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–ç¼“å­˜key&lt;/span&gt;
            Object cacheKey =&lt;span&gt; getCacheKey(bean.getClass(), beanName);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.earlyProxyReferences.remove(cacheKey) !=&lt;span&gt; bean) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¦‚æœæœ‰å¿…è¦å°±ä»£ç†&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt;&lt;span&gt; wrapIfNecessary(bean, beanName, cacheKey);
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; bean;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å»wrapIfNecessary(bean, beanName, cacheKey)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; Object wrapIfNecessary(Object bean, String beanName, Object cacheKey) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å·²ç»è¢«å¤„ç†è¿‡&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (StringUtils.hasLength(beanName) &amp;amp;&amp;amp; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.targetSourcedBeans.contains(beanName)) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; bean;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸éœ€è¦å¢å¼ºçš„&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (Boolean.FALSE.equals(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.get(cacheKey))) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; bean;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ˜¯ä¸æ˜¯åŸºç¡€çš„bean æ˜¯ä¸æ˜¯éœ€è¦è·³è¿‡çš„&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (isInfrastructureClass(bean.getClass()) ||&lt;span&gt; shouldSkip(bean.getClass(), beanName)) {
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.put(cacheKey, Boolean.FALSE);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; bean;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¦‚æœæœ‰åŒ¹é…çš„é€šçŸ¥,å°±åˆ›å»ºä»£ç†å¯¹è±¡&lt;/span&gt;
        Object[] specificInterceptors = getAdvicesAndAdvisorsForBean(bean.getClass(), beanName, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¦‚æœä¸ä¸ºç©ºï¼Œè¡¨è¿°éœ€è¦ä»£ç†&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (specificInterceptors !=&lt;span&gt; DO_NOT_PROXY) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è®¾ç½®å½“å‰çš„å¯¹è±¡å·²å¤„ç†&lt;/span&gt;
            &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.put(cacheKey, Boolean.TRUE);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºæˆ‘ä»¬çš„çœŸæ­£çš„ä»£ç†å¯¹è±¡&lt;/span&gt;
            Object proxy =&lt;span&gt; createProxy(
                    bean.getClass(), beanName, specificInterceptors, &lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; SingletonTargetSource(bean));
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åŠ å…¥åˆ°ç¼“å­˜&lt;/span&gt;
            &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.proxyTypes.put(cacheKey, proxy.getClass());
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; proxy;
        }

        &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advisedBeans.put(cacheKey, Boolean.FALSE);
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; bean;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥getAdvicesAndAdvisorsForBean(bean.getClass(), beanName, null)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; Object[] getAdvicesAndAdvisorsForBean(
            Class&lt;/span&gt;&amp;lt;?&amp;gt;&lt;span&gt; beanClass, String beanName, @Nullable TargetSource targetSource) {
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * æ‰¾åˆé€‚çš„å¢å¼ºå™¨å¯¹è±¡
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
        List&lt;/span&gt;&amp;lt;Advisor&amp;gt; advisors =&lt;span&gt; findEligibleAdvisors(beanClass, beanName);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥åˆé€‚çš„é€šçŸ¥å™¨ä¸ºç©º&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (advisors.isEmpty()) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; DO_NOT_PROXY;
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; advisors.toArray();
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥findEligibleAdvisors(beanClass, beanName)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; List&amp;lt;Advisor&amp;gt; findEligibleAdvisors(Class&amp;lt;?&amp;gt;&lt;span&gt; beanClass, String beanName) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ‰¾åˆ°Spring IoCå®¹å™¨ä¸­æ‰€æœ‰çš„å€™é€‰é€šçŸ¥ åŒ…æ‹¬Aopçš„å’Œäº‹åŠ¡çš„&lt;/span&gt;
        List&amp;lt;Advisor&amp;gt; candidateAdvisors =&lt;span&gt; findCandidateAdvisors();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­æ‰¾åˆ°çš„é€šçŸ¥èƒ½ä¸èƒ½ä½œç”¨åˆ°å½“å‰çš„ç±»ä¸Š&lt;/span&gt;
        List&amp;lt;Advisor&amp;gt; eligibleAdvisors =&lt;span&gt; findAdvisorsThatCanApply(candidateAdvisors, beanClass, beanName);
        extendAdvisors(eligibleAdvisors);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¯¹æˆ‘ä»¬çš„advisorè¿›è¡Œæ’åº&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;eligibleAdvisors.isEmpty()) {
            eligibleAdvisors &lt;/span&gt;=&lt;span&gt; sortAdvisors(eligibleAdvisors);
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; eligibleAdvisors;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;â‘  è¿›å…¥findCandidateAdvisors()æ–¹æ³•ï¼Œé€šè¿‡å¢å¼ºå™¨æ£€ç´¢å™¨æ£€ç´¢å¢å¼ºå™¨ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012222001817-590136552.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€è¿›å…¥findAdvisorBeans()æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; List&amp;lt;Advisor&amp;gt;&lt;span&gt; findAdvisorBeans() {

        &lt;/span&gt;&lt;span&gt;String[] advisorNames &lt;/span&gt;= &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.cachedAdvisorBeanNames;
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (advisorNames == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
             * å»å®¹å™¨ä¸­è·å–åˆ°å®ç°äº†Advisoræ¥å£çš„å®ç°ç±» æˆ‘ä»¬çš„äº‹åŠ¡æ³¨è§£@EnableTransactionManagementå¯¼å…¥äº†ä¸€ä¸ªå«ProxyTransactionManagementConfigurationé…ç½®ç±»
             * è€Œåœ¨è¿™ä¸ªé…ç½®ç±»ä¸­é…ç½®äº†ï¼š
             * @Bean(name = TransactionManagementConfigUtils.TRANSACTION_ADVISOR_BEAN_NAME)
             * @Role(BeanDefinition.ROLE_INFRASTRUCTURE)
             * public BeanFactoryTransactionAttributeSourceAdvisor transactionAdvisor();
             * ç„¶åæŠŠä»–çš„åå­—è·å–å‡ºæ¥ä¿å­˜åˆ° æœ¬ç±»çš„å±æ€§å˜é‡cachedAdvisorBeanNamesä¸­
             &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
            advisorNames &lt;/span&gt;=&lt;span&gt; BeanFactoryUtils.beanNamesForTypeIncludingAncestors(
                    &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.beanFactory, Advisor.&lt;span&gt;class&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;.cachedAdvisorBeanNames =&lt;span&gt; advisorNames;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥åœ¨å®¹å™¨ä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªç©ºçš„é›†åˆ&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (advisorNames.length == 0&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
        }

        List&lt;/span&gt;&amp;lt;Advisor&amp;gt; advisors = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®¹å™¨ä¸­æ‰¾åˆ°äº†æˆ‘ä»¬äº‹åŠ¡é…ç½®çš„BeanFactoryTransactionAttributeSourceAdvisor&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (String name : advisorNames) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­ä»–æ˜¯ä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isEligibleBean(name)) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;BeanFactoryTransactionAttributeSourceAdvisoræ˜¯ä¸æ˜¯æ­£åœ¨åˆ›å»ºçš„Bean&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.beanFactory.isCurrentlyInCreation(name)) {
                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                        logger.debug(&lt;/span&gt;&quot;Skipping currently created advisor '&quot; + name + &quot;'&quot;&lt;span&gt;);
                    }
                }
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸æ˜¯çš„è¯&lt;/span&gt;
                &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                    &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ˜¾ç¤ºçš„è°ƒç”¨getBeanæ–¹æ³•æ–¹æ³•åˆ›å»ºæˆ‘ä»¬çš„BeanFactoryTransactionAttributeSourceAdvisorè¿”å›å»&lt;/span&gt;
                        advisors.add(&lt;span&gt;this&lt;/span&gt;.beanFactory.getBean(name, Advisor.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;));
                    }
                    &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (BeanCreationException ex) {
                        Throwable rootCause &lt;/span&gt;=&lt;span&gt; ex.getMostSpecificCause();
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (rootCause &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; BeanCurrentlyInCreationException) {
                            BeanCreationException bce &lt;/span&gt;=&lt;span&gt; (BeanCreationException) rootCause;
                            String bceBeanName &lt;/span&gt;=&lt;span&gt; bce.getBeanName();
                            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (bceBeanName != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.beanFactory.isCurrentlyInCreation(bceBeanName)) {
                                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                                    logger.debug(&lt;/span&gt;&quot;Skipping advisor '&quot; + name +
                                            &quot;' with dependency on currently created bean: &quot; +&lt;span&gt; ex.getMessage());
                                }
                                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Ignore: indicates a reference back to the bean we're trying to advise.
                                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; We want to find advisors other than the currently created bean itself.&lt;/span&gt;
                                &lt;span&gt;continue&lt;/span&gt;&lt;span&gt;;
                            }
                        }
                        &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex;
                    }
                }
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; advisors;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥åˆ°isEligibleBean(name)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012222848298-24636502.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€è¿›å…¥isEligibleAdvisorBean(beanName)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isEligibleAdvisorBean(String beanName) {
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * å®¹å™¨ä¸­åŒ…å«äº†è¿™ä¸ªBeanå®šä¹‰ï¼Œå¹¶ä¸”Beanå®šä¹‰çš„è§’è‰²ä¸ºBeanDefinition.ROLE_INFRASTRUCTURE
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.beanFactory != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &lt;span&gt;this&lt;/span&gt;.beanFactory.containsBeanDefinition(beanName) &amp;amp;&amp;amp;
                &lt;span&gt;this&lt;/span&gt;.beanFactory.getBeanDefinition(beanName).getRole() ==&lt;span&gt; BeanDefinition.ROLE_INFRASTRUCTURE);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;&lt;span&gt;å¦‚æœæ˜¯åˆé€‚çš„å°±ä¿å­˜åœ¨advisorsä¸­å¹¶è¿”å›ï¼›è‡³æ­¤findCandidateAdvisors()æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h4&gt;ã€€ã€€â‘¡ æ‰¾åˆ°çš„å¢å¼ºå™¨æ˜¯å¦èƒ½ä½œç”¨åœ¨å½“å‰çš„ç±»ä¸Šï¼ŒfindAdvisorsThatCanApply(candidateAdvisors, beanClass, beanName)æ–¹æ³•ï¼š&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012223847888-1398024872.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€è¿›å…¥åˆ°AopUtils.findAdvisorsThatCanApply(candidateAdvisors, beanClass)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; List&amp;lt;Advisor&amp;gt; findAdvisorsThatCanApply(List&amp;lt;Advisor&amp;gt; candidateAdvisors, Class&amp;lt;?&amp;gt;&lt;span&gt; clazz) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥å€™é€‰çš„å¢å¼ºå™¨é›†åˆä¸ºç©ºç›´æ¥è¿”å›&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (candidateAdvisors.isEmpty()) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; candidateAdvisors;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å®šä¹‰ä¸€ä¸ªåˆé€‚çš„å¢å¼ºå™¨é›†åˆå¯¹è±¡&lt;/span&gt;
        List&amp;lt;Advisor&amp;gt; eligibleAdvisors = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¾ªç¯æˆ‘ä»¬å€™é€‰çš„å¢å¼ºå™¨å¯¹è±¡&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Advisor candidate : candidateAdvisors) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­æˆ‘ä»¬çš„å¢å¼ºå™¨å¯¹è±¡æ˜¯ä¸æ˜¯å®ç°äº†IntroductionAdvisor (å¾ˆæ˜æ˜¾æˆ‘ä»¬äº‹åŠ¡çš„æ²¡æœ‰å®ç° æ‰€ä»¥ä¸ä¼šèµ°ä¸‹é¢çš„é€»è¾‘)&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (candidate &lt;span&gt;instanceof&lt;/span&gt; IntroductionAdvisor &amp;amp;&amp;amp;&lt;span&gt; canApply(candidate, clazz)) {
                eligibleAdvisors.add(candidate);
            }
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸ä¸ºç©º&lt;/span&gt;
        &lt;span&gt;boolean&lt;/span&gt; hasIntroductions = !&lt;span&gt;eligibleAdvisors.isEmpty();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Advisor candidate : candidateAdvisors) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­æˆ‘ä»¬çš„å¢å¼ºå™¨å¯¹è±¡æ˜¯ä¸æ˜¯å®ç°äº†IntroductionAdvisor (å¾ˆæ˜æ˜¾æˆ‘ä»¬äº‹åŠ¡çš„æ²¡æœ‰å®ç° æ‰€ä»¥ä¸ä¼šèµ°ä¸‹é¢çš„é€»è¾‘)&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (candidate &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; IntroductionAdvisor) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åœ¨ä¸Šé¢å·²ç»å¤„ç†è¿‡ ï¼Œä¸éœ€è¦å¤„ç†&lt;/span&gt;
                &lt;span&gt;continue&lt;/span&gt;&lt;span&gt;;
            }
            &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
             * çœŸæ­£çš„åˆ¤æ–­å¢å¼ºå™¨æ˜¯å¦åˆé€‚å½“å‰ç±»
             &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (canApply(candidate, clazz, hasIntroductions)) {
                eligibleAdvisors.add(candidate);
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; eligibleAdvisors;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€çœŸæ­£çš„åˆ¤æ–­å¢å¼ºå™¨æ˜¯å¦åˆé€‚å½“å‰ç±»ï¼ŒcanApply(candidate, clazz, hasIntroductions)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; canApply(Advisor advisor, Class&amp;lt;?&amp;gt; targetClass, &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; hasIntroductions) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­æˆ‘ä»¬çš„å¢å¼ºå™¨ IntroductionAdvisor&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (advisor &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; IntroductionAdvisor) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; ((IntroductionAdvisor) advisor).getClassFilter().matches(targetClass);
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­æˆ‘ä»¬äº‹åŠ¡çš„å¢å¼ºå™¨BeanFactoryTransactionAttributeSourceAdvisoræ˜¯å¦å®ç°äº†PointcutAdvisor&lt;/span&gt;
        &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (advisor &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; PointcutAdvisor) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è½¬ä¸ºPointcutAdvisorç±»å‹&lt;/span&gt;
            PointcutAdvisor pca =&lt;span&gt; (PointcutAdvisor) advisor;
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ‰¾åˆ°çœŸæ­£èƒ½ç”¨çš„å¢å¼ºå™¨&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; canApply(pca.getPointcut(), targetClass, hasIntroductions);
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; It doesn't have a pointcut so we assume it applies.&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€æ‰¾åˆ°çœŸæ­£èƒ½ç”¨çš„å¢å¼ºå™¨ï¼ŒcanApply(pca.getPointcut(), targetClass, hasIntroductions)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; canApply(Pointcut pc, Class&amp;lt;?&amp;gt; targetClass, &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; hasIntroductions) {
        Assert.notNull(pc, &lt;/span&gt;&quot;Pointcut must not be null&quot;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;pc.getClassFilter().matches(targetClass)) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * é€šè¿‡åˆ‡ç‚¹è·å–åˆ°ä¸€ä¸ªæ–¹æ³•åŒ¹é…å™¨å¯¹è±¡
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
        MethodMatcher methodMatcher &lt;/span&gt;=&lt;span&gt; pc.getMethodMatcher();
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (methodMatcher ==&lt;span&gt; MethodMatcher.TRUE) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; No need to iterate the methods if we're matching any method anyway...&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­åŒ¹é…å™¨æ˜¯ä¸æ˜¯IntroductionAwareMethodMatcher&lt;/span&gt;
        IntroductionAwareMethodMatcher introductionAwareMethodMatcher = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (methodMatcher &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; IntroductionAwareMethodMatcher) {
            introductionAwareMethodMatcher &lt;/span&gt;=&lt;span&gt; (IntroductionAwareMethodMatcher) methodMatcher;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªé›†åˆç”¨äºä¿å­˜targetClassçš„classå¯¹è±¡&lt;/span&gt;
        Set&amp;lt;Class&amp;lt;?&amp;gt;&amp;gt; classes = &lt;span&gt;new&lt;/span&gt; LinkedHashSet&amp;lt;&amp;gt;&lt;span&gt;();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­å½“å‰classæ˜¯ä¸æ˜¯ä»£ç†çš„classå¯¹è±¡&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;Proxy.isProxyClass(targetClass)) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åŠ å…¥åˆ°é›†åˆä¸­å»&lt;/span&gt;
&lt;span&gt;            classes.add(ClassUtils.getUserClass(targetClass));
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–åˆ°targetClassæ‰€å®ç°çš„æ¥å£çš„classå¯¹è±¡ï¼Œç„¶ååŠ å…¥åˆ°é›†åˆä¸­&lt;/span&gt;
&lt;span&gt;        classes.addAll(ClassUtils.getAllInterfacesForClassAsSet(targetClass));

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¾ªç¯æ‰€æœ‰çš„classå¯¹è±¡&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (Class&amp;lt;?&amp;gt;&lt;span&gt; clazz : classes) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡classè·å–åˆ°æ‰€æœ‰çš„æ–¹æ³•&lt;/span&gt;
            Method[] methods =&lt;span&gt; ReflectionUtils.getAllDeclaredMethods(clazz);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¾ªç¯æˆ‘ä»¬çš„æ–¹æ³•&lt;/span&gt;
            &lt;span&gt;for&lt;/span&gt;&lt;span&gt; (Method method : methods) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡methodMatcher.matchesæ¥åŒ¹é…æˆ‘ä»¬çš„æ–¹æ³•&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (introductionAwareMethodMatcher != &lt;span&gt;null&lt;/span&gt; ?&lt;span&gt;
                        introductionAwareMethodMatcher.matches(method, targetClass, hasIntroductions) :
                        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡æ–¹æ³•åŒ¹é…å™¨è¿›è¡ŒåŒ¹é…&lt;/span&gt;
&lt;span&gt;                        methodMatcher.matches(method, targetClass)) {
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
                }
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥methodMatcher.matches(method, targetClass)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt; matches(Method method, @Nullable Class&amp;lt;?&amp;gt;&lt;span&gt; targetClass) {
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (targetClass != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; TransactionalProxy.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;.isAssignableFrom(targetClass)) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
        }
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * è·å–æˆ‘ä»¬@EnableTransactionManagementæ³¨è§£ä¸ºæˆ‘ä»¬å®¹å™¨ä¸­å¯¼å…¥çš„ProxyTransactionManagementConfiguration
         * é…ç½®ç±»ä¸­çš„TransactionAttributeSourceå¯¹è±¡
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
        TransactionAttributeSource tas &lt;/span&gt;=&lt;span&gt; getTransactionAttributeSource();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥äº‹åŠ¡å±æ€§åŸä¸ºnullæˆ–è€… è§£æå‡ºæ¥çš„äº‹åŠ¡æ³¨è§£å±æ€§ä¸ä¸ºç©º    è¡¨ç¤ºæ–¹æ³•åŒ¹é…&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt; (tas == &lt;span&gt;null&lt;/span&gt; || tas.getTransactionAttribute(method, targetClass) != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥åˆ°è·å–äº‹åŠ¡æ³¨è§£å±æ€§tas.getTransactionAttribute(method, targetClass)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; TransactionAttribute getTransactionAttribute(Method method, @Nullable Class&amp;lt;?&amp;gt;&lt;span&gt; targetClass) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­methodæ‰€åœ¨çš„class æ˜¯ä¸æ˜¯Objectç±»å‹&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (method.getDeclaringClass() == Object.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ„å»ºæˆ‘ä»¬çš„ç¼“å­˜key&lt;/span&gt;
        Object cacheKey =&lt;span&gt; getCacheKey(method, targetClass);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å…ˆå»æˆ‘ä»¬çš„ç¼“å­˜ä¸­è·å–&lt;/span&gt;
        TransactionAttribute cached = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.attributeCache.get(cacheKey);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç¼“å­˜ä¸­ä¸ä¸ºç©º&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (cached != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­ç¼“å­˜ä¸­çš„å¯¹è±¡æ˜¯ä¸æ˜¯ç©ºäº‹åŠ¡å±æ€§çš„å¯¹è±¡&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (cached ==&lt;span&gt; NULL_TRANSACTION_ATTRIBUTE) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; cached;
            }
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŸ¥æ‰¾æˆ‘ä»¬çš„äº‹åŠ¡æ³¨è§£&lt;/span&gt;
            TransactionAttribute txAttr =&lt;span&gt; computeTransactionAttribute(method, targetClass);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥è§£æå‡ºæ¥çš„äº‹åŠ¡æ³¨è§£å±æ€§ä¸ºç©º&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (txAttr == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¾€ç¼“å­˜ä¸­å­˜æ”¾ç©ºäº‹åŠ¡æ³¨è§£å±æ€§&lt;/span&gt;
                &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.attributeCache.put(cacheKey, NULL_TRANSACTION_ATTRIBUTE);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æˆ‘ä»¬æ‰§è¡Œæ–¹æ³•çš„æè¿°ç¬¦ åŒ…å+ç±»å+æ–¹æ³•å&lt;/span&gt;
                String methodIdentification =&lt;span&gt; ClassUtils.getQualifiedMethodName(method, targetClass);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠæ–¹æ³•æè¿°è®¾ç½®åˆ°äº‹åŠ¡å±æ€§ä¸Šå»&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (txAttr &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; DefaultTransactionAttribute) {
                    ((DefaultTransactionAttribute) txAttr).setDescriptor(methodIdentification);
                }
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                    logger.debug(&lt;/span&gt;&quot;Adding transactional method '&quot; + methodIdentification + &quot;' with attribute: &quot; +&lt;span&gt; txAttr);
                }
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åŠ å…¥åˆ°ç¼“å­˜&lt;/span&gt;
                &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.attributeCache.put(cacheKey, txAttr);
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txAttr;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥æŸ¥æ‰¾æˆ‘ä»¬çš„äº‹åŠ¡æ³¨è§£ï¼ŒcomputeTransactionAttribute(method, targetClass)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;39&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; TransactionAttribute computeTransactionAttribute(Method method, @Nullable Class&amp;lt;?&amp;gt;&lt;span&gt; targetClass) {
        &lt;/span&gt;&lt;span&gt;//åˆ¤æ–­&lt;/span&gt;&lt;span&gt;æˆ‘ä»¬çš„äº‹åŠ¡æ–¹æ³•ä¸Šçš„ä¿®é¥°ç¬¦æ˜¯ä¸æ˜¯publicçš„&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (allowPublicMethodsOnly() &amp;amp;&amp;amp; !&lt;span&gt;Modifier.isPublic(method.getModifiers())) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; The method may be on an interface, but we need attributes from the target class.
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; If the target class is null, the method will be unchanged.&lt;/span&gt;
        Method specificMethod =&lt;span&gt; AopUtils.getMostSpecificMethod(method, targetClass);

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç¬¬ä¸€ï¼šå…ˆå»ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ä¸Šå»æ‰¾æˆ‘ä»¬çš„äº‹åŠ¡æ³¨è§£&lt;/span&gt;
        TransactionAttribute txAttr =&lt;span&gt; findTransactionAttribute(specificMethod);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txAttr;
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç¬¬äºŒï¼šå»ç›®æ ‡å¯¹è±¡ä¸Šæ‰¾äº‹åŠ¡æ³¨è§£&lt;/span&gt;
        txAttr =&lt;span&gt; findTransactionAttribute(specificMethod.getDeclaringClass());
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp;&lt;span&gt; ClassUtils.isUserLevelMethod(method)) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txAttr;
        }

        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (specificMethod !=&lt;span&gt; method) {
            &lt;/span&gt;&lt;span&gt;//ç¬¬ä¸‰ï¼š&lt;/span&gt;&lt;span&gt;å»æˆ‘ä»¬çš„å®ç°ç±»çš„æ¥å£ä¸Šçš„æ–¹æ³•å»æ‰¾äº‹åŠ¡æ³¨è§£&lt;/span&gt;
            txAttr =&lt;span&gt; findTransactionAttribute(method);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txAttr;
            }
            &lt;/span&gt;&lt;span&gt;//ç¬¬å››ï¼š&lt;/span&gt;&lt;span&gt;å»æˆ‘ä»¬çš„å®ç°ç±»çš„æ¥å£ä¸Šå»æ‰¾äº‹åŠ¡æ³¨è§£&lt;/span&gt;
            txAttr =&lt;span&gt; findTransactionAttribute(method.getDeclaringClass());
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp;&lt;span&gt; ClassUtils.isUserLevelMethod(method)) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txAttr;
            }
        }

        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥åˆ°æ‰¾@Transactionalæ³¨è§£ï¼ŒfindTransactionAttribute(specificMethod)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012225518155-1970592922.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€è¿›å…¥determineTransactionAttribute(method)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; TransactionAttribute determineTransactionAttribute(AnnotatedElement element) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬çš„æ³¨è§£è§£æå™¨&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (TransactionAnnotationParser annotationParser : &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.annotationParsers) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡æ³¨è§£è§£æå™¨å»è§£ææˆ‘ä»¬çš„å…ƒç´ (æ–¹æ³•æˆ–è€…ç±»)ä¸Šçš„æ³¨è§£&lt;/span&gt;
            TransactionAttribute attr =&lt;span&gt; annotationParser.parseTransactionAnnotation(element);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (attr != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; attr;
            }
        }
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥annotationParser.parseTransactionAnnotation(element)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt;&lt;span&gt; TransactionAttribute parseTransactionAnnotation(AnnotatedElement element) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä»elementå¯¹è±¡ä¸­è·å–@Transactionalæ³¨è§£ ç„¶åæŠŠæ³¨è§£å±æ€§å°è£…åˆ°äº†AnnotationAttributes&lt;/span&gt;
        AnnotationAttributes attributes =&lt;span&gt; AnnotatedElementUtils.findMergedAnnotationAttributes(
                element, Transactional.&lt;/span&gt;&lt;span&gt;class&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (attributes != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æå‡ºçœŸæ­£çš„äº‹åŠ¡å±æ€§å¯¹è±¡&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; parseTransactionAnnotation(attributes);
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥åˆ°è§£æå‡ºçœŸæ­£çš„äº‹åŠ¡å±æ€§å¯¹è±¡ï¼ŒparseTransactionAnnotation(attributes)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; TransactionAttribute parseTransactionAnnotation(AnnotationAttributes attributes) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªåŸºç¡€è§„åˆ™çš„äº‹åŠ¡å±æ€§å¯¹è±¡&lt;/span&gt;
        RuleBasedTransactionAttribute rbta = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RuleBasedTransactionAttribute();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æ@Transactionlä¸Šçš„ä¼ æ’­è¡Œä¸º&lt;/span&gt;
        Propagation propagation = attributes.getEnum(&quot;propagation&quot;&lt;span&gt;);
        rbta.setPropagationBehavior(propagation.value());
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æ@Transactionlä¸Šçš„éš”ç¦»çº§åˆ«&lt;/span&gt;
        Isolation isolation = attributes.getEnum(&quot;isolation&quot;&lt;span&gt;);
        rbta.setIsolationLevel(isolation.value());
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æ@Transactionlä¸Šçš„äº‹åŠ¡è¶…æ—¶äº‹ä»¶&lt;/span&gt;
        rbta.setTimeout(attributes.getNumber(&quot;timeout&quot;&lt;span&gt;).intValue());
        rbta.setReadOnly(attributes.getBoolean(&lt;/span&gt;&quot;readOnly&quot;&lt;span&gt;));
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æ@Transactionlä¸Šçš„äº‹åŠ¡ç®¡ç†å™¨çš„åç§°&lt;/span&gt;
        rbta.setQualifier(attributes.getString(&quot;value&quot;&lt;span&gt;));

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è§£æé’ˆå¯¹å“ªç§å¼‚å¸¸å›æ»š&lt;/span&gt;
        List&amp;lt;RollbackRuleAttribute&amp;gt; rollbackRules = &lt;span&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;&lt;span&gt;();
        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt; (Class&amp;lt;?&amp;gt; rbRule : attributes.getClassArray(&quot;rollbackFor&quot;&lt;span&gt;)) {
            rollbackRules.add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; RollbackRuleAttribute(rbRule));
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¯¹å“ªç§å¼‚å¸¸è¿›è¡Œå›æ»š&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (String rbRule : attributes.getStringArray(&quot;rollbackForClassName&quot;&lt;span&gt;)) {
            rollbackRules.add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; RollbackRuleAttribute(rbRule));
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¯¹å“ªç§å¼‚å¸¸ä¸å›æ»š&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (Class&amp;lt;?&amp;gt; rbRule : attributes.getClassArray(&quot;noRollbackFor&quot;&lt;span&gt;)) {
            rollbackRules.add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; NoRollbackRuleAttribute(rbRule));
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¯¹å“ªç§ç±»å‹ä¸å›æ»š&lt;/span&gt;
        &lt;span&gt;for&lt;/span&gt; (String rbRule : attributes.getStringArray(&quot;noRollbackForClassName&quot;&lt;span&gt;)) {
            rollbackRules.add(&lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt; NoRollbackRuleAttribute(rbRule));
        }
        rbta.setRollbackRules(rollbackRules);

        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; rbta;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Â ã€€ã€€&lt;strong&gt;&lt;span&gt;è‡³æ­¤computeTransactionAttribute(method, targetClass)æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012225953438-1425094167.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€ç„¶åæŠŠæˆ‘ä»¬æ‰§è¡Œæ–¹æ³•çš„æè¿°ç¬¦è®¾ç½®åˆ°TransactionAttributeäº‹åŠ¡å±æ€§ä¸­ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•éœ€è¦æ‰§è¡ŒSpringäº‹åŠ¡ï¼Œå¹¶æŠŠäº‹åŠ¡æ³¨è§£å±æ€§åŠ å…¥åˆ°ç¼“å­˜attributeCacheä¸­ï¼Œ&lt;strong&gt;&lt;span&gt;è‡³æ­¤è·å–äº‹åŠ¡æ³¨è§£å±æ€§tas.getTransactionAttributeå®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¦‚æœcanApplyæ–¹æ³•è¿”å›trueè¡¨ç¤ºæ‰¾åˆ°çœŸæ­£èƒ½ç”¨çš„å¢å¼ºå™¨äº†ï¼Œç„¶åå°±æŠŠåˆé€‚çš„å¢å¼ºå™¨åŠ å…¥åˆ°eligibleAdvisorsä¸­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012231359590-119867190.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€&lt;strong&gt;&lt;span&gt;è‡³æ­¤findAdvisorsThatCanApply(candidateAdvisors, beanClass, beanName)æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012232007018-1681254033.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€&lt;strong&gt;â‘¢Â extendAdvisors(eligibleAdvisors) æ‰©å±•å¢å¼ºå™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€ â‘£ sortAdvisors(eligibleAdvisors) æ’åº&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;å…¶ä¸­â‘¢ï¼Œâ‘£ ç•¥ å…·ä½“å‚è€ƒ&lt;span&gt;&lt;strong&gt;&lt;a href=&quot;https://www.cnblogs.com/toby-xu/p/11444288.html&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;Springç³»åˆ—ï¼ˆäº”ï¼‰ï¼šSpring AOPæºç è§£æ&lt;/span&gt;&lt;/a&gt;&lt;/strong&gt;&lt;span&gt;ï¼Œå…¶å®äº‹åŠ¡æ‰¾å¢å¼ºå™¨ç›¸å¯¹Aopç®€å•å¾ˆå¤šï¼Œ&lt;strong&gt;&lt;span&gt;åˆ°æ­¤findEligibleAdvisors(beanClass, beanName)æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012232934141-1966255247.png&quot; alt=&quot;&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012232822761-1941844900.png&quot; alt=&quot;&quot; width=&quot;967&quot; height=&quot;395&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€&lt;strong&gt;&lt;span&gt;åˆ°æ­¤Springäº‹åŠ¡åˆ›å»ºä»£ç†å¯¹è±¡å®Œæ¯•ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Â å››ã€Springäº‹åŠ¡ä»£ç†è°ƒç”¨è¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191012234016937-1109050985.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;Â ã€€ã€€ç¬¬ä¸€æ­¥ï¼šæ‰§è¡ŒaddUser(user)æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;ã€€ã€€å…¶å®å°±æ˜¯è°ƒç”¨org.springframework.aop.framework.JdkDynamicAopProxy#invoke&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;48&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; Object invoke(Object proxy, Method method, Object[] args) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; Throwable {
        Object oldProxy &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; setProxyContext = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–åˆ°æˆ‘ä»¬çš„ç›®æ ‡å¯¹è±¡&lt;/span&gt;
        TargetSource targetSource = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advised.targetSource;
        Object target &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥æ˜¯equalsæ–¹æ³•ä¸éœ€è¦ä»£ç†&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;this&lt;/span&gt;.equalsDefined &amp;amp;&amp;amp;&lt;span&gt; AopUtils.isEqualsMethod(method)) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; The target does not implement the equals(Object) method itself.&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt; equals(args[0&lt;span&gt;]);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥æ˜¯hashCodeæ–¹æ³•ä¸éœ€è¦ä»£ç†&lt;/span&gt;
            &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;this&lt;/span&gt;.hashCodeDefined &amp;amp;&amp;amp;&lt;span&gt; AopUtils.isHashCodeMethod(method)) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; The target does not implement the hashCode() method itself.&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt;&lt;span&gt; hashCode();
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥æ˜¯DecoratingProxyä¹Ÿä¸è¦æ‹¦æˆªå™¨æ‰§è¡Œ&lt;/span&gt;
            &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (method.getDeclaringClass() == DecoratingProxy.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; There is only getDecoratedClass() declared -&amp;gt; dispatch to proxy config.&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt; AopProxyUtils.ultimateTargetClass(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advised);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;this&lt;/span&gt;.advised.opaque &amp;amp;&amp;amp; method.getDeclaringClass().isInterface() &amp;amp;&amp;amp;&lt;span&gt;
                    method.getDeclaringClass().isAssignableFrom(Advised.&lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Service invocations on ProxyConfig with the proxy config...&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt; AopUtils.invokeJoinpointUsingReflection(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advised, method, args);
            }

            Object retVal;

            &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
             * è¿™ä¸ªé…ç½®æ˜¯æš´éœ²æˆ‘ä»¬çš„ä»£ç†å¯¹è±¡åˆ°çº¿ç¨‹å˜é‡ä¸­ï¼Œéœ€è¦æ­é…@EnableAspectJAutoProxy(exposeProxy = true)ä¸€èµ·ä½¿ç”¨
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ * æ¯”å¦‚åœ¨ç›®æ ‡å¯¹è±¡æ–¹æ³•ä¸­å†æ¬¡è·å–ä»£ç†å¯¹è±¡å¯ä»¥ä½¿ç”¨è¿™ä¸ªAopContext.currentProxy()
             * è¿˜æœ‰çš„å°±æ˜¯äº‹åŠ¡æ–¹æ³•è°ƒç”¨äº‹åŠ¡æ–¹æ³•çš„æ—¶å€™ä¹Ÿæ˜¯ç”¨åˆ°è¿™ä¸ª
             &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advised.exposeProxy) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠæˆ‘ä»¬çš„ä»£ç†å¯¹è±¡æš´éœ²åˆ°çº¿ç¨‹å˜é‡ä¸­&lt;/span&gt;
                oldProxy =&lt;span&gt; AopContext.setCurrentProxy(proxy);
                setProxyContext &lt;/span&gt;= &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬çš„ç›®æ ‡å¯¹è±¡&lt;/span&gt;
            target =&lt;span&gt; targetSource.getTarget();
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬ç›®æ ‡å¯¹è±¡çš„class&lt;/span&gt;
            Class&amp;lt;?&amp;gt; targetClass = (target != &lt;span&gt;null&lt;/span&gt; ? target.getClass() : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠaopçš„advisorè½¬åŒ–ä¸ºæ‹¦æˆªå™¨é“¾&lt;/span&gt;
            List&amp;lt;Object&amp;gt; chain = &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass);

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¦‚æœæ‹¦æˆªå™¨é“¾ä¸ºç©º&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (chain.isEmpty()) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡åå°„ç›´æ¥è°ƒç”¨æ‰§è¡Œ&lt;/span&gt;
                Object[] argsToUse =&lt;span&gt; AopProxyUtils.adaptArgumentsIfNecessary(method, args);
                retVal &lt;/span&gt;=&lt;span&gt; AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¯¹è±¡&lt;/span&gt;
                MethodInvocation invocation =
                        &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è°ƒç”¨æ‰§è¡Œ&lt;/span&gt;
                retVal =&lt;span&gt; invocation.proceed();
            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Massage return value if necessary.&lt;/span&gt;
            Class&amp;lt;?&amp;gt; returnType =&lt;span&gt; method.getReturnType();
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (retVal != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; retVal == target &amp;amp;&amp;amp;&lt;span&gt;
                    returnType &lt;/span&gt;!= Object.&lt;span&gt;class&lt;/span&gt; &amp;amp;&amp;amp; returnType.isInstance(proxy) &amp;amp;&amp;amp;
                    !RawTargetAccess.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;.isAssignableFrom(method.getDeclaringClass())) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Special case: it returned &quot;this&quot; and the return type of the method
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; is type-compatible. Note that we can't help if the target sets
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; a reference to itself in another returned object.&lt;/span&gt;
                retVal =&lt;span&gt; proxy;
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (retVal == &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; returnType != Void.TYPE &amp;amp;&amp;amp;&lt;span&gt; returnType.isPrimitive()) {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; AopInvocationException(
                        &lt;/span&gt;&quot;Null return value from advice does not match primitive return type for: &quot; +&lt;span&gt; method);
            }
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; retVal;
        }
        &lt;/span&gt;&lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (target != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !&lt;span&gt;targetSource.isStatic()) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Must have come from TargetSource.&lt;/span&gt;
&lt;span&gt;                targetSource.releaseTarget(target);
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (setProxyContext) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Restore old proxy.&lt;/span&gt;
&lt;span&gt;                AopContext.setCurrentProxy(oldProxy);
            }
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€ è¿›å…¥åˆ°invocation.proceed()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„è°ƒç”¨ç”¨åˆ°äº†é€’å½’å’Œè´£ä»»é“¾è®¾è®¡æ¨¡å¼ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; Object proceed() &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; Throwable {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä»-1å¼€å§‹,ä¸‹æ ‡=æ‹¦æˆªå™¨çš„é•¿åº¦-1çš„æ¡ä»¶æ»¡è¶³è¡¨ç¤ºæ‰§è¡Œåˆ°äº†æœ€åä¸€ä¸ªæ‹¦æˆªå™¨çš„æ—¶å€™ï¼Œæ­¤æ—¶æ‰§è¡Œç›®æ ‡æ–¹æ³•&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;this&lt;/span&gt;.currentInterceptorIndex == &lt;span&gt;this&lt;/span&gt;.interceptorsAndDynamicMethodMatchers.size() - 1&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; invokeJoinpoint();
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–ç¬¬ä¸€ä¸ªæ–¹æ³•æ‹¦æˆªå™¨ä½¿ç”¨çš„æ˜¯å‰++&lt;/span&gt;
        Object interceptorOrInterceptionAdvice =
                &lt;span&gt;this&lt;/span&gt;.interceptorsAndDynamicMethodMatchers.get(++&lt;span&gt;this&lt;/span&gt;&lt;span&gt;.currentInterceptorIndex);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (interceptorOrInterceptionAdvice &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; InterceptorAndDynamicMethodMatcher) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Evaluate dynamic method matcher here: static part will already have
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; been evaluated and found to match.&lt;/span&gt;
            InterceptorAndDynamicMethodMatcher dm =&lt;span&gt;
                    (InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (dm.methodMatcher.matches(&lt;span&gt;this&lt;/span&gt;.method, &lt;span&gt;this&lt;/span&gt;.targetClass, &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.arguments)) {
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; dm.interceptor.invoke(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Dynamic matching failed.
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Skip this interceptor and invoke the next in the chain.&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt;&lt;span&gt; proceed();
            }
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(&lt;span&gt;this&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€è¿›å…¥åˆ°((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(this)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; Object invoke(MethodInvocation invocation) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; Throwable {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬çš„ä»£ç†å¯¹è±¡çš„classå±æ€§&lt;/span&gt;
        Class&amp;lt;?&amp;gt; targetClass = (invocation.getThis() != &lt;span&gt;null&lt;/span&gt; ? AopUtils.getTargetClass(invocation.getThis()) : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * ä»¥äº‹åŠ¡çš„æ–¹å¼è°ƒç”¨ç›®æ ‡æ–¹æ³•
         * åœ¨è¿™åŸ‹äº†ä¸€ä¸ªé’©å­å‡½æ•° ç”¨æ¥å›è°ƒç›®æ ‡æ–¹æ³•çš„
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt;&lt;span&gt; invokeWithinTransaction(invocation.getMethod(), targetClass, invocation::proceed);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;ã€€ã€€è°ƒç”¨invokeWithinTransactionæ–¹æ³•&lt;/h3&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;49&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; Object invokeWithinTransaction(Method method, @Nullable Class&amp;lt;?&amp;gt;&lt;span&gt; targetClass,
            &lt;/span&gt;&lt;span&gt;final&lt;/span&gt; InvocationCallback invocation) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; Throwable {

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬çš„äº‹åŠ¡å±æºå¯¹è±¡&lt;/span&gt;
        TransactionAttributeSource tas =&lt;span&gt; getTransactionAttributeSource();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡äº‹åŠ¡å±æ€§æºå¯¹è±¡è·å–åˆ°æˆ‘ä»¬çš„äº‹åŠ¡å±æ€§ä¿¡æ¯&lt;/span&gt;
        &lt;span&gt;final&lt;/span&gt; TransactionAttribute txAttr = (tas != &lt;span&gt;null&lt;/span&gt; ? tas.getTransactionAttribute(method, targetClass) : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æˆ‘ä»¬é…ç½®çš„äº‹åŠ¡ç®¡ç†å™¨å¯¹è±¡&lt;/span&gt;
        &lt;span&gt;final&lt;/span&gt; PlatformTransactionManager tm =&lt;span&gt; determineTransactionManager(txAttr);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä»txå±æ€§å¯¹è±¡ä¸­è·å–å‡ºæ ‡æ³¨äº†@Transactionlçš„æ–¹æ³•æè¿°ç¬¦&lt;/span&gt;
        &lt;span&gt;final&lt;/span&gt; String joinpointIdentification =&lt;span&gt; methodIdentification(method, targetClass, txAttr);

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¤„ç†å£°æ˜å¼äº‹åŠ¡&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (txAttr == &lt;span&gt;null&lt;/span&gt; || !(tm &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; CallbackPreferringPlatformTransactionManager)) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æœ‰æ²¡æœ‰å¿…è¦åˆ›å»ºäº‹åŠ¡&lt;/span&gt;
            TransactionInfo txInfo =&lt;span&gt; createTransactionIfNecessary(tm, txAttr, joinpointIdentification);

            Object retVal;
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è°ƒç”¨é’©å­å‡½æ•°è¿›è¡Œå›è°ƒç›®æ ‡æ–¹æ³•&lt;/span&gt;
                retVal =&lt;span&gt; invocation.proceedWithInvocation();
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Throwable ex) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠ›å‡ºå¼‚å¸¸è¿›è¡Œå›æ»šå¤„ç†&lt;/span&gt;
&lt;span&gt;                completeTransactionAfterThrowing(txInfo, ex);
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex;
            }
            &lt;/span&gt;&lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¸…ç©ºæˆ‘ä»¬çš„çº¿ç¨‹å˜é‡ä¸­transactionInfoçš„å€¼&lt;/span&gt;
&lt;span&gt;                cleanupTransactionInfo(txInfo);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æäº¤äº‹åŠ¡&lt;/span&gt;
&lt;span&gt;            commitTransactionAfterReturning(txInfo);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; retVal;
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç¼–ç¨‹å¼äº‹åŠ¡&lt;/span&gt;
        &lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;final&lt;/span&gt; ThrowableHolder throwableHolder = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ThrowableHolder();

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; It's a CallbackPreferringPlatformTransactionManager: pass a TransactionCallback in.&lt;/span&gt;
            &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                Object result &lt;/span&gt;= ((CallbackPreferringPlatformTransactionManager) tm).execute(txAttr, status -&amp;gt;&lt;span&gt; {
                    TransactionInfo txInfo &lt;/span&gt;=&lt;span&gt; prepareTransactionInfo(tm, txAttr, joinpointIdentification, status);
                    &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; invocation.proceedWithInvocation();
                    }
                    &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Throwable ex) {
                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (txAttr.rollbackOn(ex)) {
                            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; A RuntimeException: will lead to a rollback.&lt;/span&gt;
                            &lt;span&gt;if&lt;/span&gt; (ex &lt;span&gt;instanceof&lt;/span&gt;&lt;span&gt; RuntimeException) {
                                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; (RuntimeException) ex;
                            }
                            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ThrowableHolderException(ex);
                            }
                        }
                        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; A normal return value: will lead to a commit.&lt;/span&gt;
                            throwableHolder.throwable =&lt;span&gt; ex;
                            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
                        }
                    }
                    &lt;/span&gt;&lt;span&gt;finally&lt;/span&gt;&lt;span&gt; {
                        cleanupTransactionInfo(txInfo);
                    }
                });

                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Check result state: It might indicate a Throwable to rethrow.&lt;/span&gt;
                &lt;span&gt;if&lt;/span&gt; (throwableHolder.throwable != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                    &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; throwableHolder.throwable;
                }
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; result;
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (ThrowableHolderException ex) {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex.getCause();
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (TransactionSystemException ex2) {
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (throwableHolder.throwable != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                    logger.error(&lt;/span&gt;&quot;Application exception overridden by commit exception&quot;&lt;span&gt;, throwableHolder.throwable);
                    ex2.initApplicationException(throwableHolder.throwable);
                }
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex2;
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Throwable ex2) {
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (throwableHolder.throwable != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                    logger.error(&lt;/span&gt;&quot;Application exception overridden by commit exception&quot;&lt;span&gt;, throwableHolder.throwable);
                }
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex2;
            }
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;ã€€ã€€1&lt;strong&gt;Â createTransactionIfNecessary(tm, txAttr, joinpointIdentification)æ–¹æ³•ï¼š&lt;/strong&gt;&lt;/h4&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;40&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; TransactionInfo createTransactionIfNecessary(@Nullable PlatformTransactionManager tm,
            @Nullable TransactionAttribute txAttr, &lt;/span&gt;&lt;span&gt;final&lt;/span&gt;&lt;span&gt; String joinpointIdentification) {

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; æŠŠæˆ‘ä»¬çš„æ–¹æ³•æè¿°ç¬¦ä½œä¸ºä¸€ä¸ªäº‹åŠ¡åç§°&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; txAttr.getName() == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            txAttr &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DelegatingTransactionAttribute(txAttr) {
                @Override
                &lt;/span&gt;&lt;span&gt;public&lt;/span&gt;&lt;span&gt; String getName() {
                    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; joinpointIdentification;
                }
            };
        }

        TransactionStatus status &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (tm != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–ä¸€ä¸ªäº‹åŠ¡çŠ¶æ€&lt;/span&gt;
                status =&lt;span&gt; tm.getTransaction(txAttr);
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                    logger.debug(&lt;/span&gt;&quot;Skipping transactional joinpoint [&quot; + joinpointIdentification +
                            &quot;] because no transaction manager has been configured&quot;&lt;span&gt;);
                }
            }
        }
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠäº‹åŠ¡çŠ¶æ€å’Œäº‹åŠ¡å±æ€§ç­‰ä¿¡æ¯å°è£…æˆä¸€ä¸ªTransactionInfoå¯¹è±¡&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt;&lt;span&gt; prepareTransactionInfo(tm, txAttr, joinpointIdentification, status);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h5&gt;ã€€ã€€1.1Â &lt;strong&gt;è¿›å…¥è·å–ä¸€ä¸ªäº‹åŠ¡çŠ¶æ€ï¼Œtm.getTransaction(txAttr)æ–¹æ³•ï¼š&lt;/strong&gt;&lt;/h5&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;56&quot;&gt;
&lt;pre&gt;
&lt;span&gt;public&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; TransactionStatus getTransaction(@Nullable TransactionDefinition definition) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å°è¯•è·å–ä¸€ä¸ªäº‹åŠ¡å¯¹è±¡&lt;/span&gt;
        Object transaction =&lt;span&gt; doGetTransaction();

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Cache debug flag to avoid repeated checks.&lt;/span&gt;
        &lt;span&gt;boolean&lt;/span&gt; debugEnabled =&lt;span&gt; logger.isDebugEnabled();

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * åˆ¤æ–­ä»ä¸Šä¸€ä¸ªæ–¹æ³•ä¼ é€’è¿›æ¥çš„äº‹åŠ¡å±æ€§æ˜¯ä¸æ˜¯ä¸ºç©º
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸ºç©ºçš„è¯ï¼Œæ‰§è¡Œéäº‹åŠ¡æ–¹æ³•&lt;/span&gt;
            definition = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DefaultTransactionDefinition();
        }

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * åˆ¤æ–­æ˜¯ä¸æ˜¯å·²ç»å­˜åœ¨äº†äº‹åŠ¡å¯¹è±¡
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isExistingTransaction(transaction)) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¤„ç†å­˜åœ¨çš„äº‹åŠ¡&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; handleExistingTransaction(definition, transaction, debugEnabled);
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ£€æŸ¥äº‹åŠ¡è®¾ç½®çš„è¶…æ—¶æ—¶é—´&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition.getTimeout() &amp;lt;&lt;span&gt; TransactionDefinition.TIMEOUT_DEFAULT) {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; InvalidTimeoutException(&quot;Invalid transaction timeout&quot;&lt;span&gt;, definition.getTimeout());
        }

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * è‹¥å½“å‰çš„äº‹åŠ¡å±æ€§å¼ PROPAGATION_MANDATORY è¡¨ç¤ºå¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡ä¸­ï¼Œè‹¥å½“å‰æ²¡æœ‰äº‹åŠ¡å°±æŠ›å‡ºå¼‚å¸¸
         * ç”±äºisExistingTransaction(transaction)è·³è¿‡äº†è¿™é‡Œï¼Œè¯´æ˜å½“å‰æ˜¯ä¸å­˜åœ¨äº‹åŠ¡çš„ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºå¼‚å¸¸
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() ==&lt;span&gt; TransactionDefinition.PROPAGATION_MANDATORY) {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; IllegalTransactionStateException(
                    &lt;/span&gt;&quot;No existing transaction found for transaction marked with propagation 'mandatory'&quot;&lt;span&gt;);
        }
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * PROPAGATION_REQUIRED å½“å‰å­˜åœ¨äº‹åŠ¡å°±åŠ å…¥åˆ°å½“å‰çš„äº‹åŠ¡,æ²¡æœ‰å°±æ–°å¼€ä¸€ä¸ª
         * PROPAGATION_REQUIRES_NEW:æ–°å¼€ä¸€ä¸ªäº‹åŠ¡,è‹¥å½“å‰å­˜åœ¨äº‹åŠ¡å°±æŒ‚èµ·å½“å‰äº‹åŠ¡
         * PROPAGATION_NESTED: PROPAGATION_NESTED
            è¡¨ç¤ºå¦‚æœå½“å‰æ­£æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œä¸­ï¼Œåˆ™è¯¥æ–¹æ³•åº”è¯¥è¿è¡Œåœ¨ ä¸€ä¸ªåµŒå¥—çš„äº‹åŠ¡ä¸­ï¼Œ
            è¢«åµŒå¥—çš„äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå°è£…äº‹åŠ¡è¿›è¡Œæäº¤æˆ–è€…å›æ»š(ä¿å­˜ç‚¹)ï¼Œ
            å¦‚æœå°è£…äº‹åŠ¡ä¸å­˜åœ¨,è¡Œä¸ºå°±åƒ PROPAGATION_REQUIRES_NEW
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() == TransactionDefinition.PROPAGATION_REQUIRED ||&lt;span&gt;
                definition.getPropagationBehavior() &lt;/span&gt;== TransactionDefinition.PROPAGATION_REQUIRES_NEW ||&lt;span&gt;
                definition.getPropagationBehavior() &lt;/span&gt;==&lt;span&gt; TransactionDefinition.PROPAGATION_NESTED) {
            &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
             * æŒ‚èµ·å½“å‰äº‹åŠ¡ï¼Œåœ¨è¿™é‡Œä¸ºå•¥ä¼ å…¥null?
             * å› ä¸ºé€»è¾‘èµ°åˆ°è¿™é‡Œäº†,ç»è¿‡äº†ä¸Šé¢çš„isExistingTransaction(transaction) åˆ¤æ–­å½“å‰æ˜¯ä¸å­˜åœ¨äº‹åŠ¡çš„
             * æ‰€æœ‰å†è¿™é‡Œæ˜¯æŒ‚èµ·å½“å‰äº‹åŠ¡ä¼ é€’ä¸€ä¸ªnullè¿›å»
             &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
            SuspendedResourcesHolder suspendedResources &lt;/span&gt;= suspend(&lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (debugEnabled) {
                logger.debug(&lt;/span&gt;&quot;Creating new transaction with name [&quot; + definition.getName() + &quot;]: &quot; +&lt;span&gt; definition);
            }
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() !=&lt;span&gt; SYNCHRONIZATION_NEVER);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ–°åˆ›å»ºä¸€ä¸ªäº‹åŠ¡çŠ¶æ€&lt;/span&gt;
                DefaultTransactionStatus status =&lt;span&gt; newTransactionStatus(
                        definition, transaction, &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;, newSynchronization, debugEnabled, suspendedResources);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¼€å¯ä¸€ä¸ªæ–°çš„äº‹ç‰©&lt;/span&gt;
&lt;span&gt;                doBegin(transaction, definition);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠå½“å‰çš„äº‹åŠ¡ä¿¡æ¯ç»‘å®šåˆ°çº¿ç¨‹å˜é‡å»&lt;/span&gt;
&lt;span&gt;                prepareSynchronization(status, definition);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; status;
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt; (RuntimeException |&lt;span&gt; Error ex) {
                resume(&lt;/span&gt;&lt;span&gt;null&lt;/span&gt;&lt;span&gt;, suspendedResources);
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex;
            }
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; { &lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªç©ºçš„äº‹åŠ¡
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Create &quot;empty&quot; transaction: no actual transaction, but potentially synchronization.&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (definition.getIsolationLevel() != TransactionDefinition.ISOLATION_DEFAULT &amp;amp;&amp;amp;&lt;span&gt; logger.isWarnEnabled()) {
                logger.warn(&lt;/span&gt;&quot;Custom isolation level specified but no actual transaction initiated; &quot; +
                        &quot;isolation level will effectively be ignored: &quot; +&lt;span&gt; definition);
            }
            &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() ==&lt;span&gt; SYNCHRONIZATION_ALWAYS);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; prepareTransactionStatus(definition, &lt;span&gt;null&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;, newSynchronization, debugEnabled, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€â‘  è¿›å…¥åˆ°doGetTransaction()æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; Object doGetTransaction() {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªæ•°æ®æºäº‹åŠ¡å¯¹è±¡&lt;/span&gt;
        DataSourceTransactionObject txObject = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; DataSourceTransactionObject();
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ˜¯å¦å…è®¸å½“å‰äº‹åŠ¡è®¾ç½®ä¿æŒç‚¹&lt;/span&gt;
&lt;span&gt;        txObject.setSavepointAllowed(isNestedTransactionAllowed());
        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * TransactionSynchronizationManager äº‹åŠ¡åŒæ­¥ç®¡ç†å™¨å¯¹è±¡(è¯¥ç±»ä¸­éƒ½æ˜¯å±€éƒ¨çº¿ç¨‹å˜é‡)
         * ç”¨æ¥ä¿å­˜å½“å‰äº‹åŠ¡çš„ä¿¡æ¯,æˆ‘ä»¬ç¬¬ä¸€æ¬¡ä»è¿™é‡Œå»çº¿ç¨‹å˜é‡ä¸­è·å– äº‹åŠ¡è¿æ¥æŒæœ‰å™¨å¯¹è±¡ é€šè¿‡æ•°æ®æºä¸ºkeyå»è·å–
         * ç”±äºç¬¬ä¸€æ¬¡è¿›æ¥å¼€å§‹äº‹åŠ¡ æˆ‘ä»¬çš„äº‹åŠ¡åŒæ­¥ç®¡ç†å™¨ä¸­æ²¡æœ‰è¢«å­˜æ”¾.æ‰€ä»¥æ­¤æ—¶è·å–å‡ºæ¥çš„conHolderä¸ºnull
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;&lt;span&gt;
        ConnectionHolder conHolder &lt;/span&gt;=&lt;span&gt;
                (ConnectionHolder) TransactionSynchronizationManager.getResource(obtainDataSource());
        txObject.setConnectionHolder(conHolder, &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è¿”å›äº‹åŠ¡å¯¹è±¡&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt;&lt;span&gt; txObject;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€â‘¡ è¿›å…¥isExistingTransaction(transaction)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; isExistingTransaction(Object transaction) {
        DataSourceTransactionObject txObject &lt;/span&gt;=&lt;span&gt; (DataSourceTransactionObject) transaction;
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è‹¥ç¬¬ä¸€æ¬¡è¿›æ¥å¼€å§‹äº‹åŠ¡ï¼ŒtxObject.hasConnectionHolder() è¿”å›çš„null é‚£ä¹ˆè¡¨ç¤ºä¸å­˜åœ¨äº‹åŠ¡&lt;/span&gt;
        &lt;span&gt;return&lt;/span&gt; (txObject.hasConnectionHolder() &amp;amp;&amp;amp;&lt;span&gt; txObject.getConnectionHolder().isTransactionActive());
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€â‘¢ ç”±äºäº‹åŠ¡ä¼ æ’­æœºåˆ¶æ˜¯TransactionDefinition.PROPAGATION_REQUIREDï¼Œæ‰€ä»¥èµ°ä¸‹é¢åˆ†æ”¯&lt;/p&gt;
&lt;p&gt;Â &lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013002122643-8557110.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€â‘£ è¿›å…¥æŒ‚èµ·äº‹åŠ¡ï¼Œsuspend(null)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; SuspendedResourcesHolder suspend(@Nullable Object transaction) &lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­å½“å‰çš„çº¿ç¨‹å˜é‡ä¸­ æœ‰æ²¡æœ‰æ¿€æ´»çš„äº‹ç‰©,æœ‰éœ€è¦æ¸…ç©ºçº¿ç¨‹å˜é‡&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (TransactionSynchronizationManager.isSynchronizationActive()) {
            List&lt;/span&gt;&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations =&lt;span&gt; doSuspendSynchronization();
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                Object suspendedResources &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (transaction != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
                    suspendedResources &lt;/span&gt;=&lt;span&gt; doSuspend(transaction);
                }
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–å·²å­˜åœ¨çš„äº‹åŠ¡çš„åç§°&lt;/span&gt;
                String name =&lt;span&gt; TransactionSynchronizationManager.getCurrentTransactionName();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¸…ç©ºçº¿ç¨‹å˜é‡çš„&lt;/span&gt;
                TransactionSynchronizationManager.setCurrentTransactionName(&lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–å‡ºåªè¯»äº‹åŠ¡çš„åç§°&lt;/span&gt;
                &lt;span&gt;boolean&lt;/span&gt; readOnly =&lt;span&gt; TransactionSynchronizationManager.isCurrentTransactionReadOnly();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¸…ç©ºçº¿ç¨‹å˜é‡çš„&lt;/span&gt;
                TransactionSynchronizationManager.setCurrentTransactionReadOnly(&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–å·²å­˜åœ¨äº‹åŠ¡çš„éš”ç¦»çº§åˆ«&lt;/span&gt;
                Integer isolationLevel =&lt;span&gt; TransactionSynchronizationManager.getCurrentTransactionIsolationLevel();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¸…ç©ºéš”ç¦»çº§åˆ«&lt;/span&gt;
                TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(&lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è·å–æ¿€æ´»æ ‡å¿—&lt;/span&gt;
                &lt;span&gt;boolean&lt;/span&gt; wasActive =&lt;span&gt; TransactionSynchronizationManager.isActualTransactionActive();
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¸…ç©ºæ ‡è®°&lt;/span&gt;
                TransactionSynchronizationManager.setActualTransactionActive(&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠä¸Šè¯‰ä»çº¿ç¨‹å˜é‡ä¸­è·å–å‡ºæ¥çš„å­˜åœ¨äº‹åŠ¡å±æ€§å°è£…ä¸ºæŒ‚èµ·çš„äº‹åŠ¡å±æ€§è¿”å›å‡ºå»&lt;/span&gt;
                &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; SuspendedResourcesHolder(
                        suspendedResources, suspendedSynchronizations, name, readOnly, isolationLevel, wasActive);
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt; (RuntimeException |&lt;span&gt; Error ex) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; doSuspend failed - original transaction is still active...&lt;/span&gt;
&lt;span&gt;                doResumeSynchronization(suspendedSynchronizations);
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; ex;
            }
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (transaction != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Transaction active but no synchronization active.&lt;/span&gt;
            Object suspendedResources =&lt;span&gt; doSuspend(transaction);
            &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; SuspendedResourcesHolder(suspendedResources);
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Neither transaction nor synchronization active.&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€â‘¤ è¿›å…¥åˆ°äº‹åŠ¡å¼€å§‹ï¼ŒdoBegin(transaction, definition)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; doBegin(Object transaction, TransactionDefinition definition) {
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¼ºåˆ¶è½¬åŒ–äº‹åŠ¡å¯¹è±¡&lt;/span&gt;
        DataSourceTransactionObject txObject =&lt;span&gt; (DataSourceTransactionObject) transaction;
        Connection con &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;

        &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­äº‹åŠ¡å¯¹è±¡æ²¡æœ‰æ•°æ®åº“è¿æ¥æŒæœ‰å™¨&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt; (!txObject.hasConnectionHolder() ||&lt;span&gt;
                    txObject.getConnectionHolder().isSynchronizedWithTransaction()) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é€šè¿‡æ•°æ®æºè·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡&lt;/span&gt;
                Connection newCon =&lt;span&gt; obtainDataSource().getConnection();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                    logger.debug(&lt;/span&gt;&quot;Acquired Connection [&quot; + newCon + &quot;] for JDBC transaction&quot;&lt;span&gt;);
                }
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠæˆ‘ä»¬çš„æ•°æ®åº“è¿æ¥åŒ…è£…æˆä¸€ä¸ªConnectionHolderå¯¹è±¡ ç„¶åè®¾ç½®åˆ°æˆ‘ä»¬çš„txObjectå¯¹è±¡ä¸­å»&lt;/span&gt;
                txObject.setConnectionHolder(&lt;span&gt;new&lt;/span&gt; ConnectionHolder(newCon), &lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ ‡è®°å½“å‰çš„è¿æ¥æ˜¯ä¸€ä¸ªåŒæ­¥äº‹åŠ¡&lt;/span&gt;
            txObject.getConnectionHolder().setSynchronizedWithTransaction(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
            con &lt;/span&gt;=&lt;span&gt; txObject.getConnectionHolder().getConnection();

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸ºå½“å‰çš„äº‹åŠ¡è®¾ç½®éš”ç¦»çº§åˆ«&lt;/span&gt;
            Integer previousIsolationLevel =&lt;span&gt; DataSourceUtils.prepareConnectionForTransaction(con, definition);
            txObject.setPreviousIsolationLevel(previousIsolationLevel);

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å…³é—­è‡ªåŠ¨æäº¤&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (con.getAutoCommit()) {
                txObject.setMustRestoreAutoCommit(&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isDebugEnabled()) {
                    logger.debug(&lt;/span&gt;&quot;Switching JDBC Connection [&quot; + con + &quot;] to manual commit&quot;&lt;span&gt;);
                }
                con.setAutoCommit(&lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ¤æ–­äº‹åŠ¡ä¸ºåªè¯»äº‹åŠ¡&lt;/span&gt;
&lt;span&gt;            prepareTransactionalConnection(con, definition);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è®¾ç½®äº‹åŠ¡æ¿€æ´»&lt;/span&gt;
            txObject.getConnectionHolder().setTransactionActive(&lt;span&gt;true&lt;/span&gt;&lt;span&gt;);

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´&lt;/span&gt;
            &lt;span&gt;int&lt;/span&gt; timeout =&lt;span&gt; determineTimeout(definition);
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (timeout !=&lt;span&gt; TransactionDefinition.TIMEOUT_DEFAULT) {
                txObject.getConnectionHolder().setTimeoutInSeconds(timeout);
            }

            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç»‘å®šæˆ‘ä»¬çš„æ•°æ®æºå’Œè¿æ¥åˆ°æˆ‘ä»¬çš„åŒæ­¥ç®¡ç†å™¨ä¸Š   æŠŠæ•°æ®æºä½œä¸ºkey,æ•°æ®åº“è¿æ¥ä½œä¸ºvalue è®¾ç½®åˆ°çº¿ç¨‹å˜é‡ä¸­&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (txObject.isNewConnectionHolder()) {
                TransactionSynchronizationManager.bindResource(obtainDataSource(), txObject.getConnectionHolder());
            }
        }

        &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Throwable ex) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (txObject.isNewConnectionHolder()) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;é‡Šæ”¾æ•°æ®åº“è¿æ¥&lt;/span&gt;
&lt;span&gt;                DataSourceUtils.releaseConnection(con, obtainDataSource());
                txObject.setConnectionHolder(&lt;/span&gt;&lt;span&gt;null&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; CannotCreateTransactionException(&quot;Could not open JDBC Connection for transaction&quot;&lt;span&gt;, ex);
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€â‘¥ è¿›å…¥åˆ°prepareSynchronization(status, definition)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;36&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; prepareSynchronization(DefaultTransactionStatus status, TransactionDefinition definition) {
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (status.isNewSynchronization()) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ç»‘å®šäº‹åŠ¡æ¿€æ´»&lt;/span&gt;
&lt;span&gt;            TransactionSynchronizationManager.setActualTransactionActive(status.hasTransaction());
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å½“å‰äº‹åŠ¡çš„éš”ç¦»çº§åˆ«&lt;/span&gt;
&lt;span&gt;            TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(
                    definition.getIsolationLevel() &lt;/span&gt;!= TransactionDefinition.ISOLATION_DEFAULT ?&lt;span&gt;
                            definition.getIsolationLevel() : &lt;/span&gt;&lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡&lt;/span&gt;
&lt;span&gt;            TransactionSynchronizationManager.setCurrentTransactionReadOnly(definition.isReadOnly());
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;äº‹åŠ¡çš„åç§°&lt;/span&gt;
&lt;span&gt;            TransactionSynchronizationManager.setCurrentTransactionName(definition.getName());
            TransactionSynchronizationManager.initSynchronization();
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h5&gt;ã€€ã€€1.2 æŠŠäº‹åŠ¡çŠ¶æ€å’Œäº‹åŠ¡å±æ€§ç­‰ä¿¡æ¯å°è£…æˆä¸€ä¸ªTransactionInfoå¯¹è±¡ï¼ŒprepareTransactionInfo(tm, txAttr, joinpointIdentification, status)æ–¹æ³•ï¼š&lt;/h5&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;41&quot;&gt;
&lt;pre&gt;
&lt;span&gt;protected&lt;/span&gt;&lt;span&gt; TransactionInfo prepareTransactionInfo(PlatformTransactionManager tm,
            TransactionAttribute txAttr, String joinpointIdentification, TransactionStatus status) {

        TransactionInfo txInfo &lt;/span&gt;= &lt;span&gt;new&lt;/span&gt;&lt;span&gt; TransactionInfo(tm, txAttr, joinpointIdentification);
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (txAttr != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; We need a transaction for this method...&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isTraceEnabled()) {
                logger.trace(&lt;/span&gt;&quot;Getting transaction for [&quot; + txInfo.getJoinpointIdentification() + &quot;]&quot;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; The transaction manager will flag an error if an incompatible tx already exists.&lt;/span&gt;
&lt;span&gt;            txInfo.newTransactionStatus(status);
        }
        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt; {
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; The TransactionInfo.hasTransaction() method will return false. We created it only
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; to preserve the integrity of the ThreadLocal stack maintained in this class.&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (logger.isTraceEnabled())
                logger.trace(&lt;/span&gt;&quot;Don't need to create transaction for [&quot; + joinpointIdentification +
                        &quot;]: This method isn't transactional.&quot;&lt;span&gt;);
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; We always bind the TransactionInfo to the thread, even if we didn't create
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; a new transaction here. This guarantees that the TransactionInfo stack
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; will be managed correctly even if no transaction was created by this aspect.&lt;/span&gt;
&lt;span&gt;        txInfo.bindToThread();
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; txInfo;
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;ã€€ã€€2Â è°ƒç”¨é’©å­å‡½æ•°è¿›è¡Œå›è°ƒç›®æ ‡æ–¹æ³•ï¼Œinvocation.proceedWithInvocation()æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°ç›®æ ‡æ–¹æ³•é‡Œé¢ï¼š&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013003540036-506778559.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;Â ã€€ã€€ç¬¬äºŒæ­¥ï¼šaddLog(&quot;æ–°å¢ç”¨æˆ·&quot;) å…¶ä¸­äº‹åŠ¡æ³¨è§£ä¸Šçš„ä¼ æ’­æœºåˆ¶æ˜¯propagation = Propagation.NESTED&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013004009652-1109626673.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€æ‰§è¡Œæµç¨‹å‚è€ƒå‰é¢çš„addUseræµç¨‹ï¼ŒåŒºåˆ«æ˜¯åˆ°AbstractPlatformTransactionManager#getTransactioné‡Œé¢çš„isExistingTransaction (transaction)ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯è¿”å›trueçš„ï¼Œæ‰€ä»¥æ‰§è¡ŒhandleExistingTransaction(definition, transaction, debugEnabled)æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;74&quot;&gt;
&lt;pre&gt;
&lt;span&gt;private&lt;/span&gt;&lt;span&gt; TransactionStatus handleExistingTransaction(
            TransactionDefinition definition, Object transaction, &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt;&lt;span&gt; debugEnabled)
            &lt;/span&gt;&lt;span&gt;throws&lt;/span&gt;&lt;span&gt; TransactionException {

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * åˆ¤æ–­å½“å‰çš„äº‹åŠ¡è¡Œä¸ºæ˜¯ä¸æ˜¯PROPAGATION_NEVERçš„
         * è¡¨ç¤ºä¸ºä¸æ”¯æŒäº‹åŠ¡,ä½†æ˜¯å½“å‰åˆå­˜åœ¨ä¸€ä¸ªäº‹åŠ¡,æ‰€ä»¥æŠ›å‡ºå¼‚å¸¸
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() ==&lt;span&gt; TransactionDefinition.PROPAGATION_NEVER) {
            &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; IllegalTransactionStateException(
                    &lt;/span&gt;&quot;Existing transaction found for transaction marked with propagation 'never'&quot;&lt;span&gt;);
        }

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * åˆ¤æ–­å½“å‰çš„äº‹åŠ¡å±æ€§ä¸æ”¯æŒäº‹åŠ¡,PROPAGATION_NOT_SUPPORTED,æ‰€ä»¥éœ€è¦å…ˆæŒ‚èµ·å·²ç»å­˜åœ¨çš„äº‹åŠ¡
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() ==&lt;span&gt; TransactionDefinition.PROPAGATION_NOT_SUPPORTED) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (debugEnabled) {
                logger.debug(&lt;/span&gt;&quot;Suspending current transaction&quot;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŒ‚èµ·å­˜åœ¨çš„äº‹åŠ¡&lt;/span&gt;
            Object suspendedResources =&lt;span&gt; suspend(transaction);
            &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() ==&lt;span&gt; SYNCHRONIZATION_ALWAYS);
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„éäº‹åŠ¡çŠ¶æ€(ä¿å­˜äº†ä¸Šä¸€ä¸ªå­˜åœ¨äº‹åŠ¡çŠ¶æ€çš„å±æ€§)&lt;/span&gt;
            &lt;span&gt;return&lt;/span&gt;&lt;span&gt; prepareTransactionStatus(
                    definition, &lt;/span&gt;&lt;span&gt;null&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;&lt;span&gt;, newSynchronization, debugEnabled, suspendedResources);
        }

        &lt;/span&gt;&lt;span&gt;/**&lt;/span&gt;&lt;span&gt;
         * å½“å‰çš„äº‹åŠ¡å±æ€§çŠ¶æ€æ˜¯PROPAGATION_REQUIRES_NEWè¡¨ç¤ºéœ€è¦æ–°å¼€å¯ä¸€ä¸ªäº‹åŠ¡çŠ¶æ€
         &lt;/span&gt;&lt;span&gt;*/&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() ==&lt;span&gt; TransactionDefinition.PROPAGATION_REQUIRES_NEW) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (debugEnabled) {
                logger.debug(&lt;/span&gt;&quot;Suspending current transaction, creating new transaction with name [&quot; +&lt;span&gt;
                        definition.getName() &lt;/span&gt;+ &quot;]&quot;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŒ‚èµ·å·²ç»å­˜åœ¨çš„äº‹åŠ¡&lt;/span&gt;
            SuspendedResourcesHolder suspendedResources =&lt;span&gt; suspend(transaction);
            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
                &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() !=&lt;span&gt; SYNCHRONIZATION_NEVER);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡çŠ¶æ€(åŒ…å«äº†æŒ‚èµ·çš„äº‹åŠ¡çš„å±æ€§)&lt;/span&gt;
                DefaultTransactionStatus status =&lt;span&gt; newTransactionStatus(
                        definition, transaction, &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;, newSynchronization, debugEnabled, suspendedResources);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¼€å¯æ–°çš„äº‹åŠ¡&lt;/span&gt;
&lt;span&gt;                doBegin(transaction, definition);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æŠŠæ–°çš„äº‹åŠ¡çŠ¶æ€è®¾ç½®åˆ°å½“å‰çš„çº¿ç¨‹å˜é‡ä¸­å»&lt;/span&gt;
&lt;span&gt;                prepareSynchronization(status, definition);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; status;
            }
            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt; (RuntimeException |&lt;span&gt; Error beginEx) {
                resumeAfterBeginException(transaction, suspendedResources, beginEx);
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt; beginEx;
            }
        }

        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (definition.getPropagationBehavior() ==&lt;span&gt; TransactionDefinition.PROPAGATION_NESTED) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;isNestedTransactionAllowed()) {
                &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; NestedTransactionNotSupportedException(
                        &lt;/span&gt;&quot;Transaction manager does not allow nested transactions by default - &quot; +
                        &quot;specify 'nestedTransactionAllowed' property with value 'true'&quot;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (debugEnabled) {
                logger.debug(&lt;/span&gt;&quot;Creating nested transaction with name [&quot; + definition.getName() + &quot;]&quot;&lt;span&gt;);
            }
            &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;åµŒå¥—äº‹åŠ¡çš„å¤„ç†&lt;/span&gt;
            &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (useSavepointForNestedTransaction()) {
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡&lt;/span&gt;
                DefaultTransactionStatus status =&lt;span&gt;
                        prepareTransactionStatus(definition, transaction, &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;, &lt;span&gt;false&lt;/span&gt;, debugEnabled, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;ä¸ºäº‹åŠ¡è®¾ç½®ä¸€ä¸ªå›é€€ç‚¹&lt;/span&gt;
&lt;span&gt;                status.createAndHoldSavepoint();
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; status;
            }
            &lt;/span&gt;&lt;span&gt;else&lt;/span&gt; {&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Nested transaction through nested begin and commit/rollback calls.
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Usually only for JTA: Spring synchronization might get activated here
                &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; in case of a pre-existing JTA transaction.&lt;/span&gt;
                &lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() !=&lt;span&gt; SYNCHRONIZATION_NEVER);
                DefaultTransactionStatus status &lt;/span&gt;=&lt;span&gt; newTransactionStatus(
                        definition, transaction, &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;, newSynchronization, debugEnabled, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
                doBegin(transaction, definition);
                prepareSynchronization(status, definition);
                &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; status;
            }
        }

        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; Assumably PROPAGATION_SUPPORTS or PROPAGATION_REQUIRED.&lt;/span&gt;
        &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (debugEnabled) {
            logger.debug(&lt;/span&gt;&quot;Participating in existing transaction&quot;&lt;span&gt;);
        }
        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isValidateExistingTransaction()) {
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (definition.getIsolationLevel() !=&lt;span&gt; TransactionDefinition.ISOLATION_DEFAULT) {
                Integer currentIsolationLevel &lt;/span&gt;=&lt;span&gt; TransactionSynchronizationManager.getCurrentTransactionIsolationLevel();
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (currentIsolationLevel == &lt;span&gt;null&lt;/span&gt; || currentIsolationLevel !=&lt;span&gt; definition.getIsolationLevel()) {
                    Constants isoConstants &lt;/span&gt;=&lt;span&gt; DefaultTransactionDefinition.constants;
                    &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalTransactionStateException(&quot;Participating transaction with definition [&quot; +&lt;span&gt;
                            definition &lt;/span&gt;+ &quot;] specifies isolation level which is incompatible with existing transaction: &quot; +&lt;span&gt;
                            (currentIsolationLevel &lt;/span&gt;!= &lt;span&gt;null&lt;/span&gt; ?&lt;span&gt;
                                    isoConstants.toCode(currentIsolationLevel, DefaultTransactionDefinition.PREFIX_ISOLATION) :
                                    &lt;/span&gt;&quot;(unknown)&quot;&lt;span&gt;));
                }
            }
            &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;definition.isReadOnly()) {
                &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (TransactionSynchronizationManager.isCurrentTransactionReadOnly()) {
                    &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; IllegalTransactionStateException(&quot;Participating transaction with definition [&quot; +&lt;span&gt;
                            definition &lt;/span&gt;+ &quot;] is not marked as read-only but existing transaction is&quot;&lt;span&gt;);
                }
            }
        }
        &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt; newSynchronization = (getTransactionSynchronization() !=&lt;span&gt; SYNCHRONIZATION_NEVER);
        &lt;/span&gt;&lt;span&gt;return&lt;/span&gt; prepareTransactionStatus(definition, transaction, &lt;span&gt;false&lt;/span&gt;, newSynchronization, debugEnabled, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€ç”±äºaddLogä¸Šé¢çš„äº‹åŠ¡æ³¨è§£çš„ä¼ æ’­æœºåˆ¶æ˜¯TransactionDefinition.PROPAGATION_NESTEDï¼Œæ‰€ä»¥æ‰§è¡Œä¸‹é¢åˆ†æ”¯&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013004945309-1840588607.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€å¯ä»¥çœ‹å‡ºå†…åµŒäº‹åŠ¡è®¾ç½®ä¿å­˜ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å†…åµŒäº‹åŠ¡çš„å¼‚å¸¸å›æ»šæ˜¯å›æ»šåˆ°è¯¥ä¿å­˜ç‚¹çš„ï¼Œåªè¦å¤–å±‚å°è£…äº‹åŠ¡æ•è·äº†å†…åµŒäº‹åŠ¡çš„å¼‚å¸¸ï¼Œå†…åµŒäº‹åŠ¡çš„å›æ»šæ˜¯ä¸ä¼šå½±å“å¤–å±‚å°è£…äº‹åŠ¡çš„ã€‚ä»demoçš„ä¾‹å­å°±èƒ½ä½“ç°è¿™ç‚¹ã€‚æ¥ä¸‹æ¥åˆå›åˆ°addUseræ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013005532299-1758768675.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€ç¤ºä¾‹demoä¸­çš„ç›®æ ‡æ–¹æ³•å¦‚ä¸‹:&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
 @Transactional(propagation = Propagation.NESTED,rollbackFor = Exception.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; addLog(String operation) {
        logDao.addLog(operation);
        System.out.println(&lt;/span&gt;1/0&lt;span&gt;);
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€1/0ä¼šæŠ¥java.lang.ArithmeticException: / by zeroå¼‚å¸¸ï¼Œæ‰€ä»¥è¢«catchæ•è·åˆ°ï¼Œä»è€Œè¿›è¡Œå›æ»šï¼Œæ­¤æ—¶ç”±äºå‰é¢å†…åµŒäº‹åŠ¡è®¾ç½®äº†ä¿å­˜ç‚¹ï¼Œæ‰€ä»¥å†…åµŒäº‹åŠ¡å€¼å›æ»šåˆ°ä¿å­˜ç‚¹ï¼Œå¯¹å¤–é¢æ²¡æœ‰å½±å“ã€‚å†…åµŒäº‹åŠ¡æ‰§è¡Œå®Œäº†ä¹‹åï¼Œç»§ç»­å¤–å±‚addUserçš„æ–¹æ³•æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013010112070-899001189.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€addUseræ–¹æ³•æ•è·äº†logService.addLog(&quot;æ–°å¢ç”¨æˆ·&quot;)å¼‚å¸¸å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;38&quot;&gt;
&lt;pre&gt;
@Transactional(propagation = Propagation.REQUIRED,rollbackFor = Exception.&lt;span&gt;class&lt;/span&gt;&lt;span&gt;)
    &lt;/span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt;&lt;span&gt; addUser(User user) {
        userDao.addUser(user.getName(),user.getSex(),user.getAddress());
        &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;æ¼”ç¤ºPropagation.NESTED å†…åµŒäº‹åŠ¡ä¸å½±å“å¤–éƒ¨äº‹åŠ¡&lt;/span&gt;
        &lt;span&gt;try&lt;/span&gt;&lt;span&gt; {
            logService.addLog(&lt;/span&gt;&quot;æ–°å¢ç”¨æˆ·&quot;&lt;span&gt;);
        } &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception e) {
            e.printStackTrace();
        }
    }&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€æ‰€ä»¥å¤–å±‚äº‹åŠ¡çš„è¿˜æ˜¯èƒ½æ­£å¸¸æäº¤äº‹åŠ¡&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1761778/201910/1761778-20191013010328149-317274879.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€&lt;strong&gt;&lt;span&gt;è‡³æ­¤æ•´ä¸ªaddUseræ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼ï¼&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€æ€»ç»“ï¼šé¦–å…ˆé€šè¿‡äº‹åŠ¡æ¦‚è¿°ï¼Œå¯¹äº‹åŠ¡çš„ACIDç‰¹æ€§ï¼Œäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼ŒSpringäº‹åŠ¡çš„ä¼ æ’­æœºåˆ¶æœ‰äº†ä¸€å®šçš„è®¤è¯†ï¼Œç„¶ååˆ†æäº†@Enable TransactionManagementæ³¨è§£å¼€å¯Springäº‹åŠ¡çš„æ”¯æŒåŠŸèƒ½ï¼Œè¯¥æ³¨è§£ä¸ºæˆ‘ä»¬Springå®¹å™¨ä¸­æ³¨å†Œäº†InfrastructureAdvisorAutoProxy Creatorç»„ä»¶ï¼ŒSpringäº‹åŠ¡ä»£ç†åˆ›å»ºéƒ½åœ¨è¿™ä¸ªç»„ä»¶ä¸­å®Œæˆï¼Œç„¶åé€šè¿‡ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„åµŒå¥—äº‹åŠ¡çš„è°ƒç”¨è¿‡ç¨‹åˆ†æï¼Œè¿›ä¸€æ­¥åŠ æ·±å¯¹Springäº‹åŠ¡çš„ä¼ æ’­æœºåˆ¶ç†è§£ã€‚Springç³»åˆ—å®Œæ•´ä»£ç åœ¨ç äº‘ï¼š&lt;span&gt;&lt;strong&gt;&lt;a href=&quot;https://gitee.com/xutaowin/spring&quot; target=&quot;_blank&quot;&gt;&lt;span&gt;springç³»åˆ—&lt;/span&gt;&lt;/a&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 12 Oct 2019 17:32:00 +0000</pubDate>
<dc:creator>toby.xu</dc:creator>
<og:description>ä¸€ã€äº‹åŠ¡æ¦‚è¿° 1.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡ äº‹åŠ¡æ˜¯ä¸€ç»„åŸå­æ€§çš„SQLæŸ¥è¯¢ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œå•å…ƒã€‚è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚ 1.2 äº‹åŠ¡çš„ç‰¹æ€§(ACID) â‘ åŸå­æ€§ï¼ˆatomicityï¼‰ ä¸€ä¸ªäº‹åŠ¡å¿…é¡»</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/toby-xu/p/11645162.html</dc:identifier>
</item>
<item>
<title>æå¤§ä¼¼ç„¶å°ç»“ - é£å‰‘å®¢é˜¿é£</title>
<link>http://www.cnblogs.com/moonwanderer/p/11664619.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/moonwanderer/p/11664619.html</guid>
<description>&lt;p&gt;åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è¦åˆ©ç”¨æå¤§ä¼¼ç„¶æ³•è¿‘ä¼¼æ•°æ®æ•´ä½“çš„åˆ†å¸ƒï¼Œæœ¬ç¯‡æ–‡ç« é€šè¿‡ä»‹ç»æå¤§ä¼¼ç„¶æ³•åŠå…¶ä¸€äº›æ€§è´¨ï¼Œæ—¨åœ¨æ·±å…¥æµ…å‡ºåœ°è§£é‡Šæ¸…æ¥šæå¤§ä¼¼ç„¶æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;è´å¶æ–¯æ¦‚ç‡&quot;&gt;0. è´å¶æ–¯æ¦‚ç‡&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆçœ‹ä¸€ä¸‹ç»å…¸çš„è´å¶æ–¯å…¬å¼ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ p(Y|X)=\frac{p(X|Y)p(Y)}{p(X)} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p(Y)\)&lt;/span&gt;ç§°ä¸ºå…ˆéªŒæ¦‚ç‡(&lt;span class=&quot;math inline&quot;&gt;\(prior\)&lt;/span&gt;)ï¼Œå³æ ¹æ®å…ˆéªŒçŸ¥è¯†å¾—å‡ºçš„å…³äºå˜é‡&lt;span class=&quot;math inline&quot;&gt;\(Y\)&lt;/span&gt;çš„åˆ†å¸ƒï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p(X|Y)\)&lt;/span&gt;ç§°ä¸ºä¼¼ç„¶å‡½æ•°ï¼ˆ&lt;span class=&quot;math inline&quot;&gt;\(likelihood\)&lt;/span&gt;ï¼‰ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p(X)\)&lt;/span&gt;ä¸ºå˜é‡&lt;span class=&quot;math inline&quot;&gt;\(X\)&lt;/span&gt;çš„æ¦‚ç‡ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p(Y|X)\)&lt;/span&gt;ç§°ä¹‹ä¸ºæ¡ä»¶æ¦‚ç‡ï¼ˆç»™å®šå˜é‡&lt;span class=&quot;math inline&quot;&gt;\(X\)&lt;/span&gt;çš„æƒ…å†µä¸‹&lt;span class=&quot;math inline&quot;&gt;\(Y\)&lt;/span&gt;çš„æ¦‚ç‡ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(posterior\)&lt;/span&gt;ï¼ŒåéªŒæ¦‚ç‡ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¼¼ç„¶å‡½æ•°&quot;&gt;1. ä¼¼ç„¶å‡½æ•°&lt;/h3&gt;
&lt;p&gt;ä¼¼ç„¶ï¼Œå³å¯èƒ½æ€§ï¼›é¡¾åæ€ä¹‰ï¼Œåˆ™ä¼¼ç„¶å‡½æ•°å°±æ˜¯å…³äºå¯èƒ½æ€§çš„å‡½æ•°äº†ã€‚åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œå®ƒè¡¨ç¤ºäº†æ¨¡å‹å‚æ•°çš„ä¼¼ç„¶æ€§ï¼Œå³ä½œä¸ºç»Ÿè®¡æ¨¡å‹ä¸­å‚æ•°çš„å‡½æ•°ã€‚ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math display&quot;&gt;\[ L(\omega)=p(D | \omega) = p(x_1, x_2, \cdots ,x_n| \omega) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;è¡¨ç¤ºæ ·æœ¬é›†&lt;span class=&quot;math inline&quot;&gt;\(\{x_1,x_2,\cdots, x_n\}\)&lt;/span&gt;, â€‚&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;è¡¨ç¤ºå‚æ•°å‘é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¼¼ç„¶å‡½æ•°è¡¨ç¤ºäº†åœ¨ä¸åŒçš„å‚æ•°å‘é‡&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;ä¸‹ï¼Œè§‚æµ‹æ•°æ®å‡ºç°çš„å¯èƒ½æ€§çš„å¤§å°ï¼Œå®ƒæ˜¯å‚æ•°å‘é‡&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„å‡½æ•°ã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå…¶æ˜¯æ¡ä»¶æ¦‚ç‡çš„é€†å&lt;span class=&quot;math inline&quot;&gt;\(^{[1]}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œåˆ©ç”¨Wikipedia&lt;span class=&quot;math inline&quot;&gt;\(^{[1]}\)&lt;/span&gt;ä¸­çš„ä¾‹å­ç®€è¦è¯´æ˜ä¸€ä¸‹ä¼¼ç„¶å‡½æ•°ï¼ŒåŒæ—¶ä¹Ÿå¼•å‡ºæå¤§ä¼¼ç„¶ä¼°è®¡ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;31&quot;&gt;
&lt;p&gt;è€ƒè™‘ä¼˜è´¨ä¸€æšç¡¬å¸çš„å®éªŒï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬çš„ç¡¬å¸éƒ½æ˜¯â€œå…¬å¹³â€ï¼ˆè´¨åœ°å‡åŒ€ï¼‰çš„ï¼Œå³æ­£é¢å‘ä¸Šï¼ˆHeadï¼‰çš„æ¦‚ç‡&lt;span class=&quot;math inline&quot;&gt;\(p_H=0.5\)&lt;/span&gt;ï¼Œç”±æ­¤æ¦‚ç‡æˆ‘ä»¬å¯ä»¥çŸ¥é“æŠ•æ·è‹¥å¹²æ¬¡åå„ç§ç»“æœå‡ºç°çš„å¯èƒ½æ€§ï¼ˆæ¦‚ç‡ï¼Œæˆ–ç„¶æ€§ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼ŒæŠ•æ·ç¡¬å¸ä¸¤æ¬¡ï¼Œä¸¤æ¬¡éƒ½ä¸ºä¸Šçš„æ¦‚ç‡ä¸º0.25ï¼Œåˆ©ç”¨æ¡ä»¶æ¦‚ç‡è¡¨ç¤ºï¼Œå³ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ P(HH|p_h=0.5)=0.5^2=0.25 \]&lt;/span&gt;&lt;br/&gt;å¦‚æœä¸€ä¸ªç¡¬å¸å¹¶éè´¨åœ°å‡åŒ€ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½æ˜¯ä¸€æšâ€œéå…¬å¹³â€çš„ã€‚åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯&lt;strong&gt;å·²çŸ¥ä¸€ç³»åˆ—æŠ•æ·çš„ç»“æœæ—¶ï¼Œå…³äºç¡¬å¸æŠ•æ·æ—¶æ­£é¢æœä¸Šçš„å¯èƒ½æ€§çš„ä¿¡æ¯&lt;/strong&gt;ã€‚æˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªç»Ÿè®¡æ¨¡å‹ï¼šå‡è®¾ç¡¬å¸æŠ•å‡ºæ—¶ä¼šæœ‰&lt;span class=&quot;math inline&quot;&gt;\(p_H\)&lt;/span&gt;çš„æ¦‚ç‡æ­£é¢æœä¸Šï¼Œåˆ™æœ‰&lt;span class=&quot;math inline&quot;&gt;\(1-p_H\)&lt;/span&gt;çš„æ¦‚ç‡åé¢æœä¸Šã€‚è¿™æ—¶é€šè¿‡&lt;strong&gt;è§‚å¯Ÿå·²å‘ç”Ÿçš„&lt;/strong&gt;ä¸¤æ¬¡æŠ•æ·ï¼Œæ¡ä»¶æ¦‚ç‡å¯ä»¥æ”¹å†™æˆä¼¼ç„¶å‡½æ•°ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ L(p_H)=P(HH|p_H=0.5)=0.25 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºå–å®šçš„ä¼¼ç„¶å‡½æ•°ï¼Œåœ¨è§‚æµ‹åˆ°ä¸¤æ¬¡æŠ•æ·éƒ½æ˜¯æ­£é¢æœä¸Šæ—¶ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p_H\)&lt;/span&gt;çš„&lt;strong&gt;ä¼¼ç„¶æ€§&lt;/strong&gt;æ˜¯0.25ã€‚æ³¨æ„ï¼Œåä¹‹å¹¶ä¸æˆç«‹ï¼Œ&lt;strong&gt;å³å½“ä¼¼ç„¶å‡½æ•°ä¸º0.25æ—¶ï¼Œä¸èƒ½æ¨è®ºå‡º&lt;span class=&quot;math inline&quot;&gt;\(p_H=0.25\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè€ƒè™‘&lt;span class=&quot;math inline&quot;&gt;\(p_H=0.6\)&lt;/span&gt;ï¼Œé‚£ä¼¼ç„¶å‡½æ•°ä¹Ÿä¼šæ”¹å˜ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ L(p_H)=P(HH|p_H=0.6)=0.36 \]&lt;/span&gt;&lt;br/&gt;å¦‚å›¾æ‰€ç¤ºï¼Œæ³¨æ„åˆ°ä¼¼ç„¶å‡½æ•°çš„å€¼å˜å¤§äº†ã€‚è¿™è¯´æ˜ï¼Œå¦‚æœå‚æ•°&lt;span class=&quot;math inline&quot;&gt;\(p_H\)&lt;/span&gt;å–å€¼å˜æˆ0.6çš„è¯ï¼Œç»“æœè§‚æµ‹åˆ°è¿ç»­ä¸¤æ¬¡æ­£é¢æœä¸Šçš„æ¦‚ç‡æ¯”å‡è®¾&lt;span class=&quot;math inline&quot;&gt;\(p_H=0.5\)&lt;/span&gt;æ—¶æ›´å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‚æ•°&lt;span class=&quot;math inline&quot;&gt;\(p_H\)&lt;/span&gt;å–0.6è¦æ¯”å–æˆ0.5æ›´æœ‰è¯´æœåŠ›ï¼Œæ›´ä¸º&quot;&lt;strong&gt;åˆç†&lt;/strong&gt;&quot;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cnblogs.com/moonwanderer/p/LikelihoodFunctionAfterHH.png&quot; alt=&quot;img&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œ&lt;strong&gt;ä¼¼ç„¶å‡½æ•°çš„é‡è¦æ€§ä¸æ˜¯å®ƒçš„å…·ä½“å–å€¼ï¼Œè€Œæ˜¯å½“å‚æ•°å˜åŒ–æ—¶ï¼Œå‡½æ•°åˆ°åº•å˜å°è¿˜æ˜¯å˜å¤§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯¹åŒä¸€ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œå…¶æ‰€ä»£è¡¨çš„æ¨¡å‹ä¸­ï¼ŒæŸé¡¹å‚æ•°å€¼å…·æœ‰å¤šç§å¯èƒ½ï¼Œä½†å¦‚æœå­˜åœ¨ä¸€ä¸ªå‚æ•°å€¼ï¼Œä½¿å¾—å®ƒçš„å‡½æ•°å€¼æœ€çˆ±çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±æ˜¯è¿™é¡¹å‚æ•°æœ€ä¸ºâ€œåˆç†â€çš„å‚æ•°å€¼ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(p_H\)&lt;/span&gt;å–1æ—¶ï¼Œä¼¼ç„¶å‡½æ•°è¾¾åˆ°æœ€å¤§å€¼ã€‚ä¹Ÿå³æ˜¯ï¼Œå½“è¿ç»­è§‚æµ‹åˆ°ä¸¤æ¬¡æ­£é¢æœä¸Šæ—¶ï¼Œå‡è®¾ç¡¬å¸æŠ•æ·æ—¶æ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º1æ˜¯æœ€åˆç†çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ä¸Šè¿°å¼•ç”¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæç«¯çš„ç»“è®ºï¼Œå³æœªæ¥æ‰€æœ‰çš„æŠ•æ·éƒ½ä¼šæ˜¯æ­£é¢å‘ä¸Šï¼Œè¿™æ˜¯é¢‘ç‡æ´¾è§‚ç‚¹ä¸‹ä½¿ç”¨å¹¿æ³›çš„ä¸€ç§æ–¹æ³•ï¼Œå³æå¤§ä¼¼ç„¶æ³•ã€‚åœ¨ä¸Šé¢çš„è§‚ç‚¹ä¸­ï¼ˆé¢‘ç‡æ´¾ï¼‰ï¼Œ&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå›ºå®šçš„å‚æ•°ï¼Œå®ƒçš„å€¼é€šè¿‡&lt;strong&gt;ä¼°è®¡&lt;/strong&gt;æ¥ç¡®å®šã€‚ä½†æ˜¯åœ¨è´å¶æ–¯æ´¾è§‚ç‚¹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®é›†&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;(å³å®é™…è§‚æµ‹åˆ°çš„æ•°æ®é›†)ï¼Œå‚æ•°çš„ä¸ç¡®å®šæ€§é€šè¿‡&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„æ¦‚ç‡åˆ†å¸ƒæ¥è¡¨è¾¾ã€‚è´å¶æ–¯çš„è§‚ç‚¹æ˜¯å¯¹å…ˆéªŒæ¦‚ç‡çš„åŒ…å«æ˜¯å¾ˆè‡ªç„¶çš„äº‹æƒ…ï¼ŒåŒ…å«å…ˆéªŒæ¦‚ç‡çš„è´å¶æ–¯æ–¹æ³•å°†ä¸ä¼šå¾—åˆ°ä¸Šè¿°çš„æç«¯ç»“è®ºã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿˜æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼Œç¬¬ä¸€ï¼Œä¼¼ç„¶å‡½æ•°ä¸æ˜¯&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå…³äº&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„ç§¯åˆ†å¹¶ä¸ä¸€å®šç­‰äº1ï¼›ç¬¬äºŒï¼Œä¼¼ç„¶&lt;span class=&quot;math inline&quot;&gt;\(\ne\)&lt;/span&gt;æ¦‚ç‡ï¼Œæ¦‚ç‡ï¼ˆæˆ–ç„¶æ€§ï¼‰ç”¨äºåœ¨å·²çŸ¥ä¸€äº›å‚æ•°çš„æƒ…å†µä¸‹é¢„æµ‹æ¥ä¸‹æ¥çš„ç»“æœï¼Œä¼¼ç„¶æ€§åˆ™æ˜¯åœ¨å·²çŸ¥æŸäº›ç»“æœæ—¶ï¼Œå¯¹æœ‰å…³å‚æ•°è¿›è¡Œä¼°å€¼ã€‚å…³äºç¬¬äºŒç‚¹ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘æœ‰ä¸€æšç¡¬å¸ï¼Œå¦‚æœæ˜¯è´¨åœ°å‡åŒ€çš„ï¼ˆ&lt;strong&gt;å·²çŸ¥å‚æ•°&lt;/strong&gt;ï¼‰ï¼Œé‚£ä¹ˆå®ƒå‡ºç°æ­£é¢æœä¸Šçš„&lt;strong&gt;æ¦‚ç‡&lt;/strong&gt;ä¸º0.5ï¼ˆ&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼‰ï¼›åŒæ ·åœ°ï¼Œå¦‚æœä¸€æšç¡¬å¸ï¼Œæˆ‘æŠ›äº†100æ¬¡ï¼Œæ­£é¢æœä¸Š52æ¬¡ï¼ˆç»“æœï¼‰ï¼Œé‚£ä¹ˆæˆ‘è®¤ä¸ºç¡¬å¸åæœ‰å…«ä¹æ˜¯è´¨åœ°å‡åŒ€çš„ï¼ˆ&lt;strong&gt;ä¼°è®¡å‚æ•°&lt;/strong&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æå¤§ä¼¼ç„¶ä¼°è®¡maximum-likelihood-estimation-mle&quot;&gt;2. æå¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆmaximum likelihood estimationï¼Œ MLEï¼‰&lt;/h3&gt;
&lt;p&gt;äº†è§£äº†ä¼¼ç„¶å‡½æ•°ï¼Œé‚£ä¹ˆæå¤§ä¼¼ç„¶ä¼°è®¡æ˜¯ä»€ä¹ˆå°±å¾ˆå¥½ç†è§£äº†ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨æ¥ä¼°è®¡ä¸€ä¸ª&lt;strong&gt;æ¦‚ç‡æ¨¡å‹å‚æ•°&lt;/strong&gt;çš„æ–¹æ³•ã€‚æ ¹æ®å…¬å¼ï¼ˆ2ï¼‰ï¼Œæˆ‘ä»¬ä¸€æ—¦è·å¾—ä¸€ä¸ªæ•°æ®é›†&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;ï¼Œé‚£æˆ‘ä»¬å°±èƒ½æ±‚å¾—ä¸€ä¸ªå…³äº&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„ä¼°è®¡ï¼Œæå¤§ä¼¼ç„¶ä¼°è®¡ä¼šå¯»æ‰¾ä¸€ä¸ªæœ€å¯èƒ½çš„å€¼ï¼ˆæ­¤å¤„çš„å¯èƒ½æ˜¯æœ€å¯èƒ½çš„&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;ï¼Œè¿™ä¸ª&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;å¯ä»¥ä½¿å‡ºç°é‡‡æ ·&lt;span class=&quot;math inline&quot;&gt;\(D\)&lt;/span&gt;çš„å¯èƒ½æ€§æœ€å¤§åŒ–ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä»æ•°å­¦ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„æ‰€æœ‰å–å€¼ä¸­ï¼Œå¯»æ‰¾ä¸€ä¸ªå€¼ä½¿å¾—ä¼¼ç„¶å‡½æ•°è¾¾åˆ°æœ€å¤§å€¼ï¼Œè¿™ç§ä¼°è®¡æ–¹æ³•ç§°ä¹‹ä¸ºæå¤§ä¼¼ç„¶ä¼°è®¡ã€‚æå¤§ä¼¼ç„¶ä¼°è®¡æ˜¯æ ·æœ¬ä¸å˜æ—¶ï¼Œå…³äº&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;çš„å‡½æ•°ã€‚æå¤§ä¼¼ç„¶ä¼°è®¡ä¸ä¸€å®šå­˜åœ¨ï¼Œä¹Ÿä¸ä¸€å®šå”¯ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç¬¬1èŠ‚ä¸­é¢„æµ‹ç¡¬å¸çš„è´¨åœ°&lt;span class=&quot;math inline&quot;&gt;\(\omega\)&lt;/span&gt;ï¼Œæ˜¯å…³äºæå¤§ä¼¼ç„¶ä¼°è®¡çš„ä¸€ä¸ªç»å…¸ä¾‹å­ã€‚å…¶ä»–ä¾‹å­å¯ä»¥æŸ¥çœ‹å‚è€ƒæ–‡çŒ®&lt;span class=&quot;math inline&quot;&gt;\(^{[2]}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬çœ‹ä¸€ä¸‹æå¤§ä¼¼ç„¶ä¼°è®¡åœ¨æ­£æ€åˆ†å¸ƒä¸­çš„åº”ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;ç°åœ¨å‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªè§‚æµ‹çš„æ•°æ®é›†&lt;span class=&quot;math inline&quot;&gt;\(\mathbf{x}=(x_1,\cdots,x_N)^T\)&lt;/span&gt;ï¼Œè¡¨ç¤ºæ ‡é‡å˜é‡&lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt;çš„Næ¬¡è§‚æµ‹ã€‚æˆ‘ä»¬å‡å®šå„æ¬¡è§‚æµ‹æ˜¯ç‹¬ç«‹åœ°ä»é«˜æ–¯åˆ†å¸ƒä¸­æŠ½å–ï¼Œåˆ†å¸ƒçš„å‡å€¼&lt;span class=&quot;math inline&quot;&gt;\(\mu\)&lt;/span&gt;å’Œæ–¹å·®&lt;span class=&quot;math inline&quot;&gt;\(\sigma^2\)&lt;/span&gt;æœªçŸ¥ï¼Œæˆ‘ä»¬æƒ³æ ¹æ®æ•°æ®é›†æ¥ç¡®å®šè¿™äº›å‚æ•°ã€‚ä¸¤ä¸ªç‹¬ç«‹äº‹ä»¶çš„è”åˆæ¦‚ç‡å¯ä»¥ç”±å„ä¸ªäº‹ä»¶çš„è¾¹ç¼˜æ¦‚ç‡çš„ä¹˜ç§¯å¾—åˆ°ã€‚æˆ‘ä»¬çš„æ•°æ®é›†&lt;span class=&quot;math inline&quot;&gt;\(\mathbf{x}\)&lt;/span&gt;æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼Œå› æ­¤ç»™å®š&lt;span class=&quot;math inline&quot;&gt;\(\mu\)&lt;/span&gt;å’Œ&lt;span class=&quot;math inline&quot;&gt;\(\sigma^2\)&lt;/span&gt;ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºé«˜æ–¯åˆ†å¸ƒçš„ä¼¼ç„¶å‡½æ•°ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ p(\mathbf{x}|\mu,\sigma^2)=\prod_{n=1}^{N}\mathcal{N}(x_n|\mu,\sigma^2) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç®€åŒ–åˆ†æå’Œæœ‰åŠ©äºæ•°å€¼è¿ç®—,æˆ‘ä»¬å–ä¼¼ç„¶å‡½æ•°çš„å¯¹æ•°ï¼ˆ&lt;strong&gt;æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ç­‰ä»·äºæœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼Œå¾ˆå®¹æ˜“è¯æ˜&lt;/strong&gt;ï¼‰:&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ ln(\mathbf x|\mu,\sigma^2)=-\frac {1} {2\sigma^2} \sum_{n=1}^{N}(x_n-\mu)^2-\frac {N}{2}ln\sigma^2-\frac{N}{2}ln(2\pi) \]&lt;/span&gt;&lt;br/&gt;å…³äº&lt;span class=&quot;math inline&quot;&gt;\(\mu\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œå¾—åˆ°&lt;span class=&quot;math inline&quot;&gt;\(\mu\)&lt;/span&gt;çš„æœ€å¤§ä¼¼ç„¶è§£ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ \mu_{ML}=\frac {1}{N} \sum_{n=1}^{N}x_n \]&lt;/span&gt;&lt;br/&gt;å¯çœ‹åˆ°è§£ä¸ºæ ·æœ¬å‡å€¼ã€‚åŒç†ï¼Œæ–¹å·®&lt;span class=&quot;math inline&quot;&gt;\(\sigma^2\)&lt;/span&gt;çš„æœ€å¤§ä¼¼ç„¶è§£ä¸ºï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ \sigma_{ML}^2=\frac {1}{N} \sum_{n=1}^{N}(x_n-\mu_{ML})^2 \]&lt;/span&gt;&lt;br/&gt;ç”±æ­¤å®Œæˆäº†æ­£æ€åˆ†å¸ƒçš„æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æå¤§ä¼¼ç„¶çš„æœ‰åæ€§&quot;&gt;3. æå¤§ä¼¼ç„¶çš„æœ‰åæ€§&lt;/h3&gt;
&lt;p&gt;æå¤§ä¼¼ç„¶ä¼°è®¡æ–¹æ³•æ±‚è§£å‚æ•°æœ‰ä¸€å®šå±€é™æ€§&lt;span class=&quot;math inline&quot;&gt;\(^{[3]}\)&lt;/span&gt;ï¼Œæå¤§ä¼¼ç„¶æ³•é™¤äº†ä¼šå¾—å‡ºç¬¬1èŠ‚ä¸­å…³äºç¡¬å¸çš„æç«¯æƒ…å†µå¤–ï¼Œè¿˜ä¼šå‡ºç°ä¸€ç§æƒ…å†µï¼Œ&lt;strong&gt;æœ‰åä¼°è®¡&lt;/strong&gt;ï¼Œå°±æ˜¯æœŸæœ›&lt;span class=&quot;math inline&quot;&gt;\(\ne\)&lt;/span&gt;ç†æƒ³å€¼ã€‚æœ€å¤§ä¼¼ç„¶æ–¹æ³•ä¼šç³»ç»ŸåŒ–åœ°ä½ä¼°åˆ†å¸ƒçš„æ–¹å·®ã€‚ä¸‹é¢è¿›è¡Œè¯æ˜ï¼š&lt;/p&gt;
&lt;p&gt;å‡å€¼çš„ä¼°è®¡&lt;span class=&quot;math inline&quot;&gt;\(\mu_{ML}\)&lt;/span&gt;çš„æœŸæœ›&lt;span class=&quot;math inline&quot;&gt;\(E[\mu_{ML}]\)&lt;/span&gt;ä¸º:&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ E(\mu_{ML})=E(\frac{1}{N} \sum_{n=1}^{N}x_n)=\frac {1}{N}E({\sum_{n=1}^{N}x_n})=\frac{1}{N}\sum_{n=1}^{N}E(x_n)=\mu \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ–¹å·®çš„ä¼°è®¡&lt;span class=&quot;math inline&quot;&gt;\(\sigma^2\)&lt;/span&gt;çš„æœŸæœ›&lt;span class=&quot;math inline&quot;&gt;\(E[\sigma_{ML}^2]\)&lt;/span&gt;ä¸ºï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ E[\sigma_{ML}^2]=E(\frac {1}{N} \sum_{n=1}^{N}(x_n-\mu_{ML})^2)=E(\frac{1}{N}\sum_{n=1}^{N}x_n^2-\mu_{ML}^2)=\frac {1}{N}\sum_{n=1}^{N}E(x_n^2)-E(\mu_{ML}^2) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ±‚å…¶åä¸¤é¡¹ï¼Œæ­£æ€åˆ†å¸ƒçš„äºŒé˜¶çŸ©ä¸º&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ E(x_n^2)=\mu^2+\sigma^2 \]&lt;/span&gt;&lt;br/&gt;è€Œ&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math display&quot;&gt;\[ E(\mu_{ML}^2)=E((\frac{x_1+x_2+x_3+\cdots+x_n}{n})^2)=\frac{1}{n^2}(n^2\mu^2+n\sigma^2) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ•…ï¼š&lt;br/&gt;&lt;span class=&quot;math display&quot;&gt;\[ E[\sigma_{ML}^2]=\frac{n-1}{n}\sigma^2 \]&lt;/span&gt;&lt;br/&gt;ç”±æ­¤è¯æ˜äº†æå¤§ä¼¼ç„¶çš„æœ‰åæ€§ã€‚å…¶ä¸­å…¬å¼ï¼ˆ12ï¼‰å’Œå…¬å¼ï¼ˆ13ï¼‰çš„è¯æ˜å¯è‡ªè¡Œå‚è€ƒæ­£æ€åˆ†å¸ƒçš„åŸºç¡€çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼ŒPRML&lt;span class=&quot;math inline&quot;&gt;\(^{[3]}\)&lt;/span&gt;ç»™å‡ºäº†æ›´ç›´è§‚åœ°è§£é‡Šï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cnblogs.com/moonwanderer/p/1570894486589.png&quot; alt=&quot;1570894486589&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œç»¿è‰²æ›²çº¿è¡¨ç¤ºçœŸå®é«˜æ–¯åˆ†å¸ƒï¼Œæ•°æ®ç‚¹æ˜¯æ ¹æ®æ­¤æ¦‚ç‡åˆ†å¸ƒç”Ÿæˆï¼Œä¸‰æ¡çº¢è‰²åˆ†åˆ«æ‹Ÿåˆäº†ä¸‰ä¸ªé«˜æ–¯æ¦‚ç‡åˆ†å¸ƒï¼Œæ¯ä¸ªæ•°æ®é›†åŒ…å«äº†ä¸¤ä¸ªè“è‰²æ•°æ®ç‚¹ï¼Œå¯¹ä¸‰ä¸ªæ•°æ®é›†æ±‚å¹³å‡ï¼Œå¾ˆæ˜æ˜¾æ–¹å·®è¢«ä½ä¼°äº†ã€‚&lt;strong&gt;å› ä¸ºå®ƒæ˜¯ç›¸å¯¹æ ·æœ¬å‡å€¼è¿›è¡Œæµ‹é‡çš„ï¼Œè€Œä¸æ˜¯ç›¸å¯¹çœŸå®çš„å‡å€¼è¿›è¡Œæµ‹é‡&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;åè®°&quot;&gt;4. åè®°&lt;/h3&gt;
&lt;p&gt;æå¤§ä¼¼ç„¶ä½œä¸ºæœºå™¨å­¦ä¹ ä¸­çš„ä¸€ç§æœ€å¸¸ç”¨æ–¹æ³•ï¼Œæ·±åˆ»ç†è§£å…¶å«ä¹‰æ˜¯éå¸¸å¿…è¦ä¸”æœ‰ç”¨çš„ï¼Œåº”è¯¥åƒè¿™å¯¹äºç†è§£æ¦‚ç‡è®ºå’Œä¸€äº›å¸¸è§çš„æ¨¡å‹æœ‰ç€å¾ˆå¤§çš„å¸®åŠ©ã€‚å½“ç„¶ï¼Œæå¤§ä¼¼ç„¶æ³•è¿˜æœ‰ä¸€äº›æ€§è´¨ï¼Œå¦‚&lt;strong&gt;æ³›å‡½ä¸å˜æ€§&lt;/strong&gt;ï¼Œ&lt;strong&gt;æ¸è¡Œçº¿è¡Œä¸º&lt;/strong&gt;ï¼Œé™äºæ—¶é—´ç²¾åŠ›å’Œä¸ªäººæ°´å¹³ï¼Œæ²¡æœ‰ç»™å‡ºè¯æ˜ï¼Œè¯»è€…å¯è‡ªè¡Œå‚è€ƒç»´åŸºç™¾ç§‘&lt;span class=&quot;math inline&quot;&gt;\(^{[2]}\)&lt;/span&gt;ã€‚æ–‡ç« ä¸­å¤§éƒ¨åˆ†å†…å®¹ä¸ºæ€»ç»“å’Œæ‘˜æŠ„ï¼Œå…±å‹‰ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡çŒ®ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0&quot;&gt;https://zh.wikipedia.org/wiki/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1&quot;&gt;https://zh.wikipedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ã€Š &lt;a href=&quot;http://users.isr.ist.utl.pt/~wurmd/Livros/school/Bishop%20-%20Pattern%20Recognition%20And%20Machine%20Learning%20-%20Springer%202006.pdf&quot;&gt;Pattern Recognition and Machine Learning&lt;/a&gt; ã€‹ï¼ˆå³PRMLï¼‰&lt;/li&gt;
&lt;li&gt;ã€ŠTheory of Point Estimationã€‹&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/35670078&quot; class=&quot;uri&quot;&gt;https://www.zhihu.com/question/35670078&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description>
<pubDate>Sat, 12 Oct 2019 17:31:00 +0000</pubDate>
<dc:creator>é£å‰‘å®¢é˜¿é£</dc:creator>
<og:description>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è¦åˆ©ç”¨æå¤§ä¼¼ç„¶æ³•è¿‘ä¼¼æ•°æ®æ•´ä½“çš„åˆ†å¸ƒï¼Œæœ¬ç¯‡æ–‡ç« é€šè¿‡ä»‹ç»æå¤§ä¼¼ç„¶æ³•åŠå…¶ä¸€äº›æ€§è´¨ï¼Œæ—¨åœ¨æ·±å…¥æµ…å‡ºåœ°è§£é‡Šæ¸…æ¥šæå¤§ä¼¼ç„¶æ³•ã€‚ 0. è´å¶æ–¯æ¦‚ç‡ é¦–å…ˆçœ‹ä¸€ä¸‹ç»å…¸çš„è´å¶æ–¯å…¬å¼ï¼š $$ p(Y|X)</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/moonwanderer/p/11664619.html</dc:identifier>
</item>
<item>
<title>.NETæ–—é±¼ç›´æ’­å¼¹å¹•å®¢æˆ·ç«¯ï¼ˆä¸Šï¼‰ - .NETéªšæ“ä½œ</title>
<link>http://www.cnblogs.com/sdflysha/p/20191011-douyu-barrage-with-dotnet.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/sdflysha/p/20191011-douyu-barrage-with-dotnet.html</guid>
<description>&lt;p&gt;ç°åœ¨ç›´æ’­å¹³å°ç”±äº&lt;strong&gt;å¼¹å¹•&lt;/strong&gt;çš„å­˜åœ¨ï¼Œä¸»æ’­ä¸è§‚ä¼—å¯ä»¥æ›´è½»æ¾åœ°è¿›è¡Œäº’åŠ¨ï¼Œéå¸¸å—å¹´è½»ç¾¤ä¼—çš„æ¬¢è¿ã€‚æ–—é±¼TVå°±æ˜¯ä¸€æ¬¾éå¸¸æµè¡Œçš„ç›´æ’­å¹³å°ï¼Œå¼¹å¹•æ›´æ˜¯éå¸¸ç«çˆ†ã€‚çœ‹åˆ°æœ‰ä¸å°‘ä¸»æ’­æ¥å…¥&lt;code&gt;å¼¹å¹•è¯­éŸ³æ’­æŠ¥å™¨&lt;/code&gt;ã€&lt;code&gt;å¼¹å¹•ç‚¹æ­Œ&lt;/code&gt;ç­‰æ¨¡å—ï¼Œè¿™éƒ½éœ€è¦é¦–å…ˆè¿æ¥æ–—é±¼å¼¹å¹•ã€‚&lt;/p&gt;
&lt;p&gt;ç»å¸¸çœ‹åˆ°å…¶å®ƒç¼–ç¨‹è¯­è¨€çš„å¼€å‘è€…ï¼Œåˆ†äº«äº†ä»–ä»¬æ–—é±¼å¼¹å¹•å®¢æˆ·ç«¯çš„ä»£ç ã€‚&lt;code&gt;.NET&lt;/code&gt;å½“ç„¶ä¹Ÿèƒ½åšï¼Œè¿˜èƒ½åšå¾—æ›´å¥½ï¼ˆåªæ˜¯ä¸çŸ¥ä¸ºä½•å¾ˆå°‘è§äººåˆ†äº«ğŸ˜‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;æˆ‘å°†ä½¿ç”¨æ–—é±¼TVå®˜æ–¹å…¬å¼€çš„å¼¹å¹•PDFæ–‡æ¡£ï¼Œä½¿ç”¨&lt;code&gt;Socket&lt;/code&gt;/&lt;code&gt;TcpClient&lt;/code&gt;è¿ç»­æ–—é±¼å¼¹å¹•ï¼›&lt;/li&gt;
&lt;li&gt;åˆ†æå¦‚ä½•åˆ©ç”¨&lt;code&gt;.NET&lt;/code&gt;å¼ºå¤§çš„&lt;code&gt;ValueTask&lt;/code&gt;ç‰¹æ€§ï¼Œåœ¨ä¿æŒä»£ç ç®€æ´çš„åŒæ—¶ï¼Œè½»æ¾äº«å—é«˜æ€§èƒ½å¼‚æ­¥ä»£ç çš„å¿«ä¹ï¼›&lt;/li&gt;
&lt;li&gt;ç„¶åå°†ä½¿ç”¨&lt;code&gt;Reactive Extensions&lt;/code&gt;ï¼ˆ&lt;code&gt;RX&lt;/code&gt;ï¼‰ï¼Œæ¼”ç¤ºå¦‚ä½•å°†ä¸€ç³»åˆ—å¤æ‚çš„å¼¹å¹•æ¥å…¥æ“ä½œï¼Œå°±åƒå†™&lt;code&gt;Hello World&lt;/code&gt;ä¸€èˆ¬å®¹æ˜“ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨æˆ‘è‡ªåˆ¶çš„â€œå‡†æ¸¸æˆå¼•æ“â€&lt;code&gt;FlysEngine&lt;/code&gt;ï¼Œåªéœ€å°‘é‡ä»£ç ï¼Œå³å¯å°†æ–—é±¼TVçš„å¼¹å¹•æ˜¾ç¤ºå·¦å³é£è¿‡çš„æ•ˆæœï¼›&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;æœ¬æ–‡å†…å®¹å¯èƒ½æ¯”è¾ƒå¤šï¼Œå› æ­¤åˆ†ä¸Šã€ä¸‹ä¸¤ç¯‡é˜è¿°ï¼Œä¸Šç¯‡å°†å…·ä½“èŠèŠç¬¬1ã€2ç‚¹ï¼Œç¬¬3ã€4ç‚¹å°†åœ¨ä¸‹ç¯‡è¿›è¡Œï¼Œæ•´ç¯‡å®Œæˆåï¼Œæœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/233608/201910/233608-20191013000802086-1693839442.gif&quot;/&gt;&lt;/p&gt;

&lt;p&gt;ç°åœ¨ç½‘ä¸Šå¯ä»¥è½»æ¾æ‰¾åˆ°&lt;code&gt;æ–—é±¼å¼¹å¹•æœåŠ¡å™¨ç¬¬ä¸‰æ–¹æ¥å…¥åè®®v1.6.2.pdf&lt;/code&gt;ï¼ˆç½‘ä¸Šæœç´¢è¯¥å…³é”®å­—å³å¯æ‰¾åˆ°ï¼‰ã€‚&lt;br/&gt;æ–‡æ¡£æåˆ°ï¼Œç¬¬ä¸‰æ–¹æ¥å…¥å¼¹å¹•æœåŠ¡çš„æœåŠ¡å™¨ä¸º&lt;code&gt;openbarrage.douyutv.com:8601&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;TcpClient&lt;/code&gt;æ¥æ–¹ä¾¿è¿æ¥ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;using (var client = new TcpClient())
{
    client.ConnectAsync(&quot;openbarrage.douyutv.com&quot;, 8601).Wait();
    Stream stream = client.GetStream();
    // do other works
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¥æ–‡æ¡£ä¸­æåˆ°æ‰€æœ‰æ•°æ®åŒ…æ ¼å¼å¦‚ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/233608/201910/233608-20191013000809744-2066118098.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„å‰ä¸¤ä¸ª4å­—èŠ‚çš„æ¶ˆæ¯é•¿åº¦æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;Debug.Assert&lt;/code&gt;è¿›è¡Œæ–­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æ‰€æœ‰æ•°å­—éƒ½ä¸ºå°ç«¯æ•´æ•°ï¼Œåˆšå¥½&lt;code&gt;.NET&lt;/code&gt;çš„&lt;code&gt;BinaryWriter&lt;/code&gt;ç±»é»˜è®¤éƒ½ä»¥å°ç«¯æ•´æ•°è¿›è¡Œè½¬æ¢ã€‚å¯ä»¥åˆ©ç”¨èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè¯»å–ä¸€ä¸ªæ¶ˆæ¯åŒ…çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;using (var reader = new BinaryReader(stream, Encoding.UTF8, true))
{
    var fullMsgLength = reader.ReadInt32();
    var fullMsgLength2 = reader.ReadInt32();
    Debug.Assert(fullMsgLength == fullMsgLength2);

    var length = fullMsgLength - 1 - 4 - 4;
    var packType = reader.ReadInt16();
    Debug.Assert(packType == ServerSendToClient);
    var encrypted = reader.ReadByte();
    Debug.Assert(encrypted == Encrypted);
    var reserved = reader.ReadByte();
    Debug.Assert(reserved == Reserved);

    var bytes = reader.ReadBytes(length);
    var zero = reader.ReadByte();
    Debug.Assert(zero == ByteZero);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶ä¸­&lt;code&gt;bytes&lt;/code&gt;æ—¢æ˜¯æ•°æ®éƒ¨åˆ†ï¼Œæ ¹æ®&lt;code&gt;pdf&lt;/code&gt;æ–‡æ¡£ä¸­çš„è§„å®šï¼Œè¯¥éƒ¨åˆ†ä¸º&lt;code&gt;UTF-8&lt;/code&gt;ç¼–ç ï¼Œåœ¨&lt;code&gt;C#&lt;/code&gt;ä¸­ä½¿ç”¨&lt;code&gt;Encoding.UTF8.GetString()&lt;/code&gt;å³å¯è·å–å…¶å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²é•¿è¿™æ ·å­ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;type@=chatmsg/rid@=633019/ct@=1/uid@=124155/nn@=å¤œç§‘æ‰¬ç¾½/txt@=è¿™ä¸å‹ä¸ªèœ¥èœ´/cid@=602c7f1becf2419962a6520300000000/ic@=avatar@S000@S12@S41@S55_avatar/level@=21/sahf@=0/cst@=1570891500125/bnn@=è³Šå¼€å¿ƒ/bl@=8/brid@=5789561/hc@=21ebd5b2c86c01e0565453e45f14ca5b/el@=/lk@=/urlev@=10/ &lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¥æ ¼å¼ä¸æ˜¯&lt;code&gt;JSON&lt;/code&gt;/&lt;code&gt;XML&lt;/code&gt;ç­‰ï¼Œä½†ä»”ç»†åˆ†æåˆç¡®å®æœ‰é€»è¾‘ï¼Œæœ‰å±‚æ¬¡æ„Ÿï¼Œæ ¹æ®æ–‡æ¡£ï¼Œè¯¥æ ¼å¼ä¸ºæ‰€è°“çš„&lt;code&gt;STT&lt;/code&gt;åºåˆ—åŒ–ï¼Œè¯¥æ ¼å¼åŒ…å«é”®å€¼å¯¹ã€æ•°ç»„ç­‰å¤šç§æ ¼å¼ã€‚ç›¸æ¯”&lt;code&gt;JSON&lt;/code&gt;å¯ä»¥å‡å°‘å¤§é‡çš„å¼•å·&quot;ç©ºé—´å¼€é”€ã€‚è¿˜å¥½åè®®ç®€å•ï¼Œæˆ‘å¯ä»¥é€šè¿‡å¯¥å¯¥å‡ è¡Œä»£ç ï¼Œå³å¯è½¬æ¢ä¸º&lt;code&gt;Json.NET&lt;/code&gt;çš„&lt;code&gt;JToken&lt;/code&gt;æ ¼å¼ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;public static JToken DecodeStringToJObject(string str)
{
    if (str.Contains(&quot;//&quot;)) // æ•°ç»„
    {
        var result = new JArray();
        foreach (var field in str.Split(new[] { &quot;//&quot; }, StringSplitOptions.RemoveEmptyEntries))
        {
            result.Add(DecodeStringToJObject(field));
        }
        return result;
    }
    if (str.Contains(&quot;@=&quot;)) // å¯¹è±¡
    {
        var result = new JObject();
        foreach (var field in str.Split(new[] { '/' }, StringSplitOptions.RemoveEmptyEntries))
        {
            var tokens = field.Split(new[] { &quot;@=&quot; }, StringSplitOptions.None);
            var k = tokens[0];
            var v = UnscapeSlashAt(tokens[1]);
            result[k] = DecodeStringToJObject(v);
        }
        return result;
    }
    else if (str.Contains(&quot;@A=&quot;)) // é”®å€¼å¯¹
    {
        return DecodeStringToJObject(UnscapeSlashAt(str));
    }
    else
    {
        return UnscapeSlashAt(str); // å€¼
    }
}

static string EscapeSlashAt(string str)
{
    return str
        .Replace(&quot;/&quot;, &quot;@S&quot;)
        .Replace(&quot;@&quot;, &quot;@A&quot;);
}

static string UnscapeSlashAt(string str)
{
    return str
        .Replace(&quot;@S&quot;, &quot;/&quot;)
        .Replace(&quot;@A&quot;, &quot;@&quot;);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œå³å¯å°†&lt;code&gt;STT&lt;/code&gt;æ ¼å¼è½¬æ¢ä¸º&lt;code&gt;JSON&lt;/code&gt;æ ¼å¼ï¼Œå› æ­¤åªéœ€åƒ&lt;code&gt;JSON&lt;/code&gt;æ ¼å¼å–å‡º&lt;code&gt;nn&lt;/code&gt;å­—æ®µå’Œ&lt;code&gt;txt&lt;/code&gt;å­—æ®µå³å¯ï¼Œè¿˜æœ‰ä¸€ä¸ª&lt;code&gt;col&lt;/code&gt;å­—æ®µï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šå¼¹å¹•é¢œè‰²ï¼Œæˆ‘å¯ä»¥å°†å…¶è½¬æ¢ä¸º&lt;code&gt;RGB&lt;/code&gt;çš„&lt;code&gt;int32&lt;/code&gt;å€¼ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;Color = (x[&quot;col&quot;] ?? new JValue(0)).Value&amp;lt;int&amp;gt;() switch
{
    1 =&amp;gt; 0xff0000, // çº¢
    2 =&amp;gt; 0x1e87f0, // æµ…è“
    3 =&amp;gt; 0x7ac84b, // æµ…ç»¿
    4 =&amp;gt; 0xff7f00, // æ©™è‰²
    5 =&amp;gt; 0x9b39f4, // ç´«è‰²
    6 =&amp;gt; 0xff69b4, // æ´‹çº¢
    _ =&amp;gt; 0xffffff, // é»˜è®¤ï¼Œç™½è‰²
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¯¥ä»£ç ä½¿ç”¨äº†&lt;code&gt;C# 8.0&lt;/code&gt;çš„&lt;code&gt;switch expression&lt;/code&gt;åŠŸèƒ½ï¼Œå¯ä»¥ä¸€ä¸ªè¡¨è¾¾å¼è½¬æˆæ•´ä¸ªé¢œè‰²è½¬æ¢ï¼Œæ¯”&lt;code&gt;if/else&lt;/code&gt;å’Œ&lt;code&gt;switch/case&lt;/code&gt;è¯­å¥éƒ½ç²¾ç®€ä¸å°‘ï¼Œå¯è°“ä¸€æ°”å‘µæˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;C# 5.0&lt;/code&gt;æä¾›äº†å¼ºå¤§çš„å¼‚æ­¥&lt;code&gt;API&lt;/code&gt;â€”â€”&lt;code&gt;async/await&lt;/code&gt;ï¼Œé€šè¿‡å¼‚æ­¥APIï¼Œä»¥å‰éš¾ä»¥ç”¨ç¼–ç¨‹å®ç°çš„æ“ä½œç°åœ¨å¯ä»¥åƒå†™ä¸²è¡Œä»£ç ä¸€æ ·è½»æ¾å®Œæˆï¼Œè¿˜èƒ½è½»æ¾åŠ å…¥å–æ¶ˆä»»åŠ¡æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç„¶å&lt;code&gt;C# 7.0&lt;/code&gt;å‘å¸ƒäº†&lt;code&gt;ValueTask&lt;/code&gt;ï¼Œ&lt;code&gt;ValueTask&lt;/code&gt;æ˜¯å€¼ç±»å‹ï¼Œå› æ­¤åœ¨é¢‘ç¹è°ƒç”¨å¼‚æ­¥æ“ä½œï¼ˆå¦‚ä½¿ç”¨&lt;code&gt;Stream&lt;/code&gt;è¯»å–å­—èŠ‚ï¼‰æ—¶ï¼Œä¸ä¼šå› ä¸ºåˆ›å»ºè¿‡å¤šçš„&lt;code&gt;Task&lt;/code&gt;è€Œåˆ†é…æ²¡å¿…è¦çš„å†…å­˜ã€‚è¿™é‡Œï¼Œæˆ‘ç¡®å®æ˜¯ä½¿ç”¨&lt;code&gt;TCP&lt;/code&gt;è¿æ¥æµè¯»å–å­—èŠ‚ï¼Œæ˜¯ä½¿ç”¨&lt;code&gt;ValueTask&lt;/code&gt;çš„æœ€ä½³æ—¶æœºã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å°†å°è¯•å°†ä»£ç åˆ‡æ¢ä¸º&lt;code&gt;ValueTask&lt;/code&gt;ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯&lt;code&gt;BinaryReader&lt;/code&gt;ç±»ï¼Œè¯¥ç±»æä¾›äº†ä¾¿åˆ©çš„å­—èŠ‚æ“ä½œæ–¹å¼ï¼Œä¸”èƒ½ç¡®ä¿å­—èŠ‚ç«¯ä¸ºå°ç«¯ï¼Œä½†è¯¥ç±»ä¸æä¾›å¼‚æ­¥&lt;code&gt;API&lt;/code&gt;ï¼Œå› æ­¤éœ€è¦ä½œä¸€äº›ç‰¹æ®Šå¤„ç†ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;public static async Task&amp;lt;string&amp;gt; RecieveAsync(Stream stream, CancellationToken cancellationToken)
{
    int fullMsgLength = await ReadInt32().ConfigureAwait(false);
    int fullMsgLength2 = await ReadInt32().ConfigureAwait(false);
    Debug.Assert(fullMsgLength == fullMsgLength2);

    int length = fullMsgLength - 1 - 4 - 4;
    short packType = await ReadInt16().ConfigureAwait(false);
    Debug.Assert(packType == ServerSendToClient);
    short encrypted = await ReadByte().ConfigureAwait(false);
    Debug.Assert(encrypted == Encrypted);
    short reserved = await ReadByte().ConfigureAwait(false);
    Debug.Assert(reserved == Reserved);

    Memory&amp;lt;byte&amp;gt; bytes = await ReadBytes(length).ConfigureAwait(false);
    byte zero = await ReadByte().ConfigureAwait(false);
    Debug.Assert(zero == ByteZero);

    return Encoding.UTF8.GetString(bytes.Span);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚ä»£ç æ‰€ç¤ºï¼Œæˆ‘å°è£…äº†&lt;code&gt;ReadInt16()&lt;/code&gt;å’Œ&lt;code&gt;ReadInt32()&lt;/code&gt;ä¸¤ä¸ªæ–¹æ³•ï¼Œ&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;var intBuffer = new byte[4];
var int32Buffer = new Memory&amp;lt;byte&amp;gt;(intBuffer, 0, 4);

async ValueTask&amp;lt;int&amp;gt; ReadInt32()
{
    var memory = int32Buffer;
    int read = 0;
    while (read &amp;lt; 4)
    {
        read += await stream.ReadAsync(memory.Slice(read), cancellationToken).ConfigureAwait(false);
    }
    Debug.Assert(read == memory.Length);
    return 
        (intBuffer[0] &amp;lt;&amp;lt; 0) + 
        (intBuffer[1] &amp;lt;&amp;lt; 8) +
        (intBuffer[2] &amp;lt;&amp;lt; 16) + 
        (intBuffer[3] &amp;lt;&amp;lt; 24);
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¦‚å›¾ï¼Œæˆ‘è¿˜ä½¿ç”¨äº†ä¸€ä¸ª&lt;code&gt;while&lt;/code&gt;è¯­å¥ï¼Œå› ä¸ºä¸åƒ&lt;code&gt;BinaryReader&lt;/code&gt;ï¼Œå¦‚æœä¸€æ¬¡æ— æ³•è¯»å–æ‰€éœ€çš„å­—èŠ‚æ•°ï¼ˆ4ä¸ªå­—èŠ‚ï¼‰ï¼Œ&lt;code&gt;stream.ReadAsync()&lt;/code&gt;å¹¶ä¸ä¼šå µå¡çº¿ç¨‹ã€‚ç„¶åéœ€è¦å°†&lt;code&gt;int32Buffer&lt;/code&gt;è½¬æ¢ä¸º&lt;code&gt;int&lt;/code&gt;ç±»å‹ã€‚&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;æ³¨æ„ï¼šæ­¤å¤„æˆ‘æ²¡æœ‰ä½¿ç”¨&lt;code&gt;BitConverter.ToInt32()&lt;/code&gt;ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå› ä¸ºè¯¥æ–¹æ³•ä¸åƒ&lt;code&gt;BinaryReader&lt;/code&gt;ï¼Œå®ƒåœ¨å¤§ç«¯/å°ç«¯çš„&lt;code&gt;CPU&lt;/code&gt;ä¸Šä¼šæœ‰ä¸åŒçš„è¡Œä¸ºã€‚ï¼ˆå…¶ä¸­åœ¨å¤§ç«¯&lt;code&gt;CPU&lt;/code&gt;ä¸Šå°†æœ‰é”™è¯¯çš„è¡Œä¸ºï¼‰æ¶‰åŠäºŒè¿›åˆ¶åºåˆ—åŒ–éœ€è¦ä¼ è¾“çš„ï¼Œä¸èƒ½ä½¿ç”¨&lt;code&gt;BitConverter&lt;/code&gt;ç±»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŒæ ·çš„ï¼Œå†™&lt;code&gt;TCP&lt;/code&gt;æµä¹Ÿéœ€è¦æœ‰ç›¸åº”çš„å˜åŒ–ï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;static async Task SendAsync(Stream stream, byte[] body, CancellationToken cancellationToken)
{
    var buffer = new byte[4];
    
    await stream.WriteAsync(GetBytesI32(4 + 4 + body.Length + 1), cancellationToken).ConfigureAwait(false);
    await stream.WriteAsync(GetBytesI32(4 + 4 + body.Length + 1), cancellationToken).ConfigureAwait(false);

    await stream.WriteAsync(GetBytesI16(ClientSendToServer), cancellationToken).ConfigureAwait(false);
    await stream.WriteAsync(new byte[] { Encrypted}, cancellationToken).ConfigureAwait(false);
    await stream.WriteAsync(new byte[] { Reserved}, cancellationToken).ConfigureAwait(false);

    await stream.WriteAsync(body, cancellationToken).ConfigureAwait(false);
    await stream.WriteAsync(new byte[] { ByteZero}, cancellationToken).ConfigureAwait(false);
    
    Memory&amp;lt;byte&amp;gt; GetBytesI32(int v)
    {
        buffer[0] = (byte)v;
        buffer[1] = (byte)(v &amp;gt;&amp;gt; 8);
        buffer[2] = (byte)(v &amp;gt;&amp;gt; 16);
        buffer[3] = (byte)(v &amp;gt;&amp;gt; 24);
        return new Memory&amp;lt;byte&amp;gt;(buffer, 0, 4);
    }

    Memory&amp;lt;byte&amp;gt; GetBytesI16(short v)
    {
        buffer[0] = (byte)v;
        buffer[1] = (byte)(v &amp;gt;&amp;gt; 8);;
        return new Memory&amp;lt;byte&amp;gt;(buffer, 0, 2);
    }
}&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;æœ€ç»ˆè¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/233608/201910/233608-20191013000828693-2124088762.gif&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸€ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨æ–—é±¼två¼€æ”¾å¼¹å¹•&lt;code&gt;API&lt;/code&gt;ï¼Œä¸‹ç¯‡å°†ä¼šï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å…±äº«æœ¬æ–‡æ‰€ä½¿ç”¨çš„æ‰€æœ‰å®Œæ•´çš„æºä»£ç ï¼›&lt;/li&gt;
&lt;li&gt;ä»‹ç»å¦‚ä½•ä½¿ç”¨&lt;code&gt;Reactive Extensions&lt;/code&gt;ï¼ˆ&lt;code&gt;RX&lt;/code&gt;ï¼‰ï¼Œæ¼”ç¤ºè¿™ä¸€ç³»åˆ—æ“ä½œç”¨èµ·æ¥ï¼Œå°±åƒå†™&lt;code&gt;Hello World&lt;/code&gt;ä¸€æ ·ç®€å•ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨æˆ‘è‡ªåˆ¶çš„â€œå‡†æ¸¸æˆå¼•æ“â€&lt;code&gt;FlysEngine&lt;/code&gt;ï¼Œåªéœ€å°‘é‡ä»£ç ï¼Œå³å¯å®ç°æ¡Œé¢å¼¹å¹•çš„æ•ˆæœï¼›&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;æ•¬è¯·æœŸå¾…ï¼â€œåˆ·ä¸€æ³¢666ğŸš€ğŸš€ğŸš€â€&lt;/p&gt;
&lt;p&gt;å–œæ¬¢çš„æœ‹å‹è¯·å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼šã€DotNetéªšæ“ä½œã€‘&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/233608/201908/233608-20190825165420518-990227633.jpg&quot; alt=&quot;DotNetéªšæ“ä½œ&quot;/&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 12 Oct 2019 16:13:00 +0000</pubDate>
<dc:creator>.NETéªšæ“ä½œ</dc:creator>
<og:description>.NETä¹Ÿèƒ½è¿æ–—é±¼TVç›´æ’­å¼¹å¹•</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/sdflysha/p/20191011-douyu-barrage-with-dotnet.html</dc:identifier>
</item>
<item>
<title>pinpoint1.8.5å®‰è£…åŠä½¿ç”¨æŒ‡å— - luozhiyun</title>
<link>http://www.cnblogs.com/luozhiyun/p/11664534.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/luozhiyun/p/11664534.html</guid>
<description>&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;pinpointæ˜¯å¼€æºåœ¨githubä¸Šçš„ä¸€æ¬¾APMç›‘æ§å·¥å…·ï¼Œå®ƒæ˜¯ç”¨Javaç¼–å†™çš„ï¼Œç”¨äºå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿç›‘æ§ã€‚å®ƒå¯¹æ€§èƒ½çš„å½±å“æœ€å°ï¼ˆåªå¢åŠ çº¦3ï¼…èµ„æºåˆ©ç”¨ç‡ï¼‰ï¼Œå®‰è£…agentæ˜¯æ— ä¾µå…¥å¼çš„ã€‚&lt;/p&gt;
&lt;p&gt;å„å¤§APMå·¥å…·ï¼Œå‡ ä¹éƒ½æ˜¯æ ¹æ®googleè¿™ç¯‡ç»å…¸çš„Dapperè®ºæ–‡è€Œæ¥ï¼Œä¸€å®šè¦è¯»ä¸€è¯»ã€‚è¿™é‡Œæ˜¯å®ƒçš„æºæ–‡åœ°å€ï¼šhttps://research.google.com/pubs/pub36356.htmlï¼Œæ„Ÿè°¢è¿™ä½åŒå­¦çš„ç¿»è¯‘ï¼šhttp://bigbully.github.io/Dapper-translation/&lt;/p&gt;
&lt;p&gt;pinpointæä¾›äº†ä¸€äº›åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æœåŠ¡æ˜ å°„ï¼šé€šè¿‡å¯è§†åŒ–å…¶ç»„ä»¶å¦‚ä½•äº’è¿æ¥äº†è§£ä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³è”å…³ç³»ã€‚å•å‡»èŠ‚ç‚¹å¯æ˜¾ç¤ºæœ‰å…³ç»„ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å…¶å½“å‰çŠ¶æ€å’Œäº‹åŠ¡è®¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å®æ—¶çš„æ´»è·ƒçº¿ç¨‹æ•°&lt;/li&gt;
&lt;li&gt;è¯·æ±‚/å“åº”æ•£ç‚¹å›¾&lt;/li&gt;
&lt;li&gt;è°ƒç”¨æ ˆ&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹æœ‰å…³åº”ç”¨ç¨‹åºçš„å…¶ä»–è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚CPUä½¿ç”¨ç‡ï¼Œå†…å­˜/åƒåœ¾æ”¶é›†ï¼ŒTPSå’ŒJVMå‚æ•°&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000736751-1142811357.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªpinpointæ¶æ„åˆ†ä¸º3éƒ¨åˆ†ï¼špinpoint-collectorã€pinpoint-agentã€pinpoint-webUIã€‚&lt;/p&gt;
&lt;p&gt;pinpoint-agentï¼šç”¨æ¥æ”¶é›†å•ä¸ªåº”ç”¨çš„ä¿¡æ¯ï¼Œå¹¶å°†æ”¶é›†å¥½çš„åº”ç”¨ä¿¡æ¯å‘é€åˆ°pinpoint-collectorä¸­&lt;br/&gt;pinpoint-collectorï¼šç”¨æ¥å¤„ç†pinpoint-agentå‘é€è¿‡æ¥çš„ä¿¡æ¯ï¼Œå¹¶å°†ä¿¡æ¯æ”¶é›†å¥½ä¹‹åå­˜å‚¨åˆ°HBaseä¸­&lt;br/&gt;pinpoint-webUIï¼šæŸ¥æ‰¾å‡ºHBaseä¸­çš„æ•°æ®å¹¶å±•ç¤º&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘è¿™é‡Œéœ€è¦å‡†å¤‡ä¸¤å°æœºå™¨ï¼š&lt;br/&gt;10.200.201.xxxï¼šç”¨äºå®‰è£…pinpoint-collectorã€pinpoint-webUIã€HBase&lt;br/&gt;10.200.201.yyyï¼šç”¨äºå®‰è£…pinpoint-agentï¼Œè´Ÿè´£æ”¶é›†åº”ç”¨çš„ä¿¡æ¯&lt;/p&gt;
&lt;h2 id=&quot;ç¯å¢ƒå®‰è£…&quot;&gt;ç¯å¢ƒå®‰è£…&lt;/h2&gt;
&lt;h3 id=&quot;å®‰è£…jdk&quot;&gt;å®‰è£…jdk&lt;/h3&gt;
&lt;p&gt;æˆ‘è¿™é‡Œç”¨çš„æ˜¯rpmåŒ…ç›´æ¥å®‰è£…çš„ï¼šrpm -ivh jdk-8u171-linux-x64.rpm&lt;br/&gt;å®‰è£…å¥½åé…ç½®ä¸€ä¸‹JAVA_HOMEï¼š&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨vimé…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼š&lt;br/&gt;vim /etc/profile&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;export JAVA_HOME=/usr/java/jdk1.8.0_45
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export PATH=$PATH:$JAVA_HOME/bin&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶ååŠ è½½ä¸€äº›profileæ–‡ä»¶ï¼š&lt;br/&gt;source /etc/profile&lt;/p&gt;
&lt;h3 id=&quot;å®‰è£…hbase&quot;&gt;å®‰è£…HBase&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªå¯¹ç…§å›¾ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000751382-1411442897.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç”±ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°HBaseæˆ‘ä»¬éœ€è¦å®‰è£…1.2.xç‰ˆæœ¬çš„&lt;br/&gt;ä¸‹è½½åœ°å€ï¼š&lt;br/&gt;http://archive.apache.org/dist/hbase/&lt;br/&gt;æˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯1.2.12ç‰ˆæœ¬çš„ã€‚&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;å°†Hbseæ”¾åˆ°æŒ‡å®šç›®å½•&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;shell&quot;&gt;
&lt;code&gt;cd /app/install
tar -zxvf hbase-1.2.12-bin.tar.gz&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;ä¿®æ”¹é…ç½®ä¿¡æ¯&lt;br/&gt;ä¿®æ”¹hbase-env.sh&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;shell&quot;&gt;
&lt;code&gt;vim /app/install/hbase-1.2.12/conf/hbase-env.sh

#åŠ å…¥JAVA_HOME
export JAVA_HOME=/usr/java/jdk1.8.0_45&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¿®æ”¹hbase-site.xml&lt;/p&gt;
&lt;pre class=&quot;shell&quot;&gt;
&lt;code&gt;vim /app/install/hbase-1.2.12/conf/hbase-site.xml

&amp;lt;configuration&amp;gt;
        &amp;lt;property&amp;gt;
            &amp;lt;name&amp;gt;hbase.rootdir&amp;lt;/name&amp;gt;
            &amp;lt;value&amp;gt;file:///app/data/hbase&amp;lt;/value&amp;gt;
        &amp;lt;/property&amp;gt;
        &amp;lt;property&amp;gt;
            &amp;lt;name&amp;gt;hbase.zookeeper.property.dataDir&amp;lt;/name&amp;gt;
            &amp;lt;value&amp;gt;/app/data/zookeeper&amp;lt;/value&amp;gt;
        &amp;lt;/property&amp;gt;
        &amp;lt;property&amp;gt;
         &amp;lt;name&amp;gt;hbase.zookeeper.property.clientPort&amp;lt;/name&amp;gt;
         &amp;lt;value&amp;gt;2181&amp;lt;/value&amp;gt;
         &amp;lt;description&amp;gt;Property from ZooKeeper'sconfig zoo.cfg. The port at which the clients will connect.
         &amp;lt;/description&amp;gt;
        &amp;lt;/property&amp;gt;
        &amp;lt;!-- falseæ˜¯å•æœºæ¨¡å¼ï¼Œtrueæ˜¯åˆ†å¸ƒå¼æ¨¡å¼  --&amp;gt;
        &amp;lt;property&amp;gt;
         &amp;lt;name&amp;gt;hbase.cluster.distributed&amp;lt;/name&amp;gt;
         &amp;lt;value&amp;gt;false&amp;lt;/value&amp;gt;
        &amp;lt;/property&amp;gt;
&amp;lt;/configuration&amp;gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;å¯åŠ¨HBase&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;shell&quot;&gt;
&lt;code&gt;cd /app/install/hbase-1.2.12/bin
./start-hbase.sh

# æŸ¥çœ‹Hbaseæ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œå¦‚æœå¯åŠ¨æˆåŠŸçš„ä¼šçœ‹åˆ°&quot;HMaster&quot;çš„è¿›ç¨‹
[root@localhost bin]# jps
12075 Jps
11784 HMaster&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;åˆå§‹åŒ–pinpointåº“&lt;br/&gt;ä¸‹è½½è„šæœ¬ï¼šhttps://github.com/naver/pinpoint/blob/master/hbase/scripts/hbase-create.hbase&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code&gt;#è¿›å…¥åˆ°hbaseçš„binç›®å½•ä¸­
cd /app/install/hbase-1.2.12/bin
#æ‰§è¡Œè„šæœ¬
./bin/hbase shell /app/install/pinpoint/hbase/scripts/hbase-create.hbase

# æ‰§è¡Œå®Œäº†ä»¥åï¼Œè¿›å…¥Hbase
./hbase shell

#è¿›å…¥åå¯ä»¥çœ‹åˆ°Hbaseçš„ç‰ˆæœ¬ï¼Œè¿˜æœ‰ä¸€äº›ç›¸å…³çš„ä¿¡æ¯
2019-10-12 16:18:28,074 WARN  [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
HBase Shell; enter 'help&amp;lt;RETURN&amp;gt;' for list of supported commands.
Type &quot;exit&amp;lt;RETURN&amp;gt;&quot; to leave the HBase Shell
Version 1.2.12, r91d5ec4c4dcd10ceec984c6e663ea82acf353995, Sat Apr  6 15:27:28 CDT 2019

# è¾“å…¥&quot;status 'detailed'&quot;å¯ä»¥æŸ¥çœ‹åˆšæ‰åˆå§‹åŒ–çš„è¡¨ï¼Œæ˜¯å¦å­˜åœ¨
hbase(main):002:0&amp;gt; status 'detailed'&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ç™»å½•webï¼Œæ¥æŸ¥çœ‹HBaseçš„æ•°æ®æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ&lt;br/&gt;http://10.200.201.xxx:16010/master-status&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000807755-867026080.png&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;å®‰è£…pinpoint-collector&quot;&gt;å®‰è£…pinpoint-collector&lt;/h3&gt;
&lt;p&gt;åˆ¶ä½œä¸€ä¸ªtomcatå®¹å™¨ï¼Œç«¯å£å·ä¸º8081&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;#å°†pinpoint-collectorçš„waråŒ…ä¸¢åˆ°Tomcatçš„webappsç›®å½•ä¸‹
cp pinpoint-collector-1.8.5.war ../apache-tomcat-8081/webapps/

#å°†waråŒ…åå­—æ”¹ä¸€ä¸‹
mv pinpoint-web-1.8.5.war pp-collector.war

#å¯åŠ¨tomcat
./bin/startup.sh

# æŸ¥çœ‹æ—¥å¿—ï¼Œæ˜¯å¦æˆåŠŸå¯åŠ¨
tail -f ../logs/catalina.out

#å¦‚æœhbaseå®‰è£…åœ¨åˆ«çš„æœºå™¨ä¸‹éœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®
cd /app/install/apache-tomcat-8081
vim webapps/pp-collector/WEB-INF/classes/hbase.properties
#ä¿®æ”¹hbaseçš„ipå’Œhbaseæ‰€å¯¹åº”çš„ç«¯å£å·
hbase.client.host=10.200.201.xxx
hbase.client.port=2181&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;å®‰è£…pinpoint-web&quot;&gt;å®‰è£…pinpoint-web&lt;/h3&gt;
&lt;p&gt;è§£å‹ä¸€ä¸ªtomcatå®¹å™¨ï¼Œç«¯å£å·ä¸º8080&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;#å°†pinpoint-webæ”¾åˆ°tomcatçš„webappså®¹å™¨ä¸­
cp pinpoint-web-1.8.5.war  ../apache-tomcat-8080/webapps/

#ä¿®æ”¹ä¸€ä¸‹waråŒ…å
mv pinpoint-web-1.8.5.war pp-web.war

#å¯åŠ¨tomcat
./bin/startup.sh

# æŸ¥çœ‹æ—¥å¿—ï¼Œæ˜¯å¦æˆåŠŸå¯åŠ¨
tail -f ../logs/catalina.out

#å¦‚æœhbaseå®‰è£…åœ¨åˆ«çš„æœºå™¨ä¸‹éœ€è¦ä¿®æ”¹ä¸€ä¸‹é…ç½®
cd /app/install/apache-tomcat-8080
vim webapps/pp-web/WEB-INF/classes/hbase.properties

#ä¿®æ”¹hbaseçš„ipå’Œhbaseæ‰€å¯¹åº”çš„ç«¯å£å·
hbase.client.host=10.200.201.xxx
hbase.client.port=2181&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶åå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ï¼šhttp://10.200.201.xxx:8080/pp-web/&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000822492-626272947.png&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;éƒ¨ç½²pinpoint-agenté‡‡é›†ç›‘æ§æ•°æ®&quot;&gt;éƒ¨ç½²pinpoint-agenté‡‡é›†ç›‘æ§æ•°æ®&lt;/h3&gt;
&lt;ol&gt;&lt;li&gt;ä¼ å…¥pinpoint-agentåŒ…&lt;br/&gt;é¦–å…ˆå°†pinpoint-agent-1.8.5.tar.gzä¼ å…¥åˆ°æœåŠ¡å™¨10.200.201.yyyçš„/app/install/pinpoint-agent/ä¸­&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;ç„¶åæ‰§è¡Œtar -zxvf pinpoint-agent-1.8.5.tar.gzè§£å‹&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;é…ç½®pp-agenté‡‡é›†å™¨&lt;/li&gt;
&lt;/ol&gt;&lt;pre class=&quot;shell&quot;&gt;
&lt;code&gt;cd /app/install/pinpoint-agent
vim pinpoint.config

# ä¸»è¦ä¿®æ”¹IPï¼Œåªéœ€è¦æŒ‡å®šåˆ°å®‰è£…pp-colçš„IPå°±è¡Œäº†ï¼Œå®‰è£…pp-colå¯åŠ¨åï¼Œè‡ªåŠ¨å°±å¼€å¯äº†9994ï¼Œ9995ï¼Œ9996çš„ç«¯å£äº†ã€‚è¿™é‡Œå°±ä¸éœ€è¦æ“å¿ƒäº†ï¼Œå¦‚æœæœ‰ç«¯å£éœ€æ±‚ï¼Œè¦å»pp-colçš„é…ç½®æ–‡ä»¶(&quot;pp-collector/webapps/ROOT/WEB-INF/classes/pinpoint-collector.properties&quot;)ä¸­ï¼Œä¿®æ”¹è¿™äº›ç«¯å£
profiler.collector.ip=10.200.201.xxx&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;å¦‚æœç›‘æ§çš„æ˜¯tomcat&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code&gt;# ä¿®æ”¹æµ‹è¯•é¡¹ç›®ä¸‹çš„tomcatå¯åŠ¨æ–‡ä»¶&quot;catalina.sh&quot;ï¼Œä¿®æ”¹è¿™ä¸ªåªè¦æ˜¯ä¸ºäº†ç›‘æ§æµ‹è¯•ç¯å¢ƒçš„Tomcatï¼Œå¢åŠ æ¢é’ˆ
vi catalina.sh

# ç¬¬ä¸€è¡Œæ˜¯pp-agentçš„jaråŒ…ä½ç½®
# ç¬¬äºŒè¡Œæ˜¯agentçš„IDï¼Œè¿™ä¸ªIDæ˜¯å”¯ä¸€çš„ï¼Œæˆ‘æ˜¯ç”¨pp + ä»Šå¤©çš„æ—¥æœŸå‘½åçš„ï¼Œåªè¦ä¸å…¶ä»–çš„é¡¹ç›®çš„IDä¸é‡å¤å°±å¥½äº†
# ç¬¬ä¸‰è¡Œæ˜¯é‡‡é›†é¡¹ç›®çš„åå­—ï¼Œè¿™ä¸ªåå­—å¯ä»¥éšä¾¿å–ï¼Œåªè¦å„ä¸ªé¡¹ç›®ä¸é‡å¤å°±å¥½äº†
CATALINA_OPTS=&quot;$CATALINA_OPTS -javaagent:$AGENT_PATH/pinpoint-bootstrap-$VERSION.jar&quot;
CATALINA_OPTS=&quot;$CATALINA_OPTS -Dpinpoint.agentId=$AGENT_ID&quot;
CATALINA_OPTS=&quot;$CATALINA_OPTS -Dpinpoint.applicationName=$APPLICATION_NAME&quot;

# é…ç½®å¥½äº†ã€‚å°±å¯ä»¥å¼€å§‹ç›‘æ§äº†ï¼Œæˆ‘ä»¬å¯åŠ¨æµ‹è¯•ç”¨çš„Tomcatçš„æœåŠ¡å™¨
cd /data/pp-test/bin/
./startup.sh
 
# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼Œç¡®å®Tomcatå¯åŠ¨
tail -f ../logs/catalina.out&lt;/code&gt;
&lt;/pre&gt;
&lt;ol&gt;&lt;li&gt;springbootåŒ…éƒ¨ç½²&lt;br/&gt;å¦‚æœæ˜¯jaråŒ…éƒ¨ç½²ï¼Œç›´æ¥åœ¨å¯åŠ¨å‘½ä»¤åŠ å¯åŠ¨å‚æ•°ï¼š&lt;/li&gt;
&lt;/ol&gt;&lt;pre&gt;
&lt;code&gt;nohup java -javaagent:/app/install/pinpoint-agent/pinpoint-bootstrap-1.8.5.jar -Dpinpoint.agentId=$AGENT_ID -Dpinpoint.applicationName=$APPLICATION_NAME&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;åŠŸèƒ½è®¾ç½®&quot;&gt;åŠŸèƒ½è®¾ç½®&lt;/h2&gt;
&lt;h3 id=&quot;è®¾ç½®ç›‘æ§&quot;&gt;è®¾ç½®ç›‘æ§&lt;/h3&gt;
&lt;p&gt;å¦‚æœæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å®‰è£…å®Œäº†ä¹‹ååœ¨è¿›è¡Œç›‘æ§è®¾ç½®çš„æˆ–è€…ç”¨æˆ·è®¾ç½®çš„æ—¶å€™ä¼šæŠ¥é”™çš„ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000837145-478275099.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸‹mysqlï¼š&lt;br/&gt;é¦–å…ˆéœ€è¦è·‘ä¸¤ä¸ªsqlè„šæœ¬ï¼š&lt;br/&gt;https://github.com/naver/pinpoint/blob/master/web/src/main/resources/sql/CreateTableStatement-mysql.sql&lt;br/&gt;https://github.com/naver/pinpoint/blob/master/web/src/main/resources/sql/SpringBatchJobRepositorySchema-mysql.sql&lt;/p&gt;
&lt;p&gt;ç„¶åè¿›å…¥åˆ°pinpoint-webçš„waræ‰€åœ¨çš„tomcatçš„å®¹å™¨ä¸­ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šWEB-INF/classes/jdbc.properties&lt;br/&gt;å¹¶è®¾å€¼mysqlçš„è´¦å·å¯†ç &lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;jdbc.url=jdbc:mysql://localhost:13306/pinpoint?characterEncoding=UTF-8
jdbc.username=admin
jdbc.password=admin&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥åœ¨applicationé‡Œé¢ç»™ä¸åŒçš„åº”ç”¨è®¾ç½®ä¸åŒçš„æé†’è§„åˆ™ï¼Œå…·ä½“çš„æé†’è§„åˆ™å¦‚ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1204119/201910/1204119-20191013000848850-1104293135.png&quot;/&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;SLOW COUNTï¼šå‘é€åˆ°åº”ç”¨ç¨‹åºçš„æ…¢é€Ÿè¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘

SLOW RATE
   å‘é€åˆ°åº”ç”¨ç¨‹åºçš„æ…¢é€Ÿè¯·æ±‚çš„ç™¾åˆ†æ¯”ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘

ERROR COUNT
   å‘é€åˆ°åº”ç”¨ç¨‹åºçš„å¤±è´¥è¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚

ERROR RATE
   å‘é€åˆ°åº”ç”¨ç¨‹åºçš„å¤±è´¥è¯·æ±‚çš„ç™¾åˆ†æ¯”ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚

TOTAL COUNT
   å‘é€åˆ°åº”ç”¨ç¨‹åºçš„æ‰€æœ‰è¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚

SLOW COUNT TO CALLEE
   å½“åº”ç”¨ç¨‹åºå‘é€çš„æ…¢é€Ÿè¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚ æ‚¨å¿…é¡»åœ¨é…ç½®UIçš„â€œæ³¨é‡Š...â€æ¡†ä¸­æŒ‡å®šåŸŸæˆ–åœ°å€ï¼ˆIPï¼Œç«¯å£ï¼‰    
     ä¾‹å¦‚ï¼‰www.naver.comï¼Œ127.0.0.1:8080

SLOW RATE TO CALLEE
   å½“åº”ç”¨ç¨‹åºå‘é€çš„æ…¢é€Ÿè¯·æ±‚çš„ç™¾åˆ†æ¯”ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚ æ‚¨å¿…é¡»åœ¨é…ç½®UIçš„â€œæ³¨é‡Š...â€æ¡†ä¸­æŒ‡å®šåŸŸæˆ–åœ°å€ï¼ˆIPï¼Œç«¯å£ï¼‰
   ex) www.naver.com, 127.0.0.1:8080

ERROR COUNT TO CALLEE
   å½“åº”ç”¨ç¨‹åºå‘é€çš„å¤±è´¥è¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚ æ‚¨å¿…é¡»åœ¨é…ç½®UIçš„â€œæ³¨é‡Š...â€æ¡†ä¸­æŒ‡å®šåŸŸæˆ–åœ°å€ï¼ˆIPï¼Œç«¯å£ï¼‰
   ex) www.naver.com, 127.0.0.1:8080

ERROR RATE TO CALLEE
   å½“åº”ç”¨ç¨‹åºå‘é€çš„å¤±è´¥è¯·æ±‚çš„ç™¾åˆ†æ¯”ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚ æ‚¨å¿…é¡»åœ¨é…ç½®UIçš„â€œæ³¨é‡Š...â€æ¡†ä¸­æŒ‡å®šåŸŸæˆ–åœ°å€ï¼ˆIPï¼Œç«¯å£ï¼‰
   ex) www.naver.com, 127.0.0.1:8080

TOTAL COUNT TO CALLEE
   å½“åº”ç”¨ç¨‹åºå‘é€çš„æ‰€æœ‰è¯·æ±‚æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚ æ‚¨å¿…é¡»åœ¨é…ç½®UIçš„â€œæ³¨é‡Š...â€æ¡†ä¸­æŒ‡å®šåŸŸæˆ–åœ°å€ï¼ˆIPï¼Œç«¯å£ï¼‰
   ex) www.naver.com, 127.0.0.1:8080

HEAP USAGE RATE
   å½“åº”ç”¨ç¨‹åºçš„å †ä½¿ç”¨ç‡ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚

JVM CPU USAGE RATE
   å½“åº”ç”¨ç¨‹åºçš„CPUä½¿ç”¨ç‡ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚

SYSTEM CPU USAGE RATE
   å½“åº”ç”¨ç¨‹åºçš„CPUä½¿ç”¨ç‡ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶å‘é€è­¦æŠ¥ã€‚

DATASOURCE CONNECTION USAGE RATE
   å½“åº”ç”¨ç¨‹åºçš„æ•°æ®æºè¿æ¥ä½¿ç”¨ç‡ï¼ˆï¼…ï¼‰è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶è§¦å‘ã€‚
   
FILE DESCRIPTOR COUNT
   å½“æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡è¶…è¿‡é…ç½®çš„é˜ˆå€¼æ—¶ï¼Œå‘é€è­¦æŠ¥ã€‚&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç„¶åéœ€è¦åœ¨webapps/pp-web/WEB-INF/classes/batch.propertiesé‡Œé¢é…ç½®ä¸€ä¸‹é‚®ä»¶æœåŠ¡å™¨çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre class=&quot;properties&quot;&gt;
&lt;code&gt;pinpoint.url= #pinpoint-web server url
alarm.mail.server.url= #smtp server address
alarm.mail.server.port= #smtp server port
alarm.mail.server.username= #username for smtp server authentication
alarm.mail.server.password= #password for smtp server authentication
alarm.mail.sender.address= #sender's email address

#ä¾‹å¦‚
pinpoint.url=http://pinpoint.com
alarm.mail.server.url=stmp.server.com
alarm.mail.server.port=583
alarm.mail.server.username=pinpoint
alarm.mail.server.password=pinpoint
alarm.mail.sender.address=pinpoint_operator@pinpoint.com&lt;/code&gt;
&lt;/pre&gt;</description>
<pubDate>Sat, 12 Oct 2019 16:09:00 +0000</pubDate>
<dc:creator>luozhiyun</dc:creator>
<og:description>ç®€ä»‹ pinpointæ˜¯å¼€æºåœ¨githubä¸Šçš„ä¸€æ¬¾APMç›‘æ§å·¥å…·ï¼Œå®ƒæ˜¯ç”¨Javaç¼–å†™çš„ï¼Œç”¨äºå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿç›‘æ§ã€‚å®ƒå¯¹æ€§èƒ½çš„å½±å“æœ€å°ï¼ˆåªå¢åŠ çº¦3ï¼…èµ„æºåˆ©ç”¨ç‡ï¼‰ï¼Œå®‰è£…agentæ˜¯æ— ä¾µå…¥å¼çš„ã€‚ å„å¤§APM</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/luozhiyun/p/11664534.html</dc:identifier>
</item>
<item>
<title>åŸºäºå…¬å…±å­åºåˆ—çš„è½¨è¿¹èšç±»(c#) - éº¦æ¯”ä¹Œæ–¯çš‡</title>
<link>http://www.cnblogs.com/hsxian/p/11664478.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/hsxian/p/11664478.html</guid>
<description>&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;å¦‚ä»Šçš„ä¸–ç•Œä¸­ï¼Œæƒ³è¦ç ”ç©¶äººä»¬çš„å‡ºè¡Œæ´»åŠ¨ï¼Œå¯ä»¥åˆ©ç”¨æ™ºèƒ½æ‰‹æœºæˆ–æ™ºèƒ½æ‰‹ç¯ç­‰ä¸ªäººè®¾å¤‡ç”Ÿæˆçš„ GPS æ•°æ®è¿›è¡Œç ”ç©¶ã€‚è€Œåœ¨ä¼—å¤šçš„ç ”ç©¶æ–¹å‘ä¸­ï¼Œå‡ºè¡Œçš„çƒ­ç‚¹è·¯çº¿æˆ–è€…è¯´ç»å¸¸å‡ºè¡Œçš„è·¯çº¿ä¹Ÿæ¯”è¾ƒå—æ¬¢è¿ã€‚é‡‡ç”¨çƒ­åŠ›å›¾çš„æ–¹å¼å¯¹å…¶è¿›è¡Œç ”ç©¶å…·æœ‰è®¸å¤šä¼˜ç‚¹ã€‚çƒ­åŠ›å›¾ç»™ä½¿ç”¨è€…çš„æ„Ÿè§‰å°±æ˜¯ç‰¹åˆ«ç›´è§‚ï¼Œä¸€çœ¼ä¾¿çœ‹å‡ºæ¥å“ªäº›è·¯å¾„å±äºçƒ­è¿¹ï¼ˆæˆ‘ä»¬æŠŠçƒ­ç‚¹è·¯çº¿ï¼Œä¹Ÿå°±æ˜¯é‡å¤åº¦é«˜çš„è·¯çº¿ç§°ä¸ºçƒ­è¿¹ï¼‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1214143/201910/1214143-20191012234018795-1830294094.jpg&quot;/&gt;ï¼ˆå›¾ç‰‡æ¥è‡ªç½‘ä¸Šï¼Œä¾µåˆ ï¼‰&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­æˆ‘ä»¬ä¸€çœ¼ä¾¿èƒ½å¤Ÿæ‰¾å‡ºä¸¤æ¡ç²—å£®çš„çƒ­è¿¹ã€‚è¿™è¡¨ç¤ºæœ‰æŸç§ç‰©ä½“ç»å¸¸æ²¿ç€ä¸¤æ¡è·¯çº¿è¿åŠ¨ã€‚ä½†å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œè¦ä»å›¾ä¸­æ‰¾å‡ºè¿™ä¸¤æ¡çƒ­è¿¹ï¼Œå¹¶åŠ ä»¥åŒºåˆ†å½¢æˆä¸¤æ¡å®Œæ•´çš„è·¯çº¿å¯ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½ç›´æ¥ä»è½¨è¿¹ä¸Šå…¥æ‰‹ã€‚æ¥ä¸‹æ¥å°†ä»‹ç»åˆ©ç”¨å…¬å…±å­åºåˆ—è¿›è¡Œè½¨è¿¹èšç±»çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥èšç±»æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç›¸ä¼¼çš„è½¨è¿¹åœ¨åœ°ç†ç©ºé—´ä¸­å æœ‰çš„ä½ç½®åŸºæœ¬ä¸€è‡´ï¼Œè½¨è¿¹è¶Šç›¸ä¼¼å…¶å…±æœ‰çš„ä½ç½®å åŸè½¨è¿¹ç©ºé—´çš„æ¯”é‡è¶Šå¤§ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬åˆ’åˆ†è½¨è¿¹çš„ç²¾åº¦é™ä½è€Œæé«˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ•°æ®å‡†å¤‡&quot;&gt;æ•°æ®å‡†å¤‡&lt;/h2&gt;
&lt;h3 id=&quot;gps-æ•°æ®å‡†å¤‡&quot;&gt;Gps æ•°æ®å‡†å¤‡&lt;/h3&gt;
&lt;p&gt;ç ”ç©¶è½¨è¿¹èšç±»ï¼Œæœ€åŸºæœ¬çš„è¦æ±‚å°±æ˜¯æ‹¥æœ‰å¤§é‡çš„è½¨è¿¹æ•°æ®ã€‚å¹¸è¿çš„ï¼Œæˆ‘ä»ç½‘ä¸Šçš„é¡¹ç›®ä¸­æ‰¾åˆ°äº†å…¬å¼€çš„ Gps æ•°æ®ã€‚ä¸ºä»€ä¹ˆè¯´æ˜¯å¹¸è¿çš„ï¼Ÿåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æ›¾å†™è¿‡ä¸€ä¸ª Appï¼Œä»¥æœŸæ”¶é›†è‡ªå·±çš„å‡ºè¡Œè½¨è¿¹è¿›è¡Œç ”ç©¶ã€‚è¯¥åº”ç”¨çš„ç¡®è¾¾åˆ°äº†é¢„æœŸï¼Œä½†å›°éš¾çš„æ˜¯æ‰‹æœºè¦å¼€å¯ Gps æ‰èƒ½å¾—åˆ°æ¯”è¾ƒç²¾å‡†çš„è½¨è¿¹æ•°æ®ï¼Œè¿™æ˜¾ç„¶æé«˜äº†æ‰‹æœºç”µé‡çš„è¦æ±‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ”¶é›†ä¼—å¤šçš„è½¨è¿¹éœ€è¦å¤§é‡æ—¶é—´ã€ä¸Šç­æ—è½¨è¿¹ç›¸å¯¹å›ºå®šç­‰ä¸€ç³»åˆ—å› ç´ å¯¼è‡´æ”¶é›†è‡ªå·±çš„è½¨è¿¹è®¡åˆ’å¤­æŠ˜ã€‚è€Œåœ¨ç½‘ä¸Šæ‰¾åˆ°çš„æ•°æ®å®Œå…¨æ»¡è¶³ç ”ç©¶è¦æ±‚ã€‚è¿™äº›æ•°æ®æ¥è‡ªäºå¾®è½¯äºšæ´²ç ”ç©¶é™¢çš„é¡¹ç›® &lt;a href=&quot;https://www.microsoft.com/en-us/research/project/geolife-building-social-networks-using-human-location-history/?from=http%3A%2F%2Fresearch.microsoft.com%2Fen-us%2Fprojects%2Fgeolife%2Fdefault.aspx&quot;&gt;&lt;strong&gt;Geolife&lt;/strong&gt;&lt;/a&gt;ï¼Œæ˜¯æ¯ä¸ªäººéƒ½èƒ½å¤Ÿè·å–çš„ã€‚è¯¥æ•°æ®ä»¥ plt ä¸ºæ–‡ä»¶åç¼€å­˜å‚¨ï¼Œä½†å®é™…ä¸Šå°±æ˜¯æ™®é€šçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”é™¤äº†å‰å…­è¡Œå¤–å°±æ˜¯ csv æ ¼å¼çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1214143/201910/1214143-20191012234101471-1608525274.png&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;è½¨è¿¹æ•°æ®æ¨¡å‹ç±»&quot;&gt;è½¨è¿¹æ•°æ®æ¨¡å‹ç±»&lt;/h3&gt;
&lt;p&gt;è¿™æ˜¯æœ¬é¡¹ç›®ä¸­ç”¨åˆ°çš„æ•°æ®ç±»æ¨¡å‹&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;//è½¨è¿¹æ•°æ®ç‚¹é€šç”¨æ¨¡å‹ï¼ˆä»¥æ¥å£å®šä¹‰ï¼‰
public interface IGeoInfoModel
{
    float Latitude { get; set; }
    float Longitude { get; set; }
}

//è½¨è¿¹ç±»
public class Trajectory
{
    public Guid Id { get; }
    public Trajectory()
    {
        Id = Guid.NewGuid();
    }
    public string Name { get; set; }
    public List&amp;lt;IGeoInfoModel&amp;gt; GeoPoints { get; set; }//è½¨è¿¹ç‚¹é›†
    public List&amp;lt;string&amp;gt; GeoCodes { get; set; }//è½¨è¿¹ç¼–ç é›†
    public Trajectory Parent { get; set; }//è½¨è¿¹çš„çˆ¶äº²
    //è½¨è¿¹çš„å…„å¼Ÿå§å¦¹ï¼Œè¯¥é›†åˆä¸­çš„è½¨è¿¹ä¸è¯¥è½¨è¿¹ç›¸ä¼¼åº¦æé«˜ï¼ˆçº¿ç¨‹å®‰å…¨é›†åˆï¼‰
    public ConcurrentBag&amp;lt;Trajectory&amp;gt; Siblings { get; } = new ConcurrentBag&amp;lt;Trajectory&amp;gt;();
    //è½¨è¿¹çš„åè¾ˆï¼Œè¯¥é›†åˆä¸­çš„è½¨è¿¹ä¸è¯¥è½¨è¿¹å…·æœ‰ä¸€å®šç›¸ä¼¼æ€§ï¼Œä½†ä½äºå…„å¼Ÿå§å¦¹ï¼ˆçº¿ç¨‹å®‰å…¨é›†åˆï¼‰
    public ConcurrentBag&amp;lt;Trajectory&amp;gt; Children { get; } = new ConcurrentBag&amp;lt;Trajectory&amp;gt;();
    public float MinLat =&amp;gt; GeoPoints.Min(t =&amp;gt; t.Latitude);
    public float MinLon =&amp;gt; GeoPoints.Min(t =&amp;gt; t.Longitude);
    public float MaxLat =&amp;gt; GeoPoints.Max(t =&amp;gt; t.Latitude);
    public float MaxLon =&amp;gt; GeoPoints.Max(t =&amp;gt; t.Longitude);
    public int Level { get; set; }//è½¨è¿¹åœ¨æ—è°±ä¸­çš„ä»£æ•°/å±‚æ•°
    public string LevelTag { get; set; }//ä»£æ•°æ ‡ç­¾ï¼Œç”¨äºæ‰“å°
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;è½¨è¿¹åºåˆ—äº§ç”Ÿè½¨è¿¹çš„ä½åˆ†è¾¨ç‡ä½ç²¾åº¦æè¿°&quot;&gt;è½¨è¿¹åºåˆ—äº§ç”Ÿï¼ˆè½¨è¿¹çš„ä½åˆ†è¾¨ç‡/ä½ç²¾åº¦æè¿°ï¼‰&lt;/h2&gt;
&lt;p&gt;è¦æ‰¾è½¨è¿¹é—´çš„å…¬å…±å­åºåˆ—ï¼Œé¦–å…ˆå¾—æœ‰å¯ä»¥æè¿°è½¨è¿¹çš„åºåˆ—çš„æ–¹æ³•ã€‚è¯¥åºåˆ—å…·æœ‰æ¯”åŸå§‹è½¨è¿¹ä½çš„ç²¾åº¦ï¼Œä½†åŸºæœ¬å¯ä»¥æè¿°ä¸€æ¡è½¨è¿¹çš„ç©ºé—´ä½ç½®ã€‚ä¸‹é¢ä»‹ç»ä¸¤ç§è¯¥é¡¹ç›®ä¸­ç”¨åˆ°çš„ç¼–ç æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;ä¿ç•™é«˜ä½å°æ•°æ³•&quot;&gt;ä¿ç•™é«˜ä½å°æ•°æ³•&lt;/h3&gt;
&lt;p&gt;æœ€ç®€å•çš„å°±æ˜¯ä»…ä¿ç•™ç»çº¬åº¦çš„é«˜ä½å°æ•°æ¥è¿›è¡Œç¼–ç ã€‚è¿™ç§æ–¹å¼çš„äº§ç”Ÿçš„æ•°æ®çš„ç²¾åº¦è°ƒèŠ‚æœ‰é™ï¼Œä½†ä¹Ÿèƒ½æ»¡è¶³ä¸€èˆ¬éœ€æ±‚ã€‚ä»¥åæ ‡ï¼ˆ1.2222ï¼Œ33.44444ï¼‰æ¥è¯´ä¿ç•™ä¸‰ä½å°æ•°åå¯å¾—â€œ1.222_33.444â€,ä¸­é—´æ·»åŠ ä¸‹åˆ’çº¿æ˜¯ä¿ç•™åè§£ç çš„éœ€æ±‚ã€‚&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;var digits = 3;
var dig = $&quot;F{digits}&quot;;
var code = $&quot;{t.Latitude.ToString(dig)}_{t.Longitude.ToString(dig)}&quot;&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;geohash-æ³•&quot;&gt;GeoHash æ³•&lt;/h3&gt;
&lt;p&gt;GeoHash æ˜¯å…¬è®¤çš„è®¡ç®—ç»çº¬åº¦ç¼–ç çš„æœ‰æ•ˆæ–¹æ³•ï¼Œå¹¶ä¸”ç²¾åº¦è°ƒèŠ‚èƒ½åŠ›è¾ƒå¼ºã€‚è¯»è€…å¯ä»¥ä»è¿™é‡Œè¿›è¡Œäº†è§£&lt;a href=&quot;https://blog.csdn.net/u011497262/article/details/81210634&quot;&gt;Geohash ç²¾åº¦å’ŒåŸç†&lt;/a&gt;ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒGeoHash å¯ä»¥å¾—åˆ°è¾ƒçŸ­çš„å­—ç¬¦ä¸²ï¼Œè¿˜æ˜¯ä»¥åæ ‡ï¼ˆ1.2222ï¼Œ33.44444ï¼‰æ¥è¯´ï¼Œå¾—åˆ° 7 ä½çš„å­—ç¬¦ç¼–ç â€œs8pycn3â€ã€‚è¯¥hashç ç²¾åº¦å’Œç›´æ¥å–ä¸Šé¢å–ä¸‰ä½å°æ•°çš„æ–¹å¼ä¸Šç²¾åº¦æ¥è¿‘ï¼Œä½†å­—ç¬¦é•¿å´ç¼©å‡äº† 5 ä½ã€‚è¿™åˆ©äºé«˜æ•ˆçš„æŸ¥æ‰¾å…¬å…±å­åºåˆ—ã€‚åœ¨ c#ä¸­æˆ‘ä»¬ç›´æ¥ nuget å‘½ä»¤æ·»åŠ  nupkg åŒ…&lt;a href=&quot;https://www.nuget.org/packages/NGeoHash.DotNetCore/&quot;&gt;NGeoHash.DotNetCore&lt;/a&gt;å³å¯è·å¾— GeoHash çš„è®¡ç®—æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;var code = GeoHash.Encode(1.2222,33.44444, 7);&lt;/code&gt;
&lt;/pre&gt;
&lt;h3 id=&quot;å­åºåˆ—çš„æœ€ç»ˆå½¢å¼&quot;&gt;å­åºåˆ—çš„æœ€ç»ˆå½¢å¼&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä¸¤ç§æ–¹æ³•çš†å¯å¾—åˆ°æè¿°è½¨è¿¹çš„åºåˆ—ã€‚å¯¹äºæˆ‘ä»¬çš„å…¬å…±å­åºåˆ—èšç±»æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨ GeoHash å¾—åˆ°è½¨è¿¹åºåˆ—èƒ½å¤Ÿå¾—åˆ°è¾ƒé«˜çš„æ•ˆç‡ï¼ˆèŠ±è´¹æ—¶é—´åŸºæœ¬ä¸ºä¿ç•™é«˜ä½å°æ•°æ³•çš„ 60%ï¼‰ã€‚æ­¤å¤–éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼š1.è¯¥èšç±»æ–¹æ³•å¹¶ä¸å…³å¿ƒè½¨è¿¹ç‚¹çš„å…ˆåé¡ºåºï¼Œä¹Ÿå°±æ˜¯æ—¶é—´æ— å…³æ€§ï¼›2.äº§ç”Ÿçš„è½¨è¿¹åºåˆ—ä¼šæœ‰é‡å¤å€¼ï¼Œä½†æˆ‘ä»¬åªå…³å¿ƒè½¨è¿¹æ˜¯å¦åœ¨æŸä¸€ç©ºé—´ï¼Œè€Œä¸å…³å¿ƒåœ¨æŸä¸€ç©ºé—´å‡ºç°çš„æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯é‡å¤æ— ç”¨æ€§ã€‚åŸºäºä»¥ä¸Šä¸¤ç‚¹ï¼Œåˆæ­¥äº§ç”Ÿçš„è½¨è¿¹åºåˆ—éœ€è¦å»é‡ï¼Œè¿™å¯¹äºæŸ¥æ‰¾å…¬å…±å­åºåˆ—æ¥è¯´ä¹Ÿæ˜¯ä¸€ç§æ•ˆç‡ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¯¹äº c#æ¥è¯´æ˜¯æå…¶ç®€å•çš„:&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;//å¹¶è¡Œè¿­ä»£è½¨è¿¹è·å¾—è½¨è¿¹åºåˆ—
Parallel.ForEach(tracks, t =&amp;gt;
{
//   t.GeoCodes = GeoHelper.GetGeoCodes(t.GeoPoints, 3).ToList();//ä¿ç•™é«˜ä½å°æ•°æ³•
     t.GeoCodes = t.GeoPoints
            .Select(tt =&amp;gt; GeoHash.Encode(tt.Latitude, tt.Longitude, 7))
            .Distinct()
            .ToList();//GeoHashæ³•
});&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;è½¨è¿¹ç›¸ä¼¼åº¦çš„è®¡ç®—&quot;&gt;è½¨è¿¹ç›¸ä¼¼åº¦çš„è®¡ç®—&lt;/h2&gt;
&lt;p&gt;åœ¨å¾—åˆ°æ¯æ¡è½¨è¿¹çš„åºåˆ—åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè½¨è¿¹çš„ç›¸ä¼¼åº¦è®¡ç®—ã€‚è€Œè½¨è¿¹ç›¸ä¼¼åº¦å¯ä»¥å½’ç»“ä¸ºè½¨è¿¹åºåˆ—é—´çš„å…¬å…±å­åºåˆ—å åŸå§‹åºåˆ—çš„æ¯”ç‡ã€‚&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;//arrayä¸ºè½¨è¿¹åˆ—è¡¨ï¼Œibfä¸ºç´¢å¼•1ï¼Œjafä¸ºç´¢å¼•2ï¼Œè®¡ç®—GeoCodesçš„äº¤é›†
var intersect = array[ibf].GeoCodes.Intersect(array[jaf].GeoCodes).ToList();
//å…¬å…±å­åºåˆ—çš„ä¸ªæ•°è½¬ä¸ºæµ®ç‚¹å‹ï¼Œé¿å…ä¸‹ä¸€æ­¥è®¡ç®—ä¸ºæ•´å½¢æ—¶ç»“æœç›´æ¥å½’é›¶
var intersectCount = (float) intersect.Count;
//å…¬å…±è½¨è¿¹ï¼ˆå­åºåˆ—ï¼‰çš„ä¸è½¨è¿¹1çš„ç›¸ä¼¼åº¦
var rateIbf = intersectCount / array[ibf].GeoCodes.Count;
//å…¬å…±è½¨è¿¹ï¼ˆå­åºåˆ—ï¼‰çš„ä¸è½¨è¿¹2çš„ç›¸ä¼¼åº¦
var rateJaf = intersectCount / array[jaf].GeoCodes.Count;&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;è½¨è¿¹æ—è°±çš„ç”Ÿæˆ&quot;&gt;è½¨è¿¹æ—è°±çš„ç”Ÿæˆ&lt;/h2&gt;
&lt;p&gt;å¾—åˆ°è½¨è¿¹ç›¸ä¼¼åº¦åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªé˜ˆå€¼ï¼šä¸€ä¸ªä¸ºå…„å¼Ÿå§å¦¹ç›¸ä¼¼åº¦&lt;strong&gt;scaleSimilar&lt;/strong&gt;ï¼Œä¸€ä¸ªä¸ºåä»£ç›¸ä¼¼åº¦&lt;strong&gt;scaleBlood&lt;/strong&gt;ã€‚æ³¨æ„ï¼Œå…„å¼Ÿå§å¦¹ç›¸ä¼¼åº¦æ€»æ˜¯æ¯”åä»£ç›¸ä¼¼åº¦çš„å€¼è¦å¤§ã€‚æ ¹æ®è¿™ä¸¤ä¸ªé˜ˆå€¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè½¨è¿¹æ—è°±çš„ç”Ÿæˆã€‚å¦‚æœç›¸ä¼¼åº¦&lt;code&gt;rateIbf&lt;/code&gt;å’Œ&lt;code&gt;rateJaf&lt;/code&gt;éƒ½å¤§äº&lt;code&gt;scaleSimilar&lt;/code&gt;ï¼Œè¯´æ˜ä¸¤æ¡è½¨è¿¹æä¸ºç›¸ä¼¼ï¼Œè¢«å®šä¹‰ä¸ºå…„å¼Ÿå§å¦¹ã€‚å¦‚æœéƒ½å¤§äº&lt;code&gt;scaleBlood&lt;/code&gt;ï¼Œå¹¶ä¸”&lt;code&gt;rateIbf&lt;/code&gt;å¤§äº&lt;code&gt;rateJaf&lt;/code&gt;ï¼Œåˆ™è½¨è¿¹ 2 æ˜¯ 1 çš„åä»£ï¼Œåä¹‹ 1 æ˜¯ 2 çš„åä»£ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒï¼š&lt;/p&gt;
&lt;pre class=&quot;csharp&quot;&gt;
&lt;code&gt;//æ„å»ºè½¨è¿¹æ ‘ï¼ˆæ—è°±ï¼‰
public IEnumerable&amp;lt;Trajectory&amp;gt; BuildClusterTree(IEnumerable&amp;lt;Trajectory&amp;gt; trajectories, float scaleSimilar = 0.8f,
    float scaleBlood = 0.6f)
{
    var array = trajectories.OrderByDescending(t =&amp;gt; t.GeoCodes.Count).ToArray();
    for (var ibf = 0; ibf &amp;lt; array.Length; ibf++)
    {
        Parallel.For(ibf + 1, array.Length, jaf =&amp;gt;
        {
            if (array[jaf].Level == 1) return;
            var intersect = array[ibf].GeoCodes.Intersect(array[jaf].GeoCodes).ToList();
            var intersectCount = (float) intersect.Count;
            var rateIbf = intersectCount / array[ibf].GeoCodes.Count;
            var rateJaf = intersectCount / array[jaf].GeoCodes.Count;
            if (rateIbf &amp;gt;= scaleSimilar &amp;amp;&amp;amp; rateJaf &amp;gt;= scaleSimilar)
            {
                array[jaf].Level = 1;
                array[ibf].Siblings.Add(array[jaf]);
                array[jaf].Siblings.Add(array[ibf]);
            }
            else if (rateJaf &amp;gt; rateIbf &amp;amp;&amp;amp; rateIbf &amp;gt;= scaleBlood)
            {
                array[jaf].Level = 1;
                array[jaf].Parent = array[ibf];
                array[ibf].Children.Add(array[jaf]);
            }
            else if (rateIbf &amp;gt; rateJaf &amp;amp;&amp;amp; rateJaf &amp;gt;= scaleBlood)
            {
                array[ibf].Level = 1;
                array[ibf].Parent = array[jaf];
                array[jaf].Children.Add(array[ibf]);
            }
        });
    }

    var root = array.Where(t =&amp;gt; t.Level == 0 ).ToList();
    SetClusterTreeLevelInfo(root);
    return root;
}
//è®¾ç½®ä»£æ•°åŠæ ‡ç­¾ä¿¡æ¯
private void SetClusterTreeLevelInfo(IEnumerable&amp;lt;Trajectory&amp;gt; tree,int level = 0, string levelTag = &quot;&quot;)
{
    Parallel.For(0, tree.Count(), i =&amp;gt;
    {
        var node = tree.ElementAt(i);
        node.Level = level;
        node.LevelTag = $&quot;{levelTag}{i}&quot;;
        for (var j = 0; j &amp;lt; node.Siblings.Count; j++)
        {
            var sib = node.Siblings.ElementAt(j);
            sib.Level = level;
            sib.LevelTag = $&quot;{node.LevelTag}__{j}_sim&quot;;
        }
        SetClusterTreeLevelInfo(node.Children, level + 1, $&quot;{node.LevelTag}_&quot;);
    });
}&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;ç»“æœå±•ç¤ºåŠè¯´æ˜&quot;&gt;ç»“æœå±•ç¤ºåŠè¯´æ˜&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ç›´æ¥ä¸Šæœ€ç»ˆçš„è½¨è¿¹æ—è°±å›¾çš„å±•ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/1214143/201910/1214143-20191012234148285-1325794867.png&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¯»è€…æ”¾å¤§ååº”è¯¥èƒ½å¤Ÿçœ‹æ¸…å›¾ç‰‡çš„æ–‡ä»¶åï¼Œæ–‡ä»¶åæ˜¯ä»£æ•°æ ‡ç­¾ã€‚ä»¥â€œ3.pngâ€å’Œâ€œ3_0.pngâ€æ¥è¯´ï¼Œâ€œ3.pngâ€æ˜¯â€œ3_0.pngâ€çš„çˆ¶äº²ã€‚å¯¹åº”çš„ï¼Œåè€…æ˜¯å‰è€…çš„å­©å­ï¼ˆæ‰€æœ‰è½¨è¿¹å¯¹äºéƒ½æ˜¯è‡ªé€‚åº”å›ºå®šå¤§å°çš„å›¾ç‰‡ç”»çš„ï¼Œæ‰€ä»¥ç¼©æ”¾æ¯”ä¾‹å’Œæ•´ä½“åç§»ä¼šå¯¼è‡´çœ‹èµ·æ¥æœ‰å·®åˆ«ã€‚è¯»è€…ä»”ç»†è§‚å¯Ÿèƒ½å¤Ÿå‘ç° 3_0 åªæ˜¯ 3 çš„å·¦ä¸‹è§’ä¸€éƒ¨åˆ†ï¼‰ã€‚è€Œå¯¹äºâ€œ3_0_4_8.pngâ€å’Œâ€œ3_0_4_8__sim_0.pngâ€æ¥è¯´åˆ™äº’ä¸ºå…„å¼Ÿå§å¦¹ï¼ˆç¼©ç•¥å›¾ä¸è‡ªé€‚åº”çš„ç¡®å½±å“äº†ç»“æœçš„æŸ¥çœ‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºç¬¬ 3 å’Œç¬¬ 6 æ˜¯ä¸¤ä¸ªå¤§å®¶æ—ã€‚å¦‚æœåˆ©ç”¨æ‰€æœ‰è½¨è¿¹çš„æ•°æ®ç”Ÿæˆçƒ­åŠ›å›¾ï¼Œé‚£ä¹ˆ 3 æ—å’Œ 6 æ—æ‰€ç»è¿‡çš„åœ°æ–¹çƒ­åŠ›å€¼ç›¸å¯¹æ¥è¯´è¦é«˜å¾ˆå¤šã€‚æŠŠä¸€ä¸ªå¤§å®¶æ—çš„æ‰€æœ‰æˆå‘˜è½¨è¿¹å åŠ åå¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„çƒ­è¿¹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;è¯¥ç®—æ³•å¦‚æœä¸ç”¨å¹¶è¡Œè®¡ç®—æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n^2)çš„ç®—æ³•â€œnï¼ˆn+1ï¼‰/2â€ã€‚è€Œæ”¹ä¸ºå¹¶è¡Œè®¡ç®—åï¼Œæ•ˆç‡æœ‰å¾ˆå¤§æå‡ï¼ˆç”±äºç›´æ¥é‡‡ç”¨å¹¶è¡Œè®¡ç®—ï¼Œä¸çŸ¥é“æå‡äº†å¤šå°‘ï¼‰ã€‚ç¤ºä¾‹ä¸­71æ¡è½¨è¿¹ç”Ÿæˆæ—è°±æ ‘ä»…éœ€25æ¯«ç§’å·¦å³ï¼Œè€Œ1988æ¡è½¨è¿¹éœ€è¦7.5ç§’å·¦å³ã€‚ä»æ•ˆç‡å’Œç»“æœä¸Šæ¥è¯´éƒ½è¾¾åˆ°äº†ä»¤äººæ»¡æ„çš„ç¨‹åº¦ã€‚å¦å¤–ï¼Œè¯¥é¡¹ç›®å·²ç»ä¸Šä¼ githubï¼Œè®¿é—®è¯·ç‚¹å‡»&lt;a href=&quot;https://github.com/hsxian/QianMo&quot;&gt;QianMo&lt;/a&gt;ï¼Œæ¬¢è¿å¤§å®¶æå‡ºä¿®æ”¹æ„è§ã€‚&lt;/p&gt;
</description>
<pubDate>Sat, 12 Oct 2019 15:44:00 +0000</pubDate>
<dc:creator>éº¦æ¯”ä¹Œæ–¯çš‡</dc:creator>
<og:description>å‰è¨€ å¦‚ä»Šçš„ä¸–ç•Œä¸­ï¼Œæƒ³è¦ç ”ç©¶äººä»¬çš„å‡ºè¡Œæ´»åŠ¨ï¼Œå¯ä»¥åˆ©ç”¨æ™ºèƒ½æ‰‹æœºæˆ–æ™ºèƒ½æ‰‹ç¯ç­‰ä¸ªäººè®¾å¤‡ç”Ÿæˆçš„ GPS æ•°æ®è¿›è¡Œç ”ç©¶ã€‚è€Œåœ¨ä¼—å¤šçš„ç ”ç©¶æ–¹å‘ä¸­ï¼Œå‡ºè¡Œçš„çƒ­ç‚¹è·¯çº¿æˆ–è€…è¯´ç»å¸¸å‡ºè¡Œçš„è·¯çº¿ä¹Ÿæ¯”è¾ƒå—æ¬¢è¿ã€‚é‡‡ç”¨çƒ­åŠ›å›¾çš„æ–¹å¼å¯¹å…¶</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/hsxian/p/11664478.html</dc:identifier>
</item>
<item>
<title>åˆ†äº«8ç‚¹è¶…çº§æœ‰ç”¨çš„Pythonç¼–ç¨‹å»ºè®® - samlam</title>
<link>http://www.cnblogs.com/samshare/p/11664329.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/samshare/p/11664329.html</guid>
<description>&lt;p&gt;æˆ‘ä»¬åœ¨ç”¨Pythonè¿›è¡Œæœºå™¨å­¦ä¹ å»ºæ¨¡é¡¹ç›®çš„æ—¶å€™ï¼Œæ¯ä¸ªäººéƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€å¥—é¡¹ç›®æ–‡ä»¶ç®¡ç†çš„ä¹ æƒ¯ï¼Œæˆ‘è‡ªå·±ä¹Ÿæœ‰ä¸€å¥—æ–¹æ³•ï¼Œæ˜¯è‡ªå·±æ›¾ç»è¸©è¿‡çš„å‘æ€»ç»“å‡ºæ¥çš„ï¼Œç°åœ¨åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤šå°‘æœ‰äº›åœ°æ–¹å¯ä»¥ç»™å¤§å®¶å€Ÿé‰´ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å…ˆç¹ä¸ºå¿«&quot;&gt;ğŸš— å…ˆç¹ä¸ºå¿«&lt;/h2&gt;
&lt;ul&gt;&lt;li&gt;é¡¹ç›®æ–‡ä»¶äº‹å…ˆåšå¥½å½’æ¡£&lt;/li&gt;
&lt;li&gt;æ°¸è¿œä¸è¦æ‰‹åŠ¨ä¿®æ”¹æºæ•°æ®å¹¶ä¸”åšå¥½å¤‡ä»½&lt;/li&gt;
&lt;li&gt;åšå¥½è·¯å¾„çš„æ­£ç¡®é…ç½®&lt;/li&gt;
&lt;li&gt;ä»£ç å¿…è¦çš„åœ°æ–¹åšå¥½å¤‡æ³¨ä¸è¯´æ˜&lt;/li&gt;
&lt;li&gt;åŠ é€Ÿä½ çš„Pythonå¾ªç¯ä»£ç &lt;/li&gt;
&lt;li&gt;å¯è§†åŒ–ä½ çš„å¾ªç¯ä»£ç è¿›åº¦&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨é«˜æ•ˆçš„å¼‚å¸¸æ•è·å·¥å…·&lt;/li&gt;
&lt;li&gt;è¦å¤šè€ƒè™‘ä»£ç å¥å£®æ€§&lt;/li&gt;
&lt;/ul&gt;&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;é¡¹ç›®æ–‡ä»¶äº‹å…ˆåšå¥½å½’æ¡£&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;æ¯æ¬¡å¼€å§‹ä¸€ä¸ªæ–°å·¥ä½œçš„æ—¶å€™ï¼Œä»¥å‰çš„æˆ‘æ€»æ˜¯è´ªå›¾æ–¹ä¾¿ï¼ŒCodeã€Dataã€æ–‡æ¡£éƒ½é›†ä¸­æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹å†…ï¼Œçœ‹èµ·æ¥å¾ˆä¹±ï¼Œä¸€åº¦è®©å›æº¯è¿‡ç¨‹ååˆ†ç—›è‹¦ï¼Œæˆ–è€…æ˜¯æ¢äº†éƒ¨ç”µè„‘ï¼Œæ–‡ä»¶å…¨éƒ½è¿è¡Œä¸è¡Œäº†ï¼Œéœ€è¦è‡ªè¡Œä¿®æ”¹è·¯å¾„ï¼Œååˆ†ç—›è‹¦ã€‚&lt;/p&gt;
&lt;p&gt;ç»è¿‡è‡ªå·±ä¸€ç•ªæ¢ç´¢ï¼Œå¤§å®¶å¯ä»¥å¤§è‡´å°†é¡¹ç›®åˆ†æˆå‡ ä¸ªå­æ–‡ä»¶å¤¹ï¼Œcodeæ”¾åœ¨ä¸»æ–‡ä»¶å¤¹é‡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/812632/201910/812632-20191012225331657-1928999195.jpg&quot; alt=&quot;file&quot;/&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;æ°¸è¿œä¸è¦æ‰‹åŠ¨ä¿®æ”¹æºæ•°æ®å¹¶ä¸”åšå¥½å¤‡ä»½&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦å¯¹æºæ•°æ®è¿›è¡Œå¥½å¤‡ä»½ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¸‹ä¸€æ¬¡è¿›è¡Œå›æº¯ï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œæˆ–è€…æ˜¯å¯¹ä¸­é—´æ­¥éª¤çš„ä¿®æ”¹ï¼Œè€Œä¸”ï¼Œå¯¹ä»£ç ç­‰å…¶ä»–æ–‡ä»¶ä¹Ÿæ˜¯éœ€è¦åšå¥½å¤‡ä»½çš„ï¼Œä»¥å…å‡ºç°æ„å¤–ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ¥è‡ª&lt;em&gt;è‰¯è®¸Linux&lt;/em&gt;çš„ä¸€ç¯‡æ–‡ç« ï¼Œæ¨èäº†4ä¸ªå·¥å…·ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;Rsyncæ–‡ä»¶å¤‡ä»½&lt;/li&gt;
&lt;li&gt;Dropboxäº‘å­˜å‚¨&lt;/li&gt;
&lt;li&gt;Time Machineæ—¶å…‰æœºå™¨&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;æ›´å¤šçš„å·¥å…·ä»‹ç»å’Œä½¿ç”¨æˆ‘è¿™è¾¹å°±ä¸å±•å¼€ï¼Œå¤§å®¶å¯ä»¥å»è‡ªè¡Œäº†è§£å‘—ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;åšå¥½è·¯å¾„çš„æ­£ç¡®é…ç½®&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;å¾ˆå¤šåŒå­¦åœ¨å†™è·¯å¾„çš„æ—¶å€™éƒ½å¾ˆå–œæ¬¢ç›´æ¥ç”¨ç»å¯¹è·¯å¾„ï¼Œè™½ç„¶ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœä»£ç å…±äº«ç»™å…¶ä»–äººå­¦ä¹ æˆ–è€…è¿è¡Œçš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ï¼Œå¾ˆå¤šæƒ…å†µä¸‹éƒ½ä¸èƒ½ç›´æ¥è·‘é€šï¼Œ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå»ºè®®ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼šè„šæœ¬ä½äºä¸»ç›®å½•ä¸‹ï¼Œå…¶ä»–èµ„æºï¼ˆå¦‚æ•°æ®ã€ç¬¬ä¸‰æ–¹åŒ…ç­‰ï¼‰åœ¨å…¶åŒçº§æˆ–ä½çº§ç›®å½•ä¸‹ï¼Œå¦‚ ./data/processed/test1.csv&lt;/li&gt;
&lt;li&gt;å…¨å±€è·¯å¾„é…ç½®å˜é‡ï¼š&lt;/li&gt;
&lt;/ul&gt;&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;# è®¾ç½®ä¸»ç›®å½•
HOME_PATH = r'E:\ML\190615- PROJECT1'

# è¯»å–æ•°æ®
data = open(HOME_PATH+'/data/processed/test1.csv') 
data = pd.read_csv(data)
data.head()&lt;/code&gt;
&lt;/pre&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;ä»£ç å¿…è¦çš„åœ°æ–¹åšå¥½å¤‡æ³¨ä¸è¯´æ˜&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½æ„ŸåŒèº«å—äº†ï¼Œä¸ä¿¡ï¼Ÿæ‹¿å›ä¸€ä¸ªæœˆå‰è‡ªå·±å†™çš„ä»£ç çœ‹çœ‹å§ï¼Œçœ‹ä¸€ä¸‹èƒ½çœ‹æ‡‚å¤šå°‘ï¼ˆå¦‚æœæ²¡æœ‰åšå¥½å¤‡æ³¨è¯´æ˜çš„è¯ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;åŠ é€Ÿä½ çš„Pythonå¾ªç¯ä»£ç &lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œæ¨èäº‘å“¥çš„ä¸€ç¯‡æ–‡ç« ï¼š24å¼åŠ é€Ÿä½ çš„pythonï¼š&lt;/p&gt;
&lt;p&gt;https://mp.weixin.qq.com/s/8bWm4NjHAam-fIeC4a29cA&lt;/p&gt;
&lt;p&gt;æ”¶è—èµ·æ¥ï¼Œå¤šçœ‹å¤šå‡ æ¬¡ï¼Œå…»æˆå¥½ä¹ æƒ¯å‘—ï¼Œè¿™æ ·å­ä½ å†™ä»£ç æ‰ä¼šè¶Šæ¥è¶Šå¿«ï½&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;å¯è§†åŒ–ä½ çš„å¾ªç¯ä»£ç è¿›åº¦&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œä»‹ç»ä¸€ä¸ªPythonåº“ï¼Œtqdmï¼Œå…ˆå®‰è£…ä¸€ä¸‹ï¼š&lt;code&gt;pip install tqdm&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯ä¸€ä¸ªå¯ä»¥æ˜¾ç¤ºå¾ªç¯è¿›åº¦çš„åº“ï¼Œæœ‰äº†å®ƒå°±å¯ä»¥æ›´åŠ è¿ç­¹å¸·å¹„äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/812632/201910/812632-20191012225331957-477308799.jpg&quot; alt=&quot;file&quot;/&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;ä½¿ç”¨é«˜æ•ˆçš„å¼‚å¸¸æ•è·å·¥å…·&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;å¼‚å¸¸bugå®šä½ï¼Œä»¥å‰çš„æˆ‘ç»å¸¸ä¹Ÿæ˜¯ä¸€æ¡print()å‡½æ•°èµ°åˆ°åº•ï¼Œè™½ç„¶è¯´ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ•ˆç‡ä¸Šè¿˜æ˜¯ä¼šæ¯”è¾ƒæ…¢ï¼Œåæ¥å‘ç°äº†ä¸€ä¸ªå«PySnooperçš„è£…é¥°å™¨ï¼Œä»¿ä½›å‘ç°äº†æ–°å¤§é™†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸€èˆ¬debugï¼Œéƒ½æ˜¯åœ¨æˆ‘ä»¬å¯èƒ½è§‰å¾—ä¼šæœ‰é—®é¢˜çš„åœ°æ–¹ï¼Œå»æ‰“å°è¾“å‡ºï¼Œçœ‹ä¸‹å®é™…è¾“å‡ºäº†ä»€ä¹ˆï¼Œç„¶åæ€è€ƒé—®é¢˜æ‰€åœ¨ï¼Œè¿™éœ€è¦æˆ‘ä»¬å»æ”¹codeï¼Œéå¸¸ç»†è‡´åœ°æ”¹ï¼Œç›¸æ¯”è¾ƒç›´æ¥åŠ ä¸ªè£…é¥°å™¨ï¼Œæ˜¯ååˆ†éº»çƒ¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¯ä»¥çœ‹çœ‹Exampleï¼š&lt;/p&gt;
&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;import pysnooper

@pysnooper.snoop('./log/file.log')
def number_to_bits(number):
    if number:
        bits = []
        while number:
            number, remainder = divmod(number, 2)
            bits.insert(0, remainder)
        return bits
    else:
        return [0]

number_to_bits(6)&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠå‡½æ•°æ¯ä¸€æ­¥çš„è¾“å‡ºéƒ½ä¿å­˜ä¸ºfile.logï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å»çœ‹åˆ°åº•å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2018.cnblogs.com/blog/812632/201910/812632-20191012225332742-868336303.jpg&quot; alt=&quot;file&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ğŸ“š é¡¹ç›®åœ°å€ï¼šhttps://github.com/cool-RR/pysnooper&lt;br/&gt;https://mp.weixin.qq.com/s/zqFPVfmPa-qsPUibzQdcjQ&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;&lt;li&gt;è¦å¤šè€ƒè™‘ä»£ç å¥å£®æ€§&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;ä½•ä¸ºä»£ç çš„å¥å£®æ€§,é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯ä»¥æŠµæŒ¡å¾—ä½å„ç§å¼‚å¸¸åœºæ™¯çš„æµ‹è¯•ï¼Œå¼‚å¸¸å¤„ç†å·¥ä½œç”±â€œæ•è·â€å’Œâ€œæŠ›å‡ºâ€ä¸¤éƒ¨åˆ†ç»„æˆã€‚â€œæ•è·â€æŒ‡çš„æ˜¯ä½¿ç”¨ try ... except åŒ…è£¹ç‰¹å®šè¯­å¥ï¼Œå¦¥å½“çš„å®Œæˆé”™è¯¯æµç¨‹å¤„ç†ã€‚è€Œæ°å½“çš„ä½¿ç”¨ raise ä¸»åŠ¨â€œæŠ›å‡ºâ€å¼‚å¸¸ï¼Œæ›´æ˜¯ä¼˜é›…ä»£ç é‡Œå¿…ä¸å¯å°‘çš„ç»„æˆéƒ¨åˆ†ï¼Œä¸‹é¢æ€»ç»“å‡ ç‚¹ä¾›å¤§å®¶å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;1ï¼‰çŸ¥é“è¦ä¼ å…¥çš„å‚æ•°æ˜¯ä»€ä¹ˆ,ç±»å‹,ä¸ªæ•°....(å¼‚å¸¸å¤„ç†,é€»è¾‘åˆ¤æ–­)&lt;/p&gt;
&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;def add(a, b):
  if isinstance(a, int) and isinstance(b, int):
      return a+b
  else:
      return 'å‚æ•°ç±»å‹é”™è¯¯'

print(add(1, 2))
print(add(1, 'a'))&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;2ï¼‰åªåšæœ€ç²¾å‡†çš„å¼‚å¸¸æ•è·&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœ‰çš„æ—¶å€™æƒ³ç€è®©è„šæœ¬workæ‰æ˜¯ç‹é“ï¼Œæ‰€ä»¥ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€å°±æä¸€ä¸ªå¤§å¤§çš„try...exceptæŠŠæ•´å—ä»£ç åŒ…è£¹èµ·æ¥ï¼Œä½†è¿™æ ·å¾ˆå®¹æ˜“æŠŠåŸæœ¬è¯¥è¢«æŠ›å‡ºçš„ AttibuteError åå™¬äº†ã€‚ä»è€Œç»™æˆ‘ä»¬çš„ debug è¿‡ç¨‹å¢åŠ äº†ä¸å¿…è¦çš„éº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬æ°¸è¿œåªæ•è·é‚£äº›å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„è¯­å¥å—ï¼Œè€Œä¸”å°½é‡åªæ•è·ç²¾ç¡®çš„å¼‚å¸¸ç±»å‹ï¼Œè€Œä¸æ˜¯æ¨¡ç³Šçš„ Exceptionã€‚&lt;/p&gt;
&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;from requests.exceptions import RequestException

def save_website_title(url, filename):
    try:
        resp = requests.get(url)
    except RequestException as e:
        print(f'save failed: unable to get page content: {e}')
        return False
        
# è¿™æ®µæ­£åˆ™æ“ä½œæœ¬èº«å°±æ˜¯ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡å¿…è¦ä½¿ç”¨ try è¯­å¥å—
# å‡å¦‚ group è¢«è¯¯æ‰“æˆäº† grop ä¹Ÿæ²¡å…³ç³»ï¼Œç¨‹åºé©¬ä¸Šå°±ä¼šé€šè¿‡ AttributeError æ¥
# å‘Šè¯‰æˆ‘ä»¬ã€‚
    obj = re.search(r'&amp;lt;title&amp;gt;(.*)&amp;lt;/title&amp;gt;', resp.text)
    if not obj:
    print('save failed: title tag not found in page content')
    return False
    title = obj.group(1)

    try:
    with open(filename, 'w') as fp:
        fp.write(title)
    except IOError as e:
    print(f'save failed: unable to write to file {filename}: {e}')
    return False
    else:
    return True&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;3ï¼‰å¼‚å¸¸å¤„ç†ä¸åº”è¯¥å–§å®¾å¤ºä¸»&lt;/p&gt;
&lt;p&gt;åƒä¸Šä¸€æ¡è¯´åˆ°çš„å¼‚å¸¸æ•è·è¦ç²¾å‡†ï¼Œä½†å¦‚æœæ¯ä¸€ä¸ªéƒ½å¾ˆç²¾å‡†çš„è¯ï¼Œå…¶å®æˆ‘ä»¬çš„ä»£ç é‡Œå°±ä¼šæœ‰å¾ˆå¤štry...exceptè¯­å¥å—ï¼Œä»¥è‡³äºæ‰°ä¹±æ ¸å¿ƒä»£ç ï¼Œä»£ç æ•´ä½“é˜…è¯»æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ¥æ”¹å–„æˆ‘ä»¬çš„å¼‚å¸¸å¤„ç†æµç¨‹ï¼Œç®€åŒ–é‡å¤çš„å¼‚å¸¸å¤„ç†é€»è¾‘ã€‚&lt;/p&gt;
&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;class raise_api_error:
    &quot;&quot;&quot;captures specified exception and raise ApiErrorCode instead
    :raises: AttributeError if code_name is not valid
    &quot;&quot;&quot;
    def __init__(self, captures, code_name):
    self.captures = captures
    self.code = getattr(error_codes, code_name)

    def __enter__(self):
    # è¯¥æ–¹æ³•å°†åœ¨è¿›å…¥ä¸Šä¸‹æ–‡æ—¶è°ƒç”¨
    return self

    def __exit__(self, exc_type, exc_val, exc_tb):
    # è¯¥æ–¹æ³•å°†åœ¨é€€å‡ºä¸Šä¸‹æ–‡æ—¶è°ƒç”¨
    # exc_type, exc_val, exc_tb åˆ†åˆ«è¡¨ç¤ºè¯¥ä¸Šä¸‹æ–‡å†…æŠ›å‡ºçš„
    # å¼‚å¸¸ç±»å‹ã€å¼‚å¸¸å€¼ã€é”™è¯¯æ ˆ
    if exc_type is None:
        return False

    if exc_type == self.captures:
        raise self.code from exc_val
    return False&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º raise_api_error çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå®ƒåœ¨è¿›å…¥ä¸Šä¸‹æ–‡æ—¶ä»€ä¹ˆä¹Ÿä¸åšã€‚ä½†æ˜¯åœ¨é€€å‡ºä¸Šä¸‹æ–‡æ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰ä¸Šä¸‹æ–‡ä¸­æ˜¯å¦æŠ›å‡ºäº†ç±»å‹ä¸º self.captures çš„å¼‚å¸¸ï¼Œå¦‚æœæœ‰ï¼Œå°±ç”¨ APIErrorCode å¼‚å¸¸ç±»æ›¿ä»£å®ƒã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨åï¼Œç®€æ´çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre class=&quot;python&quot;&gt;
&lt;code&gt;def upload_avatar(request):
    &quot;&quot;&quot;ç”¨æˆ·ä¸Šä¼ æ–°å¤´åƒ&quot;&quot;&quot;
    with raise_api_error(KeyError, 'AVATAR_FILE_NOT_PROVIDED'):
    avatar_file = request.FILES['avatar']
        
    with raise_api_error(ResizeAvatarError, 'AVATAR_FILE_INVALID'),\
        raise_api_error(FileTooLargeError, 'AVATAR_FILE_TOO_LARGE'):
      resized_avatar_file = resize_avatar(avatar_file)

    with raise_api_error(Exception, 'INTERNAL_SERVER_ERROR'):
    request.user.avatar = resized_avatar_file
    request.user.save()
    return HttpResponse({})&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;reference&quot;&gt;ğŸ“– Reference&lt;/h2&gt;
</description>
<pubDate>Sat, 12 Oct 2019 14:54:00 +0000</pubDate>
<dc:creator>samlam</dc:creator>
<og:description>æˆ‘ä»¬åœ¨ç”¨Pythonè¿›è¡Œæœºå™¨å­¦ä¹ å»ºæ¨¡é¡¹ç›®çš„æ—¶å€™ï¼Œæ¯ä¸ªäººéƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€å¥—é¡¹ç›®æ–‡ä»¶ç®¡ç†çš„ä¹ æƒ¯ï¼Œæˆ‘è‡ªå·±ä¹Ÿæœ‰ä¸€å¥—æ–¹æ³•ï¼Œæ˜¯è‡ªå·±æ›¾ç»è¸©è¿‡çš„å‘æ€»ç»“å‡ºæ¥çš„ï¼Œç°åœ¨åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤šå°‘æœ‰äº›åœ°æ–¹å¯ä»¥ç»™å¤§å®¶å€Ÿé‰´ã€‚</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/samshare/p/11664329.html</dc:identifier>
</item>
</channel>
</rss>