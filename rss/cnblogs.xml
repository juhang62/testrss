<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=feed.cnblogs.com%2Fblog%2Fsitehome%2Frss&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://feed.cnblogs.com/blog/sitehome/rss" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dfeed.cnblogs.com%252Fblog%252Fsitehome%252Frss%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>åšå®¢å›­_é¦–é¡µ</title>
<link></link>
<description>ä»£ç æ”¹å˜ä¸–ç•Œ</description>
<item>
<title>.Net Coreå¾®æœåŠ¡å…¥é—¨å…¨çºªå½•ï¼ˆäº”ï¼‰â€”â€”Ocelot-APIç½‘å…³ï¼ˆä¸‹ï¼‰ - xhznl</title>
<link>http://www.cnblogs.com/xhznl/p/13132255.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/xhznl/p/13132255.html</guid>
<description>&lt;p&gt;ä¸Šä¸€ç¯‡ã€&lt;a href=&quot;https://www.cnblogs.com/xhznl/p/13092535.html&quot;&gt;.Net Coreå¾®æœåŠ¡å…¥é—¨å…¨çºªå½•ï¼ˆå››ï¼‰â€”â€”Ocelot-APIç½‘å…³ï¼ˆä¸Šï¼‰&lt;/a&gt;ã€‘å·²ç»å®Œæˆäº†Ocelotç½‘å…³çš„åŸºæœ¬æ­å»ºï¼Œå®ç°äº†æœåŠ¡å…¥å£çš„ç»Ÿä¸€ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯APIç½‘å…³çš„ä¸€ä¸ªæœ€åŸºæœ¬åŠŸèƒ½ï¼Œå®ƒçš„è¿›é˜¶åŠŸèƒ½è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆéœ€è¦è§£å†³çš„å°±æ˜¯æœåŠ¡å‘ç°çš„é—®é¢˜ï¼ŒæœåŠ¡å‘ç°çš„ä¼˜ç‚¹ä¹‹å‰è®²è¿‡ï¼Œå°±ä¸è¯´äº†ã€‚&lt;br/&gt;ä¸Šä¸€ç¯‡ä¸­æˆ‘ä»¬çš„æœåŠ¡åœ°å€éƒ½æ˜¯å†™åœ¨ocelot.jsoné…ç½®æ–‡ä»¶é‡Œï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦ç»“åˆä¹‹å‰çš„Consulæ¥å®ç°æœåŠ¡å‘ç°ã€‚&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;æ”¹é€ ä»£ç ï¼š&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;é¦–å…ˆNuGetå®‰è£…&lt;code&gt;Ocelot.Provider.Consul&lt;/code&gt;ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200615213448863-1043664447.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹Startup.csï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;        public void ConfigureServices(IServiceCollection services)
        {
            //æ·»åŠ ocelotæœåŠ¡
            services.AddOcelot()
                .AddConsul();//æ·»åŠ consulæ”¯æŒ
        }
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¿®æ”¹ocelot.jsoné…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{
  &quot;Routes&quot;: [
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;ProductService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      }
    },
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;OrderService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      }
    }
  ],
  &quot;GlobalConfiguration&quot;: {
    &quot;BaseUrl&quot;: &quot;http://localhost:9070&quot;,
    &quot;ServiceDiscoveryProvider&quot;: {
      &quot;Scheme&quot;: &quot;http&quot;,
      &quot;Host&quot;: &quot;localhost&quot;,
      &quot;Port&quot;: 8500,
      &quot;Type&quot;: &quot;Consul&quot;
    }
  }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªé…ç½®åº”è¯¥å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æŠŠæˆ‘ä»¬ä¸Šæ¬¡çš„DownstreamHostAndPortsèŠ‚ç‚¹å»æ‰äº†ï¼Œç„¶åå¢åŠ äº†ServiceDiscoveryProvideræœåŠ¡å‘ç°ç›¸å…³é…ç½®ã€‚&lt;br/&gt;æ³¨æ„ï¼ŒOceloté™¤äº†æ”¯æŒConsulæœåŠ¡å‘ç°ä»¥å¤–ï¼Œè¿˜æœ‰Eurekaä¹Ÿå¯ä»¥ï¼ŒEurekaä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼çš„æ³¨å†Œä¸­å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼Œä»£ç ä¿®æ”¹å°±å·®ä¸å¤šäº†ï¼Œä¸‹é¢è¿è¡Œç¨‹åºæµ‹è¯•ä¸€ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200615221633113-1526943266.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200615221920176-9130658.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;br/&gt;å®¢æˆ·ç«¯æ­£å¸¸è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ­¤æˆ‘ä»¬å°±å®ç°äº†æœåŠ¡æ³¨å†Œä¸å‘ç°å’Œapiç½‘å…³çš„åŸºæœ¬åŠŸèƒ½ã€‚æ¥ä¸‹æ¥å°±è¦æåˆ°ï¼š&lt;strong&gt;æœåŠ¡æ²»ç†&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;å…¶å®æœåŠ¡æ²»ç†ä¹Ÿæ²¡æœ‰ä¸€ä¸ªéå¸¸æ˜ç¡®çš„å®šä¹‰ã€‚å®ƒçš„ä½œç”¨ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç®¡ç†æœåŠ¡ï¼Œæå‡æœåŠ¡çš„å¯ç”¨æ€§ã€‚â€”â€”ç¼“å­˜ï¼Œé™æµï¼Œç†”æ–­ï¼Œé“¾è·¯è¿½è¸ª ç­‰ç­‰ã€‚ã€‚ã€‚éƒ½å±äºå¸¸ç”¨çš„æœåŠ¡æ²»ç†æ‰‹æ®µã€‚&lt;br/&gt;ä¹‹å‰è®²çš„è´Ÿè½½å‡è¡¡ï¼ŒæœåŠ¡å‘ç°ä¹Ÿå¯ä»¥ç®—æ˜¯æœåŠ¡æ²»ç†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Ocelotä¸­å¯ç”¨ç¼“å­˜ï¼Œéœ€è¦NuGetå®‰è£…ä¸€ä¸‹&lt;code&gt;Ocelot.Cache.CacheManager&lt;/code&gt;ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200616201422921-1718170282.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹Startup.csä¸­çš„ConfigureServices()æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;//æ·»åŠ ocelotæœåŠ¡
services.AddOcelot()
    //æ·»åŠ consulæ”¯æŒ
    .AddConsul()
    //æ·»åŠ ç¼“å­˜
    .AddCacheManager(x =&amp;gt;
    {
        x.WithDictionaryHandle();
    });
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¿®æ”¹ocelot.jsoné…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{
  &quot;Routes&quot;: [
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;ProductService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      },
      &quot;FileCacheOptions&quot;: {
        &quot;TtlSeconds&quot;: 5,
        &quot;Region&quot;: &quot;regionname&quot;
      }
    },
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;OrderService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      },
      &quot;FileCacheOptions&quot;: {
        &quot;TtlSeconds&quot;: 5,
        &quot;Region&quot;: &quot;regionname&quot;
      }
    }
  ],
  &quot;GlobalConfiguration&quot;: {
    &quot;BaseUrl&quot;: &quot;http://localhost:9070&quot;,
    &quot;ServiceDiscoveryProvider&quot;: {
      &quot;Scheme&quot;: &quot;http&quot;,
      &quot;Host&quot;: &quot;localhost&quot;,
      &quot;Port&quot;: 8500,
      &quot;Type&quot;: &quot;Consul&quot;
    }
  }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨Routesè·¯ç”±é…ç½®ä¸­å¢åŠ äº†FileCacheOptionsã€‚TtlSecondsä»£è¡¨ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼ŒRegionä»£è¡¨ç¼“å†²åŒºåç§°ï¼Œè¿™ä¸ªæˆ‘ä»¬ç›®å‰ç”¨ä¸åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼Œä»£ç ä¿®æ”¹å®Œéœ€è¦ç¼–è¯‘é‡å¯ä¸€ä¸‹ç½‘å…³é¡¹ç›®ï¼Œç„¶åæ‰“å¼€å®¢æˆ·ç«¯ç½‘ç«™æµ‹è¯•ä¸€ä¸‹ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200616203849105-1496099469.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;br/&gt;å¯ä»¥çœ‹åˆ°ï¼Œ5ç§’ä¹‹å†…çš„è¯·æ±‚éƒ½æ˜¯åŒæ ·çš„ç¼“å­˜æ•°æ®ã€‚Ocelotä¹Ÿæ”¯æŒè‡ªå®šä¹‰ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;é™æµå°±æ˜¯é™åˆ¶å®¢æˆ·ç«¯ä¸€å®šæ—¶é—´å†…çš„è¯·æ±‚æ¬¡æ•°ã€‚&lt;br/&gt;ç»§ç»­ä¿®æ”¹é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;{
  &quot;Routes&quot;: [
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/products&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;ProductService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      },
      &quot;FileCacheOptions&quot;: {
        &quot;TtlSeconds&quot;: 5,
        &quot;Region&quot;: &quot;regionname&quot;
      },
      &quot;RateLimitOptions&quot;: {
        &quot;ClientWhitelist&quot;: [ &quot;SuperClient&quot; ],
        &quot;EnableRateLimiting&quot;: true,
        &quot;Period&quot;: &quot;5s&quot;,
        &quot;PeriodTimespan&quot;: 2,
        &quot;Limit&quot;: 1
      }
    },
    {
      &quot;DownstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;DownstreamScheme&quot;: &quot;http&quot;,
      &quot;UpstreamPathTemplate&quot;: &quot;/orders&quot;,
      &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot; ],
      &quot;ServiceName&quot;: &quot;OrderService&quot;,
      &quot;LoadBalancerOptions&quot;: {
        &quot;Type&quot;: &quot;RoundRobin&quot;
      },
      &quot;FileCacheOptions&quot;: {
        &quot;TtlSeconds&quot;: 5,
        &quot;Region&quot;: &quot;regionname&quot;
      },
      &quot;RateLimitOptions&quot;: {
        &quot;ClientWhitelist&quot;: [ &quot;SuperClient&quot; ],
        &quot;EnableRateLimiting&quot;: true,
        &quot;Period&quot;: &quot;5s&quot;,
        &quot;PeriodTimespan&quot;: 2,
        &quot;Limit&quot;: 2
      }
    }
  ],
  &quot;GlobalConfiguration&quot;: {
    &quot;BaseUrl&quot;: &quot;http://localhost:9070&quot;,
    &quot;ServiceDiscoveryProvider&quot;: {
      &quot;Scheme&quot;: &quot;http&quot;,
      &quot;Host&quot;: &quot;localhost&quot;,
      &quot;Port&quot;: 8500,
      &quot;Type&quot;: &quot;Consul&quot;
    },
    &quot;RateLimitOptions&quot;: {
      &quot;DisableRateLimitHeaders&quot;: false,
      &quot;QuotaExceededMessage&quot;: &quot;too many requests...&quot;,
      &quot;HttpStatusCode&quot;: 999,
      &quot;ClientIdHeader&quot;: &quot;Test&quot;
    }
  }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åœ¨Routesè·¯ç”±é…ç½®ä¸­å¢åŠ äº†RateLimitOptionsã€‚ClientWhitelistä»£è¡¨å®¢æˆ·ç«¯ç™½åå•ï¼Œåœ¨ç™½åå•ä¸­çš„å®¢æˆ·ç«¯å¯ä»¥ä¸å—é™æµçš„å½±å“ï¼›EnableRateLimitingä»£è¡¨æ˜¯å¦é™æµï¼›Periodä»£è¡¨é™æµçš„å•ä½æ—¶é—´ï¼Œä¾‹å¦‚1sï¼Œ5mï¼Œ1hï¼Œ1dç­‰ï¼›PeriodTimespanä»£è¡¨å®¢æˆ·ç«¯è¾¾åˆ°è¯·æ±‚ä¸Šé™å¤šå°‘ç§’åå¯ä»¥é‡è¯•ï¼›Limitä»£è¡¨å®¢æˆ·ç«¯åœ¨å®šä¹‰çš„æ—¶é—´å†…å¯ä»¥å‘å‡ºçš„æœ€å¤§è¯·æ±‚æ•°ã€‚&lt;br/&gt;åœ¨GlobalConfigurationé…ç½®ä¸­ä¹Ÿå¢åŠ äº†RateLimitOptionsã€‚DisableRateLimitHeadersä»£è¡¨æ˜¯å¦ç¦ç”¨X-Rate-Limitå’ŒRetry-Afteræ ‡å¤´ï¼ˆè¯·æ±‚è¾¾åˆ°ä¸Šé™æ—¶response headerä¸­çš„é™åˆ¶æ•°å’Œå¤šå°‘ç§’åèƒ½é‡è¯•ï¼‰ï¼›QuotaExceededMessageï¼šä»£è¡¨è¯·æ±‚è¾¾åˆ°ä¸Šé™æ—¶è¿”å›ç»™å®¢æˆ·ç«¯çš„æ¶ˆæ¯ï¼›HttpStatusCodeï¼šä»£è¡¨è¯·æ±‚è¾¾åˆ°ä¸Šé™æ—¶è¿”å›ç»™å®¢æˆ·ç«¯çš„HTTPçŠ¶æ€ä»£ç ã€‚ClientIdHeaderå¯ä»¥å…è®¸è‡ªå®šä¹‰ç”¨äºæ ‡è¯†å®¢æˆ·ç«¯çš„æ ‡å¤´ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ºâ€œ ClientIdâ€ã€‚&lt;br/&gt;æœ€é‡è¦çš„å°±æ˜¯Periodï¼ŒPeriodTimespanï¼ŒLimitè¿™å‡ ä¸ªé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;é‡æ–°ç¼–è¯‘å¯åŠ¨çœ‹ä¸€ä¸‹æ•ˆæœï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200616211944189-440946732.gif&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;è¶…æ—¶/ç†”æ–­&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;è¶…æ—¶å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç½‘å…³è¯·æ±‚æœåŠ¡æ—¶å¯å®¹å¿çš„æœ€é•¿å“åº”æ—¶é—´ã€‚ç†”æ–­çš„æ„æ€å°±æ˜¯å½“è¯·æ±‚æŸä¸ªæœåŠ¡çš„å¼‚å¸¸æ¬¡æ•°è¾¾åˆ°ä¸€å®šé‡æ—¶ï¼Œé‚£ä¹ˆç½‘å…³åœ¨ä¸€å®šæ—¶é—´å†…å°±ä¸å†å¯¹è¿™ä¸ªæœåŠ¡å‘èµ·è¯·æ±‚äº†ï¼Œç›´æ¥ç†”æ–­ã€‚&lt;br/&gt;Ocelotä¸­å¯ç”¨ è¶…æ—¶/ç†”æ–­ éœ€è¦NuGetå®‰è£…ä¸€ä¸‹&lt;code&gt;Ocelot.Provider.Polly&lt;/code&gt;ï¼š&lt;br/&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/610959/202006/610959-20200616214037176-1072442140.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹Startup.csä¸­çš„ConfigureServices()æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;//æ·»åŠ ocelotæœåŠ¡
services.AddOcelot()
    //æ·»åŠ consulæ”¯æŒ
    .AddConsul()
    //æ·»åŠ ç¼“å­˜
    .AddCacheManager(x =&amp;gt;
    {
        x.WithDictionaryHandle();
    })
    //æ·»åŠ Polly
    .AddPolly();
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;åŒæ ·çš„åœ¨ocelot.jsonè·¯ç”±é…ç½®ä¸­å¢åŠ QoSOptionsï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;&quot;QoSOptions&quot;: {
        &quot;ExceptionsAllowedBeforeBreaking&quot;: 3,
        &quot;DurationOfBreak&quot;: 10000,
        &quot;TimeoutValue&quot;: 5000
      }
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ExceptionsAllowedBeforeBreakingä»£è¡¨å‘ç”Ÿé”™è¯¯çš„æ¬¡æ•°ï¼ŒDurationOfBreakä»£è¡¨ç†”æ–­æ—¶é—´ï¼ŒTimeoutValueä»£è¡¨è¶…æ—¶æ—¶é—´ã€‚&lt;br/&gt;ä»¥ä¸Šçš„é…ç½®æ„æ€å°±æ˜¯å½“æœåŠ¡å‘ç”Ÿ3æ¬¡é”™è¯¯æ—¶ï¼Œé‚£ä¹ˆå°±ç†”æ–­10ç§’ï¼ŒæœŸé—´å®¢æˆ·ç«¯çš„è¯·æ±‚ç›´æ¥è¿”å›é”™è¯¯ï¼Œ10ç§’ä¹‹åæ¢å¤ã€‚&lt;br/&gt;è¿™ä¸ªä¸å¤ªå¥½æ¨¡æ‹Ÿï¼Œå°±ä¸æ¼”ç¤ºäº†ï¼Œåº”è¯¥ä¹ŸæŒºå¥½ç†è§£çš„ã€‚&lt;/p&gt;
&lt;p&gt;ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºæœåŠ¡æ²»ç†çš„å­¦é—®è¿˜æœ‰å¾ˆå¤šï¼Œä¸ç»§ç»­äº†ã€‚ã€‚ã€‚å°±åˆ°æ­¤ä¸ºæ­¢å§ã€‚&lt;br/&gt;æƒ³è¦æ›´æ·±å…¥äº†è§£Ocelotçš„ï¼Œè¯·çœ‹å®˜ç½‘ï¼š&lt;a href=&quot;https://ocelot.readthedocs.io/en/latest/&quot;&gt;https://ocelot.readthedocs.io/en/latest/&lt;/a&gt;&lt;br/&gt;æˆ–è€…çœ‹æºç ï¼š&lt;a href=&quot;https://github.com/ThreeMammals/Ocelot&quot;&gt;https://github.com/ThreeMammals/Ocelot&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€ç¯‡å‡†å¤‡è¯´ä¸€ä¸‹ï¼šäº‹ä»¶æ€»çº¿ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ”¾åœ¨ï¼š&lt;a href=&quot;https://github.com/xiajingren/NetCoreMicroserviceDemo&quot;&gt;https://github.com/xiajingren/NetCoreMicroserviceDemo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœªå®Œå¾…ç»­...&lt;/p&gt;
</description>
<pubDate>Fri, 19 Jun 2020 00:22:00 +0000</pubDate>
<dc:creator>xhznl</dc:creator>
<og:description>å‰è¨€ ä¸Šä¸€ç¯‡ã€.Net Coreå¾®æœåŠ¡å…¥é—¨å…¨çºªå½•ï¼ˆå››ï¼‰â€”â€”Ocelot-APIç½‘å…³ï¼ˆä¸Šï¼‰ã€‘å·²ç»å®Œæˆäº†Ocelotç½‘å…³çš„åŸºæœ¬æ­å»ºï¼Œå®ç°äº†æœåŠ¡å…¥å£çš„ç»Ÿä¸€ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯APIç½‘å…³çš„ä¸€ä¸ªæœ€åŸºæœ¬åŠŸèƒ½ï¼Œå®ƒçš„è¿›é˜¶åŠŸ</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/xhznl/p/13132255.html</dc:identifier>
</item>
<item>
<title>å¯¹ JsonConvert çš„è®¤è¯†å¤ªè‚¤æµ…äº†ï¼Œç»ˆäºè¿˜æ˜¯é‡åˆ°äº†é—®é¢˜ - ä¸€çº¿ç å†œ</title>
<link>http://www.cnblogs.com/huangxincheng/p/13161143.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/huangxincheng/p/13161143.html</guid>
<description>&lt;h2 id=&quot;ä¸€ï¼šèƒŒæ™¯&quot;&gt;ä¸€ï¼šèƒŒæ™¯&lt;/h2&gt;
&lt;h3 id=&quot;1-è®²æ•…äº‹&quot;&gt;1. è®²æ•…äº‹&lt;/h3&gt;
&lt;p&gt;åœ¨å¼€å§‹æœ¬æ–‡ä¹‹å‰ï¼ŒçœŸçš„å¥½æƒ³åšä¸ªé—®å·è°ƒæŸ¥ï¼Œåˆ°åº•æœ‰å¤šå°‘äººå’Œæˆ‘ä¸€æ ·ï¼Œå¯¹ JsonConvert çš„è®¤è¯†åªå±€é™åœ¨ &lt;code&gt;SerializeObject&lt;/code&gt; å’Œ &lt;code&gt;DeserializeObject&lt;/code&gt; è¿™ä¸¤ä¸ªæ–¹æ³•ä¸Š(â”¬ï¼¿â”¬), è¿™æ ·æˆ‘ä¹Ÿå¥½ç»“ä¼´åŒè¡Œï¼Œä¸å†å­¤å•è½é­„ğŸ˜ğŸ˜ğŸ˜ï¼Œæˆ–è®¸æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•åŸºæœ¬ä¸Šèƒ½å¤Ÿè§£å†³å·¥ä½œä¸­ 80% çš„åœºæ™¯ï¼Œå¯¹äºæˆ‘æ¥è¯´ç¡®å®æ˜¯è¿™æ ·ï¼Œä½†éšç€ç¼–ç çš„å»¶ç»­ï¼Œç»ˆç©¶è¿˜æ˜¯ä¼šé‡åˆ°é‚£å‰©ä¸‹çš„ 20% ï¼Œæ‰€ä»¥å‘€ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„åœºæ™¯æ˜¯è¿™æ ·çš„ï¼šå‰æ®µæ—¶é—´å†™ä¸šåŠ¡ä»£ç çš„æ—¶å€™ï¼Œæˆ‘æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å®¢æˆ·ç®—æ³•ç±»å‹çš„Modelï¼Œè¿™ä¸ªModelä¸­æœ‰è¿™ç§ç®—æ³•ç±»å‹ä¸‹çš„å®¢æˆ·ç¾¤ä»¥åŠReportç»Ÿè®¡ä¿¡æ¯ï¼Œè¿˜ç”¨äº† HashSet è®°å½•äº†è¯¥ç±»å‹ä¸‹çš„ CustomerIDé›†åˆï¼Œä¸ºäº†æ–¹ä¾¿è®²è¿°ï¼Œæˆ‘æŠŠModelç®€åŒ–å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
    class CustomerAlgorithmModel
    {
        public string DisplayName { get; set; }

        public int CustomerType { get; set; }

        public ReprotModel Report { get; set; }

        public HashSet&amp;lt;int&amp;gt; CustomerIDHash { get; set; }
    }

    class ReprotModel
    {
        public int TotalCustomerCount { get; set; }

        public int TotalTradeCount { get; set; }
    }

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é‚£æœ‰æ„æ€çš„å°±æ¥äº†ï¼Œæˆ‘ä¸ªäººæ˜¯æœ‰è®°æ—¥å¿—çš„ç™–å¥½ï¼Œå°±æƒ³ç€ä»¥åä¸ä¼šå‡ºç°æ­»æ— å¯¹è¯çš„æƒ…å†µï¼Œç„¶åå°±ç†æ‰€å½“ç„¶çš„ä½¿ç”¨ &lt;code&gt;JsonConvert.SerializeObject&lt;/code&gt;, è¿™ä¸€ä¸‹å°±å‡ºé—®é¢˜äº†ï¼Œæ—¥å¿—é€å…¥åˆ°äº† &lt;code&gt;ElasticSearch&lt;/code&gt; ï¼Œç„¶åé€šè¿‡ &lt;code&gt;Kibana&lt;/code&gt; æŸ¥ä¸å‡ºæ¥ï¼Œä¸ºå•¥å‘¢ï¼Ÿ çœ‹å®Œä¸Šé¢çš„ Model æˆ‘æƒ³ä½ ä¹ŸçŒœåˆ°äº†åŸå› ï¼Œjsonä½“å¤ªå¤§äº†å“ˆï¼Œå¥½æ­¹ &lt;code&gt;CustomerIDHash&lt;/code&gt; ä¸­ä¹Ÿæœ‰å‡ åä¸‡ä¸ªæ’’ï¼Œè¿™ä¸€ä¸‹å…¨å¯¼å‡ºæˆjsonäº†ï¼Œè¿™ size è¿˜èƒ½å°å—ï¼Ÿ è¦ä¸æˆ‘å†™æ®µä»£ç çœ‹ä¸€çœ‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
        static void Main(string[] args)
        {
            var algorithModel = new CustomerAlgorithmModel()
            {
                CustomerType = 1,
                DisplayName = &quot;ğŸ®ğŸ‘ƒ&quot;,
                Report = new ReprotModel()
                {
                    TotalCustomerCount = 1000,
                    TotalTradeCount = 50
                },
                CustomerIDHash = new HashSet&amp;lt;int&amp;gt;(Enumerable.Range(1, 500000))
            };

            var json = JsonConvert.SerializeObject(algorithModel);

            File.WriteAllText(&quot;1.txt&quot;, json, Encoding.UTF8);

            Console.WriteLine(&quot;å†™å…¥å®Œæˆï¼&quot;);
        }

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/214741/202006/214741-20200619080907542-626066165.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œä»…ä¸€ä¸ªjsonå°± &lt;code&gt;3.3M&lt;/code&gt;ï¼Œè¿™æ ·çš„è®°å½•å¤šæ¥å‡ æ‰“åï¼Œåœ¨ &lt;code&gt;kibana&lt;/code&gt; ä¸Šä¸€æ£€ç´¢ï¼Œæµè§ˆå™¨å°±å¡çš„è¦æ­»ï¼Œå…¶å® &lt;code&gt;CustomerIDHash&lt;/code&gt; è¿™ä¸ªå­—æ®µå¯¹æˆ‘æ¥è¯´æ˜¯å¯æœ‰å¯æ— çš„ï¼Œå°±ç®—å­˜ä¸‹æ¥äº†ä¹Ÿæ²¡å•¥å¤§ç”¨ï¼Œæ‰€ä»¥éœ€æ±‚å°±æ¥äº†ï¼Œå¦‚ä½•å±è”½æ‰ &lt;code&gt;CustomerIDHash&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;äºŒï¼šå¯»æ±‚è§£å†³æ–¹æ¡ˆ&quot;&gt;äºŒï¼šå¯»æ±‚è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;h3 id=&quot;1-ä½¿ç”¨-jsonignore&quot;&gt;1. ä½¿ç”¨ JsonIgnore&lt;/h3&gt;
&lt;p&gt;æœ‰é—®é¢˜å°±ç½‘ä¸Šæœå•Šï¼Œè¿™ä¸€æœé©¬ä¸Šå°±æœ‰äººå‘Šè¯‰ä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;JsonIgnoreAttribute&lt;/code&gt; å¿½ç•¥ç‰¹æ€§ï¼ŒåŠ å¥½è¿™ä¸ªç‰¹æ€§åç»§ç»­è·‘ä¸€ä¸‹ç¨‹åºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
    [Newtonsoft.Json.JsonIgnore]
    public HashSet&amp;lt;int&amp;gt; CustomerIDHash { get; set; }

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/214741/202006/214741-20200619080907871-2135321165.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å¤ªå¥½äº†ï¼Œç»ˆäºæå®šäº†ï¼Œä½†æ˜¯é™ä¸‹å¿ƒæ¥æƒ³ä¸€æƒ³ï¼Œæ€»æ„Ÿè§‰å¿ƒé‡Œæœ‰é‚£ä¹ˆä¸€ç‚¹ä¸èˆ’æœï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œä¸€æ—¦ä½ ç»™è¿™ä¸ª &lt;code&gt;CustomerIDHash&lt;/code&gt; å¥—ä¸Šäº† &lt;code&gt;JsonIgnore&lt;/code&gt; ï¼Œè¿™å°±æ„å‘³ç€å®ƒåœ¨ JsonConvet çš„ä¸–ç•Œä¸­ä»æ­¤æ¶ˆå¤±ï¼Œä¹Ÿä¸ç®¡æ˜¯è°åœ¨ä½¿ç”¨è¿™ä¸ªModelï¼Œ ä½†è¿™å¹¶ä¸æ˜¯æˆ‘çš„åˆè¡·ï¼Œæˆ‘çš„åˆè¡·ä»…ä»…æ˜¯ä¸ºäº†åœ¨è®°å½•æ—¥å¿—çš„æ—¶å€™è¸¢æ‰ &lt;code&gt;CustomerIDHash&lt;/code&gt;ï¼Œå¯åƒä¸‡ä¸è¦å½±å“åœ¨å…¶ä»–åœºæ™¯ä¸‹çš„ä½¿ç”¨å“ˆï¼Œç°åœ¨è¿™ç§åšæ³•å°±ä¼šç»™è‡ªå·±ï¼Œç»™åˆ«äººæŒ–å‘ï¼ŒåŸ‹ä¸‹äº†ä¸å¯é¢„çŸ¥çš„bugï¼Œæˆ‘æƒ³ä½ åº”è¯¥æ˜ç™½æˆ‘çš„æ„æ€ï¼Œè¿˜å¾—ç»§ç»­å¯»æ‰¾ä¸‹ä¸€ä¸ªæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h3 id=&quot;2-ä½¿ç”¨è‡ªå®šä¹‰çš„-jsonconverter&quot;&gt;2. ä½¿ç”¨è‡ªå®šä¹‰çš„ JsonConverter&lt;/h3&gt;
&lt;p&gt;çœŸçš„ï¼Œ&lt;code&gt;Newtonsoft&lt;/code&gt; å¤ªå¼ºå¤§äº†ï¼Œæˆ‘éƒ½æƒ³å†™ä¸€ä¸ªä¸“é¢˜å¥½å¥½å¼¥è¡¥å¼¥è¡¥æˆ‘çš„çŸ¥è¯†ç›²åŒºï¼Œå…¶å®åœ¨è¿™ä¸ªåœºæ™¯ä¸­ä¸å°±æ˜¯æƒ³æŠŠ &lt;code&gt;HashSet&amp;lt;int&amp;gt;&lt;/code&gt; ç»™å±è”½æ‰å˜›ï¼Œ&lt;code&gt;Newtonsoft&lt;/code&gt; ä¸­ä¸“é—¨æä¾›äº†ä¸€ä¸ªé’ˆå¯¹ç‰¹å®šç±»å‹çš„è‡ªå®šä¹‰å¤„ç†ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘å°±å†™ä¸€æ®µï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
   /// &amp;lt;summary&amp;gt;
   /// è‡ªå®šä¹‰ä¸€ä¸ª é’ˆå¯¹ HashSet&amp;lt;int&amp;gt; çš„è½¬æ¢ç±»
   /// &amp;lt;/summary&amp;gt;
   public class HashSetConverter : Newtonsoft.Json.JsonConverter&amp;lt;HashSet&amp;lt;int&amp;gt;&amp;gt;
   {
       public override HashSet&amp;lt;int&amp;gt; ReadJson(JsonReader reader, Type objectType, HashSet&amp;lt;int&amp;gt; existingValue, bool hasExistingValue, JsonSerializer serializer)
       {
           return existingValue;
       }

       public override void WriteJson(JsonWriter writer, HashSet&amp;lt;int&amp;gt; value, JsonSerializer serializer)
       {
           writer.WriteNull();
       }
   } 

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œç„¶åå°±å¯ä»¥åœ¨ &lt;code&gt;SerializeObject&lt;/code&gt; çš„æ—¶å€™æŒ‡å®šä¸‹è‡ªå®šä¹‰çš„ &lt;code&gt;HashSetConverter&lt;/code&gt; å³å¯ï¼Œç„¶åå†å°†ç¨‹åºè·‘èµ·æ¥çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
 var json = JsonConvert.SerializeObject(algorithModel, Formatting.Indented, new HashSetConverter());

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/214741/202006/214741-20200619080908118-301859342.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­çœ‹ï¼Œè²Œä¼¼ä¹Ÿæ˜¯è§£å†³äº†ï¼Œä½†æˆ‘çªç„¶å‘ç°è‡ªå·±è¦é’»ç‰›è§’å°–äº†ï¼Œå¦‚æœæˆ‘çš„å®ä½“ä¸­åˆæ¥äº†ä¸€ä¸ªé¡¶çº§ä¼˜è´¨å®¢æˆ·ç¾¤çš„ &lt;code&gt;TopNCustomerIDHash&lt;/code&gt;ï¼Œä½†å› ä¸ºè¿™ä¸ªCustomerID æ¯”è¾ƒå°‘ï¼Œæˆ‘å¸Œæœ›åœ¨ Json ä¸­èƒ½ä¿ç•™ä¸‹æ¥ï¼Œç„¶åå°±æ˜¯è¸¢æ‰çš„é‚£ä¸ª CustomerIDHash æˆ‘è¦ä¿ç•™ &lt;code&gt;CustomerIDHash.Length&lt;/code&gt; ï¼Œå“ˆå“ˆï¼Œæäº‹æƒ…å“ˆï¼Œé‚£æ¥ä¸‹æ¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;ä¿®æ”¹ Model å®ä½“&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
    class CustomerAlgorithmModel
    {
        public HashSet&amp;lt;int&amp;gt; CustomerIDHash { get; set; }

        // topN ä¼˜è´¨å®¢æˆ·ç¾¤
        public HashSet&amp;lt;int&amp;gt; TopNCustomerIDHash { get; set; }
    }

&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;HashSetConverter å¢åŠ é€»è¾‘é‰´åˆ«æ˜¯å¦ä¸ºä¿ç•™å­—æ®µ&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
        public override void WriteJson(JsonWriter writer, HashSet&amp;lt;int&amp;gt; value, JsonSerializer serializer)
        {
            if (writer.Path == &quot;TopNCustomerIDHash&quot;)
            {
                writer.WriteStartArray();

                foreach (var item in value)
                {
                    writer.WriteValue(item);
                }

                writer.WriteEndArray();
            }
            else
            {
                writer.WriteValue(value.Count);
            }
        }

&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;æœ€åç»™ TopNCustomerIDHash èµ‹å€¼&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
            var algorithModel = new CustomerAlgorithmModel()
            {
                CustomerType = 1,
                DisplayName = &quot;ğŸ®ğŸ‘ƒ&quot;,
                Report = new ReprotModel()
                {
                    TotalCustomerCount = 1000,
                    TotalTradeCount = 50
                },
                CustomerIDHash = new HashSet&amp;lt;int&amp;gt;(Enumerable.Range(1, 500000)),
                TopNCustomerIDHash = new HashSet&amp;lt;int&amp;gt;(Enumerable.Range(1, 10)),
            };

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸‰å—éƒ½æå®šåå°±å¯ä»¥æŠŠç¨‹åºè·‘èµ·æ¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/214741/202006/214741-20200619080908484-2080311596.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è²Œä¼¼é’»ç‰›è§’å°–çš„é—®é¢˜æ˜¯è§£å†³äº†ï¼Œæ—¢ç„¶é’»ç‰›è§’å°–è‚¯å®šè¦å„ç§é„™è§†ï¼Œæ¯”å¦‚è¿™é‡Œçš„ ReportModel æˆ‘æ˜¯ä¸éœ€è¦çš„ï¼ŒCustomerType æˆ‘ä¹Ÿæ˜¯ä¸éœ€è¦çš„ï¼Œæˆ‘ä»…ä»…éœ€è¦çœ‹ä¸€ä¸‹ &lt;code&gt;DisplayName&lt;/code&gt; å’Œ &lt;code&gt;TotalCustomerCount&lt;/code&gt; è¿™ä¸¤ä¸ªå­—æ®µå°±å¯ä»¥äº†ï¼Œ é‚£è¿™ä¸ªè¦æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&quot;3-ä½¿ç”¨-åŒ¿åç±»å‹&quot;&gt;3. ä½¿ç”¨ åŒ¿åç±»å‹&lt;/h3&gt;
&lt;p&gt;ç¡®å®å¾ˆå¤šæ—¶å€™è®°æ—¥å¿—ï¼Œå°±æ˜¯ä¸ºäº†è·Ÿè¸ª Model ä¸­ä½ ç‰¹åˆ«å…³å¿ƒçš„é‚£å‡ ä¸ªå­—æ®µï¼Œæ‰€ä»¥æºæ‚äº†å¤šä½™çš„å­—æ®µç¡®å®ä¹Ÿæ˜¯æ²¡å¿…è¦çš„ï¼Œè¿™é‡Œå¯ä»¥ç”¨åŒ¿åæ¥è§£å†³ï¼Œæˆ‘å°±æ¥å†™ä¸€æ®µä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-C#&quot;&gt;
    var json = JsonConvert.SerializeObject(new
    {
        algorithModel.DisplayName,
        algorithModel.Report.TotalCustomerCount
    }, Formatting.Indented);

&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/214741/202006/214741-20200619080908770-1632920626.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;ä¸‰ï¼š-æ€»ç»“&quot;&gt;ä¸‰ï¼š æ€»ç»“&lt;/h2&gt;
&lt;p&gt;è™½ç„¶é˜»å‡»äº†å‡ ä¸ªå›åˆï¼Œä½†åŒæ—¶ä¹Ÿå‘ç°äº† &lt;code&gt;Newtonsoft&lt;/code&gt; ä¸­è¿˜æœ‰ç‰¹åˆ«å¤šçš„æœªæŒ–æ˜åŠŸèƒ½ï¼ŒçœŸçš„éœ€è¦å¥½å¥½ç ”ç©¶ç ”ç©¶ï¼Œæºç å·²ä¸‹å¥½ï¼Œæ¥ä¸‹æ¥å‡†å¤‡åšä¸ªç³»åˆ—æ¥è§£å‰–ä¸€ä¸‹ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ &lt;code&gt;.Net&lt;/code&gt;ä¸­å·²è‡ªå¸¦äº† &lt;code&gt;System.Text.Json.JsonSerializer&lt;/code&gt; ç±»ï¼Œç›®å‰æ¥çœ‹åŠŸèƒ½è¿˜ä¸ç®—å¤ªä¸°å¯Œï¼Œç®€å•ç”¨ç”¨è¿˜æ˜¯å¯ä»¥çš„ï¼Œæœ¬ç¯‡å°±è¯´åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚&lt;/p&gt;
&lt;hr/&gt;&lt;h3 id=&quot;å¦‚æ‚¨æœ‰æ›´å¤šé—®é¢˜ä¸æˆ‘äº’åŠ¨ï¼Œæ‰«æä¸‹æ–¹è¿›æ¥å§&quot;&gt;å¦‚æ‚¨æœ‰æ›´å¤šé—®é¢˜ä¸æˆ‘äº’åŠ¨ï¼Œæ‰«æä¸‹æ–¹è¿›æ¥å§~&lt;/h3&gt;
&lt;img src=&quot;https://img2020.cnblogs.com/blog/214741/202005/214741-20200522143723695-575216767.png&quot; width=&quot;600&quot; height=&quot;200&quot; alt=&quot;å›¾ç‰‡åç§°&quot; align=&quot;center&quot;/&gt;</description>
<pubDate>Fri, 19 Jun 2020 00:09:00 +0000</pubDate>
<dc:creator>ä¸€çº¿ç å†œ</dc:creator>
<og:description>ä¸€ï¼šèƒŒæ™¯ 1. è®²æ•…äº‹ åœ¨å¼€å§‹æœ¬æ–‡ä¹‹å‰ï¼ŒçœŸçš„å¥½æƒ³åšä¸ªé—®å·è°ƒæŸ¥ï¼Œåˆ°åº•æœ‰å¤šå°‘äººå’Œæˆ‘ä¸€æ ·ï¼Œå¯¹ JsonConvert çš„è®¤è¯†åªå±€é™åœ¨ SerializeObject å’Œ DeserializeObject</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/huangxincheng/p/13161143.html</dc:identifier>
</item>
<item>
<title>æ•æˆ‘ç›´è¨€ä½ å¯èƒ½çœŸçš„ä¸ä¼šjavaç¬¬4ç¯‡ï¼šStreamç®¡é“æµMapæ“ä½œ - å­—æ¯å“¥åšå®¢</title>
<link>http://www.cnblogs.com/zimug/p/13161118.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/zimug/p/13161118.html</guid>
<description>&lt;h2 id=&quot;ä¸€ã€å›é¡¾streamç®¡é“æµmapçš„åŸºç¡€ç”¨æ³•&quot;&gt;ä¸€ã€å›é¡¾Streamç®¡é“æµmapçš„åŸºç¡€ç”¨æ³•&lt;/h2&gt;
&lt;p&gt;æœ€ç®€å•çš„éœ€æ±‚ï¼šå°†é›†åˆä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¨éƒ¨è½¬æ¢æˆå¤§å†™ï¼&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;List&amp;lt;String&amp;gt; alpha = Arrays.asList(&quot;Monkey&quot;, &quot;Lion&quot;, &quot;Giraffe&quot;, &quot;Lemur&quot;);

//ä¸ä½¿ç”¨Streamç®¡é“æµ
List&amp;lt;String&amp;gt; alphaUpper = new ArrayList&amp;lt;&amp;gt;();
for (String s : alpha) {
    alphaUpper.add(s.toUpperCase());
}
System.out.println(alphaUpper); //[MONKEY, LION, GIRAFFE, LEMUR]

// ä½¿ç”¨Streamç®¡é“æµ
List&amp;lt;String&amp;gt; collect = alpha.stream().map(String::toUpperCase).collect(Collectors.toList());
//ä¸Šé¢ä½¿ç”¨äº†æ–¹æ³•å¼•ç”¨ï¼Œå’Œä¸‹é¢çš„lambdaè¡¨è¾¾å¼è¯­æ³•æ•ˆæœæ˜¯ä¸€æ ·çš„
//List&amp;lt;String&amp;gt; collect = alpha.stream().map(s -&amp;gt; s.toUpperCase()).collect(Collectors.toList());

System.out.println(collect); //[MONKEY, LION, GIRAFFE, LEMUR]
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥&lt;strong&gt;mapå‡½æ•°çš„ä½œç”¨å°±æ˜¯é’ˆå¯¹ç®¡é“æµä¸­çš„æ¯ä¸€ä¸ªæ•°æ®å…ƒç´ è¿›è¡Œè½¬æ¢æ“ä½œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1815316/202006/1815316-20200619074257914-1438012054.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;äºŒã€å¤„ç†éå­—ç¬¦ä¸²ç±»å‹é›†åˆå…ƒç´ &quot;&gt;äºŒã€å¤„ç†éå­—ç¬¦ä¸²ç±»å‹é›†åˆå…ƒç´ &lt;/h2&gt;
&lt;p&gt;map()å‡½æ•°ä¸ä»…å¯ä»¥å¤„ç†æ•°æ®ï¼Œè¿˜å¯ä»¥è½¬æ¢æ•°æ®çš„ç±»å‹ã€‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;List&amp;lt;Integer&amp;gt; lengths = alpha.stream()
        .map(String::length)
        .collect(Collectors.toList());

System.out.println(lengths); //[6, 4, 7, 5]
&lt;/code&gt;
&lt;/pre&gt;
&lt;pre&gt;
&lt;code&gt;Stream.of(&quot;Monkey&quot;, &quot;Lion&quot;, &quot;Giraffe&quot;, &quot;Lemur&quot;)
        .mapToInt(String::length)
        .forEach(System.out::println);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¾“å‡ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;6
4
7
5
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;é™¤äº†mapToIntã€‚è¿˜æœ‰maoToLongï¼ŒmapToDoubleç­‰ç­‰ç”¨æ³•&lt;/p&gt;
&lt;h2 id=&quot;ä¸‰ã€å†å¤æ‚ä¸€ç‚¹ï¼šå¤„ç†å¯¹è±¡æ•°æ®æ ¼å¼è½¬æ¢&quot;&gt;ä¸‰ã€å†å¤æ‚ä¸€ç‚¹ï¼šå¤„ç†å¯¹è±¡æ•°æ®æ ¼å¼è½¬æ¢&lt;/h2&gt;
&lt;p&gt;è¿˜æ˜¯ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­çš„Employeeç±»ï¼Œåˆ›å»º10ä¸ªå¯¹è±¡ã€‚éœ€æ±‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;å°†æ¯ä¸€ä¸ªEmployeeçš„å¹´é¾„å¢åŠ ä¸€å²&lt;/li&gt;
&lt;li&gt;å°†æ€§åˆ«ä¸­çš„â€œMâ€æ¢æˆâ€œmaleâ€ï¼ŒFæ¢æˆFemaleã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;pre&gt;
&lt;code&gt;public static void main(String[] args){
    Employee e1 = new Employee(1,23,&quot;M&quot;,&quot;Rick&quot;,&quot;Beethovan&quot;);
    Employee e2 = new Employee(2,13,&quot;F&quot;,&quot;Martina&quot;,&quot;Hengis&quot;);
    Employee e3 = new Employee(3,43,&quot;M&quot;,&quot;Ricky&quot;,&quot;Martin&quot;);
    Employee e4 = new Employee(4,26,&quot;M&quot;,&quot;Jon&quot;,&quot;Lowman&quot;);
    Employee e5 = new Employee(5,19,&quot;F&quot;,&quot;Cristine&quot;,&quot;Maria&quot;);
    Employee e6 = new Employee(6,15,&quot;M&quot;,&quot;David&quot;,&quot;Feezor&quot;);
    Employee e7 = new Employee(7,68,&quot;F&quot;,&quot;Melissa&quot;,&quot;Roy&quot;);
    Employee e8 = new Employee(8,79,&quot;M&quot;,&quot;Alex&quot;,&quot;Gussin&quot;);
    Employee e9 = new Employee(9,15,&quot;F&quot;,&quot;Neetu&quot;,&quot;Singh&quot;);
    Employee e10 = new Employee(10,45,&quot;M&quot;,&quot;Naveen&quot;,&quot;Jain&quot;);


    List&amp;lt;Employee&amp;gt; employees = Arrays.asList(e1, e2, e3, e4, e5, e6, e7, e8, e9, e10);

    /*List&amp;lt;Employee&amp;gt; maped = employees.stream()
            .map(e -&amp;gt; {
                e.setAge(e.getAge() + 1);
                e.setGender(e.getGender().equals(&quot;M&quot;)?&quot;male&quot;:&quot;female&quot;);
                return e;
            }).collect(Collectors.toList());*/

    List&amp;lt;Employee&amp;gt; maped = employees.stream()
            .peek(e -&amp;gt; {
                e.setAge(e.getAge() + 1);
                e.setGender(e.getGender().equals(&quot;M&quot;)?&quot;male&quot;:&quot;female&quot;);
            }).collect(Collectors.toList());

    System.out.println(maped);

}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ç”±äºmapçš„å‚æ•°eå°±æ˜¯è¿”å›å€¼ï¼Œæ‰€ä»¥å¯ä»¥ç”¨peekå‡½æ•°ã€‚peekå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„mapå‡½æ•°ï¼Œå½“å‡½æ•°æ²¡æœ‰è¿”å›å€¼æˆ–è€…å‚æ•°å°±æ˜¯è¿”å›å€¼çš„æ—¶å€™å¯ä»¥ä½¿ç”¨peekå‡½æ•°ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å››ã€flatmap&quot;&gt;å››ã€flatMap&lt;/h2&gt;
&lt;p&gt;mapå¯ä»¥å¯¹ç®¡é“æµä¸­çš„æ•°æ®è¿›è¡Œè½¬æ¢æ“ä½œï¼Œä½†æ˜¯å¦‚æœç®¡é“ä¸­è¿˜æœ‰ç®¡é“è¯¥å¦‚ä½•å¤„ç†ï¼Ÿå³ï¼šå¦‚ä½•å¤„ç†äºŒç»´æ•°ç»„åŠäºŒç»´é›†åˆç±»ã€‚å®ç°ä¸€ä¸ªç®€å•çš„éœ€æ±‚ï¼šå°†â€œhelloâ€ï¼Œâ€œworldâ€ä¸¤ä¸ªå­—ç¬¦ä¸²ç»„æˆçš„é›†åˆï¼Œå…ƒç´ çš„æ¯ä¸€ä¸ªå­—æ¯æ‰“å°å‡ºæ¥ã€‚å¦‚æœä¸ç”¨Streamæˆ‘ä»¬æ€ä¹ˆå†™ï¼Ÿå†™2å±‚forå¾ªç¯,ç¬¬ä¸€å±‚éå†å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆcharæ•°ç»„ï¼Œç¬¬äºŒå±‚forå¾ªç¯éå†charæ•°ç»„ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;List&amp;lt;String&amp;gt; words = Arrays.asList(&quot;hello&quot;, &quot;word&quot;);
words.stream()
        .map(w -&amp;gt; Arrays.stream(w.split(&quot;&quot;)))    //[[h,e,l,l,o],[w,o,r,l,d]]
        .forEach(System.out::println);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¾“å‡ºæ‰“å°ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;java.util.stream.ReferencePipeline$Head@3551a94
java.util.stream.ReferencePipeline$Head@531be3c5
&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;&lt;li&gt;ç”¨mapæ–¹æ³•æ˜¯åšä¸åˆ°çš„ï¼Œè¿™ä¸ªéœ€æ±‚ç”¨mapæ–¹æ³•æ— æ³•å®ç°ã€‚mapåªèƒ½é’ˆå¯¹ä¸€ç»´æ•°ç»„è¿›è¡Œæ“ä½œï¼Œæ•°ç»„é‡Œé¢è¿˜æœ‰æ•°ç»„ï¼Œç®¡é“é‡Œé¢è¿˜æœ‰ç®¡é“ï¼Œå®ƒæ˜¯å¤„ç†ä¸äº†æ¯ä¸€ä¸ªå…ƒç´ çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1815316/202006/1815316-20200619074258271-2000046664.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;flatMapå¯ä»¥ç†è§£ä¸ºå°†è‹¥å¹²ä¸ªå­ç®¡é“ä¸­çš„æ•°æ®å…¨éƒ½ï¼Œå¹³é¢å±•å¼€åˆ°çˆ¶ç®¡é“ä¸­è¿›è¡Œå¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/other/1815316/202006/1815316-20200619074258769-1528898385.jpg&quot; alt=&quot;file&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;words.stream()
        .flatMap(w -&amp;gt; Arrays.stream(w.split(&quot;&quot;))) // [h,e,l,l,o,w,o,r,l,d]
        .forEach(System.out::println);
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¾“å‡ºæ‰“å°ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;h
e
l
l
o
w
o
r
d
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2 id=&quot;æ¬¢è¿å…³æ³¨æˆ‘çš„åšå®¢ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç²¾å“åˆé›†&quot;&gt;æ¬¢è¿å…³æ³¨æˆ‘çš„åšå®¢ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç²¾å“åˆé›†&lt;/h2&gt;
&lt;ul&gt;&lt;li&gt;æœ¬æ–‡è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ˆå¿…é¡»å¸¦è¿æ¥ï¼Œä¸èƒ½åªè½¬æ–‡å­—ï¼‰ï¼š&lt;a href=&quot;http://www.zimug.com&quot;&gt;å­—æ¯å“¥åšå®¢&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;è§‰å¾—å¯¹æ‚¨æœ‰å¸®åŠ©çš„è¯ï¼Œå¸®æˆ‘ç‚¹èµã€åˆ†äº«ï¼æ‚¨çš„æ”¯æŒæ˜¯æˆ‘ä¸ç«­çš„åˆ›ä½œåŠ¨åŠ›ï¼&lt;/strong&gt; ã€‚å¦å¤–ï¼Œç¬”è€…æœ€è¿‘ä¸€æ®µæ—¶é—´è¾“å‡ºäº†å¦‚ä¸‹çš„ç²¾å“å†…å®¹ï¼ŒæœŸå¾…æ‚¨çš„å…³æ³¨ã€‚&lt;/p&gt;
</description>
<pubDate>Thu, 18 Jun 2020 23:43:00 +0000</pubDate>
<dc:creator>å­—æ¯å“¥åšå®¢</dc:creator>
<og:description>ä¸€ã€å›é¡¾Streamç®¡é“æµmapçš„åŸºç¡€ç”¨æ³• æœ€ç®€å•çš„éœ€æ±‚ï¼šå°†é›†åˆä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¨éƒ¨è½¬æ¢æˆå¤§å†™ï¼ List&amp;amp;lt;String&amp;amp;gt; alpha = Arrays.asList(&amp;</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/zimug/p/13161118.html</dc:identifier>
</item>
<item>
<title>å°å¸ˆå¦¹å­¦JVMä¹‹:JITä¸­çš„LogCompilation - flydean</title>
<link>http://www.cnblogs.com/flydean/p/jvm-jit-logcompilation.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/flydean/p/jvm-jit-logcompilation.html</guid>
<description>&lt;p&gt;æˆ‘ä»¬çŸ¥é“åœ¨JVMä¸­ä¸ºäº†åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œå¼•å…¥äº†JITå³æ—¶ç¼–è¯‘çš„åŠŸèƒ½ã€‚é‚£ä¹ˆJITä»€ä¹ˆæ—¶å€™å¼€å§‹ç¼–è¯‘çš„ï¼Œåˆæ˜¯æ€ä¹ˆç¼–è¯‘çš„ï¼Œä½œä¸ºä¸€ä¸ªé«˜å‚²çš„ç¨‹åºå‘˜ï¼Œæœ‰æ²¡æœ‰åŠæ³•å»æ¢ç©¶JITç¼–è¯‘çš„ç§˜å¯†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œä»Šå¤©å’Œå°å¸ˆå¦¹ä¸€èµ·å¸¦å¤§å®¶æ¥çœ‹ä¸€çœ‹è¿™ä¸ªç¼–è¯‘èƒŒåçš„ç§˜å¯†ã€‚&lt;/p&gt;
&lt;p&gt;æ›´å¤šç²¾å½©å†…å®¹ä¸”çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;å°å¸ˆå¦¹ï¼šFå¸ˆå…„ï¼ŒJITè¿™ä¹ˆç¥å™¨ï¼Œä½†æ˜¯å¥½åƒå°±æ˜¯ä¸€ä¸ªé»‘ç›’å­ï¼Œæœ‰æ²¡æœ‰åŠæ³•å¯ä»¥æ¢å¯»åˆ°å…¶å†…éƒ¨çš„æœ¬è´¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿½æ±‚çœŸç†å’Œæ¢ç´¢ç²¾ç¥æ˜¯æˆ‘ä»¬ä½œä¸ºç¨‹åºå‘˜çš„æœ€å¤§ä¼˜ç‚¹ï¼Œæƒ³æƒ³å¦‚æœæ²¡æœ‰ç»å°”å…³äºåŸå­ç»“æ„çš„æ–°ç†è®ºï¼Œæ€ä¹ˆä¼šæœ‰åŸå­ä½“ç³»çš„çªç ´ï¼Œå¦‚æœæ²¡æœ‰æµ·æ£®å ¡çš„çŸ©é˜µåŠ›å­¦ï¼Œæ€ä¹ˆä¼šæœ‰é‡å­åŠ›å­¦çš„å»ºç«‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;JITçš„ç¼–è¯‘æ—¥å¿—è¾“å‡ºå¾ˆç®€å•ï¼Œä½¿ç”¨ -XX:+LogCompilationå°±å¤Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦æŠŠæ—¥å¿—é‡å®šå‘åˆ°ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåˆ™å¯ä»¥ä½¿ç”¨-XX:LogFile= ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¦å¼€å¯è¿™äº›åˆ†æçš„åŠŸèƒ½ï¼Œåˆéœ€è¦ä½¿ç”¨-XX:+UnlockDiagnosticVMOptionsã€‚ æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;-XX:+UnlockDiagnosticVMOptions -XX:+LogCompilation -XX:LogFile=www.flydean.com.log
&lt;/code&gt;
&lt;/pre&gt;

&lt;p&gt;æ ¹æ®ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬ç°åœºæ¥ç”Ÿæˆä¸€ä¸ªJITçš„ç¼–è¯‘æ—¥å¿—ï¼Œä¸ºäº†ä½“ç°å‡ºä¸“ä¸šæ€§ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°JMHæ¥åšæ€§èƒ½æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;JMHçš„å…¨ç§°æ˜¯Java Microbenchmark Harnessï¼Œæ˜¯ä¸€ä¸ªopen JDKä¸­ç”¨æ¥åšæ€§èƒ½æµ‹è¯•çš„å¥—ä»¶ã€‚è¯¥å¥—ä»¶å·²ç»è¢«åŒ…å«åœ¨äº†JDK 12ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨çš„ä¸æ˜¯JDK 12ï¼Œé‚£ä¹ˆéœ€è¦æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-xml&quot;&gt;&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.openjdk.jmh&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;jmh-core&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;1.19&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.openjdk.jmh&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;jmh-generator-annprocess&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;1.19&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ›´å¤šè¯¦æƒ…å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„ï¼š åœ¨javaä¸­ä½¿ç”¨JMHï¼ˆJava Microbenchmark Harnessï¼‰åšæ€§èƒ½æµ‹è¯•ä¸€æ–‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æœ‰çš„æœ‹å‹è¯´ï¼Œä»£ç ä¹Ÿç”¨å›¾ç‰‡ï¼Œçœ‹èµ·æ¥å¥½çœ‹ï¼Œä»æœ¬æ–‡ä¹‹åï¼Œæˆ‘ä»¬ä¼šå°½é‡æŠŠä»£ç ä¹Ÿè½¬æˆå›¾ç‰‡æ¥å±•ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/20200529101342389.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_0,text_aHR0cDovL3d3dy5mbHlkZWFuLmNvbQ==,size_35,color_8F8F8F,t_70&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;çœ‹å®Œæˆ‘çš„JMHçš„ä»‹ç»ï¼Œä¸Šé¢çš„ä¾‹å­åº”è¯¥å¾ˆæ¸…æ¥šäº†ï¼Œä¸»è¦å°±æ˜¯åšä¸€ä¸ªç´¯åŠ æ“ä½œï¼Œç„¶åwarmup 5è½®ï¼Œæµ‹è¯•5è½®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨@Forkæ³¨è§£é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®jvmçš„å‚æ•°ï¼Œä¸ºä»€ä¹ˆæˆ‘æ³¨é‡Šæ‰äº†å‘¢ï¼Ÿå› ä¸ºæˆ‘å‘ç°åœ¨jvmArgsPrependä¸­çš„-XX:LogFileæ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ²¡åŠæ³•ï¼Œæˆ‘åªå¥½åœ¨è¿è¡Œé…ç½®ä¸­æ·»åŠ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/20200529101742580.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_0,text_aHR0cDovL3d3dy5mbHlkZWFuLmNvbQ==,size_35,color_8F8F8F,t_70&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;è¿è¡Œä¹‹åï¼Œä½ å°±å¯ä»¥å¾—åˆ°è¾“å‡ºçš„ç¼–è¯‘æ—¥å¿—æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;å°å¸ˆå¦¹ï¼šFå¸ˆå…„ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹ç”Ÿæˆçš„æ–‡ä»¶å¥½å¤æ‚å•Šï¼Œç”¨è‚‰çœ¼èƒ½çœ‹å¾—æ˜ç™½å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åˆ«æ€•ï¼Œåªæ˜¯å†…å®¹çš„å¤šä¸€ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬ç»†ç»†å†ç»†ç»†çš„åˆ†æä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°å…¶å®å®ƒçœŸçš„éå¸¸éå¸¸......å¤æ‚!&lt;/p&gt;
&lt;p&gt;å…¶å®å†™ç‚¹ç®€å•çš„å°ç™½æ–‡ä¸å¥½å—ï¼Ÿä¸ºä»€ä¹ˆè¦æ¥åˆ†æè¿™ä¹ˆå¤æ‚ï¼Œåˆæ²¡äººçœ‹ï¼Œçœ‹äº†ä¹Ÿæ²¡äººæ‡‚çš„JVMåº•å±‚.....&lt;/p&gt;
&lt;p&gt;å¤§æ¦‚ï¼Œè¿™å°±æ˜¯ä¸“ä¸šå§ï¼&lt;/p&gt;
&lt;p&gt;LogCompilationæ–‡ä»¶å…¶å®æ˜¯xmlæ ¼å¼çš„ï¼Œæˆ‘ä»¬ç°åœ¨æ¥å¤§æ¦‚åˆ†æä¸€ä¸‹ï¼Œå®ƒçš„ç»“æ„ï¼Œè®©å¤§å®¶ä¸‹æ¬¡çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¹Ÿèƒ½å¤Ÿå¤§æ¦‚äº†è§£å®ƒçš„é‡ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/20200529222302406.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_0,text_aHR0cDovL3d3dy5mbHlkZWFuLmNvbQ==,size_35,color_8F8F8F,t_70&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœ€åŸºæœ¬çš„ä¿¡æ¯å°±æ˜¯JVMçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬JVMçš„ç‰ˆæœ¬ï¼ŒJVMè¿è¡Œçš„å‚æ•°ï¼Œè¿˜æœ‰ä¸€äº›propertieså±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ”¶é›†åˆ°çš„æ—¥å¿—å…¶å®æ˜¯åˆ†ä¸¤ç±»çš„ï¼Œç¬¬ä¸€ç±»æ˜¯åº”ç”¨ç¨‹åºæœ¬èº«çš„çš„ç¼–è¯‘æ—¥å¿—ï¼Œç¬¬äºŒç±»å°±æ˜¯ç¼–è¯‘çº¿ç¨‹è‡ªå·±å†…éƒ¨äº§ç”Ÿçš„æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç±»çš„æ—¥å¿—ä¼šä»¥hs_c*.logçš„æ ¼å¼å­˜å‚¨ï¼Œç„¶ååœ¨JVMé€€å‡ºçš„æ—¶å€™ï¼Œå†å°†è¿™äº›æ–‡ä»¶è·Ÿæœ€ç»ˆçš„æ—¥å¿—è¾“å‡ºæ–‡ä»¶åˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªæ•´ä½“çš„æ—¥å¿—æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä¸‹é¢çš„ä¸¤ä¸ªå°±æ˜¯ç¼–è¯‘çº¿ç¨‹å†…éƒ¨çš„æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;thread_logfile thread='22275' filename='/var/folders/n5/217y_bgn49z18zvjch907xb00000gp/T//hs_c22275_pid83940.log'/&amp;gt;
&amp;lt;thread_logfile thread='41731' filename='/var/folders/n5/217y_bgn49z18zvjch907xb00000gp/T//hs_c41731_pid83940.log'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢åˆ—å‡ºäº†ç¼–è¯‘çº¿ç¨‹çš„id=22275ï¼Œå¦‚æœæˆ‘ä»¬é¡ºç€22275æ‰¾ä¸‹å»ï¼Œåˆ™å¯ä»¥æ‰¾åˆ°å…·ä½“ç¼–è¯‘çº¿ç¨‹çš„æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;compilation_log thread='22275'&amp;gt;
...
&amp;lt;/compilation_log&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢ç”±compilation_logå›´èµ·æ¥çš„éƒ¨åˆ†å°±æ˜¯ç¼–è¯‘æ—¥å¿—äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„éƒ¨åˆ†è¡¨ç¤ºï¼Œç¼–è¯‘çº¿ç¨‹å¼€å§‹æ‰§è¡Œäº†ï¼Œå…¶ä¸­stampè¡¨ç¤ºçš„æ˜¯å¯åŠ¨æ—¶é—´ï¼Œä¸‹å›¾åˆ—å‡ºäº†ä¸€ä¸ªå®Œæ•´çš„ç¼–è¯‘çº¿ç¨‹çš„æ—¥å¿—ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/20200529224327438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_0,text_aHR0cDovL3d3dy5mbHlkZWFuLmNvbQ==,size_35,color_8F8F8F,t_70&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;start_compile_thread name='C2 CompilerThread0' thread='22275' process='83940' stamp='0.058'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥æè¿°çš„æ˜¯è¦ç¼–è¯‘çš„æ–¹æ³•ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;task compile_id='10' method='java.lang.Object &amp;lt;init&amp;gt; ()V' bytes='1' count='1409' iicount='1409' stamp='0.153'&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢åˆ—å‡ºäº†è¦ç¼–è¯‘çš„æ–¹æ³•åï¼Œcompile_idè¡¨ç¤ºçš„æ˜¯ç³»ç»Ÿå†…éƒ¨åˆ†é…çš„ç¼–è¯‘idï¼Œbytesæ˜¯æ–¹æ³•ä¸­çš„å­—èŠ‚æ•°ï¼Œcountè¡¨ç¤ºçš„æ˜¯è¯¥æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„æ¬¡æ•°å¹¶ä¸æ˜¯æ–¹æ³•çš„çœŸå®è°ƒç”¨æ¬¡æ•°ï¼Œåªèƒ½åšä¸€ä¸ªä¼°è®¡ã€‚&lt;/p&gt;
&lt;p&gt;iicountæ˜¯è§£é‡Šå™¨è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;taskæ‰§è¡Œäº†ï¼Œè‡ªç„¶å°±ä¼šæ‰§è¡Œå®Œæˆï¼Œæ‰§è¡Œå®Œæˆçš„å†…å®¹æ˜¯ä»¥task_doneæ ‡ç­¾æ¥è¡¨ç¤ºçš„ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;task_done success='1' nmsize='120' count='1468' stamp='0.155'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å…¶ä¸­successè¡¨ç¤ºæ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œnmsizeè¡¨ç¤ºç¼–è¯‘å™¨ç¼–è¯‘å‡ºæ¥çš„æŒ‡ä»¤å¤§å°ï¼Œä»¥byteä¸ºå•ä½ã€‚å¦‚æœæœ‰å†…è”çš„è¯ï¼Œè¿˜æœ‰ä¸ªinlined_byteså±æ€§ï¼Œè¡¨ç¤ºinlinedçš„å­—èŠ‚ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;type id='1025' name='void'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;typeè¡¨ç¤ºçš„æ˜¯æ–¹æ³•çš„è¿”å›ç±»å‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;klass id='1030' name='java.lang.Object' flags='1'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;klassè¡¨ç¤ºçš„æ˜¯å®ä¾‹å’Œæ•°ç»„ç±»å‹ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;method id='1148' holder='1030' name='&amp;lt;init&amp;gt;' return='1025' flags='1' bytes='1' compile_id='1' compiler='c1' level='3' iicount='1419'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;methodè¡¨ç¤ºæ‰§è¡Œçš„æ–¹æ³•ï¼Œholderæ˜¯å‰é¢çš„klassçš„idï¼Œè¡¨ç¤ºçš„æ˜¯å®šä¹‰è¯¥æ–¹æ³•çš„å®ä¾‹æˆ–è€…æ•°ç»„å¯¹è±¡ã€‚methodæœ‰åå­—ï¼Œæœ‰&lt;br/&gt;returnï¼Œreturnå¯¹åº”çš„æ˜¯ä¸Šé¢çš„typeã€‚&lt;/p&gt;
&lt;p&gt;flagsè¡¨ç¤ºçš„æ˜¯æ–¹æ³•çš„è®¿é—®æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯parseï¼Œæ˜¯åˆ†æé˜¶æ®µçš„æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;parse method='1148' uses='1419.000000' stamp='0.153'&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢æœ‰parseçš„æ–¹æ³•idã€‚usesæ˜¯ä½¿ç”¨æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;bc code='177' bci='0'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;bcæ˜¯byte Countçš„ç¼©å†™ï¼Œcodeæ˜¯byteçš„ä¸ªæ•°ï¼Œbciæ˜¯byte codeçš„ç´¢å¼•ã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;dependency type='no_finalizable_subclasses' ctxk='1030'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;dependencyåˆ†æçš„æ˜¯ç±»çš„ä¾èµ–å…³ç³»ï¼Œtypeè¡¨ç¤ºçš„æ˜¯ä»€ä¹ˆç±»å‹çš„ä¾èµ–ï¼Œctkxæ˜¯ä¾èµ–çš„context classã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ³¨æ„æœ‰çš„parseä¸­ï¼Œå¯èƒ½ä¼šæœ‰uncommon_trapï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;uncommon_trap bci='10' reason='unstable_if' action='reinterpret' debug_id='0' comment='taken never'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ€ä¹ˆç†è§£uncommon_trapå‘¢ï¼Ÿå­—é¢ä¸Šæ„æ€å°±æ˜¯æ•è·éå¸¸ç”¨çš„ä»£ç ï¼Œå°±æ˜¯è¯´åœ¨è§£æä»£ç çš„è¿‡ç¨‹ä¸­å‘ç°å‘ç°è¿™äº›ä»£ç æ˜¯uncommonçš„ï¼Œç„¶åè§£æäº§ç”Ÿä¸€ä¸ªuncommon_trapï¼Œä¸å†ç»§ç»­è¿›è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒé‡Œé¢æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å­—æ®µï¼Œreasonè¡¨ç¤ºçš„æ˜¯è¢«æ ‡è®°ä¸ºuncommon_trapçš„åŸå› ã€‚actionè¡¨ç¤ºçš„å‡ºå‘uncommon_trapçš„äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº›åœ°æ–¹è¿˜ä¼šæœ‰callï¼š&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;&amp;lt;call method='1150' count='5154' prof_factor='1.000000' inline='1'/&amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;callçš„æ„æ€æ˜¯ï¼Œåœ¨è¯¥ä»£ç ä¸­å°†ä¼šè°ƒç”¨å…¶ä»–çš„æ–¹æ³•ã€‚countæ˜¯æ‰§è¡Œæ¬¡æ•°ã€‚&lt;/p&gt;

&lt;p&gt;å¤æ‚çš„ç¼–è¯‘æ—¥å¿—ç»ˆäºè®²å®Œäº†ï¼Œå¯èƒ½è®²çš„å¹¶ä¸æ˜¯å¾ˆå…¨ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–æƒ…å†µè¿™é‡Œå¹¶æ²¡æœ‰åˆ—å‡ºæ¥ï¼Œåé¢å¦‚æœé‡åˆ°äº†ï¼Œæˆ‘å†æ·»åŠ è¿›å»ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡çš„ä¾‹å­&lt;a href=&quot;https://github.com/ddean2009/learn-java-base-9-to-20&quot;&gt;https://github.com/ddean2009/learn-java-base-9-to-20&lt;/a&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;8.4950495049505&quot;&gt;
&lt;p&gt;æœ¬æ–‡ä½œè€…ï¼šflydeanç¨‹åºé‚£äº›äº‹&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é“¾æ¥ï¼š&lt;a href=&quot;http://www.flydean.com/jvm-jit-logcompilation/&quot;&gt;http://www.flydean.com/jvm-jit-logcompilation/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ¥æºï¼šflydeançš„åšå®¢&lt;/p&gt;
&lt;p&gt;æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·:ç¨‹åºé‚£äº›äº‹ï¼Œæ›´å¤šç²¾å½©ç­‰ç€æ‚¨ï¼&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Thu, 18 Jun 2020 23:07:00 +0000</pubDate>
<dc:creator>flydean</dc:creator>
<og:description>ç®€ä»‹ æˆ‘ä»¬çŸ¥é“åœ¨JVMä¸­ä¸ºäº†åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œå¼•å…¥äº†JITå³æ—¶ç¼–è¯‘çš„åŠŸèƒ½ã€‚é‚£ä¹ˆJITä»€ä¹ˆæ—¶å€™å¼€å§‹ç¼–è¯‘çš„ï¼Œåˆæ˜¯æ€ä¹ˆç¼–è¯‘çš„ï¼Œä½œä¸ºä¸€ä¸ªé«˜å‚²çš„ç¨‹åºå‘˜ï¼Œæœ‰æ²¡æœ‰åŠæ³•å»æ¢ç©¶JITç¼–è¯‘çš„ç§˜å¯†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œä»Šå¤©å’Œå°å¸ˆå¦¹ä¸€</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/flydean/p/jvm-jit-logcompilation.html</dc:identifier>
</item>
<item>
<title>ä¼˜ç§€æºç å¸¦ç»™æˆ‘ä»¬çš„ä¸€äº›å¯ç¤º  - è‚¥å®…å¿«ä¹ç </title>
<link>http://www.cnblogs.com/fatmanhappycode/p/12744761.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/fatmanhappycode/p/12744761.html</guid>
<description>&lt;p&gt;é¦–å…ˆæ˜¯ä¸ªäººçš„ä¸€äº›é˜…è¯»æºç çš„å°æŠ€å·§ï¼Œä¸ä¸€å®šé€‚ç”¨æ¯ä¸ªäººï¼Œå¯ä»¥ç›´æ¥è·³è¿‡ã€‚&lt;/p&gt;



&lt;h2&gt;åšå®¢+æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä¸ªäººè§‰å¾—å¤§å¤šæ•°æƒ…å†µä¸‹è·Ÿç€ä¸€ç¯‡ä¼˜ç§€çš„åšå®¢é…åˆç€çœ‹å°±è¶³å¤Ÿäº†ï¼Œä¹‹åå†è‡ªå·±å†™åšå®¢æ€»ç»“ä¸€éåŠ æ·±å°è±¡ï¼Œç”»ä¸€ä¸‹æµç¨‹å›¾åŸºæœ¬éƒ½èƒ½ç†é¡ºã€‚ï¼ˆå›¾ä¸ºå­¦AQSæ—¶æœ¬äººç”»çš„è·å–ç‹¬å é”æµç¨‹å›¾ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1576191/202006/1576191-20200619003827269-748130854.png&quot; width=&quot;300&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

&lt;h2&gt;ç±»å…³ç³»&lt;/h2&gt;
&lt;p&gt;é…åˆideaçœ‹ç±»ä¹‹é—´çš„å…³ç³»ï¼ˆctrl+alt+shift+uï¼‰çš„åŠŸèƒ½ä¹Ÿèƒ½æ›´å¥½çš„ç†è§£æ•´ä¸ªé¡¹ç›®çš„æ•´ä½“æ¶æ„ã€‚å› ä¸ºå¾ˆå¤šæºç å…¶å®å¹¶ä¸æ˜¯çœŸçš„å¤æ‚ï¼Œåªæ˜¯ä¸ºäº†æ‰©å±•æ€§ä¼˜é›…ç®€æ´ç­‰åŸå› å»ºç«‹äº†å¤§é‡çš„æ¥å£å’ŒæŠ½è±¡ç±»ä»¥åŠå„ç§è®¾è®¡æ¨¡å¼ï¼Œä½¿å¾—é¡¹ç›®çœ‹èµ·æ¥å¾ˆåºå¤§å¾ˆå¤æ‚ï¼Œå€ŸåŠ©è¿™ä¸ªåŠŸèƒ½æœ‰åˆ©äºä½ æ’é™¤æ‰ä¸€äº›ä½ æš‚æ—¶ä¸æƒ³å»å…³å¿ƒçš„è®¾è®¡é€»è¾‘ã€‚çŸ¥é“é‚£ä¸ªéƒ¨åˆ†æ‰æ˜¯æœ€æ ¸å¿ƒçš„é€»è¾‘ï¼Œä¸“æ³¨äºå»çœ‹æ ¸å¿ƒä»£ç ã€‚Â &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1576191/202006/1576191-20200619003644227-1757566925.png&quot; width=&quot;400&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

&lt;h2&gt;å¤šçœ‹æ³¨é‡Š&lt;/h2&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœä½ çœ‹çš„åšå®¢é‡Œé¢åˆšå¥½ç¼ºå°‘äº†ä¸€éƒ¨åˆ†ä½ æƒ³çœ‹çš„å†…å®¹ï¼Œè€Œä½ åˆæ‰¾ä¸åˆ°èµ„æ–™ï¼Œéœ€è¦è‡ªå·±å»çœ‹ï¼Œåˆæˆ–è€…ä½ æƒ³çœ‹çš„æºç ä¸€ç‚¹ç‚¹èµ„æ–™éƒ½æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹æƒ³å»çœ‹æºç ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™æ¯”è¾ƒæœ‰ä½œç”¨çš„å°±æ˜¯æ³¨é‡Šï¼Œæºç ä¸­çš„æ³¨é‡Šçœ‹ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œæ”¾åˆ°ç™¾åº¦ç¿»è¯‘é‡ŒåŸºæœ¬ä¹Ÿèƒ½ç†è§£å¤§æ¦‚çš„æ„æ€ã€‚ä»”ç»†çœ‹å®Œæ–¹æ³•æˆ–ç±»çš„æ³¨é‡Šä¹‹åä½ å°±ç†è§£äº†æ¥ä¸‹æ¥è¿™ä¸ªç±»å¤§è‡´æ˜¯åœ¨åšä»€ä¹ˆï¼Œä¹‹åè¯»å®ƒçš„æºç ä¼šé€šé¡ºå¾ˆå¤šï¼Œæœ‰ä¸€äº›æ–¹æ³•æˆ–ç±»ç”šè‡³åœ¨ä½ çœ‹å®Œæ³¨é‡Šä¹‹åå°±å·²ç»èƒ½çŸ¥é“ä½ æƒ³çœ‹çš„å†…å®¹äº†ï¼Œå·²ç»æ²¡æœ‰éœ€è¦ç»§ç»­å¾€ä¸‹è¯»äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ä»…ä»…æ˜¯ç±»æˆ–æ–¹æ³•çš„æ³¨é‡Šæ–‡æ¡£ï¼Œæ–¹æ³•ä¸­ä»£ç çš„æ³¨é‡Šä¹Ÿå¾ˆé‡è¦ï¼ŒåŸºæœ¬ä¸Šç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹çš„ä»£ç ï¼Œç”šè‡³æœ‰æ—¶å€™åŠ ä¸ªé”ï¼Œä½œè€…éƒ½ä¼šè®¤è®¤çœŸçœŸçš„å†™ä¸€è¡Œæ³¨é‡Šè§£é‡Šè‡ªå·±è¿™ä¹ˆåšçš„åŸå› ã€‚&lt;/p&gt;

&lt;h2&gt;é€‚å½“å›«å›µåæ£&lt;/h2&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç‚¹æ˜¯é€‚å½“å¿½ç•¥ä¸€äº›ä¸é‡è¦çš„ç»†èŠ‚ï¼Œè¿™ä¸ªä¸»è¦çœ‹ä½ æƒ³çœ‹ä»€ä¹ˆï¼Œä¸€èˆ¬æˆ‘ä»¬çœ‹ç¬¬ä¸€éå¤§å¤šæ•°åªæ˜¯æƒ³çŸ¥é“å¤§è‡´çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥é€‚å½“å¿½ç•¥å¹¶å‘é€»è¾‘å’Œä¸€äº›æ–¹æ³•é‡Œçš„å†…å®¹ï¼ˆçœ‹ä¸€çœ¼æ³¨é‡Šå…ˆçŸ¥é“è¿™ä¸ªæ–¹æ³•ä¼šåšä»€ä¹ˆçš„å°±å¤Ÿäº†ï¼‰ã€‚ç¬¬ä¸€éå¤§è‡´çŸ¥é“æµç¨‹ï¼Œç¬¬äºŒç¬¬ä¸‰éå†å»æ·±ç©¶ç»†èŠ‚å’Œå¹¶å‘é€»è¾‘ç­‰ã€‚&lt;/p&gt;

&lt;h2&gt;å–„ç”¨debug&lt;/h2&gt;
&lt;p&gt;å¤šç”¨debugï¼Œå¾ˆå¤šæ—¶å€™æºç èµ°çš„è·¯çº¿ä¼šå’Œä½ æƒ³è±¡ä¸­çš„æœ‰å¾ˆå¤§ä¸åŒï¼Œä½ ä»¥ä¸ºä¼šè¿›å…¥è¿™ä¸ªifï¼Œå…¶å®ä»–å·å·è¿›äº†elseã€‚&lt;/p&gt;


&lt;p&gt;ç»å¸¸çœ‹åˆ°åˆ©ç”¨çŸ­è·¯æœºåˆ¶çš„ä»£ç ï¼Œè¿™é‡Œä»¥Â &lt;span class=&quot;cnblogs_code&quot;&gt;AbstractQueuedSynchronizer&lt;/span&gt;Â çš„Â &lt;span class=&quot;cnblogs_code&quot;&gt;acquire&lt;/span&gt;Â æ–¹æ³•ä¸ºä¾‹å­ï¼Œåªæœ‰Â &lt;span class=&quot;cnblogs_code&quot;&gt;tryAcquire&lt;/span&gt;Â è·å–é”å¤±è´¥ï¼ŒÂ &lt;span class=&quot;cnblogs_code&quot;&gt;!tryAcquire&lt;/span&gt;Â è¿”å›Â &lt;span class=&quot;cnblogs_code&quot;&gt;&lt;span&gt;true&lt;/span&gt;&lt;/span&gt;Â æ—¶æ‰ä¼šæ‰§è¡Œåé¢è¿›å…¥é˜»å¡é˜Ÿåˆ—å¹¶æŒ‚èµ·çš„æ–¹æ³•ï¼Œå¦‚æœè·å–é”æˆåŠŸäº†ï¼Œæ ¹æ®çŸ­è·¯æœºåˆ¶è‡ªç„¶ä¸ä¼šæ‰§è¡Œå…¥é˜Ÿæ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; AbstractQueuedSynchronizer.acquire(int arg)&lt;/span&gt;
&lt;span&gt;if&lt;/span&gt; (!tryAcquire(arg) &amp;amp;&amp;amp;&lt;span&gt;
    acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) {
    selfInterrupt();
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p id=&quot;reentrantreadwritelock-&quot;&gt;ReentrantReadWriteLockçš„è¿™æ®µä»£ç é‡Œå°†AQSçš„stateä¸€åˆ†ä¸ºäºŒç»™å…±äº«é”å’Œç‹¬å é”ä½¿ç”¨ï¼Œä¸ªäººè§‰å¾—è¿™ç§è®¾è®¡éå¸¸å·§å¦™ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;35&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ReentrantReadWriteLock&lt;/span&gt;
&lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;class&lt;/span&gt; Sync &lt;span&gt;extends&lt;/span&gt;&lt;span&gt; AbstractQueuedSynchronizer {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä¸‹é¢è¿™å—è¯´çš„å°±æ˜¯å°† state ä¸€åˆ†ä¸ºäºŒï¼Œé«˜ 16 ä½ç”¨äºå…±äº«æ¨¡å¼ï¼Œä½16ä½ç”¨äºç‹¬å æ¨¡å¼&lt;/span&gt;
    &lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; SHARED_SHIFT   = 16&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; SHARED_UNIT    = (1 &amp;lt;&amp;lt;&lt;span&gt; SHARED_SHIFT);
    &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; MAX_COUNT      = (1 &amp;lt;&amp;lt; SHARED_SHIFT) - 1&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;static&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; EXCLUSIVE_MASK = (1 &amp;lt;&amp;lt; SHARED_SHIFT) - 1&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å– c çš„é«˜ 16 ä½å€¼ï¼Œä»£è¡¨è¯»é”çš„è·å–æ¬¡æ•°(åŒ…æ‹¬é‡å…¥)&lt;/span&gt;
    &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; sharedCount(&lt;span&gt;int&lt;/span&gt; c)    { &lt;span&gt;return&lt;/span&gt; c &amp;gt;&amp;gt;&amp;gt;&lt;span&gt; SHARED_SHIFT; }
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; å– c çš„ä½ 16 ä½å€¼ï¼Œä»£è¡¨å†™é”çš„é‡å…¥æ¬¡æ•°ï¼Œå› ä¸ºå†™é”æ˜¯ç‹¬å æ¨¡å¼&lt;/span&gt;
    &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; exclusiveCount(&lt;span&gt;int&lt;/span&gt; c) { &lt;span&gt;return&lt;/span&gt; c &amp;amp; EXCLUSIVE_MASK; }
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¿˜è®°åœ¨å“ªé‡Œçœ‹åˆ°çš„äº†ï¼Œç¿»äº†ä¸€ä¸‹æµè§ˆè®°å½•åº”è¯¥æ˜¯åœ¨Java AIOéƒ¨åˆ†çš„æºç é‡Œï¼Œè¿™ç§å†™æ³•æ„Ÿè§‰å¾ˆç®€æ´å°±è®°ä¸‹æ¥äº†ï¼Œä¸è¿‡å¯è¯»æ€§ä¼¼ä¹ä¸å¤ªé«˜ï¼Œç‰¹åˆ«æ˜¯ç¬¬ä¸€ç§ä¹ä¸€çœ‹è¿˜ä»¥ä¸ºæ˜¯lambdaè¡¨è¾¾å¼&lt;/p&gt;
&lt;p&gt;æ„æ€ç­‰åŒäºÂ &lt;span class=&quot;cnblogs_code&quot;&gt;&lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = 0; i &amp;lt; n; i++)&lt;/span&gt; Â ï¼Œä½†æ˜¯Â &lt;span class=&quot;cnblogs_code&quot;&gt;&lt;span&gt;while&lt;/span&gt;(n-- &amp;gt; 0)&lt;/span&gt;Â å’ŒÂ &lt;span class=&quot;cnblogs_code&quot;&gt;&lt;span&gt;while&lt;/span&gt; (--n &amp;gt;= 0)&lt;/span&gt;Â è¿™ç§å†™æ³•ä¼šç›´æ¥æ”¹å˜nçš„å€¼&lt;/p&gt;


&lt;p&gt;åœ¨å¾ˆå¤šjdkçš„æºç ä¸­æˆ‘ä»¬éƒ½å¯ä»¥çœ‹åˆ°Â &lt;span class=&quot;cnblogs_code&quot;&gt;xx = &lt;span&gt;null&lt;/span&gt; &lt;span&gt;//&lt;/span&gt; &lt;span&gt;help GC&lt;/span&gt;&lt;/span&gt;Â è¿™æ ·çš„ä»£ç ï¼Œç”¨æ¥ç½®ç©ºå¼•ç”¨ï¼Œå¸®åŠ©jvmå®Œæˆgcã€‚å…·ä½“å¯ä»¥äº†è§£å¯è¾¾æ€§ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ä»¥LinkListä¸ºä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;34&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; LinkList çš„æ–¹æ³•&lt;/span&gt;
&lt;span&gt;private&lt;/span&gt; E unlinkFirst(Node&amp;lt;E&amp;gt;&lt;span&gt; f) {
    &lt;/span&gt;&lt;span&gt;final&lt;/span&gt; E element =&lt;span&gt; f.item;
    &lt;/span&gt;&lt;span&gt;final&lt;/span&gt; Node&amp;lt;E&amp;gt; next =&lt;span&gt; f.next;
    f.item &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    f.next &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; help GC&lt;/span&gt;
    first =&lt;span&gt; next;
    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt; (next == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
        last &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;
        next.prev &lt;/span&gt;= &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
    size&lt;/span&gt;--&lt;span&gt;;
    modCount&lt;/span&gt;++&lt;span&gt;;
    &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt; element;
}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä¼šä½¿ç”¨ä½ç§»æ¥è¿›è¡Œè¿ç®—ï¼Œå¹³æ—¶å†™ç®—æ³•é¢˜ä¹Ÿä¸€æ ·å¾ˆå¤šäººéƒ½è¿™ä¹ˆä½¿ç”¨ï¼Œä¸‹é¢ä»¥Â &lt;span class=&quot;cnblogs_code&quot;&gt;ArrayList&lt;/span&gt;Â çš„Â &lt;span class=&quot;cnblogs_code&quot;&gt;grow&lt;/span&gt;Â æ–¹æ³•ä¸ºä¾‹å­ï¼Œè¿™é‡Œé€šè¿‡å³ç§»1ä½ä½¿Â &lt;span class=&quot;cnblogs_code&quot;&gt;oldCapacity&lt;/span&gt;Â å˜ä¸ºåŸæ¥çš„0.5å€ï¼Œä¹‹ååŠ ä¸Šå®ƒæœ¬èº«å¾—åˆ°Â Â &lt;span class=&quot;cnblogs_code&quot;&gt;newCapacity&lt;/span&gt;Â &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;33&quot;&gt;
&lt;pre&gt;
&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ArrayList.grow(int minCapacity)&lt;/span&gt;
&lt;span&gt;private&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; grow(&lt;span&gt;int&lt;/span&gt;&lt;span&gt; minCapacity) {
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; . . . . . .&lt;/span&gt;
    &lt;span&gt;int&lt;/span&gt; newCapacity = oldCapacity + (oldCapacity &amp;gt;&amp;gt; 1);&lt;span&gt;//&lt;/span&gt;&lt;span&gt;newCapacityå°±æ˜¯1.5å€çš„oldCapacity
    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; . . . . . . &lt;/span&gt;
}
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸Šæ˜¯æˆ‘ç›®å‰çš„æ°´å¹³æ‰€èƒ½æ€»ç»“å‡ºæ¥çš„ï¼Œåç»­å­¦åˆ°å…¶ä»–çš„ä¼šç»§ç»­æ›´æ–°ï¼Œå¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆè¡¥å……çš„è¯·å‘Šè¯‰æˆ‘&lt;/p&gt;

&lt;p&gt;æœ€åæƒ¯ä¾‹é™„ä¸€å›¾ï¼šï¼ˆ&lt;strong&gt;æ ¹æœ¬ä¸å­˜åœ¨æƒ³é›‡ä½£æˆ‘çš„åœ°æ–¹( Â´_ã‚`).jpg&lt;/strong&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/1576191/202006/1576191-20200619005102888-264991343.png&quot; width=&quot;600&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

</description>
<pubDate>Thu, 18 Jun 2020 17:00:00 +0000</pubDate>
<dc:creator>è‚¥å®…å¿«ä¹ç </dc:creator>
<og:description>é¦–å…ˆæ˜¯ä¸ªäººçš„ä¸€äº›é˜…è¯»æºç çš„å°æŠ€å·§ï¼Œä¸ä¸€å®šé€‚ç”¨æ¯ä¸ªäººï¼Œå¯ä»¥ç›´æ¥è·³è¿‡ã€‚ é˜…è¯»æºç çš„ä¸€äº›ä¸ªäººæŠ€å·§ åšå®¢+æ€»ç»“ ä¸ªäººè§‰å¾—å¤§å¤šæ•°æƒ…å†µä¸‹è·Ÿç€ä¸€ç¯‡ä¼˜ç§€çš„åšå®¢é…åˆç€çœ‹å°±è¶³å¤Ÿäº†ï¼Œä¹‹åå†è‡ªå·±å†™åšå®¢æ€»ç»“ä¸€éåŠ æ·±å°è±¡ï¼Œç”»ä¸€ä¸‹</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/fatmanhappycode/p/12744761.html</dc:identifier>
</item>
<item>
<title>ã€åŸåˆ›ã€‘å¼ºæ’¸åŸºäº .NET çš„ Redis Cluster é›†ç¾¤è®¿é—®ç»„ä»¶ - TANZAME</title>
<link>http://www.cnblogs.com/yiting/p/13149846.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/yiting/p/13149846.html</guid>
<description>&lt;p&gt;ã€€ã€€Hello å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯TANZAMEï¼Œæˆ‘ä»¬åˆè§é¢äº†ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠæ€ä¹ˆæ‰‹æ’¸ä¸€ä¸ªÂ Redis Cluster é›†ç¾¤å®¢æˆ·ç«¯ï¼Œçº¯æ‰‹å·¥æœ‰å¹²è´§ï¼Œæ‚¨ç»†å“ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€éšç€ä¸šåŠ¡å¢é•¿ï¼Œçº¿ä¸Šç¯å¢ƒçš„QPSæš´å¢ï¼Œè‡ªç„¶è€Œç„¶å°†å½“å‰çš„å•æœº RedisÂ åˆ‡æ¢åˆ°ç¾¤é›†æ¨¡å¼ã€‚ç‡ƒé¹…ï¼Œæˆ‘ä»¬æ‚²å‰§åœ°å‘ç°ï¼ŒServiceStack.Redisè¿™ä¸ªå®˜æ–¹æ¨èçš„ .NETÂ å®¢æˆ·ç«¯å¹¶æ²¡æœ‰æ”¯æŒé›†ç¾¤æ¨¡å¼ã€‚ä¸€é€šåº¦å¨˜ç¿»å¢™æ— æœåï¼Œå†³å®šè‡ªå·±å¼ºæ’¸ä¸€ä¸ªåŸºäºServiceStack.Redisçš„Redisé›†ç¾¤è®¿é—®ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šè¿è¡Œæ•ˆæœå›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/89702/202006/89702-20200618143326704-141840287.png&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;

&lt;p&gt;ã€€ã€€Redis-Clusteré›†ç¾¤ä½¿ç”¨ hash slotÂ ç®—æ³•å¯¹æ¯ä¸ªkeyè®¡ç®—CRC16å€¼ï¼Œç„¶åå¯¹16383å–æ¨¡ï¼Œå¯ä»¥è·å–keyå¯¹åº”çš„ hash slotã€‚Redis-Clusterä¸­æ¯ä¸ªmasteréƒ½ä¼šæŒæœ‰éƒ¨åˆ† slotï¼Œåœ¨è®¿é—®keyæ—¶æ ¹æ®è®¡ç®—å‡ºæ¥çš„hash slotå»æ‰¾åˆ°å…·ä½“çš„masterèŠ‚ç‚¹ï¼Œå†ç”±å½“å‰æ‰¾åˆ°çš„èŠ‚ç‚¹å»æ‰§è¡Œå…·ä½“çš„ RedisÂ å‘½ä»¤ï¼ˆå…·ä½“å¯æŸ¥é˜…&lt;a title=&quot;REDIS é›†ç¾¤è¯´æ˜æ–‡æ¡£&quot; href=&quot;https://redis.io/topics/cluster-tutorial&quot; target=&quot;_blank&quot;&gt;å®˜æ–¹è¯´æ˜æ–‡æ¡£&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç”±äº ServiceStack.Rediså·²ç»å®ç°äº†å•ä¸ªå®ä¾‹çš„Rediså‘½ä»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å³å°†è¦å®ç°çš„ Redis é›†ç¾¤å®¢æˆ·ç«¯å½“åšä¸€ä¸ªä»£ç†ï¼Œå®ƒåªè´Ÿè´£è®¡ç®— keyÂ è½åœ¨å“ªä¸€ä¸ªå…·ä½“èŠ‚ç‚¹ï¼ˆå¯»å€ï¼‰ç„¶åå°†Rediså‘½ä»¤è½¬å‘ç»™å¯¹åº”çš„èŠ‚ç‚¹æ‰§è¡Œå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ServiceStack.Redisçš„RedisClientæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒServiceStack.Redis ä½¿ç”¨ç¼“å­˜å®¢æˆ·ç«¯ç®¡ç†å™¨ï¼ˆPooledRedisClientManagerï¼‰æ¥æé«˜æ€§èƒ½å’Œå¹¶å‘èƒ½åŠ›ï¼Œæˆ‘ä»¬çš„Redis Clusteré›†ç¾¤å®¢æˆ·ç«¯ä¹Ÿåº”é›†æˆPooledRedisClientManageræ¥è·å– RedisClientÂ å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€åŒæ—¶ï¼ŒRedis-Clusteré›†ç¾¤æ”¯æŒåœ¨çº¿åŠ¨æ€æ‰©å®¹å’Œslotè¿ç§»ï¼Œæˆ‘ä»¬çš„Redisé›†ç¾¤å®¢æˆ·ç«¯ä¹Ÿåº”å…·å¤‡è‡ªåŠ¨æ™ºèƒ½å‘ç°æ–°èŠ‚ç‚¹å’Œè‡ªåŠ¨åˆ·æ–° slotÂ åˆ†å¸ƒçš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;span&gt;æ€»ç»“èµ·æ¥ï¼Œè¦å®ç°ä¸€ä¸ªRedis-Clusterå®¢æˆ·ç«¯ï¼Œéœ€è¦å®ç°ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¦‚ä¸‹é¢ç±»å›¾æ‰€ç¤ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†åˆ†æå…·ä½“çš„ä»£ç å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/89702/202006/89702-20200617232204203-2012898308.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;ã€€ã€€&lt;/span&gt;&lt;/p&gt;
&lt;p id=&quot;section_crc16&quot;&gt;&lt;span&gt;ã€€ã€€ä¸€ã€CRC16Â &lt;/span&gt;&lt;span&gt;ã€€&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€CRCå³å¾ªç¯å†—ä½™æ ¡éªŒç ï¼Œæ˜¯ä¿¡æ¯ç³»ç»Ÿä¸­ä¸€ç§å¸¸è§çš„æ£€é”™ç ã€‚CRCæ ¡éªŒç ä¸åŒçš„æœºæ„æœ‰ä¸åŒçš„æ ‡å‡†ï¼Œè¿™é‡ŒRediséµå¾ªçš„æ ‡å‡†æ˜¯CRC-16-CCITTæ ‡å‡†ï¼Œè¿™ä¹Ÿæ˜¯è¢«XMODEMåè®®ä½¿ç”¨çš„CRCæ ‡å‡†ï¼Œæ‰€ä»¥ä¹Ÿå¸¸ç”¨XMODEM CRCä»£æŒ‡ï¼Œæ˜¯æ¯”è¾ƒç»å…¸çš„â€œåŸºäºå­—èŠ‚æŸ¥è¡¨æ³•çš„CRCæ ¡éªŒç ç”Ÿæˆç®—æ³•â€ã€‚Â &lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;37&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;///&lt;/span&gt;&lt;span&gt; æ ¹æ® key è®¡ç®—å¯¹åº”çš„å“ˆå¸Œæ§½
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; GetSlot(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; key)
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     key =&lt;span&gt; CRC16.ExtractHashTag(key);
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; optimization with modulo operator with power of 2 equivalent to getCRC16(key) % 16384&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; GetCRC16(key) &amp;amp; (&lt;span&gt;16384&lt;/span&gt; - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; 
&lt;span&gt;11&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt; &lt;span&gt;///&lt;/span&gt;&lt;span&gt; è®¡ç®—ç»™å®šå­—èŠ‚ç»„çš„ crc16 æ£€éªŒç 
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;14&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; GetCRC16(&lt;span&gt;byte&lt;/span&gt;[] bytes, &lt;span&gt;int&lt;/span&gt; s, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; e)
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; crc = &lt;span&gt;0x0000&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; 
&lt;span&gt;18&lt;/span&gt;     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = s; i &amp;lt; e; i++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         crc = ((crc &amp;lt;&amp;lt; &lt;span&gt;8&lt;/span&gt;) ^ LOOKUP_TABLE[((crc &amp;gt;&amp;gt; &lt;span&gt;8&lt;/span&gt;) ^ (bytes[i] &amp;amp; &lt;span&gt;0xFF&lt;/span&gt;)) &amp;amp; &lt;span&gt;0xFF&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt; crc &amp;amp; &lt;span&gt;0xFFFF&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;

&lt;p id=&quot;section_read_nodes&quot;&gt;ã€€ã€€&lt;span&gt;äºŒã€è¯»å–é›†ç¾¤èŠ‚ç‚¹&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä»é›†ç¾¤ä¸­çš„ä»»æ„èŠ‚ç‚¹ä½¿ç”¨ CLUSTER NODESÂ å‘½ä»¤å¯ä»¥è¯»å–åˆ°é›†ç¾¤ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿æ¥çŠ¶æ€ï¼Œå®ƒä»¬çš„æ ‡å¿—ï¼Œå±æ€§å’Œåˆ†é…çš„æ§½ç­‰ç­‰ã€‚CLUSTER NODES ä»¥ä¸²è¡Œæ ¼å¼æä¾›æ‰€æœ‰è¿™äº›ä¿¡æ¯ï¼Œè¾“å‡ºç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_Highlighter&quot; readability=&quot;36&quot;&gt;
&lt;pre class=&quot;brush:csharp;gutter:true;&quot;&gt;
d99b65a25ef726c64c565901e345f98c496a1a47 127.0.0.1:7007 master - 0 1592288083308 8 connected
2d71879d6529d1edbfeed546443051986245c58e 127.0.0.1:7003 master - 0 1592288084311 11 connected 10923-16383
654cdc25a5fa11bd44b5b716cdf07d4ce176efcd 127.0.0.1:7005 slave 484e73948d8aacd8327bf90b89469b52bff464c5 0 1592288085313 10 connected
ed65d52dad7ef6854e0e261433b56a551e5e11cb 127.0.0.1:7004 slave 754d0ec7a7f5c7765f784a6a2c370ea38ea0c089 0 1592288081304 9 connected
754d0ec7a7f5c7765f784a6a2c370ea38ea0c089 127.0.0.1:7001 master - 0 1592288080300 9 connected 0-5460
484e73948d8aacd8327bf90b89469b52bff464c5 127.0.0.1:7002 master - 0 1592288082306 10 connected 5461-10922
2223bc6d099bd9838e5d2f1fbd9a758f64c554c4 127.0.0.1:7006 myself,slave 2d71879d6529d1edbfeed546443051986245c58e 0 0 6 connected
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ã€€ã€€æ¯ä¸ªå­—æ®µçš„å«ä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041789&quot; class=&quot;J-stage-100041789 doc-postil&quot; readability=&quot;31.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;8&quot;&gt;
&lt;p&gt;ã€€ã€€1. &lt;code&gt;id&lt;/code&gt;ï¼šèŠ‚ç‚¹ IDï¼Œä¸€ä¸ª40ä¸ªå­—ç¬¦çš„éšæœºå­—ç¬¦ä¸²ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹è¢«åˆ›å»ºæ—¶ä¸ä¼šå†å‘ç”Ÿå˜åŒ–ï¼ˆé™¤é&lt;code&gt;CLUSTER RESET HARD&lt;/code&gt;è¢«ä½¿ç”¨ï¼‰ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041790&quot; class=&quot;J-stage-100041790 doc-postil&quot; readability=&quot;31&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;7&quot;&gt;
&lt;p&gt;ã€€ã€€2. &lt;code&gt;ip:port&lt;/code&gt;ï¼šå®¢æˆ·ç«¯åº”è¯¥è”ç³»èŠ‚ç‚¹ä»¥è¿è¡ŒæŸ¥è¯¢çš„èŠ‚ç‚¹åœ°å€ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041791&quot; class=&quot;J-stage-100041791 doc-postil&quot; readability=&quot;31.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;8&quot;&gt;
&lt;p&gt;ã€€ã€€3. &lt;code&gt;flags&lt;/code&gt;ï¼šé€—å·åˆ—è¡¨åˆ†éš”çš„æ ‡å¿—ï¼š&lt;code&gt;myself&lt;/code&gt;ï¼Œ&lt;code&gt;master&lt;/code&gt;ï¼Œ&lt;code&gt;slave&lt;/code&gt;ï¼Œ&lt;code&gt;fail?&lt;/code&gt;ï¼Œ&lt;code&gt;fail&lt;/code&gt;ï¼Œ&lt;code&gt;handshake&lt;/code&gt;ï¼Œ&lt;code&gt;noaddr&lt;/code&gt;ï¼Œ&lt;code&gt;noflags&lt;/code&gt;ã€‚æ ‡å¿—åœ¨ä¸‹ä¸€èŠ‚è¯¦ç»†è§£é‡Šã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041792&quot; class=&quot;J-stage-100041792 doc-postil&quot; readability=&quot;31.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;8&quot;&gt;
&lt;p&gt;ã€€ã€€4. &lt;code&gt;master&lt;/code&gt;ï¼šå¦‚æœèŠ‚ç‚¹æ˜¯ä»å±èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸»èŠ‚ç‚¹å·²çŸ¥ï¼Œåˆ™èŠ‚ç‚¹IDä¸ºä¸»èŠ‚ç‚¹ï¼Œå¦åˆ™ä¸ºâ€œ - â€å­—ç¬¦ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041793&quot; class=&quot;J-stage-100041793 doc-postil&quot; readability=&quot;31.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;8&quot;&gt;
&lt;p&gt;ã€€ã€€5. &lt;code&gt;ping-sent&lt;/code&gt;ï¼šä»¥æ¯«ç§’ä¸ºå•ä½çš„å½“å‰æ¿€æ´»çš„pingå‘é€çš„unixæ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰æŒ‚èµ·çš„pingï¼Œåˆ™ä¸ºé›¶ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041794&quot; class=&quot;J-stage-100041794 doc-postil&quot; readability=&quot;31&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;7&quot;&gt;
&lt;p&gt;ã€€ã€€6. &lt;code&gt;pong-recv&lt;/code&gt;ï¼šæ¯«ç§’ unix æ—¶é—´æ”¶åˆ°æœ€åä¸€ä¸ªä¹’ä¹“çƒã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041795&quot; class=&quot;J-stage-100041795 doc-postil&quot; readability=&quot;32.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;10&quot;&gt;
&lt;p&gt;ã€€ã€€7. &lt;code&gt;config-epoch&lt;/code&gt;ï¼šå½“å‰èŠ‚ç‚¹ï¼ˆæˆ–å½“å‰ä¸»èŠ‚ç‚¹ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»èŠ‚ç‚¹ï¼‰çš„é…ç½®æ—¶æœŸï¼ˆæˆ–ç‰ˆæœ¬ï¼‰ã€‚æ¯æ¬¡å‘ç”Ÿæ•…éšœåˆ‡æ¢æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œå”¯ä¸€çš„ï¼Œå•è°ƒé€’å¢çš„é…ç½®æ—¶æœŸã€‚å¦‚æœå¤šä¸ªèŠ‚ç‚¹å£°ç§°æœåŠ¡äºç›¸åŒçš„å“ˆå¸Œæ§½ï¼Œåˆ™å…·æœ‰è¾ƒé«˜é…ç½®æ—¶æœŸçš„èŠ‚ç‚¹å°†è·èƒœã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041796&quot; class=&quot;J-stage-100041796 doc-postil&quot; readability=&quot;31.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;8&quot;&gt;
&lt;p&gt;ã€€ã€€8. &lt;code&gt;link-state&lt;/code&gt;ï¼šç”¨äºèŠ‚ç‚¹åˆ°èŠ‚ç‚¹é›†ç¾¤æ€»çº¿çš„é“¾è·¯çŠ¶æ€ã€‚æˆ‘ä»¬ä½¿ç”¨æ­¤é“¾æ¥ä¸èŠ‚ç‚¹è¿›è¡Œé€šä¿¡ã€‚å¯ä»¥æ˜¯&lt;code&gt;connected&lt;/code&gt;æˆ–&lt;code&gt;disconnected&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041797&quot; class=&quot;J-stage-100041797 doc-postil&quot; readability=&quot;32.5&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;10&quot;&gt;
&lt;p&gt;ã€€ã€€9. &lt;code&gt;slot&lt;/code&gt;ï¼šæ•£åˆ—æ§½å·æˆ–èŒƒå›´ã€‚ä»å‚æ•°9å¼€å§‹ï¼Œä½†æ€»å…±å¯èƒ½æœ‰16384ä¸ªæ¡ç›®ï¼ˆé™åˆ¶ä»æœªè¾¾åˆ°ï¼‰ã€‚è¿™æ˜¯æ­¤èŠ‚ç‚¹æä¾›çš„æ•£åˆ—æ§½åˆ—è¡¨ã€‚å¦‚æœæ¡ç›®ä»…ä»…æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œåˆ™è¢«è§£æä¸ºè¿™æ ·ã€‚å¦‚æœå®ƒæ˜¯ä¸€ä¸ªèŒƒå›´ï¼Œå®ƒæ˜¯åœ¨å½¢å¼&lt;code&gt;start-end&lt;/code&gt;ï¼Œå¹¶ä¸”æ„å‘³ç€èŠ‚ç‚¹è´Ÿè´£æ‰€æœ‰æ•£åˆ—æ—¶éš™ä»&lt;code&gt;start&lt;/code&gt;åˆ°&lt;code&gt;end&lt;/code&gt;åŒ…æ‹¬èµ·å§‹å’Œç»“æŸå€¼ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041798&quot; class=&quot;J-stage-100041798 doc-postil&quot; readability=&quot;31&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;7&quot;&gt;
&lt;p&gt;æ ‡å¿—çš„å«ä¹‰ï¼ˆå­—æ®µç¼–å·3ï¼‰ï¼š&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041799&quot; class=&quot;J-stage-100041799 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;myself&lt;/code&gt;ï¼šæ‚¨æ­£åœ¨è”ç³»çš„èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041800&quot; class=&quot;J-stage-100041800 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;master&lt;/code&gt;ï¼šèŠ‚ç‚¹æ˜¯ä¸»äººã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041801&quot; class=&quot;J-stage-100041801 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;slave&lt;/code&gt;ï¼šèŠ‚ç‚¹æ˜¯ä»å±çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041802&quot; class=&quot;J-stage-100041802 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;fail?&lt;/code&gt;ï¼šèŠ‚ç‚¹å¤„äº&lt;code&gt;PFAIL&lt;/code&gt;çŠ¶æ€ã€‚å¯¹äºæ­£åœ¨è”ç³»çš„èŠ‚ç‚¹æ— æ³•è®¿é—®ï¼Œä½†ä»ç„¶å¯ä»¥åœ¨é€»è¾‘ä¸Šè®¿é—®ï¼ˆä¸å¤„äº&lt;code&gt;FAIL&lt;/code&gt;çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041803&quot; class=&quot;J-stage-100041803 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;fail&lt;/code&gt;ï¼šèŠ‚ç‚¹å¤„äº&lt;code&gt;FAIL&lt;/code&gt;çŠ¶æ€ã€‚å¯¹äºå°†&lt;code&gt;PFAIL&lt;/code&gt;çŠ¶æ€æå‡ä¸º&lt;code&gt;FAIL&lt;/code&gt;çš„å¤šä¸ªèŠ‚ç‚¹è€Œè¨€ï¼Œè¿™æ˜¯æ— æ³•è®¿é—®çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041804&quot; class=&quot;J-stage-100041804 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;handshake&lt;/code&gt;ï¼šä¸å—ä¿¡ä»»çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æ¡æ‰‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041805&quot; class=&quot;J-stage-100041805 doc-postil&quot;&gt;
&lt;div class=&quot;rno-markdown&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;noaddr&lt;/code&gt;ï¼šæ­¤èŠ‚ç‚¹æ²¡æœ‰å·²çŸ¥çš„åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div id=&quot;stage-100041806&quot; class=&quot;J-stage-100041806 doc-postil&quot; readability=&quot;48.291579936883&quot;&gt;
&lt;div class=&quot;rno-markdown&quot; readability=&quot;52.274390653327&quot;&gt;
&lt;ul class=&quot;ul-level-0&quot;&gt;&lt;li&gt;&lt;code&gt;noflags&lt;/code&gt;ï¼šæ ¹æœ¬æ²¡æœ‰æ ‡å¿—ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('11e35619-0c07-448e-9940-f074fbdca451')&quot; readability=&quot;38&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_11e35619-0c07-448e-9940-f074fbdca451&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_11e35619-0c07-448e-9940-f074fbdca451&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_11e35619-0c07-448e-9940-f074fbdca451&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;71&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¯»å–é›†ç¾¤ä¸Šçš„èŠ‚ç‚¹ä¿¡æ¯&lt;/span&gt;
&lt;span&gt;  2&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IList&amp;lt;InternalClusterNode&amp;gt; ReadClusterNodes(IEnumerable&amp;lt;ClusterNode&amp;gt;&lt;span&gt; source)
&lt;/span&gt;&lt;span&gt;  3&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt;  4&lt;/span&gt;     RedisClient c = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  5&lt;/span&gt;     StringReader reader = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  6&lt;/span&gt;     IList&amp;lt;InternalClusterNode&amp;gt; result = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  7&lt;/span&gt; 
&lt;span&gt;  8&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; index = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  9&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; rowCount =&lt;span&gt; source.Count();
&lt;/span&gt;&lt;span&gt; 10&lt;/span&gt; 
&lt;span&gt; 11&lt;/span&gt;     &lt;span&gt;foreach&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; node &lt;span&gt;in&lt;/span&gt;&lt;span&gt; source)
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 13&lt;/span&gt;         &lt;span&gt;try&lt;/span&gt;
&lt;span&gt; 14&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 15&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä»å½“å‰èŠ‚ç‚¹è¯»å–REDISé›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯&lt;/span&gt;
&lt;span&gt; 16&lt;/span&gt;             index += &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 17&lt;/span&gt;             c = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RedisClient(node.Host, node.Port, node.Password);
&lt;/span&gt;&lt;span&gt; 18&lt;/span&gt;             RedisData data = c.RawCommand(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;CLUSTER&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;.ToUtf8Bytes(), &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;NODES&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;.ToUtf8Bytes());
&lt;/span&gt;&lt;span&gt; 19&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; info =&lt;span&gt; Encoding.UTF8.GetString(data.Data);
&lt;/span&gt;&lt;span&gt; 20&lt;/span&gt; 
&lt;span&gt; 21&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°†è¯»å›çš„å­—ç¬¦æ–‡æœ¬è½¬æˆå¼ºç±»å‹èŠ‚ç‚¹å®ä½“&lt;/span&gt;
&lt;span&gt; 22&lt;/span&gt;             reader = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; StringReader(info);
&lt;/span&gt;&lt;span&gt; 23&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; line =&lt;span&gt; reader.ReadLine();
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (line != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 25&lt;/span&gt; &lt;span&gt;            {
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (result == &lt;span&gt;null&lt;/span&gt;) result = &lt;span&gt;new&lt;/span&gt; List&amp;lt;InternalClusterNode&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt; 27&lt;/span&gt;                 InternalClusterNode n =&lt;span&gt; InternalClusterNode.Parse(line);
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt;                 n.Password =&lt;span&gt; node.Password;
&lt;/span&gt;&lt;span&gt; 29&lt;/span&gt; &lt;span&gt;                result.Add(n);
&lt;/span&gt;&lt;span&gt; 30&lt;/span&gt; 
&lt;span&gt; 31&lt;/span&gt;                 line =&lt;span&gt; reader.ReadLine();
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 33&lt;/span&gt; 
&lt;span&gt; 34&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åªè¦ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æ‹¿åˆ°é›†ç¾¤ä¿¡æ¯ï¼Œç›´æ¥é€€å‡º&lt;/span&gt;
&lt;span&gt; 35&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (result != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; result.Count &amp;gt; &lt;span&gt;0&lt;/span&gt;) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 37&lt;/span&gt;         &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
&lt;/span&gt;&lt;span&gt; 38&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 39&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å‡ºç°å¼‚å¸¸ï¼Œå¦‚æœè¿˜æ²¡åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ç»§ç»­ä½¿ç”¨ä¸‹ä¸€ä¸‹èŠ‚ç‚¹è¯»å–é›†ç¾¤ä¿¡æ¯
&lt;/span&gt;&lt;span&gt; 40&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¦åˆ™æŠ›å‡ºå¼‚å¸¸&lt;/span&gt;
&lt;span&gt; 41&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (index &amp;lt;&lt;span&gt; rowCount)
&lt;/span&gt;&lt;span&gt; 42&lt;/span&gt;                 Thread.Sleep(&lt;span&gt;100&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 43&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt;
&lt;span&gt; 44&lt;/span&gt;                 &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RedisClusterException(ex.Message, c != &lt;span&gt;null&lt;/span&gt; ? c.GetHostString() : &lt;span&gt;string&lt;/span&gt;&lt;span&gt;.Empty, ex);
&lt;/span&gt;&lt;span&gt; 45&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 46&lt;/span&gt;         &lt;span&gt;finally&lt;/span&gt;
&lt;span&gt; 47&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 48&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (reader != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) reader.Dispose();
&lt;/span&gt;&lt;span&gt; 49&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (c != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;) c.Dispose();
&lt;/span&gt;&lt;span&gt; 50&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 51&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 52&lt;/span&gt; 
&lt;span&gt; 53&lt;/span&gt; 
&lt;span&gt; 54&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (result == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 55&lt;/span&gt;         result = &lt;span&gt;new&lt;/span&gt; List&amp;lt;InternalClusterNode&amp;gt;(&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 56&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; result;
&lt;/span&gt;&lt;span&gt; 57&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 58&lt;/span&gt; 
&lt;span&gt; 59&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 60&lt;/span&gt; &lt;span&gt;///&lt;/span&gt;&lt;span&gt; ä» cluster nodes çš„æ¯ä¸€è¡Œå‘½ä»¤é‡Œè¯»å–å‡ºé›†ç¾¤èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯
&lt;/span&gt;&lt;span&gt; 61&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 62&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;line&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é›†ç¾¤å‘½ä»¤&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt; 63&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt; 64&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; InternalClusterNode Parse(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; line)
&lt;/span&gt;&lt;span&gt; 65&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 66&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(line))
&lt;/span&gt;&lt;span&gt; 67&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArgumentException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;line&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 68&lt;/span&gt; 
&lt;span&gt; 69&lt;/span&gt;     InternalClusterNode node = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; InternalClusterNode();
&lt;/span&gt;&lt;span&gt; 70&lt;/span&gt;     node._nodeDescription =&lt;span&gt; line;
&lt;/span&gt;&lt;span&gt; 71&lt;/span&gt;     &lt;span&gt;string&lt;/span&gt;[] segs = line.Split(&lt;span&gt;'&lt;/span&gt; &lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 72&lt;/span&gt; 
&lt;span&gt; 73&lt;/span&gt;     node.NodeId = segs[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;];
&lt;/span&gt;&lt;span&gt; 74&lt;/span&gt;     node.Host = segs[&lt;span&gt;1&lt;/span&gt;].Split(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;];
&lt;/span&gt;&lt;span&gt; 75&lt;/span&gt;     node.Port = &lt;span&gt;int&lt;/span&gt;.Parse(segs[&lt;span&gt;1&lt;/span&gt;].Split(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;)[&lt;span&gt;1&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 76&lt;/span&gt;     node.MasterNodeId = segs[&lt;span&gt;3&lt;/span&gt;] == &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; ? &lt;span&gt;null&lt;/span&gt; : segs[&lt;span&gt;3&lt;/span&gt;&lt;span&gt;];
&lt;/span&gt;&lt;span&gt; 77&lt;/span&gt;     node.PingSent = &lt;span&gt;long&lt;/span&gt;.Parse(segs[&lt;span&gt;4&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt;     node.PongRecv = &lt;span&gt;long&lt;/span&gt;.Parse(segs[&lt;span&gt;5&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 79&lt;/span&gt;     node.ConfigEpoch = &lt;span&gt;int&lt;/span&gt;.Parse(segs[&lt;span&gt;6&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 80&lt;/span&gt;     node.LinkState = segs[&lt;span&gt;7&lt;/span&gt;&lt;span&gt;];
&lt;/span&gt;&lt;span&gt; 81&lt;/span&gt; 
&lt;span&gt; 82&lt;/span&gt;     &lt;span&gt;string&lt;/span&gt;[] flags = segs[&lt;span&gt;2&lt;/span&gt;].Split(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 83&lt;/span&gt;     node.IsMater = flags[&lt;span&gt;0&lt;/span&gt;] == MYSELF ? flags[&lt;span&gt;1&lt;/span&gt;] == MASTER : flags[&lt;span&gt;0&lt;/span&gt;] ==&lt;span&gt; MASTER;
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt;     node.IsSlave = !&lt;span&gt;node.IsMater;
&lt;/span&gt;&lt;span&gt; 85&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; start = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 86&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (flags[start] ==&lt;span&gt; MYSELF)
&lt;/span&gt;&lt;span&gt; 87&lt;/span&gt;         start = &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (flags[start] == SLAVE || flags[start] ==&lt;span&gt; MASTER)
&lt;/span&gt;&lt;span&gt; 89&lt;/span&gt;         start += &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 90&lt;/span&gt;     node.NodeFlag = &lt;span&gt;string&lt;/span&gt;.Join(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, flags.Skip(start));
&lt;/span&gt;&lt;span&gt; 91&lt;/span&gt; 
&lt;span&gt; 92&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (segs.Length &amp;gt; &lt;span&gt;8&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 93&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt;         &lt;span&gt;string&lt;/span&gt;[] slots = segs[&lt;span&gt;8&lt;/span&gt;].Split(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 95&lt;/span&gt;         node.Slot.Start = &lt;span&gt;int&lt;/span&gt;.Parse(slots[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 96&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (slots.Length &amp;gt; &lt;span&gt;1&lt;/span&gt;) node.Slot.End = &lt;span&gt;int&lt;/span&gt;.Parse(slots[&lt;span&gt;1&lt;/span&gt;&lt;span&gt;]);
&lt;/span&gt;&lt;span&gt; 97&lt;/span&gt; 
&lt;span&gt; 98&lt;/span&gt;         &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; index = &lt;span&gt;9&lt;/span&gt;; index &amp;lt; segs.Length; index++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 99&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;100&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (node.RestSlots == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;101&lt;/span&gt;                 node.RestSlots = &lt;span&gt;new&lt;/span&gt; List&amp;lt;HashSlot&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt; 
&lt;span&gt;103&lt;/span&gt;             slots = segs[index].Split(&lt;span&gt;'&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;'&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;104&lt;/span&gt; 
&lt;span&gt;105&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; s1 = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;106&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; s2 = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;107&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt; b1 = &lt;span&gt;int&lt;/span&gt;.TryParse(slots[&lt;span&gt;0&lt;/span&gt;], &lt;span&gt;out&lt;/span&gt;&lt;span&gt; s1);
&lt;/span&gt;&lt;span&gt;108&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt; b2 = &lt;span&gt;int&lt;/span&gt;.TryParse(slots[&lt;span&gt;1&lt;/span&gt;], &lt;span&gt;out&lt;/span&gt;&lt;span&gt; s2);
&lt;/span&gt;&lt;span&gt;109&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (!b1 || !&lt;span&gt;b2)
&lt;/span&gt;&lt;span&gt;110&lt;/span&gt;                 &lt;span&gt;continue&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;111&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt;
&lt;span&gt;112&lt;/span&gt;                 node.RestSlots.Add(&lt;span&gt;new&lt;/span&gt; HashSlot(s1, slots.Length &amp;gt; &lt;span&gt;1&lt;/span&gt; ? &lt;span&gt;new&lt;/span&gt; Nullable&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;(s2) : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;));
&lt;/span&gt;&lt;span&gt;113&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;114&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;115&lt;/span&gt; 
&lt;span&gt;116&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; node;
&lt;/span&gt;&lt;span&gt;117&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p id=&quot;section_alloc_manager&quot;&gt;ã€€ã€€&lt;span&gt;ä¸‰ã€ä¸ºèŠ‚ç‚¹åˆ†é…ç¼“å­˜å®¢æˆ·ç«¯ç®¡ç†å™¨&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€åœ¨å•å®ä¾‹çš„Redisä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ PooledRedisClientManagerÂ è¿™ä¸ªç®¡ç†å™¨æ¥è·å–RedisClientã€‚å€Ÿé‰´è¿™ä¸ªæ€è·¯ï¼Œåœ¨Redis Clusteré›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€ä¸ªä¸»èŠ‚ç‚¹å®ä¾‹åŒ–ä¸€ä¸ªÂ PooledRedisClientManagerï¼Œå¹¶ä¸”è¯¥ä¸»èŠ‚ç‚¹æŒæœ‰çš„ slotÂ éƒ½å…±äº«ä¸€ä¸ªÂ PooledRedisClientManagerÂ å®ä¾‹ã€‚ä»¥ slotÂ åšä¸º keyÂ å°† slotÂ ä¸Â PooledRedisClientManagerÂ ä¸€ä¸€æ˜ å°„å¹¶ç¼“å­˜èµ·æ¥ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('94e0618d-f686-48f4-927d-2ac82ede7605')&quot; readability=&quot;38&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_94e0618d-f686-48f4-927d-2ac82ede7605&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_94e0618d-f686-48f4-927d-2ac82ede7605&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_94e0618d-f686-48f4-927d-2ac82ede7605&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;71&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; åˆå§‹åŒ–é›†ç¾¤ç®¡ç†&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Initialize(IList&amp;lt;InternalClusterNode&amp;gt; clusterNodes = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä» redis è¯»å–é›†ç¾¤ä¿¡æ¯&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt;     IList&amp;lt;InternalClusterNode&amp;gt; nodes = clusterNodes == &lt;span&gt;null&lt;/span&gt; ?&lt;span&gt; RedisCluster.ReadClusterNodes(_source) : clusterNodes;
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; 
&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç”Ÿæˆä¸»èŠ‚ç‚¹ï¼Œæ¯ä¸ªä¸»èŠ‚ç‚¹çš„ slot å¯¹åº”ä¸€ä¸ªREDISå®¢æˆ·ç«¯ç¼“å†²æ± ç®¡ç†å™¨&lt;/span&gt;
&lt;span&gt; 8&lt;/span&gt;     IList&amp;lt;InternalClusterNode&amp;gt; masters = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;     IDictionary&amp;lt;&lt;span&gt;int&lt;/span&gt;, PooledRedisClientManager&amp;gt; managers = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;foreach&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; n &lt;span&gt;in&lt;/span&gt;&lt;span&gt; nodes)
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; èŠ‚ç‚¹æ— æ•ˆæˆ–è€…&lt;/span&gt;
&lt;span&gt;13&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!(n.IsMater &amp;amp;&amp;amp;
&lt;span&gt;14&lt;/span&gt;             !&lt;span&gt;string&lt;/span&gt;.IsNullOrEmpty(n.Host) &amp;amp;&amp;amp;
&lt;span&gt;15&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt;.IsNullOrEmpty(n.NodeFlag) &amp;amp;&amp;amp;
&lt;span&gt;16&lt;/span&gt;             (&lt;span&gt;string&lt;/span&gt;.IsNullOrEmpty(n.LinkState) || n.LinkState == InternalClusterNode.CONNECTED))) &lt;span&gt;continue&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; 
&lt;span&gt;18&lt;/span&gt;         n.SlaveNodes = nodes.Where(x =&amp;gt; x.MasterNodeId ==&lt;span&gt; n.NodeId);
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (masters == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;             masters = &lt;span&gt;new&lt;/span&gt; List&amp;lt;InternalClusterNode&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;        masters.Add(n);
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; 
&lt;span&gt;23&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç”¨æ¯ä¸€ä¸ªä¸»èŠ‚ç‚¹çš„å“ˆå¸Œæ§½åšé”®ï¼Œå¯¼å…¥REDISå®¢æˆ·ç«¯ç¼“å†²æ± ç®¡ç†å™¨
&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ç„¶åï¼Œæ–¹æ³•è¡¨æŒ‡é’ˆï¼ˆåˆåç±»å‹å¯¹è±¡æŒ‡é’ˆï¼‰ä¸Šåœºï¼Œå æ® 4 ä¸ªå­—èŠ‚ã€‚ 4 * 16384 / 1024 = 64KB&lt;/span&gt;
&lt;span&gt;25&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (managers == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;             managers = &lt;span&gt;new&lt;/span&gt; Dictionary&amp;lt;&lt;span&gt;int&lt;/span&gt;, PooledRedisClientManager&amp;gt;&lt;span&gt;();
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; 
&lt;span&gt;28&lt;/span&gt;         &lt;span&gt;string&lt;/span&gt;[] writeHosts = &lt;span&gt;new&lt;/span&gt;&lt;span&gt;[] { n.HostString };
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;         &lt;span&gt;string&lt;/span&gt;[] readHosts = n.SlaveNodes.Where(n =&amp;gt; &lt;span&gt;false&lt;/span&gt;).Select(n =&amp;gt;&lt;span&gt; n.HostString).ToArray();
&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;         &lt;span&gt;var&lt;/span&gt; pool = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; PooledRedisClientManager(writeHosts, readHosts, _config);
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;        managers.Add(n.Slot.Start, pool);
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (n.Slot.End != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¿™ä¸ªèŒƒå›´å†…çš„å“ˆå¸Œæ§½éƒ½ç”¨åŒä¸€ä¸ªç¼“å†²æ± &lt;/span&gt;
&lt;span&gt;35&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; s = n.Slot.Start + &lt;span&gt;1&lt;/span&gt;; s &amp;lt;= n.Slot.End.Value; s++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; &lt;span&gt;                managers.Add(s, pool);
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (n.RestSlots != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;             &lt;span&gt;foreach&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; slot &lt;span&gt;in&lt;/span&gt;&lt;span&gt; n.RestSlots)
&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; &lt;span&gt;            {
&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;                managers.Add(slot.Start, pool);
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (slot.End != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;44&lt;/span&gt; &lt;span&gt;                {
&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;                     &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è¿™ä¸ªèŒƒå›´å†…çš„å“ˆå¸Œæ§½éƒ½ç”¨åŒä¸€ä¸ªç¼“å†²æ± &lt;/span&gt;
&lt;span&gt;46&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; s = slot.Start + &lt;span&gt;1&lt;/span&gt;; s &amp;lt;= slot.End.Value; s++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;47&lt;/span&gt; &lt;span&gt;                        managers.Add(s, pool);
&lt;/span&gt;&lt;span&gt;48&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;49&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;50&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;52&lt;/span&gt; 
&lt;span&gt;53&lt;/span&gt;     _masters =&lt;span&gt; masters;
&lt;/span&gt;&lt;span&gt;54&lt;/span&gt;     _redisClientManagers =&lt;span&gt; managers;
&lt;/span&gt;&lt;span&gt;55&lt;/span&gt;     _clusterNodes = nodes != &lt;span&gt;null&lt;/span&gt; ? nodes : &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;56&lt;/span&gt; 
&lt;span&gt;57&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (_masters == &lt;span&gt;null&lt;/span&gt;) _masters = &lt;span&gt;new&lt;/span&gt; List&amp;lt;InternalClusterNode&amp;gt;(&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;58&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (_clusterNodes == &lt;span&gt;null&lt;/span&gt;) _clusterNodes = &lt;span&gt;new&lt;/span&gt; List&amp;lt;InternalClusterNode&amp;gt;(&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;59&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (_redisClientManagers == &lt;span&gt;null&lt;/span&gt;) _redisClientManagers = &lt;span&gt;new&lt;/span&gt; Dictionary&amp;lt;&lt;span&gt;int&lt;/span&gt;, PooledRedisClientManager&amp;gt;(&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;60&lt;/span&gt; 
&lt;span&gt;61&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (_masters.Count &amp;gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt;         _source = _masters.Select(n =&amp;gt; &lt;span&gt;new&lt;/span&gt;&lt;span&gt; ClusterNode(n.Host, n.Port, n.Password)).ToList();
&lt;/span&gt;&lt;span&gt;63&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;ã€€ã€€&lt;span&gt;å››ã€å°† hash slotÂ è·¯ç”±åˆ°æ­£ç¡®çš„èŠ‚ç‚¹&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€åœ¨è®¿é—®ä¸€ä¸ª keyÂ æ—¶ï¼Œæ ¹æ®ç¬¬ä¸‰æ­¥ç¼“å­˜èµ·æ¥çš„Â PooledRedisClientManager ï¼Œç”¨ keyÂ è®¡ç®—å‡ºæ¥çš„ hash slotÂ å€¼å¯ä»¥å¿«é€Ÿæ‰¾å‡ºè¿™ä¸ª keyÂ å¯¹åº”çš„Â PooledRedisClientManagerÂ å®ä¾‹ï¼Œè°ƒç”¨Â PooledRedisClientManager.GetClient()Â å³å¯å°† hash slotÂ è·¯ç”±åˆ°æ­£ç¡®çš„ä¸»èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; readability=&quot;44&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒæŒ‡å®šåŠ¨ä½œå¹¶è¿”å›å€¼&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; T DoExecute&amp;lt;T&amp;gt;(&lt;span&gt;string&lt;/span&gt; key, Func&amp;lt;RedisClient, T&amp;gt; action) =&amp;gt; &lt;span&gt;this&lt;/span&gt;.DoExecute(() =&amp;gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.GetRedisClient(key), action);
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; 
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒæŒ‡å®šåŠ¨ä½œå¹¶è¿”å›å€¼&lt;/span&gt;
&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; T DoExecute&amp;lt;T&amp;gt;(Func&amp;lt;RedisClient&amp;gt; slot, Func&amp;lt;RedisClient, T&amp;gt; action, &lt;span&gt;int&lt;/span&gt; tryTimes = &lt;span&gt;1&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     RedisClient c = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;
&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;         c =&lt;span&gt; slot();
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; action(c);
&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;     &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ­¤å¤„çœç•¥ ...&lt;/span&gt;
&lt;span&gt;16&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;     &lt;span&gt;finally&lt;/span&gt;
&lt;span&gt;18&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (c != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;            c.Dispose();
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; 
&lt;span&gt;24&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è·å–æŒ‡å®škeyå¯¹åº”çš„ä¸»è®¾å¤‡èŠ‚ç‚¹&lt;/span&gt;
&lt;span&gt;25&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; RedisClient GetRedisClient(&lt;span&gt;string&lt;/span&gt;&lt;span&gt; key)
&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (&lt;span&gt;string&lt;/span&gt;&lt;span&gt;.IsNullOrEmpty(key))
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArgumentNullException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;key&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; 
&lt;span&gt;30&lt;/span&gt;     &lt;span&gt;int&lt;/span&gt; slot =&lt;span&gt; CRC16.GetSlot(key);
&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;     &lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;_redisClientManagers.ContainsKey(slot))
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;         &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; SlotNotFoundException(&lt;span&gt;string&lt;/span&gt;.Format(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;No reachable node in cluster for slot {{{0}}}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;, slot), slot, key);
&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; 
&lt;span&gt;34&lt;/span&gt;     &lt;span&gt;var&lt;/span&gt; pool =&lt;span&gt; _redisClientManagers[slot];
&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; (RedisClient)pool.GetClient();
&lt;/span&gt;&lt;span&gt;36&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;

&lt;p id=&quot;section_auto_discovery&quot;&gt;ã€€ã€€&lt;span&gt;äº”ã€è‡ªåŠ¨å‘ç°æ–°èŠ‚ç‚¹å’Œè‡ªåŠ¨åˆ·æ–°slotåˆ†å¸ƒ&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒRedisÂ é›†ç¾¤ç»å¸¸ä¼šæœ‰æ·»åŠ /åˆ é™¤èŠ‚ç‚¹ã€è¿ç§» slot ã€ä¸»èŠ‚ç‚¹å®•æœºä»èŠ‚ç‚¹è½¬ä¸»èŠ‚ç‚¹ç­‰ï¼Œé’ˆå¯¹è¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬çš„ Redis ClusterÂ ç»„ä»¶å¿…é¡»å…·å¤‡è‡ªåŠ¨å‘ç°èŠ‚ç‚¹å’Œåˆ·æ–°åœ¨Â &lt;a href=&quot;https://www.cnblogs.com/yiting/p/13149846.html#section_alloc_manager&quot;&gt;ç¬¬ä¸‰æ­¥Â &lt;/a&gt;Â ç¼“å­˜èµ·æ¥çš„ slotÂ çš„èƒ½åŠ›ã€‚åœ¨è¿™é‡Œæˆ‘çš„å®ç°æ€è·¯æ˜¯å½“èŠ‚ç‚¹æ‰§è¡Œ RedisÂ å‘½ä»¤æ—¶è¿”å› RedisExceptionÂ å¼‚å¸¸æ—¶å°±å¼ºåˆ¶åˆ·æ–°é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯å¹¶é‡æ–°ç¼“å­˜ slotÂ ä¸Â èŠ‚ç‚¹ä¹‹é—´çš„æ˜ å°„ã€‚&lt;/p&gt;
&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('0d27fbae-0766-4b70-a53a-aa171131c8e5')&quot; readability=&quot;38.5&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_0d27fbae-0766-4b70-a53a-aa171131c8e5&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_0d27fbae-0766-4b70-a53a-aa171131c8e5&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_0d27fbae-0766-4b70-a53a-aa171131c8e5&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;72&quot;&gt;
&lt;pre&gt;
&lt;span&gt;  1&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ‰§è¡ŒæŒ‡å®šåŠ¨ä½œå¹¶è¿”å›å€¼&lt;/span&gt;
&lt;span&gt;  2&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; T DoExecute&amp;lt;T&amp;gt;(Func&amp;lt;RedisClient&amp;gt; slot, Func&amp;lt;RedisClient, T&amp;gt; action, &lt;span&gt;int&lt;/span&gt; tryTimes = &lt;span&gt;1&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;  3&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt;  4&lt;/span&gt;     RedisClient c = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;  5&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;
&lt;span&gt;  6&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;  7&lt;/span&gt;         c =&lt;span&gt; slot();
&lt;/span&gt;&lt;span&gt;  8&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; action(c);
&lt;/span&gt;&lt;span&gt;  9&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 10&lt;/span&gt;     &lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)
&lt;/span&gt;&lt;span&gt; 11&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 12&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (!(ex &lt;span&gt;is&lt;/span&gt; RedisException) || tryTimes == &lt;span&gt;0&lt;/span&gt;) &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RedisClusterException(ex.Message, c != &lt;span&gt;null&lt;/span&gt; ? c.GetHostString() : &lt;span&gt;string&lt;/span&gt;&lt;span&gt;.Empty, ex);
&lt;/span&gt;&lt;span&gt; 13&lt;/span&gt;         &lt;span&gt;else&lt;/span&gt;
&lt;span&gt; 14&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 15&lt;/span&gt;             tryTimes -= &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 16&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å°è¯•é‡æ–°åˆ·æ–°é›†ç¾¤ä¿¡æ¯&lt;/span&gt;
&lt;span&gt; 17&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt; isRefresh =&lt;span&gt; DiscoveryNodes(_source, _config);
&lt;/span&gt;&lt;span&gt; 18&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isRefresh)
&lt;/span&gt;&lt;span&gt; 19&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é›†ç¾¤èŠ‚ç‚¹æœ‰æ›´æ–°è¿‡ï¼Œé‡æ–°æ‰§è¡Œ&lt;/span&gt;
&lt;span&gt; 20&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.DoExecute(slot, action, tryTimes);
&lt;/span&gt;&lt;span&gt; 21&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt;
&lt;span&gt; 22&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é›†ç¾¤èŠ‚ç‚¹æœªæ›´æ–°è¿‡ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸&lt;/span&gt;
&lt;span&gt; 23&lt;/span&gt;                 &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RedisClusterException(ex.Message, c != &lt;span&gt;null&lt;/span&gt; ? c.GetHostString() : &lt;span&gt;string&lt;/span&gt;&lt;span&gt;.Empty, ex);
&lt;/span&gt;&lt;span&gt; 24&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 25&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 26&lt;/span&gt;     &lt;span&gt;finally&lt;/span&gt;
&lt;span&gt; 27&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 28&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (c != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 29&lt;/span&gt; &lt;span&gt;            c.Dispose();
&lt;/span&gt;&lt;span&gt; 30&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 31&lt;/span&gt; &lt;span&gt;}
&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt; 
&lt;span&gt; 33&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡æ–°åˆ·æ–°é›†ç¾¤ä¿¡æ¯&lt;/span&gt;
&lt;span&gt; 34&lt;/span&gt; &lt;span&gt;private&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; DiscoveryNodes(IEnumerable&amp;lt;ClusterNode&amp;gt;&lt;span&gt; source, RedisClientManagerConfig config)
&lt;/span&gt;&lt;span&gt; 35&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 36&lt;/span&gt;     &lt;span&gt;bool&lt;/span&gt; lockTaken = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 37&lt;/span&gt;     &lt;span&gt;try&lt;/span&gt;
&lt;span&gt; 38&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 39&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; noop&lt;/span&gt;
&lt;span&gt; 40&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (_isDiscoverying) { }
&lt;/span&gt;&lt;span&gt; 41&lt;/span&gt; 
&lt;span&gt; 42&lt;/span&gt;         Monitor.Enter(_objLock, &lt;span&gt;ref&lt;/span&gt;&lt;span&gt; lockTaken);
&lt;/span&gt;&lt;span&gt; 43&lt;/span&gt; 
&lt;span&gt; 44&lt;/span&gt;         _source =&lt;span&gt; source;
&lt;/span&gt;&lt;span&gt; 45&lt;/span&gt;         _config =&lt;span&gt; config;
&lt;/span&gt;&lt;span&gt; 46&lt;/span&gt;         _isDiscoverying = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 47&lt;/span&gt; 
&lt;span&gt; 48&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; è·Ÿä¸Šæ¬¡åŒæ­¥æ—¶é—´ç›¸éš” {MONITORINTERVAL} ç§’é’Ÿä»¥ä¸Šæ‰éœ€è¦åŒæ­¥&lt;/span&gt;
&lt;span&gt; 49&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; ((DateTime.Now - _lastDiscoveryTime).TotalMilliseconds &amp;gt;=&lt;span&gt; MONITORINTERVAL)
&lt;/span&gt;&lt;span&gt; 50&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 51&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt; isRefresh = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 52&lt;/span&gt;             IList&amp;lt;InternalClusterNode&amp;gt; newNodes =&lt;span&gt; RedisCluster.ReadClusterNodes(_source);
&lt;/span&gt;&lt;span&gt; 53&lt;/span&gt;             &lt;span&gt;foreach&lt;/span&gt; (&lt;span&gt;var&lt;/span&gt; node &lt;span&gt;in&lt;/span&gt;&lt;span&gt; newNodes)
&lt;/span&gt;&lt;span&gt; 54&lt;/span&gt; &lt;span&gt;            {
&lt;/span&gt;&lt;span&gt; 55&lt;/span&gt;                 &lt;span&gt;var&lt;/span&gt; n = _clusterNodes.FirstOrDefault(x =&amp;gt; x.HostString ==&lt;span&gt; node.HostString);
&lt;/span&gt;&lt;span&gt; 56&lt;/span&gt;                 isRefresh =
&lt;span&gt; 57&lt;/span&gt;                     n == &lt;span&gt;null&lt;/span&gt; ||                        &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æ–°èŠ‚ç‚¹                                                                &lt;/span&gt;
&lt;span&gt; 58&lt;/span&gt;                     n.Password != node.Password ||      &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å¯†ç å˜äº†                                                                &lt;/span&gt;
&lt;span&gt; 59&lt;/span&gt;                     n.IsMater != node.IsMater ||        &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä¸»å˜ä»æˆ–è€…ä»å˜ä¸»                                                                &lt;/span&gt;
&lt;span&gt; 60&lt;/span&gt;                     n.IsSlave != node.IsSlave ||        &lt;span&gt;//&lt;/span&gt;&lt;span&gt; ä¸»å˜ä»æˆ–è€…ä»å˜ä¸»                                                                &lt;/span&gt;
&lt;span&gt; 61&lt;/span&gt;                     n.NodeFlag != node.NodeFlag ||      &lt;span&gt;//&lt;/span&gt;&lt;span&gt; èŠ‚ç‚¹æ ‡è®°ä½å˜äº†                                                                &lt;/span&gt;
&lt;span&gt; 62&lt;/span&gt;                     n.LinkState != node.LinkState ||    &lt;span&gt;//&lt;/span&gt;&lt;span&gt; èŠ‚ç‚¹çŠ¶æ€ä½å˜äº†                                                                &lt;/span&gt;
&lt;span&gt; 63&lt;/span&gt;                     n.Slot.Start != node.Slot.Start ||  &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å“ˆå¸Œæ§½å˜äº†                                                                &lt;/span&gt;
&lt;span&gt; 64&lt;/span&gt;                     n.Slot.End != node.Slot.End ||      &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å“ˆå¸Œæ§½å˜äº†&lt;/span&gt;
&lt;span&gt; 65&lt;/span&gt;                     (n.RestSlots == &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; node.RestSlots != &lt;span&gt;null&lt;/span&gt;) ||
&lt;span&gt; 66&lt;/span&gt;                     (n.RestSlots != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; node.RestSlots == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt; 67&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (!isRefresh &amp;amp;&amp;amp; n.RestSlots != &lt;span&gt;null&lt;/span&gt; &amp;amp;&amp;amp; node.RestSlots != &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 68&lt;/span&gt; &lt;span&gt;                {
&lt;/span&gt;&lt;span&gt; 69&lt;/span&gt;                     &lt;span&gt;var&lt;/span&gt; slots1 = n.RestSlots.OrderBy(x =&amp;gt;&lt;span&gt; x.Start).ToList();
&lt;/span&gt;&lt;span&gt; 70&lt;/span&gt;                     &lt;span&gt;var&lt;/span&gt; slots2 = node.RestSlots.OrderBy(x =&amp;gt;&lt;span&gt; x.Start).ToList();
&lt;/span&gt;&lt;span&gt; 71&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; index = &lt;span&gt;0&lt;/span&gt;; index &amp;lt; slots1.Count; index++&lt;span&gt;)
&lt;/span&gt;&lt;span&gt; 72&lt;/span&gt; &lt;span&gt;                    {
&lt;/span&gt;&lt;span&gt; 73&lt;/span&gt;                         isRefresh =
&lt;span&gt; 74&lt;/span&gt;                             slots1[index].Start != slots2[index].Start ||   &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å“ˆå¸Œæ§½å˜äº†                                                                &lt;/span&gt;
&lt;span&gt; 75&lt;/span&gt;                             slots1[index].End != slots2[index].End;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; å“ˆå¸Œæ§½å˜äº†&lt;/span&gt;
&lt;span&gt; 76&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (isRefresh) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 77&lt;/span&gt; &lt;span&gt;                    }
&lt;/span&gt;&lt;span&gt; 78&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt; 79&lt;/span&gt; 
&lt;span&gt; 80&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (isRefresh) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 81&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 82&lt;/span&gt; 
&lt;span&gt; 83&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (isRefresh)
&lt;/span&gt;&lt;span&gt; 84&lt;/span&gt; &lt;span&gt;            {
&lt;/span&gt;&lt;span&gt; 85&lt;/span&gt;                 &lt;span&gt;//&lt;/span&gt;&lt;span&gt; é‡æ–°åˆå§‹åŒ–é›†ç¾¤&lt;/span&gt;
&lt;span&gt; 86&lt;/span&gt;                 &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.Dispose();
&lt;/span&gt;&lt;span&gt; 87&lt;/span&gt;                 &lt;span&gt;this&lt;/span&gt;&lt;span&gt;.Initialize(newNodes);
&lt;/span&gt;&lt;span&gt; 88&lt;/span&gt;                 &lt;span&gt;this&lt;/span&gt;._lastDiscoveryTime =&lt;span&gt; DateTime.Now;
&lt;/span&gt;&lt;span&gt; 89&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt; 90&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt; 91&lt;/span&gt; 
&lt;span&gt; 92&lt;/span&gt;         &lt;span&gt;//&lt;/span&gt;&lt;span&gt; æœ€ååˆ·æ–°æ—¶é—´åœ¨ {MONITORINTERVAL} å†…ï¼Œè¡¨ç¤ºæ˜¯æœ€æ–°ç¾¤é›†ä¿¡æ¯ newest&lt;/span&gt;
&lt;span&gt; 93&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; (DateTime.Now - _lastDiscoveryTime).TotalMilliseconds &amp;lt;&lt;span&gt; MONITORINTERVAL;
&lt;/span&gt;&lt;span&gt; 94&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt; 95&lt;/span&gt;     &lt;span&gt;finally&lt;/span&gt;
&lt;span&gt; 96&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt; 97&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt;&lt;span&gt; (lockTaken)
&lt;/span&gt;&lt;span&gt; 98&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt; 99&lt;/span&gt;             _isDiscoverying = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt;100&lt;/span&gt; &lt;span&gt;            Monitor.Exit(_objLock);
&lt;/span&gt;&lt;span&gt;101&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;102&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;103&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;ã€€ã€€&lt;span&gt;å…­ã€é…ç½®è®¿é—®ç»„ä»¶è°ƒç”¨å…¥å£&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€æœ€åæˆ‘ä»¬éœ€è¦ä¸ºç»„ä»¶æä¾›è®¿é—®å…¥å£ï¼Œæˆ‘ä»¬ç”¨ RedisClusterÂ ç±»å®ç°Â å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å“ˆå¸Œã€é›†åˆã€æœ‰åºé›†åˆå’ŒKeysçš„åŸºæœ¬æ“ä½œï¼Œå¹¶ä¸”ç”¨Â RedisClusterFactory å·¥å‚ç±»å¯¹å¤–æä¾›å•ä¾‹æ“ä½œï¼Œè¿™æ ·å°±å¯ä»¥åƒå•å®ä¾‹ RedisÂ é‚£æ ·è°ƒç”¨ Redis ClusterÂ é›†ç¾¤ã€‚è°ƒç”¨ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&quot;cnblogs_Highlighter&quot; readability=&quot;37&quot;&gt;
&lt;pre class=&quot;brush:csharp;gutter:true;&quot;&gt;
var node = new ClusterNode(&quot;127.0.0.1&quot;, 7001);
var redisCluster = RedisClusterFactory.Configure(node, config);
string key = &quot;B070x14668&quot;;
redisCluster.Set(key, key);
string value = redisCluster.Get&amp;lt;string&amp;gt;(key);
redisCluster.Del(key);
&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;cnblogs_code&quot; onclick=&quot;cnblogs_code_show('41b2e97f-44a9-4e6a-980e-ca2565de79da')&quot; readability=&quot;35&quot;&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif&quot; id=&quot;code_img_closed_41b2e97f-44a9-4e6a-980e-ca2565de79da&quot; class=&quot;code_img_closed&quot;/&gt;&lt;img src=&quot;https://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif&quot; id=&quot;code_img_opened_41b2e97f-44a9-4e6a-980e-ca2565de79da&quot; class=&quot;code_img_opened&quot;/&gt;&lt;div id=&quot;cnblogs_code_open_41b2e97f-44a9-4e6a-980e-ca2565de79da&quot; class=&quot;cnblogs_code_hide&quot; readability=&quot;65&quot;&gt;
&lt;pre&gt;
&lt;span&gt; 1&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;///&lt;/span&gt;&lt;span&gt; REDIS é›†ç¾¤å·¥å‚
&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;public&lt;/span&gt; &lt;span&gt;class&lt;/span&gt;&lt;span&gt; RedisClusterFactory
&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;{
&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;     &lt;span&gt;static&lt;/span&gt; RedisClusterFactory _factory = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RedisClusterFactory();
&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;     &lt;span&gt;static&lt;/span&gt; RedisCluster _cluster = &lt;span&gt;null&lt;/span&gt;&lt;span&gt;;
&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; 
&lt;span&gt; 9&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;10&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; Redis é›†ç¾¤
&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;12&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; RedisCluster Cluster
&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;         &lt;span&gt;get&lt;/span&gt;
&lt;span&gt;15&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (_cluster == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                 &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; Exception(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;You should call RedisClusterFactory.Configure to config cluster first.&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt;
&lt;span&gt;19&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt;&lt;span&gt; _cluster;
&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; 
&lt;span&gt;23&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;24&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; åˆå§‹åŒ– &lt;/span&gt;&lt;span&gt;&amp;lt;see cref=&quot;RedisClusterFactory&quot;/&amp;gt;&lt;/span&gt;&lt;span&gt; ç±»çš„æ–°å®ä¾‹
&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;26&lt;/span&gt;     &lt;span&gt;private&lt;/span&gt;&lt;span&gt; RedisClusterFactory()
&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; 
&lt;span&gt;30&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;31&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é…ç½® REDIS é›†ç¾¤
&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;&lt;span&gt;è‹¥ç¾¤é›†ä¸­æœ‰æŒ‡å®š password çš„èŠ‚ç‚¹ï¼Œå¿…é¡»ä½¿ç”¨  IEnumerable&amp;amp;lt;ClusterNode&amp;amp;gt; é‡è½½åˆ—ä¸¾å‡ºè¿™äº›èŠ‚ç‚¹&lt;/span&gt;&lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
&lt;span&gt;33&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;34&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;node&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é›†ç¾¤èŠ‚ç‚¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;35&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt;36&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; RedisCluster Configure(ClusterNode node)
&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; RedisClusterFactory.Configure(node, &lt;span&gt;null&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; 
&lt;span&gt;41&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;42&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é…ç½® REDIS é›†ç¾¤
&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;para&amp;gt;&lt;/span&gt;&lt;span&gt;è‹¥ç¾¤é›†ä¸­æœ‰æŒ‡å®š password çš„èŠ‚ç‚¹ï¼Œå¿…é¡»ä½¿ç”¨  IEnumerable&amp;amp;lt;ClusterNode&amp;amp;gt; é‡è½½åˆ—ä¸¾å‡ºè¿™äº›èŠ‚ç‚¹&lt;/span&gt;&lt;span&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
&lt;span&gt;44&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;45&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;node&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é›†ç¾¤èŠ‚ç‚¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;46&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;config&quot;&amp;gt;&amp;lt;see cref=&quot;RedisClientManagerConfig&quot;/&amp;gt;&lt;/span&gt;&lt;span&gt; å®¢æˆ·ç«¯ç¼“å†²æ± é…ç½®&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;47&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt;48&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt;&lt;span&gt; RedisCluster Configure(ClusterNode node, RedisClientManagerConfig config)
&lt;/span&gt;&lt;span&gt;49&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;50&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt; RedisClusterFactory.Configure(&lt;span&gt;new&lt;/span&gt; List&amp;lt;ClusterNode&amp;gt;&lt;span&gt; { node }, config);
&lt;/span&gt;&lt;span&gt;51&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;52&lt;/span&gt; 
&lt;span&gt;53&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;
&lt;span&gt;54&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt;&lt;span&gt; é…ç½® REDIS é›†ç¾¤
&lt;/span&gt;&lt;span&gt;55&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
&lt;span&gt;56&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;nodes&quot;&amp;gt;&lt;/span&gt;&lt;span&gt;é›†ç¾¤èŠ‚ç‚¹&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;57&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;param name=&quot;config&quot;&amp;gt;&amp;lt;see cref=&quot;RedisClientManagerConfig&quot;/&amp;gt;&lt;/span&gt;&lt;span&gt; å®¢æˆ·ç«¯ç¼“å†²æ± é…ç½®&lt;/span&gt;&lt;span&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;
&lt;span&gt;58&lt;/span&gt;     &lt;span&gt;///&lt;/span&gt; &lt;span&gt;&amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;
&lt;span&gt;59&lt;/span&gt;     &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; RedisCluster Configure(IEnumerable&amp;lt;ClusterNode&amp;gt;&lt;span&gt; nodes, RedisClientManagerConfig config)
&lt;/span&gt;&lt;span&gt;60&lt;/span&gt; &lt;span&gt;    {
&lt;/span&gt;&lt;span&gt;61&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (nodes == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;62&lt;/span&gt;             &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArgumentNullException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;nodes&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;63&lt;/span&gt; 
&lt;span&gt;64&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (nodes == &lt;span&gt;null&lt;/span&gt; || nodes.Count() == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;65&lt;/span&gt;             &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; ArgumentException(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;There is no nodes to configure cluster.&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;);
&lt;/span&gt;&lt;span&gt;66&lt;/span&gt; 
&lt;span&gt;67&lt;/span&gt;         &lt;span&gt;if&lt;/span&gt; (_cluster == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;68&lt;/span&gt; &lt;span&gt;        {
&lt;/span&gt;&lt;span&gt;69&lt;/span&gt;             &lt;span&gt;lock&lt;/span&gt;&lt;span&gt; (_factory)
&lt;/span&gt;&lt;span&gt;70&lt;/span&gt; &lt;span&gt;            {
&lt;/span&gt;&lt;span&gt;71&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (_cluster == &lt;span&gt;null&lt;/span&gt;&lt;span&gt;)
&lt;/span&gt;&lt;span&gt;72&lt;/span&gt; &lt;span&gt;                {
&lt;/span&gt;&lt;span&gt;73&lt;/span&gt;                     RedisCluster c = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; RedisCluster(nodes, config);
&lt;/span&gt;&lt;span&gt;74&lt;/span&gt;                     _cluster =&lt;span&gt; c;
&lt;/span&gt;&lt;span&gt;75&lt;/span&gt; &lt;span&gt;                }
&lt;/span&gt;&lt;span&gt;76&lt;/span&gt; &lt;span&gt;            }
&lt;/span&gt;&lt;span&gt;77&lt;/span&gt; &lt;span&gt;        }
&lt;/span&gt;&lt;span&gt;78&lt;/span&gt; 
&lt;span&gt;79&lt;/span&gt;         &lt;span&gt;return&lt;/span&gt;&lt;span&gt; _cluster;
&lt;/span&gt;&lt;span&gt;80&lt;/span&gt; &lt;span&gt;    }
&lt;/span&gt;&lt;span&gt;81&lt;/span&gt; }
&lt;/pre&gt;&lt;/div&gt;
&lt;span class=&quot;cnblogs_code_collapse&quot;&gt;View Code&lt;/span&gt;&lt;/div&gt;

&lt;p&gt;ã€€ã€€&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä»Šå¤©æˆ‘ä»¬è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä»0æ‰‹å†™ä¸€ä¸ªRedis Clusteré›†ç¾¤å®¢æˆ·ç«¯è®¿é—®ç»„ä»¶ï¼Œç›¸ä¿¡å¯¹åŒæ ·åœ¨å¯»æ‰¾ç±»ä¼¼è§£å†³æ–¹æ¡ˆçš„åŒå­¦ä»¬ä¼šæœ‰ä¸€å®šçš„å¯å‘ï¼Œå–œæ¬¢çš„åŒå­¦è¯·ç‚¹ä¸ª starã€‚åœ¨æ²¡æœ‰ç›¸åŒæ¡ˆä¾‹å¯ä»¥å‚è€ƒçš„æƒ…å†µä¸‹ç¬”è€…é€šè¿‡æŸ¥é˜…å®˜æ–¹è¯´æ˜æ–‡æ¡£å’Œå€Ÿé‰´ JavaÂ çš„ JedisClusterÂ çš„å®ç°æ€è·¯ï¼Œè™½è¯´ç£•ç£•ç¢°ç¢°ä½†æœ€ç»ˆä¹Ÿåˆæ­¥å®Œæˆè¿™ä¸ªç»„ä»¶å¹¶æŠ•å…¥ä½¿ç”¨ï¼Œå¿…é¡»ç»™è‡ªå·±åŠ ä¸€ä¸ªé¸¡è…¿ï¼ï¼åœ¨æ­¤æˆ‘æœ‰ä¸€ä¸ªå°å°çš„ç–‘é—®ï¼Œ.NETÂ çš„åŒå­¦ä»¬åœ¨ç”¨ RedisÂ é›†ç¾¤æ—¶ï¼Œä½ ä»¬æ˜¯ç”¨ä»€ä¹ˆç»„ä»¶è€çš„ï¼Œä¸ºä½•ç½‘ä¸Šçš„ç›¸å…³ä»‹ç»å’Œç°æˆç»„ä»¶å‡ ä¹éƒ½æ²¡æœ‰ï¼Ÿæ¬¢è¿è®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€GitHubÂ ä»£ç æ‰˜ç®¡ï¼š&lt;a href=&quot;https://github.com/TANZAME/ServiceStack.Redis.Cluster&quot;&gt;https://github.com/TANZAME/ServiceStack.Redis.Cluster&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€æŠ€æœ¯äº¤æµ QQ ç¾¤ï¼š816425449&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
<pubDate>Thu, 18 Jun 2020 16:56:00 +0000</pubDate>
<dc:creator>TANZAME</dc:creator>
<og:description>Hello å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯TANZAMEï¼Œæˆ‘ä»¬åˆè§é¢äº†ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠæ€ä¹ˆæ‰‹æ’¸ä¸€ä¸ª&amp;#160;Redis Cluster é›†ç¾¤å®¢æˆ·ç«¯ï¼Œçº¯æ‰‹å·¥æœ‰å¹²è´§ï¼Œæ‚¨ç»†å“ã€‚ éšç€ä¸šåŠ¡å¢é•¿ï¼Œçº¿ä¸Šç¯å¢ƒçš„QPSæš´å¢ï¼Œè‡ªç„¶è€Œç„¶</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/yiting/p/13149846.html</dc:identifier>
</item>
<item>
<title>Nettyä¸­çš„è¿™äº›çŸ¥è¯†ç‚¹ï¼Œä½ éœ€è¦çŸ¥é“ï¼ - WindWant</title>
<link>http://www.cnblogs.com/niejunlei/p/13155554.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/niejunlei/p/13155554.html</guid>
<description>&lt;p&gt;Channelã€EventLoopã€Unsafeã€multiplexorã€AdaptiveRecvByteBufAllocatorã€ChannelPipeline...&lt;/p&gt;&lt;div id=&quot;cnblogs_post_body&quot; readability=&quot;146.10134023043&quot;&gt;
&lt;h2&gt;ä¸€ã€Channel&lt;/h2&gt;
&lt;p&gt;Channelæ˜¯ä¸€ä¸ª&lt;strong&gt;æ¥å£&lt;/strong&gt;ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ¥å£ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå¤§è€Œå…¨â€ï¼Œå›Šæ‹¬äº†serverç«¯åŠclientç«¯æ¥å£æ‰€éœ€è¦çš„æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;Channelæ˜¯ä¸€ä¸ª&lt;span&gt;&lt;strong&gt;é—¨é¢&lt;/strong&gt;&lt;/span&gt;ï¼Œå°è£…äº†åŒ…æ‹¬ç½‘ç»œI/OåŠç›¸å…³çš„æ‰€æœ‰æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;Channel&lt;span&gt;&lt;strong&gt;èšåˆ&lt;/strong&gt;&lt;/span&gt;äº†åŒ…æ‹¬ç½‘ç»œè¯»å†™ã€é“¾è·¯ç®¡ç†ã€ç½‘ç»œè¿æ¥ä¿¡æ¯ã€è·å–EventLoopã€Pipelineç­‰ç›¸å…³åŠŸèƒ½ç±»ï¼›ç»Ÿä¸€åˆ†é…ï¼Œè°ƒåº¦å®ç°ç›¸åº”åœºæ™¯çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618014545640-42163202.png&quot; alt=&quot;&quot; width=&quot;541&quot; height=&quot;246&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªChannel &lt;strong&gt;&lt;span&gt;å¯¹åº”ä¸€ä¸ªç‰©ç†è¿æ¥&lt;/span&gt;&lt;/strong&gt;ï¼Œæ˜¯åŸºäºç‰©ç†è¿æ¥ä¸Šçš„æ“ä½œåŒ…è£…ã€‚&lt;/p&gt;
&lt;h2&gt;äºŒã€EventLoop&lt;/h2&gt;
&lt;p&gt;EventLoopï¼ŒEventæ„ä¸ºäº‹ä»¶ã€Loopæ„ä¸ºç¯ï¼ŒEventLooå³ä¸º&lt;span&gt;&lt;strong&gt;äº‹ä»¶ç¯&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;EventLoopæ˜¯ä¸€ç§ç¨‹åº&lt;strong&gt;è®¾è®¡ç»“æ„&lt;/strong&gt;ï¼Œ&lt;span&gt;&lt;strong&gt;ç­‰å¾…ä»¥åŠåˆ†å‘&lt;/strong&gt;&lt;/span&gt;äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618020149069-1425194326.png&quot; alt=&quot;&quot; width=&quot;515&quot; height=&quot;218&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;NioEventLoopï¼Œæ˜¯ä¸€ä¸ªNettyå·¥ä½œçº¿ç¨‹ï¼Œåˆä¸ä»…ä»…æ˜¯ä¸€ä¸ªNettyå·¥ä½œçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/niejunlei/p/13070107.html&quot; target=&quot;_blank&quot;&gt;æ ‡å‡†çš„nettyçº¿ç¨‹æ¨¡å‹&lt;/a&gt;Â ä¸­æˆ‘ä»¬è®²è¿‡Nettyçš„æ ‡å‡†çº¿ç¨‹æ± æ¨¡å‹ï¼Œæ± å­é‡Œçš„æ¯ä¸ªçº¿ç¨‹å¯¹è±¡å°±æ˜¯ä¸€ä¸ªNioEventLoopå¯¹è±¡ã€‚æˆ–è´Ÿè´£&lt;strong&gt;&lt;span&gt;æ¥å—è¿æ¥&lt;/span&gt;&lt;/strong&gt;ï¼Œæˆ–&lt;strong&gt;&lt;span&gt;è´Ÿè´£ç½‘ç»œI/O&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯´å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªNettyçº¿ç¨‹ï¼Œå› ä¸ºå®ƒå®ç°äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹å®ƒçš„ç»§æ‰¿å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618204514189-414304278.png&quot; alt=&quot;&quot; width=&quot;548&quot; height=&quot;591&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å®ƒçš„ä¸Šæ–¹æœ‰ä¸¤ä¸ªæä¸«ï¼Œä¸€ä¸ª&lt;span&gt;&lt;strong&gt;çº¿ç¨‹å±æ€§&lt;/strong&gt;&lt;/span&gt;ï¼Œä¸€ä¸ª&lt;span&gt;&lt;strong&gt;EventLoop&lt;/strong&gt;&lt;/span&gt;ï¼Œå®ƒæ˜¯Nettyçš„&lt;span&gt;&lt;strong&gt;Reactorçº¿ç¨‹&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶æ˜¯Reactorçº¿ç¨‹ï¼Œé‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª&lt;strong&gt;&lt;span&gt;å¤šè·¯å¤ç”¨å™¨&lt;/span&gt;&lt;/strong&gt;ã€‚åœ¨Netty NioEventLoopä¸­ï¼ŒåŒ…å°±å«ä¸€ä¸ªÂ Selectorï¼Œå®ƒçš„æ“ä½œå¯¹è±¡æ˜¯Channelã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618220620517-1530612963.png&quot; alt=&quot;&quot; width=&quot;527&quot; height=&quot;278&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;NioEventLoopçš„ä¸»è¦é€»è¾‘åœ¨å®ƒçš„run()æ–¹æ³•ï¼Œæ–¹æ³•ä½“å†…æ˜¯ä¸€ä¸ª&lt;span&gt;&lt;strong&gt;æ— é™å¾ªç¯Â for (;;)&lt;/strong&gt;&lt;span&gt;ï¼Œå¾ªç¯ä½“å†…å®ç°LoopåŠŸèƒ½ã€‚è¿™ä¹Ÿæ˜¯é€šç”¨çš„NIOçº¿ç¨‹å®ç°æ–¹å¼ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618222621735-1124071953.png&quot; alt=&quot;&quot; width=&quot;587&quot; height=&quot;358&quot; loading=&quot;lazy&quot;/&gt;Â &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Loop ä»ä»»åŠ¡é˜Ÿåˆ—é‡Œè·å–ä»»åŠ¡ï¼Œç„¶åæ£€æŸ¥å¤šè·¯å¤ç”¨å™¨ä¸­å°±ç»ªçš„Channelè¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸‰ã€Unsafe&lt;/h2&gt;
&lt;p&gt;Nettyä¸­çš„Unsafeï¼Œä¸€ä¸ªChannel&lt;span&gt;&lt;strong&gt;å†…éƒ¨èšåˆæ¥å£&lt;/strong&gt;&lt;/span&gt;ï¼Œç”¨ä»¥å¤„ç†å®é™…çš„ç½‘ç»œI/Oè¯»å†™ã€‚å½“ç„¶ï¼Œå–Unsafeå‘½åï¼Œæºç ä¸­é‡Šä¹‰ï¼šæä¾›çš„ç½‘ç»œç›¸å…³çš„æ“ä½œæ–¹æ³•ï¼Œæ°¸è¿œä¸åº”è¯¥è¢«å¼€å‘äººå‘˜æ“ä½œä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒæ˜¯Channelçš„ä¸€ä¸ª&lt;strong&gt;&lt;span&gt;è¾…åŠ©æ¥å£&lt;/span&gt;&lt;/strong&gt;ï¼Œä¸»è¦æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;1ã€registerï¼šæ³¨å†ŒChannel&lt;/p&gt;
&lt;p&gt;2ã€deregisterï¼šå–æ¶ˆæ³¨å†Œ&lt;/p&gt;
&lt;p&gt;3ã€bindï¼šç»‘å®šåœ°å€ï¼ŒæœåŠ¡ç«¯ç»‘å®šç›‘å¬ç‰¹å®šç«¯å£ï¼›å®¢æˆ·ç«¯æŒ‡å®šæœ¬åœ°ç»‘å®šSocketåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;4ã€connectï¼šå»ºç«‹è¿æ¥&lt;/p&gt;
&lt;p&gt;5ã€disconnectï¼šæ–­å¼€è¿æ¥&lt;/p&gt;
&lt;p&gt;6ã€closeï¼šå…³é—­è¿æ¥&lt;/p&gt;
&lt;p&gt;7ã€writeï¼šè°ƒåº¦å†™ï¼Œå°†æ•°æ®å†™å…¥bufferï¼Œ&lt;span&gt;&lt;strong&gt;å¹¶æœªçœŸæ­£è¿›å…¥Channel&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;8ã€flushï¼šå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥Channel&lt;/p&gt;
&lt;h2&gt;å››ã€AdaptiveRecvByteBufAllocator&lt;/h2&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;åŠ¨æ€ç¼“å†²åŒºåˆ†é…å™¨&lt;/strong&gt;&lt;/span&gt;ï¼Œæºç è¯´æ˜ï¼šæ ¹æ®&lt;span&gt;&lt;strong&gt;å®æ—¶çš„åé¦ˆ&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;åŠ¨æ€&lt;/strong&gt;&lt;/span&gt;çš„å¢åŠ æˆ–è€…å‡å°‘&lt;span&gt;&lt;strong&gt;é¢„éœ€&lt;/strong&gt;&lt;/span&gt;çš„ç¼“å†²åŒºå¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ&lt;span&gt;&lt;strong&gt;ä¸Š&lt;/strong&gt;&lt;strong&gt;ä¸€æ¬¡&lt;/strong&gt;&lt;/span&gt;åˆ†é…çš„ç¼“å†²åŒºè¢«å¡«æ»¡äº†ï¼Œåˆ™è°ƒé«˜ä¸‹ä¸€æ¬¡åˆ†é…çš„ç¼“å†²åŒºå¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ&lt;strong&gt;&lt;span&gt;è¿ç»­ä¸¤æ¬¡&lt;/span&gt;&lt;/strong&gt;å®é™…ä½¿ç”¨çš„å®¹é‡ä½äºåˆ†é…çš„ç¼“å†²åŒºå¤§å°ç‰¹å®šæ¯”ä¾‹ï¼Œåˆ™å‡å°ä¸‹ä¸€æ¬¡åˆ†é…çš„ç¼“å†²åŒºå¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ƒæƒ…æ™¯ï¼Œä¿æŒåˆ†é…å¤§å°ä¸å˜ã€‚&lt;/p&gt;
&lt;p&gt;Nettyçš„è¿™ç§&lt;span&gt;&lt;strong&gt;â€œæ™ºèƒ½åŒ–â€&lt;/strong&gt;&lt;/span&gt;å¤„ç†ï¼Œå¯ä»¥è¯´æ˜¯ç›¸å½“æœ‰ç”¨çš„ï¼š&lt;/p&gt;
&lt;p&gt;1ã€é¦–å…ˆï¼Œå®é™…çš„åº”ç”¨åœºæ™¯åƒå·®ä¸‡åˆ«ï¼ŒåŒä¸€åœºæ™¯ä¸‹ä¸åŒæ—¶åˆ»çš„ç¼“å†²åŒºéœ€æ±‚ä¹Ÿæ˜¯å®æ—¶å˜åŒ–ï¼ˆä¸€å¥è¯å¯ä»¥æ˜¯ä¸€ä¸ªå­—ï¼Œä¹Ÿå¯èƒ½æ˜¯1000ä¸ªå­—ï¼‰ï¼Œè¿™å°±éœ€è¦NettyåŠ¨æ€è°ƒæ•´ç¼“å†²åˆ†é…å¤§å°ä»¥é€‚åº”ä¸åŒçš„&lt;span&gt;&lt;strong&gt;ä¸šåŠ¡åœºæ™¯ï¼Œæ—¶åˆ»åœºæ™¯&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200618234604888-749823847.png&quot; alt=&quot;&quot; width=&quot;320&quot; height=&quot;375&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;2ã€å…¶æ¬¡ï¼Œ&lt;span&gt;&lt;strong&gt;è¿‡å¤§çš„ä¸å¿…è¦çš„&lt;/strong&gt;&lt;/span&gt;å†…å­˜åˆ†é…ï¼Œä¼šå¯¼è‡´Bufferå¤„ç†æ€§èƒ½ä¸‹é™ï¼›&lt;span&gt;&lt;strong&gt;è¿‡å°çš„&lt;/strong&gt;&lt;/span&gt;å†…å­˜åˆ†é…ï¼Œåˆ™ä¼šå¯¼è‡´é¢‘ç¹çš„åˆ†é…é‡Šæ”¾ã€‚è¿™éƒ½æ˜¯ä¸€ä¸ªä¼˜è‰¯çš„ç½‘ç»œæ¡†æ¶ä¸åº”è¯¥æœ‰çš„ã€‚Â &lt;/p&gt;
&lt;p&gt;3ã€æœ€åï¼ŒåŠ¨æ€çš„è°ƒæ•´æœ€ç›´æ¥çš„å¥½å¤„å°±æ˜¯&lt;span&gt;&lt;strong&gt;å†…å­˜çš„çš„é«˜æ•ˆä½¿ç”¨&lt;/strong&gt;&lt;/span&gt;ï¼Œä¸€å®šç¨‹åº¦ä¸Šåšåˆ°äº†&lt;span&gt;&lt;strong&gt;æŒ‰éœ€åˆ†é…&lt;/strong&gt;&lt;/span&gt;ã€‚Â &lt;/p&gt;
&lt;h2&gt;äº”ã€ChannelPipeline&lt;/h2&gt;
&lt;p&gt;Pipeline ç®¡é“ï¼ŒChannelçš„&lt;span&gt;&lt;strong&gt;æ•°æ®æµé€šç®¡é“&lt;/strong&gt;&lt;/span&gt;ï¼Œåœ¨è¿™ä¸ªç®¡é“ä¸­ï¼Œå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;ChannelPipeline æ˜¯ä¸€ç§&lt;span&gt;&lt;strong&gt;èŒè´£é“¾&lt;/strong&gt;&lt;/span&gt;ï¼Œå¯ä»¥å¯¹å…¶ä¸­æµåŠ¨çš„æ•°æ®è¿›è¡Œ&lt;span&gt;&lt;strong&gt;è¿‡æ»¤ã€æ‹¦æˆªå¤„ç†&lt;/strong&gt;&lt;/span&gt;ï¼Œæ˜¯ä¸€ç§&lt;span&gt;&lt;strong&gt;æ’æ‹”å¼çš„é“¾è·¯è£…é…å™¨&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200619000457982-1182918482.png&quot; alt=&quot;&quot; width=&quot;415&quot; height=&quot;437&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;1ã€ChannelPiplineæ˜¯ä¸€ä¸ªå®¹å™¨&lt;/h3&gt;
&lt;p&gt;æ”¯æŒæŸ¥è¯¢ã€æ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ç­‰å®¹å™¨æ“ä½œã€‚&lt;/p&gt;
&lt;h3&gt;2ã€ChannelPiplineæ”¯æŒåŠ¨æ€çš„æ·»åŠ å’Œåˆ é™¤ Handler&lt;/h3&gt;
&lt;p&gt;ChannelPiplineçš„è¿™ç§ç‰¹æ€§ç»™äº†æˆ‘ä»¬ç›¸å½“çš„æƒ³è±¡ç©ºé—´ï¼Œä¾‹å¦‚åŠ¨æ€çš„æ·»åŠ ç³»ç»Ÿæ‹¥å¡ä¿æŠ¤Handlerï¼Œæ•æ„Ÿæ•°æ®è¿‡æ»¤Handlerã€æ—¥å¿—è®°å½•Handlerã€æ€§èƒ½ç»Ÿè®¡Handlerç­‰ã€‚&lt;/p&gt;
&lt;h3&gt;3ã€ChannelPipline æ˜¯çº¿ç¨‹å®‰å…¨çš„&lt;/h3&gt;
&lt;p&gt;ChannelPiplineä½¿ç”¨Â &lt;span&gt;&lt;strong&gt;synchronizedÂ &lt;/strong&gt;&lt;/span&gt;å®ç°çº¿ç¨‹å®‰å…¨ï¼Œä¸šåŠ¡çº¿ç¨‹å¯ä»¥&lt;span&gt;&lt;strong&gt;å¹¶å‘çš„æ“ä½œ&lt;/strong&gt;&lt;/span&gt;ChannelPiplineã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;span&gt;&lt;strong&gt;Handleræ˜¯éçº¿ç¨‹å®‰å…¨çš„&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2&gt;å…­ã€HandlerAdapter&lt;/h2&gt;
&lt;p&gt;Adapteræ˜¯ä¸€ç§&lt;span&gt;&lt;strong&gt;é€‚é…å™¨&lt;/strong&gt;&lt;/span&gt;ï¼Œå¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„Handlerï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿HandlerAdapterï¼Œæ¥&lt;span&gt;&lt;strong&gt;è§„é¿ä¸å¿…è¦çš„æ¥å£å®ç°&lt;/strong&gt;&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img2020.cnblogs.com/blog/603942/202006/603942-20200619004006549-1391336846.png&quot; alt=&quot;&quot; width=&quot;470&quot; height=&quot;428&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;/div&gt;</description>
<pubDate>Thu, 18 Jun 2020 16:49:00 +0000</pubDate>
<dc:creator>WindWant</dc:creator>
<og:description>Channelã€EventLoopã€Unsafeã€multiplexorã€AdaptiveRecvByteBufAllocatorã€ChannelPipeline...</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/niejunlei/p/13155554.html</dc:identifier>
</item>
<item>
<title>ã€Stringæ³¨è§£é©±åŠ¨å¼€å‘ã€‘é¢è¯•å®˜è®©æˆ‘è¯´è¯´ï¼šå¦‚ä½•ä½¿ç”¨FactoryBeanå‘Springå®¹å™¨ä¸­æ³¨å†Œbeanï¼Ÿ - å†°æ²³å›¢é˜Ÿ</title>
<link>http://www.cnblogs.com/binghe001/p/13160930.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/binghe001/p/13160930.html</guid>
<description>&lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;blockquote readability=&quot;8.8940092165899&quot;&gt;
&lt;p&gt;åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å‘Springå®¹å™¨ä¸­æ³¨å†Œbeanã€‚å¯ä»¥ä½¿ç”¨@Configurationç»“åˆ@Beanå‘Springå®¹å™¨ä¸­æ³¨å†Œbeanï¼›å¯ä»¥æŒ‰ç…§æ¡ä»¶å‘Springå®¹å™¨ä¸­æ³¨å†Œbeanï¼›å¯ä»¥ä½¿ç”¨@Importå‘å®¹å™¨ä¸­å¿«é€Ÿå¯¼å…¥beanå¯¹è±¡ï¼›å¯ä»¥åœ¨@Importä¸­ä½¿ç”¨ImportBeanDefinitionRegistrarå‘å®¹å™¨ä¸­æ³¨å†Œbeanã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®å·¥ç¨‹æºç å·²ç»æäº¤åˆ°GitHubï¼š&lt;a href=&quot;https://github.com/sunshinelyz/spring-annotation&quot;&gt;https://github.com/sunshinelyz/spring-annotation&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;factorybeanæ¦‚è¿°&quot;&gt;FactoryBeanæ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSpringé€šè¿‡åå°„æœºåˆ¶åˆ©ç”¨beançš„classå±æ€§æŒ‡å®šå®ç°ç±»æ¥å®ä¾‹åŒ–bean ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ä¾‹åŒ–beanè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœæŒ‰ç…§ä¼ ç»Ÿçš„æ–¹å¼ï¼Œåˆ™éœ€è¦åœ¨æ ‡ç­¾ä¸­æä¾›å¤§é‡çš„é…ç½®ä¿¡æ¯ï¼Œé…ç½®æ–¹å¼çš„çµæ´»æ€§æ˜¯å—é™çš„ï¼Œè¿™æ—¶é‡‡ç”¨ç¼–ç çš„æ–¹å¼å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´åŠ ç®€å•çš„æ–¹æ¡ˆã€‚Springä¸ºæ­¤æä¾›äº†ä¸€ä¸ªorg.springframework.bean.factory.FactoryBeançš„å·¥å‚ç±»æ¥å£ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å®ç°è¯¥æ¥å£å®šåˆ¶å®ä¾‹åŒ–beançš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;FactoryBeanæ¥å£å¯¹äºSpringæ¡†æ¶æ¥è¯´å æœ‰é‡è¦çš„åœ°ä½ï¼ŒSpring è‡ªèº«å°±æä¾›äº†70å¤šä¸ªFactoryBeançš„å®ç°ã€‚å®ƒä»¬éšè—äº†å®ä¾‹åŒ–ä¸€äº›å¤æ‚beançš„ç»†èŠ‚ï¼Œç»™ä¸Šå±‚åº”ç”¨å¸¦æ¥äº†ä¾¿åˆ©ã€‚ä»Spring 3.0 å¼€å§‹ï¼Œ FactoryBeanå¼€å§‹æ”¯æŒæ³›å‹ï¼Œå³æ¥å£å£°æ˜æ”¹ä¸ºFactoryBean çš„å½¢å¼ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨Spring 5.2.6ç‰ˆæœ¬ä¸­ï¼ŒFactoryBeanæ¥å£çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;package org.springframework.beans.factory;
import org.springframework.lang.Nullable;

public interface FactoryBean&amp;lt;T&amp;gt; {

        String OBJECT_TYPE_ATTRIBUTE = &quot;factoryBeanObjectType&quot;;

        @Nullable
        T getObject() throws Exception;

        @Nullable
        Class&amp;lt;?&amp;gt; getObjectType();

        default boolean isSingleton() {
                return true;
        }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;ul&gt;&lt;li&gt;T getObject()ï¼šè¿”å›ç”±FactoryBeanåˆ›å»ºçš„beanå®ä¾‹ï¼Œå¦‚æœisSingleton()è¿”å›trueï¼Œåˆ™è¯¥å®ä¾‹ä¼šæ”¾åˆ°Springå®¹å™¨ä¸­å•å®ä¾‹ç¼“å­˜æ± ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;boolean isSingleton()ï¼šè¿”å›ç”±FactoryBeanåˆ›å»ºçš„beanå®ä¾‹çš„ä½œç”¨åŸŸæ˜¯singletonè¿˜æ˜¯prototypeã€‚&lt;/li&gt;
&lt;li&gt;Class getObjectType()ï¼šè¿”å›FactoryBeanåˆ›å»ºçš„beanç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;è¿™é‡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“é…ç½®æ–‡ä»¶ä¸­æ ‡ç­¾çš„classå±æ€§é…ç½®çš„å®ç°ç±»æ˜¯FactoryBeanæ—¶ï¼Œé€šè¿‡ getBean()æ–¹æ³•è¿”å›çš„ä¸æ˜¯FactoryBeanæœ¬èº«ï¼Œè€Œæ˜¯FactoryBean#getObject()æ–¹æ³•æ‰€è¿”å›çš„å¯¹è±¡ï¼Œç›¸å½“äºFactoryBean#getObject()ä»£ç†äº†getBean()æ–¹æ³•ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;factorybeanå®ä¾‹&quot;&gt;FactoryBeanå®ä¾‹&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªPersonFactoryBeanï¼Œå®ç°FactoryBeanæ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;package io.mykit.spring.plugins.register.bean;

import org.springframework.beans.factory.FactoryBean;
/**
 * @author binghe
 * @version 1.0.0
 * @description å•†å“çš„FactoryBeanï¼Œæµ‹è¯•FactoryBean
 */
public class PersonFactoryBean implements FactoryBean&amp;lt;Person&amp;gt; {

    //è¿”å›ä¸€ä¸ªPersonå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¢«æ³¨å†Œåˆ°Springå®¹å™¨ä¸­
    @Override
    public Person getObject() throws Exception {
        return new Person();
    }

    @Override
    public Class&amp;lt;?&amp;gt; getObjectType() {
        return Person.class;
    }

    //beanæ˜¯å¦ä¸ºå•ä¾‹;true:æ˜¯ï¼›false:å¦
    @Override
    public boolean isSingleton() {
        return true;
    }
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨PersonConfig2ç±»ä¸­åŠ å…¥PersonFactoryBeançš„å£°æ˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Bean
public PersonFactoryBean personFactoryBean(){
    return new PersonFactoryBean();
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦å°ä¼™ä¼´ä»¬æ³¨æ„çš„æ˜¯ï¼šæˆ‘åœ¨è¿™é‡Œä½¿ç”¨@Beanæ³¨è§£å‘Springå®¹å™¨ä¸­æ·»åŠ çš„æ˜¯PersonFactoryå¯¹è±¡ã€‚é‚£æˆ‘ä»¬å°±æ¥çœ‹çœ‹Springå®¹å™¨ä¸­æœ‰å“ªäº›beanã€‚æ¥ä¸‹æ¥ï¼Œè¿è¡ŒSpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•ï¼Œè¾“å‡ºçš„ç»“æœä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
personConfig2
io.mykit.spring.plugins.register.bean.Department
io.mykit.spring.plugins.register.bean.Employee
io.mykit.spring.plugins.register.bean.User
io.mykit.spring.plugins.register.bean.Role
person
binghe001
personFactoryBean
company
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œç»“æœä¿¡æ¯ä¸­è¾“å‡ºäº†ä¸€ä¸ªpersonFactoryBeanï¼Œæˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªpersonFactoryBeanåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯¹SpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•ç¨åŠ æ”¹åŠ¨ï¼Œæ·»åŠ è·å–personFactoryBeançš„ä»£ç ï¼Œå¹¶è¾“å‡ºpersonFactoryBeanå®ä¾‹çš„ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Test
public void testAnnotationConfig7(){
    ApplicationContext context = new AnnotationConfigApplicationContext(PersonConfig2.class);
    String[] names = context.getBeanDefinitionNames();
    Arrays.stream(names).forEach(System.out::println);

    Object personFactoryBean = context.getBean(&quot;personFactoryBean&quot;);
    System.out.println(&quot;personFactoryBeanå®ä¾‹çš„ç±»å‹ä¸ºï¼š&quot; + personFactoryBean.getClass());
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å†æ¬¡è¿è¡ŒSpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•ï¼Œè¾“å‡ºçš„ç»“æœä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
personConfig2
io.mykit.spring.plugins.register.bean.Department
io.mykit.spring.plugins.register.bean.Employee
io.mykit.spring.plugins.register.bean.User
io.mykit.spring.plugins.register.bean.Role
person
binghe001
personFactoryBean
company
personFactoryBeanå®ä¾‹çš„ç±»å‹ä¸ºï¼šclass io.mykit.spring.plugins.register.bean.Person
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘åœ¨ä»£ç ä¸­ä½¿ç”¨@Beanæ³¨è§£æ³¨å…¥çš„PersonFactoryBeanå¯¹è±¡ï¼Œä½†æ˜¯ï¼Œå®é™…ä¸Šä»Springå®¹å™¨ä¸­è·å–åˆ°çš„beanå¯¹è±¡å´æ˜¯è°ƒç”¨PersonFactoryBeanç±»ä¸­çš„getObject()è·å–åˆ°çš„Personå¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯æœ‰ç§è±ç„¶å¼€æœ—çš„æ„Ÿè§‰ï¼ï¼ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨PersonFactoryBeanç±»ä¸­ï¼Œæˆ‘ä»¬å°†Personå¯¹è±¡è®¾ç½®ä¸ºå•å®ä¾‹beanï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨SpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•å¤šæ¬¡è·å–Personå¯¹è±¡ï¼Œå¹¶è¾“å‡ºå¤šæ¬¡è·å–çš„å¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Test
public void testAnnotationConfig7(){
    ApplicationContext context = new AnnotationConfigApplicationContext(PersonConfig2.class);
    String[] names = context.getBeanDefinitionNames();
    Arrays.stream(names).forEach(System.out::println);

    Object personFactoryBean1 = context.getBean(&quot;personFactoryBean&quot;);
    Object personFactoryBean2 = context.getBean(&quot;personFactoryBean&quot;);
    System.out.println(personFactoryBean1 == personFactoryBean2);
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿è¡ŒtestAnnotationConfig7()æ–¹æ³•è¾“å‡ºçš„ç»“æœä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
personConfig2
io.mykit.spring.plugins.register.bean.Department
io.mykit.spring.plugins.register.bean.Employee
io.mykit.spring.plugins.register.bean.User
io.mykit.spring.plugins.register.bean.Role
person
binghe001
personFactoryBean
company
true
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨PersonFactoryBeanç±»çš„isSingleton()æ–¹æ³•ä¸­è¿”å›trueæ—¶ï¼Œæ¯æ¬¡è·å–åˆ°çš„Personå¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè¯´æ˜Personå¯¹è±¡æ˜¯å•å®ä¾‹beanã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œï¼Œå¯èƒ½å°±ä¼šæœ‰å°ä¼™ä¼´è¦é—®äº†ï¼Œå¦‚æœå°†Personå¯¹è±¡ä¿®æ”¹æˆå¤šå®ä¾‹beanå‘¢ï¼Ÿåˆ«æ€¥ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦åœ¨PersonFactoryBeanç±»çš„isSingleton()æ–¹æ³•ä¸­è¿”å›falseï¼Œå³å¯å°†Personå¯¹è±¡è®¾ç½®ä¸ºå¤šå®ä¾‹beanï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;//beanæ˜¯å¦ä¸ºå•ä¾‹;true:æ˜¯ï¼›false:å¦
@Override
public boolean isSingleton() {
    return false;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å†æ¬¡è¿è¡ŒSpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•ï¼Œè¾“å‡ºçš„ç»“æœä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-bash&quot;&gt;org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
personConfig2
io.mykit.spring.plugins.register.bean.Department
io.mykit.spring.plugins.register.bean.Employee
io.mykit.spring.plugins.register.bean.User
io.mykit.spring.plugins.register.bean.Role
person
binghe001
personFactoryBean
company
false
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆç»“æœè¿”å›äº†falseï¼Œè¯´æ˜æ­¤æ—¶Personå¯¹è±¡æ˜¯å¤šå®ä¾‹beanã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¦‚ä½•åœ¨springå®¹å™¨ä¸­è·å–åˆ°factorybeanå¯¹è±¡ï¼Ÿ&quot;&gt;å¦‚ä½•åœ¨Springå®¹å™¨ä¸­è·å–åˆ°FactoryBeanå¯¹è±¡ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨@Beanæ³¨è§£å‘Springå®¹å™¨ä¸­æ³¨å†Œçš„PersonFactoryBeanï¼Œè·å–å‡ºæ¥çš„ç¡®å®Personå¯¹è±¡ã€‚é‚£ä¹ˆï¼Œå°ä¼™ä¼´ä»¬å¯èƒ½ä¼šé—®ï¼šæˆ‘å°±æƒ³è·å–PersonFactoryBeanå®ä¾‹ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œè¿™ä¹Ÿå¾ˆç®€å•ï¼Œ &lt;strong&gt;åªéœ€è¦åœ¨è·å–beanå¯¹è±¡æ—¶ï¼Œåœ¨idå‰é¢åŠ ä¸Š&amp;amp;ç¬¦å·å³å¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€æˆ‘ä»¬çš„æµ‹è¯•ç±»SpringBeanTestï¼Œåœ¨testAnnotationConfig7()æ–¹æ³•ä¸­æ·»åŠ è·å–PersonFactoryBeanå®ä¾‹çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;@Test
public void testAnnotationConfig7(){
    ApplicationContext context = new AnnotationConfigApplicationContext(PersonConfig2.class);
    String[] names = context.getBeanDefinitionNames();
    Arrays.stream(names).forEach(System.out::println);

    Object personFactoryBean1 = context.getBean(&quot;personFactoryBean&quot;);
    Object personFactoryBean2 = context.getBean(&quot;personFactoryBean&quot;);
    System.out.println(&quot;personFactoryBean1ç±»å‹ï¼š&quot; + personFactoryBean1.getClass());
    System.out.println(&quot;personFactoryBean2ç±»å‹ï¼š&quot; + personFactoryBean2.getClass());
    System.out.println(personFactoryBean1 == personFactoryBean2);

    Object personFactoryBean3 = context.getBean(&quot;&amp;amp;personFactoryBean&quot;);
    System.out.println(&quot;personFactoryBean3ç±»å‹ï¼š&quot; + personFactoryBean3.getClass());
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;è¿è¡ŒSpringBeanTestç±»ä¸­çš„testAnnotationConfig7()æ–¹æ³•ï¼Œè¾“å‡ºçš„ç»“æœä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
personConfig2
io.mykit.spring.plugins.register.bean.Department
io.mykit.spring.plugins.register.bean.Employee
io.mykit.spring.plugins.register.bean.User
io.mykit.spring.plugins.register.bean.Role
person
binghe001
personFactoryBean
company
personFactoryBean1ç±»å‹ï¼šclass io.mykit.spring.plugins.register.bean.Person
personFactoryBean2ç±»å‹ï¼šclass io.mykit.spring.plugins.register.bean.Person
false
personFactoryBean3ç±»å‹ï¼šclass io.mykit.spring.plugins.register.bean.PersonFactoryBean
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è·å–beanæ—¶ï¼Œåœ¨idå‰é¢åŠ ä¸Š&amp;amp;ç¬¦å·å°±ä¼šè·å–åˆ°PersonFactoryBeanå®ä¾‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;é‚£é—®é¢˜åˆæ¥äº†ï¼ï¼&lt;strong&gt;ä¸ºä»€ä¹ˆåœ¨idå‰é¢åŠ ä¸Š&amp;amp;ç¬¦å·å°±ä¼šè·å–åˆ°PersonFactoryBeanå®ä¾‹å¯¹è±¡å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ­å¼€è¿™ä¸ªç¥ç§˜çš„é¢çº±ï¼Œæ‰“å¼€BeanFactoryæ¥å£ï¼Œ&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-java&quot;&gt;package org.springframework.beans.factory;
import org.springframework.beans.BeansException;
import org.springframework.core.ResolvableType;
import org.springframework.lang.Nullable;

public interface BeanFactory {
        String FACTORY_BEAN_PREFIX = &quot;&amp;amp;&quot;;
    /**************ä»¥ä¸‹çœç•¥nè¡Œä»£ç ***************/
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯æ˜ç™½äº†å‘¢ï¼Ÿæ²¡é”™ï¼Œåœ¨BeanFactoryæ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ª&amp;amp;å‰ç¼€ï¼Œåªè¦æˆ‘ä»¬ä½¿ç”¨beançš„idæ¥ä»Springå®¹å™¨ä¸­è·å–beanæ—¶ï¼ŒSpringå°±ä¼šçŸ¥é“æˆ‘ä»¬æ˜¯åœ¨è·å–FactoryBeanæœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;å¥½äº†ï¼Œå’±ä»¬ä»Šå¤©å°±èŠåˆ°è¿™å„¿å§ï¼åˆ«å¿˜äº†ç»™ä¸ªåœ¨çœ‹å’Œè½¬å‘ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ°ï¼Œä¸€èµ·å­¦ä¹ ä¸€èµ·è¿›æ­¥ï¼ï¼&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;blockquote readability=&quot;2.3333333333333&quot;&gt;
&lt;p&gt;é¡¹ç›®å·¥ç¨‹æºç å·²ç»æäº¤åˆ°GitHubï¼š&lt;a href=&quot;https://github.com/sunshinelyz/spring-annotation&quot;&gt;https://github.com/sunshinelyz/spring-annotation&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å†™åœ¨æœ€å&quot;&gt;å†™åœ¨æœ€å&lt;/h2&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;å¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰ç‚¹å¸®åŠ©ï¼Œè¯·å¾®ä¿¡æœç´¢å¹¶å…³æ³¨ã€Œ å†°æ²³æŠ€æœ¯ ã€å¾®ä¿¡å…¬ä¼—å·ï¼Œè·Ÿå†°æ²³å­¦ä¹ Springæ³¨è§£é©±åŠ¨å¼€å‘ã€‚å…¬ä¼—å·å›å¤â€œspringæ³¨è§£â€å…³é”®å­—ï¼Œé¢†å–Springæ³¨è§£é©±åŠ¨å¼€å‘æ ¸å¿ƒçŸ¥è¯†å›¾ï¼Œè®©Springæ³¨è§£é©±åŠ¨å¼€å‘ä¸å†è¿·èŒ«ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
</description>
<pubDate>Thu, 18 Jun 2020 16:25:00 +0000</pubDate>
<dc:creator>å†°æ²³å›¢é˜Ÿ</dc:creator>
<og:description>å†™åœ¨å‰é¢ åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å‘Springå®¹å™¨ä¸­æ³¨å†Œbeanã€‚å¯ä»¥ä½¿ç”¨@Configurationç»“åˆ@Beanå‘Springå®¹å™¨ä¸­æ³¨å†Œbeanï¼›å¯ä»¥æŒ‰ç…§æ¡ä»¶å‘Springå®¹å™¨ä¸­</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/binghe001/p/13160930.html</dc:identifier>
</item>
<item>
<title>80386å­¦ä¹ ï¼ˆäº”ï¼‰ 80386åˆ†é¡µæœºåˆ¶ä¸è™šæ‹Ÿå†…å­˜ - å°ç†Šé¤é¦†</title>
<link>http://www.cnblogs.com/xiaoxiongcanguan/p/13068678.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/xiaoxiongcanguan/p/13068678.html</guid>
<description>&lt;p&gt;ã€€ã€€80386èƒ½å¤Ÿå°†å†…å­˜åˆ†ä¸ºä¸åŒå±æ€§çš„æ®µï¼Œå¹¶é€šè¿‡æ®µæè¿°ç¬¦ã€æ®µè¡¨ä»¥åŠæ®µé€‰æ‹©å­ç­‰æœºåˆ¶ï¼Œé€šè¿‡æ®µåŸºå€å’Œæ®µå†…åç§»é‡è®¡ç®—å‡ºçº¿æ€§åœ°å€è¿›è¡Œè®¿é—®ï¼Œè¿™ä¸€å†…å­˜ç®¡ç†æ–¹å¼è¢«ç§°ä¸º&lt;strong&gt;æ®µå¼å†…å­˜ç®¡ç†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è¿™é‡Œè¦ä»‹ç»çš„æ˜¯å¦ä¸€ç§å†…å­˜ç®¡ç†çš„æ–¹å¼ï¼š80386åœ¨å¼€å¯äº†åˆ†é¡µæœºåˆ¶åï¼Œä¾¿èƒ½å¤Ÿå°†ç‰©ç†å†…å­˜åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªå¤§å°ç›¸åŒä¸”è¿ç»­çš„ç‰©ç†å†…å­˜é¡µï¼Œè®¿é—®æ—¶é€šè¿‡ç‰©ç†å†…å­˜é¡µå·å’Œé¡µå†…åç§»è®¡ç®—å‡ºæœ€ç»ˆéœ€è¦è®¿é—®çš„çº¿æ€§åœ°å€è¿›è¡Œè®¿é—®ï¼Œç”±äºå†…å­˜ç®¡ç†å•å…ƒç”±æ®µå˜æˆäº†é¡µï¼Œå› æ­¤è¿™ä¸€å†…å­˜ç®¡ç†æ–¹å¼è¢«ç§°ä¸º&lt;strong&gt;é¡µå¼å†…å­˜ç®¡ç†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;80386çš„åˆ†é¡µæœºåˆ¶åªèƒ½åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹å¼€å¯ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆéœ€è¦é¡µå¼å†…å­˜ç®¡ç†ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ã€€ã€€åœ¨ä»‹ç»80386åˆ†é¡µæœºåˆ¶å‰ï¼Œéœ€è¦å…ˆç†è§£ä¸ºä»€ä¹ˆCPUåœ¨ç®¡ç†å†…å­˜æ—¶ï¼Œè¦åœ¨æ®µå¼å†…å­˜ç®¡ç†çš„åŸºç¡€ä¸Šå†å¼•å…¥ä¸€ç§æœ‰å¾ˆå¤§å·®å¼‚çš„é¡µå¼å†…å­˜ç®¡ç†æ–¹å¼ï¼Ÿé¡µå¼å†…å­˜ç®¡ç†ä¸çº¯æ®µå¼å†…å­˜ç®¡ç†ç›¸æ¯”åˆ°åº•å…·æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› æ˜¯ä¸ºäº†è§£å†³å¤šä»»åŠ¡ç¯å¢ƒä¸‹ï¼Œ&lt;strong&gt;æ®µå¼å†…å­˜ç®¡ç†ä¸­å¤šä»»åŠ¡çš„åˆ›å»ºä¸ç»ˆæ­¢æ—¶ä¼šäº§ç”Ÿè¾ƒå¤šå†…å­˜ç¢ç‰‡ï¼Œä½¿å¾—å†…å­˜ç©ºé—´ä½¿ç”¨ç‡ä¸é«˜çš„é—®é¢˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;å†…å­˜ç¢ç‰‡åˆ†ä¸ºå¤–ç¢ç‰‡å’Œå†…ç¢ç‰‡ä¸¤ç§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;å¤–ç¢ç‰‡&lt;/h3&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;å¯¹äºæŒ‡ä»¤å’Œæ•°æ®çš„è®¿é—®é€šå¸¸éƒ½æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥éœ€è¦ä¸ºä¸€ä¸ªä»»åŠ¡åˆ†é…è¿ç»­çš„å†…å­˜ç©ºé—´&lt;/strong&gt;ã€‚åœ¨æ®µå¼å†…å­˜ç®¡ç†ä¸­ï¼Œé€šå¸¸ä¸ºä»»åŠ¡åˆ†é…ä¸€ä¸ªå®Œæ•´çš„å†…å­˜æ®µï¼Œæˆ–æ˜¯æŒ‰ç…§ä»»åŠ¡å†…æ®µåŠŸèƒ½çš„ä¸åŒï¼Œåˆ†é…åŒ…æ‹¬ä»£ç æ®µã€æ•°æ®æ®µå’Œå †æ ˆæ®µåœ¨å†…çš„å¤šä¸ªå®Œæ•´è¿ç»­æ®µç©ºé—´ã€‚&lt;strong&gt;æ”¯æŒå¤šé“ä»»åŠ¡çš„ç³»ç»Ÿåˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œä¼šåœ¨æŸäº›ä»»åŠ¡é€€å‡ºå¹¶é‡Šæ”¾å†…å­˜æ—¶ï¼Œäº§ç”Ÿå¤–éƒ¨å†…å­˜ç¢ç‰‡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾å½“å‰å­˜åœ¨10MBçš„å†…å­˜ç©ºé—´ï¼Œå­˜åœ¨A/B/C/Då››ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€æ•´å—çš„å†…å­˜ç©ºé—´ï¼Œå…¶æ‰€å ç”¨çš„å†…å­˜ç©ºé—´åˆ†åˆ«ä¸º3MB/2MB/4MB/1MBï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º(ä¸€ä¸ªæ ¼å­ä»£è¡¨1MBå†…å­˜)ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å½“ä»»åŠ¡Bå’Œä»»åŠ¡Dæ‰§è¡Œå®Œæˆåï¼Œæ‰€å ç”¨çš„å†…å­˜ç©ºé—´è¢«é‡Šæ”¾ï¼Œ10MBçš„å†…å­˜ç©ºé—´ä¸­å‡ºç°äº†3MBå¤§å°çš„ç©ºé—²å†…å­˜ã€‚å¦‚æœæ­¤æ—¶å‡ºç°äº†ä¸€ä¸ªä»»åŠ¡Eï¼Œéœ€è¦ä¸ºå…¶åˆ†é…3MBçš„å†…å­˜ç©ºé—´ï¼Œæ­¤æ—¶å†…å­˜è™½ç„¶å­˜åœ¨3MBçš„å†…å­˜ç©ºé—´ï¼Œå´ç”±äºç©ºé—²å†…å­˜çš„ä¸è¿ç»­ï¼Œç¢ç‰‡åŒ–ï¼Œå¯¼è‡´æ— æ³•ç›´æ¥åˆ†é…ç»™ä»»åŠ¡Eä½¿ç”¨ã€‚è€Œè¿™é‡Œä»»åŠ¡Bã€ä»»åŠ¡Dç»“æŸåé‡Šæ”¾çš„ç©ºä½™å†…å­˜ç©ºé—´å°±è¢«è§†ä¸ºå¤–ç¢ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è¿™é‡Œçš„ä¾‹å­ä»»åŠ¡æ•°é‡å°‘ä¸”å†…å­˜ç©ºé—´ä¹Ÿå¾ˆå°ã€‚è€Œåœ¨å®é™…çš„32ä½ç”šè‡³64ä½çš„ç³»ç»Ÿä¸­ï¼Œç‰©ç†å†…å­˜ç©ºé—´å°‘åˆ™4GBï¼Œå¤šåˆ™å‡ åç”šè‡³ä¸Šç™¾GBï¼Œç”±äºä»»åŠ¡å†…å­˜çš„åå¤åˆ†é…å’Œé‡Šæ”¾ï¼Œå¯¼è‡´å‡ºç°çš„å¤–ç¢ç‰‡çš„æ•°é‡åŠæµªè´¹çš„å†…å­˜ç©ºé—´ä¼šå¾ˆå¤šï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½äº†å†…å­˜ç©ºé—´çš„åˆ©ç”¨ç‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è™½ç„¶ç†è®ºä¸Šèƒ½å¤Ÿé€šè¿‡æ“ä½œç³»ç»Ÿå°å¿ƒç¿¼ç¿¼çš„æŒªåŠ¨å†…å­˜ï¼Œä½¿å¾—å¤–ç¢ç‰‡èƒ½å¤Ÿæ‹¼æ¥ä¸ºè¿ç»­çš„å¤§å—ï¼Œå¾—ä»¥è¢«æœ‰æ•ˆåˆ©ç”¨(å†…å­˜ç´§ç¼©)ã€‚ä½†æ˜¯æ“ä½œç³»ç»ŸæŒªåŠ¨ã€å¤åˆ¶å†…å­˜æœ¬èº«å¾ˆå ç”¨CPUèµ„æºï¼Œä¸”å­˜åœ¨å¯¹æŒ‡ä»¤è¿›è¡Œåœ°å€é‡å®šä½ã€æš‚æ—¶æš‚åœå¯¹æ‰€æŒªåŠ¨å†…å­˜åŒºåŸŸçš„è®¿é—®ç­‰é™„åŠ é—®é¢˜ï¼Œé€ æˆçš„æ•ˆç‡é™ä½ç¨‹åº¦å‡ ä¹æ˜¯ä¸å¯å¿å—çš„ï¼Œå› æ­¤è¿™ä¸€è§£å†³æ–¹æ¡ˆå¹¶æ²¡æœ‰è¢«å¹¿æ³›ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;img src=&quot;https://img2020.cnblogs.com/blog/1506329/202006/1506329-20200610234004524-1910338670.png&quot; alt=&quot;&quot; width=&quot;594&quot; height=&quot;553&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;å†…ç¢ç‰‡&lt;/h3&gt;
&lt;p&gt;ã€€ã€€å¤–ç¢ç‰‡æŒ‡çš„æ˜¯ä¸åŒä»»åŠ¡å†…å­˜ä¹‹é—´çš„ç¢ç‰‡ï¼Œè€Œå†…ç¢ç‰‡æŒ‡çš„æ˜¯ä¸€ä¸ªä»»åŠ¡å†…äº§ç”Ÿçš„å†…å­˜ç¢ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€é€šå¸¸æ“ä½œç³»ç»Ÿä¸ºäº†ç®¡ç†å¤šä»»åŠ¡ç¯å¢ƒä¸‹çš„ç‰©ç†å†…å­˜ï¼Œä¼šå°†å†…å­˜åˆ†éš”ä¸ºå›ºå®šå¤§å°çš„åˆ†åŒºï¼Œä½¿ç”¨ç³»ç»Ÿè¡¨è®°å½•å¯¹åº”åˆ†åŒºå†…å­˜çš„ä½¿ç”¨æƒ…å†µ(å¦‚æ˜¯å¦å·²åˆ†é…ç­‰)ã€‚åˆ†åŒºçš„å¤§å°å¿…é¡»é€‚å½“ï¼Œå¦‚æœåˆ†åŒºè¿‡å°ï¼Œåˆ™ç›¸åŒç‰©ç†å†…å­˜å¤§å°ä¸‹ï¼Œç³»ç»Ÿè¡¨é¡¹è¿‡å¤šä½¿å¾—æ‰€å ç”¨çš„ç©ºé—´è¿‡å¤§ï¼›å¯å¦‚æœåˆ†åŒºè¿‡å¤§ï¼Œåˆ™ä¼šäº§ç”Ÿè¿‡å¤§çš„å†…ç¢ç‰‡ï¼Œé€ æˆä¸å¿…è¦çš„å†…å­˜ç©ºé—´æµªè´¹ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä»¥ä¸Šè¿°ä»‹ç»å¤–ç¢ç‰‡çš„æ•°æ®ä¸ºä¾‹ï¼Œç³»ç»Ÿä¸­çš„å†…å­˜åˆ†åŒºå›ºå®šå¤§å°ä¸º1MBï¼Œå…¶ä¸­ä¸ºä»»åŠ¡Cåˆ†é…äº†4ä¸ªå†…å­˜åˆ†åŒºï¼Œå…±4MBå¤§å°ã€‚å¯å®é™…ä¸Šä»»åŠ¡Cå®é™…åªéœ€è¦3.5MBçš„ç©ºé—´å³å¯æ»¡è¶³éœ€æ±‚ï¼Œä½†ç”±äºåˆ†åŒºæ˜¯å†…å­˜ç®¡ç†çš„æœ€å°å•å…ƒï¼Œåªèƒ½ä¸ºä»»åŠ¡åˆ†é…æ•´æ•°ä¸ªçš„å†…å­˜åˆ†åŒºã€‚3ä¸ªåˆ†åŒº3MBå¹¶ä¸æ»¡è¶³ä»»åŠ¡Cçš„3.5MBçš„å†…å­˜éœ€æ±‚ï¼Œå› æ­¤åªèƒ½åˆ†é…4ä¸ªåˆ†åŒºç»™ä»»åŠ¡Cã€‚è€Œè¿™é‡Œä»»åŠ¡Cé¢å¤–å¤šå ç”¨çš„0.5MBå†…å­˜å°±æ˜¯å†…ç¢ç‰‡ã€‚ã€€&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;å†…ç¢ç‰‡å°±æ˜¯å·²ç»è¢«åˆ†é…å‡ºå»ï¼Œå´ä¸èƒ½è¢«æœ‰æ•ˆåˆ©ç”¨çš„å†…å­˜ç©ºé—´ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;80386æ˜¯å¦‚ä½•è§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜çš„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å¤–ç¢ç‰‡çš„è§£å†³&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¤–ç¢ç‰‡é—®é¢˜äº§ç”Ÿçš„ä¸»è¦åŸå› æ˜¯ç¨‹åºæ‰€éœ€è¦åˆ†é…çš„å†…å­˜ç©ºé—´æ˜¯è¿ç»­çš„ã€‚ä¸ºæ­¤ï¼Œ80386æä¾›äº†åˆ†é¡µæœºåˆ¶ï¼Œä½¿å¾—æœ€ç»ˆåˆ†é…ç»™ä»»åŠ¡çš„ç‰©ç†å†…å­˜ç©ºé—´å¯ä»¥ä¸è¿ç»­ã€‚å¦‚æœä»»åŠ¡æ‰€ä½¿ç”¨çš„å†…å­˜ä¸å¿…è¿ç»­ï¼Œå‰é¢å¤–ç¢ç‰‡ä¾‹å­ä¸­æåˆ°çš„ä»»åŠ¡Eå°±èƒ½å¤Ÿåœ¨1MB+2MBçš„ç¦»æ•£ç‰©ç†å†…å­˜ä¸Šæ­£å¸¸è¿è¡Œï¼Œå¤–ç¢ç‰‡é—®é¢˜è‡ªç„¶å°±å¾—åˆ°äº†è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å†…ç¢ç‰‡çš„è§£å†³&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€å†…ç¢ç‰‡ä»æœ¬è´¨ä¸Šæ¥è¯´æ˜¯å¾ˆéš¾å®Œå…¨é¿å…çš„(å†…å­˜ç®¡ç†æœ€å°å•å…ƒä¸èƒ½è¿‡å°)ï¼Œä¸»è¦çš„é—®é¢˜åœ¨äºå‰é¢æåˆ°çš„å†…å­˜åˆ†åŒºç®¡ç†å•å…ƒå¤§å°çš„è¾ƒä¼˜å€¼ä¸å¥½ç¡®å®šã€‚å¼€å¯äº†åˆ†é¡µç®¡ç†çš„80386ï¼Œå…è®¸å°†ç‰©ç†å†…å­˜åˆ†å‰²æœ€å°ä¸º4KBå›ºå®šå¤§å°çš„ç®¡ç†å•å…ƒï¼Œè¿™ä¸ªå›ºå®šå¤§å°çš„å†…å­˜ç®¡ç†å•å…ƒè¢«ç§°ä¸ºé¡µï¼Œå¹¶ç”±ä¸“é—¨çš„è¢«ç§°ä¸ºé¡µè¡¨çš„æ•°æ®ç»“æ„æ¥è¿½è¸ªå†…å­˜é¡µçš„ä½¿ç”¨æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¯¹äºé¡µè¡¨é¡¹è¿‡å¤šçš„é—®é¢˜ï¼Œ80386çš„è®¾è®¡è€…æä¾›äº†å¤šçº§é¡µè¡¨æœºåˆ¶ï¼Œå‡å°‘äº†é¡µè¡¨æ‰€å ç”¨çš„ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¯¹äºå†…ç¢ç‰‡è¿‡å¤§çš„é—®é¢˜ï¼Œç”±äº80386æ‰€è¿è¡Œçš„ä»»åŠ¡æ‰€å ç”¨çš„å†…å­˜æ®µä¸€èˆ¬è¿œå¤§äºä¸€ä¸ªå†…å­˜é¡µçš„å¤§å°ï¼Œå› æ­¤é¡µæœºåˆ¶ä¸‹æ‰€äº§ç”Ÿçš„å†…éƒ¨ç¢ç‰‡æ˜¯ååˆ†æœ‰é™çš„ï¼Œå¯ä»¥è¾¾åˆ°ä¸€ä¸ªä»¤äººæ»¡æ„çš„å†…å­˜ä½¿ç”¨ç‡ã€‚&lt;/p&gt;

&lt;p&gt;ã€€ã€€ä¸ºäº†è§£å†³åº”ç”¨ç¨‹åºé«˜é€Ÿå¢é•¿çš„å†…å­˜éœ€æ±‚ä¸ç‰©ç†å†…å­˜å¢åŠ ç¼“æ…¢çš„çŸ›ç›¾ï¼Œè®¡ç®—æœºç§‘å­¦å®¶ä»¬æä¾›äº†è™šæ‹Ÿå†…å­˜çš„æ¦‚å¿µã€‚ä½¿ç”¨äº†è™šæ‹Ÿå†…å­˜çš„ç³»ç»Ÿï¼Œå¯ä»¥ä½¿å¾—ç³»ç»Ÿå†…è¿è¡Œçš„ç¨‹åºæ‰€å ç”¨çš„å†…å­˜ç©ºé—´æ€»é‡ï¼Œè¿œå¤§äºå®é™…ç‰©ç†å†…å­˜çš„å®¹é‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€èƒ½å¤Ÿå®ç°è™šæ‹Ÿå†…å­˜çš„å…³é”®åœ¨äºç¨‹åºåœ¨ç‰¹å®šæ—¶åˆ»æ‰€éœ€è¦è®¿é—®çš„å†…å­˜åœ°å€æ˜¯ç¬¦åˆ&lt;strong&gt;å±€éƒ¨æ€§åŸç†&lt;/strong&gt;çš„ã€‚é€šè¿‡æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶çš„ç´§å¯†é…åˆï¼Œèƒ½å¤Ÿå°†ä»»åŠ¡æš‚æ—¶ä¸éœ€è¦è®¿é—®çš„å†…å­˜äº¤æ¢åˆ°å¤–éƒ¨ç¡¬ç›˜ä¸­ï¼Œè€Œå°†ç‰©ç†å†…å­˜ç•™ç»™çœŸæ­£éœ€è¦è®¿é—®çš„é‚£éƒ¨åˆ†å†…å­˜(&lt;strong&gt;å·¥ä½œé›†å†…å­˜&lt;/strong&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è™šæ‹Ÿå†…å­˜å’Œåˆ†é¡µæœºåˆ¶æ˜¯ä¸€å¯¹å¥½æ­æ¡£ï¼Œåˆ†é¡µæœºåˆ¶æä¾›äº†ç®¡ç†å†…å­˜çš„åŸºæœ¬å•ä½ï¼šé¡µï¼Œ80386çš„é¡µå¼è™šæ‹Ÿå†…å­˜å®ç°åœ¨å·¥ä½œé›†å†…å­˜è°ƒåº¦æ—¶ä¹Ÿä¾èµ–åˆ†é¡µæœºåˆ¶æä¾›çš„é¡µæ¥è¿›è¡Œã€‚éšç€ç¨‹åºçš„æ‰§è¡Œï¼Œç¨‹åºçš„å·¥ä½œé›†å†…å­˜åœ¨åŠ¨æ€å˜åŒ–ï¼Œå½“CPUæ£€æµ‹åˆ°å½“å‰æ‰€è®¿é—®çš„å†…å­˜é¡µä¸åœ¨ç‰©ç†å†…å­˜ä¸­æ—¶ï¼Œä¾¿ä¼šé€šçŸ¥æ“ä½œç³»ç»Ÿ(å†…å­˜ç¼ºé¡µå¼‚å¸¸)ï¼Œæ“ä½œç³»ç»Ÿçš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºä¼šå°†ç¡¬ç›˜äº¤æ¢åŒºä¸­çš„å¯¹åº”å†…å­˜é¡µæ•°æ®å†™å›ç‰©ç†å†…å­˜ã€‚å¦‚æœç‰©ç†å†…å­˜é¡µå·²ç»æ»¡äº†çš„æƒ…å†µä¸‹ï¼Œåˆ™è¿˜éœ€è¦æ ¹æ®æŸç§ç®—æ³•å°†å¦ä¸€ä¸ªç‰©ç†å†…å­˜é¡µæ›¿æ¢ï¼Œæ¥å®¹çº³è¿™ä¸€æ¢å…¥çš„å†…å­˜é¡µã€‚&lt;/p&gt;

&lt;p&gt;ã€€ã€€åœ¨ä»‹ç»åˆ†é¡µæœºåˆ¶åŸç†ä¹‹å‰ï¼Œéœ€è¦å…ˆç†è§£å…³äº80386ä¿æŠ¤æ¨¡å¼ä¸‹32ä½å†…å­˜å¯»å€æ—¶å‡ ç§åœ°å€çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç‰©ç†åœ°å€(Physical Address)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç‰©ç†åœ°å€å°±æ˜¯32ä½çš„åœ°å€æ€»çº¿æ‰€å¯¹åº”çš„çœŸå®çš„ç¡¬ä»¶å­˜å‚¨ç©ºé—´ã€‚å¯¹äºç‰©ç†å†…å­˜çš„è®¿é—®ï¼Œæ— è®ºä¸­é—´ä¼šç»è¿‡å¤šå°‘æ¬¡è½¬æ¢ï¼Œæœ€ç»ˆå¿…é¡»è½¬æ¢ä¸ºæœ€ç»ˆçš„ç‰©ç†åœ°å€è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é€»è¾‘åœ°å€(Logical Address)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;åœ¨80386ä¿æŠ¤æ¨¡å¼çš„ç¨‹åºæŒ‡ä»¤ä¸­ï¼Œå¯¹å†…å­˜çš„è®¿é—®æ˜¯ç”±æ®µé€‰æ‹©å­å’Œæ®µå†…åç§»å†³å®šçš„ã€‚&lt;strong&gt;æ®µé€‰æ‹©å­+æ®µå†…åç§» --&amp;gt; é€»è¾‘åœ°å€ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çº¿æ€§åœ°å€(Linear Address)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;CPUåœ¨å†…å­˜å¯»å€æ—¶ï¼Œä»æŒ‡ä»¤ä¸­è·å¾—æ®µé€‰æ‹©å­å’Œæ®µå†…åç§»ï¼Œå³é€»è¾‘åœ°å€ã€‚ç”±æ®µé€‰æ‹©å­åœ¨æ®µè¡¨(GDTæˆ–LDT)ä¸­æ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦ï¼Œè·å–æ®µåŸºå€ã€‚&lt;strong&gt;æ®µåŸºå€+æ®µå†…åç§»å†³å®šçº¿æ€§åœ°å€ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¦‚æœæ²¡æœ‰å¼€å¯åˆ†é¡µï¼ŒCPUå°±ä½¿ç”¨ç”Ÿæˆçš„çº¿æ€§åœ°å€ç›´æ¥ä½œä¸ºæœ€ç»ˆçš„ç‰©ç†åœ°å€è¿›è¡Œè®¿é—®ï¼›å¦‚æœå¼€å¯äº†åˆ†é¡µï¼Œåˆ™è¿˜éœ€è¦é€šè¿‡é¡µè¡¨ç­‰æœºåˆ¶ï¼Œå°†çº¿æ€§åœ°å€è¿›ä¸€æ­¥å¤„ç†æ‰èƒ½ç”Ÿæˆç‰©ç†åœ°å€è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;h2&gt;é¡µå¼è™šæ‹Ÿå†…å­˜å®ç°åŸç†&lt;/h2&gt;
&lt;p&gt;ã€€ã€€ç¨‹åºè¦æ±‚è®¿é—®ä¸€ä¸ªæ®µæ—¶ï¼Œå…¶çº¿æ€§åœ°å€å¿…é¡»æ˜¯è¿ç»­çš„ã€‚åœ¨çº¯ç²¹çš„æ®µå¼å†…å­˜ç®¡ç†ä¸­ï¼Œçº¿æ€§åœ°å€ç­‰äºç‰©ç†åœ°å€çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šå‡ºç°å¤–ç¢ç‰‡çš„é—®é¢˜ã€‚è€Œåœ¨æ®µå¼å†…å­˜ç®¡ç†çš„åŸºç¡€ä¸Šï¼Œ80386å¦‚æœè¿˜å¼€å¯äº†é¡µæœºåˆ¶ï¼Œå°±èƒ½&lt;strong&gt;é€šè¿‡æŠ½è±¡å‡ºä¸€å±‚çº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ï¼Œä½¿å¾—æœ€ç»ˆåˆ†é…ç»™ç¨‹åºçš„ç‰©ç†å†…å­˜æ®µä¸å¿…è¿ç»­ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€80386ä¸­çš„å†…å­˜é¡µå¤§å°ä¸º4KBï¼Œåœ¨32ä½çš„å†…å­˜å¯»å€ç©ºé—´ä¸­(4GB)ï¼Œå­˜åœ¨ç€0x10000 = 1048576ä¸ªé¡µã€‚æ¯ä¸ªé¡µå¯¹åº”çš„èµ·å§‹åœ°å€ä½12ä½éƒ½ä¸º0ï¼Œç¬¬ä¸€ä¸ªç‰©ç†å†…å­˜é¡µçš„ç‰©ç†åœ°å€ä¸º0x00000000ï¼Œç¬¬äºŒä¸ªç‰©ç†å†…å­˜é¡µçš„ç‰©ç†åœ°å€ä¸º0x00001000ï¼Œä¾æ­¤ç±»æ¨ï¼Œæœ€åä¸€ä¸ªç‰©ç†é¡µçš„ç‰©ç†åœ°å€æ˜¯0xFFFFF000ã€‚&lt;/p&gt;
&lt;h2&gt;é¡µè¡¨&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;åœ¨80386çš„åˆ†é¡µæœºåˆ¶çš„å®ç°ä¸­ï¼Œæ˜¯é€šè¿‡é¡µè¡¨æ¥å®ç°çº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€æ˜ å°„è½¬æ¢çš„ã€‚&lt;strong&gt;æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„é¡µè¡¨&lt;/strong&gt;ï¼Œ&lt;strong&gt;è®°å½•ç€ä»»åŠ¡çš„çº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;å¼€å¯äº†é¡µæœºåˆ¶åçš„çº¿æ€§åœ°å€ä¹Ÿè¢«ç§°ä¸ºè™šæ‹Ÿåœ°å€&lt;/strong&gt;ï¼Œè¿™æ˜¯å› ä¸ºçº¿æ€§åœ°å€å·²ç»ä¸å†ç›´æ¥å¯¹åº”çœŸå®çš„ç‰©ç†åœ°å€ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸æ‰¿è½½çœŸå®æ•°æ®çš„è™šæ‹Ÿå†…å­˜åœ°å€ã€‚&lt;strong&gt;å¼€å¯äº†åˆ†é¡µæœºåˆ¶åï¼Œä¸€ä¸ªä»»åŠ¡çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¾ç„¶æ˜¯è¿ç»­çš„ï¼Œä½†&lt;/strong&gt;æ‰€å ç”¨çš„ç‰©ç†åœ°å€ç©ºé—´å´å¯ä»¥ä¸è¿ç»­ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€é¡µè¡¨ä¿å­˜ç€è¢«ç§°ä¸º&lt;strong&gt;é¡µè¡¨é¡¹&lt;/strong&gt;çš„æ•°æ®ç»“æ„é›†åˆï¼Œæ¯ä¸€ä¸ªé¡µè¡¨é¡¹éƒ½è®°è½½ç€ä¸€ä¸ªè™šæ‹Ÿå†…å­˜é¡µåˆ°ç‰©ç†å†…å­˜é¡µçš„æ˜ å°„å…³ç³»ã€‚å¼€å¯äº†é¡µæœºåˆ¶ä¹‹åï¼ŒCPUåœ¨å†…å­˜å¯»å€æ—¶ï¼Œåœ¨é€šè¿‡æ®µè¡¨è®¡ç®—å‡ºäº†çº¿æ€§åœ°å€(è™šæ‹Ÿåœ°å€)åï¼Œä¾¿å¯ä»¥åœ¨è¿ç»­æ’å¸ƒçš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æ‰¾åˆ°å¯¹åº”çš„é¡µè¡¨é¡¹ï¼Œé€šè¿‡é¡µè¡¨é¡¹è·å–è™šæ‹Ÿå†…å­˜é¡µæ‰€å¯¹åº”çš„ç‰©ç†å†…å­˜é¡µåœ°å€ï¼Œè¿›è¡Œç‰©ç†å†…å­˜çš„è®¿é—®ã€‚è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€æ˜ å°„çš„ç»†èŠ‚ä¼šåœ¨åé¢è¿›è¡Œå±•å¼€ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç”±äºæ˜¯å°†ä¸æ–­å˜åŒ–çš„è™šæ‹Ÿå†…å­˜é¡µè£…è½½è¿›ç›¸å¯¹ä¸å˜çš„ç‰©ç†å†…å­˜é¡µä¸­ï¼Œå°±åƒç”»å»Šä¸­å±•ç¤ºçš„ç”»ä¼šä¸æ–­çš„æ›´æ›¿ï¼Œä½†ç”»æ¡†åŸºæœ¬ä¸å˜ä¸€æ ·ã€‚ä¸ºäº†æ›´å¥½çš„åŒºåˆ†è¿™ä¸¤è€…ï¼Œ&lt;strong&gt;é¡µé€šå¸¸ç‰¹æŒ‡è™šæ‹Ÿå†…å­˜é¡µï¼Œè€Œç‰©ç†å†…å­˜é¡µåˆ™è¢«ç§°ä¸ºé¡µæ¡†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;é¡µè¡¨é¡¹ä»‹ç»&lt;/h3&gt;
&lt;p&gt;ã€€ã€€é¡µè¡¨é¡¹æ˜¯32ä½çš„ï¼Œå…¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;img src=&quot;https://img2020.cnblogs.com/blog/1506329/202006/1506329-20200613214426851-1944434721.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€P&lt;/strong&gt;(&lt;strong&gt;Present&lt;/strong&gt;)&lt;strong&gt;ä½&lt;/strong&gt;ï¼Œå­˜åœ¨ä½ã€‚æ ‡è¯†å½“å‰è™šæ‹Ÿå†…å­˜é¡µæ˜¯å¦å­˜åœ¨äºç‰©ç†å†…å­˜é¡µä¸­ã€‚å½“Pä½ä¸º1æ—¶ï¼Œè¡¨ç¤ºå½“å‰è™šæ‹Ÿå†…å­˜é¡µå­˜åœ¨äºç‰©ç†å†…å­˜ä¸­ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œè®¿é—®ã€‚å½“Pä½ä¸º0æ—¶ï¼Œè¡¨ç¤ºå¯¹åº”çš„ç‰©ç†å†…å­˜é¡µä¸å­˜åœ¨ï¼Œéœ€è¦æ–°åˆ†é…ç‰©ç†å†…å­˜é¡µæˆ–æ˜¯ä»ç£ç›˜ä¸­å°†å…¶è°ƒåº¦å›ç‰©ç†å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€åˆ†é¡µæ¨¡å¼ä¸‹çš„å†…å­˜å¯»å€ï¼Œå¦‚æœCPUå‘ç°å¯¹åº”çš„é¡µè¡¨é¡¹Pä½ä¸º0ï¼Œä¼šå¼•å‘ç¼ºé¡µå¼‚å¸¸ä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿåœ¨ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºä¸­è¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼Œä»¥å®ç°è™šæ‹Ÿå†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;RWä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€RW(Read/Write)ä½ï¼Œè¯»å†™ä½ã€‚&lt;/strong&gt;æ ‡è¯†å½“å‰é¡µæ˜¯å¦èƒ½å¤Ÿå†™å…¥ã€‚å½“RWä¸º1æ—¶ï¼Œä»£è¡¨å½“å‰é¡µå¯è¯»å¯å†™ï¼›å½“RWä¸º0æ—¶ï¼Œä»£è¡¨å½“å‰é¡µæ˜¯åªè¯»çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;USä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€US(User/Supervisor)ä½ï¼Œç”¨æˆ·/ç®¡ç†ä½&lt;/strong&gt;ã€‚å½“USä¸º1æ—¶ï¼Œæ ‡è¯†å½“å‰é¡µæ˜¯ç”¨æˆ·çº§åˆ«çš„ï¼Œå…è®¸æ‰€æœ‰å½“å‰ç‰¹æƒçº§çš„ä»»åŠ¡è¿›è¡Œè®¿é—®ã€‚å½“USä¸º0æ—¶ï¼Œè¡¨ç¤ºå½“å‰é¡µæ˜¯å±äºç®¡ç†å‘˜çº§åˆ«çš„ï¼Œåªå…è®¸å½“å‰ç‰¹æƒçº§ä¸º0ã€1ã€2çš„ä»»åŠ¡è¿›è¡Œè®¿é—®ï¼Œè€Œå½“å‰ç‰¹æƒçº§ä¸º3çš„ç”¨æˆ·æ€ä»»åŠ¡æ— æ³•è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PWTä½/PCDä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€PWT(Page-level Write Through)ä½ï¼Œé¡µçº§é€šå†™ä½ã€‚&lt;/strong&gt;PWTä¸º1æ—¶ï¼Œè¡¨ç¤ºå½“å‰ç‰©ç†é¡µçš„é«˜é€Ÿç¼“å­˜é‡‡ç”¨é€šå†™æ³•ï¼›PWTä¸º0æ—¶ï¼Œè¡¨ç¤ºå½“å‰ç‰©ç†é¡µçš„é«˜é€Ÿç¼“å­˜é‡‡ç”¨å›å†™æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€PCD(Page-level Cache Disable)ä½ï¼Œé¡µçº§é«˜é€Ÿç¼“å­˜ç¦æ­¢ä½ã€‚&lt;/strong&gt;PCDä¸º1æ—¶ï¼Œè¡¨ç¤ºè®¿é—®å½“å‰ç‰©ç†é¡µç¦ç”¨é«˜é€Ÿç¼“å­˜ï¼›PCDä¸º0æ—¶ï¼Œè¡¨ç¤ºè®¿é—®å½“å‰ç‰©ç†é¡µæ—¶å…è®¸ä½¿ç”¨é«˜é€Ÿç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;PWTä¸PCDä½çš„ä½¿ç”¨ï¼Œæ¶‰åŠåˆ°äº†80386é«˜é€Ÿç¼“å­˜çš„å·¥ä½œåŸç†ä¸å†…å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Œé™äºç¯‡å¹…ä¸åœ¨è¿™é‡Œå±•å¼€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Aä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€A(Access)ä½ï¼Œè®¿é—®ä½ã€‚&lt;/strong&gt;Aä½ä¸º1æ—¶ï¼Œä»£è¡¨å½“å‰é¡µæ›¾ç»è¢«è®¿é—®è¿‡ï¼›Aä½ä¸º0æ—¶ï¼Œä»£è¡¨å½“å‰é¡µæ²¡æœ‰è¢«è®¿é—®è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€Aä½çš„è®¾ç½®ç”±CPUå›ºä»¶åœ¨å¯¹åº”å†…å­˜é¡µè®¿é—®æ—¶è‡ªåŠ¨è®¾ç½®ä¸º1ï¼Œä¸”å¯ä»¥ç”±æ“ä½œç³»ç»Ÿåœ¨é€‚å½“çš„æ—¶å€™é€šè¿‡ç¨‹åºæŒ‡ä»¤é‡ç½®ä¸º0ï¼Œç”¨ä»¥è®¡ç®—å†…å­˜é¡µçš„è®¿é—®é¢‘ç‡ã€‚é€šè¿‡è®¿é—®é¢‘ç‡ï¼Œæ“ä½œç³»ç»Ÿèƒ½å¤Ÿä»¥æ­¤ä½œä¸ºè™šæ‹Ÿå†…å­˜è°ƒåº¦ç®—æ³•ä¸­è¯„ä¼°çš„ä¾æ®ï¼Œåœ¨ç‰©ç†å†…å­˜ç´§å¼ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©å°†æœ€å°‘ä½¿ç”¨çš„å†…å­˜é¡µæ¢å‡ºï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„è™šæ‹Ÿå†…å­˜é¡µè°ƒåº¦æ—¶çš„ç£ç›˜I/Oï¼Œæé«˜è™šæ‹Ÿå†…å­˜çš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€D(Dirty)ä½ï¼Œè„ä½ã€‚&lt;/strong&gt;å½“Dä½ä¸º1æ—¶ï¼Œè¡¨ç¤ºå½“å‰é¡µè¢«å†™å…¥ä¿®æ”¹è¿‡ï¼›Dä½ä¸º0æ—¶ï¼Œä»£è¡¨å½“å‰é¡µæ²¡æœ‰è¢«å†™å…¥ä¿®æ”¹è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è„ä½ç”±CPUåœ¨å¯¹åº”å†…å­˜é¡µè¢«å†™å…¥æ—¶è‡ªåŠ¨è®¾ç½®ä¸º1ã€‚æ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œå†…å­˜é¡µè°ƒåº¦æ—¶ï¼Œå¦‚æœå‘ç°éœ€è¦è¢«æ¢å‡ºçš„å†…å­˜é¡µDä½ä¸º1æ—¶ï¼Œåˆ™éœ€è¦å°†å¯¹åº”ç‰©ç†å†…å­˜é¡µæ•°æ®å†™å›è™šæ‹Ÿé¡µå¯¹åº”çš„ç£ç›˜äº¤æ¢åŒºï¼Œä¿è¯ç£ç›˜/å†…å­˜æ•°æ®çš„ä¸€è‡´æ€§ï¼›å½“å‘ç°éœ€è¦è¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜é¡µçš„Dä½ä¸º0æ—¶ï¼Œè¡¨ç¤ºå½“å‰é¡µè‡ªä»æ¢å…¥ç‰©ç†å†…å­˜ä»¥æ¥æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œå’Œç£ç›˜äº¤æ¢åŒºä¸­çš„æ•°æ®ä¸€è‡´ï¼Œä¾¿ç›´æ¥å°†å…¶è¦†ç›–ï¼Œè€Œä¸è¿›è¡Œç£ç›˜çš„å†™å›ï¼Œå‡å°‘ä¸å¿…è¦çš„I/Oä»¥æé«˜æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PATä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€PAT(Page Attribute Table)ï¼Œé¡µå±æ€§è¡¨æ”¯æŒä½ã€‚&lt;/strong&gt;PATä½çš„å­˜åœ¨ä½¿å¾—CPUèƒ½å¤Ÿæ”¯æŒæ›´å¤æ‚çš„ï¼Œä¸åŒé¡µå¤§å°çš„åˆ†é¡µç®¡ç†ã€‚å½“PAT=0æ—¶ï¼Œæ¯ä¸€é¡µçš„å¤§å°ä¸º4KBï¼›å½“PAT=1æ—¶ï¼Œæ¯ä¸€é¡µçš„å¤§å°æ˜¯4MBï¼Œæˆ–æ˜¯å…¶å®ƒå¤§å°(åˆ†CPUçš„æƒ…å†µè€Œå®š)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Gä½:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€G(Global)ï¼Œå…¨å±€ä½ã€‚&lt;/strong&gt;è¡¨ç¤ºå½“å‰é¡µæ˜¯å¦æ˜¯å…¨å±€çš„ï¼Œè€Œä¸æ˜¯å±äºæŸä¸€ç‰¹å®šä»»åŠ¡çš„ã€‚G=1æ—¶ï¼Œè¡¨ç¤ºå½“å‰é¡µæ˜¯å…¨å±€çš„ï¼›G=0æ—¶ï¼Œè¡¨ç¤ºå½“å‰é¡µæ˜¯å±äºç‰¹å®šä»»åŠ¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸ºäº†åŠ é€Ÿé¡µè¡¨é¡¹çš„è®¿é—®ï¼Œ80386æä¾›äº†TLBå¿«è¡¨ï¼Œä½œä¸ºé¡µè¡¨è®¿é—®çš„é«˜é€Ÿç¼“å­˜ã€‚å½“ä»»åŠ¡åˆ‡æ¢æ—¶ï¼ŒTLBå†…æ‰€æœ‰G=0çš„éå…¨å±€é¡µå°†ä¼šè¢«æ¸…é™¤ï¼ŒG=1çš„å…¨å±€é¡µå°†ä¼šè¢«ä¿ç•™ã€‚å°†æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­å…³é”®çš„ï¼Œé¢‘ç¹è®¿é—®çš„é¡µè®¾ç½®ä¸ºå…¨å±€é¡µï¼Œä½¿å¾—å…¶èƒ½å¤Ÿä¸€ç›´ä¿å­˜åœ¨TLBå¿«è¡¨ä¸­ï¼ŒåŠ é€Ÿå¯¹å…¶çš„è®¿é—®é€Ÿåº¦ï¼Œæé«˜æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;AVLä½ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€AVL(Avaliable)ï¼Œå¯ç”¨ä½ã€‚&lt;/strong&gt;å’Œæ®µæè¿°ç¬¦ä¸­çš„AVLä½åŠŸèƒ½ç±»ä¼¼ï¼ŒCPUå¹¶ä¸ä½¿ç”¨å®ƒï¼Œè€Œæ˜¯æä¾›ç»™æ“ä½œç³»ç»Ÿè½¯ä»¶è‡ªå®šä¹‰ä½¿ç”¨ã€‚&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é¡µç‰©ç†åŸºåœ°å€å­—æ®µï¼šã€€ã€€&lt;/strong&gt; ã€€ã€€&lt;/p&gt;
&lt;p&gt;ã€€ã€€é¡µç‰©ç†åŸºåœ°å€å­—æ®µç”¨äºæ ‡è¯†å¯¹åº”çš„ç‰©ç†é¡µï¼Œå…±20ä½ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç”±äº32ä½çš„80386çš„é¡µæœ€å°æ˜¯4KBï¼Œè€Œ4GBçš„ç‰©ç†å†…å­˜è¢«åˆ†è§£ä¸ºäº†æœ€å¤š0x10000ä¸ª4KBçš„ç‰©ç†é¡µã€‚20ä½çš„é¡µç‰©ç†åŸºåœ°å€å­—æ®µä½œä¸ºç‰©ç†é¡µçš„ç´¢å¼•æ ‡å·ä¸æ¯ä¸€ä¸ªå…·ä½“çš„ç‰©ç†é¡µä¸€ä¸€å¯¹åº”ã€‚é€šè¿‡é¡µç‰©ç†åŸºåœ°å€å­—æ®µï¼Œä¾¿èƒ½æ‰¾åˆ°å”¯ä¸€å¯¹åº”çš„ç‰©ç†å†…å­˜é¡µã€‚&lt;/p&gt;
&lt;h2&gt;å¤šçº§é¡µè¡¨&lt;/h2&gt;
&lt;p&gt;ã€€ã€€åœ¨32ä½çš„CPUä¸­ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ç»™æ¯ä¸ªç¨‹åºåˆ†é…è‡³å¤š4GBçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œå¦‚æœä¸€ä¸ªå†…å­˜é¡µå 4KBï¼Œé‚£ä¹ˆå¯¹åº”çš„æ¯ä¸ªç¨‹åºçš„é¡µè¡¨ä¸­æœ€å¤šéœ€è¦å­˜æ”¾ç€0x10000ä¸ªé¡µè¡¨é¡¹æ¥è¿›è¡Œæ˜ å°„ã€‚å³ä½¿æ¯ä¸ªé¡µè¡¨é¡¹åªå å°å°çš„32ä½å…±4ä¸ªå­—èŠ‚(4Byte)ï¼Œè¿™ä¾ç„¶æ˜¯ä¸€ä¸ªä¸å°çš„å†…å­˜å¼€é”€(0x10000ä¸ªé¡µè¡¨é¡¹çš„å¤§å°ä¸º4MB)ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸€ä¸ªåº”ç”¨ç¨‹åºè™½ç„¶å¯ä»¥è¢«åˆ†é…4GBçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œä½†å®é™…ä¸Šå¯èƒ½åªä½¿ç”¨å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œä¾‹å¦‚40MBçš„å¤§å°ã€‚é€šå¸¸ç¨‹åºçš„å †æ ˆæ®µå’Œæ•°æ®æ®µéƒ½åˆ†åˆ«ä½äºè™šæ‹Ÿå†…å­˜ç©ºé—´çš„é«˜ä½ä¸¤ç«¯ï¼Œå¹¶éšç€ç¨‹åºçš„æ‰§è¡Œæ…¢æ…¢çš„å‘ä¸­é—´æ‰©å±•ï¼Œç”±äºé¡µè¡¨é¡¹å¯¹åº”ä¸è™šæ‹Ÿåœ°å€ç©ºé—´çš„è¿ç»­æ€§ï¼Œè¿™å°±è¦æ±‚ä»»åŠ¡åœ¨æ‰§è¡Œæ—¶å¿…é¡»å®Œæ•´çš„å®šä¹‰æ•´å¼ é¡µè¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¯ä»¥çœ‹åˆ°ï¼Œ&lt;strong&gt;ä¸€çº§çš„å¹³é¢é¡µè¡¨ç»“æ„å­˜åœ¨ç€æ˜æ˜¾çš„é¡µè¡¨ç©ºé—´æµªè´¹çš„é—®é¢˜ã€‚&lt;/strong&gt;è™½ç„¶å¯ä»¥è¦æ±‚åº”ç”¨ç¨‹åºä¸è¦ä¸€ä¸‹å­å°±ä»¥4GBçš„å†…å­˜è§„æ ¼è¿›è¡Œç¼–ç¨‹ï¼Œè€Œæ˜¯ä¸€å¼€å§‹ç”¨è¾ƒå°çš„å†…å­˜ï¼Œå¹¶åœ¨éœ€è¦æ›´å¤§å†…å­˜æ—¶æ¢¯åº¦çš„ç”³è¯·æ›´å¤§çš„å†…å­˜ç©ºé—´ï¼Œå¹¶é‡æ–°æ„é€ æ•°æ®æ®µå’Œå †æ ˆæ®µä»¥å‡å°‘æ¯ä¸ªä»»åŠ¡çš„æ— ç”¨é¡µè¡¨é¡¹ç©ºé—´çš„æµªè´¹ã€‚ä½†è¿™å°†é¡µè¡¨ç©ºé—´ä¼˜åŒ–çš„ç¹é‡ä»»åŠ¡å¼ºåŠ ç»™äº†åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è§£å†³åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä¸ºæ­¤ï¼Œè®¡ç®—æœºç§‘å­¦å®¶ä»¬æå‡ºäº†&lt;strong&gt;å¤šçº§é¡µè¡¨çš„æ–¹æ¡ˆæ¥è§£å†³é¡µè¡¨é¡¹è¿‡å¤šçš„é—®é¢˜&lt;/strong&gt;ã€‚å¤šçº§é¡µè¡¨é¡¾åæ€ä¹‰ï¼Œé¡µè¡¨çš„ç»“æ„ä¸å†æ˜¯ä¸€ä¸ªä¸€çº§çš„å¹³é¢ç»“æ„(ä¸€çº§é¡µè¡¨)ï¼Œè€Œæ˜¯åƒä¸€é¢—æ ‘ä¸€æ ·ï¼Œç”±&lt;strong&gt;é¡µç›®å½•é¡¹èŠ‚ç‚¹&lt;/strong&gt;å’Œ&lt;strong&gt;é¡µè¡¨é¡¹èŠ‚ç‚¹&lt;/strong&gt;ç»„æˆã€‚ç›®å½•èŠ‚ç‚¹ä¸­ä¿å­˜ç€ä¸‹ä¸€çº§èŠ‚ç‚¹çš„ç‰©ç†é¡µåœ°å€ç­‰ä¿¡æ¯ï¼Œå¶å­èŠ‚ç‚¹ä¸­åˆ™åŒ…å«ç€çœŸæ­£çš„é¡µè¡¨é¡¹ä¿¡æ¯ã€‚æŸ¥è¯¢é¡µè¡¨é¡¹æ—¶ï¼Œä»ä¸€çº§é¡µç›®å½•èŠ‚ç‚¹(æ ¹ç›®å½•)å‡ºå‘ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ä¸‹ä¸€çº§å­ç›®å½•èŠ‚ç‚¹ï¼Œç›´åˆ°æŸ¥è¯¢å‡ºå¯¹åº”çš„å¶å­èŠ‚ç‚¹ä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;img src=&quot;https://img2020.cnblogs.com/blog/1506329/202006/1506329-20200615000824118-1327835411.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;80386é¡µç›®å½•é¡¹ä»‹ç»&lt;/h3&gt;
&lt;p&gt;ã€€ã€€&lt;span&gt;80386é‡‡ç”¨çš„æ˜¯äºŒçº§é¡µè¡¨çš„è®¾è®¡ï¼ŒäºŒçº§é¡µè¡¨ç”±é¡µç›®å½•è¡¨å’Œé¡µè¡¨å…±åŒç»„æˆã€‚&lt;strong&gt;é¡µç›®å½•è¡¨ä¸­å­˜æ”¾çš„æ˜¯é¡µç›®å½•é¡¹ï¼Œ&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;é¡µç›®å½•é¡¹çš„å¤§å°å’Œé¡µè¡¨é¡¹ä¸€è‡´ï¼Œä¸º4å­—èŠ‚ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€é€šè¿‡80386æŒ‡ä»¤å¾—åˆ°çš„32ä½çº¿æ€§åœ°å€ï¼Œå…¶ä¸­é«˜20ä½ä½œä¸ºé¡µè¡¨é¡¹ç´¢å¼•ï¼Œä½12ä½ä½œä¸ºé¡µå†…åç§»åœ°å€(4KBå¤§å°çš„ç‰©ç†é¡µ)ã€‚å¦‚æœé‡‡ç”¨çš„æ˜¯ä¸€çº§é¡µè¡¨ç»“æ„ï¼Œ20ä½çš„é¡µè¡¨é¡¹ç´¢å¼•èƒ½ç›´æ¥æ‰¾åˆ°4MBé¡µè¡¨ä¸­çš„å¯¹åº”é¡µè¡¨é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è€Œå¯¹äº80386äºŒçº§é¡µè¡¨çš„è®¾è®¡æ¥è¯´ï¼Œ&lt;strong&gt;ç”±äºä¸€ä¸ªç‰©ç†é¡µå¤§å°ä¸º4KBï¼Œæœ€å¤šå¯ä»¥å®¹çº³1024(2^10)ä¸ªé¡µè¡¨é¡¹æˆ–è€…é¡µç›®å½•é¡¹&lt;/strong&gt;ï¼Œæ‰€ä»¥å°†é¡µè¡¨é¡¹ç´¢å¼•çš„é«˜10ä½ä½œä¸ºæ ¹ç›®å½•é¡µä¸­é¡µç›®å½•é¡¹çš„ç´¢å¼•å€¼ï¼Œé€šè¿‡é¡µç›®å½•é¡¹ä¸­çš„é¡µè¡¨é¡¹ç‰©ç†é¡µå·å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„é¡µè¡¨ç‰©ç†é¡µï¼›å†æ ¹æ®é¡µè¡¨é¡¹ç´¢å¼•çš„å10ä½æ‰¾åˆ°é¡µè¡¨ä¸­å¯¹åº”çš„é¡µè¡¨é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;img src=&quot;https://img2020.cnblogs.com/blog/1506329/202006/1506329-20200615003331305-327649121.png&quot; alt=&quot;&quot; width=&quot;1024&quot; height=&quot;508&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;80386é¡µç›®å½•é¡¹ç»“æ„å›¾&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Â ã€€ã€€80386çš„äºŒçº§é¡µè¡¨çš„é¡µç›®å½•é¡¹å 32ä½ï¼Œå…¶ä½12ä½çš„å«ä¹‰ä¸é¡µè¡¨é¡¹ä¸€è‡´ã€‚ä¸»è¦åŒºåˆ«åœ¨äºå…¶é«˜20ä½å­˜æ”¾çš„æ˜¯ä¸‹ä¸€çº§é¡µè¡¨çš„ç‰©ç†é¡µç´¢å¼•ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿåœ°å€æ˜ å°„çš„ç‰©ç†å†…å­˜é¡µåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;img src=&quot;https://img2020.cnblogs.com/blog/1506329/202006/1506329-20200615003450236-715712375.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3&gt;&lt;strong&gt;é¡µè¡¨åŸºå€å¯„å­˜å™¨&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;å‰é¢æåˆ°è¿‡ï¼Œå’ŒLDTä¸€æ ·ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æ‹¥æœ‰ç€è‡ªå·±ç‹¬ç«‹çš„é¡µè¡¨ã€‚ä¸ºæ­¤80386CPUæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„å¯„å­˜å™¨ç”¨äºè¿½è¸ªå®šä½ä»»åŠ¡è‡ªå·±çš„é¡µè¡¨ï¼Œè¿™ä¸ªå¯„å­˜å™¨çš„åç§°å«åšé¡µè¡¨åŸºå€å¯„å­˜å™¨(&lt;strong&gt;Page Directory Base Registerï¼ŒPDBR&lt;/strong&gt;)ï¼Œä¹Ÿå°±æ˜¯æ§åˆ¶å¯„å­˜å™¨CR3ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç”±äº80386åˆ†é¡µæœºåˆ¶ä½¿ç”¨çš„æ˜¯äºŒçº§é¡µè¡¨ï¼Œå› æ­¤PDBRæŒ‡å‘çš„æ˜¯äºŒçº§é¡µè¡¨ç»“æ„ä¸­çš„é¡µç›®å½•ï¼Œé€šè¿‡é¡µç›®å½•è¡¨ä¾¿èƒ½å¤Ÿé—´æ¥çš„è®¿é—®æ•´ä¸ªäºŒçº§é¡µè¡¨ã€‚ä¸ºäº†æ•ˆç‡å…¶ä¸­å­˜æ”¾çš„ç›´æ¥å°±æ˜¯é¡µç›®å½•è¡¨çš„32ä½ç‰©ç†åœ°å€ï¼Œä¸€èˆ¬ç”±æ“ä½œç³»ç»Ÿè´Ÿè´£åœ¨ä»»åŠ¡åˆ‡æ¢æ—¶å°†æ–°ä»»åŠ¡å¯¹åº”çš„é¡µç›®å½•è¡¨é¢„å…ˆåŠ è½½è¿›ç‰©ç†å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€ç”±äºPDBRæ˜¯å’Œå½“å‰ä»»åŠ¡æœ‰å…³çš„ï¼Œåœ¨ä»»åŠ¡åˆ‡æ¢æ—¶ä¼šè¢«æ–°ä»»åŠ¡TSSä¸­çš„PDBRå­—æ®µå€¼æ‰€æ›¿æ¢ï¼ŒæŒ‡å‘æ–°ä»»åŠ¡çš„é¡µç›®å½•è¡¨ï¼Œè€Œæ—§ä»»åŠ¡çš„PDBRçš„å€¼åˆ™åœ¨ä¿æŠ¤ç°åœºæ—¶è¢«å­˜å…¥å¯¹åº”çš„TSSä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤šçº§é¡µè¡¨æ˜¯å¦‚ä½•è§£å†³é¡µè¡¨é¡¹æµªè´¹é—®é¢˜çš„ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€ä»¥80386çš„äºŒçº§é¡µè¡¨è®¾è®¡ä¸ºä¾‹ï¼Œæœ€å¤§4GBçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸‹ï¼Œæ— è®ºå¦‚ä½•ä¸€çº§é¡µç›®å½•è¡¨æ˜¯å¿…é¡»å­˜åœ¨çš„ã€‚å½“ä¸éœ€è¦ä¸ºåº”ç”¨ç¨‹åºåˆ†é…è¿‡å¤šçš„å†…å­˜æ—¶ï¼Œé¡µç›®å½•è¡¨ä¸­çš„é¡µç›®å½•é¡¹æ‰€æŒ‡å‘çš„å¯¹åº”é¡µè¡¨å¯ä»¥ä¸å­˜åœ¨ï¼Œå³é¡µç›®å½•é¡¹çš„Pä½ä¸º0ï¼Œå®é™…ä¸ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜ç©ºé—´å°†æ²¡æœ‰å¯¹åº”çš„äºŒçº§é¡µè¡¨èŠ‚ç‚¹ï¼Œç›¸æ¯”ä¸€çº§é¡µè¡¨çš„è®¾è®¡å…¶æµªè´¹çš„å†…å­˜ä¼šå°‘å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å‡è®¾éœ€è¦ä¸ºä¸€ä¸ªè™šæ‹Ÿåœ°å€é¦–å°¾å„éœ€è¦åˆ†é…20MBï¼Œå…±å ç”¨40MBå†…å­˜çš„ä»»åŠ¡æ„å»ºå¯¹åº”çš„é¡µè¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€1. å¦‚æœä½¿ç”¨ä¸€çº§é¡µè¡¨ï¼Œ4GBçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸‹éœ€è¦æä¾›0x10000ä¸ªé¡µè¡¨é¡¹ï¼Œå…±4MBï¼Œé¡µè¡¨çš„ä½“ç§¯è¾¾åˆ°äº†ä»»åŠ¡è‡ªèº«æ‰€éœ€40MBå†…å­˜çš„10%ï¼Œä½†å…¶ä¸­ç»å¤§å¤šæ•°çš„é¡µè¡¨é¡¹éƒ½æ˜¯æ²¡ç”¨çš„(Pä½ä¸º0)ï¼Œä¸ä¼šå¯¹åº”å®é™…çš„ç‰©ç†å†…å­˜ï¼Œç©ºé—´æ•ˆç‡å¾ˆä½ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€2. å¦‚æœä½¿ç”¨äºŒçº§é¡µè¡¨ï¼Œé™¤äº†å ä¸€ä¸ªç‰©ç†é¡µ4KBå¤§å°çš„é¡µç›®å½•è¡¨æ˜¯å¿…é¡»å­˜åœ¨çš„å¤–ï¼Œå…¶é¡µç›®å½•è¡¨ä¸­åªæœ‰é¦–å°¾ä¸¤é¡¹çš„Pä½ä¸º1ï¼Œåˆ†åˆ«æŒ‡å‘ä¸€ä¸ªå®é™…å­˜åœ¨çš„é¡µè¡¨(äºŒçº§èŠ‚ç‚¹)ï¼Œé¡µç›®å½•è¡¨ä¸­é—´å…¶å®ƒçš„é¡µç›®å½•é¡¹Pä½éƒ½ä¸º0ï¼Œä¸éœ€è¦ä¸ºè¿™äº›ä¸ä¼šä½¿ç”¨åˆ°çš„è™šæ‹Ÿåœ°å€åˆ†é…é¡µè¡¨ã€‚å¯¹äºè¿™ä¸ª40MBçš„ç¨‹åºæ¥è¯´ï¼Œå…¶é¡µè¡¨åªå äº†3ä¸ªç‰©ç†é¡µé¢ï¼Œå…±12KBï¼Œç©ºé—´æ•ˆç‡ç›¸æ¯”ä¸€çº§é¡µè¡¨é«˜å¾ˆå¤šã€‚&lt;/p&gt;
&lt;h2&gt;TLBå¿«è¡¨&lt;/h2&gt;
&lt;p&gt;ã€€ã€€å‰é¢æåˆ°äº†å¤šçº§é¡µè¡¨æ‰€å¸¦æ¥çš„å¥½å¤„ï¼šé€šè¿‡é¡µè¡¨åˆ†å±‚ï¼Œå¯ä»¥å‡å°‘é¡ºåºæ’åˆ—çš„æ— æ•ˆé¡µè¡¨é¡¹æ•°é‡ï¼ŒèŠ‚çº¦å†…å­˜ç©ºé—´ï¼›é¡µè¡¨çš„å±‚çº§è¶Šå¤šï¼Œç©ºé—´æ•ˆç‡ä¹Ÿè¶Šé«˜ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€è®¡ç®—æœºé¢†åŸŸä¸­ï¼Œé€šå¸¸å¹¶æ²¡æœ‰å…è´¹çš„åˆé¤ï¼Œä¸€ä¸ªé—®é¢˜çš„è§£å†³ï¼Œå¾€å¾€ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ï¼š&lt;strong&gt;å¤šçº§é¡µè¡¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹é¡µéƒ½æ˜¯ç¦»æ•£çš„ï¼Œå› æ­¤æ¯ä¸€å±‚çº§è®¿é—®éƒ½éœ€è¦è¿›è¡Œä¸€æ¬¡å†…å­˜å¯»å€æ“ä½œï¼Œé¡µè¡¨çš„å±‚çº§è¶Šå¤šï¼Œè®¿é—®çš„æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œè™šæ‹Ÿé¡µåœ°å€æ˜ å°„è¿‡ç¨‹ä¹Ÿè¶Šæ…¢ã€‚&lt;/strong&gt;åœ¨32ä½çš„80386ä¸­ï¼Œ2çº§é¡µè¡¨ä¸‹é—®é¢˜è¿˜ä¸ç®—ç‰¹åˆ«ä¸¥é‡ï¼›ä½†64ä½CPUçš„å‡ºç°å¸¦æ¥äº†æ›´å¤§çš„å¯»å€ç©ºé—´ï¼Œä¹Ÿéœ€è¦æ›´å¤šçš„é¡µè¡¨é¡¹ï¼Œé¡µè¡¨çš„å±‚çº§ä¹Ÿæ¸æ¸çš„ä»2çº§å˜æˆäº†3çº§ã€4çº§ç”šè‡³æ›´å¤šã€‚&lt;strong&gt;é¡µæœºåˆ¶å¼€å¯ä¹‹åï¼Œæ‰€æœ‰çš„å†…å­˜å¯»å€éƒ½éœ€è¦ç»è¿‡CPUçš„é¡µéƒ¨ä»¶è¿›è¡Œè½¬åŒ–æ‰èƒ½è·å¾—æœ€ç»ˆçš„ç‰©ç†åœ°å€ï¼Œå› æ­¤è¿™ä¸€è¿‡ç¨‹å¿…é¡»è¦å¿«ï¼Œä¸èƒ½å› ä¸ºé¡µè¡¨çš„ç¦»æ•£å±‚æ¬¡è®¿é—®å°±ä¸¥é‡å½±å“è™šæ‹Ÿåœ°å€ç©ºé—´åˆ°ç‰©ç†åœ°å€ç©ºé—´çš„è½¬æ¢é€Ÿåº¦ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ã€€ã€€è¦åŠ å¿«åŸæœ¬ç›¸å¯¹è€—æ—¶çš„æŸ¥è¯¢æ“ä½œï¼Œä¸€ä¸ªå¸¸ç”¨çš„åŠæ³•ä¾¿æ˜¯å¼•å…¥ç¼“å­˜ã€‚ä¸ºäº†åŠ é€Ÿé€šç”¨å†…å­˜çš„è®¿é—®ï¼Œ80386åˆ©ç”¨å±€éƒ¨æ€§åŸç†æä¾›äº†é«˜é€Ÿç¼“å­˜ï¼›ä¸ºäº†åŠ é€Ÿå¤šçº§é¡µè¡¨çš„é¡µè¡¨é¡¹è®¿é—®ï¼Œ80386æä¾›äº†TLBã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€&lt;strong&gt;TLB(Translation Lookaside Buffer)&lt;/strong&gt;ç›´è¯‘ä¸º&lt;strong&gt;åœ°å€è½¬æ¢åæ´ç¼“å†²å™¨&lt;/strong&gt;ï¼Œæ ¹æ®å…¶ä½œç”¨ä¹Ÿè¢«ç§°ä¸º&lt;strong&gt;é¡µè¡¨ç¼“å­˜&lt;/strong&gt;æˆ–æ˜¯&lt;strong&gt;å¿«è¡¨&lt;/strong&gt;(å¿«é€Ÿé¡µè¡¨)ã€‚TLBä¸­å­˜æ”¾ç€ä¸€å¼ è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸€é¡¹ç”¨äºç¼“å­˜å½“å‰ä»»åŠ¡è™šæ‹Ÿé¡µå·å’Œå¯¹åº”é¡µè¡¨é¡¹ä¸­çš„å…³é”®ä¿¡æ¯ï¼Œè¢«ç§°ä¸ºTLBé¡¹ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€TLBçš„å·¥ä½œåŸç†å’Œé«˜é€Ÿç¼“å­˜ç±»ä¼¼ï¼šå½“CPUè®¿é—®æŸä¸€è™šæ‹Ÿé¡µæ—¶ï¼Œé€šè¿‡è™šæ‹Ÿé¡µå·å…ˆåœ¨TLBä¸­å¯»æ‰¾ï¼Œå¦‚æœå‘ç°å¯¹åº”çš„TLBé¡¹å­˜åœ¨ï¼Œåˆ™ç›´æ¥ä»¥TLBé¡¹ä¸­çš„æ•°æ®è¿›è¡Œç‰©ç†åœ°å€çš„è½¬æ¢ï¼Œè¿™è¢«ç§°ä¸ºTLBå‘½ä¸­ï¼›å½“å‘ç°å¯¹åº”çš„TLBé¡¹ä¸å­˜åœ¨æ—¶(TLBæœªå‘½ä¸­)ï¼Œåˆ™è¿›è¡Œå†…å­˜çš„è®¿é—®ï¼Œåœ¨è·å–å†…å­˜ä¸­é¡µè¡¨é¡¹æ•°æ®çš„åŒæ—¶ï¼Œä¹Ÿå°†å¯¹åº”é¡µè¡¨é¡¹ç¼“å­˜å…¥TLBä¸­ã€‚å¦‚æœTLBå·²æ»¡åˆ™éœ€è¦é€šè¿‡æŸç§ç½®æ¢ç®—æ³•é€‰å‡ºä¸€ä¸ªå·²å­˜åœ¨çš„TLBé¡¹å°†å…¶æ›¿æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€TLBçš„æŸ¥è¯¢é€Ÿåº¦æ¯”å†…å­˜å¿«ï¼Œä½†å®¹é‡ç›¸å¯¹å†…å­˜å°å¾ˆå¤šï¼Œå› æ­¤åªèƒ½ç¼“å­˜æ•°é‡æœ‰é™çš„é¡µè¡¨é¡¹ã€‚ä½†ç”±äºå†…å­˜è®¿é—®çš„å±€éƒ¨æ€§ï¼Œåªè¦é€šè¿‡åˆç†çš„è®¾è®¡æé«˜TLBçš„å‘½ä¸­ç‡(é€šå¸¸å¯ä»¥è¾¾åˆ°90%ä»¥ä¸Š)ï¼Œå°±èƒ½è¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚ã€€&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;ä¸‹é¢æ€»ç»“ä¸€ä¸‹å¼€å¯äº†åˆ†é¡µæœºåˆ¶çš„80386æ˜¯å¦‚ä½•è¿›è¡Œå†…å­˜å¯»å€çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€1. CPUé¦–å…ˆä»å†…å­˜è®¿é—®æŒ‡ä»¤ä¸­è·å–æ®µé€‰æ‹©å­å’Œæ®µå†…åç§»åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€2. æ ¹æ®æ®µé€‰æ‹©å­ä»æ®µè¡¨(GDTæˆ–LDT)ä¸­æŸ¥è¯¢å‡ºå¯¹åº”çš„æ®µæè¿°ç¬¦&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€3. æ ¹æ®æ®µæè¿°ç¬¦ä¸­çš„æ®µåŸºå€å’ŒæŒ‡ä»¤ä¸­çš„æ®µå†…åç§»åœ°å€ç”Ÿæˆ32ä½çš„çº¿æ€§åœ°å€(é¡µæœºåˆ¶ä¸‹çš„è™šæ‹Ÿåœ°å€)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€4. 32ä½çš„çº¿æ€§åœ°å€æ ¹æ®80386äºŒçº§é¡µè¡¨çš„è®¾è®¡ï¼Œæ‹†åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šé«˜10ä½ä½œä¸ºé¡µç›®å½•é¡¹ç´¢å¼•ï¼Œä¸­é—´æ¬¡é«˜10ä½ä½œä¸ºé¡µè¡¨é¡¹ç´¢å¼•ï¼Œä½12ä½ä½œä¸ºé¡µå†…åç§»åœ°å€ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€€ã€€5. é€šè¿‡é«˜10ä½çš„é¡µç›®å½•é¡¹ç´¢å¼•ä»ä¸€çº§é¡µç›®å½•è¡¨ä¸­è·å–äºŒçº§é¡µè¡¨çš„ç‰©ç†é¡µåœ°å€(é€šè¿‡ç‰©ç†é¡µæ¡†å·å¯å¾—)ï¼Œå†æ ¹æ®ä¸­é—´10ä½çš„é¡µè¡¨é¡¹ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„ç‰©ç†é¡µæ¡†ã€‚æ ¹æ®ç‰©ç†é¡µæ¡†å·ä¸é¡µå†…åç§»åœ°å€å…±åŒç”Ÿæˆæœ€ç»ˆçš„ç‰©ç†åœ°å€ï¼Œè¿›è¡Œç‰©ç†å†…å­˜çš„è®¿é—®ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ã€€ã€€&lt;/strong&gt;æƒ³è¦é€šè¿‡å­¦ä¹ æ“ä½œç³»ç»Ÿæ¥æ›´å¥½çš„ç†è§£è®¡ç®—æœºç¨‹åºåº•å±‚çš„å·¥ä½œåŸç†ï¼ŒåŸºç¡€çš„ç¡¬ä»¶çŸ¥è¯†æ˜¯å¿…é¡»è¦äº†è§£çš„ã€‚çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œï¼Œåœ¨ç†è§£äº†åŸºç¡€åŸç†åï¼Œè¿˜éœ€è¦é€šè¿‡å®è·µæ¥åŠ æ·±å¯¹åŸç†çŸ¥è¯†çš„ç†è§£ï¼Œè€Œé˜…è¯»ç›¸å…³æ“ä½œç³»ç»Ÿçš„å®ç°æºç å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°†å®è·µä¸åŸç†ç´§å¯†ç»“åˆçš„å­¦ä¹ æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ã€€ã€€å¸Œæœ›é€šè¿‡å¯¹ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å­¦ä¹ èƒ½å¸®åŠ©æˆ‘æ‰“å¼€è®¡ç®—æœºç¨‹åºåº•å±‚è¿è¡Œçš„ç¥ç§˜é»‘ç›’å­ä¸€çª¥ç©¶ç«Ÿï¼Œåœ¨æ€è€ƒé—®é¢˜æ—¶èƒ½å¤Ÿæ¢ä¸€ä¸ªè§’åº¦ä»åº•å±‚çš„è§†è§’å‡ºå‘ï¼Œå»æ›´å¥½çš„ç†è§£å’ŒæŒæ¡ä¸Šå±‚çš„åº”ç”¨æŠ€æœ¯ï¼Œä»¥é¿å…è¿·å¤±åœ¨å¿«é€Ÿå‘å±•çš„æŠ€æœ¯æµªæ½®ä¸­ã€‚&lt;/p&gt;

</description>
<pubDate>Thu, 18 Jun 2020 15:54:00 +0000</pubDate>
<dc:creator>å°ç†Šé¤é¦†</dc:creator>
<og:description>ä¸€. é¡µå¼å†…å­˜ç®¡ç†ä»‹ç» 80386èƒ½å¤Ÿå°†å†…å­˜åˆ†ä¸ºä¸åŒå±æ€§çš„æ®µï¼Œå¹¶é€šè¿‡æ®µæè¿°ç¬¦ã€æ®µè¡¨ä»¥åŠæ®µé€‰æ‹©å­ç­‰æœºåˆ¶ï¼Œé€šè¿‡æ®µåŸºå€å’Œæ®µå†…åç§»é‡è®¡ç®—å‡ºçº¿æ€§åœ°å€è¿›è¡Œè®¿é—®ï¼Œè¿™ä¸€å†…å­˜ç®¡ç†æ–¹å¼è¢«ç§°ä¸ºæ®µå¼å†…å­˜ç®¡ç†ã€‚ è¿™é‡Œè¦ä»‹ç»çš„æ˜¯</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/xiaoxiongcanguan/p/13068678.html</dc:identifier>
</item>
<item>
<title>å¦‚ä½•åªç”¨5åˆ†é’Ÿå®Œæˆæ•°æ® åˆ—è¡¨ã€åˆ›å»ºé¡µé¢ - è¿ç¨‹</title>
<link>http://www.cnblogs.com/anxin1225/p/13160847.html</link>
<guid isPermaLink="true" >http://www.cnblogs.com/anxin1225/p/13160847.html</guid>
<description>&lt;p&gt;æˆ‘ä»¬å½“ç„¶å¸Œæœ›èƒ½å¤Ÿæ›´å¿«çš„å®Œæˆæˆ‘ä»¬çš„å·¥ä½œï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æœ‰æ›´å¤šçš„æ—¶é—´åšå…¶ä»–çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´æµ‹è¯•ã€å­¦ä¹ ã€æ”¾æ¾ã€‚&lt;/p&gt;

&lt;p&gt;è½¯ä»¶ä¸€èˆ¬ä¹Ÿå°±è¿™ä¹ˆå‡ ä¸ªæ–¹é¢çš„å·¥ä½œè¦åšï¼Œå¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚å¦‚æœå½’ç»“åˆ°é¡µé¢ä¸Šæ¥è¯´ï¼Œé‚£ä¹ˆæ— éä¹Ÿå°±è¿™ä¹ˆå‡ ä¸ªé¡µé¢Formé¡µé¢ï¼ˆå¢ï¼‰ã€åˆ—è¡¨é¡µé¢ï¼ˆæŸ¥ã€åˆ ï¼‰ã€ç¼–è¾‘é¡µé¢ï¼ˆæ”¹ï¼‰ã€‚å¾ˆå¤§ç¨‹åº¦ä¸Šï¼Œä½ çš„é¡¹ç›®å°±æ˜¯ç”±ä¸åŒçš„å®ä½“çš„è¿™ä¹ˆå‡ ä¸ªé¡µé¢ç»„è£…èµ·æ¥çš„ã€‚æ—¢ç„¶ä»–ä»¬éƒ½æ˜¯è¿™ä¹ˆå‡ ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘é’ˆå¯¹è¿™å‡ ä¸ªé¡µé¢è¿›è¡ŒæŠ½è±¡å‘¢ï¼Ÿç„¶åä½¿ç”¨æ•°æ®æè¿°è¿™å‡ ä¸ªé¡µé¢çš„è¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;ç»å…¸å€’å™ï¼Œå…ˆä¸Šæ•ˆæœå›¾&lt;/p&gt;
&lt;h2 id=&quot;åˆ—è¡¨é¡µé¢&quot;&gt;åˆ—è¡¨é¡µé¢&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c8095099259ca?w=837&amp;amp;h=1079&amp;amp;f=png&amp;amp;s=51171&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;åˆ›å»ºé¡µé¢&quot;&gt;åˆ›å»ºé¡µé¢&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c809aa268db38?w=837&amp;amp;h=1079&amp;amp;f=png&amp;amp;s=49705&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰å°±ç®€å•å®ç°äº†åˆ—è¡¨é¡µé¢å’Œåˆ›å»ºé¡µé¢ã€‚ç¼–è¾‘é¡µé¢ï¼Œè·Ÿåˆ›å»ºé¡µé¢å¤ªåƒäº†ã€‚æš‚æ—¶è¿˜æ²¡æœ‰å®ç°ç›¸å…³å†…å®¹ï¼Œä¸è¿‡ï¼Œè¿™ä¸ªä¸æ˜¯å¾ˆé‡è¦äº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;éœ€æ±‚åˆ†æ&quot;&gt;éœ€æ±‚åˆ†æ&lt;/h2&gt;
&lt;p&gt;å…¶å®ï¼Œæ¯ä¸ªé¡µé¢éƒ½æ˜¯å­˜åœ¨å›ºå®šçš„è·¯æ•°çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ—è¡¨é¡µé¢&lt;/strong&gt;é‡Œè¾¹ä¸»è¦å­˜åœ¨è¿™ä¹ˆå‡ ä¸ªå‚æ•°ï¼šåˆ—è¡¨åã€åˆ—è¡¨å¤´ä¸Šçš„æŒ‰é’®ã€åˆ—è¡¨çš„è¡¨å¤´ã€åˆ—è¡¨å†…å®¹ã€åˆ—è¡¨æ¯ä¸€è¡Œä¸­çš„æ“ä½œã€åˆ†é¡µæ§ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¡¨å•é¡µé¢&lt;/strong&gt;åˆ—è¡¨ä¸»è¦å­˜åœ¨è¿™ä¹ˆå‡ ä¸ªå‚æ•°ï¼šè¡¨å•åã€è¡¨å•å†…å®¹é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦çš„å‚æ•°å‡ºç°çš„ä½ç½®éƒ½æ˜¯å›ºå®šçš„ã€‚ä½†æ˜¯ä»€ä¹ˆåœ°æ–¹å‡ºç°ä»€ä¹ˆå†…å®¹åˆ™æ˜¯å¯ä»¥å˜åŒ–çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ä»£ç ï¼Œä¸€éä¸€éçš„é‡å†™è¿™äº›é¡µé¢ï¼Œç„¶åæ¥è¾¾åˆ°ä¸åŒçš„åº”ç”¨ä¹‹é—´çš„å˜åŒ–çš„ç›®çš„ã€‚å…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡æ•°æ®æ¥æè¿°ä»–ä»¬çš„ã€‚æ¯”å¦‚è¯´å‘ä¸‹é¢è¿™æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c815e4ab1c036?w=965&amp;amp;h=376&amp;amp;f=png&amp;amp;s=22372&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;åˆ—è¡¨é¡µé¢çš„å®šä¹‰&quot;&gt;åˆ—è¡¨é¡µé¢çš„å®šä¹‰&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c810b3043370b?w=641&amp;amp;h=674&amp;amp;f=png&amp;amp;s=53034&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;formè¡¨å•é¡µé¢çš„å®šä¹‰&quot;&gt;Formè¡¨å•é¡µé¢çš„å®šä¹‰&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c8125777c2370?w=615&amp;amp;h=514&amp;amp;f=png&amp;amp;s=39583&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;åŸå§‹æ•°æ®çš„å®šä¹‰&quot;&gt;åŸå§‹æ•°æ®çš„å®šä¹‰&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c812c8939a8d0?w=611&amp;amp;h=500&amp;amp;f=png&amp;amp;s=31136&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°†è¿™äº›å®šä¹‰å¥½çš„å±æ€§é€šè¿‡åç«¯æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c8142b2b8731d?w=1549&amp;amp;h=1000&amp;amp;f=png&amp;amp;s=124090&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c81467c7f390b?w=1574&amp;amp;h=779&amp;amp;f=png&amp;amp;s=105091&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å°±å¯ä»¥è¾¾åˆ°ï¼Œå‰è¾¹å±•ç¤ºçš„è¿™ç§æ•ˆæœäº†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ•°æ®å­˜å‚¨&quot;&gt;æ•°æ®å­˜å‚¨&lt;/h3&gt;
&lt;p&gt;å› ä¸ºæ•°æ®ç±»å‹æ˜¯è‡ªå®šä¹‰çš„ï¼Œæ‰€ä»¥æ•°æ®å­˜å‚¨çš„å­—æ®µä¹Ÿæ˜¯å¯ä»¥è‡ªå·±éšä¾¿é¢„è®¾çš„ã€‚ç„¶åç³»ç»Ÿå°±å¯ä»¥ç›´æ¥æ”¯æŒè¿™ä¸€æ•°æ®ç±»å‹ã€‚åœ¨è¿™ä¸ªDemoé‡Œè¾¹ï¼Œæˆ‘æ˜¯ç®€å•ç²—æš´çš„ä½¿ç”¨äº†æ–‡ä»¶å­˜å‚¨Jsonæ–‡ä»¶çš„æ–¹å¼æ¥è¿›è¡Œä¿å­˜çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c819a46214611?w=988&amp;amp;h=338&amp;amp;f=png&amp;amp;s=15960&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®åº”è¯¥é“¾æ¥æ•°æ®åº“çš„ã€‚ä¸è¿‡æˆ‘åœ¨Demoé¡¹ç›®é‡Œè¾¹ç•™ä¸‹äº†ç›¸å…³çš„æ¥å£ï¼Œåªè¦å†å®ç°ä¸€ä¸ªæ•°æ®åº“ç‰ˆæœ¬çš„å®ä¾‹å°±å¯ä»¥æ— ç¼å¯¹æ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-gold-cdn.xitu.io/2020/6/18/172c81a946b91e01?w=406&amp;amp;h=459&amp;amp;f=png&amp;amp;s=23967&quot; alt=&quot;&quot; loading=&quot;lazy&quot;/&gt;&lt;/p&gt;
&lt;h3 id=&quot;å…¶å®&quot;&gt;å…¶å®&lt;/h3&gt;
&lt;p&gt;å½“ç„¶äº†è¿™åªæ˜¯ä»–çš„æœ€åˆçº§çš„å½¢æ€ï¼Œå› ä¸ºç°åœ¨å†™çš„é…ç½®æ–‡ä»¶éƒ½æ˜¯é€šè¿‡æ‰‹å†™æ¥å®ç°ï¼Œå°†æ¥å¯ä»¥åšä¸€ä¸ªç¼–è¾‘å™¨ã€‚å¹¶ä¸”å¯ä»¥å®æ—¶çœ‹åˆ°è°ƒæ•´è¿‡çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®è¿™ä¸ªåšæ³•ï¼Œæ˜¯æ¥æºäºPaaSé¡¹ç›®ä¸­çš„ä¸€ä¸ªå¾ˆå°å¾ˆå°çš„åŠŸèƒ½å—ã€‚çœŸæ­£çš„PaaSé¡¹ç›®è¿™ä¸€æ•´å¥—ä¸œè¥¿éƒ½æ˜¯åœ¨çº¿ä¸Šç›´æ¥ç¼–è¾‘çœ‹æ•ˆæœçš„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç³»åˆ—&quot;&gt;ç³»åˆ—&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªé¡¹ç›®å°†æ¥ä¼šèå…¥åˆ°æˆ‘å†™çš„PaaS Demoä¸­ä½œä¸ºå‰ç«¯å±•ç¤ºéƒ¨åˆ†ã€‚ ç³»åˆ—çš„ç›®å½•åœ¨ &lt;a href=&quot;https://juejin.im/post/5eca2a186fb9a047e96b2884&quot;&gt;https://juejin.im/post/5eca2a186fb9a047e96b2884&lt;/a&gt; è¿™ä¸ªéƒ¨åˆ†ä¼šä¸€ç‚¹ç‚¹å®Œå–„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¼€æº&quot;&gt;å¼€æº&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ä¸œè¥¿ä¸å¤§ï¼Œä½†æ˜¯è¿˜æ˜¯å¸Œæœ›èƒ½ç»™ä½ ä¸€ç‚¹ç‚¹å¯å‘ã€‚ é¡¹ç›®åœ°å€ &lt;a href=&quot;https://gitee.com/anxin1225/Dov.GenericWeb&quot;&gt;https://gitee.com/anxin1225/Dov.GenericWeb&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;ç®€å•çš„ä½“éªŒ&quot;&gt;ç®€å•çš„ä½“éªŒ&lt;/h2&gt;
&lt;p&gt;éƒ¨ç½²åˆ°äº‘ç«¯äº†ï¼Œå¯ä»¥ç®€å•ä½“éªŒä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://gw.ash50p.com/Generic/Meeting.Record/List&quot;&gt;http://gw.ash50p.com/Generic/Meeting.Record/List&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è½¬è½½è«å¿˜åŸæ–‡åœ°å€ï¼š&lt;a href=&quot;https://juejin.im/post/5eeb85b8e51d45740850f755&quot;&gt;https://juejin.im/post/5eeb85b8e51d45740850f755&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Thu, 18 Jun 2020 15:53:00 +0000</pubDate>
<dc:creator>è¿ç¨‹</dc:creator>
<og:description>å‰è¨€ æˆ‘ä»¬å½“ç„¶å¸Œæœ›èƒ½å¤Ÿæ›´å¿«çš„å®Œæˆæˆ‘ä»¬çš„å·¥ä½œï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æœ‰æ›´å¤šçš„æ—¶é—´åšå…¶ä»–çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¯´æµ‹è¯•ã€å­¦ä¹ ã€æ”¾æ¾ã€‚ èƒŒæ™¯ è½¯ä»¶ä¸€èˆ¬ä¹Ÿå°±è¿™ä¹ˆå‡ ä¸ªæ–¹é¢çš„å·¥ä½œè¦åšï¼Œå¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚å¦‚æœå½’ç»“åˆ°é¡µé¢ä¸Šæ¥è¯´ï¼Œé‚£ä¹ˆæ— éä¹Ÿå°±</og:description>
<dc:language>zh-cn</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.cnblogs.com/anxin1225/p/13160847.html</dc:identifier>
</item>
</channel>
</rss>