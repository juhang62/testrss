<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>VPN – Very Precarious Narrative</title>
<link>https://schub.io/blog/2019/04/08/very-precarious-narrative.html</link>
<guid isPermaLink="true" >https://schub.io/blog/2019/04/08/very-precarious-narrative.html</guid>
<description>&lt;p&gt;I just watched a &lt;em&gt;great&lt;/em&gt; YouTube video, touching technical, political, and philosophical questions around the whole “who controls the algorithm” topic, from one of those multi-million subscriber channels, spending lots and lots of time and resources on researching and producing. The video was perfect, but the end did upset me slightly. In the end, the sponsoring message was read, and the sponsor was one of those VPN companies, with their usual marketing lingo. You surely know what I am talking about, but let me quote the sponsoring message here for context:&lt;/p&gt;&lt;blockquote readability=&quot;18&quot;&gt;
&lt;p&gt;Your internet connection, right now, is broadcasting your IP address, which is the way people track you online. Check this out [shows a screencap of a website displaying the IP and GeoLocation information], when I go to this website, it tests everything that my internet connection is leaking. You can see my IP address, but you can also see where I am. Your internet connection is doing this right now. Here is how [VPN company] works: It is a Virtual Private Network, you turn it on with one click. My internet traffic is now encrypted, and going through [VPN company]s servers located throughout the world, so people can no longer figure out where I am located. I protect myself online with [VPN company]. […] There is a 30-day money back guarantee which I am confident you are not going to use, because I feel comforted knowing that my personal information is protected on the internet.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Here is another one, from a different channel:&lt;/p&gt;
&lt;blockquote readability=&quot;13&quot;&gt;
&lt;p&gt;With all the recent news about online security breaches, it is hard not to worry about where my data goes. Make an online purchase or simply accessing your email puts your private information at risk. You are being tracked online all the time by social media sites, marketing companies, and mobile internet providers. That is why you need to take your internet privacy back right now. Use [VPN company]! [VPN company] has the easiest apps that run seamlessly in the background of any computer, phone, and tablet. Turning on [VPN company] protection only takes one click. I am going to tell you what takes more than one click: getting your identity and data back after it’s been lost. Try getting back the money from your stolen credit cards. Do one click now. [VPN company] secures and anoymizes your internet browsing by encrypting your data and hiding your public IP address.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The popularity of those services and the way they are recommended and promoted is bad. So bad that I feel impelled to write this article on it, to explain two problematic points. Those are:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;In most circumstances, &lt;strong&gt;VPNs do very little to enhance your data security or privacy&lt;/strong&gt; unless paired with other changes.&lt;/li&gt;
&lt;li&gt;Acting as they do, and &lt;strong&gt;promoting commercial VPN providers&lt;/strong&gt; as a solution to potential issues &lt;strong&gt;does more harm than good&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;Just stick around for a bit, and I will explain everything. Before I start, though, let me clarify that I am writing this post with non-technical, but curious people in mind. This means that I will be using simplified terms and sometimes generalize a bit. However, I can assure you that all information is still very accurate. Sometimes, using technical words is necessary to avoid this post becoming inaccurate. If you do not understand something, just read on, the next paragraph might be more apparent.&lt;/p&gt;
&lt;h2 id=&quot;what-a-vpn-is-and-what-it-is-not&quot;&gt;What a VPN is, and what it is not.&lt;/h2&gt;
&lt;blockquote readability=&quot;9.1901408450704&quot;&gt;
&lt;p&gt;[…] another worrying aspect of today’s market of VPN services is the large misinformation end users are exposed to, which makes it hard for them to properly tell apart vague and bold claims typical of product advertisement campaigns with actual facts.&lt;/p&gt;
&lt;p&gt;- &lt;em&gt;a &lt;a href=&quot;https://www.degruyter.com/downloadpdf/j/popets.2015.1.issue-1/popets-2015-0006/popets-2015-0006.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;paper published in 2015&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/vpn-banner.png&quot; alt=&quot;VPN - a Very Precarious Narrative&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;To start, &lt;a href=&quot;https://en.wikipedia.org/wiki/Virtual_private_network&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Wikipedia&lt;/a&gt; has a very nice summary of what a VPN is:&lt;/p&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;A virtual private network (VPN) extends a private network across a public network, and enables users to send and receive data across shared or public networks as if their computing devices were directly connected to the private network.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A VPN is a &lt;em&gt;tunnel&lt;/em&gt; connecting two different networks. You throw traffic into one end of the tunnel, and it will come out somewhere else, even if the destination might not be reachable on the public internet. VPNs are popular in company environments: Imagine a large company running their servers with private sale data on them. The company does not want those servers to be reachable via the internet for security reasons, but at the same time, salespeople need to be able to access those datasets, even if they are on the road. The salesperson can use the company’s VPN to “move their laptop into the company network”, without the need to physically be there, so they have access to that information. In addition, network traffic sent over VPNs is generally encrypted, so even if the salesperson is using a maybe insecure network, the data is probably safe, if everything is configured correctly.&lt;/p&gt;
&lt;p&gt;The VPNs that get advertised at the end of YouTube videos are different. They are not used to access protected, internal infrastructure. Instead, they are used to tunnel &lt;em&gt;all&lt;/em&gt; network traffic into a datacenter you neither know nor can control in any way. To understand why this might be a bad idea and is absolutely not necessary in most cases, let’s look at the marketing claims.&lt;/p&gt;
&lt;h2 id=&quot;your-ip-is-used-for-tracking-and-leaks-private-information-you-should-hide-it&quot;&gt;“Your IP is used for tracking and leaks private information. You should hide it.”&lt;/h2&gt;
&lt;p&gt;One thing that most VPN advertisements have in common is some babble around IP addresses. Providers claim that your IP address leaks tons of private information, even your physical location, and they also claim that IP addresses are used for tracking. I call that fearmongering and deliberate misinformation.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/vpn-check.jpg&quot; alt=&quot;Two screenshots from VPN websites showing my &amp;quot;unprotected&amp;quot; IP address&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;I am sure you have seen notices like these on VPN provider’s websites before. They claim that your IP can be used to track you, and they even show a map of where you are located to make it look scarier.&lt;/p&gt;
&lt;p&gt;Before I address those two things, let me say something more generic. Notice how both sites show my IP, claim that my connection is “unprotected”, and one is even showing a map? Well. In reality, I am actually &lt;em&gt;using a VPN&lt;/em&gt; in those screenshots, I just happened to use &lt;a href=&quot;https://protonvpn.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ProtonVPN&lt;/a&gt; for this example, so I should be protected very well, right? How come they claim I am unprotected?&lt;/p&gt;
&lt;p&gt;That is because those “tests” do not do anything useful. The only check these things are doing is a simple “is the user currently connected via one of our IPs, and thus is using our VPN? If yes, say the user is protected, otherwise, act like the world is on fire”. Not very productive.&lt;/p&gt;
&lt;h3 id=&quot;ip-addresses-for-user-identification&quot;&gt;IP addresses for user identification&lt;/h3&gt;
&lt;p&gt;One of the sponsor messages I quoted earlier explicitly claims that IP addresses are how you “are being tracked online all the time by social media sites and marketing companies”. But is that so? We all know that Facebook is pretty big in the whole “tracking people” business, so if you have an active subscription at one of those VPN providers and a Facebook account, let’s do a test together!&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Open a new Private Window/Incognito Window in your favorite browser.&lt;/li&gt;
&lt;li&gt;In that window, open two tabs: Facebook, and the “What is my IP?” page of your VPN provider, like &lt;a href=&quot;https://www.expressvpn.com/what-is-my-ip&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;this one from ExpressVPN&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Log in to your Facebook account.&lt;/li&gt;
&lt;li&gt;With the VPN disabled, verify that the “test” site shows “you are unprotected”, like in my screenshots above.&lt;/li&gt;
&lt;li&gt;Connect to your VPN. Refresh the VPN test page, which should now say that your IP is hidden and your connection is protected. Right?&lt;/li&gt;
&lt;li&gt;Now, switch over to the Facebook tab, and hit reload.&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;So, what happened? Did Facebook forget who you are, and boot you back out to the login form? No, of course not. Even though your IP address changed, Facebook still knew &lt;em&gt;exactly&lt;/em&gt; who you are. So do marketing companies and other tracking parties.&lt;/p&gt;
&lt;p&gt;The reality here is that your IP address is only a tiny piece of your trackable profile and a pretty unreliable one as such. Tracking companies are interested in tracking &lt;em&gt;you&lt;/em&gt;, not a specific device or a specific browsing session. Your IP changes all the time, take your mobile phone as an example: You may be connected to your home WiFi, to your mobile connection, the network at work, … and you will have a different IP in each network. Moreover, these IPs are not even unique to you in most cases: most mobile phone networks share their public IPs to hundreds, sometimes thousands of mobile phones in a process called &lt;a href=&quot;https://en.wikipedia.org/wiki/Network_address_translation&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;NAT&lt;/a&gt;. Tracking companies have to distinguish between all those people - their profiles would be useless otherwise.&lt;/p&gt;
&lt;p&gt;Tracking companies have far more advanced methods. One well-known identification method is &lt;em&gt;Cookies&lt;/em&gt;, little portions of data in your browser or mobile client. However, since Cookies can easily be altered or removed by users, trackers came up with far more advanced technologies like browser fingerprinting and even running behavioral pattern recognition to uniquely identify users. All these things cannot be influenced or altered in any way by a VPN.&lt;/p&gt;
&lt;p&gt;If you are worried about these things, then use a browser with integrated tracking protection features. In Firefox, &lt;a href=&quot;https://blog.mozilla.org/firefox/facebook-container-extension/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Multi-Account Containers and the Facebook Container Extension&lt;/a&gt; for example help by locking those tracking sites into their isolated sandbox, so they cannot track you when you are not actively using them. The whole “a VPN makes you browse anonymously” thing is just marketing.&lt;/p&gt;
&lt;h3 id=&quot;location-leaking&quot;&gt;Location leaking&lt;/h3&gt;
&lt;p&gt;Another very effective method these VPN marketing people are using is showing your location on their sites. This is very effective at scaring people since those sites hit either your actual hometown or a city nearby. Nobody wants to share their location publicly.&lt;/p&gt;
&lt;p&gt;“Your IP address” is not leaking your home address.&lt;/p&gt;
&lt;p&gt;You see, your modem is not connected to a cable that leads directly to your ISPs main router. Instead, your internet data is &lt;em&gt;merged together&lt;/em&gt; with other peoples data on the way. ISPs split up their network into multiple segments to make their network more manageable, and to reduce the amount of cable needed. To have some structure in their networks, they “group” a bunch of customers together, for example by city or by district.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/net-chart.png&quot; alt=&quot;Very simplified scheme of how your route to a server looks like.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Some of these &lt;em&gt;merging points&lt;/em&gt; are passive components, a bit like a USB splitter. Other points are proper routers themselves, and those have IP addresses on their own. Let’s call those points &lt;em&gt;hops&lt;/em&gt;, as in “your internet packets &lt;em&gt;hop&lt;/em&gt; on those points to reach their target”, and multiple hops build the &lt;em&gt;route&lt;/em&gt; to the server you want to reach. With utilities like &lt;a href=&quot;https://en.wikipedia.org/wiki/Traceroute&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;traceroute&lt;/code&gt;&lt;/a&gt; you can check the route to a server yourself. Here, for example, is the route between the server hosting my blog and &lt;code class=&quot;highlighter-rouge&quot;&gt;google.com&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot; readability=&quot;7&quot;&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;
&lt;code&gt; 1  core12.nbg1.hetzner.com (213.239.229.5)
 2  core0.fra.hetzner.com (213.239.252.25)
 3  72.14.218.176 (72.14.218.176)
 4  108.170.251.193 (108.170.251.193)
 5  72.14.234.227 (72.14.234.227)
 6  fra16s25-in-f14.1e100.net (216.58.207.78)
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;If you are from Germany, you might be able to identify some snippets here. &lt;code class=&quot;highlighter-rouge&quot;&gt;nbg&lt;/code&gt;, for example, is short for Nuremberg, &lt;code class=&quot;highlighter-rouge&quot;&gt;fra&lt;/code&gt; is short for Frankfurt. So, as the first hop has Nuremberg in its name, this server is probably located close to - or in - Nuremberg. Also, the Google server I am connecting to is &lt;em&gt;probably&lt;/em&gt; in Frankfurt.&lt;/p&gt;
&lt;p&gt;Companies like &lt;a href=&quot;https://www.maxmind.com/en/locate-my-ip-address&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MaxMind&lt;/a&gt; sell large databases that map IP ranges, and the data I showed to you is one of the multiple indications they probably use to build these databases. Ultimately, this means that the location these VPN sites show you is the location of a piece of large network equipment of your ISP, and not your location. Quite often, if you look closely on the maps they show you, the marker ends up just being in the geographical center of a town, sometimes tens if not hundreds of kilometers away, because that is the best they can do to locate “you”.&lt;/p&gt;
&lt;h2 id=&quot;network-encryption&quot;&gt;“Network Encryption”&lt;/h2&gt;
&lt;p&gt;The second large topic in VPN advertisements is traffic encryption. They claim that, without VPNs, your personal data is sent unencrypted for everyone to read, while the VPN protects your private data by wrapping it in strong encryption.&lt;/p&gt;
&lt;p&gt;Technically, this is not a lie, they indeed &lt;em&gt;do&lt;/em&gt; encrypt your network traffic inside the VPN. However, I am fairly confident that most people will overestimate the amount of protection you gain from it, and &lt;em&gt;where&lt;/em&gt; the data is actually encrypted. So let’s look into that.&lt;/p&gt;
&lt;h3 id=&quot;what-a-vpn-can-encrypt-and-what-it-cant&quot;&gt;What a VPN can encrypt, and what it can’t.&lt;/h3&gt;
&lt;p&gt;In the following few paragraphs, I will write on the assumption that you indeed send out your data unencrypted. We will look into the substance of that assumption in just a bit, but it makes explaining the situation a lot easier, for now.&lt;/p&gt;
&lt;p&gt;If you send unencrypted data over the internet, you are essentially sending out a love letter on the back of a postcard. Every node in the chart shown earlier &lt;em&gt;could&lt;/em&gt; read and modify the contents. The following charts show the &lt;em&gt;cables&lt;/em&gt; and &lt;em&gt;nodes&lt;/em&gt; where your content is passed, red means the content is sent unencrypted, green means the content is encrypted.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/net-all-unencrypted.png&quot; alt=&quot;Your data is unencrypted everywhere.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Okay, this is bad. Everything is red, not a single connection in there is green. And yes, that is &lt;em&gt;absolutely&lt;/em&gt; how your data is passed when you send stuff unencrypted, which is why encryption is so important.&lt;/p&gt;
&lt;p&gt;So, how does a VPN solve that issue? Well, the thing is, it does not. Remember when I earlier described VPNs as a &lt;em&gt;tunnel&lt;/em&gt;? Every tunnel needs to end somewhere. For VPNs, you send your data through the encrypted “VPN tunnel” to VPN provider’s servers. But what happens to your data once it arrives there? Well, VPN providers are unable to deliver your data packets directly to the final destination, because they do not actually know where that is. All they can do is to throw your packets back into the public internet so that it eventually can reach its goal. To visualize this, we need to alter our chart slightly.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/net-via-vpn.png&quot; alt=&quot;VPN doing what a VPN does: Encrypting traffic from your client to the VPN endpoint.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;You might be surprised now, given there is still a lot of red in there. And as sorry as I am, this chart is not an exaggeration in any way.&lt;/p&gt;
&lt;p&gt;Remember how I explained the &lt;em&gt;proper&lt;/em&gt; use case for VPNs earlier? VPNs were designed to get network traffic &lt;em&gt;into&lt;/em&gt; the network they are located, and they are designed to do that in a very secure manner. There is no difference here with commercial VPNs: They get your data to the VPNs endpoint in a secure fashion, and that is about it. As soon as your traffic reached the VPN endpoint, which is a server the VPN provider runs, the data will get decrypted and leave the VPN provider’s network just like it would leave your network if you did not use a VPN. Unencrypted.&lt;/p&gt;
&lt;p&gt;This means that as soon as your data leaves the VPN tunnel, everyone can, once again, read and modify your data. This includes the VPN provider itself. The only secured channel here is the route between your machine and the VPN server.&lt;/p&gt;
&lt;p&gt;Now, what can &lt;em&gt;you&lt;/em&gt; do to get your data encrypted to the target server? Unfortunately, there is nothing you can do. The only way to transmit data encrypted to the end is if the target server is supporting encrypted connections. However, as it turns out, this is &lt;em&gt;probably&lt;/em&gt; nothing you actually have to worry about.&lt;/p&gt;
&lt;h3 id=&quot;your-data-probably-is-encrypted-anyway&quot;&gt;Your data probably is encrypted anyway&lt;/h3&gt;
&lt;p&gt;Remember the thing about little padlock icons in your browser’s address bar, and the prefix &lt;code class=&quot;highlighter-rouge&quot;&gt;https://&lt;/code&gt; in front of the domain name?&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/https-address-bar.png&quot; alt=&quot;If you are using Firefox, your address bar will look like this.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;HTTPS is the &lt;em&gt;secure&lt;/em&gt; version of HTTP, which is the protocol your browser is using to talk to web servers. HTTPS is using a set of cryptographic protocols called &lt;a href=&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Transport Layer Security&lt;/a&gt;. You do not need to know the details, because they are so complicated that I cannot remember them myself. All you need to know is that whenever there is a padlock and the &lt;code class=&quot;highlighter-rouge&quot;&gt;https&lt;/code&gt; prefix in your address bar, &lt;em&gt;your browser&lt;/em&gt; will encrypt the data in a way that can only be decrypted by the destination server. No matter if you are using a VPN or not, with TLS, your data is encrypted from the start to the end, and the chart would look like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/net-tls.png&quot; alt=&quot;All lights are green, everything is encrypted.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;TLS is not just used in your browser. Your email client? Probably using TLS. Your instant messaging app? Using TLS. Your Twitter client? Using TLS. In modern days, it is really, &lt;em&gt;really&lt;/em&gt;, rare for an application handling personal data not to use some form of encryption. With projects like &lt;a href=&quot;https://letsencrypt.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Let’s Encrypt&lt;/a&gt;, making TLS certificates free for everyone, there is absolutely no reason for applications not to add encryption, and there is a myriad of reasons why not encrypting is a horrible idea.&lt;/p&gt;
&lt;p&gt;I wanted to know &lt;em&gt;how&lt;/em&gt; popular TLS is these days. Getting reliable data on all forms of communication is tricky, so I decided to only look at the distribution of HTTP vs. HTTPS. For that, I had to shell out money and get the list of top 3000 domains in the United States via the &lt;a href=&quot;https://aws.amazon.com/alexa-top-sites/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Alexa Top Sites web service&lt;/a&gt;. I used that list to run some checks&lt;sup id=&quot;fnref:1&quot;/&gt; on the sites you are probably using the most, here are the results.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://schub.io/statics/blog/20190408/top3000-chart.png&quot; alt=&quot;A pie chart. Explanation is in the paragraphs below.&quot; class=&quot;center&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Out of 3000 tested domains, 2906 offered HTTP at the root level. The few others are domains that only get used for subdomains, like CDNs, so I filtered them out. Out of those remaining, 2863 domains did support HTTPS. This means that &lt;em&gt;98.52%&lt;/em&gt; of the top 3000 sites are either using HTTPS right away, or are redirecting to another domain that supports HTTPS immediately, meaning your data is encrypted just fine, no matter if you are using an “encrypted VPN” or not.&lt;/p&gt;
&lt;p&gt;In conclusion, “make sure there is a lock in your address bar” is much better advice than “use a VPN”.&lt;/p&gt;
&lt;h3 id=&quot;what-about-dns-leakage&quot;&gt;What about “DNS leakage”?&lt;/h3&gt;
&lt;p&gt;Interestingly enough, &lt;a href=&quot;https://en.wikipedia.org/wiki/DNS_leak&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;“DNS leak”&lt;/a&gt; is a term coined and widely popularized by commercial VPN providers. A “DNS leak” happens when your VPN fails to take care of tunneling your DNS requests, resulting in the request being sent to your ISP. Somehow, VPNs have turned them not failing to do their job into something they can market as a special feature. As these VPNs make a really big deal about using your ISP for DNS, let’s talk about what DNS is and the privacy impact of DNS queries.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Domain_Name_System&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DNS&lt;/a&gt;, short for Domain Name System, the system that turns human-readable domain names like &lt;code class=&quot;highlighter-rouge&quot;&gt;schub.io&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;twitter.com&lt;/code&gt; into something more useful to computers, IP addresses like &lt;code class=&quot;highlighter-rouge&quot;&gt;159.69.231.132&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;104.244.42.129&lt;/code&gt;. DNS was invented because humans generally have a hard time remembering IP addresses.&lt;/p&gt;
&lt;p&gt;Generally speaking, DNS is unencrypted, which means that everyone between you and the DNS server can read your DNS queries. There is nothing too private in there, as the query is basically a simple “Hey, can you tell me the IP for &lt;code class=&quot;highlighter-rouge&quot;&gt;schub.io&lt;/code&gt;?”, where the server replies with “Sure, the IP is &lt;code class=&quot;highlighter-rouge&quot;&gt;159.69.231.132&lt;/code&gt; - good luck!”. Usually, your ISP runs your DNS servers, so you do not send this information all over the internet.&lt;/p&gt;
&lt;p&gt;This is where the VPN marketeers pick you up, because, in theory, your ISP could keep a list of all domains you requested and based on that, they would have a pretty good understanding of what you were doing online. So VPNs claim to “solve” this issue by offering their own DNS servers, and setting your computer up in a way that uses these servers through the VPN. However, it should be clear by now that this is not resolving the issue because the VPN provider still handles unencrypted DNS requests, and now &lt;em&gt;they&lt;/em&gt; could log these requests. With a VPN, all you end up doing is shifting the trust from one party to another. You are not gaining anything.&lt;/p&gt;
&lt;p&gt;Instead of just shifting the trust from one ISP to another, some people are working on getting DNS itself encrypted, just like HTTPS. As this story is far too big for me to explain here, please check out &lt;a href=&quot;https://hacks.mozilla.org/2018/05/a-cartoon-intro-to-dns-over-https/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;this article on Mozilla Hacks&lt;/a&gt; for more details.&lt;/p&gt;
&lt;h2 id=&quot;but-can-using-a-vpn-cause-harm&quot;&gt;But can using a VPN cause harm?&lt;/h2&gt;
&lt;p&gt;With all that being said, we have figured out that VPNs really do not add that much to your online privacy. But can using them cause actual harm?&lt;/p&gt;
&lt;p&gt;There is no black or white answer here. First of all, using a VPN that is being marked as super secure and super anonymous can easily have some unfortunate side-effects. This false sense of security can lead you to do things that you normally would not do. Additionally, there is a lot of room on the technical side for things to go wrong.&lt;/p&gt;
&lt;h3 id=&quot;the-no-logs-thing&quot;&gt;The “no logs” thing&lt;/h3&gt;
&lt;p&gt;Almost all of the commercial VPN providers claim they do not collect personal data or your VPN activity. However, the sad reality is, there is no such thing as a “no logs” VPN. Because running it would technically be impossible.&lt;/p&gt;
&lt;p&gt;Starting with the obvious, if you pay for a VPN service, they have to keep your user account and associated payment information and your payment history. So, unless you are using a fake identity and an anonymous credit card (is that even possible these days?), your VPN account will be linked to your actual identity.&lt;/p&gt;
&lt;p&gt;Most VPNs limit the number of devices that can be connected at the same time. For that to work, well, they have to store a piece of information stating which device is connected, and what VPN account it is associated with. They have to associate your VPN session with your VPN account, as counting the number of sessions per account would be impossible otherwise. There is a lot more data that needs to be stored, at least temporary, to make networking work.&lt;/p&gt;
&lt;p&gt;How long do they store this data? Surely it’s only temporary, right? You do not know. Just like you have to &lt;em&gt;trust&lt;/em&gt; your ISP that they do not collect data, you have to &lt;em&gt;trust&lt;/em&gt; that your VPN provider is not storing the same data. And seriously, what is your reasoning behind trusting an anonymous company from the British Virgin Islands or in Panama more than you trust your ISP, which is a big company with public leadership people and something to lose?&lt;/p&gt;
&lt;h3 id=&quot;using-a-vpn-does-not-make-you-anonymous&quot;&gt;Using a VPN does not make you anonymous.&lt;/h3&gt;
&lt;p&gt;As outlined in previous paragraphs, VPNs do absolutely nothing to protect your identity in most cases. As a good example &lt;a href=&quot;https://www.justice.gov/opa/press-release/file/1001841/download&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;here&lt;/a&gt; is a case from a US District Court. The offense in question were serious cases of cyberstalking. The defendant was using a VPN in an attempt to hide their identity, but it turned out to be worthless.&lt;/p&gt;
&lt;p&gt;While connected to the VPN, the defendant logged into their personal Google Mail account. This could be a simple mistake by accessing that account, but it could also be that this was just some background service checking the server for new mail. Because of that, their VPN IP (you know, the one that is supposed to “hide” your identity) was directly linked to their identity, and the case was simple.&lt;/p&gt;
&lt;p&gt;Regardless if you want to stay anonymous towards other sites, trackers, ISPs, hackers, or governments, a VPN is not doing that job for you.&lt;/p&gt;
&lt;h3 id=&quot;security-issues-in-vpns-and-their-clients&quot;&gt;Security issues in VPNs and their clients&lt;/h3&gt;
&lt;p&gt;Just like any piece of software, VPNs and their clients are far from perfect. A &lt;a href=&quot;https://www.degruyter.com/downloadpdf/j/popets.2015.1.issue-1/popets-2015-0006/popets-2015-0006.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;paper published in 2015&lt;/a&gt; concludes that lots of large commercial VPNs clients had significant security issues. These issues ranged from simple DNS leaks to more significant issues like VPNs that did not tunnel IPv6 and forgot to turn it off, and even VPNs that allowed hijacking the user’s DNS configuration. The study also showed that some VPN services did not even run their own DNS servers, but just used Google’s public DNS server, despite claiming “privacy improvements”.&lt;/p&gt;
&lt;p&gt;I am not saying that all current VPNs have security issues, especially since the paper was published four years ago and I hope that all these issues have been addressed. However, VPN clients are still software, and contrary to projects like &lt;a href=&quot;https://openvpn.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OpenVPN&lt;/a&gt;, which can be validated by independent security researchers, commercial VPN clients always add their own little touches. And more often than not, these “customizations” are cause for a lot of trouble.&lt;/p&gt;
&lt;h3 id=&quot;vpns-are-a-central-point-for-attackers&quot;&gt;VPNs are a central point for attackers&lt;/h3&gt;
&lt;p&gt;The security issues I mentioned are more dangerous if you think what these commercial VPN providers actually are. The big services, especially those with enough money to sponsor tons of YouTubers, handle &lt;em&gt;tons&lt;/em&gt; of private information from a lot of different users.&lt;/p&gt;
&lt;p&gt;If you were a hacker with malicious intentions, what would you attack? A small instance of someone hosting their private VPN based on open source software; or a large commercial VPN provider, handling the connections for thousands if not hundreds of thousands of users? Yes. Ironically, these VPN providers claiming they want to improve the privacy and security of their customers create &lt;em&gt;huge&lt;/em&gt; issues. They centralize a lot of traffic onto a single infrastructure, and suddenly, lots of people depend on a small number of engineers maintaining that central infrastructure to do their job correctly.&lt;/p&gt;
&lt;p&gt;Large commercial VPNs are not only interesting to malicious hackers looking for credit cards to sell and private data to use. They also make governmental surveillance easier. Instead of having to listen on each person’s ISP, a government could, in theory, just hijack a large VPN service. This is not a good situation for anyone.&lt;/p&gt;
&lt;h2 id=&quot;so-are-there-valid-reasons-to-use-a-vpn&quot;&gt;So, are there valid reasons to use a VPN?&lt;/h2&gt;
&lt;p&gt;All right. After I spent over 4000 words explaining why VPNs are using deliberate misinformation in their marketing strategies and showing how VPNs do not help your privacy online, this post sounds like I am totally against VPNs. And while I indeed do &lt;em&gt;dislike&lt;/em&gt; the current wave of commercial VPN providers, I think there are some valid use-cases, and I think it is important to highlight those as well.&lt;/p&gt;
&lt;h3 id=&quot;public-networks&quot;&gt;Public networks&lt;/h3&gt;
&lt;p&gt;If you are using your device on a public network, VPNs can help you protect your data. Good examples for such networks are the WiFi networks that do not require a passphrase to connect, for example on Airports, in Cafes, or public buildings. Networks like these make it easy for attackers to get a copy of your network data, and if you send something unencrypted, the results can be quite harmful.&lt;/p&gt;
&lt;p&gt;I have a &lt;a href=&quot;https://protonvpn.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ProtonVPN&lt;/a&gt; subscription myself, just for those instances where I am sitting in an airport waiting for my plane, or using a large event’s WiFi to check my mail. In those cases, using a VPN is a really smart thing to do, as long as you do not expect your data is more secure than in your home network.&lt;/p&gt;
&lt;h3 id=&quot;geolocked-content&quot;&gt;Geolocked content&lt;/h3&gt;
&lt;p&gt;Some content on the internet is, unfortunately, locked behind geographic borders. Examples of that may include your favorite news channel livestream, which is unavailable if you are traveling abroad, or some sites that decided it is a good idea to lock everyone inside the European Union out because they are too lazy to comply with EU data protection laws.&lt;/p&gt;
&lt;p&gt;In those cases, using a VPN which allows you to select the country you would like to be in can be beneficial. Again, unless you expect your data to be magically protected, this is an awesome use-case for a commercial VPN!&lt;/p&gt;
&lt;h3 id=&quot;circumvention-of-isp-level-web-blocking&quot;&gt;Circumvention of ISP-level web blocking&lt;/h3&gt;
&lt;p&gt;Commercial VPNs are not just interesting to people who want to “protect their privacy”. In some countries, or behind some ISPs, certain internet resources can be blocked for technical or political reasons. YouTube, for example, is blocked in Turkey. VPNs &lt;em&gt;can&lt;/em&gt; be a way to work around these restrictions, by tunneling your network traffic through a country where those limitations do not apply.&lt;/p&gt;
&lt;p&gt;Let me be 100% clear here. VPNs &lt;em&gt;do not protect you&lt;/em&gt; and they are not a valid method to circumvent governmental surveillance. If you do use a commercial VPN to do things that are illegal in your country, you put yourself in great danger. I am not kidding.&lt;/p&gt;
&lt;p&gt;However, in some cases, the basis of those blocks can be quite… gray, and circumventing the blocks might not directly violate the laws. I am not your lawyer, and I am not giving you any advice. Do your research about your situation if you think this could affect you. However, VPNs could be a way to work around these blocks.&lt;/p&gt;
&lt;h2 id=&quot;in-the-end&quot;&gt;In the end…&lt;/h2&gt;
&lt;p&gt;Starting out this article, I quote a &lt;a href=&quot;https://www.degruyter.com/downloadpdf/j/popets.2015.1.issue-1/popets-2015-0006/popets-2015-0006.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;paper published from 2015&lt;/a&gt;. To close this, I would like to quote the same sentence once again.&lt;/p&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;[…] another worrying aspect of today’s market of VPN services is the large misinformation end users are exposed to, which makes it hard for them to properly tell apart vague and bold claims typical of product advertisement campaigns with actual facts.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This quote was written four years ago. Nowadays, we still see popular people advertising commercial VPN services with the same marketing claims and bold promises. Even worse, I feel like these services become more and more popular. This has to stop. We have to get better.&lt;/p&gt;
&lt;p&gt;Making people aware of privacy and security topics is amazing. Showing them solutions to those issues is also awesome, but for that to be effective, we - as in the whole internet - have to suggest and rely on methods that actually &lt;em&gt;do&lt;/em&gt; what we need them to do. Using a VPN does not protect you against hackers who hijack parts of the internet to read traffic. Using a VPN does not protect you against data breaches on the services you are using. Using a VPN does not automatically protect your privacy and your identity. VPNs are tools you can use to achieve those goals, but you have to know &lt;em&gt;how&lt;/em&gt; to use them.&lt;/p&gt;
&lt;p&gt;I wrote this article to vent my frustration about popular YouTube education channels promoting VPNs by reading their false marketing lingo out loud. I also wrote this article as a reference to point people towards if they have questions, or to quote from if I have to explain data breaches to people who were using a VPN.&lt;/p&gt;
&lt;p&gt;To people currently promoting these services, I have a personal message. I am not asking you to stop accepting money from those services. I do understand that sponsoring is a huge part of the thing that makes your work possible, and I am not the person to tell you where you should get your money from. All I am asking is that you spend a bit of time researching and validating the claims that your sponsors get you to read. I know this is annoying and a lot of work, but you have to do it. People who are far less experienced and knowledgeable than you keep watching your videos. They will hear your advertisement, and they expect you only to say things that you have personally vetted, and they trust you. If you tell them that using a VPN will keep their data safe, they will have false expectations. Let us work on not raising false expectations, and instead, let’s educate people, without relying on marketing material.&lt;/p&gt;
&lt;p&gt;If you made it this far, you have successfully finished a 5000+ words article on VPNs. I know this was a long text, but I did not manage to write it any shorter without losing out on accuracy. Thank you so much for working through this. Feel free to validate all of my claims, and share the knowledge you have gained. You &lt;em&gt;are&lt;/em&gt; awesome.&lt;/p&gt;

</description>
<pubDate>Mon, 08 Apr 2019 02:34:48 +0000</pubDate>
<dc:creator>denschub</dc:creator>
<og:title>VPN - a Very Precarious Narrative - Dennis Schubert</og:title>
<og:type>website</og:type>
<og:url>https://schub.io/blog/2019/04/08/very-precarious-narrative.html</og:url>
<og:description>A very long article about commercial VPNs, their marketing strategies, and the truth behind their privacy and security claims.</og:description>
<og:image>https://schub.io/statics/opengraph_fallback.png</og:image>
<dc:format>text/html</dc:format>
<dc:identifier>https://schub.io/blog/2019/04/08/very-precarious-narrative.html</dc:identifier>
</item>
<item>
<title>Facebook are &amp;#039;morally bankrupt liars&amp;#039; says New Zealand&amp;#039;s privacy commissioner</title>
<link>https://www.theguardian.com/technology/2019/apr/08/facebook-are-morally-bankrupt-liars-says-new-zealands-privacy-commissioner</link>
<guid isPermaLink="true" >https://www.theguardian.com/technology/2019/apr/08/facebook-are-morally-bankrupt-liars-says-new-zealands-privacy-commissioner</guid>
<description>&lt;p&gt;New Zealand’s privacy commissioner has lashed out at social media giant Facebook in the wake of the &lt;a href=&quot;https://www.theguardian.com/world/christchurch&quot; data-link-name=&quot;auto-linked-tag&quot; data-component=&quot;auto-linked-tag&quot; class=&quot;u-underline&quot;&gt;Christchurch&lt;/a&gt; attacks, calling the company “morally bankrupt pathological liars”.&lt;/p&gt;
&lt;p&gt;The commissioner used his personal Twitter page to lambast the social network, which has also drawn the ire of prime minister Jacinda Ardern for &lt;a href=&quot;https://www.theguardian.com/us-news/2019/mar/29/facebook-new-zealand-christchurch-attack-response&quot; data-link-name=&quot;in body link&quot; class=&quot;u-underline&quot;&gt;hosting a livestream&lt;/a&gt; of the attacks that left 50 dead, which was then copied and shared all over the internet.&lt;/p&gt;
&lt;p&gt;“Facebook cannot be trusted,” wrote Edwards.&lt;/p&gt;
&lt;aside class=&quot;element element-rich-link element--thumbnail element-rich-link--not-upgraded&quot; data-component=&quot;rich-link&quot; data-link-name=&quot;rich-link-2 | 1&quot;&gt;&lt;div class=&quot;rich-link&quot;&gt;
&lt;div class=&quot;rich-link__container&quot;&gt;
&lt;div class=&quot;rich-link__header&quot;&gt;
&lt;h2 class=&quot;rich-link__title&quot;&gt;Online hate threatens us all. Platforms can and must do more to eradicate it | Dan Hett&lt;/h2&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/aside&gt;&lt;p&gt;“They are morally bankrupt pathological liars who enable genocide (Myanmar), facilitate foreign undermining of democratic institutions.&lt;/p&gt;
&lt;p&gt;“[They] allow the live streaming of suicides, rapes, and murders, continue to host and publish the mosque attack video, allow advertisers to target ‘Jew haters’ and other hateful market segments, and refuse to accept any responsibility for any content or harm.&lt;/p&gt;
&lt;p&gt;“They #dontgiveazuck” wrote Edwards. He later deleted the tweets, saying they had prompted &lt;a href=&quot;https://twitter.com/JCE_PC/status/1115090993395654657&quot; data-link-name=&quot;in body link&quot; class=&quot;u-underline&quot;&gt;“toxic and misinformed traffic”&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Edwards was responding to an interview given by Facebook co-founder Mark Zuckerberg to &lt;a href=&quot;https://abcnews.go.com/Business/interview-facebook-ceo-mark-zuckerberg-transcript/story?id=62152829&quot; data-link-name=&quot;in body link&quot; class=&quot;u-underline&quot;&gt;America’s ABC&lt;/a&gt; network, in which he failed to commit to any changes to the Facebook live technology, including a time delay on livestreams.&lt;/p&gt;
&lt;p&gt;Zuckerberg said incidents like the live streaming of the Christchurch mosque attacks were the result of “bad actors”; not bad technology and a time delay would disrupt the enjoyment of users who broadcast events like birthday parties or group hangouts.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.radionz.co.nz/national/programmes/morningreport/audio/2018689989/facebook-cannot-be-trusted-privacy-commissioner&quot; data-link-name=&quot;in body link&quot; class=&quot;u-underline&quot;&gt;In a later interview with RNZ&lt;/a&gt; on Monday, Edwards described Zuckerberg’s comments as “disingenuous”, and said the company had refused to tell his office how many murders, suicides and sexual assaults had been broadcast using the platform.&lt;/p&gt;
&lt;aside class=&quot;element element-rich-link element--thumbnail element-rich-link--not-upgraded&quot; data-component=&quot;rich-link&quot; data-link-name=&quot;rich-link-2 | 2&quot;&gt;&lt;div class=&quot;rich-link&quot;&gt;
&lt;div class=&quot;rich-link__container&quot;&gt;
&lt;div class=&quot;rich-link__header&quot;&gt;
&lt;h2 class=&quot;rich-link__title&quot;&gt;Australia passes social media law penalising platforms for violent content&lt;/h2&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/aside&gt;&lt;p&gt;“It is a technology which is capable of causing great harm,” Edwards told RNZ.&lt;/p&gt;
&lt;p&gt;Before the mosque attacks prime minister Ardern was an avid user of &lt;a href=&quot;https://www.theguardian.com/technology/facebook&quot; data-link-name=&quot;auto-linked-tag&quot; data-component=&quot;auto-linked-tag&quot; class=&quot;u-underline&quot;&gt;Facebook&lt;/a&gt; live, using the technology to broadcast her formal press conferences, as well as more casual, informal messages from the sofa of her Auckland home, or the kitchen of Premier House in Wellington.&lt;/p&gt;
&lt;p&gt;The Guardian understands the prime minister’s office were considering what other platforms it could use to broadcast the prime minister’s video messages, including a separate, dedicated website, to avoid using Facebook.&lt;/p&gt;
&lt;p&gt;The last Facebook live video posted by the prime minister was a post-cabinet press conference on March 25, and the last informal Facebook live video was a climate change discussion two days before the attack.&lt;/p&gt;
&lt;p&gt;On Monday, Ardern said the Royal Commission inquiry into the Christchurch attack will report back to the government by 10 December 10.&lt;/p&gt;
&lt;p&gt;The inquiry would look into the suspected gunman’s activities, use of social media and international connections, as well as whether there was “inappropriate” priority setting in state counter terrorism resources, Ardern said in a statement.&lt;/p&gt;


</description>
<pubDate>Mon, 08 Apr 2019 02:24:24 +0000</pubDate>
<dc:creator>oska</dc:creator>
<og:url>http://www.theguardian.com/technology/2019/apr/08/facebook-are-morally-bankrupt-liars-says-new-zealands-privacy-commissioner</og:url>
<og:description>John Edwards calls out social media giant after Christchurch attack for refusing to accept responsibility for harm</og:description>
<og:image>https://i.guim.co.uk/img/media/70c82b3919e204ae111caa5f967599a33430f521/0_354_5314_3188/master/5314.jpg?width=1200&amp;height=630&amp;quality=85&amp;auto=format&amp;fit=crop&amp;overlay-align=bottom%2Cleft&amp;overlay-width=100p&amp;overlay-base64=L2ltZy9zdGF0aWMvb3ZlcmxheXMvdGctZGVmYXVsdC5wbmc&amp;s=b42734571125620af03bb3fe8db058de</og:image>
<og:type>article</og:type>
<og:title>Facebook are 'morally bankrupt liars' says New Zealand's privacy commissioner</og:title>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.theguardian.com/technology/2019/apr/08/facebook-are-morally-bankrupt-liars-says-new-zealands-privacy-commissioner</dc:identifier>
</item>
<item>
<title>Prisma – Database tools for modern application development</title>
<link>https://www.prisma.io/</link>
<guid isPermaLink="true" >https://www.prisma.io/</guid>
<description>&lt;h3 class=&quot;Section__Heading3-sc-9llphx-2 dXHwew&quot;&gt;Building a GraphQL server with Prisma&lt;/h3&gt;
&lt;p class=&quot;Section__Description-sc-9llphx-4 ibWLhV&quot;&gt;Prisma makes it easy to implement GraphQL servers. Learn how to use the Prisma client to access your database inside your resolvers.&lt;/p&gt;

&lt;ul readability=&quot;0.93103448275862&quot;&gt;&lt;li class=&quot;FeatureListItem__Wrapper-sc-1ozxdtz-0 hbglIn&quot; readability=&quot;-1&quot;&gt;
&lt;p&gt;Solves N+1 Problem with built-in dataloader&lt;/p&gt;
&lt;/li&gt;
&lt;li class=&quot;FeatureListItem__Wrapper-sc-1ozxdtz-0 hbglIn&quot; readability=&quot;1&quot;&gt;
&lt;p&gt;No boilerplate for CRUD, filters, pagination &amp;amp; more&lt;/p&gt;
&lt;/li&gt;
&lt;li class=&quot;FeatureListItem__Wrapper-sc-1ozxdtz-0 hbglIn&quot; readability=&quot;-1&quot;&gt;
&lt;p&gt;Easily implement GraphQL subscriptions&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;

&lt;a class=&quot;Buttons__PrimaryButton-sc-1buxojb-0-Link dTWvet&quot; href=&quot;https://www.prisma.io/with-graphql&quot;&gt;Learn More&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
<pubDate>Sun, 07 Apr 2019 17:19:50 +0000</pubDate>
<dc:creator>octosphere</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.prisma.io/</dc:identifier>
</item>
<item>
<title>Fast Directory Listing on Linux</title>
<link>https://github.com/romkatv/gitstatus/blob/master/docs/listdir.md</link>
<guid isPermaLink="true" >https://github.com/romkatv/gitstatus/blob/master/docs/listdir.md</guid>
<description>
&lt;p&gt;In order to find untracked files in a git repository, &lt;a href=&quot;https://github.com/romkatv/gitstatus&quot;&gt;gitstatusd&lt;/a&gt; needs to list the contents of every directory. gitstatusd does it 27% faster than a reasonable implementation that a seasoned C/C++ practitioner might write. This document explains the optimizations that went into it. As directory listing is a common operation, many other projects can benefit from applying these optimizations.&lt;/p&gt;
&lt;h2&gt;v1&lt;/h2&gt;
&lt;p&gt;Given a path to a directory, &lt;code&gt;ListDir()&lt;/code&gt; must produce the list of files in that directory. Moreover, the list must be sorted lexicographically to enable fast comparison with the index.&lt;/p&gt;
&lt;p&gt;The following C++ implementation gets the job done. For simplicity, it returns an empty list on error.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
vector&amp;lt;string&amp;gt; &lt;span class=&quot;pl-en&quot;&gt;ListDir&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* dirname) {
  vector&amp;lt;string&amp;gt; entries;
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (DIR* dir = &lt;span class=&quot;pl-c1&quot;&gt;opendir&lt;/span&gt;(dirname)) {
    &lt;span class=&quot;pl-k&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;dirent&lt;/span&gt;* ent = (errno = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;readdir&lt;/span&gt;(dir))) {
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;pl-c1&quot;&gt;Dots&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;)) entries.&lt;span class=&quot;pl-c1&quot;&gt;push_back&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;);
    }
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (errno) entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
    &lt;span class=&quot;pl-c1&quot;&gt;sort&lt;/span&gt;(entries.&lt;span class=&quot;pl-c1&quot;&gt;begin&lt;/span&gt;(), entries.&lt;span class=&quot;pl-c1&quot;&gt;end&lt;/span&gt;());
    &lt;span class=&quot;pl-c1&quot;&gt;closedir&lt;/span&gt;(dir);
  }
  &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; entries;
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Every directory has entries &lt;code&gt;&quot;.&quot;&lt;/code&gt; and &lt;code&gt;&quot;..&quot;&lt;/code&gt;, which we aren't interested in. We filter them out with a helper function &lt;code&gt;Dots()&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;Dots&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* s) { &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; s[&lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;.&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;&lt;/span&gt; &amp;amp;&amp;amp; (!s[&lt;span class=&quot;pl-c1&quot;&gt;1&lt;/span&gt;] || (s[&lt;span class=&quot;pl-c1&quot;&gt;1&lt;/span&gt;] == &lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;.&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;&lt;/span&gt; &amp;amp;&amp;amp; !s[&lt;span class=&quot;pl-c1&quot;&gt;2&lt;/span&gt;])); }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To check how fast &lt;code&gt;ListDir()&lt;/code&gt; performs, we can run it many times on a typical directory. One million runs on a directory with 32 files with 16-character names takes 12.7 seconds.&lt;/p&gt;
&lt;h2&gt;v2&lt;/h2&gt;
&lt;p&gt;Experienced C++ practitioners will scoff at our implementation of &lt;code&gt;ListDir()&lt;/code&gt;. If it's meant to be efficient, returning &lt;code&gt;vector&amp;lt;string&amp;gt;&lt;/code&gt; is an unaffordable convenience. To avoid heap allocations we can use a simple arena that will allow us to reuse memory between different &lt;code&gt;ListDir()&lt;/code&gt; calls.&lt;/p&gt;
&lt;p&gt;(Changed and added lines are marked with comments.)&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;ListDir&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* dirname, string&amp;amp; arena, vector&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;&amp;amp; entries) {  &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (DIR* dir = &lt;span class=&quot;pl-c1&quot;&gt;opendir&lt;/span&gt;(dirname)) {
    arena.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;dirent&lt;/span&gt;* ent = (errno = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;readdir&lt;/span&gt;(dir))) {
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;pl-c1&quot;&gt;Dots&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;)) {
        entries.&lt;span class=&quot;pl-c1&quot;&gt;push_back&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;(arena.&lt;span class=&quot;pl-c1&quot;&gt;size&lt;/span&gt;()));           &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
        arena.&lt;span class=&quot;pl-c1&quot;&gt;append&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;strlen&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;) + &lt;span class=&quot;pl-c1&quot;&gt;1&lt;/span&gt;);                 &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      }
    }
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (errno) entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
    &lt;span class=&quot;pl-k&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;amp; p : entries) p = &amp;amp;arena[&lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-c1&quot;&gt;size_t&lt;/span&gt;&amp;gt;(p)];      &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-c1&quot;&gt;sort&lt;/span&gt;(entries.&lt;span class=&quot;pl-c1&quot;&gt;begin&lt;/span&gt;(), entries.&lt;span class=&quot;pl-c1&quot;&gt;end&lt;/span&gt;(),                                   &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
         [](&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* a, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* b) { &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;pl-c1&quot;&gt;strcmp&lt;/span&gt;(a, b) &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; });   &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-c1&quot;&gt;closedir&lt;/span&gt;(dir);
  }
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To make performance comparions easier, we can normalize them relative to the baseline. v1 will get performance score of 100. A twice-as-fast alternative will be 200.&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;version&lt;/th&gt;
&lt;th&gt;optimization&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;score&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;v1&lt;/td&gt;
&lt;td&gt;baseline&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100.0&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;v2&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;avoid heap allocations&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;strong&gt;112.7&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Avoiding heap allocations makes &lt;code&gt;ListDir()&lt;/code&gt; 12.7% faster. Not bad. As an added bonus, those casts will fend off the occasional frontend developer who accidentally wanders into the codebase.&lt;/p&gt;
&lt;h2&gt;v3&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;opendir()&lt;/code&gt; is an expensive call whose performance is linear in the number of subdirectories in the path because it needs to perform a lookup for every one of them. We can replace it with &lt;code&gt;openat()&lt;/code&gt;, which takes a file destriptor to the parent directory and a name of the subdirectory. Just a single lookup, less CPU time. This optimization assumes that callers already have a descriptor to the parent directory, which is indeed the case for gitstatusd, and is often the case in other applications that traverse filesystem.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;ListDir&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; parent_fd, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* dirname, string&amp;amp; arena, vector&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;&amp;amp; entries) {  &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
  &lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; dir_fd = &lt;span class=&quot;pl-c1&quot;&gt;openat&lt;/span&gt;(root_fd, dirname, O_NOATIME | O_RDONLY | O_DIRECTORY | O_CLOEXEC);   &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (dir_fd &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt;;                                                                  &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (DIR* dir = &lt;span class=&quot;pl-c1&quot;&gt;fdopendir&lt;/span&gt;(dir_fd)) {
    arena.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
    &lt;span class=&quot;pl-k&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;dirent&lt;/span&gt;* ent = (errno = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;readdir&lt;/span&gt;(dir))) {
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;pl-c1&quot;&gt;Dots&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;)) {
        entries.&lt;span class=&quot;pl-c1&quot;&gt;push_back&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;(arena.&lt;span class=&quot;pl-c1&quot;&gt;size&lt;/span&gt;()));
        arena.&lt;span class=&quot;pl-c1&quot;&gt;append&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;strlen&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;) + &lt;span class=&quot;pl-c1&quot;&gt;1&lt;/span&gt;);
      }
    }
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (errno) entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
    &lt;span class=&quot;pl-k&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;amp; p : entries) p = &amp;amp;arena[&lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-c1&quot;&gt;size_t&lt;/span&gt;&amp;gt;(p)];
    &lt;span class=&quot;pl-c1&quot;&gt;sort&lt;/span&gt;(entries.&lt;span class=&quot;pl-c1&quot;&gt;begin&lt;/span&gt;(), entries.&lt;span class=&quot;pl-c1&quot;&gt;end&lt;/span&gt;(),
         [](&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* a, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* b) { &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;pl-c1&quot;&gt;strcmp&lt;/span&gt;(a, b) &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; });
    &lt;span class=&quot;pl-c1&quot;&gt;closedir&lt;/span&gt;(dir);
  } &lt;span class=&quot;pl-k&quot;&gt;else&lt;/span&gt; {                                                                                 &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-c1&quot;&gt;close&lt;/span&gt;(dir_fd);                                                                         &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  }                                                                                        &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is worth about 3.5% in speed.&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;version&lt;/th&gt;
&lt;th&gt;optimization&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;score&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;v1&lt;/td&gt;
&lt;td&gt;baseline&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100.0&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v2&lt;/td&gt;
&lt;td&gt;avoid heap allocations&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;112.7&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;v3&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;open directories with &lt;code&gt;openat()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;strong&gt;116.2&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h2&gt;v4&lt;/h2&gt;
&lt;p&gt;Copying file names to the arena isn't free but it doesn't seem like we can avoid it. Poking around we can see that the POSIX API we are using is implemented on Linux on top of &lt;code&gt;getdents64&lt;/code&gt; system call. Its documentation isn't very encouraging:&lt;/p&gt;
&lt;pre lang=&quot;text&quot;&gt;
&lt;code&gt;These are not the interfaces you are interested in.  Look at
readdir(3) for the POSIX-conforming C library interface.  This page
documents the bare kernel system call interfaces.

Note: There are no glibc wrappers for these system calls.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Hm... The API looks like something we can take advantage of, so let's try it anyway.&lt;/p&gt;
&lt;p&gt;First, we'll need a simple &lt;code&gt;Arena&lt;/code&gt; class that can allocate 8KB blocks of memory.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;Arena&lt;/span&gt; {
 &lt;span class=&quot;pl-k&quot;&gt;public:&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;enum&lt;/span&gt; { &lt;span class=&quot;pl-c1&quot;&gt;kBlockSize&lt;/span&gt; = &lt;span class=&quot;pl-c1&quot;&gt;8&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;10&lt;/span&gt; };

  &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* &lt;span class=&quot;pl-en&quot;&gt;Alloc&lt;/span&gt;() {
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (cur_ == blocks_.&lt;span class=&quot;pl-c1&quot;&gt;size&lt;/span&gt;()) blocks_.&lt;span class=&quot;pl-c1&quot;&gt;emplace_back&lt;/span&gt;(&lt;span class=&quot;pl-c1&quot;&gt;kBlockSize&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;);
    &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; blocks_[cur_++].&lt;span class=&quot;pl-c1&quot;&gt;data&lt;/span&gt;();
  }

  &lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;Clear&lt;/span&gt;() { cur_ = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; }

 &lt;span class=&quot;pl-k&quot;&gt;private:&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;size_t&lt;/span&gt; cur_ = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;;
  vector&amp;lt;string&amp;gt; blocks_;
};
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next, we need to define &lt;code&gt;struct dirent64_t&lt;/code&gt; ourselves because there is no wrapper for the system call we are about to use.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;dirent64_t&lt;/span&gt; {
  &lt;span class=&quot;pl-c1&quot;&gt;ino64_t&lt;/span&gt; d_ino;
  &lt;span class=&quot;pl-c1&quot;&gt;off64_t&lt;/span&gt; d_off;
  &lt;span class=&quot;pl-k&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;short&lt;/span&gt; d_reclen;
  &lt;span class=&quot;pl-k&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt; d_type;
  &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt; d_name[];
};
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally we can get to the implementation of &lt;code&gt;ListDir()&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;ListDir&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; parent_fd, Arena&amp;amp; arena, vector&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;&amp;amp; entries) {                       &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
  &lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; dir_fd = &lt;span class=&quot;pl-c1&quot;&gt;openat&lt;/span&gt;(root_fd, dirname, O_NOATIME | O_RDONLY | O_DIRECTORY | O_CLOEXEC);
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (dir_fd &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt;;
  arena.&lt;span class=&quot;pl-c1&quot;&gt;Clear&lt;/span&gt;();                                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;pl-c1&quot;&gt;true&lt;/span&gt;) {                                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* buf = arena.&lt;span class=&quot;pl-c1&quot;&gt;Alloc&lt;/span&gt;();                                                            &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; n = &lt;span class=&quot;pl-bu&quot;&gt;syscall&lt;/span&gt;(SYS_getdents64, dir_fd, buf, Arena::&lt;span class=&quot;pl-c1&quot;&gt;kBlockSize&lt;/span&gt;);                      &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (n &amp;lt;= &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;) {                                                                         &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (n) entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();                                                             &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      &lt;span class=&quot;pl-k&quot;&gt;break&lt;/span&gt;;                                                                              &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    }                                                                                     &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; pos = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; pos &amp;lt; n;) {                                                         &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      &lt;span class=&quot;pl-k&quot;&gt;auto&lt;/span&gt;* ent = &lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-c1&quot;&gt;dirent64_t&lt;/span&gt;*&amp;gt;(buf + pos);                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;pl-c1&quot;&gt;Dots&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;)) entries.&lt;span class=&quot;pl-c1&quot;&gt;push_back&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;);                             &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
      pos += ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_reclen&lt;/span&gt;;                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    }                                                                                     &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  }                                                                                       &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;sort&lt;/span&gt;(entries.&lt;span class=&quot;pl-c1&quot;&gt;begin&lt;/span&gt;(), entries.&lt;span class=&quot;pl-c1&quot;&gt;end&lt;/span&gt;(),
       [](&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* a, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* b) { &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;pl-c1&quot;&gt;strcmp&lt;/span&gt;(a, b) &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; });
  &lt;span class=&quot;pl-c1&quot;&gt;close&lt;/span&gt;(dir_fd);
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;How are we doing with this one?&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;version&lt;/th&gt;
&lt;th&gt;optimization&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;score&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;v1&lt;/td&gt;
&lt;td&gt;baseline&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100.0&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v2&lt;/td&gt;
&lt;td&gt;avoid heap allocations&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;112.7&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v3&lt;/td&gt;
&lt;td&gt;open directories with &lt;code&gt;openat()&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;116.2&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;v4&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;call &lt;code&gt;getdents64()&lt;/code&gt; directly&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;strong&gt;137.8&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Solid 20% speedup. Worth the trouble. Unfortunately, we now have just one &lt;code&gt;reinterpret_cast&lt;/code&gt; instead of two, and it's not nearly as scary-looking. Hopefully with the next iteration we can get back some of that evil vibe of low-level code.&lt;/p&gt;
&lt;p&gt;As a bonus, every element in &lt;code&gt;entries&lt;/code&gt; has &lt;code&gt;d_type&lt;/code&gt; at offset -1. This can be useful to the callers that need to distinguish between regular files and directories (gitstatusd, in fact, needs this). Note how &lt;code&gt;ListDir()&lt;/code&gt; implements this feature at zero cost, as a lucky accident of &lt;code&gt;dirent64_t&lt;/code&gt; memory layout.&lt;/p&gt;
&lt;h2&gt;v5&lt;/h2&gt;
&lt;p&gt;The CPU profile of &lt;code&gt;ListDir()&lt;/code&gt; reveals that almost all userspace CPU time is spent in &lt;code&gt;strcmp()&lt;/code&gt;. Digging into the source code of &lt;code&gt;std::sort()&lt;/code&gt; we can see that it uses Insertion Sort for short collections. Our 32-element vector falls under the threshold. Insertion Sort makes &lt;code&gt;O(N^2)&lt;/code&gt; comparisons, hence a lot of CPU time in &lt;code&gt;strcmp()&lt;/code&gt;. Switching to &lt;code&gt;qsort()&lt;/code&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/Timsort&quot; rel=&quot;nofollow&quot;&gt;Timsort&lt;/a&gt; is of no use as all good sorting algorithms fall back to Insertion Sort.&lt;/p&gt;
&lt;p&gt;If we cannot make fewer comparisons, perhaps we can make each of them faster? &lt;code&gt;strcmp()&lt;/code&gt; compares characters one at a time. It cannot read ahead as it can be illegal to touch memory past the first null byte. But &lt;em&gt;we&lt;/em&gt; know that it's safe to read a few extra bytes past the end of &lt;code&gt;d_name&lt;/code&gt; for every entry except the last in the buffer. And since we own the buffer, we can overalocate it so that reading past the end of the last entry is also safe.&lt;/p&gt;
&lt;p&gt;Combining these ideas with the fact that file names on Linux are at most 255 bytes long, we can invoke &lt;code&gt;getdents64()&lt;/code&gt; like this:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; n = syscall(SYS_getdents64, dir_fd, buf, Arena::&lt;span class=&quot;pl-c1&quot;&gt;kBlockSize&lt;/span&gt; - &lt;span class=&quot;pl-c1&quot;&gt;256&lt;/span&gt;);
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And then compare entries like this:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
[](&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* a, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* b) { &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;pl-c1&quot;&gt;memcmp&lt;/span&gt;(a, b, &lt;span class=&quot;pl-c1&quot;&gt;255&lt;/span&gt;) &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; }
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This version doesn't give any speedup compared to the previous but it opens an avenue for another optimization. The pointers we pass to &lt;code&gt;memcmp()&lt;/code&gt; aren't aligned. To be more specific, their numerical values are &lt;code&gt;N * 8 + 3&lt;/code&gt; for some &lt;code&gt;N&lt;/code&gt;. When given such a pointer, &lt;code&gt;memcmp()&lt;/code&gt; will check the first 5 bytes one by one, and only then switch to comparing 8 bytes at a time. If we can handle the first 5 bytes ourselves, we can pass aligned memory to &lt;code&gt;memcmp()&lt;/code&gt; and take full advantage of its vectorized loop.&lt;/p&gt;
&lt;p&gt;Here's the implementation:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-c++&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-c1&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;Read64&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt;* p) {                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;uint64_t&lt;/span&gt; x;                                                                             &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;memcpy&lt;/span&gt;(&amp;amp;x, p, &lt;span class=&quot;pl-k&quot;&gt;sizeof&lt;/span&gt;(x));                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; x;                                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
}                                                                                         &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;

&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;ByteSwap64&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt;* p) {                                                                &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;uint64_t&lt;/span&gt; x = &lt;span class=&quot;pl-c1&quot;&gt;__builtin_bswap64&lt;/span&gt;(&lt;span class=&quot;pl-c1&quot;&gt;Read64&lt;/span&gt;(p));                                              &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;memcpy&lt;/span&gt;(p, &amp;amp;x, &lt;span class=&quot;pl-k&quot;&gt;sizeof&lt;/span&gt;(x));                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
}                                                                                         &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;

&lt;span class=&quot;pl-k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;ListDir&lt;/span&gt;(&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; parent_fd, Arena&amp;amp; arena, vector&amp;lt;&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;*&amp;gt;&amp;amp; entries) {
  entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
  &lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; dir_fd = &lt;span class=&quot;pl-c1&quot;&gt;openat&lt;/span&gt;(root_fd, dirname, O_NOATIME | O_RDONLY | O_DIRECTORY | O_CLOEXEC);
  &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (dir_fd &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt;;
  arena.&lt;span class=&quot;pl-c1&quot;&gt;Clear&lt;/span&gt;();
  &lt;span class=&quot;pl-k&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;pl-c1&quot;&gt;true&lt;/span&gt;) {
    &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* buf = arena.&lt;span class=&quot;pl-c1&quot;&gt;Alloc&lt;/span&gt;();
    &lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; n = &lt;span class=&quot;pl-bu&quot;&gt;syscall&lt;/span&gt;(SYS_getdents64, dir_fd, buf, Arena::&lt;span class=&quot;pl-c1&quot;&gt;kBlockSize&lt;/span&gt; - &lt;span class=&quot;pl-c1&quot;&gt;256&lt;/span&gt;);                &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (n &amp;lt;= &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;) {
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (n) entries.&lt;span class=&quot;pl-c1&quot;&gt;clear&lt;/span&gt;();
      &lt;span class=&quot;pl-k&quot;&gt;break&lt;/span&gt;;
    }
    &lt;span class=&quot;pl-k&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;int&lt;/span&gt; pos = &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;; pos &amp;lt; n;) {
      &lt;span class=&quot;pl-k&quot;&gt;auto&lt;/span&gt;* ent = &lt;span class=&quot;pl-k&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;pl-c1&quot;&gt;dirent64_t&lt;/span&gt;*&amp;gt;(buf + pos);
      &lt;span class=&quot;pl-k&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;pl-c1&quot;&gt;Dots&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;)) {
        &lt;span class=&quot;pl-c1&quot;&gt;ByteSwap64&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;);                                                          &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
        entries.&lt;span class=&quot;pl-c1&quot;&gt;push_back&lt;/span&gt;(ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_name&lt;/span&gt;);
      }
      pos += ent-&amp;gt;&lt;span class=&quot;pl-smi&quot;&gt;d_reclen&lt;/span&gt;;
    }
  }
  &lt;span class=&quot;pl-c1&quot;&gt;sort&lt;/span&gt;(entries.&lt;span class=&quot;pl-c1&quot;&gt;begin&lt;/span&gt;(), entries.&lt;span class=&quot;pl-c1&quot;&gt;end&lt;/span&gt;(), [](&lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* a, &lt;span class=&quot;pl-k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* b) {
    &lt;span class=&quot;pl-c1&quot;&gt;uint64_t&lt;/span&gt; x = &lt;span class=&quot;pl-c1&quot;&gt;Read64&lt;/span&gt;(a);                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-c1&quot;&gt;uint64_t&lt;/span&gt; y = &lt;span class=&quot;pl-c1&quot;&gt;Read64&lt;/span&gt;(b);                                                               &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
    &lt;span class=&quot;pl-k&quot;&gt;return&lt;/span&gt; x &amp;lt; y || (x == y &amp;amp;&amp;amp; a != b &amp;amp;&amp;amp; &lt;span class=&quot;pl-c1&quot;&gt;memcmp&lt;/span&gt;(a + &lt;span class=&quot;pl-c1&quot;&gt;5&lt;/span&gt;, b + &lt;span class=&quot;pl-c1&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;pl-c1&quot;&gt;256&lt;/span&gt;) &amp;lt; &lt;span class=&quot;pl-c1&quot;&gt;0&lt;/span&gt;);                  &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  });
  &lt;span class=&quot;pl-k&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;pl-k&quot;&gt;char&lt;/span&gt;* p : entries) &lt;span class=&quot;pl-c1&quot;&gt;ByteSwap64&lt;/span&gt;(p);                                                  &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;//&lt;/span&gt; +&lt;/span&gt;
  &lt;span class=&quot;pl-c1&quot;&gt;close&lt;/span&gt;(dir_fd);
}
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is for Little Endian architecture. Big Endian doesn't need &lt;code&gt;ByteSwap64()&lt;/code&gt;, so it'll be a bit faster.&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;version&lt;/th&gt;
&lt;th&gt;optimization&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;score&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;v1&lt;/td&gt;
&lt;td&gt;baseline&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100.0&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v2&lt;/td&gt;
&lt;td&gt;avoid heap allocations&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;112.7&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v3&lt;/td&gt;
&lt;td&gt;open directories with &lt;code&gt;openat()&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;116.2&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;v4&lt;/td&gt;
&lt;td&gt;call &lt;code&gt;getdents64()&lt;/code&gt; directly&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;137.8&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;v5&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;hand-optimize &lt;code&gt;strcmp()&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;strong&gt;143.3&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Fast and respectably arcane.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Through a series of incremental improvements we've sped up directory listing by 43.3% compared to a naive implementation (v1) and 27.2% compared to a reasonable implementation that a seasoned C/C++ practitioner might write (v2).&lt;/p&gt;
&lt;p&gt;However, these numbers are based on an artificial benchmarks while the real judge is always the real code. Our goal was to speed up gitstatusd. Benchmark was just a tool. Thankfully, the different versions of &lt;code&gt;ListDir()&lt;/code&gt; have the same comparative performance within gitstatusd as in the benchmark. In truth, the directory chosen for the benchmark wasn't arbitrary. It was picked by sampling gitstatusd when it runs on &lt;a href=&quot;https://github.com/chromium/chromium&quot;&gt;chromium&lt;/a&gt; git repository.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ListDir()&lt;/code&gt; spends 97% of its CPU time in the kernel. If we assume that it makes the minimum possible number of system calls and these calls are optimal, it puts the upper bound on possible future performance improvements at just 3%.&lt;/p&gt;
&lt;p&gt;&lt;a target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; href=&quot;https://raw.githubusercontent.com/romkatv/gitstatus/master/docs/cpu-profile-listdir.png&quot;&gt;&lt;img src=&quot;https://raw.githubusercontent.com/romkatv/gitstatus/master/docs/cpu-profile-listdir.png&quot; alt=&quot;ListDir() CPU profile&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 07 Apr 2019 15:41:22 +0000</pubDate>
<dc:creator>romka2</dc:creator>
<og:image>https://avatars0.githubusercontent.com/u/1282067?s=400&amp;v=4</og:image>
<og:type>object</og:type>
<og:title>romkatv/gitstatus</og:title>
<og:url>https://github.com/romkatv/gitstatus</og:url>
<og:description>10x faster implementation of `git status` command. Contribute to romkatv/gitstatus development by creating an account on GitHub.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://github.com/romkatv/gitstatus/blob/master/docs/listdir.md</dc:identifier>
</item>
<item>
<title>When to Use TypeScript – A Detailed Guide Through Common Scenarios</title>
<link>https://khalilstemmler.com/articles/when-to-use-typescript-guide/</link>
<guid isPermaLink="true" >https://khalilstemmler.com/articles/when-to-use-typescript-guide/</guid>
<description>&lt;p&gt;Have you heard of that little programming language called &lt;strong&gt;TypeScript&lt;/strong&gt;? You know, the one that Microsoft made? The one that's kinda &lt;a href=&quot;https://redmonk.com/sogrady/2019/03/20/language-rankings-1-19/?utm_campaign=digest&amp;amp;utm_medium=email&amp;amp;utm_source=nuzzel&quot;&gt;blowing up&lt;/a&gt;?&lt;/p&gt;
&lt;p&gt;Maybe you were like me, a true JavaScript purist. I was doing &lt;em&gt;just fine&lt;/em&gt; with React and Node without types. Prop types and Joi validation have been treating me just nicely, thank you.&lt;/p&gt;
&lt;p&gt;Maybe you caved and gave it a shot. Started playing with it. Maybe you hated it because it reminded you of Java. Maybe you got annoyed with how you couldn't be super productive right away.&lt;/p&gt;
&lt;p&gt;These were some of &lt;strong&gt;my own initial sentiments&lt;/strong&gt; when I first started with TypeScript.&lt;/p&gt;
&lt;p&gt;I certainly didn't see the benefit... up until I started experiencing some really annoying stuff. Things like builds not failing when they should, buggy code and typos finding their way into production code somehow started to get to me. In addition to that, as my project demands started to get more complex, I found it increasingly challenging to express my designs in a really clean object-oriented way.&lt;/p&gt;
&lt;p&gt;9 months later into using TypeScript, I've built new features in Angular apps for clients, I've begun compiling &lt;a href=&quot;https://univjobs.ca&quot;&gt;Univjobs&lt;/a&gt;'s React / Redux front-end with TypeScript, and I ported all of Univjobs' backend services to TypeScript from vanilla Node.js, refactoring mass amounts of code along the way.&lt;/p&gt;
&lt;p&gt;In this article, we'll take a look at some of the most common scenarios and identify when it might be vital to use TypeScript, and when we could probably do without it and stick to vanilla JS.&lt;/p&gt;
&lt;hr/&gt;&lt;h2&gt;Why this discussion matters more than ever today&lt;/h2&gt;
&lt;p&gt;I've come to the very important conclusion that depending on your situation, context, project, skill level and other factors, that it's actually &lt;strong&gt;dangerous&lt;/strong&gt; for your project to &lt;strong&gt;NOT&lt;/strong&gt; be written using TypeScript today.&lt;/p&gt;
&lt;p&gt;The front-end space, for one- is getting more and more complex. Certain features that were once considered bleeding-edge, are now very-much standard user exprience assumptions.&lt;/p&gt;
&lt;p&gt;For example, it's almost always expected that your app is going to still work offline in some capacity; and when users ARE online, it's also usually expected that they're going to get real-time notifications without having to refresh the page.&lt;/p&gt;
&lt;p&gt;These are some pretty steep (but definitely not unrealstic in 2019) demands.&lt;/p&gt;
&lt;p&gt;Before we dive into different scenarios, we should actually talk about the three categories of really hard software problems to be solved.&lt;/p&gt;
&lt;h2&gt;3 Categories of Hard Software Problems&lt;/h2&gt;
&lt;p&gt;Generally speaking, there are 3. The Performant System Problem, the Embedded System Problem, and the Complex Domain Problem.&lt;/p&gt;
&lt;h3&gt;1. The Performant System Problem&lt;/h3&gt;
&lt;p&gt;Let's talk about Twitter.&lt;/p&gt;
&lt;p&gt;Twitter is actually a really simple concept.&lt;/p&gt;
&lt;p&gt;You sign up, you make tweets, you like other people's tweets and that's pretty much it.&lt;/p&gt;
&lt;p&gt;If Twitter is that simple, why couldn't someone else do it?&lt;/p&gt;
&lt;p&gt;It's apparent that the real challenge for Twitter is not actually so much as &quot;what it does&quot;, but it's &quot;how it's able to do what it does&quot;.&lt;/p&gt;
&lt;p&gt;Twitter has the unique challenge of serving requests from approximately 500 million users every single day.&lt;/p&gt;
&lt;p&gt;The hard problem that Twitter solves is actually a &lt;strong&gt;perfomance problem&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;When the challenge is performance, whether we use a strictly typed language or not is less important.&lt;/p&gt;
&lt;h3&gt;2. The Embedded System Problem&lt;/h3&gt;
&lt;p&gt;An embedded system is a combination of computer hardware and software, with the purpose of enabling control over the mechanical or electrical aspects of a system.&lt;/p&gt;
&lt;p&gt;Most systems we use today are built on a very complex layer of code that, if not initially written in, compiles down to C or C++ usually.&lt;/p&gt;
&lt;p&gt;Coding in these languages is not for the faint of heart.&lt;/p&gt;
&lt;p&gt;In C, there is no such thing as objects; and we as humans like objects because we can easily understand them. C is procedural and this makes the code that we have to write in this language more challenging to keep clean. These problems also require knowledge of the lower-level details.&lt;/p&gt;
&lt;p&gt;C++ does make life a whole lot better because it has object orientation, but the challenge is still fundementally interacting with lower-level hardware details.&lt;/p&gt;
&lt;p&gt;Because we don't really have that much of a choice on the languages we use for these problems, it's irrelevant to discuss TypeScript here.&lt;/p&gt;
&lt;h3&gt;3. The Complex Domain Problem&lt;/h3&gt;
&lt;p&gt;For some problems, that challenge is less about scaling in terms of handling more requests, but scaling in terms of &lt;strong&gt;the codebase's size&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Enterprise companies have &lt;strong&gt;complex real-life problems&lt;/strong&gt; to be solved. In these companies, the biggest engineering challenges are usually:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Being able to &lt;strong&gt;logically&lt;/strong&gt; (via domains) separate parts of that monolith into smaller apps. And then, &lt;strong&gt;physically&lt;/strong&gt; (via microservices for bounded contexts) split them up so that teams can be assigned to maintain them&lt;/li&gt;
&lt;li&gt;Handling integration and synchronization between these apps&lt;/li&gt;
&lt;li&gt;Modeling the domain concepts and actually solving the problems of the domain&lt;/li&gt;
&lt;li&gt;Creating a ubiquitous (all encompassing) language to be shared by developers and domain experts&lt;/li&gt;
&lt;li&gt;Not getting lost in the mass amounts of code written and slowing down to the point where it becomes impossible to add new features without breaking existing ones&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;I've essentially described the types of problems that &lt;a href=&quot;https://khalilstemmler.com/blank?todo=domain-driven-design&quot;&gt;Domain Driven Design&lt;/a&gt; solves. For these types of projects, you wouldn't even think about not using a strictly-typed language like TypeScript.&lt;/p&gt;
&lt;h4&gt;Object-oriented JavaScript&lt;/h4&gt;
&lt;p&gt;For &lt;strong&gt;Complex Domain&lt;/strong&gt; problems, if you don't choose TypeScript and instead, choose JavaScript, it will require some extra effort to be successful. Not only will you have to be &lt;strong&gt;extra comfortable&lt;/strong&gt; with your object modeling abilities in vanilla JavaScript, but you'll also have to know how to utilize the 4 principles of object-oriented programming (encapsulation, abstraction, inheritance, and polymorphism).&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;This can be hard to do. JavaScript doesn't naturally come with concepts of interfaces and abstract classes.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&quot;Interface Segregation&quot; from the SOLID design principles isn't easily achievable with vanilla JavaScript&lt;/p&gt;
&lt;p&gt;Using JavaScript alone would also require a certain level of discipline as a developer in order to keep the code clean, and this is vital once the codebase is sufficiently large. You're also left to ensure that your team shares the same discipline, experience and knowledge level on how to implement common design patterns in JavaScript. If not, you'll need to guide them.&lt;/p&gt;
&lt;p&gt;In Domain-Driven projects like this, the strong benefit from using a strictly typed language is &lt;em&gt;less&lt;/em&gt; about expressing what &lt;strong&gt;can be done&lt;/strong&gt;, but more about using encapsulation and information hiding to &lt;u&gt;reduce the surface area of bugs&lt;/u&gt; by limiting what domain objects are &lt;strong&gt;actually allowed to do&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We can live without this on the front-end, but it's a &lt;strong&gt;hard language requirement for the backend&lt;/strong&gt; in my books. It's also the reason why I moved my Node.js backend services to TypeScript.&lt;/p&gt;
&lt;p&gt;There's a reason why TypeScript is called &quot;&lt;strong&gt;JavaScript that scales&lt;/strong&gt;&quot;.&lt;/p&gt;
&lt;p&gt;Out of all three categories of hard software problems, only the Complex Domain Problem is the one where TypeScript is an absolute necessity.&lt;/p&gt;
&lt;p&gt;Besides this, there are other factors that might determine when it's best to use TypeScript for your JavaScript project.&lt;/p&gt;
&lt;hr/&gt;&lt;h2&gt;Code size&lt;/h2&gt;
&lt;p&gt;Code size &lt;em&gt;usually&lt;/em&gt; ties back to the &lt;strong&gt;Complex Domain Problem&lt;/strong&gt;, where a large codebase means a complex domain, but that's not always the case.&lt;/p&gt;
&lt;p&gt;When the amount of code a project has gets to a certain size, it becomes &lt;strong&gt;harder&lt;/strong&gt; to keep track of everything that exists, and becomes &lt;strong&gt;easier&lt;/strong&gt; to end up re-implementing something already coded.&lt;/p&gt;
&lt;blockquote readability=&quot;5&quot;&gt;
&lt;p&gt;Duplication is the enemy to well-designed and stable software.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is especially heightened when new developers start coding on an already large codebase.&lt;/p&gt;
&lt;p&gt;Visual Studio Code's autocompletion and Intellisense helps to navigate through huge projects. It works really well with TypeScript, but it's somewhat limited with JavaScript.&lt;/p&gt;
&lt;p&gt;For projects that I know will stay simple and small, or if I know that it will be thrown away eventually, I would be less pressed to recommend TypeScript as a necessity.&lt;/p&gt;
&lt;h2&gt;Production software vs. pet projects&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Production software&lt;/strong&gt; is code that you care about, or code that you'll get in trouble for if it doesn't work. It's also code that you've written tests for. The general rule of thumb is that if you care about the code, you need to have unit tests for it.&lt;/p&gt;
&lt;p&gt;If you don't care, don't have tests.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pet projects&lt;/strong&gt; are self-explanatory. Do whatever you like. You have no professional commitment to uphold any standards of craftsmanship whatsoever.&lt;/p&gt;
&lt;p&gt;Go on and make things! Make small things, make big things.&lt;/p&gt;
&lt;p&gt;Maybe someday you'll experience the pain when your pet project turns into your main project which turns into production software, which is buggy because it didn't have tests or types 🙃 not like I've been there or anything...&lt;/p&gt;
&lt;h3&gt;Lack of Unit Tests&lt;/h3&gt;
&lt;p&gt;It's not always possible to have tests for everything, because, well- &lt;strong&gt;life&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In that case, I'd say that if you don't have Unit Tests, the next best thing you could have is compile-time checking with TypeScript. After that, if you're using React, the next best is thing is to use runtime checking with Prop types.&lt;/p&gt;
&lt;p&gt;However, compile time checking is &lt;strong&gt;not a subsitute&lt;/strong&gt; for having unit tests. The good thing is that unit tests can be written in any language- so the argument for TypeScript here is irrelevant. What's important is that tests are written and we are confident about our code.&lt;/p&gt;
&lt;h2&gt;Startups&lt;/h2&gt;
&lt;p&gt;Definitely use whatever helps you be most productive.&lt;/p&gt;
&lt;p&gt;At this time, the language you choose matters a lot less.&lt;/p&gt;
&lt;p&gt;The most important thing for you to do is to validate your product.&lt;/p&gt;
&lt;p&gt;Choosing a language (Java, for example) or a tool (like Kubernetes) that you heard would help you scale in the future, while being totally unfamiliar with it and needing to spend time learning, may or may not be the best option in the case of a startup.&lt;/p&gt;
&lt;p&gt;Depending on how early you are, the most important thing for you to do is to be productive.&lt;/p&gt;
&lt;p&gt;In Paul Graham's famous article, &lt;a href=&quot;http://www.paulgraham.com/pypar.html&quot;&gt;The Python Paradox&lt;/a&gt;, his main point is that startup engineers should just use the technology that maximizes their productivity.&lt;/p&gt;
&lt;p&gt;Overall, in this case, use whatever you're most comfortable with: types or no types. You can always refactor towards a better design once you know you've built something people actually want.&lt;/p&gt;
&lt;h2&gt;Working on Teams&lt;/h2&gt;
&lt;p&gt;Depending on the size of your team and the frameworks you're using, using TypeScript might be a make or break kind-of thing.&lt;/p&gt;
&lt;h3&gt;Large teams&lt;/h3&gt;
&lt;p&gt;When teams are sufficiently large (because the problems are sufficiently large), it's a good reason to use an opinionated framework, like Angular for the front-end, and TypeScript for the backend.&lt;/p&gt;
&lt;p&gt;The reason why using an opinionated framework is benefitial is because you limit the number of possible ways for people to accomplish something. In Angular, there's pretty much one main way to add a Route Guard, use Dependency Injection, hook up Routing, Lazy-Loading and Reactive Forms.&lt;/p&gt;
&lt;p&gt;The huge benefit here is that the API is well specified.&lt;/p&gt;
&lt;p&gt;With TypeScript, we save massive amounts of time and make communication efficient.&lt;/p&gt;
&lt;blockquote readability=&quot;10&quot;&gt;
&lt;p&gt;The ability to quickly determine the required arguments and it's return type for any method, or the ability to explicitly describe program intent through public, private, and protected variables alone is incredibly useful.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yes, some of this is possible with JavaScript, but it's hacky.&lt;/p&gt;
&lt;h4&gt;Communicating patterns &amp;amp; implementing design principles&lt;/h4&gt;
&lt;p&gt;Not only that, but &lt;strong&gt;design patterns&lt;/strong&gt;, the solutions to commonly occuring problems in software, are more easily communicated through explicit strictly-typed languages.&lt;/p&gt;
&lt;p&gt;Here's a JavaScript example of a common pattern. See if you can identify what it is.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot; readability=&quot;11&quot;&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;
&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AudioDevice&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isPlaying &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;currentTrack &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;track&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;currentTrack &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; track&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isPlaying &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`Subclasss responsibility error`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Boombox&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AudioDevice&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IPod&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AudioDevice&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
    
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; AudioDeviceType &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  Boombox&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'Boombox'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  IPod&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'Ipod'&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; AudioDeviceFactory &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;deviceType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;deviceType&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; AudioDeviceType&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Boombox&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Boombox&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; AudioDeviceType&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IPod&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IPod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; 
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; boombox &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; AudioDeviceFactory
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AudioDeviceType&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Boombox&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; ipod &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; AudioDeviceFactory
  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AudioDeviceType&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IPod&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you guessed &lt;strong&gt;Abstract Factory Pattern&lt;/strong&gt;, you're right. Depending on your familiarity with the pattern, it might not have been that obvious to you.&lt;/p&gt;
&lt;p&gt;Let's look at it in TypeScript now. Look at how much more intent we can signify about &lt;code class=&quot;language-text&quot;&gt;AudioDevice&lt;/code&gt; in TypeScript.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;typescript&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-typescript&quot;&gt;
&lt;code class=&quot;language-typescript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AudioDevice&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; isPlaying&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; currentTrack&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ITrack &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;track&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ITrack&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;currentTrack &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; track&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isPlaying &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handlePlayCurrentAudioTrack&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Immediate improvements&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;We know the class is abstract &lt;strong&gt;right away&lt;/strong&gt;. We needed to sniff around in the JavaScript example.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AudioDevice&lt;/strong&gt; can be instantiated in the JavaScript example. This is bad, we intended &lt;strong&gt;AudioDevice&lt;/strong&gt; to be an abstract class. And abstract classes shouldn't be able to be instantiated, they're only meant to be subclassed and implemented by &lt;a href=&quot;https://khalilstemmler.com/articles/when-to-use-typescript-guide/wiki/concrete-class/&quot;&gt;concrete classes&lt;/a&gt;. This limitation is set in place correctly in the TypeScript example.&lt;/li&gt;
&lt;li&gt;We've signaled the scope of the variables.&lt;/li&gt;
&lt;li&gt;In this example, &lt;strong&gt;currentTrack&lt;/strong&gt; refers to an interface. As per the &lt;a href=&quot;https://khalilstemmler.com/wiki/dependency-inversion&quot;&gt;Dependency Inversion&lt;/a&gt; design principle, we should always depend on abstractions, not concretions. This isn't possible in the JavaScript implementation.&lt;/li&gt;
&lt;li&gt;We've also signaled that any subclasses of &lt;strong&gt;AudioDevice&lt;/strong&gt; will need to implement the &lt;strong&gt;handlePlayCurrentAudioTrack&lt;/strong&gt; themselves. In the JavaScript example, we exposed the possibility for someone to introduce runtime errors trying to execute the method from either the illegal abstract class or the non-complete concrete class implementation.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Takeaway: If you work on a large team and you need to minimize the potential ways someone could misuse your code, TypeScript is a good way to help fix that.&lt;/p&gt;
&lt;h3&gt;Smaller teams &amp;amp; coding styles&lt;/h3&gt;
&lt;p&gt;Smaller teams are a lot easier to manage coding styles and communication. Paired with linting tools, frequent discussions about how things will get done and pre-commit hooks, I think small teams can be really successful without TypeScript.&lt;/p&gt;
&lt;p&gt;I think that success is an equation involving the size of the codebase and the size of the team.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;As the codebase grows&lt;/strong&gt;, the team might find that they need to rely on some help from the language itself to remember where things are and how they should be.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;As the team grows&lt;/strong&gt;, they might find they need more rules and restrictions to keep the style consistent and prevent duplicate code.&lt;/p&gt;
&lt;h2&gt;Frameworks&lt;/h2&gt;
&lt;h3&gt;React &amp;amp; Angular&lt;/h3&gt;
&lt;p&gt;Much of what draws me and other developers to React is the ability to write code however you want and in an elegant/clever way. &lt;/p&gt;
&lt;p&gt;It's true that React makes you a better JavaScript developer because it forces you to approach problems differently, it forces you to be aware of how &lt;strong&gt;this binding&lt;/strong&gt; in JavaScript works and enables you to compose large components out of small ones.&lt;/p&gt;
&lt;p&gt;React also allows you to have a bit of your own style. And because of the number of ways I can implement any given task, I will most often write vanilla React.js apps when:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;the codebase is small&lt;/li&gt;
&lt;li&gt;it's just me coding it&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;And I will compile it with TypeScript when:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;more than 3 people are coding it, or&lt;/li&gt;
&lt;li&gt;the codebase is expected to be very large&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;I will also optionally use Angular for the same reason I will compile React with TypeScript.&lt;/p&gt;

&lt;p&gt;In conclusion, these are my personal opinions on when TypeScript is absolutely necessary and I welcome you to disagree with any of it.&lt;/p&gt;
&lt;p&gt;This is what has worked for me in the past when deciding whether to use TypeScript. However, today- since I've seen the light, it's not much more effort for me to use TypeScript over vanilla JavaScript as I'm equally comfortable with both and would prefer the type safety.&lt;/p&gt;
&lt;p&gt;My final points here are:&lt;/p&gt;
&lt;h2&gt;You can always gradually start using TypeScript&lt;/h2&gt;
&lt;p&gt;Start gradually by adding TypeScript and ts-node to your &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt; and utilizing the &lt;code class=&quot;language-text&quot;&gt;allowjs: true&lt;/code&gt;, option in your &lt;code class=&quot;language-text&quot;&gt;tsconfig&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;This is how I migrated all of my Node.js apps over time to TypeScript.&lt;/p&gt;
&lt;h2&gt;Compile time errors are better than runtime ones&lt;/h2&gt;
&lt;p&gt;You can't argue with that. If catching bugs in production code is especially important to you, TypeScript will help you minimize a lot of these.&lt;/p&gt;
&lt;h2&gt;If you are in a position to learn it, learn it. It does wonders for your software design skills&lt;/h2&gt;
&lt;p&gt;Depending on where you are in your life and your career, you might not have the time to learn it. If you do have the time, I'd recommend you start learning it and start learning about &lt;strong&gt;SOLID design principles&lt;/strong&gt; and software design patterns. This is the &lt;strong&gt;fastest way to level up as a Junior Developer&lt;/strong&gt; in my honest opinion.&lt;/p&gt;
</description>
<pubDate>Sun, 07 Apr 2019 15:26:12 +0000</pubDate>
<dc:creator>stemmlerjs</dc:creator>
<og:title>When To Use TypeScript - A Detailed Guide Through Common Scenarios</og:title>
<og:image>https://khalilstemmler.com/img/blog/time-for-typescript/typescript-time.jpg</og:image>
<og:description>Strap yourself in. In this guide, we compare when it's absolutely vital to be using TypeScript, the strictly-typed programming language, and when it makes sense to stick to vanilla JavaScript.</og:description>
<og:type>website</og:type>
<og:url>https://khalilstemmler.com/articles/when-to-use-typescript-guide/</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://khalilstemmler.com/articles/when-to-use-typescript-guide/</dc:identifier>
</item>
<item>
<title>I Lied When I Said We Did Everything We Could</title>
<link>https://www.doximity.com/doc_news/v2/entries/18293779</link>
<guid isPermaLink="true" >https://www.doximity.com/doc_news/v2/entries/18293779</guid>
<description>&lt;p&gt;&lt;img src=&quot;https://images.ctfassets.net/uq0sg0aynn6a/5JKqAcL2SeIAuf8n8IxiIY/f0c696ed81097b5969b1f30c91e3a9cf/codeFutile_1_april.gif&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Op-Med ran the “First Stab” contest in February 2019. We are excited to announce this as the runner-up.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I knew it was only a matter of time until a code would be called during my intern ICU rotation. I knew it would leave a lasting impression on me, regardless of the particular circumstances. What I didn’t know was exactly how and when it would do so.&lt;/p&gt;
&lt;p&gt;She was young — late thirties, I think — and had spent most of the past year in the hospital. The unlucky victim of genetics and circumstances still not understood by science, she was dying from sarcoidosis. She had long been beyond any hope of meaningful recovery.&lt;/p&gt;
&lt;p&gt;I had not been taking care of her, but I remembered my attending describing her case with a regrettable helplessness. He had spoken with her family innumerable times explaining her dismal prognosis, the virtues of palliation and hospice care, and the harms of overtreatment. Like many families, anything other than a “full code” meant giving up on their loved one. In the midst of tragedy, changing that mindset, like the code itself, was often an exercise in futility.&lt;/p&gt;
&lt;p&gt;As my attending and I jogged to her room for the code, this defeat was written all over his face. He already felt he had failed this patient, and now, as the ultimate price to pay for his failure, he had to run the code. And I was his accomplice in harm.&lt;/p&gt;
&lt;p&gt;With adrenaline coursing through my veins, I was amazed at how easy it was to depress the chest wall. I pushed aside my reservations and concentrated on form and rate. My attending called out orders as I rotated through cycles of compressions with two others. Suddenly, in the midst of my second or third cycle, her eyes shot open and locked on mine. I jumped back in surprise as she made a few agonizing attempts for breath, tensing her body in apparent attempt to sit up. Within seconds, her eyes rolled to the back of her head and she again went limp.&lt;/p&gt;
&lt;p&gt;The call to resume compressions came. I felt a few ribs pop under my hands. She showed no further sign of life. After about thirty-five minutes, the attending called it.&lt;/p&gt;
&lt;p&gt;In the time it took to run the code, a family member had arrived and was waiting in a conference room for us. Much to my surprise, my attending didn’t come right out and tell the man his loved one had died. Instead, he described every detail of the code, including the brief moment we “got her back,” before eventually concluding with her death. Equally surprising, the man sat, wordless, through the entire description. I imagined what kind of roller coaster this conversation must have and wondered if it was a harsh or gentle way to break it to him.&lt;/p&gt;
&lt;p&gt;Even as I empathized with him, I found myself judging him. Why had he done that to her? Was he glad she spent the last months of her life in the hospital, barely aware of her surroundings other than her struggle to breathe? Was he glad the last thing she saw was me, a stranger, pounding away at her chest? Did he really believe all the prolonged suffering was worth it? Would he do it all again? The year in the hospital? The anoxic brain injuries? The ventilator-associated pneumonia? The bedsores?&lt;/p&gt;
&lt;p&gt;Hours later, as I was making the long trek out of the hospital to the parking deck, mulling over my involvement in the code, I met her loved one in the hallway. I didn’t recognize him immediately, too caught up in my own thoughts. After walking side-by-side for a few seconds, he spoke.&lt;/p&gt;
&lt;p&gt;“You were in there, weren’t you?” he asked me.&lt;/p&gt;
&lt;p&gt;“Yes, I was.”&lt;/p&gt;
&lt;p&gt;“You all did everything you could, didn’t you?” he asked hopefully.&lt;/p&gt;
&lt;p&gt;I wanted to tell him no. I wanted to tell him that if we had done everything we could she would have gone to the palliative unit or home on hospice. We could have let her go peacefully. Instead, she died in a room full of strangers assaulting her body. I wanted to tell him about the look of agony in her eyes when she opened them the final time. I wanted him to feel the ribs popping, hear the gurgling as she struggled with her last breath. I wanted him to understand her suffering.&lt;/p&gt;
&lt;p&gt;But he couldn’t, and, as I looked into his eyes, I knew I didn’t understand his, either.&lt;/p&gt;
&lt;p&gt;I didn’t know what it was like to lose a loved one so young. I didn’t know what conversations about the end of life he had had with the patient. I didn’t know what the goals of care conversations were like he was a part of (judging from some of the ones I’ve seen since, likely not great). I didn’t know what other family dynamics fed into the decisions he had made. I didn’t know how helpless it must have felt in his situation. His only power over her disease was exerted vicariously through the medical care she received.&lt;/p&gt;
&lt;p&gt;Most importantly, she was no longer suffering. He was.&lt;/p&gt;
&lt;p&gt;“Yes,” I replied, “We did everything we could.”&lt;/p&gt;
&lt;p&gt;Tears welled up in his eyes. “Thank you.”&lt;/p&gt;
&lt;p&gt;Together, we walked in silence to the parking deck.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;J. Lane Wilson is a full-spectrum family physician at the Brody School of Medicine at East Carolina University in Greenville, NC. He is married to another family physician and is the father of two. He enjoys hiking with his family, running, and is a Major League Soccer fanatic.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Illustration by April Brust&lt;/em&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 07 Apr 2019 15:10:39 +0000</pubDate>
<dc:creator>bookofjoe</dc:creator>
<og:title>I Lied When I Said We Did Everything We Could</og:title>
<og:image>https://res.cloudinary.com/dhttas9u5/image/upload/c_fill,h_600,w_1200/btpprreuot3qisifw2wd.jpg</og:image>
<og:description>Op-Med ran the “First Stab” contest in February 2019. We are excited to announce this as the runner-up.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://opmed.doximity.com/articles/i-lied-when-i-said-we-did-everything-we-could</dc:identifier>
</item>
<item>
<title>It&amp;#039;s VHS vs. Beta all over again, but worse</title>
<link>https://www.johnnygrubb.com/its-vhs-vs-beta-all-over-again-but-worse</link>
<guid isPermaLink="true" >https://www.johnnygrubb.com/its-vhs-vs-beta-all-over-again-but-worse</guid>
<description>&lt;h2 id=&quot;title&quot; class=&quot;p-name&quot;&gt;It's VHS vs Beta all over again, but worse&lt;/h2&gt;&lt;div class=&quot;e-content&quot; readability=&quot;70.55082243779&quot;&gt;
&lt;p&gt;(HN inspired update: &lt;a href=&quot;https://moviesanywhere.com&quot; rel=&quot;nofollow&quot;&gt;Movies Anywhere&lt;/a&gt; is the thing I was wanting and can't believe it actually exists)&lt;/p&gt;
&lt;p&gt;I just bought my first Roku powered TV as an upgrade to the bottom-est bottom tier TV that we bought from Costco a couple years ago. This one is also from Costco, but it's a TCL rather than an Element brand, so it's like the second rung on the ladder. Roku is waaaaay better than the imitation version that was on the Element TV and generally I'm pleased. You can add channels and do all the stuff that I realize now qualifies as the “cord cutting” I've been reading about forever.&lt;/p&gt;
&lt;p&gt;We bought an Apple TV probably 4-5 years ago and at some point in the last 12 months it's crapped out on us, so I'm conscripted into plugging my laptop in to the TV to watch any of the dozens of kids movies we've bought on iTunes over that time.&lt;/p&gt;
&lt;p&gt;This has always irked me because none of those movies ever worked in the car's DVD player/entertainment system thingy when we go on road trips. It's a shame too, because we've only recently discovered that the headphones that came with the car for the DVD player not only work, but will let Michelle and I listen to Wait, Wait without the loud protestations of the kids (since they can watch a movie while we listen to podcasts). I have to stop at Target and trawl through the discount kid's DVDs for the car.&lt;/p&gt;
&lt;p&gt;In many ways the future is damn handy.&lt;/p&gt;
&lt;p&gt;But now we got this Roku TV and it comes with Amazon Prime so that's great, but I want to watch one of the movies we bought on iTunes. I don't want to start buying a library of movies on Amazon, because I already have a library of movies on iTunes (that they won't let me watch on anything but an Apple product :| ). Neither of these systems will let me burn to a DVD so we can watch them in the car, and neither of their apps will let me bounce out of my iPhone into the car's V-RCA inputs.&lt;/p&gt;
&lt;p&gt;Is it that hard to let things interoperate? Can Apple please just relent and let Roku have an iTunes app? I'm not buying another fucking Apple TV. I'm not. I don't give a shit about games or 4K or an internal drive, I just want to watch the fucking movies I bought (or licensed, fuck you Hollywood). I may as well have to lug around a VHS player to plug in to all these screens, it's absolutely ridiculous and completely anti-customer. You all deserve the eventual death or disruption you suffer.&lt;/p&gt;
&lt;/div&gt;
</description>
<pubDate>Sun, 07 Apr 2019 14:28:36 +0000</pubDate>
<dc:creator>Jgrubb</dc:creator>
<og:title>It's VHS vs Beta all over again, but worse</og:title>
<og:description>(HN inspired update: Movies Anywhere is the thing I was wanting and can&amp;#39;t believe it actually exists) I just bought my first Roku po...</og:description>
<og:type>article</og:type>
<og:url>https://www.johnnygrubb.com/its-vhs-vs-beta-all-over-again-but-worse</og:url>
<og:image>https://write.as/img/w-sq-light.png</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.johnnygrubb.com/its-vhs-vs-beta-all-over-again-but-worse</dc:identifier>
</item>
<item>
<title>All of Toyota’s electric vehicle patents are now royalty-free</title>
<link>https://www.topgear.com/car-news/electric/toyota-sharing-its-ev-secrets-free</link>
<guid isPermaLink="true" >https://www.topgear.com/car-news/electric/toyota-sharing-its-ev-secrets-free</guid>
<description>&lt;p&gt;As a general rule, car companies are extremely secretive about their technological developments. Anything that could provide a USP or give an edge over the competition is kept under lock and key – being guarded more fervently than the recipe for Coca-Cola. &lt;/p&gt;
&lt;p&gt;However, Toyota has now offered royalty-free licences on almost 24,000 of its electric vehicle patents.&lt;/p&gt;
&lt;p&gt;This essentially means that any company wishing to build a hybrid or fully electric vehicle will have complete access to all of Toyota’s work without having to pay a single penny.&lt;/p&gt;

&lt;p&gt;And if you’re struggling to make sense of the drawings and literature that make up the patent, Toyota will also offer technical support to any manufacturer that requests their assistance. Any advice given will come with a fee of course – you didn’t think everything would be free, did you?&lt;/p&gt;
&lt;p&gt;In total though, 23,740 patents will be available from the past 20 years of Toyota’s development of hybrid technology. That’s a whole lot of tech. Tech which Toyota helps will speed-up the manufacture and uptake of hybrid or electric vehicles across the world in the face of ever-worsening climate change.&lt;/p&gt;

&lt;p&gt;“Based on the high volume of enquiries we receive about our vehicle electrification systems from companies that recognise a need to popularise hybrid and other electrified vehicle technologies, we believe that now is the time for cooperation,” said Shigeki Terashi, Executive Vice President of Toyota. &lt;/p&gt;
&lt;p&gt;“If the number of electrified vehicles accelerates significantly in the next ten years, they will become standard, and we hope to play a role in supporting that process.”&lt;/p&gt;
&lt;p&gt;Is this the start of a new, sharing-is-caring attitude in the motoring industry?&lt;/p&gt;
</description>
<pubDate>Sun, 07 Apr 2019 12:04:48 +0000</pubDate>
<dc:creator>e2e4</dc:creator>
<og:type>article</og:type>
<og:title>Toyota is sharing its EV secrets for free</og:title>
<og:url>https://www.topgear.com/car-news/electric/toyota-sharing-its-ev-secrets-free</og:url>
<og:description>As a general rule, car companies are extremely secretive about their technological developments. Anything that could provide a USP or give an edge over the competition is kept under lock and key – being guarded more fervently than the recipe for Coca-Cola. However, Toyota has now offered royalty-free licences on almost 24,000 of its electric vehicle patents.This essentially means that any company wishing to build a hybrid or fully electric vehicle will have complete access to all of Toyota’s work without having to pay a single penny.</og:description>
<og:image>https://www.topgear.com/sites/default/files/styles/16x9_1280w/public/images/news-article/2019/04/b041c7b75df04c09fabdc2e1115efec4/001_prius-plug-in-hybrid-ext-dynamic.jpg?itok=Zh9JuKoc</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.topgear.com/car-news/electric/toyota-sharing-its-ev-secrets-free</dc:identifier>
</item>
<item>
<title>Chrome, Safari, and Edge to Prevent Disabling of Click Tracking Privacy Risk</title>
<link>https://www.bleepingcomputer.com/news/software/major-browsers-to-prevent-disabling-of-click-tracking-privacy-risk/</link>
<guid isPermaLink="true" >https://www.bleepingcomputer.com/news/software/major-browsers-to-prevent-disabling-of-click-tracking-privacy-risk/</guid>
<description>&lt;p&gt;&lt;img alt=&quot;Privacy&quot; height=&quot;469&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;1280&quot; data-src=&quot;https://www.bleepstatic.com/images/stock-photos/security/spyware.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Newer versions of Chrome, Safari, and Opera will no longer allow you to disable hyperlink auditing, which is a concern for those seeking maximum privacy. While some of these browsers previously allowed you to disable this feature, newer versions are going in the opposite direction.&lt;/p&gt;
&lt;p&gt;Hyperlink auditing is an &lt;a href=&quot;https://html.spec.whatwg.org/multipage/links.html#hyperlink-auditing&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot;&gt;HTML standard&lt;/a&gt; that can be used to track clicks on web site links. This is done by creating special links that ping back to a specified URL when they are clicked on. These pings are done in the form of a POST request to the specified web page, which can then examine the request headers to see what page the click came from.&lt;/p&gt;
&lt;p&gt;To create a hyperlink auditing URL, you can simply create a normal hyperlink HTML tag, but also include a ping=&quot;[url]&quot; variable as shown below. &lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;Ping HTML Link&quot; height=&quot;72&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;590&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/html-example.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;Ping HTML Link&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;This will render on the page as a normal link to google.com and if you hover over it, will only show you the destination URL. It does not show you the ping back URL of https://www.bleepingcomputer.com/pong.php, so users will not even realize this is happening unless they examine the sites source code.&lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;Hover shows link URL, but not ping back URL&quot; height=&quot;398&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;785&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/hover-ping.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;Hover shows link URL, but not ping back URL&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;When a user clicks on the above link, the browser will first send a POST request back to the ping URL https://www.bleepingcomputer.com/pong.php as shown below. It will then open the www.google.com page.  This means that every time a user clicks on a hyperlink audited link, the browser will make two requests instead of one.&lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;Example Ping POST Request&quot; height=&quot;262&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;679&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/ping.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;Example Ping POST Request&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;Scripts that receive the ping POST request, can then parse the headers in order to see what page the ping came from and where the hyperlink audited link was going to. The headers associated with the information sent in the ping request are shown below.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;    [HTTP_PING_FROM] =&amp;gt; https://www.bleepingcomputer.com/ping.html
    [HTTP_PING_TO] =&amp;gt; https://www.google.com/
    [CONTENT_TYPE] =&amp;gt; text/ping
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;As you can see, using Hyperlink Auditing developers can track link clicks from any web property that they have access to.&lt;/p&gt;
&lt;h2&gt;Most browsers will not let you disable in the future&lt;/h2&gt;
&lt;p&gt;With privacy and online tracking being such a large problem and major concern for many users, you would think that browser developers would give you the option to disable anything that could affect your privacy.&lt;/p&gt;
&lt;p&gt;Unfortunately, this seems to be going in the reverse direction when it comes to hyperlink auditing.&lt;/p&gt;
&lt;p&gt;According to developer Jeff Johnson, Safari enabled hyperlink auditing by default, but allowed you to disable it by using the following hidden preference.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;defaults write com.apple.Safari com.apple.Safari.ContentPageGroupIdentifier.WebKit2HyperlinkAuditingEnabled -bool false&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Johnson has stated that this flag no longer works with Safari 12.1.&lt;/p&gt;
&lt;p&gt;&quot;Unfortunately, this no longer works in Safari 12.1. I actually discovered the issue in Safari Technology Preview 72, and I filed a Radar on January 2, 2019 as &lt;a href=&quot;rdar://problem/47000341&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot;&gt;rdar://problem/47000341&lt;/a&gt;,&quot; Johnson stated in a &lt;a href=&quot;https://lapcatsoftware.com/articles/Safari-link-tracking.html&quot; target=&quot;_blank&quot;&gt;blog post&lt;/a&gt;. &quot;Despite several months notice from me, Apple shipped Safari 12.1 last week to the public with no way to disable hyperlink auditing. I hope to raise awareness about this issue, with the ultimate goal of getting hyperlink auditing disabled by default in Safari. Apple claims that Safari is supposed to protect your privacy and prevent cross-site tracking, but hyperlink auditing is a wide open door to cross-site tracking that still exists. To end this article, I'll quote the full text of the Radar that I filed:&quot;&lt;/p&gt;
&lt;p&gt;Google Chrome also enables this tracking feature by default, but in the current Chrome 73 version it includes a &quot;Hyperlink auditing&quot; flag that can be used to disable it from the chrome://flags URL.&lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;Chrome 73 Hyperlink Auditing Flag&quot; height=&quot;131&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;920&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/chrome-flags.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;Chrome 73 Hyperlink Auditing Flag&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;In the Chrome 74 Beta and Chrome 75 Canary builds, though, this flag has been removed and there is no way to disable hyperlink auditing.&lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;No Hyperlink auditing flag in Chrome 74&quot; height=&quot;731&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;1204&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/chrome-74-beta-flag-gone.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;No Hyperlink auditing flag in Chrome 74&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;The current version of Microsoft Edge also enables hyperlink auditing by default and provides no way to disable it that I could find. I also took a look at the upcoming Microsoft Edge Insider build and as it's based on Chromium 75, there is no way to disable hyperlink auditing on that browser either.&lt;/p&gt;
&lt;p&gt;Like Edge, Opera is also based on Chromium, and the Opera 61 Developer build removes the option to disable hyperlink auditing as well.&lt;/p&gt;
&lt;p&gt;Finally, I also tested it the mobile versions of Chrome and Safari and its enabled by default with no way of disabling it.&lt;/p&gt;
&lt;p&gt;What this means is that starting next month when Chrome 74 is released to the stable branch, the Edge, Chrome, Opera, and Safari browsers will no longer offer a way of disabling this tracking feature and privacy risk.&lt;/p&gt;
&lt;h2&gt;Firefox and Brave win the award&lt;/h2&gt;
&lt;p&gt;Of all the browsers I tested, only Brave and Firefox currently disable it by default and do not appear to have any plans on enabling it in the future.&lt;/p&gt;
&lt;p&gt;Firefox 66, Firefox Beta 67, and Firefox Nightly 68 disable Hyperlink auditing by default and allow users to enable it using the &lt;strong&gt;browser.send_pings&lt;/strong&gt; about:config setting.&lt;/p&gt;
&lt;div&gt;&lt;img alt=&quot;Firefox 66 Setting&quot; height=&quot;39&quot; src=&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==&quot; width=&quot;971&quot; data-src=&quot;https://www.bleepstatic.com/images/news/web-browsers/features/h/hyperlink-auditing/firefox-about-config.jpg&quot; class=&quot;b-lazy&quot;/&gt;&lt;strong&gt;Firefox 66 Setting&lt;/strong&gt;&lt;/div&gt;
&lt;p&gt;The privacy focused Brave Browser also disables it by default and does not allow you to enable it at all. It does have a display bug in the brave://flags that show that Hyperlink auditing is enabled, but this is a carryover from Chrome and is not displayed correctly.&lt;/p&gt;
&lt;p&gt;Going forward, if privacy is important to you and you want to reduce the risk of being tracked online, then you will need to use Firefox or Brave.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 4/7/19&lt;/strong&gt;: Cleaned up the confusing first paragraph.&lt;/p&gt;

</description>
<pubDate>Sun, 07 Apr 2019 11:05:51 +0000</pubDate>
<dc:creator>Athas</dc:creator>
<og:url>https://www.bleepingcomputer.com/news/software/major-browsers-to-prevent-disabling-of-click-tracking-privacy-risk/</og:url>
<og:type>article</og:type>
<og:title>Major Browsers to Prevent Disabling of Click Tracking Privacy Risk</og:title>
<og:description>Newer versions of Chrome, Safari, and Opera will no longer allow you to disable hyperlink auditing, which is a concern for those seeking maximum privacy. While some of these browsers previously allowed you to disable this feature, newer versions are going in the opposite direction.</og:description>
<og:image>https://www.bleepstatic.com/content/hl-images/2016/04/15/spyware-292-176.png</og:image>
<dc:language>en-us</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.bleepingcomputer.com/news/software/major-browsers-to-prevent-disabling-of-click-tracking-privacy-risk/</dc:identifier>
</item>
<item>
<title>Study: Two Monitors or One Ultrawide</title>
<link>https://keenethics.com/blog/1497078000000-two-monitors-or-one-ultrawide</link>
<guid isPermaLink="true" >https://keenethics.com/blog/1497078000000-two-monitors-or-one-ultrawide</guid>
<description>&lt;p&gt;&lt;img alt=&quot;Two Monitors or One Ultrawide&quot; src=&quot;https://keenethics.com/static/posts/two-monitors-or-one-ultrawide-1.jpg&quot;/&gt;&lt;/p&gt;

&lt;p&gt;At Keenethics, we always think of a new way to improve our productivity, and in this case study, we draw attention to monitors. The small size of a monitor does not allow a user to have a lot of windows simultaneously opened and makes a user switch between windows, which is time-consuming.&lt;/p&gt;
&lt;p&gt;Obviously, we are not the first ones to think of that. Researchers from NEC came to such conclusions:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;A widescreen monitor improves the productivity as much as two monitors combined.&lt;/li&gt;
&lt;li&gt;A 22-inch monitor increases performance by 30% compared to a 19-inch one.&lt;/li&gt;
&lt;li&gt;A 26-inch monitor increases performance by 20% compared to a 22-inch one.&lt;/li&gt;
&lt;li&gt;Yet, the performance when working with a 30-inch monitor dropped compared to the 26-inch “champion”.&lt;/li&gt;
&lt;li&gt;However, working with a monitor as large as 30 inches is still more productive than with a 19-inch one.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;The DELL company claims that using two monitors simultaneously, provided they were both assigned directly to work tasks and not YouTube surfing, would boost an employee’s performance by as much as 30%. These claims, of course, may be somewhat biased.&lt;/p&gt;
&lt;p&gt;Psychology professor David Meyer of the University of Michigan argues that working with multiple monitors, in contrast to concentrating on one, can negatively affect productivity. People are distracted and their workflow gets constantly interrupted.&lt;/p&gt;
&lt;p&gt;Developer Corey House writes: “People can focus only on one thing at a time. So, why do we spend money to display several things at once? If my email or social networking channels are available at a glance, I will check them all the time. This is not just unnecessary, it is counterproductive. One monitor means that my work — and only my work — is displayed in front and center. Distractions remain out of sight, and, therefore, out of mind.”&lt;/p&gt;
&lt;p&gt;Every man to his own opinion, so we decided to conduct our own research.&lt;/p&gt;
&lt;h2&gt;The Study&lt;/h2&gt;
&lt;p&gt;Three people were selected for the study: the first person received a 24” monitor, the second participant – a 25” monitor with a 21: 9 aspect ratio, and the third participant – two 24” monitors. The study lasted for three weeks. Each week, the participants swapped their monitors and, on Friday, performed the same tasks using the monitors they had been working on for the last four days.&lt;/p&gt;
&lt;h2&gt;Performance and Productivity&lt;/h2&gt;
&lt;p&gt;The study showed that the participants who performed tasks using two monitors spent less time compared to those who used a single monitor. It can be explained by the fact that opening the program for the task on one monitor and the task itself and the search engine on the other one, the employee spends less time switching between tabs, reviewing the task, etc. On an average of 10 minutes working on one monitor, a person switches about 10–15 times between tabs, while in the case of two monitors, this number drops almost twice. Moreover, participants report that switching between tabs worsens concentration.&lt;/p&gt;
&lt;h2&gt;Health Effects&lt;/h2&gt;
&lt;p&gt;Naturally, when working with two monitors, you have to turn your head more often. When working with two monitors, employees make a turn of the neck up to 10° more compared to using a single monitor. Accordingly, the difference in neck movement between using a single 24-inch monitor and a 25-inch one is also there but insignificant. Therefore, while working on 2 monitors may require massages or physical exercises to reduce neck strain, one monitor is lean and mean.&lt;/p&gt;
&lt;h2&gt;&lt;span&gt;Summary&lt;/span&gt;&lt;/h2&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Two Monitors&lt;/th&gt;
&lt;th&gt;One Ultrawide Monitor&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;Greater Productivity&lt;/td&gt;
&lt;td&gt;Less health harm&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td/&gt;
&lt;td&gt;Lower costs&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td/&gt;
&lt;td&gt;Less space in the workplace needed&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Thanks for taking part in the experiment: Volodymyr Andrushak, Rostislav Tanchak, Mikhail Fedorovich, Marina Yanul, and Mikhailo Ostrovyy.&lt;/p&gt;
</description>
<pubDate>Sun, 07 Apr 2019 10:42:36 +0000</pubDate>
<dc:creator>epaminond</dc:creator>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://keenethics.com/blog/1497078000000-two-monitors-or-one-ultrawide</dc:identifier>
</item>
</channel>
</rss>