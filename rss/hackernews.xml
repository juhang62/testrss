<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Teleforking a Process onto a Different Computer</title>
<link>https://thume.ca/2020/04/18/telefork-forking-a-process-onto-a-different-computer/</link>
<guid isPermaLink="true" >https://thume.ca/2020/04/18/telefork-forking-a-process-onto-a-different-computer/</guid>
<description>&lt;p class=&quot;meta&quot;&gt;18 April 2020&lt;/p&gt;
&lt;p&gt;One day a coworker mentioned that he was thinking about APIs for distributed compute clusters and I jokingly responded “clearly the ideal API would be simply calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork()&lt;/code&gt; and your process wakes up on every machine of the cluster with the return value being the instance ID”. I ended up captivated by this idea: I couldn’t get over how it was clearly silly, yet way easier than any remote job API I’d seen, and also seemingly not a thing computers could do. I also kind of knew how I could do it, and I already had a good name which is the hardest part of any project, so I got to work.&lt;/p&gt;
&lt;p&gt;In one weekend I had a basic prototype, and in another weekend I had a demo where I could &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; a process to a giant VM in the cloud, run a path tracing render job on lots of cores, then telefork the process back, all wrapped in a simple API.&lt;/p&gt;
&lt;p&gt;Here’s a video of it running a render on a 64 core cloud VM in 8 seconds (plus 6s each for the telefork there and back). The same render takes 40s running locally in a container on my laptop:&lt;/p&gt;
Sorry, your browser doesn't support embedded videos.
&lt;p&gt;How is it possible to teleport a process? That’s what this article is here to explain! The basic idea is that at a low level a Linux process has only a few different parts, and for each of them you just need a way to retreive it from the donor, stream it over the network, and copy it into the cloned process.&lt;/p&gt;
&lt;p&gt;You may be thinking, “but wait, how can you replicate [some reasonable thing like a TCP connection]?” Basically I just don’t replicate tricky things so that I could keep it simple, meaning it’s &lt;strong&gt;just a fun tech demo&lt;/strong&gt; you probably shouldn’t use for anything real. It can still teleport a broad class of mostly computational programs though!&lt;/p&gt;
&lt;h2 id=&quot;what-does-it-look-like&quot;&gt;What does it look like&lt;/h2&gt;
&lt;p&gt;I wrote it as a Rust library but in theory you could wrap it in a C API and then use it via FFI bindings to teleport even a Python process. &lt;a href=&quot;https://github.com/trishume/telefork&quot;&gt;The implementation&lt;/a&gt; is only about 500 lines of code (plus 200 lines of comments) and you use it like this:&lt;/p&gt;
&lt;div class=&quot;language-rust highlighter-rouge&quot; readability=&quot;9&quot;&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;13&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;
&lt;code&gt;&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;telefork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;telefork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TeleforkLocation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;destination&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.expect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;expected arg: address of teleserver&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;TcpStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.unwrap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;telefork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.unwrap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nn&quot;&gt;TeleforkLocation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nd&quot;&gt;println!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;I teleported to another computer and was passed {}!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nn&quot;&gt;TeleforkLocation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parent&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;println!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Done sending!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;I also provide a helper called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yoyo&lt;/code&gt; that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt;s to a server, executes a closure you give it, then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt;s back. This provides the illusion that you can easily run a snippet of code on a remote server, perhaps one with much more compute power available.&lt;/p&gt;
&lt;div class=&quot;language-rust highlighter-rouge&quot; readability=&quot;12&quot;&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;19&quot;&gt;
&lt;pre class=&quot;highlight&quot;&gt;
&lt;code&gt;&lt;span class=&quot;c&quot;&gt;// load the scene locally, this might require loading local scene files to memory&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scene&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create_scene&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backbuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;vec!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;Vec3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nn&quot;&gt;telefork&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;yoyo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;// do a big ray tracing job on the remote server with many cores!&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;render_scene&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scene&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;mut&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backbuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;// write out the result to the local file system&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;save_png_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backbuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;anatomy-of-a-linux-process&quot;&gt;Anatomy of a Linux process&lt;/h2&gt;
&lt;p&gt;Let’s look at what a process on Linux (the OS &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; works on) looks like:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://thume.ca/assets/postassets/telefork/process_anatomy.png&quot; alt=&quot;Anatomy of a process diagram&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Memory mappings:&lt;/strong&gt; These specify the ranges of bytes from the space of possible memory addresess that our program is using, composed of “pages” of 4 kilobytes. You can inspect them for a process using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/proc/&amp;lt;pid&amp;gt;/maps&lt;/code&gt; file. These contain both all the executable code of our program as well as the data it is working with.
&lt;ul&gt;&lt;li&gt;There are a few different types of these but we can treat these as just ranges of bytes that need to be copied and recreated at the same place (with the exception of some special ones).&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Threads:&lt;/strong&gt; A process can have multiple threads executing simultaneously on the same memory. These have ids and maybe some other state but when they’re paused they’re mainly described by the registers of the processor corresponding to the point of execution. Once we have all the memory copied we can just copy the register contents over into a thread on the destination process and then resume it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;File descriptors:&lt;/strong&gt; The operating system has a table mapping ordinary integers to special kernel resources. You can do things with these resources by passing those integers to &lt;a href=&quot;http://man7.org/linux/man-pages/man2/syscalls.2.html&quot;&gt;syscalls&lt;/a&gt;. There are a whole bunch of different types of resources these file descriptors can point to and some of them like TCP connections can be tricky to clone.
&lt;ul&gt;&lt;li&gt;I just gave up on this part and don’t handle them at all. The only ones that work are stdin/stdout/stderr since those are always mapped to 0, 1 and 2 for you.&lt;/li&gt;
&lt;li&gt;That doesn’t mean it’s not possible to handle them, it just would take some extra work I’ll talk about later.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Miscellaneous:&lt;/strong&gt; There’s some other miscellaneous pieces of process state that vary in difficulty to replicate and most of the time aren’t important. Examples include the &lt;a href=&quot;http://man7.org/linux/man-pages/man2/brk.2.html&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brk&lt;/code&gt; heap pointer&lt;/a&gt;. Some of these are only possible to restore using weird tricks or special syscalls like &lt;a href=&quot;https://lore.kernel.org/patchwork/patch/494297/&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PR_SET_MM_MAP&lt;/code&gt;&lt;/a&gt; that were added by other restoration efforts.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;So we can make a basic &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; implementation by just figuring out how to recreate the memory mappings and main thread registers. This should handle simple programs that mostly do computation without interacting with OS resources like files (in a way that needs to be teleported, opening a file on one system and closing it before calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; is fine).&lt;/p&gt;
&lt;h2 id=&quot;how-to-telefork-a-process&quot;&gt;How to telefork a process&lt;/h2&gt;
&lt;p&gt;I wasn’t the first to think of the possibility of recreating a process on another machine. I emailed &lt;a href=&quot;https://robert.ocallahan.org/&quot;&gt;@rocallahan&lt;/a&gt;, the author of &lt;a href=&quot;https://github.com/mozilla/rr&quot;&gt;the rr record and replay debugger&lt;/a&gt; to ask some questions since rr does some very similar things to what I wanted to do. He let me know of the existence of &lt;a href=&quot;https://criu.org/Main_Page&quot;&gt;CRIU&lt;/a&gt;, which is an existing system that can stream a Linux process to a different system, designed for live migrating containers between hosts. CRIU supports restoring all sorts of file descriptors and other state, however the code was really complex and used lots of syscalls that required special kernel builds or root permissions. Linked from the CRIU wiki page I found &lt;a href=&quot;http://dmtcp.sourceforge.net/&quot;&gt;DMTCP&lt;/a&gt; which was built for snapshotting distributed supercomputer jobs so they could be restarted later, and it had &lt;a href=&quot;https://github.com/dmtcp/dmtcp/blob/7d02a2e063a8e70cc4d836d0b658124614666f44/src/mtcp/mtcp_restart.c&quot;&gt;easier to follow code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;These didn’t dissuade me from trying to implement my own system since they’re super complex and require special runners and infrastructure, and I wanted to show how simple a basic teleport can be and make it just a library call. So I read pieces of source code from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rr&lt;/code&gt;, CRIU, DMTCP, and some ptrace examples, and put together my own &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; procedure. My method works in its own way that’s a hodgepodge of different techniques.&lt;/p&gt;
&lt;p&gt;In order to teleport a process, there’s both work that needs to be done in the source process which calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt;, and at the call to the function which receives a streamed process on the server and recreates it from the stream (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telepad&lt;/code&gt;). These can happen concurrently, but it’s also possible to do all the serializing before loading, for example by dumping to a file then loading later.&lt;/p&gt;
&lt;p&gt;Below is a simplified overview of both processes, if you want to know exactly how everything happens I encourage you to read &lt;a href=&quot;https://github.com/trishume/telefork/blob/master/src/lib.rs&quot;&gt;the source&lt;/a&gt;. It’s heavily commented, all in one file, and ordered so you can read it top to bottom to understand how everything works.&lt;/p&gt;
&lt;h2 id=&quot;sending-a-process-using-telefork&quot;&gt;Sending a process using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; function is given a writeable stream over which it sends all the state of its process.&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;strong&gt;Fork the process&lt;/strong&gt; into a frozen child. It can be hard for a process to inspect its own state since as it inspects the state things like the stack and registers change. We can avoid this by using a normal Unix &lt;a href=&quot;http://man7.org/linux/man-pages/man2/fork.2.html&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fork&lt;/code&gt;&lt;/a&gt; and then have the child stop itself so we can inspect it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Inspect the memory mappings.&lt;/strong&gt; This can be done by parsing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/proc/&amp;lt;pid&amp;gt;/maps&lt;/code&gt; to find out where all the memory maps are. I used the &lt;a href=&quot;https://github.com/rbspy/proc-maps&quot;&gt;proc_maps crate&lt;/a&gt; for this.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Send the info for special kernel maps.&lt;/strong&gt; Based on what DMTCP does, instead of copying the contents of special kernel maps we remap them, and this is best done before the rest of the mapping so we stream them first without their contents. These special maps like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[vdso]&lt;/code&gt; are used to make certain syscalls like getting the time faster.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Loop over the other memory maps and stream them&lt;/strong&gt; to the provided pipe. I first serialize a structure containing info about the mapping and then I loop over the pages in it and use the &lt;a href=&quot;http://man7.org/linux/man-pages/man2/process_vm_readv.2.html&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;process_vm_readv&lt;/code&gt;&lt;/a&gt; syscall to copy memory from the child to a buffer, then write that buffer to the channel.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Send the registers.&lt;/strong&gt; I use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_GETREGS&lt;/code&gt; option for the &lt;a href=&quot;http://man7.org/linux/man-pages/man2/ptrace.2.html&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ptrace&lt;/code&gt; syscall&lt;/a&gt;, which allows me to get all register values of the child process. Then I just write them in a message over the pipe.&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;running-syscalls-in-a-child-process&quot;&gt;Running syscalls in a child process&lt;/h2&gt;
&lt;p&gt;In order to mold a target process into a copy of the incoming process we’ll need to get the process to execute a bunch of syscalls on itself without having access to any code, because we’ve deleted it all. Here’s how I do remote syscalls using &lt;a href=&quot;http://man7.org/linux/man-pages/man2/ptrace.2.html&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ptrace&lt;/code&gt;&lt;/a&gt;, which is a versatile syscall for manipulating and inspecting other processes:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;strong&gt;Find a syscall instruction&lt;/strong&gt;. You need at least one syscall instruction for the child to execute to be in an executable mapping. Some people patch one in, but instead I use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;process_vm_readv&lt;/code&gt; to read the first page of the kernel &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[vdso]&lt;/code&gt; mapping, which as far as I know contains at least one syscall in all Linux versions so far, and then search through the bytes for its offset. I only do this once and update it when I move the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[vdso]&lt;/code&gt; mapping.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Set up the registers&lt;/strong&gt; to execute a syscall using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_SETREGS&lt;/code&gt;. The instruction pointer points to the syscall instruction, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rax&lt;/code&gt; holds the &lt;a href=&quot;https://filippo.io/linux-syscall-table/&quot;&gt;Linux syscall number&lt;/a&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rdi, rsi, rdx, r10, r8, r9&lt;/code&gt; hold the arguments.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Step the process one instruction&lt;/strong&gt; using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_SINGLESTEP&lt;/code&gt; option to execute the syscall instruction.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Read the registers&lt;/strong&gt; using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_GETREGS&lt;/code&gt; to retreive the syscall return value and see if it succeeded.&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;receiving-a-process-using-telepad&quot;&gt;Receiving a process using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telepad&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Using this primitive and ones I’ve already described we can recreate the process:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;&lt;strong&gt;Fork a frozen child.&lt;/strong&gt; Similar to sending except this time we need a child process we can manipulate to turn it into a clone of the process being streamed in.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Inspect the memory mappings.&lt;/strong&gt; This time we need to know all the existing memory maps so we can remove them to make room for the incoming process.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Unmap the existing mappings.&lt;/strong&gt; We loop over each of the mappings and manipulate the child process into calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;munmap&lt;/code&gt; on them.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Remap the special kernel mappings.&lt;/strong&gt; Read their destinations from the stream and use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mremap&lt;/code&gt; to remap them to their target destination.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stream in the new mappings.&lt;/strong&gt; Use remote &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mmap&lt;/code&gt; to create the mappings, then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;process_vm_writev&lt;/code&gt; to stream memory pages into them.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Restore the registers.&lt;/strong&gt; Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_SETREGS&lt;/code&gt; to restore the registers for the main thread that were sent over, with the exception of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rax&lt;/code&gt; which is the return value for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;raise(SIGSTOP)&lt;/code&gt; that the snapshotted process stopped on, which we overwrite with an arbitrary integer passed to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telepad&lt;/code&gt;.
&lt;ul&gt;&lt;li&gt;The arbitrary value is used so the telefork server can pass the file descriptor of the TCP connection the process came in on, so that it can send data back, or in the case of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yoyo&lt;/code&gt; execute a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt; back over the same connection.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Restart the process&lt;/strong&gt; with its brand new contents by using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PTRACE_DETACH&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;doing-more-things-properly&quot;&gt;Doing more things properly&lt;/h2&gt;
&lt;p&gt;There’s a few things that are still broken in my implementation of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telefork&lt;/code&gt;. I know how to fix them all, but I’m satisfied with how much I’ve implemented and sometimes they’re tricky to fix. This describes a few interesting examples of those things:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Handling the vDSO properly. I &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mremap&lt;/code&gt; the vDSO in the same way that &lt;a href=&quot;https://github.com/dmtcp/dmtcp/blob/7d02a2e063a8e70cc4d836d0b658124614666f44/src/mtcp/mtcp_restart.c#L813&quot;&gt;DMTCP does&lt;/a&gt; but that turns out to work only when restoring on the exact same kernel build. Copying the vDSO contents instead can work accross different builds of the same version, which is how I got my path tracing demo to work since getting the number of CPU cores in glibc checks the current time using the vDSO in order to cache the count. However the way to actually do it properly is to either patch all the vDSO functions to just execute syscall instructions like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rr&lt;/code&gt; does, or to patch each vDSO function to jump to the vDSO function from the donor process.&lt;/li&gt;
&lt;li&gt;Restoring &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brk&lt;/code&gt; and other miscellaneous state. I tried to use a method from DMTCP to restore the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brk&lt;/code&gt; pointer but it only works if the target &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brk&lt;/code&gt; is greater than the donor’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brk&lt;/code&gt;. The correct way to do it that also restores other things is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PR_SET_MM_MAP&lt;/code&gt;, but that requires elevated permissions and a kernel build flag.&lt;/li&gt;
&lt;li&gt;Restoring thread local storage. Thread local storage in Rust seems to just work™ presumably because the FS and GS registers are restored, but there’s apparently some kind of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;glibc&lt;/code&gt; cache of the pid and tid that might mess up a different kind of thread local storage. One solution CRIU can do using fancy namespaces is restore the process with the same PID and TIDs.&lt;/li&gt;
&lt;li&gt;Restore some file descriptors. This could be done either using individual strategies for each type of file descriptor, like checking if a file with the same name/contents exists on the destination system, or forwarding all reads/writes to the process source system using FUSE. However it’s a ton of effort to support all the types of file descriptors, like running TCP connections, so DMTCP and CRIU just painstakingly implement the most common types and give up on things like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf_event_open&lt;/code&gt; handles.&lt;/li&gt;
&lt;li&gt;Handling multiple threads. Normal Unix &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fork()&lt;/code&gt; doesn’t do this, but it should just involve stopping all threads before the memory streaming, then copying their registers and reinstating them in threads in the cloned process.&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;even-crazier-ideas&quot;&gt;Even crazier ideas&lt;/h2&gt;
&lt;p&gt;I think this shows that some crazy things you might have thought weren’t possible can in fact be done given the right low level interfaces. Here’s some ideas extending on the basic telefork ideas that are totally possible to implement, although perhaps only with a very new or patched kernel:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Cluster telefork.&lt;/strong&gt; The original inspiration for telefork was the idea of streaming a process onto every machine in a compute cluster. You could maybe even use UDP multicast or peer-to-peer techniques to make the distribution of memory to the whole cluster faster. You probably also want to provide communication primitives.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Lazy memory streaming.&lt;/strong&gt; CRIU submitted patches to the kernel to add something called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;userfaultfd&lt;/code&gt; that can catch page faults and map in new pages more efficiently than &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SIGSEGV&lt;/code&gt; handlers and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mmap&lt;/code&gt;. This can let you stream in new pages of memory only as they are accessed by the program, allowing you to teleport processes with lower latency since they can start running basically right away.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Remote threads!&lt;/strong&gt; You could transparently make a process think it was running on a machine with a thousand cores. You could use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;userfaultfd&lt;/code&gt; plus a &lt;a href=&quot;https://patchwork.kernel.org/cover/11005675/&quot;&gt;patch set for userfaultfd write protection&lt;/a&gt; &lt;a href=&quot;https://github.com/torvalds/linux/commit/63bef48fd6c9d3f1ba4f0e23b4da1e007db6a3c0&quot;&gt;which was just merged earlier this month&lt;/a&gt; to implement a cache-coherency algorithm like &lt;a href=&quot;https://en.wikipedia.org/wiki/MESI_protocol&quot;&gt;MESI&lt;/a&gt; to replicate the process memory across a cluster of machines efficiently such that memory would only need to be transferred when one machine read a page another wrote to since its last read. Then threads are just sets of registers that are very cheap to distribute across machines by swapping them into the registers of pools of kernel threads, and intelligently rearrange so they’re on the same machine as other threads they communicate with. You could even make syscalls work by pausing on syscall instructions, transferring the thread to the original host machine, executing the syscall, then transferring back. This is basically the way your multi-core or multi-socket CPU works except using pages instead of cache lines and the network instead of buses. The same techniques like minimizing sharing between threads that work for multi-core programming would make programs run efficiently here. I think this could actually be very cool, although it might need more kernel support to work seamlessly, but it could allow you to program a distributed cluster the same way you program a many-core machine and (with a bunch of optimization tricks I haven’t yet written about) have it be competitively efficient with the distributed system you otherwise would have written.&lt;/li&gt;
&lt;/ul&gt;&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I think this stuff is really cool because it’s an instance of one of my favourite techniques, which is diving in to find a lesser-known layer of abstraction that makes something that seems nigh-impossible actually not that much work. Teleporting a computation may seem impossible, or like it would require techniques like serializing all your state, copying a binary executable to the remote machine, and running it there with special command line flags to reload the state. But underneath your favourite programming language there’s a layer of abstraction where you can choose a fairly simple subset of things that make it possible to teleport at least most pure computations in any language in 500 lines of code and a single weekend. I think this kind of diving down often leads to solutions that are simpler and more universal. Another one of my projects like this is &lt;a href=&quot;https://blog.janestreet.com/commas-in-big-numbers-everywhere/&quot;&gt;Numderline&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Of course, they often seem like extremely cursed hacks and to a large extent they are. They do things in a way nobody expects, and when they break they break at a layer of abstraction they aren’t supposed to break at, like your file descriptors mysteriously dissapearing. Sometimes though you can hit the layer of abstraction just right and handle all the cases such that everything is seamless and magic, I think good examples of this are &lt;a href=&quot;https://github.com/mozilla/rr&quot;&gt;rr&lt;/a&gt; (although telefork manages to be cursed enough to segfault it) and cloud VM live migration (basically telefork at the hypervisor layer).&lt;/p&gt;
&lt;p&gt;I also like thinking about these things as inspiration for alternative ways computer systems could work. Why are our cluster computing APIs so much more difficult to use than just running a program that broadcasts functions to the cluster? Why is networked systems programming so much harder than multithreaded programming? Sure you can give all sorts of good reasons, but they’re mostly based on how difficult it would be given how other existing systems work. Maybe with the right abstraction or with enough effort a project could seamlessly make it work, it seems fundamentally possible.&lt;/p&gt;
</description>
<pubDate>Sun, 26 Apr 2020 15:19:34 +0000</pubDate>
<dc:creator>trishume</dc:creator>
<dc:language>en-us</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://thume.ca/2020/04/18/telefork-forking-a-process-onto-a-different-computer/</dc:identifier>
</item>
<item>
<title>Decrypt WhatsApp encrypted media files</title>
<link>https://github.com/ddz/whatsapp-media-decrypt</link>
<guid isPermaLink="true" >https://github.com/ddz/whatsapp-media-decrypt</guid>
<description>&lt;p&gt;A recent &lt;a href=&quot;https://www.vice.com/en_us/article/v74v34/saudi-arabia-hacked-jeff-bezos-phone-technical-report&quot; rel=&quot;nofollow&quot;&gt;high-profile forensic investigation&lt;/a&gt; reported that “due to end-to-end encryption employed by WhatsApp, it is virtually impossible to decrypt the contents of the downloader [.enc file] to determine if it contained any malicious code in addition to the delivered video.”&lt;/p&gt;
&lt;p&gt;This project demonstrates how to decrypt encrypted media files downloaded from WhatsApp.&lt;/p&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;pre&gt;
&lt;code&gt;$ go get github.com/ddz/whatsapp-media-decrypt
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;pre&gt;
&lt;code&gt;Usage: ./whatsapp-media-decrypt -o FILE -t TYPE ENCFILE HEXMEDIAKEY

Options:
  -o FILE
        write decrypted output to FILE
  -t TYPE
        media TYPE (1 = image, 2 = video, 3 = audio, 4 = doc)
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;Example&lt;/h2&gt;
&lt;h3&gt;Extract media key from iOS ChatStorage.sqlite&lt;/h3&gt;
&lt;p&gt;The media key is stored within a protobuf message that is stored hex-encoded in the &lt;code&gt;ZMEDIAKEY&lt;/code&gt; column.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ sqlite ChatStorage.sqlite
SQLite version 3.27.2 2019-03-09 15:45:46
Enter &quot;.help&quot; for usage hints.
sqlite&amp;gt; select ZMEDIAURL,ZVCARDSTRING,hex(ZMEDIAKEY) from ZWAMEDIAITEM where Z_PK = 1795;
https://mmg-fna.whatsapp.net/d/f/Atzc5Drr8l7ngis8GmUTMI6vMQNjOU9zGQ2SYRkjwq44.enc|video/mp4|0A2069A349914734B9359DA0CD8923E6DFDE06F1E2BCE23222C738C521570BA8242A1220A1F5AEB2E620F73007FA853200559B2669455BB5818F619397C638042D8F7F2A18B984A5F1052000
sqlite&amp;gt; .quit
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;Extract media key from Android msgstore.db&lt;/h3&gt;
&lt;p&gt;The media key is stored hex-encoded in the &lt;code&gt;media_key&lt;/code&gt; column.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ sqlite msgstore.db
SQLite version 3.27.2 2019-03-09 15:45:46
Enter &quot;.help&quot; for usage hints.
sqlite&amp;gt; select message_url,mime_type,hex(media_key) from message_media where message_row_id = 1337;
https://mmg-fna.whatsapp.net/d/f/AnUpYQ390rgUBOQRhuwCyNqo_9KGATdmLUq-ghYEx-D9.enc|video/mp4|14F9C1B3BB5E66D9A593999A5E0ED3D03ABFECA84320D17763C2B44205E91C17
sqlite&amp;gt; .quit
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;Download Encrypted Media File&lt;/h3&gt;
&lt;pre&gt;
&lt;code&gt;$ curl -O https://mmg-fna.whatsapp.net/d/f/Atzc5Drr8l7ngis8GmUTMI6vMQNjOU9zGQ2SYRkjwq44.enc
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  389k  100  389k    0     0  1966k      0 --:--:-- --:--:-- --:--:-- 1956k
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;Decrypt Media File&lt;/h3&gt;
&lt;pre&gt;
&lt;code&gt;$ whatapp-media-decrypt -o Atzc5Drr8l7ngis8GmUTMI6vMQNjOU9zGQ2SYRkjwq44.mp4 -t 2 ./Atzc5Drr8l7ngis8GmUTMI6vMQNjOU9zGQ2SYRkjwq44.enc 0A2069A349914734B9359DA0CD8923E6DFDE06F1E2BCE23222C738C521570BA8242A1220A1F5AEB2E620F73007FA853200559B2669455BB5818F619397C638042D8F7F2A18B984A5F1052000
&lt;/code&gt;
&lt;/pre&gt;
&lt;h2&gt;FAQ&lt;/h2&gt;
&lt;h3&gt;Does this break WhatsApp encryption?&lt;/h3&gt;
&lt;p&gt;No. WhatsApp's encryption is end-to-end, which ensures that only the sender and recipient can read the message and especially not any servers (or attackers!) in-between them. This uses a cryptographic key stored on one of the endpoints to decrypt a media attachment in the same way that the WhatsApp app does to display it on the screen.&lt;/p&gt;
&lt;h3&gt;Does this mean my WhatsApp media files are not encrypted at rest?&lt;/h3&gt;
&lt;p&gt;No. WhatsApp uses &lt;a href=&quot;https://support.apple.com/guide/security/how-data-files-are-created-and-protected-sece8608431d/1/web/1&quot; rel=&quot;nofollow&quot;&gt;iOS Data Protection&lt;/a&gt; to encrypt user data files (including &lt;code&gt;ChatStorage.sqlite&lt;/code&gt;) using the device-specific and unrecoverable hardware UID key as well as a key derived from the user's passcode. It may not be decrypted without physical access to the specific iOS device that created the file as well as knowledge of the user's passcode.&lt;/p&gt;
&lt;h3&gt;Can you help me decrypt someone's WhatsApp?&lt;/h3&gt;
&lt;p&gt;No.&lt;/p&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;p&gt;Engelke, Lucas. &lt;a href=&quot;https://github.com/Rhymen/go-whatsapp&quot;&gt;go-whatsapp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Graham, Robert. &lt;a href=&quot;https://blog.erratasec.com/2020/01/how-to-decrypt-whatsapp-end-to-end.html&quot; rel=&quot;nofollow&quot;&gt;How to decrypt WhatsApp end-to-end media files&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Marczak, Bill. &quot;&lt;a href=&quot;https://medium.com/@billmarczak/bezos-hack-mbs-mohammed-bin-salman-whatsapp-218e1b4e1242&quot; rel=&quot;nofollow&quot;&gt;Some Directions for Further Investigation in the Bezos Hack Case&lt;/a&gt;&quot;&lt;/p&gt;
&lt;p&gt;Sigalor. &lt;a href=&quot;https://github.com/sigalor/whatsapp-web-reveng&quot;&gt;WhatsApp Web Reverse Engineered&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;WhatsApp. &lt;a href=&quot;https://www.whatsapp.com/security/WhatsApp-Security-Whitepaper.pdf&quot; rel=&quot;nofollow&quot;&gt;WhatsApp Encryption Overview&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 26 Apr 2020 11:36:39 +0000</pubDate>
<dc:creator>ColinWright</dc:creator>
<og:image>https://avatars0.githubusercontent.com/u/3083278?s=400&amp;v=4</og:image>
<og:type>object</og:type>
<og:title>ddz/whatsapp-media-decrypt</og:title>
<og:url>https://github.com/ddz/whatsapp-media-decrypt</og:url>
<og:description>Decrypt WhatsApp encrypted media files. Contribute to ddz/whatsapp-media-decrypt development by creating an account on GitHub.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://github.com/ddz/whatsapp-media-decrypt</dc:identifier>
</item>
<item>
<title>Why my book can be downloaded for free (2014)</title>
<link>https://blog.plover.com/book/free-hop.html</link>
<guid isPermaLink="true" >https://blog.plover.com/book/free-hop.html</guid>
<description>&lt;p&gt;&lt;a class=&quot;storytitle&quot; name=&quot;free-hop&quot; href=&quot;https://blog.plover.com/book/free-hop.html&quot; id=&quot;free-hop&quot;&gt;Why my book can be downloaded for free&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;People are frequently surprised that my book, &lt;em&gt;&lt;a href=&quot;http://hop.perl.plover.com&quot;&gt;Higher-Order Perl&lt;/a&gt;&lt;/em&gt;, is available as &lt;a href=&quot;http://hop.perl.plover.com/book/&quot;&gt;a free download from my web site&lt;/a&gt;. They ask if it spoiled my sales, or if it was hard to convince the publisher. No and no.&lt;/p&gt;
&lt;p&gt;I sent the HOP proposal to five publishers, expecting that two or three would turn it down, and that I would pick from the remaining two or three, but somewhat to my dismay, all five offered to publish it, and I had to decide who.&lt;/p&gt;
&lt;p&gt;One of the five publishers was Morgan Kaufmann. I had never heard of Morgan Kaufmann, but one day around 2002 I was reading the web site of &lt;a href=&quot;https://blogs.law.harvard.edu/philg/&quot;&gt;Philip Greenspun&lt;/a&gt;. Greenspun was incredibly grouchy. He found fault with everything. But he had nothing but praise for Morgan Kaufmann. I thought that if Morgan Kaufmann had pleased Greenspun, who was nearly impossible to please, then they must be really good, so I sent them the proposal. (They eventually published the book, and did a superb job; I have never regretted choosing them.)&lt;/p&gt;
&lt;p&gt;But not only Morgan Kaufmann but four other publishers had offered to publish the book. So I asked a number of people for advice. I happened to be in London one week and Greenspun was giving a talk there, which I went to see. After the talk I introduced myself and asked for his advice about picking the publisher.&lt;/p&gt;
&lt;p&gt;Greenspun reiterated his support for Morgan Kaufmann, but added that the publisher was not important. Instead, he said, I should make sure to negotiate permission to make the book available for free on my web site. He told me that compared with the effort that you put into the book, the money you get back is insignificant. So if you write a book it should not be because you want to make a lot of money from it but because you have an idea that you want to present to the world. And as an author, you owe it to yourself to get your idea in front of as many people as possible. By putting the book in your web site, you make it available to many people who would not otherwise have access to it: poor people, high school students, people in developing countries, and so on.&lt;/p&gt;
&lt;p&gt;I thought that Greenspun's idea made sense; I wanted my ideas about programming to get to as many people as possible. Also, demanding that I make the book available on my web site for free seemed like a good way to narrow down the five publishers to two or three.&lt;/p&gt;
&lt;p&gt;The first part of that plan worked out well. The second part not so well: all five publishers agreed. Some agreed reluctantly and some agreed willingly, but they all agreed. Eventually I had the book published by Morgan Kaufmann, and after a delay that seemed long at the time but in retrospect seems not so long, I put the book on my web site. It has been downloaded many times. (It's hard to say how many, since browsers often download just the portion of the PDF file that they need to display.)&lt;/p&gt;
&lt;p&gt;Would the book have made more money if it were not available as a free download? We can't know for sure, but I don't think so. The book has always sold well, and has made a significant amount of money for me and for Morgan Kaufmann. The amount I made is small compared to the amount of work I had to put in, just as Greenspun said, but it was nothing to sneeze at either. Even now, ten years later, it is still selling and I still get a royalty check every six months. For my book to have lasted ten years is extremely rare. Most computer books disappear without a trace after six months.&lt;/p&gt;
&lt;p&gt;Part of this is that it's an unusually good book. But I think the longevity is partly because it is available as a free download. Imagine that person A asks a question on an Internet forum, and person B says that HOP has a section that could help with the question. If A wants to follow up, they now must find a copy of HOP. If the book is out of print, this can be difficult. It may not be in the library; it almost certainly isn't in the bookstore. Used copies may be available, but you have to order them and have them shipped, and if you don't like it once it arrives, you are stuck with it. The barrier is just too high to be convenient. But since HOP is available on my web site, B can include a link, or A can find it with an easy web search. The barrier is gone! And now I have another reader who might mention it to someone else, and they might even buy a copy. Instead of drifting away into obscurity, HOP is a book that people can recommend over and over.&lt;/p&gt;
&lt;p&gt;So my conclusion is, Greenspun's advice was exactly correct. As an author, you owe it to yourself to make your book available to as many people as possible. And the publisher may agree, so be sure to ask.&lt;/p&gt;
&lt;p&gt;[ Addendum: Some people are just getting the news, but the book was published in 2005, and has been available as a free download since 2008. ]&lt;/p&gt;
&lt;p align=&quot;right&quot;&gt;&lt;em&gt;[&lt;a href=&quot;https://blog.plover.com/book&quot;&gt;Other articles in category /book&lt;/a&gt;] &lt;a href=&quot;https://blog.plover.com/book/free-hop.html&quot;&gt;permanent link&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;br /&gt;</description>
<pubDate>Sun, 26 Apr 2020 07:42:40 +0000</pubDate>
<dc:creator>luu</dc:creator>
<og:title>The Universe of Discourse : Why my book can be downloaded for free</og:title>
<og:type>article</og:type>
<og:image>https://pic.blog.plover.com/FIRST_IMAGE_DEFAULT.jpg</og:image>
<og:url>https://blog.plover.com/book/free-hop.html</og:url>
<dc:format>text/html</dc:format>
<dc:identifier>https://blog.plover.com/book/free-hop.html</dc:identifier>
</item>
<item>
<title>Show HN: Kanmail – An email client that functions like a kanban board</title>
<link>https://github.com/Oxygem/Kanmail</link>
<guid isPermaLink="true" >https://github.com/Oxygem/Kanmail</guid>
<description>&lt;p&gt;An email client that functions like a kanban board, for Mac/Windows/Linux/Docker. &lt;a href=&quot;https://kanmail.io/download&quot; rel=&quot;nofollow&quot;&gt;&lt;strong&gt;Download the latest release here&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; href=&quot;https://github.com/Oxygem/Kanmail/blob/master/screenshot.png&quot;&gt;&lt;img src=&quot;https://github.com/Oxygem/Kanmail/raw/master/screenshot.png&quot; alt=&quot;&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Build on MacOS (beta), tested with Linux &amp;amp; Windows (alpha)&lt;/li&gt;
&lt;li&gt;Developed using Gmail, Outlook &amp;amp; Fastmail&lt;/li&gt;
&lt;li&gt;Should be compabile with other email providers (uses IMAP/SMTP)&lt;/li&gt;
&lt;li&gt;Considered in &quot;beta&quot; - used as my main email client for &amp;gt;1yr&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;The rest of this readme focuses on the technical details of Kanmail. For user documentation &lt;a href=&quot;https://github.com/Oxygem/Kanmail/blob/master/docs&quot;&gt;&lt;strong&gt;see the &lt;code&gt;docs&lt;/code&gt; directory&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;©️ License&lt;/h2&gt;
&lt;p&gt;Before continuing it is important to note that Kanmail is &lt;strong&gt;source available but not free&lt;/strong&gt;. Kanmail is available for free download for evaluation; for continued use of Kanmail a &lt;a href=&quot;https://kanmail.io/license&quot; rel=&quot;nofollow&quot;&gt;&lt;strong&gt;license should be purchased&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We welcome pull requests, but note you will be contributing to a non-free project. You will be required to sign &lt;a href=&quot;https://gist.github.com/Fizzadar/6093499cccdcac7a4d83698516f9cafa&quot;&gt;the Oxygem CLA&lt;/a&gt; before any contributions can be merged. We offer free license keys to contributors, please email &lt;a href=&quot;mailto:hello@oxygem.com&quot;&gt;hello@oxygem.com&lt;/a&gt; for more information.&lt;/p&gt;
&lt;h2&gt;🛠️ Development&lt;/h2&gt;
&lt;h3&gt;Setup your system&lt;/h3&gt;
&lt;h4&gt;MacOS&lt;/h4&gt;
&lt;p&gt;Python &lt;em&gt;must&lt;/em&gt; be configured &lt;code&gt;--with-framework&lt;/code&gt;. See &lt;a href=&quot;https://stackoverflow.com/a/15752676/352488&quot; rel=&quot;nofollow&quot;&gt;this StackOverflow answer&lt;/a&gt; to to check whether this is enabled.&lt;/p&gt;
&lt;p&gt;To build/release you'll need to intsall GNU tar, which can be done with brew:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;brew install gnu-tar
&lt;/code&gt;
&lt;/pre&gt;
&lt;h4&gt;Linux (Ubuntu)&lt;/h4&gt;
&lt;p&gt;For &lt;code&gt;qt&lt;/code&gt; to install properly you'll need:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;apt install build-essential pkg-config git python3-dev libcairo2-dev libgirepository1.0-dev
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Then, &lt;em&gt;after&lt;/em&gt; requirements are installed you need to edit &lt;a href=&quot;https://github.com/pyinstaller/pyinstaller/blob/develop/PyInstaller/hooks/hook-gi.repository.Gtk.py#L24&quot;&gt;this pyinstaller file&lt;/a&gt; and comment out the lines that add fontconfig/icons/themes (prevents the resultant bundle being &amp;gt;200mb).&lt;/p&gt;
&lt;h4&gt;Windows&lt;/h4&gt;
&lt;p&gt;You'll need the &lt;a href=&quot;https://visualstudio.microsoft.com/downloads/&quot; rel=&quot;nofollow&quot;&gt;Visual Studio build tools&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Install Python requirements&lt;/h3&gt;
&lt;p&gt;First install the requirements:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# Generic development requirements
pip install -r requirements/development.txt

# Platform specific requirements
pip install -r requirements/[macos|linux|windows].txt
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;To start the server + webpack-server:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;honcho start
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Then go to &lt;a href=&quot;https://localhost:4420&quot; rel=&quot;nofollow&quot;&gt;http://localhost:4420&lt;/a&gt; to view/develop the app in a browser of your choice.&lt;/p&gt;
&lt;p&gt;Or - to start the full windowed app, use:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;honcho start -f Procfile-app
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Note that the webserver does not auto-reload when running in app mode.&lt;/p&gt;
&lt;h3&gt;Releases&lt;/h3&gt;
&lt;p&gt;Version numbers are generated at build in the date-based format: &lt;code&gt;MAJOR.YYMMDDhhmm&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;🔄 Syncing&lt;/h2&gt;
&lt;p&gt;Kanmail syncs email using the IMAP protocol. Instead of implementing a &quot;complete sync engine&quot; (one which attempts to keep a local copy of the server data), Kanmail uses a cache and loads data on demand. This simplifies the implementation but makes it hard/impossible to behave as an offline email client.&lt;/p&gt;
&lt;p&gt;Kanmail keeps in sync with the remote server by checking UID lists. These are cached locally and every &quot;sync&quot; the full list is refreshed, ensuring the local copy is up to date with the server UID list. Email headers are cached against their UIDs.&lt;/p&gt;
&lt;p&gt;Currently no actual full email data is cached, only the headers. Meaning when offline Kanmail will load any cached threads into the column view, but it won't be able to open any of these threads.&lt;/p&gt;
&lt;h3&gt;Initial load (get emails)&lt;/h3&gt;
&lt;p&gt;When Kanmail starts, the UI attempts to get emails for each folder (both columns and &quot;core&quot; folders like archive/drafts) - this API endpoint is always expected to return a valid response, even if empty, and does not require connectivity. If there is a local cache of UIDs and email headers, these will be returned.&lt;/p&gt;
&lt;p&gt;Subsequent calls to this API endpoint will load more emails, loading headers from the server as required.&lt;/p&gt;
&lt;h3&gt;Updates (sync emails)&lt;/h3&gt;
&lt;p&gt;During the lifetime of a running Kanmail app it will periodically request to sync emails with the server. At this time the full UID list is reloaded from the server (failing if offline) and any new email headers are fetched. This endpoint returns new emails and the UIDs of any deleted emails from the UID list.&lt;/p&gt;
</description>
<pubDate>Sun, 26 Apr 2020 06:36:34 +0000</pubDate>
<dc:creator>Fizzadar</dc:creator>
<og:image>https://avatars0.githubusercontent.com/u/4098707?s=400&amp;v=4</og:image>
<og:type>object</og:type>
<og:title>Oxygem/Kanmail</og:title>
<og:url>https://github.com/Oxygem/Kanmail</og:url>
<og:description>:inbox_tray: An email client that functions like a kanban board. - Oxygem/Kanmail</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://github.com/Oxygem/Kanmail</dc:identifier>
</item>
<item>
<title>Teenagers are better behaved and less hedonistic (2018)</title>
<link>https://www.economist.com/international/2018/01/10/teenagers-are-better-behaved-and-less-hedonistic-nowadays</link>
<guid isPermaLink="true" >https://www.economist.com/international/2018/01/10/teenagers-are-better-behaved-and-less-hedonistic-nowadays</guid>
<description>&lt;aside class=&quot;article__aside&quot;&gt;&lt;div class=&quot;layout-article-meta&quot;&gt;&lt;time itemscope=&quot;&quot; itemtype=&quot;http://schema.org/DateTime&quot; datetime=&quot;2018-01-10T00:00:00Z&quot; class=&quot;article__dateline-datetime&quot;&gt;Jan 10th 2018&lt;/time&gt;&lt;p data-test-id=&quot;Dateline&quot; itemtype=&quot;http://schema.org/dateline&quot; class=&quot;article__dateline-location&quot;&gt;LOS ANGELES&lt;/p&gt;
&lt;/div&gt;
&lt;/aside&gt;&lt;p class=&quot;article__body-text&quot;&gt;AT THE gates of Santa Monica College, in Los Angeles, a young man with a skateboard is hanging out near a group of people who are smoking marijuana in view of the campus police. His head is clouded, too—but with worry, not weed. He frets about his student loans and the difficulty of finding a job, even fearing that he might end up homeless. “Not to sound intense,” he adds, but robots are taking work from humans. He neither smokes nor drinks much. The stigma against such things is stronger than it was for his parents’ generation, he explains.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Young people are indeed behaving and thinking differently from previous cohorts at the same age. These shifts can be seen in almost every rich country, from America to the Netherlands to South Korea. Some have been under way for many years, but they have accelerated in the past few. Not all of them are benign.&lt;/p&gt;

&lt;p class=&quot;article__body-text&quot;&gt;Perhaps the most obvious change is that teenagers are getting drunk less often (see chart 1). They start drinking later: the average age at which young Australians first try alcohol has risen from 14.4 to 16.1 since 1998. And even when they start, they sip rather than chug. In Britain, where a fifth of 16- to 24-year-olds do not drink at all, the number of pubs is falling by about 1,000 a year, and nightclubs are faring even worse. In the past young people went out for a drink and perhaps had something to eat at the same time, says Kate Nicholls, head of the Association of Licensed Multiple Retailers, a trade group. Now it is the other way round.&lt;/p&gt;
&lt;div itemscope=&quot;&quot; itemprop=&quot;image&quot; itemtype=&quot;https://schema.org/ImageObject&quot; data-slim=&quot;0&quot;&gt;&lt;img src=&quot;https://www.economist.com/sites/default/files/images/2018/01/articles/body/20180113_irc386.png&quot; srcset=&quot;https://www.economist.com/img/b/200/105/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 200w,https://www.economist.com/img/b/300/158/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 300w,https://www.economist.com/img/b/400/210/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 400w,https://www.economist.com/img/b/600/315/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 600w,https://www.economist.com/img/b/640/336/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 640w,https://www.economist.com/img/b/800/420/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 800w,https://www.economist.com/img/b/1000/525/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 1000w,https://www.economist.com/img/b/1280/672/85/sites/default/files/images/2018/01/articles/body/20180113_irc386.png 1280w&quot; sizes=&quot;(max-width: 320px) 300px, (max-width: 414px) 400px, (max-width: 600px) 640px, (max-width: 768px) 800px, (max-width: 960px) 1000px, (max-width: 1024px) 1200px&quot; alt=&quot;&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Other drugs are also falling from favour. Surveys by the European Monitoring Centre for Drugs and Drug Addiction show that the proportion of 15- to 16-year-olds who have tried cigarettes has been falling since 1999. A rising proportion of teenagers have never tried anything mind-altering, including alcohol, tobacco, cannabis, inhalants and sedatives. The proportion of complete abstainers rose from 11% to 31% in Sweden between 2003 and 2015, and from 23% to an astounding 61% in Iceland. In America, all illicit drugs except marijuana (which is not illicit everywhere) have become less popular. Mercifully, the decline in teenage opioid use is especially steep.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Nor are young people harming each other as much as they used to. Fighting among 13- and 15-year-olds is down across Europe. Juvenile crime and anti-social behaviour have dropped in England and Wales, and with them the number of juvenile convicts. In 2007 almost 3,000 young people were in custody; by 2016 the number was below 1,000.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Teenagers are also having less sex, especially of the procreative kind. In 1991, 54% of American teenagers in grades nine to 12 (ages 14-18) reported that they were sexually experienced, and 19% claimed to have had sex with at least four partners. In 2015 those proportions were 41% and 12%. America’s teenage birth rate crashed by two-thirds during the same period. As with alcohol, the abstention from sex seems to be carrying through into early adulthood. Jean Twenge, a psychologist at San Diego State University in California, has shown that the proportion of Americans aged 20-24 who report having no sexual partner since the age of 18 rose from 6.3% for the cohort born in the late 1960s to 15.2% for those born in the early 1990s. Japan is a more extreme case. In 2015, 47% of unmarried 20- to 24-year-old Japanese men said they had never had sex with a woman, up from 34% in 2002.&lt;/p&gt;

&lt;p class=&quot;article__body-text&quot;&gt;In short, young people are less hedonistic and break fewer rules than in the past. They are “kind of boring”, says Shoko Yoneyama, an expert on Japanese teenagers at the University of Adelaide. What is going on?&lt;/p&gt;
&lt;h2&gt;They tuck you up&lt;/h2&gt;
&lt;p class=&quot;article__body-text&quot;&gt;One possible explanation is that family life has changed. A study of 11 countries by Giulia Dotti Sani and Judith Treas, two academics, found that parents spend much more time on child care. In America, the average parent spent 88 minutes a day primarily looking after children in 2012—up from 41 minutes in 1965. Fathers have upped their child-care hours most in proportional terms, though they still do much less than mothers. Because families are smaller, the hours are spread across fewer offspring.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Those doted-upon children seem to have turned into amenable teenagers. In 28 out of 34 rich countries surveyed by the World Health Organisation, the proportion of 15-year-old boys who said they found it easy to talk to their fathers rose between 2001-02 and 2013-14. Girls found it easier to talk to their fathers in 29 out of 34 countries. The trend for mothers is similar but less strong. And even teenagers who do not talk to their parents seem to listen to them. Dutch surveys show that teenagers have come to feel more pressure from their parents not to drink. That is probably the main reason for the decline in youthful carousing since 2003.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Another possibility is that teenagers and young people are more focused on school and academic work. Across the OECD club of rich countries, the share of 25- to 34-year-olds with a tertiary degree rose from 26% to 43% between 2000 and 2016. A larger proportion of teenagers believe they will go on to university.&lt;/p&gt;

&lt;p class=&quot;article__body-text&quot;&gt;As a result, they may be staying at home more. Mike Roe, who runs a drop-in youth club in Brighton, in southern England, says that ten or 15 years ago clubs like his often used to stay open until 11pm on school nights. That is now regarded as too late. Oddly, though, teenagers are not necessarily filling their evenings with useful work. Between 2003 and 2012, the amount of time 15-year-olds spent doing homework fell by an hour a week across the OECD, to just under five hours.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Meanwhile paid work is collapsing. In 2016 just 43% of American 16- to 19-year-olds were working in July, during the summer holidays—down from 65% two decades earlier. The retreat from lifeguarding and burger-flipping worries some Americans, including Ben Sasse, a senator from Nebraska, who argues that boring paid work builds character and resilience. Teenagers are no fools, however. The average 16- to 19-year-old American worker earned $9.20 an hour in 2016. Though an improvement on previous years, that is a pittance next to the cost of university tuition or the large and growing wage differential between professional-level jobs and the rest. The fall in summer working has been mirrored by a rise in summer studying.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Ann Hagell, a British adolescent psychologist, suggests another explanation. Today’s young people in Western countries are increasingly ethnically diverse. Britain, for example, has received large flows of immigrants from Africa, south Asia and eastern Europe. Many of those immigrants arrive with strong taboos against drinking, premarital sex and smoking—at least among girls—and think that only paupers send their children out to work. Ms Hagell points out that teenage drinking is rarest in London, where immigrants cluster.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Finally, technology has probably changed people’s behaviour. Teenagers are heavy internet users, the more so as they acquire smartphones. By their own account, 15-year-olds in OECD countries spent 146 minutes a day online on weeknights in 2015, up from 105 minutes in 2012. Chileans lead the rich world, putting in an average of 195 minutes on weekdays and 230 minutes on weekend days.&lt;/p&gt;

&lt;p class=&quot;article__body-text&quot;&gt;Social media allow teenagers’ craving for contact with peers to be squared with parents’ desire to keep their offspring safe and away from harmful substances. In America, surveys known as Monitoring the Future have recorded a decline in unsupervised hanging-out, which has been especially sharp since 2012. Teenagers who communicate largely online can exchange gossip, insults and nude pictures, but not bodily fluids, blows, or bottles of vodka.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;The digital trade-off comes at a cost. Sophie Wasson, a psychologist at Harvard-Westlake, a private high school in Los Angeles, says that some teenagers seem to use social media as an alternative to face-to-face communication. In doing so, they pass up some opportunities to develop deep emotional connections with their friends, which are built on non-verbal cues as well as verbal ones. Ms Wasson believes that social media widen the gap between how teenagers feel about themselves and what they think their friends want them to be. Online, everybody else is always happy, good-looking and at a party.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Technology also enhances surveillance. Parents track their children’s phones and text frequently to ask where they are. Benjamin Pollack, a student at the University of Pennsylvania, remembers attending a camp in Israel when he was in high school. He communicated with his mother every day, using Facebook Messenger and other tools. As it happens, his mother had attended the same camp when she was a teenager. She contacted her own mother twice in eight weeks.&lt;/p&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Worries about teenagers texting and playing computer games too much (and, before that, watching too much television) have largely given way to worries about smartphones and social media. Last November Chamath Palihapitiya, formerly a Facebook executive, said that his children were “not allowed to use that shit”. But strong evidence that technology is rewiring teenagers’ minds is so far lacking. American and British data show that, although heavy internet use is associated with unhappiness, the correlation is weak. One paper on Britain by Andrew Przybylski and Netta Weinstein suggests that heavy computer and smartphone use lower adolescents’ mood much less than skipping breakfast or skimping on sleep.&lt;/p&gt;

&lt;h2&gt;Sufficient unto the day&lt;/h2&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Still, something is up. Whether it is a consequence of phones, intrusive parenting, an obsessive focus on future job prospects or something else entirely, teenagers seem lonelier than in the past. The OECD’s PISA surveys show that the share of 15-year-olds who say they make friends easily at school has dropped in almost every country (see chart 2). Some Western countries are beginning to look like Japan and South Korea, which struggle with a more extreme kind of social isolation in which young people become virtual hermits.&lt;/p&gt;
&lt;div class=&quot;article__body-text-image&quot; readability=&quot;39&quot;&gt;
&lt;div itemscope=&quot;&quot; itemprop=&quot;image&quot; itemtype=&quot;https://schema.org/ImageObject&quot; data-slim=&quot;1&quot;&gt;&lt;img src=&quot;https://www.economist.com/sites/default/files/images/2018/01/articles/body/20180113_irc502.png&quot; srcset=&quot;https://www.economist.com/img/b/200/255/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 200w,https://www.economist.com/img/b/300/383/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 300w,https://www.economist.com/img/b/400/511/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 400w,https://www.economist.com/img/b/600/766/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 600w,https://www.economist.com/img/b/640/817/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 640w,https://www.economist.com/img/b/800/1021/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 800w,https://www.economist.com/img/b/1000/1276/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 1000w,https://www.economist.com/img/b/1280/1634/85/sites/default/files/images/2018/01/articles/body/20180113_irc502.png 1280w&quot; sizes=&quot;(max-width: 320px) 300px, (max-width: 414px) 400px, (max-width: 600px) 640px, (max-width: 768px) 800px, (max-width: 960px) 1000px, (max-width: 1024px) 1200px&quot; alt=&quot;&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;article__body-text&quot;&gt;Perhaps they will get round to close friendships in time. One way of thinking about the differences between the youth of today and yesterday is that today’s lot are taking it slow. They are slow to drink, have sex and earn money. They will also probably be slow to leave home, get married and have children. What looks to older generations like indolence and a reluctance to grow up might be, at least in part, a response to medical developments. Babies born today in a rich country can expect to live for at least 80 years. Goodness knows at what age they will be entitled to state pensions. Today’s young people have all the time in the world.&lt;/p&gt;
&lt;/div&gt;
&lt;p data-test-id=&quot;Footnote&quot; class=&quot;article__footnote&quot;&gt;This article appeared in the International section of the print edition under the headline &quot;The youth of today&quot;&lt;/p&gt;
&lt;div class=&quot;layout-article-links&quot;&gt;&lt;a class=&quot;ds-actioned-link ds-actioned-link--reuse-this-content&quot; target=&quot;_blank&quot; href=&quot;https://s100.copyright.com/AppDispatchServlet?publisherName=economist&amp;amp;publication=economist&amp;amp;title=Teenagers%20are%20better%20behaved%20and%20less%20hedonistic%20nowadays&amp;amp;publicationDate=2018-01-10&amp;amp;contentID=%2Fcontent%2Fg5c52127hm7ig455k8fmp8u58imfs4uh&amp;amp;type=A&amp;amp;orderBeanReset=TRUE&quot;&gt;&lt;span&gt;Reuse this content&lt;/span&gt;&lt;/a&gt;&lt;a class=&quot;ds-actioned-link ds-actioned-link--the-trust-project&quot; href=&quot;https://www.economist.com/about-the-economist&quot;&gt;&lt;span&gt;The Trust Project&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;
</description>
<pubDate>Sun, 26 Apr 2020 06:22:37 +0000</pubDate>
<dc:creator>pjrule</dc:creator>
<og:title>Teenagers are better behaved and less hedonistic nowadays</og:title>
<og:type>Article</og:type>
<og:url>https://www.economist.com/international/2018/01/10/teenagers-are-better-behaved-and-less-hedonistic-nowadays</og:url>
<og:description>But they are also lonelier and more isolated</og:description>
<og:image>https://www.economist.com/sites/default/files/images/2018/01/articles/main/20180113_ird001.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.economist.com/international/2018/01/10/teenagers-are-better-behaved-and-less-hedonistic-nowadays</dc:identifier>
</item>
<item>
<title>My NixOS Desktop Flow</title>
<link>https://christine.website/blog/nixos-desktop-flow-2020-04-25</link>
<guid isPermaLink="true" >https://christine.website/blog/nixos-desktop-flow-2020-04-25</guid>
<description>&lt;p&gt;Before I built my current desktop, I had been using a &lt;a href=&quot;https://www.apple.com/mac-pro-2013/specs/&quot;&gt;2013 Mac Pro&lt;/a&gt; for at least 7 years. This machine has seen me through living in a few cities (Bellevue, Mountain View and Montreal), but it was starting to show its age. Its 12 core Xeon is really no slouch (scoring about 5 minutes in my “compile the linux kernel” test), but with Intel security patches it was starting to get slower and slower as time went on.&lt;/p&gt;
&lt;p&gt;So in March (just before the situation started) I ordered the parts for my new tower and built my current desktop machine. From the start, I wanted it to run Linux and have 64 GB of ram, mostly so I could write and test programs without having to worry about ram exhaustion.&lt;/p&gt;
&lt;p&gt;When the parts were almost in, I had decided to really start digging into &lt;a href=&quot;https://nixos.org&quot;&gt;NixOS&lt;/a&gt;. Friends on IRC and Discord had been trying to get me to use it for years, and I was really impressed with a simple setup that I had in a virtual machine. So I decided to jump head-first down that rabbit hole, and I’m honestly really glad I did.&lt;/p&gt;
&lt;p&gt;NixOS is built on a more functional approach to package management called &lt;a href=&quot;https://nixos.org/nix/&quot;&gt;Nix&lt;/a&gt;. Parts of the configuration can be easily broken off into modules that can be reused across machines in a deployment. If &lt;a href=&quot;https://www.ansible.com/&quot;&gt;Ansible&lt;/a&gt; or other tools like it let you customize an existing Linux distribution to meet your needs, NixOS allows you to craft your own Linux distribution around your needs.&lt;/p&gt;
&lt;p&gt;Unfortunately, the Nix and NixOS documentation is a bit more dense than most other Linux programs/distributions are, and it’s a bit easy to get lost in it. I’m going to attempt to explain a lot of the guiding principles behind Nix and NixOS and how they fit into how I use NixOS on my desktop.&lt;/p&gt;
&lt;h2&gt;What is a Package?&lt;/h2&gt;
&lt;p&gt;Earlier, I mentioned that Nix is a &lt;em&gt;functional&lt;/em&gt; package manager. This means that Nix views packages as a combination of inputs to get an output:&lt;/p&gt;
&lt;center&gt;&lt;img src=&quot;https://christine.website/static/blog/nix-package.png&quot; alt=&quot;A nix package is the metadata, the source code, the build instructions and some patches as input to a derivation to create a package&quot;/&gt;&lt;/center&gt;
&lt;p&gt;This is how most package managers work (even things like Windows installer files), but Nix goes a step further by disallowing package builds to access the internet. This allows Nix packages to be a lot more reproducible; meaning if you have the same inputs (source code, build script and patches) you should &lt;em&gt;always&lt;/em&gt; get the same output byte-for-byte every time you build the same package at the same version.&lt;/p&gt;
&lt;h3&gt;A Simple Package&lt;/h3&gt;
&lt;p&gt;Let’s consider a simple example, my &lt;a href=&quot;https://github.com/Xe/gruvbox-css&quot;&gt;gruvbox-inspired CSS file&lt;/a&gt;’s &lt;a href=&quot;https://github.com/Xe/gruvbox-css/blob/master/default.nix&quot;&gt;&lt;code&gt;default.nix&lt;/code&gt;&lt;/a&gt; file’:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;{ pkgs ? import &amp;lt;nixpkgs&amp;gt; { } }:

pkgs.stdenv.mkDerivation {
  pname = &quot;gruvbox-css&quot;;
  version = &quot;latest&quot;;
  src = ./.;
  phases = &quot;installPhase&quot;;
  installPhase = ''
    mkdir -p $out
    cp -rf $src/gruvbox.css $out/gruvbox.css
  '';
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This creates a package named &lt;code&gt;gruvbox-css&lt;/code&gt; with the version &lt;code&gt;latest&lt;/code&gt;. Let’s break this down its &lt;code&gt;default.nix&lt;/code&gt; line by line:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;{ pkgs ? import &amp;lt;nixpkgs&amp;gt; { } }:
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This creates a function that either takes in the &lt;code&gt;pkgs&lt;/code&gt; object or tells Nix to import the standard package library &lt;a href=&quot;https://nixos.org/nixpkgs/&quot;&gt;nixpkgs&lt;/a&gt; as &lt;code&gt;pkgs&lt;/code&gt;. nixpkgs includes a lot of utilities like a standard packaging environment, special builders for things like snaps and Docker images as well as one of the largest package sets out there.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;pkgs.stdenv.mkDerivation {
  # ...
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This runs the &lt;a href=&quot;https://nixos.org/nixpkgs/manual/#sec-using-stdenv&quot;&gt;&lt;code&gt;stdenv.mkDerivation&lt;/code&gt;&lt;/a&gt; function with some arguments in an object. The “standard environment” comes with tools like GCC, bash, coreutils, find, sed, grep, awk, tar, make, patch and all of the major compression tools. This means that our package builds can build C/C++ programs, copy files to the output, and extract downloaded source files by default. You can add other inputs to this environment if you need to, but for now it works as-is.&lt;/p&gt;
&lt;p&gt;Let’s specify the name and version of this package:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;pname = &quot;gruvbox-css&quot;;
version = &quot;latest&quot;;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;pname&lt;/code&gt; stands for “package name”. It is combined with the version to create the resulting package name. In this case it would be &lt;code&gt;gruvbox-css-latest&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let’s tell Nix how to build this package:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;src = ./.;
phases = &quot;installPhase&quot;;
installPhase = ''
  mkdir -p $out
  cp -rf $src/gruvbox.css $out/gruvbox.css
'';
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;src&lt;/code&gt; attribute tells Nix where the source code of the package is stored. Sometimes this can be a URL to a compressed archive on the internet, sometimes it can be a git repo, but for now it’s the current working directory &lt;code&gt;./.&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;This is a CSS file, it doesn’t make sense to have to build these, so we skip the build phase and tell Nix to directly install the package to its output folder:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-shell&quot;&gt;mkdir -p $out
cp -rf $src/gruvbox.css $out/gruvbox.css
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This two-liner shell script creates the output directory (usually exposed as &lt;code&gt;$out&lt;/code&gt;) and then copies &lt;code&gt;gruvbox.css&lt;/code&gt; into it. When we run this through Nix with&lt;code&gt;nix-build&lt;/code&gt;, we get output that looks something like this:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ nix-build ./default.nix
these derivations will be built:
  /nix/store/c99n4ixraigf4jb0jfjxbkzicd79scpj-gruvbox-css.drv
building '/nix/store/c99n4ixraigf4jb0jfjxbkzicd79scpj-gruvbox-css.drv'...
installing
/nix/store/ng5qnhwyrk9zaidjv00arhx787r0412s-gruvbox-css
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And &lt;code&gt;/nix/store/ng5qnhwyrk9zaidjv00arhx787r0412s-gruvbox-css&lt;/code&gt; is the output package. Looking at its contents with &lt;code&gt;ls&lt;/code&gt;, we see this:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ ls /nix/store/ng5qnhwyrk9zaidjv00arhx787r0412s-gruvbox-css
gruvbox.css
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;A More Complicated Package&lt;/h3&gt;
&lt;p&gt;For a more complicated package, let’s look at the &lt;a href=&quot;https://github.com/Xe/site/blob/master/site.nix&quot;&gt;build directions of the website you are reading right now&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;{ pkgs ? import (import ./nix/sources.nix).nixpkgs }:
with pkgs;

assert lib.versionAtLeast go.version &quot;1.13&quot;;

buildGoPackage rec {
  pname = &quot;christinewebsite&quot;;
  version = &quot;latest&quot;;
  
  goPackagePath = &quot;christine.website&quot;;
  src = ./.;
  goDeps = ./nix/deps.nix;
  allowGoReference = false;

  preBuild = ''
    export CGO_ENABLED=0
    buildFlagsArray+=(-pkgdir &quot;$TMPDIR&quot;)
  '';

  postInstall = ''
    cp -rf $src/blog $bin/blog
    cp -rf $src/css $bin/css
    cp -rf $src/gallery $bin/gallery
    cp -rf $src/signalboost.dhall $bin/signalboost.dhall
    cp -rf $src/static $bin/static
    cp -rf $src/talks $bin/talks
    cp -rf $src/templates $bin/templates
  '';
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Breaking it down, we see some similarities to the gruvbox-css package from above, but there’s a few more interesting lines I want to point out:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;{ pkgs ? import (import ./nix/sources.nix).nixpkgs }:
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;My website uses a pinned or fixed version of nixpkgs. This allows my website’s deployment to be stable even if nixpkgs changes something that could cause it to break.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;with pkgs;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://nixos.org/nix/manual/#idm140737321975440&quot;&gt;With expressions&lt;/a&gt; are one of the more interesting parts of Nix. Essentially, they let you say “everything in this object should be put into scope”. So if you have an expression that does this:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;let
  foo = {
    ponies = &quot;awesome&quot;;
  };
in with foo; &quot;ponies are ${ponies}!&quot;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;You get the result &lt;code&gt;&quot;ponies are awesome!&quot;&lt;/code&gt;. I use &lt;code&gt;with pkgs&lt;/code&gt; here to use things directly from nixpkgs without having to say &lt;code&gt;pkgs.&lt;/code&gt; in front of a lot of things.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;assert lib.versionAtLeast go.version &quot;1.13&quot;;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This line will make the build fail if Nix is using any Go version less than 1.13. I’m pretty sure my website’s code could function on older versions of Go, but the runtime improvements are important to it, so let’s fail loudly just in case.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;buildGoPackage {
  # ...
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://nixos.org/nixpkgs/manual/#ssec-go-legacy&quot;&gt;&lt;code&gt;buildGoPackage&lt;/code&gt;&lt;/a&gt; builds a Go package into a Nix package. It takes in the &lt;a href=&quot;https://github.com/golang/go/wiki/GOPATH#directory-layout&quot;&gt;Go package path&lt;/a&gt;, list of dependencies and if the resulting package is allowed to depend on the Go compiler or not.&lt;/p&gt;
&lt;p&gt;It will then compile the Go program (and all of its dependencies) into a binary and put that in the resulting package. This website is more than just the source code, it’s also got assets like CSS files and the image earlier in the post. Those files are copied in the &lt;code&gt;postInstall&lt;/code&gt; phase:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;postInstall = ''
  cp -rf $src/blog $bin/blog
  cp -rf $src/css $bin/css
  cp -rf $src/gallery $bin/gallery
  cp -rf $src/signalboost.dhall $bin/signalboost.dhall
  cp -rf $src/static $bin/static
  cp -rf $src/talks $bin/talks
  cp -rf $src/templates $bin/templates
'';
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This results in all of the files that my website needs to run existing in the right places.&lt;/p&gt;
&lt;h3&gt;Other Packages&lt;/h3&gt;
&lt;p&gt;For more kinds of packages that you can build, see the &lt;a href=&quot;https://nixos.org/nixpkgs/manual/#chap-language-support&quot;&gt;Languages and Frameworks&lt;/a&gt; chapter of the nixpkgs documentation.&lt;/p&gt;
&lt;p&gt;If your favorite language isn’t shown there, you can make your own build script and do it more manually. See &lt;a href=&quot;https://nixos.org/nixos/nix-pills/working-derivation.html#idm140737320334640&quot;&gt;here&lt;/a&gt; for more information on how to do that.&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;nix-env&lt;/code&gt; And Friends&lt;/h2&gt;
&lt;p&gt;Building your own packages is nice and all, but what about using packages defined in nixpkgs? Nix includes a few tools that help you find, install, upgrade and remove packages as well as &lt;code&gt;nix-build&lt;/code&gt; to build new ones.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;nix search&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;When looking for a package to install, use &lt;code&gt;$ nix search name&lt;/code&gt; to see if it’s already packaged. For example, let’s look for &lt;a href=&quot;https://graphviz.org/&quot;&gt;graphviz&lt;/a&gt;, a popular diagramming software:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ nix search graphviz

* nixos.graphviz (graphviz)
  Graph visualization tools

* nixos.graphviz-nox (graphviz)
  Graph visualization tools

* nixos.graphviz_2_32 (graphviz)
  Graph visualization tools
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;There are several results here! These are different because sometimes you may want some features of graphviz, but not all of them. For example, a server installation of graphviz wouldn’t need X windows support.&lt;/p&gt;
&lt;p&gt;The first line of the output is the attribute. This is the attribute that the package is imported to inside nixpkgs. This allows multiple packages in different contexts to exist in nixpkgs at the same time, for example with python 2 and python 3 versions of a library.&lt;/p&gt;
&lt;p&gt;The second line is a description of the package from its metadata section.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;nix&lt;/code&gt; tool allows you to do a lot more than just this, but for now this is the most important thing.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;nix-env -i&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;nix-env&lt;/code&gt; is a rather big tool that does a lot of things (similar to pacman in Arch Linux), so I’m going to break things down into separate sections.&lt;/p&gt;
&lt;p&gt;Let’s pick an instance graphviz from before and install it using &lt;code&gt;nix-env&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ nix-env -iA nixos.graphviz
installing 'graphviz-2.42.2'
these paths will be fetched (5.00 MiB download, 13.74 MiB unpacked):
  /nix/store/980jk7qbcfrlnx8jsmdx92q96wsai8mx-gts-0.7.6
  /nix/store/fij1p8f0yjpv35n342ii9pwfahj8rlbb-graphviz-2.42.2
  /nix/store/jy35xihlnb3az0vdksyg9rd2f38q2c01-libdevil-1.7.8
  /nix/store/s895dnwlprwpfp75pzq70qzfdn8mwfzc-lcms-1.19
copying path '/nix/store/980jk7qbcfrlnx8jsmdx92q96wsai8mx-gts-0.7.6' from 'https://cache.nixos.org'...
copying path '/nix/store/s895dnwlprwpfp75pzq70qzfdn8mwfzc-lcms-1.19' from 'https://cache.nixos.org'...
copying path '/nix/store/jy35xihlnb3az0vdksyg9rd2f38q2c01-libdevil-1.7.8' from 'https://cache.nixos.org'...
copying path '/nix/store/fij1p8f0yjpv35n342ii9pwfahj8rlbb-graphviz-2.42.2' from 'https://cache.nixos.org'...
building '/nix/store/r4fqdwpicqjpa97biis1jlxzb4ywi92b-user-environment.drv'...
created 664 symlinks in user environment
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And now let’s see where the &lt;code&gt;dot&lt;/code&gt; tool from graphviz is installed to:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ which dot
/home/cadey/.nix-profile/bin/dot

$ readlink /home/cadey/.nix-profile/bin/dot
/nix/store/fij1p8f0yjpv35n342ii9pwfahj8rlbb-graphviz-2.42.2/bin/dot
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This lets you install tools into the system-level Nix store without affecting other user’s environments, even if they depend on a different version of graphviz.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;nix-env -e&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;nix-env -e&lt;/code&gt; lets you uninstall packages installed with &lt;code&gt;nix-env -i&lt;/code&gt;. Let’s uninstall graphviz:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ nix-env -e graphviz
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Now the &lt;code&gt;dot&lt;/code&gt; tool will be gone from your shell:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ which dot
which: no dot in (/run/wrappers/bin:/home/cadey/.nix-profile/bin:/etc/profiles/per-user/cadey/bin:/nix/var/nix/profiles/default/bin:/run/current-system/sw/bin)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And it’s like graphviz was never installed.&lt;/p&gt;
&lt;p&gt;Notice that these package management commands are done at the &lt;em&gt;user&lt;/em&gt; level because they are only affecting the currently logged-in user. This allows users to install their own editors or other tools without having to get admins involved.&lt;/p&gt;
&lt;h2&gt;Adding up to NixOS&lt;/h2&gt;
&lt;p&gt;NixOS builds on top of Nix and its command line tools to make an entire Linux distribution that can be perfectly crafted to your needs. NixOS machines are configured using a &lt;a href=&quot;https://nixos.org/nixos/manual/index.html#ch-configuration&quot;&gt;configuration.nix&lt;/a&gt; file that contains the following kinds of settings:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;packages installed to the system&lt;/li&gt;
&lt;li&gt;user accounts on the system&lt;/li&gt;
&lt;li&gt;allowed SSH public keys for users on the system&lt;/li&gt;
&lt;li&gt;services activated on the system&lt;/li&gt;
&lt;li&gt;configuration for services on the system&lt;/li&gt;
&lt;li&gt;magic unix flags like the number of allowed file descriptors per process&lt;/li&gt;
&lt;li&gt;what drives to mount where&lt;/li&gt;
&lt;li&gt;network configuration&lt;/li&gt;
&lt;li&gt;ACME certificates&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;a href=&quot;https://nixos.org/nixos/options.html#&quot;&gt;and so much more&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;At a high level, machines are configured by setting options like this:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;# basic-lxc-image.nix
{ config, pkgs, ... }:

{
  networking.hostName = &quot;example-for-blog&quot;;
  environment.systemPackages = with pkgs; [ wget vim ];
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This would specify a simple NixOS machine with the hostname &lt;code&gt;example-for-blog&lt;/code&gt; and with wget and vim installed. This is nowhere near enough to boot an entire system, but is good enough for describing the base layout of a basic &lt;a href=&quot;https://linuxcontainers.org/lxc/introduction/&quot;&gt;LXC&lt;/a&gt; image.&lt;/p&gt;
&lt;p&gt;For a more complete example of NixOS configurations, see &lt;a href=&quot;https://github.com/Xe/nixos-configs/tree/master/hosts&quot;&gt;here&lt;/a&gt; or repositories on &lt;a href=&quot;https://nixos.wiki/wiki/Configuration_Collection&quot;&gt;this handy NixOS wiki page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The main configuration.nix file (usually at &lt;code&gt;/etc/nixos/configuration.nix&lt;/code&gt;) can also import other NixOS modules using the &lt;code&gt;imports&lt;/code&gt; attribute:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-nix&quot;&gt;# better-vm.nix
{ config, pkgs, ... }:

{
  imports = [
    ./basic-lxc-image.nix
  ];
  
  networking.hostName = &quot;better-vm&quot;;
  services.nginx.enable = true;
}
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And the &lt;code&gt;better-vm.nix&lt;/code&gt; file would describe a machine with the hostname &lt;code&gt;better-vm&lt;/code&gt; that has wget and vim installed, but is also running nginx with its default configuration.&lt;/p&gt;
&lt;p&gt;Internally, every one of these options will be fed into auto-generated Nix packages that will describe the system configuration bit by bit.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;nixos-rebuild&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;One of the handy features about Nix is that every package exists in its own part of the Nix store. This allows you to leave the older versions of a package laying around so you can roll back to them if you need to. &lt;code&gt;nixos-rebuild&lt;/code&gt; is the tool that helps you commit configuration changes to the system as well as roll them back.&lt;/p&gt;
&lt;p&gt;If you want to upgrade your entire system:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ sudo nixos-rebuild switch --upgrade
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;This tells nixos-rebuild to upgrade the package channels, use those to create a new base system description, switch the running system to it and start/restart/stop any services that were added/upgraded/removed during the upgrade. Every time you rebuild the configuration, you create a new “generation” of configuration that you can roll back to just as easily:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ sudo nixos-rebuild switch --rollback
&lt;/code&gt;
&lt;/pre&gt;
&lt;h3&gt;Garbage Collection&lt;/h3&gt;
&lt;p&gt;As upgrades happen and old generations pile up, this may end up taking up a lot of unwanted disk (and boot menu) space. To free up this space, you can use &lt;code&gt;nix-collect-garbage&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-console&quot;&gt;$ sudo nix-collect-garbage
&amp;lt; cleans up packages not referenced by anything &amp;gt;

$ sudo nix-collect-garbage -d
&amp;lt; deletes old generations and then cleans up packages not referenced by anything &amp;gt;
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;The latter is a fairly powerful command and can wipe out older system states. Only run this if you are sure you don’t want to go back to an older setup.&lt;/p&gt;
&lt;h2&gt;How I Use It&lt;/h2&gt;
&lt;p&gt;Each of these things builds on top of eachother to make the base platform that I built my desktop environment on. I have the configuration for &lt;a href=&quot;https://github.com/Xe/xepkgs/tree/master/modules/fish&quot;&gt;my shell&lt;/a&gt;, &lt;a href=&quot;https://github.com/Xe/nixos-configs/tree/master/common/users/cadey/spacemacs&quot;&gt;emacs&lt;/a&gt;, &lt;a href=&quot;https://github.com/Xe/xepkgs/tree/master/modules/dwm&quot;&gt;my window manager&lt;/a&gt; and just about &lt;a href=&quot;https://github.com/Xe/nixos-configs/tree/master/common&quot;&gt;every program I use on a regular basis&lt;/a&gt; defined in their own NixOS modules so I can pick and choose things for new machines.&lt;/p&gt;
&lt;p&gt;When I want to change part of my config, I edit the files responsible for that part of the config and then rebuild the system to test it. If things work properly, I commit those changes and then continue using the system like normal.&lt;/p&gt;
&lt;p&gt;This is a little bit more work in the short term, but as a result I get a setup that is easier to recreate on more machines in the future. It took me a half hour or so to get the configuration for &lt;a href=&quot;https://pwmt.org/projects/zathura/&quot;&gt;zathura&lt;/a&gt; right, but now I have &lt;a href=&quot;https://github.com/Xe/nixos-configs/tree/master/common/users/cadey/zathura&quot;&gt;a zathura module&lt;/a&gt; that lets me get exactly the setup I want every time.&lt;/p&gt;
&lt;h2&gt;TL;DR&lt;/h2&gt;
&lt;p&gt;Nix and NixOS ruined me. It’s hard to go back.&lt;/p&gt;
&lt;hr/&gt;&lt;button onclick=&quot;share_on_mastodon()&quot;&gt;Share on Mastodon&lt;/button&gt;
&lt;p&gt;This article was posted on 2020 M4 25. Facts and circumstances may have changed since publication. Please &lt;a href=&quot;https://christine.website/contact&quot;&gt;contact me&lt;/a&gt; before jumping to conclusions if something seems wrong or unclear.&lt;/p&gt;
&lt;p&gt;Series: &lt;a href=&quot;https://christine.website/blog/series/howto&quot;&gt;howto&lt;/a&gt;&lt;/p&gt;
</description>
<pubDate>Sun, 26 Apr 2020 05:07:52 +0000</pubDate>
<dc:creator>pcr910303</dc:creator>
<og:type>website</og:type>
<og:title>My NixOS Desktop Flow</og:title>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://christine.website/blog/nixos-desktop-flow-2020-04-25</dc:identifier>
</item>
<item>
<title>Japan to subsidize 100% of salaries at small companies</title>
<link>https://asia.nikkei.com/Economy/Japan-to-subsidize-100-of-salaries-at-small-companies</link>
<guid isPermaLink="true" >https://asia.nikkei.com/Economy/Japan-to-subsidize-100-of-salaries-at-small-companies</guid>
<description>&lt;p&gt;TOKYO -- Japan is working on a subsidy to ensure that temporarily idled small-business employees receive 100% of their wages during the current state of emergency, Nikkei has learned.&lt;/p&gt;
&lt;p&gt;The Ministry of Health, Labor and Welfare plans to use an existing employment adjustment subsidy, which helps enterprises seeing no choice but to temporarily lay off workers continue to pay them, at least in part.&lt;/p&gt;
&lt;p&gt;As things stand, laid-off workers at companies that have halted operations are entitled to at least 60% of their regular pay. The government shoulders up to 90% of this to keep them from being dismissed outright, with the company chipping in the other 10%.&lt;/p&gt;

&lt;p&gt;Many employers try to save money by sticking to the 60% minimum and asking the government to pay 90% of it.&lt;/p&gt;
&lt;p&gt;The offer will be more generous going forward. If small companies -- those in the service sector with up to five workers and manufacturers with up to 20 -- are asked by the central or local government to temporarily shutter operations, and they apply for the employment adjustment subsidy, the government will shoulder the full cost as long as the businesses pay 100% of last year's wage levels.&lt;/p&gt;
&lt;p&gt;With companies not having to pay anything out of pocket, most will choose the 100% option, the government figures.&lt;/p&gt;
&lt;p&gt;The Tokyo Metropolitan Government and other localities across Japan have asked restaurants and other businesses to close or shorten hours during the health crisis. The central government's financial support aims to maintain the income levels of workers in these industries.&lt;/p&gt;
&lt;p&gt;The subsidy program's parameters will cover 3 million companies and about 10 million employees.&lt;/p&gt;
&lt;p&gt;The employment adjustment subsidy has not proved popular so far, partly owing to its complicated paperwork and the roughly one-month wait for processing applications. In the current crisis, just 985 companies had applied in the two months leading up to April 17.&lt;/p&gt;


</description>
<pubDate>Sun, 26 Apr 2020 02:43:05 +0000</pubDate>
<dc:creator>yoquan</dc:creator>
<og:title>Japan to subsidize 100% of salaries at small companies</og:title>
<og:description>Program aims to pay 10m laid-off workers their full wages</og:description>
<og:image>https://www.ft.com/__origami/service/image/v2/images/raw/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fpsh-ex-ftnikkei-3937bb4%2Fimages%2F4%2F8%2F8%2F3%2F26693884-3-eng-GB%2FCropped-1587724353RTX7EEZ5.JPG?source=nar-cms&amp;width=1024&amp;height=512&amp;fit=cover&amp;gravity=faces</og:image>
<og:url>https://asia.nikkei.com/Economy/Japan-to-subsidize-100-of-salaries-at-small-companies</og:url>
<og:type>website</og:type>
<dc:language>en-GB</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://asia.nikkei.com/Economy/Japan-to-subsidize-100-of-salaries-at-small-companies</dc:identifier>
</item>
<item>
<title>Europe’s cities are making less room for cars after coronavirus</title>
<link>https://www.citylab.com/transportation/2020/04/coronavirus-reopen-cities-public-transit-car-free-bike-milan/610360/</link>
<guid isPermaLink="true" >https://www.citylab.com/transportation/2020/04/coronavirus-reopen-cities-public-transit-car-free-bike-milan/610360/</guid>
<description>&lt;div id=&quot;article-section-1&quot;&gt;&lt;p&gt;How will cities carefully emerge from their coronavirus quarantines once lockdown measures are relaxed? That question might seem premature in the U.S., but in places where the virus struck earlier, cities are working out strategies for a return to something approaching normal urban life.&lt;/p&gt;
&lt;p&gt;Italy appears to have &lt;a href=&quot;https://www.economist.com/graphic-detail/2020/04/17/coronavirus-infections-have-peaked-in-much-of-the-rich-world&quot;&gt;passed its mortality peak&lt;/a&gt; —  at least for Covid-19’s first wave — and now leaders in Milan and other major urban centers are looking at how people might resume working, socializing and leaving their homes even as coronavirus still remains active. Their answers could well provide an international blueprint for reopened cities.&lt;/p&gt;
&lt;/div&gt;&lt;div id=&quot;article-section-2&quot;&gt;&lt;p&gt;First off, Italian city governments are concluding, transit habits will need to change. The role that buses and subway systems play in spreading the disease remains &lt;a href=&quot;https://www.citylab.com/transportation/2020/04/coronavirus-cases-new-york-subway-infection-riders-mta/610159/&quot;&gt;incompletely understood (and controversial&lt;/a&gt;), but it’s clear that public transit systems risk becoming hot spots for transmission if they get too crowded. Accordingly, says Milan Mayor &lt;a href=&quot;https://milano.corriere.it/notizie/cronaca/20_aprile_20/04-politico-t1ewqeqwecorriere-web-milano-2a62583a-826d-11ea-afba-f0dcf1bf9a9f.shtml&quot;&gt;Beppe Sala&lt;/a&gt;, the city plans to maintain its metro system’s capacity at less than two-thirds of its pre-pandemic activity. Instead of the 1.4 million average trips it saw daily before the pandemic, it will accommodate a maximum daily ridership of 400,000.&lt;/p&gt;
&lt;p&gt;To assist this, the floors of metro cars and buses will be marked out with circles showing passengers the right level of distance to maintain. If the system looks like it will exceed the passenger numbers that makes this level of distancing possible, station entrances will be temporarily closed until congestion eases.&lt;/p&gt;
&lt;p&gt;But the metro makeover is only one part of what looks like a more dramatic reimagining of the Milanese calendar: The city’s work, school, and daily life patterns are being redrawn to accommodate the need to flatten peaks in transit use. Those who can work from home would continue to do so, while others, such as shop workers and students, should be given some flexibility in their routine. The city will encourage stores to stay open throughout the evening and the start of the school day will be staggered, with different classes starting at various points between 8 a.m. and 10 a.m. To help students catch up with missed classes, meanwhile, the city also wants to set up summer schools over the long break, which normally starts in the second week of June and continues until September.&lt;/p&gt;
&lt;/div&gt;&lt;div id=&quot;article-section-3&quot;&gt;&lt;p&gt;Milan is also joining many other European cities in using the coronavirus crisis to reevaluate its relationship with automobiles, which threaten to become a more popular post-pandemic commuting mode when transit-anxious workers venture back to the office. But with 55% of Milanese using public transit daily before the pandemic, the city — like many in Europe —  simply doesn’t have enough vehicles or parking spots to switch over from relying on trains and buses to relying on private cars. Nor does it want to try: There is already an &lt;a href=&quot;https://www.bloomberg.com/news/articles/2020-04-14/air-pollution-s-insidious-link-to-the-coronavirus-pandemic&quot;&gt;alarming pattern&lt;/a&gt; of correlation between high air pollution and high mortality rates for Covid-19, and &lt;a href=&quot;https://www.thelocal.it/20190228/po-valley-air-pollution-italy&quot;&gt;Northern Italy has some of the nation’s worst air quality&lt;/a&gt;. Cities still battling a disease that frequently attacks the lungs will be reluctant to rely on a transit mode that does so much damage to air quality.&lt;/p&gt;
&lt;section class=&quot;c-newsletter c-newsletter--promo c-newsletter--cta&quot; readability=&quot;-22.258064516129&quot;&gt;&lt;h2 class=&quot;c-newsletter__title&quot;&gt;Cities are changing fast. Keep up with the &lt;strong&gt;CityLab Daily&lt;/strong&gt; newsletter.&lt;/h2&gt;
&lt;div class=&quot;c-newsletter__content c-newsletter__content--promo&quot; readability=&quot;5.8545454545455&quot;&gt;
&lt;p&gt;The best way to follow issues you care about.&lt;/p&gt;
&lt;a href=&quot;http://link.mail.bloombergbusiness.com/join/4wm/citylab-daily&amp;amp;hash=b9b2681361bede0e1069ca238efb1ec2&quot; class=&quot;c-btn c-btn--signup c-btn--promo c-newsletter__submit--promo&quot;&gt;Subscribe&lt;/a&gt;&lt;/div&gt;
&lt;/section&gt;&lt;p&gt;As a result, Milan is going big on cycling and walking. Over the summer, the city core will be &lt;a href=&quot;https://www.theguardian.com/world/2020/apr/21/milan-seeks-to-prevent-post-crisis-return-of-traffic-pollution?CMP=Share_AndroidApp_Tweet&quot;&gt;partly remodeled&lt;/a&gt; to give over 22 miles (35 kilometers) of road space previously used by cars to bikes and pedestrians. Those cars that are allowed into the center must adhere to a new reduced 30 kilometers per hour speed limit. The aim is to make traffic more fluid and give pedestrians more space to spread out safely.&lt;/p&gt;
&lt;p&gt;Milan may be ahead of the curve, but it is far from the only European city considering similar car-mitigation measures. Rome Mayor Virginia Raggi also wants to encourage &lt;a href=&quot;https://www.lastampa.it/cronaca/2020/04/20/news/roma-per-la-fase-2-raggi-riparte-da-bici-monopattini-e-scuole-estive-1.38741303&quot;&gt;more active travel&lt;/a&gt; and open summer schools, while boroughs in Berlin are also reclaiming road space to make into wider &lt;a href=&quot;https://www.rbb24.de/panorama/thema/2020/coronavirus/beitraege_neu/2020/04/breitere-radwege-verkehrsverwaltung.html&quot;&gt;bike lanes&lt;/a&gt;. Brussels has gone yet further. From May 4, the Belgian capital’s entire city core will be a &lt;a href=&quot;https://www.lesechos.fr/monde/europe/a-bruxelles-pietons-et-cyclistes-auront-desormais-la-priorite-sur-les-automobilistes-1196778&quot;&gt;priority zone&lt;/a&gt; for cyclists and pedestrians, one in which cars cannot exceed a speed of 20 kph and must give way in the roads to people on foot or on bikes. This comes on top of an &lt;a href=&quot;https://www.citylab.com/environment/2019/05/brussels-car-free-traffic-congestion-pedestrian-boulevards/588451/&quot;&gt;ongoing pedestrianization plan&lt;/a&gt; designed to make Brussels’ core a more attractive place for people on foot.&lt;/p&gt;
&lt;p&gt;In Paris, meanwhile, that &lt;a href=&quot;https://www.citylab.com/transportation/2017/03/the-cars-that-ate-paris/520710/&quot;&gt;city’s campaign against private cars&lt;/a&gt; will get a fresh boost: As well as expanding the width of existing cycle lanes, Paris and the Île-de-France region are fast-tracking a temporary version of its planned new network of &lt;a href=&quot;https://www.citylab.com/transportation/2019/08/paris-bike-lanes-rer-v-cycle-track-petite-couronne/596089/&quot;&gt;nine long-distance cycleways&lt;/a&gt; in response to the pandemic. Linking the inner city with the suburbs, the first stretches of this new network will open in May.&lt;/p&gt;
&lt;/div&gt;&lt;div id=&quot;article-section-4&quot;&gt;&lt;p&gt;It’s not clear if all these measures will be retained once the threat of coronavirus has receded, but they’re nonetheless highly significant. It is not just that they reflect innovative ways to maintain social distancing in cities that have gone back to work: They also emphasize the way the wind is blowing. Before Covid-19 swept the globe, many European cities were reducing the space and access they &lt;a href=&quot;https://www.citylab.com/transportation/2019/04/central-london-ulez-ultra-low-emissions-zone-car-congestion-charge/586561/&quot;&gt;allotted to cars&lt;/a&gt;, improving their &lt;a href=&quot;https://www.citylab.com/transportation/2017/12/berlin-bike-revolution/548297/&quot;&gt;cycling infrastructure&lt;/a&gt;, and &lt;a href=&quot;https://www.citylab.com/environment/2020/02/paris-election-anne-hidalgo-city-planning-walks-stores-parks/606325/&quot;&gt;enlarging sidewalks&lt;/a&gt; to fit more people on foot. If such changes can also work to keep cities functioning after lockdowns cease, they could show that pro-pedestrian policies were not urbanist fantasies, but durable, practical ways to build a livable post-pandemic urban future. That’s something cities around with world will need to achieve.&lt;/p&gt;
&lt;/div&gt;</description>
<pubDate>Sat, 25 Apr 2020 21:52:10 +0000</pubDate>
<dc:creator>pseudolus</dc:creator>
<og:description>Hard-hit Milan may be leading the way in reimagining how transit and commuting patterns could change as cities emerge from coronavirus shutdowns.</og:description>
<og:image>https://cdn.theatlantic.com/thumbor/kAwQK1DUjJ1nMxjvFEHlJ5JM4Ik=/0x845:5760x3836/960x500/https://cdn.citylab.com/media/img/citylab/2020/04/361056528/original.jpg</og:image>
<og:title>Europe’s Cities Are Making Less Room for Cars After Coronavirus</og:title>
<og:type>article</og:type>
<og:url>https://www.citylab.com/transportation/2020/04/coronavirus-reopen-cities-public-transit-car-free-bike-milan/610360/</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.citylab.com/transportation/2020/04/coronavirus-reopen-cities-public-transit-car-free-bike-milan/610360/</dc:identifier>
</item>
<item>
<title>In 4 US state prisons, 3,300 inmates test positive, 96% without symptoms</title>
<link>https://www.reuters.com/article/us-health-coronavirus-prisons-testing-in/in-four-u-s-state-prisons-nearly-3300-inmates-test-positive-for-coronavirus-96-without-symptoms-idUSKCN2270RX</link>
<guid isPermaLink="true" >https://www.reuters.com/article/us-health-coronavirus-prisons-testing-in/in-four-u-s-state-prisons-nearly-3300-inmates-test-positive-for-coronavirus-96-without-symptoms-idUSKCN2270RX</guid>
<description>&lt;p&gt;(Reuters) - When the first cases of the new coronavirus surfaced in Ohio’s prisons, the director in charge felt like she was fighting a ghost.&lt;/p&gt;
&lt;p&gt;“We weren’t always able to pinpoint where all the cases were coming from,” said Annette Chambers-Smith, director of the Ohio Department of Rehabilitation and Correction. As the virus spread, they began mass testing.&lt;/p&gt;
&lt;p&gt;They started with the Marion Correctional Institution, which houses 2,500 prisoners in north central Ohio, many of them older with pre-existing health conditions. After testing 2,300 inmates for the coronavirus, they were shocked. Of the 2,028 who tested positive, close to 95% had no symptoms.&lt;/p&gt;
&lt;p&gt;“It was very surprising,” said Chambers-Smith, who oversees the state’s 28 correctional facilities.&lt;/p&gt;
&lt;p&gt;As mass coronavirus testing expands in prisons, large numbers of inmates are showing no symptoms. In four state prison systems — Arkansas, North Carolina, Ohio and Virginia — 96% of 3,277 inmates who tested positive for the coronavirus were asymptomatic, according to interviews with officials and records reviewed by Reuters. That’s out of 4,693 tests that included results on symptoms.&lt;/p&gt;
&lt;p&gt;The numbers are the latest evidence to suggest that people who are asymptomatic — contagious but not physically sick — may be driving the spread of the virus, not only in state prisons that house 1.3 million inmates across the country, but also in communities across the globe. The figures also reinforce questions over whether testing of just people suspected of being infected is actually capturing the spread of the virus.&lt;/p&gt;
&lt;p&gt;“It adds to the understanding that we have a severe undercount of cases in the U.S.,” said Dr. Leana Wen, adjunct associate professor of emergency medicine at George Washington University, said of the Reuters findings. “The case count is likely much, much higher than we currently know because of the lack of testing and surveillance.”&lt;/p&gt;
&lt;p&gt;Some people diagnosed as asymptomatic when tested for the coronavirus, however, may go on to develop symptoms later, according to researchers.&lt;/p&gt;
&lt;p&gt;The United States has more people behind bars than any other nation, a total incarcerated population of nearly 2.3 million as of 2017 — nearly half of which is in state prisons. Smaller numbers are locked in federal prisons and local jails, which typically hold people for relatively short periods as they await trial.&lt;/p&gt;
&lt;p&gt;State prison systems in Michigan, Tennessee and California have also begun mass testing — checking for coronavirus infections in large numbers of inmates even if they show no sign of illness — but have not provided specific counts of asymptomatic prisoners.&lt;/p&gt;
&lt;p&gt;Tennessee said a majority of its positive cases didn’t show symptoms. In Michigan, state authorities said “a good number” of the 620 prisoners who tested positive for the coronavirus were asymptomatic. California’s state prison system would not release counts of asymptomatic prisoners.&lt;/p&gt;
&lt;p&gt;Each state manages multiple prison facilities. Ohio, for instance, has 49,000 prisoners in 28 facilities. A total 3,837 inmates tested positive for the coronavirus in 15 of those facilities. But the state has not yet provided results on symptoms for 1,809 of them and did not identify the total number of tests conducted across the prison system.&lt;/p&gt;
&lt;p&gt;Arkansas and Tennessee have also taken a targeted approach by conducting mass testing in several of their facilities. Michigan, North Carolina, California and Virginia have started with one facility each.&lt;/p&gt;
&lt;p&gt;Most state prisons did not provide the age or other demographic details of those who tested positive for the coronavirus, which has killed more than 200,000 people globally, including more than 53,000 in the United States.&lt;/p&gt;
&lt;h3&gt;VAST UNDERCOUNT&lt;/h3&gt;
&lt;p&gt;Reuters surveyed all 50 state prison systems. Of the 30 that responded, most are only testing inmates who show symptoms, suggesting they could be vastly undercounting the number infected by the coronavirus.&lt;/p&gt;
&lt;p&gt;Florida and Texas, whose inmate populations are bigger than Ohio’s, report a combined total of just 931 cases — far fewer than the 3,837 inmates who tested positive in Ohio. New York, the epicenter of the U.S. outbreak, has reported 269 positive cases among 51,000 inmates. All three states are testing only symptomatic prisoners.&lt;/p&gt;
&lt;p&gt;“Prison agencies are almost certainly vastly undercounting the number of COVID cases among incarcerated persons,” said Michele Deitch, a corrections specialist and senior lecturer at the University of Texas. “Just as the experts are telling us in our free-world communities, the only way to get ahead of this outbreak is through mass testing.”&lt;/p&gt;
&lt;p&gt;Prison officials in Florida and Texas said they were following guidance from the U.S. Centers for Disease Control and Prevention along with state health officials when testing only inmates showing symptoms of the virus. New York’s Department of Corrections said its policy of only testing prisoners who show symptoms was “reflective of testing procedures in the general public.”&lt;/p&gt;
&lt;p&gt;Tennessee took an aggressive approach after a dozen inmates tested positive at the Bledsoe County Correctional Complex in the city of Pikeville last week. The state’s Department of Correction has tested 3,503 prisoners at Bledsoe, the Northwest Correctional Complex and the Turney Center Industrial Complex.&lt;/p&gt;
&lt;p&gt;As of Friday, 651 were positive, and most of them were asymptomatic, the department said.&lt;/p&gt;
&lt;p&gt;“It’s what makes the pandemic more difficult to manage,” said Marc Stern, former medical director for the Washington State Department of Corrections and a faculty member at the University of Washington’s School of Public Health. “There are a whole lot of people who are asymptomatic.”&lt;/p&gt;
&lt;p&gt;After a recent spike in cases at the Neuse Correctional Institution in Goldsboro, North Carolina, state correctional officials tested all 723 prisoners last week. Of the 444 who were infected by the virus, 98% were asymptomatic, the state’s department of public safety said. One inmate has died at the prison.&lt;/p&gt;
&lt;p&gt;Similarly, mass testing at two Arkansas prisons — the Cummins Unit in the city of Grady and the Community Correction Center in the state capital Little Rock — found 751 infected inmates, almost all of them asymptomatic, the state corrections department said. It did not provide the total number of inmates who were tested.&lt;/p&gt;
&lt;p&gt;Arkansas’ prisons have faced contagious disease outbreaks before, such as scabies and chickenpox, but those episodes were easier to manage because inmates showed overt symptoms, said Arkansas Department of Corrections spokeswoman Dina Tyler. “But with this virus, you have no idea because so many are asymptomatic. It makes it very challenging to contain,” she said.&lt;/p&gt;
&lt;p&gt;‘24-HOUR TURNAROUND IS CRUCIAL’&lt;/p&gt;
&lt;p&gt;Michigan’s Lakeland Correctional Facility houses some of the state’s oldest and most medically frail prisoners. When coronavirus cases surged, the prison saw a spike in infections and deaths. As of April 23, nine Lakeland inmates had died from COVID-19, accounting for a third of the deaths across Michigan’s 29 state prisons.&lt;/p&gt;
&lt;p&gt;Nearly half of Lakeland’s 1,400 prisoners suffer from chronic underlying health conditions, according to state data. Many are in wheelchairs, and the minimum-security facility in southern Michigan has its own geriatric unit for its large elderly population.&lt;/p&gt;
&lt;p&gt;On Tuesday, the prison tested all 400 inmates in the geriatric ward and plans to test the rest of the facility by the end of the week. Of the 971 tested so far, 642, or about 66%, were positive. A state official declined to disclose how many were asymptomatic.&lt;/p&gt;
&lt;p&gt;“We know mass testing is going to make our numbers spike and might make us look bad,” said Chris Gautz, spokesman for the Michigan Department of Corrections. “But I don’t think there’s another prison system in the country that doesn’t have large numbers. They just might not be testing as rigorously as we are.”&lt;/p&gt;
&lt;p&gt;All tested inmates are quarantined in their rooms or units pending the test results, which usually come back in a day, he said. “The 24-hour turnaround is crucial” because once an inmate tests negative, they can return to the general population, he said.&lt;/p&gt;
&lt;div class=&quot;Image_container&quot; tabindex=&quot;-1&quot;&gt;
&lt;div class=&quot;LazyImage_container LazyImage_dark&quot;&gt;&lt;img src=&quot;https://s4.reutersmedia.net/resources/r/?m=02&amp;amp;d=20200425&amp;amp;t=2&amp;amp;i=1516457015&amp;amp;r=LYNXNPEG3O0KR&amp;amp;w=20&quot; aria-label=&quot;FILE PHOTO: The exterior of the Marion Correctional Institution where there have been positive cases of the coronavirus disease (COVID-19) in Marion, Ohio, U.S., April 22, 2020. REUTERS/Dane Rhys&quot;/&gt;
&lt;/div&gt;

&lt;div class=&quot;Image_caption&quot;&gt;

&lt;span&gt;FILE PHOTO: The exterior of the Marion Correctional Institution where there have been positive cases of the coronavirus disease (COVID-19) in Marion, Ohio, U.S., April 22, 2020. REUTERS/Dane Rhys&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;In the seven state prison systems conducting mass tests, 49 inmates have died.&lt;/p&gt;
&lt;p&gt;As the coronavirus spreads behind bars, rights groups and public defenders say they fear more will succumb, and have pressed for the release of nonviolent older and medically high-risk inmates. While thousands have been let out, crowded, often unsanitary conditions have raised concerns that jails and prisons could become vectors for the disease.&lt;/p&gt;
&lt;p&gt;“They’re worse than landlocked cruise ships,” Stern, the corrections expert, said, referring to stranded cruise ships that have been overwhelmed by coronavirus infections.&lt;/p&gt;
&lt;div class=&quot;Attribution_container&quot; readability=&quot;6.5&quot;&gt;
&lt;div class=&quot;Attribution_attribution&quot; readability=&quot;8&quot;&gt;
&lt;p class=&quot;Attribution_content&quot;&gt;Linda So reported from Washington and Grant Smith from New York. Additional reporting by Brad Heath. Editing by Jason Szep&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;StandardArticleBody_trustBadgeContainer&quot;&gt;&lt;span class=&quot;StandardArticleBody_trustBadgeTitle&quot;&gt;Our Standards:&lt;/span&gt;&lt;span class=&quot;trustBadgeUrl&quot;&gt;&lt;a href=&quot;http://thomsonreuters.com/en/about-us/trust-principles.html&quot;&gt;The Thomson Reuters Trust Principles.&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;
</description>
<pubDate>Sat, 25 Apr 2020 19:58:26 +0000</pubDate>
<dc:creator>throwaway888abc</dc:creator>
<og:title>In four U.S. state prisons, nearly 3,300 inmates test positive for coronavirus -- 96% without symptoms</og:title>
<og:url>https://www.reuters.com/article/us-health-coronavirus-prisons-testing-in-idUSKCN2270RX</og:url>
<og:type>article</og:type>
<og:description>When the first cases of the new coronavirus surfaced in Ohio’s prisons, the director in charge felt like she was fighting a ghost.</og:description>
<og:image>https://s4.reutersmedia.net/resources/r/?m=02&amp;d=20200425&amp;t=2&amp;i=1516457015&amp;w=1200&amp;r=LYNXNPEG3O0KR</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.reuters.com/article/us-health-coronavirus-prisons-testing-in/in-four-u-s-state-prisons-nearly-3300-inmates-test-positive-for-coronavirus-96-without-symptoms-idUSKCN2270RX</dc:identifier>
</item>
<item>
<title>Liero can be played in browser now, for those who remember</title>
<link>https://www.webliero.com/</link>
<guid isPermaLink="true" >https://www.webliero.com/</guid>
<description>[unable to retrieve full-text content]
&lt;p&gt;Article URL: &lt;a href=&quot;https://www.webliero.com/&quot;&gt;https://www.webliero.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=22980676&quot;&gt;https://news.ycombinator.com/item?id=22980676&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Points: 316&lt;/p&gt;
&lt;p&gt;# Comments: 80&lt;/p&gt;
</description>
<pubDate>Sat, 25 Apr 2020 19:29:55 +0000</pubDate>
<dc:creator>farseer</dc:creator>
<og:image>https://www.webliero.com/thumbnail.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.webliero.com/</dc:identifier>
</item>
</channel>
</rss>