<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Things I Learnt from a Senior Software Engineer</title>
<link>https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html</link>
<guid isPermaLink="true" >https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html</guid>
<description>&lt;p&gt;A year ago, I started working full-time at Bloomberg. That’s when I imagined writing this post. I imagined myself to be full of ideas that I could spit out on paper when the time comes. Just one month in, I realised it won’t be that easy: I was already forgetting things I learnt. They either became so internalized that my mind tricked me into believing I always knew them&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:3&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, or they slipped my mind.&lt;/p&gt;
&lt;p&gt;That’s one of the reasons I started keeping &lt;a href=&quot;https://neilkakkar.com/the-human-log.html&quot;&gt;a human log&lt;/a&gt;. Every day, whenever I came across an interesting situation, I logged it. All thanks to sitting next to a senior software engineer, I could closely observe what they were doing, and how it was different from what I would do. We pair-programmed a lot, which made doing this easier. Further, in my team culture it’s not frowned upon to “snoop behind” people writing code. Whenever I sensed something interesting going on, I’d roll around and watch what was happening. I always had the context, thanks to regular standups.&lt;/p&gt;
&lt;p&gt;I sat next to a senior software engineer for a year. Here’s what I learnt.&lt;/p&gt;
&lt;nav&gt;&lt;h4&gt;Table of Contents&lt;/h4&gt;
&lt;/nav&gt;&lt;h2 id=&quot;writing-code&quot;&gt;Writing code&lt;/h2&gt;
&lt;h3 id=&quot;how-to-name-stuff&quot;&gt;How to name stuff&lt;/h3&gt;
&lt;p&gt;One of the first things I worked on was a React UI. We had a main component housing every other component. I like a bit of humour in my code, and I wanted to name it &lt;code class=&quot;highlighter-rouge&quot;&gt;GodComponent&lt;/code&gt;. Come code review time, and that’s when I understood why naming things is hard.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are two hard things in computer science: cache invalidation, naming things, and off-by-one errors. - &lt;a href=&quot;https://twitter.com/secretGeek/status/7269997868&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Leon Bambrick&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Every code piece I baptize has an implicit meaning attached to it. &lt;code class=&quot;highlighter-rouge&quot;&gt;GodComponent&lt;/code&gt;? That’s the component where all the crap I can’t be bothered to fit in the right place goes. It houses everything. Had I called it &lt;code class=&quot;highlighter-rouge&quot;&gt;LayoutComponent&lt;/code&gt;, future-me would realise that all it does is assign the layout. It holds no state.&lt;/p&gt;
&lt;p&gt;Another great benefit that I found out was this: If it seems too big, like a &lt;code class=&quot;highlighter-rouge&quot;&gt;LayoutComponent&lt;/code&gt; containing tonnes of business logic, I’ll know it’s time to refactor, because the business logic doesn’t belong there. With the name &lt;code class=&quot;highlighter-rouge&quot;&gt;GodComponent&lt;/code&gt;, the business logic in there wouldn’t make a difference.&lt;/p&gt;
&lt;p&gt;Naming your clusters? Naming them after the service that runs on them is great, till the point you start running something else on them too. We ended up naming them with our team name.&lt;/p&gt;
&lt;p&gt;It’s the same idea with functions. &lt;code class=&quot;highlighter-rouge&quot;&gt;doEverything()&lt;/code&gt; is a terrible name, and the ramifications are plenty. If this function does everything, it’s going to get bloody difficult to test the specific parts of the function. No matter how big this function gets, you’ll never think it’s too weird, since after all, the function is supposed to do everything. Change name. Refactor.&lt;/p&gt;
&lt;p&gt;Meaningful naming has a flip side to it, too. What if the name is too meaningful and hides some nuance? For example, &lt;a href=&quot;https://docs.sqlalchemy.org/en/13/core/pooling.html#pool-disconnects&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;closing sessions&lt;/a&gt; doesn’t close the underlying DB connection when you call &lt;code class=&quot;highlighter-rouge&quot;&gt;session.close()&lt;/code&gt; in SQLAlchemy. (I should’ve RTFM and prevented that bug - more about that in &lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#war-story&quot;&gt;Debugging&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;In this case, thinking of names as &lt;code class=&quot;highlighter-rouge&quot;&gt;x, y, z&lt;/code&gt; instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;count(), close(), insertIntoDB()&lt;/code&gt; prevents assigning implicit meaning to them - and forces me to scrutinize what they are doing.&lt;sup id=&quot;fnref:7&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:7&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;I never imagined I’ll have more than one line to say about how to name stuff.&lt;/p&gt;
&lt;h3 id=&quot;legacy-code-and-the-next-developer&quot;&gt;Legacy code and the next developer&lt;/h3&gt;
&lt;p&gt;Have you ever looked at some code and felt it’s weird? Why do they do it this way? This makes zero sense.&lt;/p&gt;
&lt;p&gt;I had the privilege of working with a legacy codebase. The kind with comments like &lt;em&gt;“Uncomment code when situation figured out with Mohammad.”&lt;/em&gt; What do you do here? Who is Mohammad?&lt;/p&gt;
&lt;p&gt;I can do a role-reversal here - think about the next person coming to my code - will they find it weird or not. Peer reviews solve this somewhat. This led me to the idea of context: Be aware of the context my team is working in.&lt;/p&gt;
&lt;p&gt;If I forget about the code, and come back to it later, and I can’t recreate the context, I’ll go like: “Why the f did they do it this way? This makes zero sense… Oh wait, I did this.”&lt;/p&gt;
&lt;p&gt;And that’s where documentation and code comments come in.&lt;/p&gt;
&lt;h3 id=&quot;documentation-and-code-comments&quot;&gt;Documentation and Code comments&lt;/h3&gt;
&lt;p&gt;They help to preserve context, and share knowledge.&lt;/p&gt;
&lt;p&gt;As Li put it in &lt;a href=&quot;https://www.csc.gov.sg/articles/how-to-build-good-software&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;How to Build Good Software&lt;/a&gt;, “The main value in software is not the code produced, but the knowledge accumulated by the people who produced it.”&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“The main value in software is not the code produced, but the knowledge accumulated by the people who produced it.” - Li&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We have this random client facing API endpoint that no one ever seems to use. Do we just delete it? After-all, it’s tech debt.&lt;/p&gt;
&lt;p&gt;What if I told you, once every year in a specific country, 10 journalists send their reports to that endpoint? How do you test this? If there’s no documentation (there wasn’t), we can’t. So, we didn’t. We deleted that endpoint. A few months down the line came that time of the year. Ten journalists were unable to send 10 important reports because the endpoint didn’t exist anymore.&lt;/p&gt;
&lt;p&gt;The people with the knowledge of the product had left the team. Sure enough, now there are comments in the code explaining what the endpoint is for.&lt;/p&gt;
&lt;p&gt;From what I’ve heard, documentation is something every team struggles with. Not just code documentation but processes around the code. &lt;/p&gt;
&lt;p&gt;We haven’t yet figured out a perfect solution for this.&lt;/p&gt;
&lt;p&gt;I enjoyed Antirez’s breakdown of different types of &lt;a href=&quot;http://antirez.com/news/124&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;worthy code comments&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br/&gt;&lt;ins class=&quot;adsbygoogle&quot; data-ad-layout=&quot;in-article&quot; data-ad-format=&quot;fluid&quot; data-ad-client=&quot;ca-pub-2867716920486339&quot; data-ad-slot=&quot;1203065606&quot;/&gt; &lt;/p&gt;

&lt;h3 id=&quot;atomic-commits&quot;&gt;Atomic commits&lt;/h3&gt;
&lt;p&gt;If you have to rollback (and you will. See &lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#testing&quot;&gt;Testing&lt;/a&gt;), does this commit make sense as one unit?&lt;/p&gt;
&lt;h3 id=&quot;becoming-confident-about-deleting-shit-code&quot;&gt;Becoming confident about deleting shit code&lt;/h3&gt;
&lt;p&gt;I was very uncomfortable deleting shit or obsolete code. I consider what was written eons ago sacred. My thinking goes “They must have something in mind when they wrote this.” It’s tradition and culture vs &lt;a href=&quot;https://neilkakkar.com/A-framework-for-First-Principles-Thinking.html&quot;&gt;first principles thinking&lt;/a&gt;. It’s the same thing that happened with deleting the once-a-year-endpoint. I learnt too specific a lesson there.&lt;sup id=&quot;fnref:6&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:6&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;I’d try to work around the code, the seniors try to work through it. Delete all of it. An if statement that would never be reached? A function that shouldn’t be called? Yep, all gone. Me? I’d just write my function on top. I’ve not reduced tech debt. If anything, I’ve just increased the code complexity and misdirection. The next person would have an even tougher time piecing things together.&lt;/p&gt;
&lt;p&gt;The heuristic I now use is this: There’s code you don’t understand, and there’s code you know you’ll never reach. Delete code you’ll never reach, and be cautious with code you don’t understand.&lt;/p&gt;
&lt;h3 id=&quot;code-reviews&quot;&gt;Code Reviews&lt;/h3&gt;
&lt;p&gt;Code reviews are amazing for learning. It’s an external feedback loop on how you’d write code vs how they write it. What’s the diff? Is one way better than the other? I asked myself this question with every code review I did: “Why did they do it this way?”. Whenever I couldn’t find a suitable answer, I’d go talk to them.&lt;/p&gt;
&lt;p&gt;After the first month, I started catching mistakes in my teammates codes (just like they were doing for mine). This was insane. Peer reviews became a lot more fun for me - it was a game I looked forward to - a game to improve my code-sense.&lt;/p&gt;
&lt;p&gt;My heuristic: Don’t approve code till I understand how it works.&lt;/p&gt;
&lt;img class=&quot;docimage&quot; src=&quot;https://neilkakkar.com/assets/images/github.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;My Github stats&lt;/p&gt;
&lt;h2 id=&quot;testing&quot;&gt;Testing&lt;/h2&gt;
&lt;p&gt;I’ve come to love testing so much that I feel uncomfortable writing code in a codebase without tests.&lt;/p&gt;
&lt;p&gt;If your entire application does one thing (like all my school projects), then testing manually is still okay&lt;sup id=&quot;fnref:5&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:5&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;. That’s what I used to do. But what happens when there are 100 different things the application does? I don’t want to spend half an hour testing everything, and sometimes forgetting what all I need to test. That’s a nightmare.&lt;/p&gt;
&lt;p&gt;Here come tests and test automation.&lt;/p&gt;
&lt;p&gt;I think of testing as documentation. It’s documentation for my assumptions about the code. Tests tell me how I (or the person before me) expect the code to work, and where all they expect things to go wrong.&lt;/p&gt;
&lt;p&gt;So, when I write tests now, I write with this in mind:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Show how to use the class/function/system I’m testing.&lt;/li&gt;
&lt;li&gt;Show what all I think can go wrong.&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;A corollary of the above is that in most cases, I’m testing the behaviour, not the implementation. (&lt;a href=&quot;https://testing.googleblog.com/2013/08/testing-on-toilet-test-behavior-not.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Here’s an example&lt;/a&gt; I picked up during bathroom breaks at Google)&lt;/p&gt;
&lt;p&gt;The things I miss in #2 is where the bugs come from.&lt;/p&gt;
&lt;p&gt;So, whenever I spot a bug, I make sure that the code-fix has a corresponding test (called regression testing) to document the information: This is another way things can go wrong.&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:4&quot; class=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;However, just writing these tests doesn’t improve my code quality, writing the code does. But the insights I gain from reading the tests help me write better code.&lt;/p&gt;
&lt;p&gt;That’s the big picture of testing.&lt;/p&gt;
&lt;p&gt;But, that’s not the only kind of testing to do. This is where deployment environments come in.&lt;/p&gt;
&lt;p&gt;You may have perfect unit tests, but if you don’t have system tests, something like this happens:&lt;/p&gt;
&lt;img src=&quot;https://natooktesting.files.wordpress.com/2017/08/unittest_lock.gif?w=480&amp;amp;zoom=2&quot;/&gt;&lt;p&gt;The lock works(?) &lt;a href=&quot;https://natooktesting.wordpress.com/2017/08/24/x-unit-tests-0-integration-tests/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This holds true for well tested code too: If you don’t have the libraries you need on your machines, you’ll crash and burn.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;
&lt;p&gt;There’s the machines you develop on (source of all “It works on my machine!” memes).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There’s the machines you test on (might be the same as the ones you develop on).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Finally, there’s the machines you deploy on (please don’t let this be the same as the machines you develop on)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;If there’s an environment mismatch between test and deploy machines, you’ll be in trouble. And here’s where deployment environments come in.&lt;/p&gt;
&lt;p&gt;We have local development, which is in docker - on my machine.&lt;/p&gt;
&lt;p&gt;We have a dev environment, where machines have a set of libraries (and dev tools) installed and we install the code we write on these. All testing with other dependant systems can take place here.&lt;/p&gt;
&lt;p&gt;Then comes the beta / stage environment, which is exactly like the production environment.&lt;/p&gt;
&lt;p&gt;Finally, the prod or production environment, which are the machines on which the code runs and serves actual customers.&lt;/p&gt;
&lt;p&gt;The idea is to try and catch errors that unit and system testing wouldn’t. For example, an API mismatch between requesting and responding system.&lt;/p&gt;
&lt;p&gt;I guess things would be very different in a personal project or a small company. Not everyone has the resources to setup their own infrastructure. However, the idea still holds with cloud providers like AWS and Azure.&lt;/p&gt;
&lt;p&gt;You can have separate clusters set up for dev and prod. AWS ECS uses docker images to deploy, so things are relatively consistent across environments. The tricky bit is the integration between other AWS services. Are you calling the right endpoint from the right environment?&lt;/p&gt;
&lt;p&gt;You can even go a step further: Download alternate container images for the other AWS services and setup a local full-fledged environment using docker-compose. It accelerates feedback loops.&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:2&quot; class=&quot;footnote&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;I’ll probably have more experience here once I get my side project up and running.&lt;/p&gt;
&lt;h2 id=&quot;derisking&quot;&gt;Derisking&lt;/h2&gt;
&lt;p&gt;De-risking is the art of reducing risk with the code that you deploy.&lt;/p&gt;
&lt;p&gt;What all steps can you take to reduce the risk of disaster?&lt;/p&gt;
&lt;p&gt;If it’s a new breaking change, how can you ensure minimal disruption when things go wrong?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“We don’t need to do a full-system deploy with all those new changes.” Oh, wait, really? How did I never think of this!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;design&quot;&gt;Design&lt;/h2&gt;
&lt;p&gt;Why am I putting design after writing code and testing? Well, design might come first, but if I haven’t coded and tested in the environment I’m in, I probably wouldn’t be great at designing a system that respects the quirks of the environment.&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html#fn:1&quot; class=&quot;footnote&quot;&gt;7&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;There’s so much to think about when designing a system.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;What’s the usage numbers?&lt;/li&gt;
&lt;li&gt;How many users exist? and what’s the expected growth? (This will translate into how many db rows)&lt;/li&gt;
&lt;li&gt;What might be the future pitfalls?&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;I need to convert this into a proper checklist titled “Gathering Requirements.” I haven’t had enough experience with it this year, which is something to solve in my next year at Bloomberg.&lt;/p&gt;
&lt;p&gt;This process goes a bit against Agile - how much can you design before getting to the implementation? It’s a balance - and you need to choose when to do what. When does diving in headfirst make sense, and when does taking a step back?&lt;/p&gt;
&lt;p&gt;Of course, just gathering requirements isn’t everything to think about. I think it pays off to include the development processes in design as well. Things like&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;How will local development work?&lt;/li&gt;
&lt;li&gt;How will we package and deploy?&lt;/li&gt;
&lt;li&gt;How will we do end-to-end testing?&lt;/li&gt;
&lt;li&gt;How will we stress-test this new service?&lt;/li&gt;
&lt;li&gt;How will we manage secrets?&lt;/li&gt;
&lt;li&gt;CI/CD integration?&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;We recently developed a new search system for &lt;a href=&quot;https://www.bnef.com&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BNEF&lt;/a&gt;. Working on this was wonderful. I got to design local development, learn about DPKGs (packaging and deployment), and wrestled with secret deployment.&lt;/p&gt;
&lt;p&gt;Who thought deploying secrets to production can get that tricky?&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;You can’t put them in code, as then anyone can see them.&lt;/li&gt;
&lt;li&gt;Put them as an env variable, like the &lt;a href=&quot;https://12factor.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;12 factor app&lt;/a&gt; suggests? It’s a good idea. How do you put them there? (Accessing PROD machines to populate env variables everytime the machine starts is a pain)&lt;/li&gt;
&lt;li&gt;Deploy as a secrets file? Where does the file come from? How is it populated?&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;We don’t want things to be manual.&lt;/p&gt;
&lt;p&gt;In the end, we went with a database with role access control (only our machines and us can talk to the database). Our code gets the secrets from this database on startup. This replicates very well across dev, beta and prod - with secrets in the respective databases.&lt;/p&gt;
&lt;p&gt;Again, this can be very different with a cloud provider like AWS. You don’t have to think much about secrets. Get your role account, input secrets in the UI, and your code shall find them when it needs them. It’s pretty cool how much it simplifies things - but I’m glad to have the experience to appreciate the simplicity.&lt;/p&gt;
&lt;h3 id=&quot;designing-with-maintenance-in-mind&quot;&gt;Designing with maintenance in mind&lt;/h3&gt;
&lt;p&gt;Designing systems is exciting. Maintaining them? Not so much.&lt;/p&gt;
&lt;p&gt;My journey through maintenance led me to this question. Why and how do systems degrade?&lt;/p&gt;
&lt;p&gt;First part is not deprecating old stuff, always adding more. A bias towards addition instead of deletion. (Reminds you of someone?)&lt;/p&gt;
&lt;p&gt;The second part is designing with an end goal in mind. A system that evolves to do things it wasn’t supposed to do necessarily doesn’t work as well as a system designed from scratch to do the same thing. This is the taking-a-step-back approach instead of hacking away with agility.&lt;/p&gt;
&lt;p&gt;I now know of atleast three ways to reduce rate of degradation.&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Keep the business logic and the infrastructure separate: It’s usually the infrastructure that degrades - usage increases, frameworks become obsolete, zero-day vulnerabilities show up, etc.&lt;/li&gt;
&lt;li&gt;Building processes around maintenance. Apply the same updates to new bits and old bits. This prevents diff between new and old, and keeps the entire code “modern”.&lt;/li&gt;
&lt;li&gt;Ensure you keep pruning all your unwanted/old stuff.&lt;/li&gt;
&lt;/ol&gt;&lt;h2 id=&quot;deploying&quot;&gt;Deploying&lt;/h2&gt;
&lt;p&gt;Would I rather bundle features together or deploy them one by one?&lt;/p&gt;
&lt;p&gt;Depending on the current processes in place, if the answer is to bundle features together, there’s a problem.&lt;/p&gt;
&lt;p&gt;The question to ask then is why do you want to bundle features together?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Does the deployment take too much time?&lt;/li&gt;
&lt;li&gt;Do the code reviews not happen easily?&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Whatever is the reason, that’s the bottleneck to fix.&lt;/p&gt;
&lt;p&gt;I know atleast two issues with bundling.&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;You’re self blocking one feature if bugs in the other.&lt;/li&gt;
&lt;li&gt;You’re going anti-derisking, or increasing risk of things going wrong.&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;Then, whatever deployment process you choose, you always want your machines to be like cattle, not like pets. They aren’t precious. You know exactly what’s running on every machine, and how to recreate them in case of death. You’re not upset when one machine dies, you just spin up a new one. You herd them, not raise them.&lt;/p&gt;
&lt;h2 id=&quot;when-things-go-wrong&quot;&gt;When things go wrong&lt;/h2&gt;
&lt;p&gt;For when things go wrong, and they will, the golden rule is minimizing client impact.&lt;/p&gt;
&lt;p&gt;My natural tendency when things went wrong were to fix the problems. Turns out, it’s not the most optimal solution.&lt;/p&gt;
&lt;p&gt;Instead of fixing what went wrong, even if it’s a “one line change”, the first thing to do is rollback. Go back to the previous working state. This is the quickest way to get clients back on a working version.&lt;/p&gt;
&lt;p&gt;Only then should I look at what went wrong and fix those bugs.&lt;/p&gt;
&lt;p&gt;Same idea with a “borked” machine in your cluster - put it down, mark it unavailable, before trying to figure out what’s wrong with the machine.&lt;/p&gt;
&lt;p&gt;I found this weird, how my natural tendency and instincts diverge from the optimal solution.&lt;/p&gt;
&lt;p&gt;I think this instinct also leads me down the longer path to solving bugs. Sometimes, I figure it’s not working because there’s something wrong with what I wrote, and I’d get into the weeds going through every line of code I wrote. Something like depth-first search.&lt;/p&gt;
&lt;p&gt;When it turns out to be a config change, that is, I didn’t enable the feature in the first place, it pisses me off. I was so sub-optimal in the bug discovery process.&lt;/p&gt;
&lt;p&gt;Since then, my heuristic has been to do a breadth-first search before a depth-first search, to get rid of the top level nodes. What can I confirm using current resources?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Is the machine up?&lt;/li&gt;
&lt;li&gt;Is the right code installed?&lt;/li&gt;
&lt;li&gt;Is the config in place?&lt;/li&gt;
&lt;li&gt;&amp;lt; Code specific configuration &amp;gt;, like is the routing in the code correct?&lt;/li&gt;
&lt;li&gt;Is the schema version correct?&lt;/li&gt;
&lt;li&gt;Then, get into the code.&lt;/li&gt;
&lt;/ul&gt;&lt;blockquote&gt;
&lt;p&gt;We thought nginx didn’t install properly on the machine, but turns out, just the config was set to false.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of course, I don’t need to do this always. Sometimes, just the error message is enough to cut down the search space right to my code.&lt;/p&gt;
&lt;p&gt;When I can’t figure out the issue, I try and keep the changes-to-code-to-figure-out-what’s-wrong to a minimum. The less the number of changes, the faster I can hone in on the real issue. Keep the inferential jumps to a minimum.&lt;/p&gt;
&lt;p&gt;I also now keep a note of bugs that took me more than 1 hour to solve: What was I missing? It’s usually some dumb shit I forgot to check, like setting up routing, making sure the schema version and the service version match, etc. etc. This is another step of getting familiar with the tech stack I use, and one thing that only experience gives - intuition for figuring out exactly why things aren’t working.&lt;/p&gt;
&lt;h3 id=&quot;war-story&quot;&gt;War Story&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;It’s a dance between tweaking parameters, and playing with statistics vs fixing the underlying cause.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;How can this post ever be complete without a &lt;a href=&quot;https://www.merriam-webster.com/dictionary/war%20story&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;war story&lt;/a&gt;? I enjoy reading them, and I’ve got atleast one to share now.&lt;/p&gt;
&lt;p&gt;It’s the tale of search and SQLAlchemy. At BNEF, we have lots of analysts writing research reports. Whenever a report is published, we get a message. Whenever we get a message, we go into our database via SQLAlchemy, get all the stuff we need, transform it, and send it to our solr instance for indexing. Now, time for the weird AF bug.&lt;/p&gt;
&lt;p&gt;Every morning, connecting to the database would fail with the error “MYSQL server has gone away.” Sometimes, during the afternoon as well. The machines turn during the afternoon, so that’s the first thing I checked. Nope, errors never occurred when the machines were turning. We make thousands of requests throughout the day to the database, none of which fail. How come, then, this very low load trigger would fail?&lt;/p&gt;
&lt;p&gt;Oh, maybe we aren’t closing our sessions after the transaction? So if it’s the same session, and the next request comes after ages, we’ve missed the timeout, and the server has gone away. Quick look in the code, and sure enough, we are using a context manager for every read which calls &lt;code class=&quot;highlighter-rouge&quot;&gt;session.close()&lt;/code&gt; on &lt;code class=&quot;highlighter-rouge&quot;&gt;__exit__()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;After one day of going through everything that might go wrong, getting nowhere, I come in to work next morning and have a chance encounter. The error occurred this morning as well. And one second after the error, three other index requests were successful. This had all the symptoms of an improper session close. You know how this story ends.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Session.close()&lt;/code&gt; in the mysql dialect of SQLAlchemy doesn’t close the underlying DB connection, unless you’re using a &lt;code class=&quot;highlighter-rouge&quot;&gt;NullPool&lt;/code&gt;. Yep, that was the fix.&lt;/p&gt;
&lt;p&gt;It’s funny how this bug occurred simply because we didn’t publish research reports at night and during lunch time. And therein lies another lesson - most stack overflow answers (of course I googled it!) for this bug were to tweak either the session timeout time, or the parameter controlling amount of data you can send per SQL statement. Neither made sense to me, because they were pretty much unrelated to the root issue. I checked that our query size was within the limits, and we were closing the sessions(&lt;em&gt;lol&lt;/em&gt;) so timeout wouldn’t occur.&lt;/p&gt;
&lt;p&gt;We could have “fixed” this bug by increasing the session timeout value to 8 hours instead of 1 hour. It would’ve appeared to fix the problem, till the next time we have a holiday during the week - and the first research report next morning would fail.&lt;/p&gt;
&lt;p&gt;It’s a dance between tweaking parameters, and playing with statistics vs fixing the underlying cause.&lt;/p&gt;
&lt;h2 id=&quot;monitoring&quot;&gt;Monitoring&lt;/h2&gt;
&lt;p&gt;This is something I never thought about doing before. To be fair, before coding full time I was never maintaining systems. I just built them, used them for a week and moved on.&lt;/p&gt;
&lt;p&gt;Working with two systems, one with great monitoring, and the other not so much, I’ve come to appreciate monitoring a lot. I can’t fix bugs if I don’t know they exist. One of the worst feelings is to find out from clients about bugs. &lt;em&gt;“What am I doing?! I don’t even know things going wrong with a system I own?”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I think three components make up monitoring - logging, metrics, and alarms.&lt;/p&gt;
&lt;p&gt;Logging in code, just like &lt;a href=&quot;https://neilkakkar.com/the-human-log.html&quot;&gt;the human log&lt;/a&gt;, is an evolutionary process.&lt;/p&gt;
&lt;p&gt;You figure out things you might need to monitor, you log those, you run your system. Over time, you find a few bugs you don’t have enough information to solve. Those are good times to enhance logging - what’s your code missing?&lt;/p&gt;
&lt;p&gt;I think you intuitively figure out what things will be important to log. There was a lot of difference between the kind of things him (the senior SWE) and I were logging in our service. I figured just the request-response logs would suffice, while he had lots of metrics like query execution time, some specific internal calls made by the code, and also when to rotate logs, all sorted out.&lt;/p&gt;
&lt;p&gt;It’s virtually impossible to debug things without logs - if you don’t know the state the system was in, how do you even go about recreating it?&lt;/p&gt;
&lt;p&gt;Metrics can be derived from logs, or a separate standalone in the code. (Like sending events to AWS CloudWatch and Grafana). You decide your metrics and send the numbers in as the code runs.&lt;/p&gt;
&lt;p&gt;Alarms are the glue putting everything together in a great monitoring system. If one metric is the number of machines currently running in production, when this number falls to 50% is a great alarm to have - you know something went wrong.&lt;/p&gt;
&lt;p&gt;Failure count above a certain threshold? Yep, another alarm.&lt;/p&gt;
&lt;p&gt;I can sleep well at night, knowing if something goes wrong, I’ll be woken up. (Wait, what?)&lt;/p&gt;
&lt;p&gt;This hints at another habit to develop. When you fix bugs, you aren’t just focusing on how to fix the bug, but also, why didn’t you figure it out earlier? Was there alarming in place? How can you monitor better to prevent similar problems?&lt;/p&gt;
&lt;p&gt;I haven’t yet figured out how to monitor the UI. Testing the components are in place isn’t enough to know about things going wrong. This is usually where clients come in and tell us - things don’t look right.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Over the last year, I’ve learnt a lot. I’m glad I made the decision when I started working to write this post - I can appreciate much better how much I’ve grown when I have this document to look back to. And I hope there’s something you can takeaway from this, too!&lt;/p&gt;
&lt;p&gt;I’ve also been pretty lucky to get a great team - we code a lot, we laugh a lot, we get to design systems from scratch, and work with lots of other teams.&lt;/p&gt;
&lt;p&gt;This year, I’m sitting next to two senior devs. Let’s see how this goes! Thanks, team!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Good engineers themselves design systems that are more robust and easier to understand by others. This has a multiplier effect, letting their colleagues build upon their work much more quickly and reliably - &lt;a href=&quot;https://www.csc.gov.sg/articles/how-to-build-good-software&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;How to Build Good Software&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;img class=&quot;docimage&quot; src=&quot;https://neilkakkar.com/assets/images/neil_code.jpeg&quot; alt=&quot;&quot;/&gt;&lt;img class=&quot;docimage&quot; src=&quot;https://neilkakkar.com/assets/images/divider.png&quot; alt=&quot;&quot;/&gt;&lt;h2 id=&quot;things-im-not-sure-about&quot;&gt;Things I’m not sure about&lt;/h2&gt;
&lt;p&gt;I haven’t cracked the code of software engineering, yet. So, this section serves as a reminder for me: There’s so much left to learn! If I’m doing things right, this list should grow longer next year.&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;
&lt;p&gt;Think in terms of abstractions or implementations?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Should I have strong opinions about how to do things? Maybe as a result of being bitten before? Have I done the &lt;a href=&quot;https://fs.blog/2013/04/the-work-required-to-have-an-opinion/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;work required to have an opinion&lt;/a&gt;?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Developing processes for workflows. If you need to change how you do things because of an emergency or an event - then is the process broken? Is it something to fix?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Are utils (folder where you put random stuff you don’t know where to put otherwise) a code smell?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;How to deal with documentation for code and workflows?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;How to monitor UI to see when things don’t look alright?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Spending time designing the perfect API / code contract vs hacking it out and iterating over and over again, to figure out what works best. Which one is better?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The easy way vs the right way? I’m not convinced the right way is superior always.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Doing things yourself vs showing those who don’t know how to do them. The former gets done fast, the latter means you seldom have to do it again yourself.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When refactoring and preventing huge-ass PRs: “If I’d have changed all the tests first then I would have seen I had 52 files to change and that was obviously gonna be too big but I was messing with the code first and not the tests.” Is breaking it up worth it?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Explore De-risking further. What all strategies exist to de-risk projects?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Effective ways of gathering requirements?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;How to decrease rate of system degradation?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;&lt;img class=&quot;docimage&quot; src=&quot;https://neilkakkar.com/assets/images/divider.png&quot; alt=&quot;&quot;/&gt;&lt;p&gt;&lt;em&gt;Thanks to Hemanth Kumar Veeranki for reading drafts of this.&lt;/em&gt;&lt;/p&gt;

</description>
<pubDate>Sun, 25 Aug 2019 19:10:48 +0000</pubDate>
<dc:creator>neilkakkar</dc:creator>
<og:title>Things I Learnt from a Senior Software Engineer</og:title>
<og:description>I sat next to a senior software engineer for a year. Here’s what I learnt.</og:description>
<og:url>https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html</og:url>
<og:type>article</og:type>
<og:image>https://neilkakkar.com/assets/images/github.png</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://neilkakkar.com/things-I-learnt-from-a-senior-dev.html</dc:identifier>
</item>
<item>
<title>Banned C standard library functions in Git source code</title>
<link>https://github.com/git/git/blob/master/banned.h</link>
<guid isPermaLink="true" >https://github.com/git/git/blob/master/banned.h</guid>
<description>&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://github.githubassets.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars0.githubusercontent.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars1.githubusercontent.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars2.githubusercontent.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars3.githubusercontent.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://github-cloud.s3.amazonaws.com&quot;/&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://user-images.githubusercontent.com/&quot;/&gt;&lt;link crossorigin=&quot;anonymous&quot; media=&quot;all&quot; integrity=&quot;sha512-UDS3MR1FfvqHmqZAs2MWSDCWPwLemVRLqCwld4/zfwH0vhv7I6RYmDnMnNAVQKP1YYvqnccOCH4iOhFaUUyrjw==&quot; rel=&quot;stylesheet&quot; href=&quot;https://github.githubassets.com/assets/frameworks-2e9090135c22aad5f56c2f72dcba7880.css&quot; type=&quot;text/css&quot;/&gt;&lt;link crossorigin=&quot;anonymous&quot; media=&quot;all&quot; integrity=&quot;sha512-l4JpykYR1c86XfE0TExTqRFbnoD7WA39FhTTEgPt22zLFiepYq+L+3XUGBZoGsnBv15oKHTomwpEAUrCbmoRqw==&quot; rel=&quot;stylesheet&quot; href=&quot;https://github.githubassets.com/assets/site-2f0f446a127a5a480dfb139991acd1cd.css&quot; type=&quot;text/css&quot;/&gt;&lt;link crossorigin=&quot;anonymous&quot; media=&quot;all&quot; integrity=&quot;sha512-ip0PbDWWMX/xpzE2prEhR95RqVx8aDPUKvBEz691/7Isc3uapauorbb1zFXT2I5Go5BTzaev9qh/wKMj9pH95A==&quot; rel=&quot;stylesheet&quot; href=&quot;https://github.githubassets.com/assets/github-cbb49d8cd46cbc8c522a95d52b21ab53.css&quot; type=&quot;text/css&quot;/&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;/&gt;&lt;title&gt;git/banned.h at master · git/git · GitHub&lt;/title&gt;&lt;meta name=&quot;description&quot; content=&quot;Git Source Code Mirror - This is a publish-only repository and all pull requests are ignored. Please follow Documentation/SubmittingPatches procedure for any of your improvements. - git/git&quot;/&gt;&lt;link rel=&quot;search&quot; type=&quot;application/opensearchdescription+xml&quot; href=&quot;/opensearch.xml&quot; title=&quot;GitHub&quot;/&gt;&lt;link rel=&quot;fluid-icon&quot; href=&quot;https://github.com/fluidicon.png&quot; title=&quot;GitHub&quot;/&gt;&lt;meta property=&quot;fb:app_id&quot; content=&quot;1401488693436528&quot;/&gt;&lt;meta name=&quot;twitter:image:src&quot; content=&quot;https://avatars1.githubusercontent.com/u/18133?s=400&amp;amp;v=4&quot;/&gt;&lt;meta name=&quot;twitter:site&quot; content=&quot;@github&quot;/&gt;&lt;meta name=&quot;twitter:card&quot; content=&quot;summary&quot;/&gt;&lt;meta name=&quot;twitter:title&quot; content=&quot;git/git&quot;/&gt;&lt;meta name=&quot;twitter:description&quot; content=&quot;Git Source Code Mirror - This is a publish-only repository and all pull requests are ignored. Please follow Documentation/SubmittingPatches procedure for any of your improvements. - git/git&quot;/&gt;&lt;meta property=&quot;og:image&quot; content=&quot;https://avatars1.githubusercontent.com/u/18133?s=400&amp;amp;v=4&quot;/&gt;&lt;meta property=&quot;og:site_name&quot; content=&quot;GitHub&quot;/&gt;&lt;meta property=&quot;og:type&quot; content=&quot;object&quot;/&gt;&lt;meta property=&quot;og:title&quot; content=&quot;git/git&quot;/&gt;&lt;meta property=&quot;og:url&quot; content=&quot;https://github.com/git/git&quot;/&gt;&lt;meta property=&quot;og:description&quot; content=&quot;Git Source Code Mirror - This is a publish-only repository and all pull requests are ignored. Please follow Documentation/SubmittingPatches procedure for any of your improvements. - git/git&quot;/&gt;&lt;link rel=&quot;assets&quot; href=&quot;https://github.githubassets.com/&quot;/&gt;&lt;meta name=&quot;pjax-timeout&quot; content=&quot;1000&quot;/&gt;&lt;meta name=&quot;request-id&quot; content=&quot;D543:44CD:326525:4D408C:5D632F66&quot; data-pjax-transient=&quot;&quot;/&gt;&lt;meta name=&quot;selected-link&quot; value=&quot;repo_source&quot; data-pjax-transient=&quot;&quot;/&gt;&lt;meta name=&quot;google-site-verification&quot; content=&quot;KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU&quot;/&gt;&lt;meta name=&quot;google-site-verification&quot; content=&quot;ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA&quot;/&gt;&lt;meta name=&quot;google-site-verification&quot; content=&quot;GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc&quot;/&gt;&lt;meta name=&quot;octolytics-host&quot; content=&quot;collector.githubapp.com&quot;/&gt;&lt;meta name=&quot;octolytics-app-id&quot; content=&quot;github&quot;/&gt;&lt;meta name=&quot;octolytics-event-url&quot; content=&quot;https://collector.githubapp.com/github-external/browser_event&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-request_id&quot; content=&quot;D543:44CD:326525:4D408C:5D632F66&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-region_edge&quot; content=&quot;iad&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-region_render&quot; content=&quot;iad&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-ga_id&quot; content=&quot;&quot; class=&quot;js-octo-ga-id&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-visitor_id&quot; content=&quot;4705658336767586150&quot;/&gt;&lt;meta name=&quot;analytics-location&quot; content=&quot;/&amp;lt;user-name&amp;gt;/&amp;lt;repo-name&amp;gt;/blob/show&quot; data-pjax-transient=&quot;true&quot;/&gt;&lt;meta name=&quot;google-analytics&quot; content=&quot;UA-3769691-2&quot;/&gt;&lt;meta class=&quot;js-ga-set&quot; name=&quot;dimension1&quot; content=&quot;Logged Out&quot;/&gt;&lt;meta name=&quot;hostname&quot; content=&quot;github.com&quot;/&gt;&lt;meta name=&quot;user-login&quot; content=&quot;&quot;/&gt;&lt;meta name=&quot;expected-hostname&quot; content=&quot;github.com&quot;/&gt;&lt;meta name=&quot;js-proxy-site-detection-payload&quot; content=&quot;ZWM0MTNhZmIxYjgyYjY1N2UzNmRjNjE4MGZlNmU4NzMxNWZmOTI1MGM4MzJjYjI2OTkzZGFiMjU0ZTYyNmE4Y3x7InJlbW90ZV9hZGRyZXNzIjoiNjguMjMwLjY2LjE2OSIsInJlcXVlc3RfaWQiOiJENTQzOjQ0Q0Q6MzI2NTI1OjRENDA4Qzo1RDYzMkY2NiIsInRpbWVzdGFtcCI6MTU2Njc4MTI4NiwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==&quot;/&gt;&lt;meta name=&quot;enabled-features&quot; content=&quot;ACTIONS_V2_ON_MARKETPLACE,MARKETPLACE_FEATURED_BLOG_POSTS,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,MARKETPLACE_PENDING_INSTALLATIONS&quot;/&gt;&lt;meta name=&quot;html-safe-nonce&quot; content=&quot;83bf09e6c338781a958441a2f1a9f3d64f2c98a1&quot;/&gt;&lt;meta http-equiv=&quot;x-pjax-version&quot; content=&quot;825ef9f886442eff2256ac335b9f2408&quot;/&gt;&lt;link href=&quot;https://github.com/git/git/commits/master.atom&quot; rel=&quot;alternate&quot; title=&quot;Recent Commits to git:master&quot; type=&quot;application/atom+xml&quot;/&gt;&lt;meta name=&quot;go-import&quot; content=&quot;github.com/git/git git https://github.com/git/git.git&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-user_id&quot; content=&quot;18133&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-user_login&quot; content=&quot;git&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_id&quot; content=&quot;36502&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_nwo&quot; content=&quot;git/git&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_public&quot; content=&quot;true&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_is_fork&quot; content=&quot;false&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_network_root_id&quot; content=&quot;36502&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_network_root_nwo&quot; content=&quot;git/git&quot;/&gt;&lt;meta name=&quot;octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown&quot; content=&quot;false&quot;/&gt;&lt;link rel=&quot;canonical&quot; href=&quot;https://github.com/git/git/blob/master/banned.h&quot; data-pjax-transient=&quot;&quot;/&gt;&lt;meta name=&quot;browser-stats-url&quot; content=&quot;https://api.github.com/_private/browser/stats&quot;/&gt;&lt;meta name=&quot;browser-errors-url&quot; content=&quot;https://api.github.com/_private/browser/errors&quot;/&gt;&lt;link rel=&quot;mask-icon&quot; href=&quot;https://github.githubassets.com/pinned-octocat.svg&quot; color=&quot;#000000&quot;/&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; class=&quot;js-site-favicon&quot; href=&quot;https://github.githubassets.com/favicon.ico&quot;/&gt;&lt;meta name=&quot;theme-color&quot; content=&quot;#1e2327&quot;/&gt;&lt;link rel=&quot;manifest&quot; href=&quot;/manifest.json&quot; crossorigin=&quot;use-credentials&quot;/&gt;&lt;meta itemprop=&quot;position&quot; content=&quot;1&quot;/&gt;&lt;meta itemprop=&quot;position&quot; content=&quot;3&quot;/&gt;&lt;meta itemprop=&quot;position&quot; content=&quot;1&quot;/&gt;&lt;meta itemprop=&quot;position&quot; content=&quot;3&quot;/&gt;&lt;meta itemprop=&quot;position&quot; content=&quot;6&quot;/&gt;&lt;/head&gt;&lt;body class=&quot;logged-out env-production page-responsive page-blob&quot; id=&quot;readabilityBody&quot; readability=&quot;47.530642750374&quot;&gt;



&lt;div class=&quot;application-main&quot; data-commit-hovercards-enabled=&quot;&quot;&gt;
&lt;div itemscope=&quot;&quot; itemtype=&quot;http://schema.org/SoftwareSourceCode&quot; class=&quot;&quot;&gt;

&lt;div class=&quot;container-lg clearfix new-discussion-timeline experiment-repo-nav p-responsive&quot;&gt;
&lt;div class=&quot;repository-content&quot;&gt;&lt;a class=&quot;d-none js-permalink-shortcut&quot; data-hotkey=&quot;y&quot; href=&quot;https://github.com/git/git/blob/745f6812895b31c02b29bdfe4ae8e5498f776c26/banned.h&quot;&gt;Permalink&lt;/a&gt; 
&lt;div class=&quot;signup-prompt-bg rounded-1&quot;&gt;
&lt;div class=&quot;signup-prompt p-4 text-center mb-4 rounded-1&quot; readability=&quot;31.129518072289&quot;&gt;
&lt;div class=&quot;position-relative&quot; readability=&quot;9.578313253012&quot;&gt;

&lt;h3 class=&quot;pt-2&quot;&gt;Join GitHub today&lt;/h3&gt;
&lt;p class=&quot;col-6 mx-auto&quot;&gt;GitHub is home to over 40 million developers working together to host and review code, manage projects, and build software together.&lt;/p&gt;
&lt;a class=&quot;btn btn-primary&quot; data-hydro-click=&quot;{&amp;quot;event_type&amp;quot;:&amp;quot;authentication.click&amp;quot;,&amp;quot;payload&amp;quot;:{&amp;quot;location_in_page&amp;quot;:&amp;quot;files signup prompt&amp;quot;,&amp;quot;repository_id&amp;quot;:null,&amp;quot;auth_type&amp;quot;:&amp;quot;SIGN_UP&amp;quot;,&amp;quot;client_id&amp;quot;:null,&amp;quot;originating_request_id&amp;quot;:&amp;quot;D543:44CD:326525:4D408C:5D632F66&amp;quot;,&amp;quot;originating_url&amp;quot;:&amp;quot;https://github.com/git/git/blob/master/banned.h&amp;quot;,&amp;quot;referrer&amp;quot;:&amp;quot;http://www.google.co.uk/url?sa=t&amp;amp;source=web&amp;amp;cd=1&amp;quot;,&amp;quot;user_id&amp;quot;:null}}&quot; data-hydro-click-hmac=&quot;49e1ebb0f140d3882106f5c52a396348014feea422c2b432b6ca760956bcf53f&quot; data-ga-click=&quot;(Logged out) Sign up prompt, clicked Sign up, text:sign-up&quot; href=&quot;https://github.com/join?source=prompt-blob-show&quot;&gt;Sign up&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;Box Box--condensed d-flex flex-column flex-shrink-0&quot;&gt;

&lt;div class=&quot;Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap&quot;&gt;
&lt;details class=&quot;details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2&quot; id=&quot;blob_contributors_box&quot;&gt;&lt;span&gt;&lt;strong&gt;2&lt;/strong&gt; contributors&lt;/span&gt;

&lt;/details&gt;&lt;span class=&quot;&quot;&gt;&lt;a class=&quot;avatar-link&quot; data-hovercard-type=&quot;user&quot; data-hovercard-url=&quot;/hovercards?user_id=45925&quot; data-octo-click=&quot;hovercard-link-click&quot; data-octo-dimensions=&quot;link_type:self&quot; href=&quot;https://github.com/git/git/commits/master/banned.h?author=peff&quot;&gt;&lt;img class=&quot;avatar mr-1&quot; src=&quot;https://avatars1.githubusercontent.com/u/45925?s=40&amp;amp;v=4&quot; width=&quot;20&quot; height=&quot;20&quot; alt=&quot;@peff&quot;/&gt;&lt;/a&gt; &lt;a class=&quot;avatar-link&quot; data-hovercard-type=&quot;user&quot; data-hovercard-url=&quot;/hovercards?user_id=54042444&quot; data-octo-click=&quot;hovercard-link-click&quot; data-octo-dimensions=&quot;link_type:self&quot; href=&quot;https://github.com/git/git/commits/master/banned.h?author=devmchakan&quot;&gt;&lt;img class=&quot;avatar mr-1&quot; src=&quot;https://avatars1.githubusercontent.com/u/54042444?s=40&amp;amp;v=4&quot; width=&quot;20&quot; height=&quot;20&quot; alt=&quot;@devmchakan&quot;/&gt;&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;Box mt-3 position-relative&quot; readability=&quot;5.8916967509025&quot;&gt;
&lt;div class=&quot;Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center&quot; readability=&quot;4.7173913043478&quot;&gt;
&lt;p&gt;33 lines (27 sloc) 795 Bytes&lt;/p&gt;

&lt;/div&gt;
&lt;div itemprop=&quot;text&quot; class=&quot;Box-body p-0 blob-wrapper data type-c&quot;&gt;
&lt;table class=&quot;highlight tab-size js-file-line-container&quot; data-tab-size=&quot;8&quot; readability=&quot;19&quot;&gt;&lt;tr&gt;&lt;td id=&quot;L1&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;1&quot;/&gt;
&lt;td id=&quot;LC1&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;ifndef&lt;/span&gt; BANNED_H&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L2&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;2&quot;/&gt;
&lt;td id=&quot;LC2&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;BANNED_H&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L3&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;3&quot;/&gt;
&lt;td id=&quot;LC3&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;/&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L4&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;4&quot;/&gt;
&lt;td id=&quot;LC4&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;/*&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td id=&quot;L5&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;5&quot;/&gt;
&lt;td id=&quot;LC5&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;* This header lists functions that have been banned from our code base,&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td id=&quot;L6&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;6&quot;/&gt;
&lt;td id=&quot;LC6&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;* because they're too easy to misuse (and even if used correctly,&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td id=&quot;L7&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;7&quot;/&gt;
&lt;td id=&quot;LC7&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;* complicate audits). Including this header turns them into compile-time&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L8&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;8&quot;/&gt;
&lt;td id=&quot;LC8&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;* errors.&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L9&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;9&quot;/&gt;
&lt;td id=&quot;LC9&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L10&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;10&quot;/&gt;
&lt;td id=&quot;LC10&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;/&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td id=&quot;L11&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;11&quot;/&gt;
&lt;td id=&quot;LC11&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;BANNED&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;func&lt;/span&gt;) sorry_##func##_is_a_banned_function&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L12&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;12&quot;/&gt;
&lt;td id=&quot;LC12&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;/&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L13&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;13&quot;/&gt;
&lt;td id=&quot;LC13&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; strcpy&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td id=&quot;L14&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;14&quot;/&gt;
&lt;td id=&quot;LC14&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;strcpy&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;x,y&lt;/span&gt;) BANNED(strcpy)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L15&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;15&quot;/&gt;
&lt;td id=&quot;LC15&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; strcat&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td id=&quot;L16&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;16&quot;/&gt;
&lt;td id=&quot;LC16&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;strcat&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;x,y&lt;/span&gt;) BANNED(strcat)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L17&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;17&quot;/&gt;
&lt;td id=&quot;LC17&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; strncpy&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td id=&quot;L18&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;18&quot;/&gt;
&lt;td id=&quot;LC18&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;strncpy&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;x,y,n&lt;/span&gt;) BANNED(strncpy)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L19&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;19&quot;/&gt;
&lt;td id=&quot;LC19&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; strncat&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td id=&quot;L20&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;20&quot;/&gt;
&lt;td id=&quot;LC20&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;strncat&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;x,y,n&lt;/span&gt;) BANNED(strncat)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L21&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;21&quot;/&gt;
&lt;td id=&quot;LC21&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;/&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L22&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;22&quot;/&gt;
&lt;td id=&quot;LC22&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; sprintf&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L23&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;23&quot;/&gt;
&lt;td id=&quot;LC23&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;undef&lt;/span&gt; vsprintf&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td id=&quot;L24&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;24&quot;/&gt;
&lt;td id=&quot;LC24&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;ifdef&lt;/span&gt; HAVE_VARIADIC_MACROS&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td id=&quot;L25&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;25&quot;/&gt;
&lt;td id=&quot;LC25&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;sprintf&lt;/span&gt;(...) BANNED(sprintf)&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td id=&quot;L26&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;26&quot;/&gt;
&lt;td id=&quot;LC26&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;vsprintf&lt;/span&gt;(...) BANNED(vsprintf)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L27&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;27&quot;/&gt;
&lt;td id=&quot;LC27&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;else&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td id=&quot;L28&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;28&quot;/&gt;
&lt;td id=&quot;LC28&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;sprintf&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;buf,fmt,arg&lt;/span&gt;) BANNED(sprintf)&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td id=&quot;L29&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;29&quot;/&gt;
&lt;td id=&quot;LC29&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;pl-en&quot;&gt;vsprintf&lt;/span&gt;(&lt;span class=&quot;pl-v&quot;&gt;buf,fmt,arg&lt;/span&gt;) BANNED(sprintf)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L30&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;30&quot;/&gt;
&lt;td id=&quot;LC30&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;endif&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L31&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;31&quot;/&gt;
&lt;td id=&quot;LC31&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;/&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td id=&quot;L32&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;32&quot;/&gt;
&lt;td id=&quot;LC32&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;&gt;#&lt;span class=&quot;pl-k&quot;&gt;endif&lt;/span&gt; &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;/*&lt;/span&gt; BANNED_H &lt;span class=&quot;pl-c&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;details class=&quot;details-reset details-overlay BlobToolbar position-absolute js-file-line-actions dropdown d-none&quot; aria-hidden=&quot;true&quot;/&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;details class=&quot;details-reset details-overlay details-overlay-dark&quot;&gt;
&lt;/details&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;You can’t perform that action at this time.&lt;/p&gt;
&lt;div class=&quot;js-stale-session-flash stale-session-flash flash flash-warn flash-banner&quot; hidden=&quot;&quot;&gt;&lt;span class=&quot;signed-in-tab-flash&quot;&gt;You signed in with another tab or window. &lt;a href=&quot;https://github.com/git/git/blob/master/banned.h&quot;&gt;Reload&lt;/a&gt; to refresh your session.&lt;/span&gt; &lt;span class=&quot;signed-out-tab-flash&quot;&gt;You signed out in another tab or window. &lt;a href=&quot;https://github.com/git/git/blob/master/banned.h&quot;&gt;Reload&lt;/a&gt; to refresh your session.&lt;/span&gt;&lt;/div&gt;
&lt;details class=&quot;details-reset details-overlay details-overlay-dark lh-default text-gray-dark hx_rsm&quot; open=&quot;&quot;&gt;
&lt;/details&gt;

&lt;/body&gt;</description>
<pubDate>Sun, 25 Aug 2019 13:48:11 +0000</pubDate>
<dc:creator>susam</dc:creator>
<og:image>https://avatars1.githubusercontent.com/u/18133?s=400&amp;v=4</og:image>
<og:type>object</og:type>
<og:title>git/git</og:title>
<og:url>https://github.com/git/git</og:url>
<og:description>Git Source Code Mirror - This is a publish-only repository and all pull requests are ignored. Please follow Documentation/SubmittingPatches procedure for any of your improvements. - git/git</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://github.com/git/git/blob/master/banned.h</dc:identifier>
</item>
<item>
<title>From Mac to Linux – the setup I&amp;#039;ve grown to love</title>
<link>https://shooting-unicorns.com/battlestation/from-mac-to-linux-the-setup-ive-grown-to-love</link>
<guid isPermaLink="true" >https://shooting-unicorns.com/battlestation/from-mac-to-linux-the-setup-ive-grown-to-love</guid>
<description>&lt;div class=&quot;sc-bdVaJa dOFoQE&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/dell.jpg&quot; alt=&quot;dell workspace&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa dOFoQE&quot;&gt;These days it seems like almost every second person wants to run their own startup and it's no different for &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://shooting-unicorns.com&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Shooting Unicorns&lt;/a&gt;. We're developers with a job during the day and hustle on our own products during the night. Every single hour is pretty much spent at our battle stations, making it really important to have an optimised workspace for maximum productivity.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;For those who are looking for a change in scenery or checking out what's around, I'll be sharing my tools and all the files associated with it.&lt;/p&gt;
&lt;h2 class=&quot;heading styled__Heading-cya4kb-0 jmgqZq sc-kgoBCf PnIgQ sc-bdVaJa dOFoQE&quot;&gt;From Mac to Linux&lt;/h2&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;I was a full time Mac user for over 4 years and I must say that the experience is a very positive one. Not only is it aesthetically pleasing, but they also have superior user interactions which feels both intuitive and natural. However the lack of customisations available (changing the overall look and feel, remapping my keys, how I would like to mold my setup/workflow) and degrading performance over time prompted me to switch. It was a choice I never regretted.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Having heard good things about Linux and being a long time lurker of Reddit's &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://www.reddit.com/r/unixporn/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;r/unixporn&lt;/a&gt;, it didn't take much convincing for me to make the switch. I must admit I had a hard time finding the right distro because there are so many options out there. In the end, I decided I would give &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://manjaro.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Manjaro&lt;/a&gt; a shot with three different desktop managers - Cinnamon, KDE and i3.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Cinnamon was easy to set up and use, but lacked the level of customisation I wanted. KDE Plasma was absolutely beautiful with tonnes of customisations available, but it still lacked something. My workspaces would get chaotic and windows would be everywhere. After having tried i3, I knew I had found the one. The shortcuts was superb and it didn't take long to get used to the keyboard focused windows manager. The next thing was manually setting up the UI, the custom keyboard shortcuts, workflow and other nitty gritty things.&lt;/p&gt;
&lt;h2 class=&quot;heading styled__Heading-cya4kb-0 jmgqZq sc-kgoBCf PnIgQ sc-bdVaJa dOFoQE&quot;&gt;Look and Feel&lt;/h2&gt;
&lt;div class=&quot;sc-bdVaJa dOFoQE&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/desktop.jpg&quot; alt=&quot;dell workspace&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Get the look &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://www.gnome-look.org/p/1218368/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Ant-Dracula-Blue&lt;/a&gt;&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;&lt;span class=&quot;styled__Text-sc-9qokh7-0 ljhQfg sc-bdVaJa eEDmfo&quot;&gt;Having never tried or seen a tiling window manager in action before, I was mind blown by how something so simple could affect the way I work. i3 provides a choice to not tile and just flow all windows, but that defeats the purpose of a tiling manager. From the image above, all the windows are automatically tiled to a corner/side of a screen (depending if it was set to horizontal or vertical tiling).&lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;sc-bdVaJa dOFoQE&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/firefox.jpg&quot; alt=&quot;firefox theme&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Get the theme &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/EliverLara/firefox-sweet-theme&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Firefox Sweet&lt;/a&gt;&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;A year ago due to performance issues with Chrome, I switched over to Firefox. Firefox also has this very handy tool where you can screenshot just your web browser content in the dev tools. The extensions I really recommend getting are &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://addons.mozilla.org/en-US/firefox/addon/vimium-ff/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Vimium-FF&lt;/a&gt;, for vim keybindings in your browser (never leave your keyboard again!) and &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://chrome.google.com/webstore/detail/tabagotchi-by-breather/ojahbhfflnbaiddhnkgeccgopmedjjen&quot;&gt;Tabagotchi&lt;/a&gt;, where your browser pet will die when there are too many tabs opened.&lt;/p&gt;
&lt;div class=&quot;sc-bdVaJa dOFoQE&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/spotify.jpg&quot; alt=&quot;spotify theme&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Get the look &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/khanhas/spicetify-cli&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Spicetify&lt;/a&gt;&lt;/p&gt;
&lt;h2 class=&quot;heading styled__Heading-cya4kb-0 jmgqZq sc-kgoBCf PnIgQ sc-bdVaJa dOFoQE&quot;&gt;Development Workflow&lt;/h2&gt;
&lt;div class=&quot;sc-bdVaJa dOFoQE&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/terminal.jpg&quot; alt=&quot;spotify theme&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Get the look &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/shooting-unicorns/dotfiles&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;dotfiles&lt;/a&gt;&lt;/p&gt;
&lt;h4 class=&quot;heading styled__Heading-cya4kb-0 jmgqZq sc-kgoBCf PnIgQ sc-bdVaJa dOFoQE&quot;&gt;Terminal Application&lt;/h4&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;I spend almost 80% of the time in my terminal when coding (and the rest on StackOverflow 😅). The terminal application I highly recommend is Kitty, it is blazing fast and easy to set up. I have tried several other different terminals such as &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/jwilm/alacritty&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Alacritty&lt;/a&gt; and &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://www.iterm2.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;iTerm2&lt;/a&gt; on the Macbook, but the performance does not compare to Kitty.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Together with Kitty Terminal, I use Oh My Zsh and Tmux. &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/tmux/tmux/wiki&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Tmux&lt;/a&gt; is essentially a terminal multiplexer allowing you to attach and detach sessions to run in the background. I personally use it as a terminal windows manager to easily navigate between different repositories and different panes with keyboard shortcuts.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;At the start of the day, boot up my laptop and create Tmux sessions for the different repositories that I would be working on. For example, I will have a session for the backend and one session for the front-end. Switching between the different code bases is as simple as using the keyboard shortcut&lt;br/&gt;&lt;code class=&quot;styled__Code-sc-1otm95n-0 hDtOf sc-gqjmRU eOSDpb sc-bdVaJa eEDmfo&quot;&gt;ctrl + a + s&lt;/code&gt;.&lt;/p&gt;
&lt;h4 class=&quot;heading styled__Heading-cya4kb-0 jmgqZq sc-kgoBCf PnIgQ sc-bdVaJa dOFoQE&quot;&gt;Code Editors&lt;/h4&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;&lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://neovim.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Neovim&lt;/a&gt; is my editor of choice unless I am doing React development to which I would then use Visual Studio code. Neovim is pretty bare from a fresh install and does require some plugins for daily use.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;My go to plugins include:&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa dOFoQE&quot;&gt;And here is my Visual studio code&lt;/p&gt;
&lt;div class=&quot;sc-fjdhpX egwpJX sc-bdVaJa eEDmfo&quot;&gt;&lt;img class=&quot;styled__Image-sc-19nzt74-0 bWkFLl sc-kGXeez kZpzLg sc-bdVaJa eEDmfo&quot; src=&quot;https://shooting-unicorns.com/blog/vscode.jpg&quot;/&gt;&lt;/div&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Get the look &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/material-theme/vsc-material-theme&quot; target=&quot;_blank&quot;&gt;Material Theme&lt;/a&gt;&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;I tend not to use VSCode as much (I spend the majoriy of the time in backend development and Vim is perfect for that), but I would use it when I have some front end work to do.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;Here are the plugins I use to make my life in front end easier:&lt;/p&gt;
&lt;ul class=&quot;styled__List-wo6si3-1 YTjyO sc-kEYyzF jAdoft sc-bdVaJa hTXYNk&quot;&gt;&lt;li class=&quot;styled__ListItem-wo6si3-0 breePq sc-bdVaJa eEDmfo&quot;&gt;&lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/Microsoft/vscode-eslint&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;ESLint&lt;/a&gt;: Live linting and autofix errors&lt;/li&gt;
&lt;li class=&quot;styled__ListItem-wo6si3-0 breePq sc-bdVaJa eEDmfo&quot;&gt;&lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/VSCodeVim/Vim&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Vim&lt;/a&gt;: Vim key bindings in VSCode&lt;/li&gt;
&lt;li class=&quot;styled__ListItem-wo6si3-0 breePq sc-bdVaJa eEDmfo&quot;&gt;&lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/prettier/prettier-vscode&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;Prettier&lt;/a&gt;: Code formatter&lt;/li&gt;
&lt;/ul&gt;&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;TLDR; Check out my dotfiles &lt;a class=&quot;styled__Link-q8ut33-0 jAOAco sc-hMqMXs ezcwQD sc-bdVaJa eWyRHv&quot; href=&quot;https://github.com/shooting-unicorns/dotfiles&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p class=&quot;styled__Paragraph-sc-1qnv201-0 eKEtIP sc-jWBwVP dbUPeK sc-bdVaJa eEDmfo&quot;&gt;[Update]: Clarified that I spend 80% of my time in the terminal. I do agree that is personal preference.&lt;/p&gt;
</description>
<pubDate>Sun, 25 Aug 2019 08:18:43 +0000</pubDate>
<dc:creator>derp_unicorns</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://shooting-unicorns.com/battlestation/from-mac-to-linux-the-setup-ive-grown-to-love/</dc:identifier>
</item>
<item>
<title>Write your own Excel in F# (2018)</title>
<link>http://tomasp.net/blog/2018/write-your-own-excel/</link>
<guid isPermaLink="true" >http://tomasp.net/blog/2018/write-your-own-excel/</guid>
<description>&lt;p&gt;I've been teaching F# for over seven years now, both in the public F# FastTrack course that we run at SkillsMatter in London and in various custom trainings for private companies. Every time I teach the F# FastTrack course, I modify the material in one way or another. I wrote about some of this interesting history &lt;a href=&quot;http://tomasp.net/blog/2018/write-your-own-excel/#&quot;&gt;last year in an fsharpWorks article&lt;/a&gt;. The course now has a stable half-day introduction to the language and a stable focus on the ideas behind functional-first programming, but there are always new examples and applications that illustrate this style of programming.&lt;/p&gt;
&lt;img src=&quot;http://tomasp.net/blog/2018/write-your-own-excel/logo.png&quot; class=&quot;rdecor&quot;/&gt;&lt;p&gt;When we started, we mostly focused on teaching functional programming concepts that might be useful even if you use C# and on building analytical components that your could integrate into a larger .NET solution. Since then, the F# community has matured, established the &lt;a href=&quot;http://fsharp.org&quot;&gt;F# Software Foundation&lt;/a&gt;, but also built a number of mature end-to-end ecosystems that you can rely on such as &lt;a href=&quot;http://fable.io&quot;&gt;Fable&lt;/a&gt;, the F# to JavaScript compiler, and &lt;a href=&quot;https://safe-stack.github.io&quot;&gt;SAFE Stack&lt;/a&gt; for full-stack web development.&lt;/p&gt;
&lt;p&gt;For the upcoming December course in London, I added a number of demos and hands-on tasks built using Fable, partly because running F# in a browser is an easy way to illustrate many concepts and partly because Fable has some amazing functional-first libraries.&lt;/p&gt;
&lt;blockquote readability=&quot;6.760147601476&quot;&gt;
&lt;p&gt;If you are interested in learning F# and attending our course, the next &lt;a href=&quot;https://skillsmatter.com/courses/473-tomas-petricek-phil-trelford-fast-track-to-fsharp&quot;&gt;F# FastTrack&lt;/a&gt; takes place on &lt;strong&gt;6-7 December&lt;/strong&gt; in London at SkillsMatter. We also offer custom on-site trainings. Get in touch at &lt;a href=&quot;http://twitter.com/tomaspetricek&quot;&gt;@tomaspetricek&lt;/a&gt; or email &lt;a href=&quot;mailto:tomas@tomasp.net&quot;&gt;tomas@tomasp.net&lt;/a&gt; for a 10% discount for the course.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;One of the new samples I want to show, which I also &lt;a href=&quot;https://vimeo.com/281241807&quot;&gt;live coded at NDC 2018&lt;/a&gt;, is building a simple web-based Excel-like spreadsheet application. The spreadsheet demonstrates all the great F# features such as domain modeling with types, the power of compositionality and also how functional-first approach can be amazingly powerful for building user interfaces.&lt;/p&gt;

&lt;p&gt;The sample compiles to JavaScript, so the best way of explaining what we want to build is to give you a live demo you can play with! Since this is a blog post about functional programming, I already implemented both Fibonacci numbers (column B) and factorial (column D) in the spreadsheet for you!&lt;/p&gt;

&lt;p&gt;You can click on any cell to edit the cells. To confirm your edit, just click on any other cell. You can enter numbers such as &lt;code&gt;1&lt;/code&gt; (in cell B1) or formulas such as &lt;code&gt;=B1+B2&lt;/code&gt; in cell B3. Formulas support parentheses and four standard numerical operators. When you make an edit, the spreadsheet automatically updates. If you make a syntax error, reference empty cell or create a recursive reference, the spreadsheet will show &lt;code&gt;#ERR&lt;/code&gt;.&lt;/p&gt;
&lt;blockquote readability=&quot;9.1477663230241&quot;&gt;
&lt;p&gt;Full source code is available in my &lt;a href=&quot;https://github.com/tpetricek/elmish-spreadsheet/&quot;&gt;elmish-spreadsheet repository on GitHub&lt;/a&gt; (as a hands-on exercise in &lt;code&gt;master&lt;/code&gt; branch and fully working in the &lt;code&gt;completed&lt;/code&gt; branch), but you can also play with it in the &lt;a href=&quot;https://fable.io/repl/&quot;&gt;Fable REPL&lt;/a&gt; (see Samples, Elmish, Spreadsheet), which lets you edit and run F# in the browser.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Defining the domain model&lt;/h2&gt;
&lt;p&gt;Following the typical F# type-driven development style, the first thing we need to think about is the domain model. Our types should capture what we work with in a spreadsheet application. In our case, we have positions such as &lt;code&gt;A5&lt;/code&gt; or &lt;code&gt;C10&lt;/code&gt;, expressions such as &lt;code&gt;=A1+3&lt;/code&gt; and the sheet itself which has user input in some of the cells. To model these, we define types for &lt;code&gt;Position&lt;/code&gt;, &lt;code&gt;Expr&lt;/code&gt; and &lt;code&gt;Sheet&lt;/code&gt;:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;2&quot;&gt;&lt;tr readability=&quot;6&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;8: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs1', 1)&quot; onmouseover=&quot;showTip(event, 'fs1', 1)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs2', 2)&quot; onmouseover=&quot;showTip(event, 'fs2', 2)&quot; class=&quot;t&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs3', 3)&quot; onmouseover=&quot;showTip(event, 'fs3', 3)&quot; class=&quot;t&quot;&gt;int&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs4', 4)&quot; onmouseover=&quot;showTip(event, 'fs4', 4)&quot; class=&quot;t&quot;&gt;Expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  | &lt;span onmouseout=&quot;hideTip(event, 'fs5', 5)&quot; onmouseover=&quot;showTip(event, 'fs5', 5)&quot; class=&quot;p&quot;&gt;Number&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs3', 6)&quot; onmouseover=&quot;showTip(event, 'fs3', 6)&quot; class=&quot;t&quot;&gt;int&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs6', 7)&quot; onmouseover=&quot;showTip(event, 'fs6', 7)&quot; class=&quot;p&quot;&gt;Reference&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs1', 8)&quot; onmouseover=&quot;showTip(event, 'fs1', 8)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs7', 9)&quot; onmouseover=&quot;showTip(event, 'fs7', 9)&quot; class=&quot;p&quot;&gt;Binary&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs4', 10)&quot; onmouseover=&quot;showTip(event, 'fs4', 10)&quot; class=&quot;t&quot;&gt;Expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs2', 11)&quot; onmouseover=&quot;showTip(event, 'fs2', 11)&quot; class=&quot;t&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs4', 12)&quot; onmouseover=&quot;showTip(event, 'fs4', 12)&quot; class=&quot;t&quot;&gt;Expr&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs8', 13)&quot; onmouseover=&quot;showTip(event, 'fs8', 13)&quot; class=&quot;t&quot;&gt;Sheet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs9', 14)&quot; onmouseover=&quot;showTip(event, 'fs9', 14)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs1', 15)&quot; onmouseover=&quot;showTip(event, 'fs1', 15)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs10', 16)&quot; onmouseover=&quot;showTip(event, 'fs10', 16)&quot; class=&quot;t&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;A &lt;code&gt;Position&lt;/code&gt; is simply a pair of column name and a number. An expression is more interesting, because it is recursive. For example, &lt;code&gt;A1+3&lt;/code&gt; is an application of a binary operator on sub-expressions &lt;code&gt;A1&lt;/code&gt;, which is a reference and &lt;code&gt;3&lt;/code&gt; which is a numerical constant. In F#, we capture this nicely using a discriminated union. In the &lt;code&gt;Binary&lt;/code&gt; case, the left and right sub-expressions are themselves values of the &lt;code&gt;Expr&lt;/code&gt; type, so our &lt;code&gt;Expr&lt;/code&gt; type is recursive.&lt;/p&gt;
&lt;p&gt;The type &lt;code&gt;Sheet&lt;/code&gt; is a map from positions to raw user inputs. We could also store parsed expressions or even evaluated results, but we always need the original input so that the user can edit it. To make things simple, we'll just store the original input and parse it each time we need to evaluate the value of a cell. To do the parsing and evaluation, we'll later define two functions:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;1&quot;&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;parse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs10', 17)&quot; onmouseover=&quot;showTip(event, 'fs10', 17)&quot; class=&quot;i&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Expr&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs11', 18)&quot; onmouseover=&quot;showTip(event, 'fs11', 18)&quot; class=&quot;i&quot;&gt;option&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;evaluate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Sheet&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs3', 19)&quot; onmouseover=&quot;showTip(event, 'fs3', 19)&quot; class=&quot;i&quot;&gt;int&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs11', 20)&quot; onmouseover=&quot;showTip(event, 'fs11', 20)&quot; class=&quot;i&quot;&gt;option&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;We will talk about these later when we discuss the logic behind our spreadsheet, but writing the type down early is useful. Given these types, we can already see how everything fits together. Given a position, we can do a lookup into &lt;code&gt;Sheet&lt;/code&gt; to find the entered text, then we can parse it using &lt;code&gt;parse&lt;/code&gt; to get &lt;code&gt;Expr&lt;/code&gt; and, finally, pass the expression to &lt;code&gt;evaluate&lt;/code&gt; to get the resulting value. We also see that both &lt;code&gt;parse&lt;/code&gt; and &lt;code&gt;evaluate&lt;/code&gt; might fail. The first one will fail if the input is not a valid formula and the second might fail if you reference an empty cell.&lt;/p&gt;
&lt;p&gt;Now, all we have to do is to keep writing the rest of Excel until the type checker is happy!&lt;/p&gt;

&lt;p&gt;I'm going to start by discussing the user interface and then get back to implementing the parsing and evaluation logic. For creating user interfaces, Fable comes with a great library called &lt;a href=&quot;https://elmish.github.io/elmish&quot;&gt;Elmish&lt;/a&gt;. Elmish implements a functional-first user interface architecture popularized by the Elm language, which is also known as &lt;em&gt;model view update&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The idea of the architecture is extremely simple. You just need the following two types and two functions:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;1.5&quot;&gt;&lt;tr readability=&quot;4.5&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;6&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span id=&quot;fst71&quot; onmouseout=&quot;hideTip(event, 'fs71', 196)&quot; onmouseover=&quot;showTip(event, 'fs71', 196, document.getElementById('fst71'))&quot; class=&quot;omitted&quot;&gt;(Record capturing the state)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs72', 197)&quot; onmouseover=&quot;showTip(event, 'fs72', 197)&quot; class=&quot;i&quot;&gt;Event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span id=&quot;fst73&quot; onmouseout=&quot;hideTip(event, 'fs73', 198)&quot; onmouseover=&quot;showTip(event, 'fs73', 198, document.getElementById('fst73'))&quot; class=&quot;omitted&quot;&gt;(Union listing possible events)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;update&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;State&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs72', 199)&quot; onmouseover=&quot;showTip(event, 'fs72', 199)&quot; class=&quot;i&quot;&gt;Event&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;State&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;State&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs72', 200)&quot; onmouseover=&quot;showTip(event, 'fs72', 200)&quot; class=&quot;i&quot;&gt;Event&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs74', 201)&quot; onmouseover=&quot;showTip(event, 'fs74', 201)&quot; class=&quot;i&quot;&gt;unit&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Html&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The two types and two functions define the user interface as follows:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code&gt;State&lt;/code&gt; stores all the user interface state that you need in order to render it.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Event&lt;/code&gt; is a union of different events that can happen when the user interacts with the UI.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;update&lt;/code&gt; is a function that takes an original state and an event and produces a new modified state.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;view&lt;/code&gt; takes the state and generates a HTML document; it also takes a function &lt;code&gt;Event -&amp;gt; unit&lt;/code&gt; which can be used in event handlers of the HTML document to trigger an event.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Conceptually, you can think that the application starts with an initial state, renders a page and, when some action happens and event is triggered, updates the state using &lt;code&gt;update&lt;/code&gt; and re-renders the page using &lt;code&gt;view&lt;/code&gt;. The key trick that makes this work is that Elmish does not replace the whole DOM, but diffs the new document with the last one and only updates DOM elements that have changed.&lt;/p&gt;
&lt;p&gt;What state and events are there in our spreadsheet? As with the whole spreadsheet application, the first step in implementing the user interface is to define a few types:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;2.5&quot;&gt;&lt;tr readability=&quot;7.5&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;9: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;6&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs75', 202)&quot; onmouseover=&quot;showTip(event, 'fs75', 202)&quot; class=&quot;t&quot;&gt;Event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs76', 203)&quot; onmouseover=&quot;showTip(event, 'fs76', 203)&quot; class=&quot;p&quot;&gt;UpdateValue&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs77', 204)&quot; onmouseover=&quot;showTip(event, 'fs77', 204)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs10', 205)&quot; onmouseover=&quot;showTip(event, 'fs10', 205)&quot; class=&quot;t&quot;&gt;string&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs78', 206)&quot; onmouseover=&quot;showTip(event, 'fs78', 206)&quot; class=&quot;p&quot;&gt;StartEdit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs77', 207)&quot; onmouseover=&quot;showTip(event, 'fs77', 207)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs79', 208)&quot; onmouseover=&quot;showTip(event, 'fs79', 208)&quot; class=&quot;t&quot;&gt;State&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  { &lt;span onmouseout=&quot;hideTip(event, 'fs80', 209)&quot; onmouseover=&quot;showTip(event, 'fs80', 209)&quot; class=&quot;i&quot;&gt;Rows&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs3', 210)&quot; onmouseover=&quot;showTip(event, 'fs3', 210)&quot; class=&quot;t&quot;&gt;int&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs81', 211)&quot; onmouseover=&quot;showTip(event, 'fs81', 211)&quot; class=&quot;t&quot;&gt;list&lt;/span&gt;
    &lt;span onmouseout=&quot;hideTip(event, 'fs82', 212)&quot; onmouseover=&quot;showTip(event, 'fs82', 212)&quot; class=&quot;i&quot;&gt;Cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 213)&quot; onmouseover=&quot;showTip(event, 'fs14', 213)&quot; class=&quot;t&quot;&gt;char&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs81', 214)&quot; onmouseover=&quot;showTip(event, 'fs81', 214)&quot; class=&quot;t&quot;&gt;list&lt;/span&gt;
    &lt;span onmouseout=&quot;hideTip(event, 'fs83', 215)&quot; onmouseover=&quot;showTip(event, 'fs83', 215)&quot; class=&quot;i&quot;&gt;Active&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs77', 216)&quot; onmouseover=&quot;showTip(event, 'fs77', 216)&quot; class=&quot;t&quot;&gt;Position&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs84', 217)&quot; onmouseover=&quot;showTip(event, 'fs84', 217)&quot; class=&quot;t&quot;&gt;option&lt;/span&gt;
    &lt;span onmouseout=&quot;hideTip(event, 'fs85', 218)&quot; onmouseover=&quot;showTip(event, 'fs85', 218)&quot; class=&quot;i&quot;&gt;Cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs8', 219)&quot; onmouseover=&quot;showTip(event, 'fs8', 219)&quot; class=&quot;t&quot;&gt;Sheet&lt;/span&gt; }
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;In the state, we keep a list of row and column keys (this typically starts from &lt;code&gt;A1&lt;/code&gt;, but we do not require that), currently selected cell (this can be &lt;code&gt;None&lt;/code&gt; if no cell is selected) and, finally, the cells of the spreadsheet. There are two events that can happen. The &lt;code&gt;UpdateValue&lt;/code&gt; event happens when you change the text in the current cell; the &lt;code&gt;StartEdit&lt;/code&gt; event happens when you click on some other cell to start editing it.&lt;/p&gt;
&lt;h3&gt;Updating the spreadsheet after event&lt;/h3&gt;
&lt;p&gt;Writing the &lt;code&gt;update&lt;/code&gt; function is quite easy - as with the main spreadsheet logic, we just need to write code until the type checker is happy!&lt;/p&gt;
&lt;p&gt;In Elmish, the &lt;code&gt;update&lt;/code&gt; function is a little bit more complicated than I said above. In addition to returning new state, we can also return a list of &lt;em&gt;commands&lt;/em&gt;. The commands are used to tell the system that it should start some action after updating the state. This can be things such as starting a HTTP web request to fetch some information from the server. In our case, we do not need any commands, so we just return &lt;code&gt;Cmd.none&lt;/code&gt;:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;3.5&quot;&gt;&lt;tr readability=&quot;10.5&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;8: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs86', 220)&quot; onmouseover=&quot;showTip(event, 'fs86', 220)&quot; class=&quot;f&quot;&gt;update&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs87', 221)&quot; onmouseover=&quot;showTip(event, 'fs87', 221)&quot; class=&quot;i&quot;&gt;msg&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 222)&quot; onmouseover=&quot;showTip(event, 'fs88', 222)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs87', 223)&quot; onmouseover=&quot;showTip(event, 'fs87', 223)&quot; class=&quot;i&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; 
  | &lt;span onmouseout=&quot;hideTip(event, 'fs78', 224)&quot; onmouseover=&quot;showTip(event, 'fs78', 224)&quot; class=&quot;p&quot;&gt;StartEdit&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs45', 225)&quot; onmouseover=&quot;showTip(event, 'fs45', 225)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
      { &lt;span onmouseout=&quot;hideTip(event, 'fs88', 226)&quot; onmouseover=&quot;showTip(event, 'fs88', 226)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Active&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs52', 227)&quot; onmouseover=&quot;showTip(event, 'fs52', 227)&quot; class=&quot;p&quot;&gt;Some&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 228)&quot; onmouseover=&quot;showTip(event, 'fs45', 228)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; }, &lt;span onmouseout=&quot;hideTip(event, 'fs89', 229)&quot; onmouseover=&quot;showTip(event, 'fs89', 229)&quot; class=&quot;t&quot;&gt;Cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs90', 230)&quot; onmouseover=&quot;showTip(event, 'fs90', 230)&quot; class=&quot;i&quot;&gt;none&lt;/span&gt;

  | &lt;span onmouseout=&quot;hideTip(event, 'fs76', 231)&quot; onmouseover=&quot;showTip(event, 'fs76', 231)&quot; class=&quot;p&quot;&gt;UpdateValue&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs45', 232)&quot; onmouseover=&quot;showTip(event, 'fs45', 232)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs91', 233)&quot; onmouseover=&quot;showTip(event, 'fs91', 233)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs92', 234)&quot; onmouseover=&quot;showTip(event, 'fs92', 234)&quot; class=&quot;i&quot;&gt;newCells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs9', 235)&quot; onmouseover=&quot;showTip(event, 'fs9', 235)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs93', 236)&quot; onmouseover=&quot;showTip(event, 'fs93', 236)&quot; class=&quot;f&quot;&gt;add&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 237)&quot; onmouseover=&quot;showTip(event, 'fs45', 237)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs91', 238)&quot; onmouseover=&quot;showTip(event, 'fs91', 238)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 239)&quot; onmouseover=&quot;showTip(event, 'fs88', 239)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs85', 240)&quot; onmouseover=&quot;showTip(event, 'fs85', 240)&quot; class=&quot;i&quot;&gt;Cells&lt;/span&gt;
      { &lt;span onmouseout=&quot;hideTip(event, 'fs88', 241)&quot; onmouseover=&quot;showTip(event, 'fs88', 241)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs92', 242)&quot; onmouseover=&quot;showTip(event, 'fs92', 242)&quot; class=&quot;i&quot;&gt;newCells&lt;/span&gt; }, &lt;span onmouseout=&quot;hideTip(event, 'fs89', 243)&quot; onmouseover=&quot;showTip(event, 'fs89', 243)&quot; class=&quot;t&quot;&gt;Cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs90', 244)&quot; onmouseover=&quot;showTip(event, 'fs90', 244)&quot; class=&quot;i&quot;&gt;none&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The implementation uses the &lt;code&gt;with&lt;/code&gt; construct, which creates a clone of the &lt;code&gt;state&lt;/code&gt; record and updates some of its fields. In the case of &lt;code&gt;StartEdit&lt;/code&gt;, we set the active cell to the newly selected one. In the case of &lt;code&gt;UpdateValue&lt;/code&gt;, we first add the new value to the sheet (the &lt;code&gt;Map.add&lt;/code&gt; function replaces existing value if there is one already) and then set the &lt;code&gt;Cells&lt;/code&gt; of the spreadsheet.&lt;/p&gt;
&lt;h3&gt;Rendering the spreadsheet&lt;/h3&gt;
&lt;p&gt;To construct the HTML document, Elmish comes with a lightweight wrapper built on top of React (although you can use other virtual DOM libraries too). The wrapper defines typed functions for creating HTML elements and specifying their attributes.&lt;/p&gt;
&lt;p&gt;We'll first implement the main &lt;code&gt;view&lt;/code&gt; function which generates the spreadsheet grid and then discuss the &lt;code&gt;renderCell&lt;/code&gt; helper which renders an individual cell.&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;3.5&quot;&gt;&lt;tr readability=&quot;10.5&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;11: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;12: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;13: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;14: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;15: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs118', 329)&quot; onmouseover=&quot;showTip(event, 'fs118', 329)&quot; class=&quot;f&quot;&gt;view&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 330)&quot; onmouseover=&quot;showTip(event, 'fs88', 330)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 331)&quot; onmouseover=&quot;showTip(event, 'fs95', 331)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span onmouseout=&quot;hideTip(event, 'fs119', 332)&quot; onmouseover=&quot;showTip(event, 'fs119', 332)&quot; class=&quot;f&quot;&gt;table&lt;/span&gt; [] [
    &lt;span onmouseout=&quot;hideTip(event, 'fs120', 333)&quot; onmouseover=&quot;showTip(event, 'fs120', 333)&quot; class=&quot;f&quot;&gt;thead&lt;/span&gt; [] [ 
      &lt;span onmouseout=&quot;hideTip(event, 'fs121', 334)&quot; onmouseover=&quot;showTip(event, 'fs121', 334)&quot; class=&quot;f&quot;&gt;tr&lt;/span&gt; [] [
        &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs122', 335)&quot; onmouseover=&quot;showTip(event, 'fs122', 335)&quot; class=&quot;f&quot;&gt;th&lt;/span&gt; [] []
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs123', 336)&quot; onmouseover=&quot;showTip(event, 'fs123', 336)&quot; class=&quot;i&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 337)&quot; onmouseover=&quot;showTip(event, 'fs88', 337)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs82', 338)&quot; onmouseover=&quot;showTip(event, 'fs82', 338)&quot; class=&quot;i&quot;&gt;Cols&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs122', 339)&quot; onmouseover=&quot;showTip(event, 'fs122', 339)&quot; class=&quot;f&quot;&gt;th&lt;/span&gt; [] [ &lt;span onmouseout=&quot;hideTip(event, 'fs103', 340)&quot; onmouseover=&quot;showTip(event, 'fs103', 340)&quot; class=&quot;f&quot;&gt;str&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs10', 341)&quot; onmouseover=&quot;showTip(event, 'fs10', 341)&quot; class=&quot;f&quot;&gt;string&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs123', 342)&quot; onmouseover=&quot;showTip(event, 'fs123', 342)&quot; class=&quot;i&quot;&gt;col&lt;/span&gt;) ]
      ] 
    ]
    &lt;span onmouseout=&quot;hideTip(event, 'fs124', 343)&quot; onmouseover=&quot;showTip(event, 'fs124', 343)&quot; class=&quot;f&quot;&gt;tbody&lt;/span&gt; [] [
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs125', 344)&quot; onmouseover=&quot;showTip(event, 'fs125', 344)&quot; class=&quot;i&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 345)&quot; onmouseover=&quot;showTip(event, 'fs88', 345)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs80', 346)&quot; onmouseover=&quot;showTip(event, 'fs80', 346)&quot; class=&quot;i&quot;&gt;Rows&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs121', 347)&quot; onmouseover=&quot;showTip(event, 'fs121', 347)&quot; class=&quot;f&quot;&gt;tr&lt;/span&gt; [] [
        &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs122', 348)&quot; onmouseover=&quot;showTip(event, 'fs122', 348)&quot; class=&quot;f&quot;&gt;th&lt;/span&gt; [] [ &lt;span onmouseout=&quot;hideTip(event, 'fs103', 349)&quot; onmouseover=&quot;showTip(event, 'fs103', 349)&quot; class=&quot;f&quot;&gt;str&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs10', 350)&quot; onmouseover=&quot;showTip(event, 'fs10', 350)&quot; class=&quot;f&quot;&gt;string&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs125', 351)&quot; onmouseover=&quot;showTip(event, 'fs125', 351)&quot; class=&quot;i&quot;&gt;row&lt;/span&gt;) ]
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs123', 352)&quot; onmouseover=&quot;showTip(event, 'fs123', 352)&quot; class=&quot;i&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 353)&quot; onmouseover=&quot;showTip(event, 'fs88', 353)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs82', 354)&quot; onmouseover=&quot;showTip(event, 'fs82', 354)&quot; class=&quot;i&quot;&gt;Cols&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs113', 355)&quot; onmouseover=&quot;showTip(event, 'fs113', 355)&quot; class=&quot;f&quot;&gt;renderCell&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 356)&quot; onmouseover=&quot;showTip(event, 'fs95', 356)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs123', 357)&quot; onmouseover=&quot;showTip(event, 'fs123', 357)&quot; class=&quot;i&quot;&gt;col&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs125', 358)&quot; onmouseover=&quot;showTip(event, 'fs125', 358)&quot; class=&quot;i&quot;&gt;row&lt;/span&gt;) &lt;span onmouseout=&quot;hideTip(event, 'fs88', 359)&quot; onmouseover=&quot;showTip(event, 'fs88', 359)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;
      ]
    ]
  ]
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Here, we're using F# list comprehensions to generate the HTML document. For example, the lines 4-7 generate the header of the table. We create a &lt;code&gt;tr&lt;/code&gt; element with no attributes (the first argument) containing a couple of &lt;code&gt;th&lt;/code&gt; elements (the second argument). We're using &lt;code&gt;yield&lt;/code&gt; to generate the elements - first, we create the empty &lt;code&gt;th&lt;/code&gt; element in the left top corner and then we iterate over all the columns and produce a header for each of the columns. The &lt;code&gt;col&lt;/code&gt; variable is a character, so we first turn it into a string using &lt;code&gt;string&lt;/code&gt; before turning it into HTML content using &lt;code&gt;str&lt;/code&gt; function provided by Elmish.&lt;/p&gt;
&lt;p&gt;The nice thing about writing your HTML rendering in this way is that it is composable. We do not have to put everything inside one massive function. Here, we call &lt;code&gt;renderCell&lt;/code&gt; (line 12) to render the contents of a cell.&lt;/p&gt;
&lt;h3&gt;Rendering spreadsheet cell&lt;/h3&gt;
&lt;p&gt;There are two different ways in which we render a cell. For the selected cell, we need to render an editor with an input box containing the original entered text. For all other cells, we need to parse the formula, evaluate it and display the result. The &lt;code&gt;renderCell&lt;/code&gt; function chooses the branch and, in the latter case, handles the evaluation:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;3.5&quot;&gt;&lt;tr readability=&quot;10.5&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;11: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;12: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;13: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs113', 282)&quot; onmouseover=&quot;showTip(event, 'fs113', 282)&quot; class=&quot;f&quot;&gt;renderCell&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 283)&quot; onmouseover=&quot;showTip(event, 'fs95', 283)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 284)&quot; onmouseover=&quot;showTip(event, 'fs45', 284)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 285)&quot; onmouseover=&quot;showTip(event, 'fs88', 285)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 286)&quot; onmouseover=&quot;showTip(event, 'fs88', 286)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs83', 287)&quot; onmouseover=&quot;showTip(event, 'fs83', 287)&quot; class=&quot;i&quot;&gt;Active&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs52', 288)&quot; onmouseover=&quot;showTip(event, 'fs52', 288)&quot; class=&quot;p&quot;&gt;Some&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 289)&quot; onmouseover=&quot;showTip(event, 'fs45', 289)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs114', 290)&quot; onmouseover=&quot;showTip(event, 'fs114', 290)&quot; class=&quot;i&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs9', 291)&quot; onmouseover=&quot;showTip(event, 'fs9', 291)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs58', 292)&quot; onmouseover=&quot;showTip(event, 'fs58', 292)&quot; class=&quot;f&quot;&gt;tryFind&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 293)&quot; onmouseover=&quot;showTip(event, 'fs45', 293)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 294)&quot; onmouseover=&quot;showTip(event, 'fs88', 294)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs85', 295)&quot; onmouseover=&quot;showTip(event, 'fs85', 295)&quot; class=&quot;i&quot;&gt;Cells&lt;/span&gt; 
    &lt;span onmouseout=&quot;hideTip(event, 'fs105', 296)&quot; onmouseover=&quot;showTip(event, 'fs105', 296)&quot; class=&quot;f&quot;&gt;renderEditor&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 297)&quot; onmouseover=&quot;showTip(event, 'fs95', 297)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 298)&quot; onmouseover=&quot;showTip(event, 'fs45', 298)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs104', 299)&quot; onmouseover=&quot;showTip(event, 'fs104', 299)&quot; class=&quot;f&quot;&gt;defaultArg&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs114', 300)&quot; onmouseover=&quot;showTip(event, 'fs114', 300)&quot; class=&quot;i&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;)
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs9', 301)&quot; onmouseover=&quot;showTip(event, 'fs9', 301)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs58', 302)&quot; onmouseover=&quot;showTip(event, 'fs58', 302)&quot; class=&quot;f&quot;&gt;tryFind&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 303)&quot; onmouseover=&quot;showTip(event, 'fs45', 303)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 304)&quot; onmouseover=&quot;showTip(event, 'fs88', 304)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs85', 305)&quot; onmouseover=&quot;showTip(event, 'fs85', 305)&quot; class=&quot;i&quot;&gt;Cells&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; 
    | &lt;span onmouseout=&quot;hideTip(event, 'fs52', 306)&quot; onmouseover=&quot;showTip(event, 'fs52', 306)&quot; class=&quot;p&quot;&gt;Some&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs115', 307)&quot; onmouseover=&quot;showTip(event, 'fs115', 307)&quot; class=&quot;i&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs116', 308)&quot; onmouseover=&quot;showTip(event, 'fs116', 308)&quot; class=&quot;i&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
          &lt;span onmouseout=&quot;hideTip(event, 'fs34', 309)&quot; onmouseover=&quot;showTip(event, 'fs34', 309)&quot; class=&quot;f&quot;&gt;parse&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs115', 310)&quot; onmouseover=&quot;showTip(event, 'fs115', 310)&quot; class=&quot;i&quot;&gt;input&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 311)&quot; onmouseover=&quot;showTip(event, 'fs48', 311)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs53', 312)&quot; onmouseover=&quot;showTip(event, 'fs53', 312)&quot; class=&quot;f&quot;&gt;bind&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs50', 313)&quot; onmouseover=&quot;showTip(event, 'fs50', 313)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs55', 314)&quot; onmouseover=&quot;showTip(event, 'fs55', 314)&quot; class=&quot;t&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs117', 315)&quot; onmouseover=&quot;showTip(event, 'fs117', 315)&quot; class=&quot;i&quot;&gt;empty&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs88', 316)&quot; onmouseover=&quot;showTip(event, 'fs88', 316)&quot; class=&quot;i&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs85', 317)&quot; onmouseover=&quot;showTip(event, 'fs85', 317)&quot; class=&quot;i&quot;&gt;Cells&lt;/span&gt;) 
          &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 318)&quot; onmouseover=&quot;showTip(event, 'fs48', 318)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs54', 319)&quot; onmouseover=&quot;showTip(event, 'fs54', 319)&quot; class=&quot;f&quot;&gt;map&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs10', 320)&quot; onmouseover=&quot;showTip(event, 'fs10', 320)&quot; class=&quot;f&quot;&gt;string&lt;/span&gt;
        &lt;span onmouseout=&quot;hideTip(event, 'fs94', 321)&quot; onmouseover=&quot;showTip(event, 'fs94', 321)&quot; class=&quot;f&quot;&gt;renderView&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 322)&quot; onmouseover=&quot;showTip(event, 'fs95', 322)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 323)&quot; onmouseover=&quot;showTip(event, 'fs45', 323)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs116', 324)&quot; onmouseover=&quot;showTip(event, 'fs116', 324)&quot; class=&quot;i&quot;&gt;result&lt;/span&gt;
    | _ &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs94', 325)&quot; onmouseover=&quot;showTip(event, 'fs94', 325)&quot; class=&quot;f&quot;&gt;renderView&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 326)&quot; onmouseover=&quot;showTip(event, 'fs95', 326)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 327)&quot; onmouseover=&quot;showTip(event, 'fs45', 327)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs52', 328)&quot; onmouseover=&quot;showTip(event, 'fs52', 328)&quot; class=&quot;p&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;)
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;We test whether the cell that is being rendered is the active one using the &lt;code&gt;state.Active = Some pos&lt;/code&gt; condition. Rather than comparing two &lt;code&gt;Position&lt;/code&gt; values, we compare &lt;code&gt;Position option&lt;/code&gt; values and do not have to worry about the case when &lt;code&gt;state.Active&lt;/code&gt; is &lt;code&gt;None&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If the current cell is active, we take the entered value or empty string and pass it to &lt;code&gt;renderEditor&lt;/code&gt; (defined next). If no, then we try to get the input - if there is no input, we call &lt;code&gt;renderView&lt;/code&gt; with &lt;code&gt;Some &quot;&quot;&lt;/code&gt; to render valid but empty cell. Otherwise, we use a sequence of &lt;code&gt;parse&lt;/code&gt; and &lt;code&gt;evaluate&lt;/code&gt; to get the result. We will look at both of these functions below, when discussing how the spreadsheet logic is implemented. Both &lt;code&gt;parse&lt;/code&gt; and &lt;code&gt;evaluate&lt;/code&gt; may fail, so we use the option type to compose them. &lt;code&gt;Option.bind&lt;/code&gt; runs &lt;code&gt;evaluate&lt;/code&gt; only when &lt;code&gt;parse&lt;/code&gt; succeeds; otherwise it propagates the &lt;code&gt;None&lt;/code&gt; result. We also use &lt;code&gt;Option.map&lt;/code&gt; to transform the optional result of type &lt;code&gt;int&lt;/code&gt; into an optional string which we then pass to &lt;code&gt;renderView&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So far, we have not created any handlers that would trigger events when something happens in the user interface. We're finally going to do this in &lt;code&gt;renderEditor&lt;/code&gt; and &lt;code&gt;renderView&lt;/code&gt;, which are both otherwise quite straightforward:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;4&quot;&gt;&lt;tr readability=&quot;12&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;11: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;12: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;13: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;14: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs94', 245)&quot; onmouseover=&quot;showTip(event, 'fs94', 245)&quot; class=&quot;f&quot;&gt;renderView&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 246)&quot; onmouseover=&quot;showTip(event, 'fs95', 246)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 247)&quot; onmouseover=&quot;showTip(event, 'fs45', 247)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs96', 248)&quot; onmouseover=&quot;showTip(event, 'fs96', 248)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs84', 249)&quot; onmouseover=&quot;showTip(event, 'fs84', 249)&quot; class=&quot;t&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;) &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs97', 250)&quot; onmouseover=&quot;showTip(event, 'fs97', 250)&quot; class=&quot;i&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs96', 251)&quot; onmouseover=&quot;showTip(event, 'fs96', 251)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs98', 252)&quot; onmouseover=&quot;showTip(event, 'fs98', 252)&quot; class=&quot;i&quot;&gt;IsNone&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;#ffb0b0&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;white&quot;&lt;/span&gt;
  &lt;span onmouseout=&quot;hideTip(event, 'fs99', 253)&quot; onmouseover=&quot;showTip(event, 'fs99', 253)&quot; class=&quot;f&quot;&gt;td&lt;/span&gt; 
    [ &lt;span onmouseout=&quot;hideTip(event, 'fs100', 254)&quot; onmouseover=&quot;showTip(event, 'fs100', 254)&quot; class=&quot;p&quot;&gt;Style&lt;/span&gt; [&lt;span onmouseout=&quot;hideTip(event, 'fs101', 255)&quot; onmouseover=&quot;showTip(event, 'fs101', 255)&quot; class=&quot;p&quot;&gt;Background&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs97', 256)&quot; onmouseover=&quot;showTip(event, 'fs97', 256)&quot; class=&quot;i&quot;&gt;color&lt;/span&gt;] 
      &lt;span onmouseout=&quot;hideTip(event, 'fs102', 257)&quot; onmouseover=&quot;showTip(event, 'fs102', 257)&quot; class=&quot;p&quot;&gt;OnClick&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; _ &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 258)&quot; onmouseover=&quot;showTip(event, 'fs95', 258)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs78', 259)&quot; onmouseover=&quot;showTip(event, 'fs78', 259)&quot; class=&quot;p&quot;&gt;StartEdit&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs45', 260)&quot; onmouseover=&quot;showTip(event, 'fs45', 260)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt;)) ) ] 
    [ &lt;span onmouseout=&quot;hideTip(event, 'fs103', 261)&quot; onmouseover=&quot;showTip(event, 'fs103', 261)&quot; class=&quot;f&quot;&gt;str&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs104', 262)&quot; onmouseover=&quot;showTip(event, 'fs104', 262)&quot; class=&quot;f&quot;&gt;defaultArg&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs96', 263)&quot; onmouseover=&quot;showTip(event, 'fs96', 263)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;#ERR&quot;&lt;/span&gt;) ]

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs105', 264)&quot; onmouseover=&quot;showTip(event, 'fs105', 264)&quot; class=&quot;f&quot;&gt;renderEditor&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 265)&quot; onmouseover=&quot;showTip(event, 'fs95', 265)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 266)&quot; onmouseover=&quot;showTip(event, 'fs45', 266)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs91', 267)&quot; onmouseover=&quot;showTip(event, 'fs91', 267)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span onmouseout=&quot;hideTip(event, 'fs99', 268)&quot; onmouseover=&quot;showTip(event, 'fs99', 268)&quot; class=&quot;f&quot;&gt;td&lt;/span&gt; [ &lt;span onmouseout=&quot;hideTip(event, 'fs106', 269)&quot; onmouseover=&quot;showTip(event, 'fs106', 269)&quot; class=&quot;p&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;selected&quot;&lt;/span&gt;] [ 
    &lt;span onmouseout=&quot;hideTip(event, 'fs107', 270)&quot; onmouseover=&quot;showTip(event, 'fs107', 270)&quot; class=&quot;f&quot;&gt;input&lt;/span&gt; [
      &lt;span onmouseout=&quot;hideTip(event, 'fs108', 271)&quot; onmouseover=&quot;showTip(event, 'fs108', 271)&quot; class=&quot;p&quot;&gt;AutoFocus&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;
      &lt;span onmouseout=&quot;hideTip(event, 'fs109', 272)&quot; onmouseover=&quot;showTip(event, 'fs109', 272)&quot; class=&quot;p&quot;&gt;OnInput&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs110', 273)&quot; onmouseover=&quot;showTip(event, 'fs110', 273)&quot; class=&quot;i&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs95', 274)&quot; onmouseover=&quot;showTip(event, 'fs95', 274)&quot; class=&quot;f&quot;&gt;trigger&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs76', 275)&quot; onmouseover=&quot;showTip(event, 'fs76', 275)&quot; class=&quot;p&quot;&gt;UpdateValue&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs45', 276)&quot; onmouseover=&quot;showTip(event, 'fs45', 276)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs110', 277)&quot; onmouseover=&quot;showTip(event, 'fs110', 277)&quot; class=&quot;i&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs111', 278)&quot; onmouseover=&quot;showTip(event, 'fs111', 278)&quot; class=&quot;i&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs91', 279)&quot; onmouseover=&quot;showTip(event, 'fs91', 279)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt;)))
      &lt;span onmouseout=&quot;hideTip(event, 'fs112', 280)&quot; onmouseover=&quot;showTip(event, 'fs112', 280)&quot; class=&quot;p&quot;&gt;Value&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs91', 281)&quot; onmouseover=&quot;showTip(event, 'fs91', 281)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; ]
  ]
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;In &lt;code&gt;renderView&lt;/code&gt;, we create red background and use the &lt;code&gt;#ERR&lt;/code&gt; string if the value to display is empty (indicating an error). We also add an &lt;code&gt;OnClick&lt;/code&gt; handler. When you click on the cell, we want to trigger the &lt;code&gt;StartEdit&lt;/code&gt; event in order to move the editor to the current cell. To do this, we specify the &lt;code&gt;OnClick&lt;/code&gt; attribute and, when a click happens, trigger the event using the &lt;code&gt;trigger&lt;/code&gt; function which we got as an input argument for the &lt;code&gt;view&lt;/code&gt; function (and which we first passed to &lt;code&gt;renderCell&lt;/code&gt; and then to &lt;code&gt;renderView&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;renderEditor&lt;/code&gt; function is similar. We specify the &lt;code&gt;OnInput&lt;/code&gt; handler and, whenever the text in the input changes, trigger the &lt;code&gt;UpdateValue&lt;/code&gt; event to update the value and recalculate everything in the spreadsheet. We also specify &lt;code&gt;AutoFocus&lt;/code&gt; attribute which ensures that the element is active immediately after it is created (when you click on a cell).&lt;/p&gt;
&lt;h3&gt;Putting it all together&lt;/h3&gt;
&lt;p&gt;Now we have all the four components we need to run our user interface. We have the &lt;code&gt;State&lt;/code&gt; and &lt;code&gt;Event&lt;/code&gt; type definitions and we have the &lt;code&gt;update&lt;/code&gt; and &lt;code&gt;view&lt;/code&gt; functions. To put everything together, we need to define the initial state, specify the ID of the HTML element in which the application should be rendered and start it.&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;3&quot;&gt;&lt;tr readability=&quot;9&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs126', 360)&quot; onmouseover=&quot;showTip(event, 'fs126', 360)&quot; class=&quot;f&quot;&gt;initial&lt;/span&gt; () &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  { &lt;span onmouseout=&quot;hideTip(event, 'fs127', 361)&quot; onmouseover=&quot;showTip(event, 'fs127', 361)&quot; class=&quot;i&quot;&gt;Cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;s&quot;&gt;'A'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'K'&lt;/span&gt;]
    &lt;span onmouseout=&quot;hideTip(event, 'fs128', 362)&quot; onmouseover=&quot;showTip(event, 'fs128', 362)&quot; class=&quot;i&quot;&gt;Rows&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; [&lt;span class=&quot;n&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;15&lt;/span&gt;]
    &lt;span class=&quot;i&quot;&gt;Active&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs57', 363)&quot; onmouseover=&quot;showTip(event, 'fs57', 363)&quot; class=&quot;p&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;i&quot;&gt;Cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs9', 364)&quot; onmouseover=&quot;showTip(event, 'fs9', 364)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs129', 365)&quot; onmouseover=&quot;showTip(event, 'fs129', 365)&quot; class=&quot;i&quot;&gt;empty&lt;/span&gt; },
  &lt;span onmouseout=&quot;hideTip(event, 'fs89', 366)&quot; onmouseover=&quot;showTip(event, 'fs89', 366)&quot; class=&quot;t&quot;&gt;Cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs130', 367)&quot; onmouseover=&quot;showTip(event, 'fs130', 367)&quot; class=&quot;i&quot;&gt;Empty&lt;/span&gt;    
 
&lt;span onmouseout=&quot;hideTip(event, 'fs131', 368)&quot; onmouseover=&quot;showTip(event, 'fs131', 368)&quot; class=&quot;t&quot;&gt;Program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs132', 369)&quot; onmouseover=&quot;showTip(event, 'fs132', 369)&quot; class=&quot;f&quot;&gt;mkProgram&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs126', 370)&quot; onmouseover=&quot;showTip(event, 'fs126', 370)&quot; class=&quot;f&quot;&gt;initial&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs86', 371)&quot; onmouseover=&quot;showTip(event, 'fs86', 371)&quot; class=&quot;f&quot;&gt;update&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs118', 372)&quot; onmouseover=&quot;showTip(event, 'fs118', 372)&quot; class=&quot;f&quot;&gt;view&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs131', 373)&quot; onmouseover=&quot;showTip(event, 'fs131', 373)&quot; class=&quot;t&quot;&gt;Program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs133', 374)&quot; onmouseover=&quot;showTip(event, 'fs133', 374)&quot; class=&quot;f&quot;&gt;withReact&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;main&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs131', 375)&quot; onmouseover=&quot;showTip(event, 'fs131', 375)&quot; class=&quot;t&quot;&gt;Program&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs134', 376)&quot; onmouseover=&quot;showTip(event, 'fs134', 376)&quot; class=&quot;f&quot;&gt;run&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The initial state defines the ranges of available rows and columns and specifies that there are no values in any of the cells (the demo embedded above specifies the initial cells for computing factorial and Fibonacci here). Then we use &lt;code&gt;mkProgram&lt;/code&gt; to compose all the components together, we specify React as our execution engine and we start the Elmish application!&lt;/p&gt;

&lt;p&gt;So far, we defined the domain model which specifies what a spreadsheet is using F# types and we implemented the user interface using Elmish. The only thing we skipped so far is the spreadsheet logic - that is, parsing of formulas and evaluation. Completing these two is going to be easier than you might expect!&lt;/p&gt;
&lt;h3&gt;Evaluating spreadsheet formulas&lt;/h3&gt;
&lt;p&gt;First, let's have a look at how to evaluate formulas. In the beginning, we defined the &lt;code&gt;Expr&lt;/code&gt; type as a discriminated union with three cases: &lt;code&gt;Number&lt;/code&gt;, &lt;code&gt;Binary&lt;/code&gt; and &lt;code&gt;Reference&lt;/code&gt;. To evaluate an expression, we need to write a recursive function that uses pattern matching and appropriately handles each case. We'll start with a simple version that does not handle errors and does not check for recursive formulas:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;7&quot;&gt;&lt;tr readability=&quot;21&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;11: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;12: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;13: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;15&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs37', 82)&quot; onmouseover=&quot;showTip(event, 'fs37', 82)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 83)&quot; onmouseover=&quot;showTip(event, 'fs38', 83)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs39', 84)&quot; onmouseover=&quot;showTip(event, 'fs39', 84)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs39', 85)&quot; onmouseover=&quot;showTip(event, 'fs39', 85)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs5', 86)&quot; onmouseover=&quot;showTip(event, 'fs5', 86)&quot; class=&quot;p&quot;&gt;Number&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs40', 87)&quot; onmouseover=&quot;showTip(event, 'fs40', 87)&quot; class=&quot;i&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span onmouseout=&quot;hideTip(event, 'fs40', 88)&quot; onmouseover=&quot;showTip(event, 'fs40', 88)&quot; class=&quot;i&quot;&gt;num&lt;/span&gt; 

  | &lt;span onmouseout=&quot;hideTip(event, 'fs7', 89)&quot; onmouseover=&quot;showTip(event, 'fs7', 89)&quot; class=&quot;p&quot;&gt;Binary&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs27', 90)&quot; onmouseover=&quot;showTip(event, 'fs27', 90)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs28', 91)&quot; onmouseover=&quot;showTip(event, 'fs28', 91)&quot; class=&quot;i&quot;&gt;op&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs29', 92)&quot; onmouseover=&quot;showTip(event, 'fs29', 92)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs41', 93)&quot; onmouseover=&quot;showTip(event, 'fs41', 93)&quot; class=&quot;i&quot;&gt;ops&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs42', 94)&quot; onmouseover=&quot;showTip(event, 'fs42', 94)&quot; class=&quot;f&quot;&gt;dict&lt;/span&gt; [ &lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;); &lt;span class=&quot;s&quot;&gt;'-'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;); &lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;(*)&lt;/span&gt;; &lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;) ]
      &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs43', 95)&quot; onmouseover=&quot;showTip(event, 'fs43', 95)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs44', 96)&quot; onmouseover=&quot;showTip(event, 'fs44', 96)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs37', 97)&quot; onmouseover=&quot;showTip(event, 'fs37', 97)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 98)&quot; onmouseover=&quot;showTip(event, 'fs38', 98)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs27', 99)&quot; onmouseover=&quot;showTip(event, 'fs27', 99)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs37', 100)&quot; onmouseover=&quot;showTip(event, 'fs37', 100)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 101)&quot; onmouseover=&quot;showTip(event, 'fs38', 101)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs29', 102)&quot; onmouseover=&quot;showTip(event, 'fs29', 102)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;
      &lt;span onmouseout=&quot;hideTip(event, 'fs41', 103)&quot; onmouseover=&quot;showTip(event, 'fs41', 103)&quot; class=&quot;i&quot;&gt;ops&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;[&lt;span onmouseout=&quot;hideTip(event, 'fs28', 104)&quot; onmouseover=&quot;showTip(event, 'fs28', 104)&quot; class=&quot;i&quot;&gt;op&lt;/span&gt;] &lt;span onmouseout=&quot;hideTip(event, 'fs43', 105)&quot; onmouseover=&quot;showTip(event, 'fs43', 105)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs44', 106)&quot; onmouseover=&quot;showTip(event, 'fs44', 106)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;

  | &lt;span onmouseout=&quot;hideTip(event, 'fs6', 107)&quot; onmouseover=&quot;showTip(event, 'fs6', 107)&quot; class=&quot;p&quot;&gt;Reference&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 108)&quot; onmouseover=&quot;showTip(event, 'fs45', 108)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs46', 109)&quot; onmouseover=&quot;showTip(event, 'fs46', 109)&quot; class=&quot;i&quot;&gt;parsed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs34', 110)&quot; onmouseover=&quot;showTip(event, 'fs34', 110)&quot; class=&quot;f&quot;&gt;parse&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs9', 111)&quot; onmouseover=&quot;showTip(event, 'fs9', 111)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs47', 112)&quot; onmouseover=&quot;showTip(event, 'fs47', 112)&quot; class=&quot;f&quot;&gt;find&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 113)&quot; onmouseover=&quot;showTip(event, 'fs45', 113)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 114)&quot; onmouseover=&quot;showTip(event, 'fs38', 114)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt;)
      &lt;span onmouseout=&quot;hideTip(event, 'fs37', 115)&quot; onmouseover=&quot;showTip(event, 'fs37', 115)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 116)&quot; onmouseover=&quot;showTip(event, 'fs38', 116)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs48', 117)&quot; onmouseover=&quot;showTip(event, 'fs48', 117)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs49', 118)&quot; onmouseover=&quot;showTip(event, 'fs49', 118)&quot; class=&quot;f&quot;&gt;get&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs46', 119)&quot; onmouseover=&quot;showTip(event, 'fs46', 119)&quot; class=&quot;i&quot;&gt;parsed&lt;/span&gt;)
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The function takes the spreadsheet &lt;code&gt;cells&lt;/code&gt; as a first argument, because it may need to lookup values of cells referenced by the current expression. It also takes the expression &lt;code&gt;expr&lt;/code&gt; and pattern matches on it. Handling &lt;code&gt;Number&lt;/code&gt; is easy - we just return the number.&lt;/p&gt;
&lt;p&gt;Handling &lt;code&gt;Binary&lt;/code&gt; is a bit more interesting, because we need to call &lt;code&gt;evaluate&lt;/code&gt; recursively to evaluate the value of the left and right sub-expressions. Once we have them, we use a simple dictionary to map the operator to a function (written using standard F# operators) and run the function.&lt;/p&gt;
&lt;p&gt;Finally, when handling a &lt;code&gt;Reference&lt;/code&gt;, we first get the input at the given cell, parse it and then (again) recursively call &lt;code&gt;evaluate&lt;/code&gt;. This can fail in many ways - the cell might be empty or the parser could fail. We improve this in the next version of our evaluator where the function returns &lt;code&gt;int option&lt;/code&gt; rather than &lt;code&gt;int&lt;/code&gt;. The missing value &lt;code&gt;None&lt;/code&gt; indicates that something went wrong.&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;6.5&quot;&gt;&lt;tr readability=&quot;19.5&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt; 1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt; 9: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;10: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;11: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;12: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;13: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;14: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;15: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;16: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;17: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;18: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;14&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs50', 120)&quot; onmouseover=&quot;showTip(event, 'fs50', 120)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs51', 121)&quot; onmouseover=&quot;showTip(event, 'fs51', 121)&quot; class=&quot;i&quot;&gt;visited&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 122)&quot; onmouseover=&quot;showTip(event, 'fs38', 122)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs39', 123)&quot; onmouseover=&quot;showTip(event, 'fs39', 123)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs39', 124)&quot; onmouseover=&quot;showTip(event, 'fs39', 124)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  | &lt;span onmouseout=&quot;hideTip(event, 'fs5', 125)&quot; onmouseover=&quot;showTip(event, 'fs5', 125)&quot; class=&quot;p&quot;&gt;Number&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs40', 126)&quot; onmouseover=&quot;showTip(event, 'fs40', 126)&quot; class=&quot;i&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span onmouseout=&quot;hideTip(event, 'fs52', 127)&quot; onmouseover=&quot;showTip(event, 'fs52', 127)&quot; class=&quot;p&quot;&gt;Some&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs40', 128)&quot; onmouseover=&quot;showTip(event, 'fs40', 128)&quot; class=&quot;i&quot;&gt;num&lt;/span&gt;

  | &lt;span onmouseout=&quot;hideTip(event, 'fs7', 129)&quot; onmouseover=&quot;showTip(event, 'fs7', 129)&quot; class=&quot;p&quot;&gt;Binary&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs27', 130)&quot; onmouseover=&quot;showTip(event, 'fs27', 130)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs28', 131)&quot; onmouseover=&quot;showTip(event, 'fs28', 131)&quot; class=&quot;i&quot;&gt;op&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs29', 132)&quot; onmouseover=&quot;showTip(event, 'fs29', 132)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs41', 133)&quot; onmouseover=&quot;showTip(event, 'fs41', 133)&quot; class=&quot;i&quot;&gt;ops&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs42', 134)&quot; onmouseover=&quot;showTip(event, 'fs42', 134)&quot; class=&quot;f&quot;&gt;dict&lt;/span&gt; [ &lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;); &lt;span class=&quot;s&quot;&gt;'-'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;); &lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;(*)&lt;/span&gt;; &lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;, (&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;) ]
      &lt;span onmouseout=&quot;hideTip(event, 'fs50', 135)&quot; onmouseover=&quot;showTip(event, 'fs50', 135)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs51', 136)&quot; onmouseover=&quot;showTip(event, 'fs51', 136)&quot; class=&quot;i&quot;&gt;visited&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 137)&quot; onmouseover=&quot;showTip(event, 'fs38', 137)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs27', 138)&quot; onmouseover=&quot;showTip(event, 'fs27', 138)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 139)&quot; onmouseover=&quot;showTip(event, 'fs48', 139)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs53', 140)&quot; onmouseover=&quot;showTip(event, 'fs53', 140)&quot; class=&quot;f&quot;&gt;bind&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs43', 141)&quot; onmouseover=&quot;showTip(event, 'fs43', 141)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
        &lt;span onmouseout=&quot;hideTip(event, 'fs50', 142)&quot; onmouseover=&quot;showTip(event, 'fs50', 142)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs51', 143)&quot; onmouseover=&quot;showTip(event, 'fs51', 143)&quot; class=&quot;i&quot;&gt;visited&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 144)&quot; onmouseover=&quot;showTip(event, 'fs38', 144)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs29', 145)&quot; onmouseover=&quot;showTip(event, 'fs29', 145)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 146)&quot; onmouseover=&quot;showTip(event, 'fs48', 146)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs54', 147)&quot; onmouseover=&quot;showTip(event, 'fs54', 147)&quot; class=&quot;f&quot;&gt;map&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs44', 148)&quot; onmouseover=&quot;showTip(event, 'fs44', 148)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
          &lt;span onmouseout=&quot;hideTip(event, 'fs41', 149)&quot; onmouseover=&quot;showTip(event, 'fs41', 149)&quot; class=&quot;i&quot;&gt;ops&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;[&lt;span onmouseout=&quot;hideTip(event, 'fs28', 150)&quot; onmouseover=&quot;showTip(event, 'fs28', 150)&quot; class=&quot;i&quot;&gt;op&lt;/span&gt;] &lt;span onmouseout=&quot;hideTip(event, 'fs43', 151)&quot; onmouseover=&quot;showTip(event, 'fs43', 151)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs44', 152)&quot; onmouseover=&quot;showTip(event, 'fs44', 152)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt; ))

  | &lt;span onmouseout=&quot;hideTip(event, 'fs6', 153)&quot; onmouseover=&quot;showTip(event, 'fs6', 153)&quot; class=&quot;p&quot;&gt;Reference&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 154)&quot; onmouseover=&quot;showTip(event, 'fs45', 154)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs55', 155)&quot; onmouseover=&quot;showTip(event, 'fs55', 155)&quot; class=&quot;t&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs56', 156)&quot; onmouseover=&quot;showTip(event, 'fs56', 156)&quot; class=&quot;f&quot;&gt;contains&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 157)&quot; onmouseover=&quot;showTip(event, 'fs45', 157)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs51', 158)&quot; onmouseover=&quot;showTip(event, 'fs51', 158)&quot; class=&quot;i&quot;&gt;visited&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
      &lt;span onmouseout=&quot;hideTip(event, 'fs57', 159)&quot; onmouseover=&quot;showTip(event, 'fs57', 159)&quot; class=&quot;p&quot;&gt;None&lt;/span&gt;

  | &lt;span onmouseout=&quot;hideTip(event, 'fs6', 160)&quot; onmouseover=&quot;showTip(event, 'fs6', 160)&quot; class=&quot;p&quot;&gt;Reference&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 161)&quot; onmouseover=&quot;showTip(event, 'fs45', 161)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; 
      &lt;span onmouseout=&quot;hideTip(event, 'fs9', 162)&quot; onmouseover=&quot;showTip(event, 'fs9', 162)&quot; class=&quot;t&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs58', 163)&quot; onmouseover=&quot;showTip(event, 'fs58', 163)&quot; class=&quot;f&quot;&gt;tryFind&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 164)&quot; onmouseover=&quot;showTip(event, 'fs45', 164)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs38', 165)&quot; onmouseover=&quot;showTip(event, 'fs38', 165)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 166)&quot; onmouseover=&quot;showTip(event, 'fs48', 166)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs53', 167)&quot; onmouseover=&quot;showTip(event, 'fs53', 167)&quot; class=&quot;f&quot;&gt;bind&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs59', 168)&quot; onmouseover=&quot;showTip(event, 'fs59', 168)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
        &lt;span onmouseout=&quot;hideTip(event, 'fs34', 169)&quot; onmouseover=&quot;showTip(event, 'fs34', 169)&quot; class=&quot;f&quot;&gt;parse&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs59', 170)&quot; onmouseover=&quot;showTip(event, 'fs59', 170)&quot; class=&quot;i&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs48', 171)&quot; onmouseover=&quot;showTip(event, 'fs48', 171)&quot; class=&quot;t&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs53', 172)&quot; onmouseover=&quot;showTip(event, 'fs53', 172)&quot; class=&quot;f&quot;&gt;bind&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs60', 173)&quot; onmouseover=&quot;showTip(event, 'fs60', 173)&quot; class=&quot;i&quot;&gt;parsed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt;
          &lt;span onmouseout=&quot;hideTip(event, 'fs50', 174)&quot; onmouseover=&quot;showTip(event, 'fs50', 174)&quot; class=&quot;f&quot;&gt;evaluate&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs55', 175)&quot; onmouseover=&quot;showTip(event, 'fs55', 175)&quot; class=&quot;t&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs61', 176)&quot; onmouseover=&quot;showTip(event, 'fs61', 176)&quot; class=&quot;f&quot;&gt;add&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs45', 177)&quot; onmouseover=&quot;showTip(event, 'fs45', 177)&quot; class=&quot;i&quot;&gt;pos&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs51', 178)&quot; onmouseover=&quot;showTip(event, 'fs51', 178)&quot; class=&quot;i&quot;&gt;visited&lt;/span&gt;) &lt;span onmouseout=&quot;hideTip(event, 'fs38', 179)&quot; onmouseover=&quot;showTip(event, 'fs38', 179)&quot; class=&quot;i&quot;&gt;cells&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs60', 180)&quot; onmouseover=&quot;showTip(event, 'fs60', 180)&quot; class=&quot;i&quot;&gt;parsed&lt;/span&gt;))
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;In case of &lt;code&gt;Number&lt;/code&gt;, we now return &lt;code&gt;Some num&lt;/code&gt;. In this case, evaluation cannot fail. In case of &lt;code&gt;Binary&lt;/code&gt;, both recursive calls can fail and we get two option values. To handle this, we use &lt;code&gt;Option.bind&lt;/code&gt; and &lt;code&gt;Option.map&lt;/code&gt; - both of these will call the specified function only when the previous operation succeeded, otherwise, they immediately return &lt;code&gt;None&lt;/code&gt; indicating a failure. If both the left and the right sub-expressions can be evaluated, we can then apply binary numerical operator to their results. Handling of &lt;code&gt;Reference&lt;/code&gt; is similar - we sequence a number of operations that may fail using &lt;code&gt;Option.bind&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Another interesting feature we added in this version is checking for recursive references. To do this, the &lt;code&gt;evaluate&lt;/code&gt; function now takes the &lt;code&gt;visited&lt;/code&gt; parameter which is a set of cells that were accessed during the evaluation. We add cells to the set using &lt;code&gt;Set.add pos visited&lt;/code&gt; on line 18. When we find a reference to a cell that we already visited (line 12), then we immediately return &lt;code&gt;None&lt;/code&gt;, because this would lead to an infinite loop.&lt;/p&gt;
&lt;h3&gt;Parsing formulas&lt;/h3&gt;
&lt;p&gt;Finally, the last part of logic that we need to implement is the parsing of formulas entered by the user into values of our &lt;code&gt;Expr&lt;/code&gt; type. For this, we're going to use a very simple parser combinator library (which you can find in the &lt;a href=&quot;https://github.com/tpetricek/elmish-spreadsheet/blob/master/src/helpers/parsec.fs&quot;&gt;full source code&lt;/a&gt;). There are four key concepts in the library:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;2.5&quot;&gt;&lt;tr readability=&quot;7.5&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;TChar&lt;/span&gt;, &lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;TResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;TChar&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs81', 377)&quot; onmouseover=&quot;showTip(event, 'fs81', 377)&quot; class=&quot;i&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs11', 378)&quot; onmouseover=&quot;showTip(event, 'fs11', 378)&quot; class=&quot;i&quot;&gt;option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;TResult&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;TChar&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs81', 379)&quot; onmouseover=&quot;showTip(event, 'fs81', 379)&quot; class=&quot;i&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; ( &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&lt;/span&gt; ) &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; ( &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; ) &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; (&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;R&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;Parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;i&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;ul readability=&quot;11&quot;&gt;&lt;li readability=&quot;4&quot;&gt;
&lt;p&gt;&lt;code&gt;Parser&amp;lt;char, 'T&amp;gt;&lt;/code&gt; represents a parser that takes a list of characters as the input. It returns &lt;code&gt;None&lt;/code&gt; if the parser cannot parse the input. Otherwise, the parser parses a value and returns it together with the rest of the input. The fact that parsers do not have to consume the entire input makes it easy to compose them.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;3&quot;&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;*&amp;gt;&lt;/code&gt; is a binary operator that takes two parsers; it runs the first parser first, getting a value of type &lt;code&gt;'T1&lt;/code&gt; and then runs the second parser on the rest of the input, getting a value of type &lt;code&gt;'T2&lt;/code&gt;. It succeeds only if both parsers succeed and then it returns a pair with both values.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;4&quot;&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;|&amp;gt;&lt;/code&gt; is a binary operator that also takes two parsers, but they both have to recognise values of the same type. It tries to run the first parser and, if that fails, tries to run the second one. It succeeds if either of the parsers succeed and returns whatever the successful parser returned.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;5&quot;&gt;
&lt;p&gt;Finally, &lt;code&gt;map&lt;/code&gt; is a function that transforms the value that a parser produces. Given a parser of type &lt;code&gt;Parser&amp;lt;'T&amp;gt;&lt;/code&gt; and a function &lt;code&gt;'T -&amp;gt; 'R&lt;/code&gt;, it returns a parser that runs the original parser and, if that is successful, applies the function to the result.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;The following snippet shows how we use these three ideas to create simple parsers to recognise operators, references and numbers:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;1.5&quot;&gt;&lt;tr readability=&quot;4.5&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;6&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs13', 22)&quot; onmouseover=&quot;showTip(event, 'fs13', 22)&quot; class=&quot;i&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 23)&quot; onmouseover=&quot;showTip(event, 'fs14', 23)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'+'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 24)&quot; onmouseover=&quot;showTip(event, 'fs14', 24)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'-'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 25)&quot; onmouseover=&quot;showTip(event, 'fs14', 25)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'*'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 26)&quot; onmouseover=&quot;showTip(event, 'fs14', 26)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs15', 27)&quot; onmouseover=&quot;showTip(event, 'fs15', 27)&quot; class=&quot;i&quot;&gt;reference&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs16', 28)&quot; onmouseover=&quot;showTip(event, 'fs16', 28)&quot; class=&quot;i&quot;&gt;letter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs17', 29)&quot; onmouseover=&quot;showTip(event, 'fs17', 29)&quot; class=&quot;i&quot;&gt;integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs18', 30)&quot; onmouseover=&quot;showTip(event, 'fs18', 30)&quot; class=&quot;f&quot;&gt;map&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs6', 31)&quot; onmouseover=&quot;showTip(event, 'fs6', 31)&quot; class=&quot;p&quot;&gt;Reference&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs19', 32)&quot; onmouseover=&quot;showTip(event, 'fs19', 32)&quot; class=&quot;i&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs17', 33)&quot; onmouseover=&quot;showTip(event, 'fs17', 33)&quot; class=&quot;i&quot;&gt;integer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs18', 34)&quot; onmouseover=&quot;showTip(event, 'fs18', 34)&quot; class=&quot;f&quot;&gt;map&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs5', 35)&quot; onmouseover=&quot;showTip(event, 'fs5', 35)&quot; class=&quot;p&quot;&gt;Number&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The &lt;code&gt;char&lt;/code&gt; function creates a parser that recognises only the given character (and then returns it as the result). Thus, the &lt;code&gt;operator&lt;/code&gt; parser recognises the four standard numerical binary operators and accepts no other characters. The &lt;code&gt;reference&lt;/code&gt; parser recognises a letter followed by a number. This returns a &lt;code&gt;char * int&lt;/code&gt; pair which we turn into the &lt;code&gt;Reference&lt;/code&gt; value of &lt;code&gt;Expr&lt;/code&gt; using the &lt;code&gt;map&lt;/code&gt; function. Parsing a number is even easier - we just run the built-in &lt;code&gt;integer&lt;/code&gt; parser and wrap it in &lt;code&gt;Number&lt;/code&gt;. Note that the type of &lt;code&gt;reference&lt;/code&gt; and &lt;code&gt;number&lt;/code&gt; is now the same - &lt;code&gt;Parser&amp;lt;char, Expr&amp;gt;&lt;/code&gt;. This means that we can compose them using &lt;code&gt;&amp;lt;|&amp;gt;&lt;/code&gt; to create parser that recognises either of the two expression types.&lt;/p&gt;
&lt;p&gt;Finishing the rest of the parsing is a bit more work, because we need to handle parentheses as &lt;code&gt;(1+2)*3&lt;/code&gt; and also ignore whitespace, but the concepts are the same:&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;6&quot;&gt;&lt;tr readability=&quot;18&quot;&gt;&lt;td class=&quot;lines&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;4: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;5: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;6: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;7: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;8: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;9: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;13&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs20', 36)&quot; onmouseover=&quot;showTip(event, 'fs20', 36)&quot; class=&quot;i&quot;&gt;exprSetter&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs21', 37)&quot; onmouseover=&quot;showTip(event, 'fs21', 37)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs22', 38)&quot; onmouseover=&quot;showTip(event, 'fs22', 38)&quot; class=&quot;f&quot;&gt;slot&lt;/span&gt; ()
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs23', 39)&quot; onmouseover=&quot;showTip(event, 'fs23', 39)&quot; class=&quot;i&quot;&gt;brack&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span onmouseout=&quot;hideTip(event, 'fs14', 40)&quot; onmouseover=&quot;showTip(event, 'fs14', 40)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'('&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 41)&quot; onmouseover=&quot;showTip(event, 'fs24', 41)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs21', 42)&quot; onmouseover=&quot;showTip(event, 'fs21', 42)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 43)&quot; onmouseover=&quot;showTip(event, 'fs24', 43)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 44)&quot; onmouseover=&quot;showTip(event, 'fs14', 44)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;')'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs25', 45)&quot; onmouseover=&quot;showTip(event, 'fs25', 45)&quot; class=&quot;i&quot;&gt;term&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs19', 46)&quot; onmouseover=&quot;showTip(event, 'fs19', 46)&quot; class=&quot;i&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs15', 47)&quot; onmouseover=&quot;showTip(event, 'fs15', 47)&quot; class=&quot;i&quot;&gt;reference&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs23', 48)&quot; onmouseover=&quot;showTip(event, 'fs23', 48)&quot; class=&quot;i&quot;&gt;brack&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs26', 49)&quot; onmouseover=&quot;showTip(event, 'fs26', 49)&quot; class=&quot;i&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
  &lt;span onmouseout=&quot;hideTip(event, 'fs25', 50)&quot; onmouseover=&quot;showTip(event, 'fs25', 50)&quot; class=&quot;i&quot;&gt;term&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 51)&quot; onmouseover=&quot;showTip(event, 'fs24', 51)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs13', 52)&quot; onmouseover=&quot;showTip(event, 'fs13', 52)&quot; class=&quot;i&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 53)&quot; onmouseover=&quot;showTip(event, 'fs24', 53)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs25', 54)&quot; onmouseover=&quot;showTip(event, 'fs25', 54)&quot; class=&quot;i&quot;&gt;term&lt;/span&gt; 
  &lt;span class=&quot;o&quot;&gt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs18', 55)&quot; onmouseover=&quot;showTip(event, 'fs18', 55)&quot; class=&quot;f&quot;&gt;map&lt;/span&gt; (&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; ((&lt;span onmouseout=&quot;hideTip(event, 'fs27', 56)&quot; onmouseover=&quot;showTip(event, 'fs27', 56)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;,&lt;span onmouseout=&quot;hideTip(event, 'fs28', 57)&quot; onmouseover=&quot;showTip(event, 'fs28', 57)&quot; class=&quot;i&quot;&gt;op&lt;/span&gt;), &lt;span onmouseout=&quot;hideTip(event, 'fs29', 58)&quot; onmouseover=&quot;showTip(event, 'fs29', 58)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;) &lt;span class=&quot;k&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs7', 59)&quot; onmouseover=&quot;showTip(event, 'fs7', 59)&quot; class=&quot;p&quot;&gt;Binary&lt;/span&gt;(&lt;span onmouseout=&quot;hideTip(event, 'fs27', 60)&quot; onmouseover=&quot;showTip(event, 'fs27', 60)&quot; class=&quot;i&quot;&gt;l&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;op&lt;/span&gt;, &lt;span onmouseout=&quot;hideTip(event, 'fs29', 61)&quot; onmouseover=&quot;showTip(event, 'fs29', 61)&quot; class=&quot;i&quot;&gt;r&lt;/span&gt;))
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs30', 62)&quot; onmouseover=&quot;showTip(event, 'fs30', 62)&quot; class=&quot;i&quot;&gt;exprAux&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs26', 63)&quot; onmouseover=&quot;showTip(event, 'fs26', 63)&quot; class=&quot;i&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs25', 64)&quot; onmouseover=&quot;showTip(event, 'fs25', 64)&quot; class=&quot;i&quot;&gt;term&lt;/span&gt;
&lt;span onmouseout=&quot;hideTip(event, 'fs20', 65)&quot; onmouseover=&quot;showTip(event, 'fs20', 65)&quot; class=&quot;i&quot;&gt;exprSetter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span onmouseout=&quot;hideTip(event, 'fs31', 66)&quot; onmouseover=&quot;showTip(event, 'fs31', 66)&quot; class=&quot;i&quot;&gt;Set&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs30', 67)&quot; onmouseover=&quot;showTip(event, 'fs30', 67)&quot; class=&quot;i&quot;&gt;exprAux&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;To deal with recursion, the library allows us to create a parser using &lt;code&gt;slot&lt;/code&gt;, use it, and then define what it is later using &lt;code&gt;exprSetter&lt;/code&gt;. In our case, we define &lt;code&gt;expr&lt;/code&gt; on line 1, use it when defining &lt;code&gt;brack&lt;/code&gt; (line 3) and then define it on line 9. This is a recursive reference; &lt;code&gt;exprAux&lt;/code&gt; can be &lt;code&gt;binary&lt;/code&gt;, which contains &lt;code&gt;term&lt;/code&gt;, which can be &lt;code&gt;brack&lt;/code&gt; and that, in turn, contains &lt;code&gt;expr&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The only other clever thing in the snippet are the &lt;code&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/code&gt; operators. Those behave like &lt;code&gt;&amp;lt;*&amp;gt;&lt;/code&gt;, but return only the result from the parser on the left or right (wherever the double arrow points). This is useful, because we can write &lt;code&gt;anySpace &amp;lt;*&amp;gt;&amp;gt; expr &amp;lt;&amp;lt;*&amp;gt; anySpace&lt;/code&gt; to parser expression surrounded by whitespace, but get a parser that returns just the result of &lt;code&gt;expr&lt;/code&gt; (we do not care what the whitespace was).&lt;/p&gt;
&lt;p&gt;Finally, we define a formula which is &lt;code&gt;=&lt;/code&gt; followed by an expression and an equation - that is, the thing that you can type in the spreadsheet - which is either a formula or a number.&lt;/p&gt;
&lt;table class=&quot;pre&quot; readability=&quot;1.5&quot;&gt;&lt;tr readability=&quot;4.5&quot;&gt;&lt;td class=&quot;lines&quot;&gt;
&lt;pre class=&quot;fssnip&quot;&gt;
&lt;span class=&quot;l&quot;&gt;1: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;2: &lt;/span&gt;
&lt;span class=&quot;l&quot;&gt;3: &lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;snippet&quot; readability=&quot;6&quot;&gt;
&lt;pre class=&quot;fssnip highlighted&quot;&gt;
&lt;code lang=&quot;fsharp&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs32', 68)&quot; onmouseover=&quot;showTip(event, 'fs32', 68)&quot; class=&quot;i&quot;&gt;formula&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs14', 69)&quot; onmouseover=&quot;showTip(event, 'fs14', 69)&quot; class=&quot;f&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'='&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 70)&quot; onmouseover=&quot;showTip(event, 'fs24', 70)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs21', 71)&quot; onmouseover=&quot;showTip(event, 'fs21', 71)&quot; class=&quot;i&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs33', 72)&quot; onmouseover=&quot;showTip(event, 'fs33', 72)&quot; class=&quot;i&quot;&gt;equation&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 73)&quot; onmouseover=&quot;showTip(event, 'fs24', 73)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;*&amp;gt;&amp;gt;&lt;/span&gt; (&lt;span onmouseout=&quot;hideTip(event, 'fs32', 74)&quot; onmouseover=&quot;showTip(event, 'fs32', 74)&quot; class=&quot;i&quot;&gt;formula&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;|&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs19', 75)&quot; onmouseover=&quot;showTip(event, 'fs19', 75)&quot; class=&quot;i&quot;&gt;number&lt;/span&gt;) &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;*&amp;gt;&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs24', 76)&quot; onmouseover=&quot;showTip(event, 'fs24', 76)&quot; class=&quot;i&quot;&gt;anySpace&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs34', 77)&quot; onmouseover=&quot;showTip(event, 'fs34', 77)&quot; class=&quot;f&quot;&gt;parse&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs35', 78)&quot; onmouseover=&quot;showTip(event, 'fs35', 78)&quot; class=&quot;i&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs36', 79)&quot; onmouseover=&quot;showTip(event, 'fs36', 79)&quot; class=&quot;f&quot;&gt;run&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs33', 80)&quot; onmouseover=&quot;showTip(event, 'fs33', 80)&quot; class=&quot;i&quot;&gt;equation&lt;/span&gt; &lt;span onmouseout=&quot;hideTip(event, 'fs35', 81)&quot; onmouseover=&quot;showTip(event, 'fs35', 81)&quot; class=&quot;i&quot;&gt;input&lt;/span&gt;
&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The &lt;code&gt;parse&lt;/code&gt; function defined on the last line lets us run the main &lt;code&gt;equation&lt;/code&gt; parser on a given input. It takes a sequence of characters and produces &lt;code&gt;option&amp;lt;Expr&amp;gt;&lt;/code&gt;, which is exactly what we've used earlier in the article.&lt;/p&gt;
&lt;h2&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;In total, this article showed you some 125 lines of code. If we did not worry about nice formatting and skipped all the blank lines, we could have written a simple spreadsheet application in some 100 lines of code! Aside from standard Fable libraries, the only thing I did not count is the parser combinator library. I wrote that on my own, but there are similar existing libraries that you could use (though you'd need to find one that works with Fable).&lt;/p&gt;
&lt;p&gt;The final spreadsheet application is quite simple, but it does a number of interesting things. It runs in a web browser and you can scroll back to the start of the article to play with it again! On the technical side, it has a user interface where you can select and edit cells, it parses the formulas you enter and it also evaluates them, handling errors and recursive references.&lt;/p&gt;
&lt;blockquote readability=&quot;10.555873925501&quot;&gt;
&lt;p&gt;If you enjoyed this post and want to learn more about F# and also Fable, join our &lt;a href=&quot;https://skillsmatter.com/courses/473-tomas-petricek-phil-trelford-fast-track-to-fsharp&quot;&gt;F# FastTrack&lt;/a&gt; course on &lt;strong&gt;6-7 December&lt;/strong&gt; in &lt;strong&gt;London&lt;/strong&gt; at SkillsMatter. We'll cover Fable, Elmish, but also many other F# examples. Get in touch at &lt;a href=&quot;http://twitter.com/tomaspetricek&quot;&gt;@tomaspetricek&lt;/a&gt; or email &lt;a href=&quot;mailto:tomas@tomasp.net&quot;&gt;tomas@tomasp.net&lt;/a&gt; for a 10% discount for the course, or if you are interested in custom on-site training.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I like this example, because it shows how a number of nice aspects of the F# language and also the F# community can come together to provide a fantastic overall experience. In case of our spreadsheet, this includes:&lt;/p&gt;
&lt;ul readability=&quot;7.7969094922737&quot;&gt;&lt;li readability=&quot;3.9358974358974&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://fable.io/&quot;&gt;Fable&lt;/a&gt; makes it possible to compile F# to JavaScript, but more importantly, it also gives us access to the JavaScript ecosystem. Fable follows the pragmatic style of functional-first F# programming. This makes it possible to integrate with libraries such as React and build different architectures on top of them.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;2.8050541516245&quot;&gt;
&lt;p&gt;The Elm architecture, as implemented by &lt;a href=&quot;https://elmish.github.io/elmish/&quot;&gt;the Elmish library&lt;/a&gt;, is a fantastic way to write functional-first user interfaces. All we had to do to implement the spreadsheet user interface was to define types for the state and events and then implement the &lt;code&gt;update&lt;/code&gt; and &lt;code&gt;view&lt;/code&gt; functions.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;6&quot;&gt;
&lt;p&gt;Finally, the example also used compositionality of functional programming in two ways. First, an expression is elegantly expressed by a recursive type &lt;code&gt;Expr&lt;/code&gt; which can consist of other &lt;code&gt;Expr&lt;/code&gt; values. Second, we composed a parser for spreadsheet formulas from just a few primitives using just two operators, &lt;code&gt;&amp;lt;|&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;*&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;If you want to have a look at the complete source code, you can find it &lt;a href=&quot;https://github.com/tpetricek/elmish-spreadsheet/&quot;&gt;in my elmish-spreadsheet repository on GitHub&lt;/a&gt;. The repository is designed as a hands-on exercise where you can start with a template, complete a number of tasks and end up with a spreadsheet, but there is also &lt;code&gt;completed&lt;/code&gt; branch where you find the finished source code. You can also edit and run the code in your browser using the &lt;a href=&quot;https://fable.io/repl/&quot;&gt;Fable REPL&lt;/a&gt; (you'll find it under Samples, Elmish, Spreadsheet),&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs1&quot; readability=&quot;9&quot;&gt;type Position = char * int&lt;p&gt;Full name: Write-your-own-excel.Position&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs2&quot; readability=&quot;13&quot;&gt;Multiple items&lt;br/&gt;val char : value:'T -&amp;gt; char (requires member op_Explicit)&lt;p&gt;Full name: Microsoft.FSharp.Core.Operators.char&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type char = System.Char&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.char&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs3&quot; readability=&quot;17&quot;&gt;Multiple items&lt;br/&gt;val int : value:'T -&amp;gt; int (requires member op_Explicit)&lt;p&gt;Full name: Microsoft.FSharp.Core.Operators.int&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type int = int32&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.int&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type int&amp;lt;'Measure&amp;gt; = int&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.int&amp;lt;_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs4&quot; readability=&quot;11&quot;&gt;type Expr =&lt;br/&gt;  | Number of int&lt;br/&gt;  | Reference of Position&lt;br/&gt;  | Binary of Expr * char * Expr&lt;p&gt;Full name: Write-your-own-excel.Expr&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case Expr.Number: int -&amp;gt; Expr&lt;/p&gt;
&lt;p&gt;union case Expr.Reference: Position -&amp;gt; Expr&lt;/p&gt;
&lt;p&gt;union case Expr.Binary: Expr * char * Expr -&amp;gt; Expr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs8&quot; readability=&quot;7&quot;&gt;type Sheet = Map&lt;p&gt;Full name: Write-your-own-excel.Sheet&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs9&quot; readability=&quot;25&quot;&gt;Multiple items&lt;br/&gt;module Map&lt;p&gt;from Microsoft.FSharp.Collections&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Map&amp;lt;'Key,'Value (requires comparison)&amp;gt; =&lt;br/&gt;  interface IEnumerable&lt;br/&gt;  interface IComparable&lt;br/&gt;  interface IEnumerable&amp;lt;KeyValuePair&amp;lt;'Key,'Value&amp;gt;&amp;gt;&lt;br/&gt;  interface ICollection&amp;lt;KeyValuePair&amp;lt;'Key,'Value&amp;gt;&amp;gt;&lt;br/&gt;  interface IDictionary&amp;lt;'Key,'Value&amp;gt;&lt;br/&gt;  new : elements:seq&amp;lt;'Key * 'Value&amp;gt; -&amp;gt; Map&amp;lt;'Key,'Value&amp;gt;&lt;br/&gt;  member Add : key:'Key * value:'Value -&amp;gt; Map&amp;lt;'Key,'Value&amp;gt;&lt;br/&gt;  member ContainsKey : key:'Key -&amp;gt; bool&lt;br/&gt;  override Equals : obj -&amp;gt; bool&lt;br/&gt;  member Remove : key:'Key -&amp;gt; Map&amp;lt;'Key,'Value&amp;gt;&lt;br/&gt;  ...&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Collections.Map&amp;lt;_,_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : elements:seq&amp;lt;'Key * 'Value&amp;gt; -&amp;gt; Map&amp;lt;'Key,'Value&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs10&quot; readability=&quot;13&quot;&gt;Multiple items&lt;br/&gt;val string : value:'T -&amp;gt; string&lt;p&gt;Full name: Microsoft.FSharp.Core.Operators.string&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type string = System.String&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.string&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs11&quot; readability=&quot;7&quot;&gt;type 'T option = Option&lt;p&gt;Full name: Microsoft.FSharp.Core.option&amp;lt;_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;module Parsec&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs13&quot; readability=&quot;7&quot;&gt;val operator : Parser&lt;p&gt;Full name: Write-your-own-excel.operator&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs14&quot; readability=&quot;11&quot;&gt;Multiple items&lt;br/&gt;val char : tok:'a -&amp;gt; Parser (requires equality)&lt;p&gt;Full name: Parsec.char&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type char = System.Char&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.char&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs15&quot; readability=&quot;7&quot;&gt;val reference : Parser&lt;p&gt;Full name: Write-your-own-excel.reference&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs16&quot;&gt;val letter : Parser&lt;p&gt;Full name: Parsec.letter&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs17&quot; readability=&quot;7&quot;&gt;val integer : Parser&lt;p&gt;Full name: Parsec.integer&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs18&quot; readability=&quot;9&quot;&gt;val map : f:('a -&amp;gt; 'b) -&amp;gt; Parser -&amp;gt; Parser&lt;p&gt;Full name: Parsec.map&lt;br/&gt;&lt;em/&gt;&lt;/p&gt;&lt;p&gt; Transforms the result of the parser using the specified function&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs19&quot; readability=&quot;7&quot;&gt;val number : Parser&lt;p&gt;Full name: Write-your-own-excel.number&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs20&quot; readability=&quot;9&quot;&gt;val exprSetter : ParserSetter&lt;p&gt;Full name: Write-your-own-excel.exprSetter&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs21&quot; readability=&quot;7&quot;&gt;val expr : Parser&lt;p&gt;Full name: Write-your-own-excel.expr&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs22&quot; readability=&quot;9&quot;&gt;val slot : unit -&amp;gt; ParserSetter * Parser&lt;p&gt;Full name: Parsec.slot&lt;br/&gt;&lt;em/&gt;&lt;/p&gt;&lt;p&gt; Creates a delayed parser whose actual parser is set later&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs23&quot; readability=&quot;7&quot;&gt;val brack : Parser&lt;p&gt;Full name: Write-your-own-excel.brack&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs24&quot; readability=&quot;7&quot;&gt;val anySpace : Parser&lt;p&gt;Full name: Parsec.anySpace&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs25&quot; readability=&quot;7&quot;&gt;val term : Parser&lt;p&gt;Full name: Write-your-own-excel.term&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs26&quot; readability=&quot;7&quot;&gt;val binary : Parser&lt;p&gt;Full name: Write-your-own-excel.binary&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val l : Expr&lt;/p&gt;
&lt;p&gt;val op : char&lt;/p&gt;
&lt;p&gt;val r : Expr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs30&quot; readability=&quot;7&quot;&gt;val exprAux : Parser&lt;p&gt;Full name: Write-your-own-excel.exprAux&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;ParserSetter.Set: Parser&amp;lt;char,Expr&amp;gt; -&amp;gt; unit&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs32&quot; readability=&quot;7&quot;&gt;val formula : Parser&lt;p&gt;Full name: Write-your-own-excel.formula&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs33&quot; readability=&quot;7&quot;&gt;val equation : Parser&lt;p&gt;Full name: Write-your-own-excel.equation&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs34&quot; readability=&quot;9&quot;&gt;val parse : input:seq -&amp;gt; Expr option&lt;p&gt;Full name: Write-your-own-excel.parse&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val input : seq&amp;lt;char&amp;gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs36&quot; readability=&quot;7&quot;&gt;val run : Parser -&amp;gt; input:seq -&amp;gt; 'b option&lt;p&gt;Full name: Parsec.run&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs37&quot; readability=&quot;9&quot;&gt;val evaluate : cells:Map&amp;gt; -&amp;gt; expr:Expr -&amp;gt; int&lt;p&gt;Full name: Write-your-own-excel.evaluate&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val cells : Map&amp;lt;Position,#seq&amp;lt;char&amp;gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;val expr : Expr&lt;/p&gt;
&lt;p&gt;val num : int&lt;/p&gt;
&lt;p&gt;val ops : System.Collections.Generic.IDictionary&amp;lt;char,(int -&amp;gt; int -&amp;gt; int)&amp;gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs42&quot; readability=&quot;9&quot;&gt;val dict : keyValuePairs:seq -&amp;gt; System.Collections.Generic.IDictionary (requires equality)&lt;p&gt;Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.dict&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val l : int&lt;/p&gt;
&lt;p&gt;val r : int&lt;/p&gt;
&lt;p&gt;val pos : Position&lt;/p&gt;
&lt;p&gt;val parsed : Expr option&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs47&quot; readability=&quot;9&quot;&gt;val find : key:'Key -&amp;gt; table:Map -&amp;gt; 'T (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Map.find&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs48&quot; readability=&quot;7&quot;&gt;module Option&lt;p&gt;from Microsoft.FSharp.Core&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs49&quot; readability=&quot;9&quot;&gt;val get : option:'T option -&amp;gt; 'T&lt;p&gt;Full name: Microsoft.FSharp.Core.Option.get&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs50&quot; readability=&quot;9&quot;&gt;val evaluate : visited:Set -&amp;gt; cells:Map&amp;gt; -&amp;gt; expr:Expr -&amp;gt; int option&lt;p&gt;Full name: Write-your-own-excel.evaluate&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val visited : Set&amp;lt;Position&amp;gt;&lt;/p&gt;
&lt;p&gt;union case Option.Some: Value: 'T -&amp;gt; Option&amp;lt;'T&amp;gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs53&quot; readability=&quot;9&quot;&gt;val bind : binder:('T -&amp;gt; 'U option) -&amp;gt; option:'T option -&amp;gt; 'U option&lt;p&gt;Full name: Microsoft.FSharp.Core.Option.bind&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs54&quot; readability=&quot;9&quot;&gt;val map : mapping:('T -&amp;gt; 'U) -&amp;gt; option:'T option -&amp;gt; 'U option&lt;p&gt;Full name: Microsoft.FSharp.Core.Option.map&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs55&quot; readability=&quot;16&quot;&gt;Multiple items&lt;br/&gt;module Set&lt;p&gt;from Microsoft.FSharp.Collections&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Set&amp;lt;'T (requires comparison)&amp;gt; =&lt;br/&gt;  interface IComparable&lt;br/&gt;  interface IEnumerable&lt;br/&gt;  interface IEnumerable&amp;lt;'T&amp;gt;&lt;br/&gt;  interface ICollection&amp;lt;'T&amp;gt;&lt;br/&gt;  new : elements:seq&amp;lt;'T&amp;gt; -&amp;gt; Set&amp;lt;'T&amp;gt;&lt;br/&gt;  member Add : value:'T -&amp;gt; Set&amp;lt;'T&amp;gt;&lt;br/&gt;  member Contains : value:'T -&amp;gt; bool&lt;br/&gt;  override Equals : obj -&amp;gt; bool&lt;br/&gt;  member IsProperSubsetOf : otherSet:Set&amp;lt;'T&amp;gt; -&amp;gt; bool&lt;br/&gt;  member IsProperSupersetOf : otherSet:Set&amp;lt;'T&amp;gt; -&amp;gt; bool&lt;br/&gt;  ...&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Collections.Set&amp;lt;_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : elements:seq&amp;lt;'T&amp;gt; -&amp;gt; Set&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs56&quot; readability=&quot;9&quot;&gt;val contains : element:'T -&amp;gt; set:Set -&amp;gt; bool (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Set.contains&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case Option.None: Option&amp;lt;'T&amp;gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs58&quot; readability=&quot;9&quot;&gt;val tryFind : key:'Key -&amp;gt; table:Map -&amp;gt; 'T option (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Map.tryFind&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val value : #seq&amp;lt;char&amp;gt;&lt;/p&gt;
&lt;p&gt;val parsed : Expr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs61&quot; readability=&quot;9&quot;&gt;val add : value:'T -&amp;gt; set:Set -&amp;gt; Set (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Set.add&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;namespace Elmish&lt;/p&gt;
&lt;p&gt;namespace Elmish.React&lt;/p&gt;
&lt;p&gt;namespace Fable&lt;/p&gt;
&lt;p&gt;namespace Fable.Helpers&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs66&quot;&gt;module React&lt;p&gt;from Fable.Helpers&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs67&quot;&gt;module Props&lt;p&gt;from Fable.Helpers.React&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;namespace Fable.Core&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs69&quot;&gt;module JsInterop&lt;p&gt;from Fable.Core&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;namespace Fable.Import&lt;/p&gt;
&lt;p&gt;{ State : string }&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs72&quot; readability=&quot;27&quot;&gt;Multiple items&lt;br/&gt;module Event&lt;p&gt;from Microsoft.FSharp.Control&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Event&amp;lt;'T&amp;gt; =&lt;br/&gt;  new : unit -&amp;gt; Event&amp;lt;'T&amp;gt;&lt;br/&gt;  member Trigger : arg:'T -&amp;gt; unit&lt;br/&gt;  member Publish : IEvent&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Control.Event&amp;lt;_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Event&amp;lt;'Delegate,'Args (requires delegate and 'Delegate :&amp;gt; Delegate)&amp;gt; =&lt;br/&gt;  new : unit -&amp;gt; Event&amp;lt;'Delegate,'Args&amp;gt;&lt;br/&gt;  member Trigger : sender:obj * args:'Args -&amp;gt; unit&lt;br/&gt;  member Publish : IEvent&amp;lt;'Delegate,'Args&amp;gt;&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Control.Event&amp;lt;_,_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : unit -&amp;gt; Event&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : unit -&amp;gt; Event&amp;lt;'Delegate,'Args&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;EventOne | EventTwo&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs74&quot; readability=&quot;7&quot;&gt;type unit = Unit&lt;p&gt;Full name: Microsoft.FSharp.Core.unit&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs75&quot; readability=&quot;32&quot;&gt;Multiple items&lt;br/&gt;module Event&lt;p&gt;from Microsoft.FSharp.Control&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Event =&lt;br/&gt;  | UpdateValue of Position * string&lt;br/&gt;  | StartEdit of Position&lt;/p&gt;&lt;p&gt;Full name: Write-your-own-excel.Event&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Event&amp;lt;'T&amp;gt; =&lt;br/&gt;  new : unit -&amp;gt; Event&amp;lt;'T&amp;gt;&lt;br/&gt;  member Trigger : arg:'T -&amp;gt; unit&lt;br/&gt;  member Publish : IEvent&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Control.Event&amp;lt;_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Event&amp;lt;'Delegate,'Args (requires delegate and 'Delegate :&amp;gt; Delegate)&amp;gt; =&lt;br/&gt;  new : unit -&amp;gt; Event&amp;lt;'Delegate,'Args&amp;gt;&lt;br/&gt;  member Trigger : sender:obj * args:'Args -&amp;gt; unit&lt;br/&gt;  member Publish : IEvent&amp;lt;'Delegate,'Args&amp;gt;&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Control.Event&amp;lt;_,_&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : unit -&amp;gt; Event&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : unit -&amp;gt; Event&amp;lt;'Delegate,'Args&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case Event.UpdateValue: Position * string -&amp;gt; Event&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs77&quot; readability=&quot;11&quot;&gt;Multiple items&lt;br/&gt;union case CSSProp.Position: obj -&amp;gt; CSSProp&lt;p&gt;--------------------&lt;br/&gt;type Position = char * int&lt;/p&gt;&lt;p&gt;Full name: Write-your-own-excel.Position&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case Event.StartEdit: Position -&amp;gt; Event&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs79&quot; readability=&quot;9&quot;&gt;type State =&lt;br/&gt;  {Rows: int list;&lt;br/&gt;   Cols: char list;&lt;br/&gt;   Active: Position option;&lt;br/&gt;   Cells: Sheet;}&lt;p&gt;Full name: Write-your-own-excel.State&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;State.Rows: int list&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs81&quot; readability=&quot;7&quot;&gt;type 'T list = List&lt;p&gt;Full name: Microsoft.FSharp.Collections.list&amp;lt;_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;State.Cols: char list&lt;/p&gt;
&lt;p&gt;State.Active: Position option&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs84&quot; readability=&quot;13&quot;&gt;Multiple items&lt;br/&gt;val option : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.option&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type 'T option = Option&amp;lt;'T&amp;gt;&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.option&amp;lt;_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;State.Cells: Sheet&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs86&quot; readability=&quot;9&quot;&gt;val update : msg:Event -&amp;gt; state:State -&amp;gt; State * Cmd&lt;p&gt;Full name: Write-your-own-excel.update&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val msg : Event&lt;/p&gt;
&lt;p&gt;val state : State&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs89&quot; readability=&quot;7&quot;&gt;Multiple items&lt;br/&gt;module Cmd&lt;p&gt;from Elmish&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Cmd&amp;lt;'msg&amp;gt; = Sub&amp;lt;'msg&amp;gt; list&lt;/p&gt;&lt;p&gt;Full name: Elmish.Cmd&amp;lt;_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs90&quot; readability=&quot;7&quot;&gt;val none : Cmd&lt;p&gt;Full name: Elmish.Cmd.none&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val value : string&lt;/p&gt;
&lt;p&gt;val newCells : Map&amp;lt;Position,string&amp;gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs93&quot; readability=&quot;9&quot;&gt;val add : key:'Key -&amp;gt; value:'T -&amp;gt; table:Map -&amp;gt; Map (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Map.add&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs94&quot; readability=&quot;9&quot;&gt;val renderView : trigger:(Event -&amp;gt; unit) -&amp;gt; char * int -&amp;gt; value:string option -&amp;gt; React.ReactElement&lt;p&gt;Full name: Write-your-own-excel.renderView&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val trigger : (Event -&amp;gt; unit)&lt;/p&gt;
&lt;p&gt;val value : string option&lt;/p&gt;
&lt;p&gt;val color : string&lt;/p&gt;
&lt;p&gt;property Option.IsNone: bool&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs99&quot; readability=&quot;9&quot;&gt;val td : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.td&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case HTMLAttr.Style: CSSProp list -&amp;gt; HTMLAttr&lt;/p&gt;
&lt;p&gt;union case CSSProp.Background: obj -&amp;gt; CSSProp&lt;/p&gt;
&lt;p&gt;union case DOMAttr.OnClick: (React.MouseEvent -&amp;gt; unit) -&amp;gt; DOMAttr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs103&quot; readability=&quot;9&quot;&gt;val str : s:string -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.str&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs104&quot; readability=&quot;9&quot;&gt;val defaultArg : arg:'T option -&amp;gt; defaultValue:'T -&amp;gt; 'T&lt;p&gt;Full name: Microsoft.FSharp.Core.Operators.defaultArg&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs105&quot; readability=&quot;9&quot;&gt;val renderEditor : trigger:(Event -&amp;gt; unit) -&amp;gt; char * int -&amp;gt; value:string -&amp;gt; React.ReactElement&lt;p&gt;Full name: Write-your-own-excel.renderEditor&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs106&quot; readability=&quot;13&quot;&gt;Multiple items&lt;br/&gt;union case HTMLAttr.Class: string -&amp;gt; HTMLAttr&lt;p&gt;--------------------&lt;br/&gt;type ClassAttribute =&lt;br/&gt;  inherit Attribute&lt;br/&gt;  new : unit -&amp;gt; ClassAttribute&lt;/p&gt;&lt;p&gt;Full name: Microsoft.FSharp.Core.ClassAttribute&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;new : unit -&amp;gt; ClassAttribute&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs107&quot; readability=&quot;9&quot;&gt;val input : b:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.input&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case HTMLAttr.AutoFocus: bool -&amp;gt; HTMLAttr&lt;/p&gt;
&lt;p&gt;union case DOMAttr.OnInput: (React.FormEvent -&amp;gt; unit) -&amp;gt; DOMAttr&lt;/p&gt;
&lt;p&gt;val e : React.FormEvent&lt;/p&gt;
&lt;p&gt;property React.SyntheticEvent.target: Browser.EventTarget&lt;/p&gt;
&lt;p&gt;union case HTMLAttr.Value: string -&amp;gt; HTMLAttr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs113&quot; readability=&quot;9&quot;&gt;val renderCell : trigger:(Event -&amp;gt; unit) -&amp;gt; char * int -&amp;gt; state:State -&amp;gt; React.ReactElement&lt;p&gt;Full name: Write-your-own-excel.renderCell&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val text : string option&lt;/p&gt;
&lt;p&gt;val input : string&lt;/p&gt;
&lt;p&gt;val result : string option&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs117&quot; readability=&quot;9&quot;&gt;val empty : Set (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Set.empty&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs118&quot; readability=&quot;9&quot;&gt;val view : state:State -&amp;gt; trigger:(Event -&amp;gt; unit) -&amp;gt; React.ReactElement&lt;p&gt;Full name: Write-your-own-excel.view&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs119&quot; readability=&quot;9&quot;&gt;val table : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.table&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs120&quot; readability=&quot;9&quot;&gt;val thead : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.thead&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs121&quot; readability=&quot;9&quot;&gt;val tr : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.tr&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs122&quot; readability=&quot;9&quot;&gt;val th : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.th&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val col : char&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs124&quot; readability=&quot;9&quot;&gt;val tbody : b:seq -&amp;gt; c:seq -&amp;gt; React.ReactElement&lt;p&gt;Full name: Fable.Helpers.React.tbody&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;val row : int&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs126&quot; readability=&quot;9&quot;&gt;val initial : unit -&amp;gt; State * Sub list&lt;p&gt;Full name: Write-your-own-excel.initial&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;union case HTMLAttr.Cols: float -&amp;gt; HTMLAttr&lt;/p&gt;
&lt;p&gt;union case HTMLAttr.Rows: float -&amp;gt; HTMLAttr&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs129&quot; readability=&quot;9&quot;&gt;val empty : Map (requires comparison)&lt;p&gt;Full name: Microsoft.FSharp.Collections.Map.empty&lt;/p&gt;&lt;/div&gt;
&lt;p&gt;property List.Empty: Sub&amp;lt;'msg&amp;gt; list&lt;/p&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs131&quot; readability=&quot;20&quot;&gt;Multiple items&lt;br/&gt;module Program&lt;p&gt;from Elmish.React&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;module Program&lt;/p&gt;&lt;p&gt;from Elmish&lt;/p&gt;&lt;p&gt;--------------------&lt;br/&gt;type Program&amp;lt;'arg,'model,'msg,'view&amp;gt; =&lt;br/&gt;  {init: 'arg -&amp;gt; 'model * Cmd&amp;lt;'msg&amp;gt;;&lt;br/&gt;   update: 'msg -&amp;gt; 'model -&amp;gt; 'model * Cmd&amp;lt;'msg&amp;gt;;&lt;br/&gt;   subscribe: 'model -&amp;gt; Cmd&amp;lt;'msg&amp;gt;;&lt;br/&gt;   view: 'model -&amp;gt; Dispatch&amp;lt;'msg&amp;gt; -&amp;gt; 'view;&lt;br/&gt;   setState: 'model -&amp;gt; Dispatch&amp;lt;'msg&amp;gt; -&amp;gt; unit;&lt;br/&gt;   onError: string * exn -&amp;gt; unit;}&lt;/p&gt;&lt;p&gt;Full name: Elmish.Program&amp;lt;_,_,_,_&amp;gt;&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs132&quot; readability=&quot;10&quot;&gt;val mkProgram : init:('arg -&amp;gt; 'model * Cmd) -&amp;gt; update:('msg -&amp;gt; 'model -&amp;gt; 'model * Cmd) -&amp;gt; view:('model -&amp;gt; Dispatch -&amp;gt; 'view) -&amp;gt; Program&lt;p&gt;Full name: Elmish.Program.mkProgram&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs133&quot; readability=&quot;9&quot;&gt;val withReact : placeholderId:string -&amp;gt; program:Program -&amp;gt; Program&lt;p&gt;Full name: Elmish.React.Program.withReact&lt;/p&gt;&lt;/div&gt;
&lt;div class=&quot;tip&quot; id=&quot;fs134&quot; readability=&quot;9&quot;&gt;val run : program:Program -&amp;gt; unit&lt;p&gt;Full name: Elmish.Program.run&lt;/p&gt;&lt;/div&gt;

</description>
<pubDate>Sun, 25 Aug 2019 07:08:11 +0000</pubDate>
<dc:creator>eDameXxX</dc:creator>
<og:title>Write your own Excel in 100 lines of F#</og:title>
<og:type>article</og:type>
<og:url>http://tomasp.net/blog/2018/write-your-own-excel/</og:url>
<og:image>http://tomasp.net/blog/2018/write-your-own-excel/logo.png</og:image>
<og:description>Use Fable, Elmish architecture, parser combinators and the magic of functional-first programming with F# to build a simple browser-based spreadsheet application! I have been teaching F# for 7 years now and while the libraries and examples change, the core ideas remain the same. In this blog post, I'll cover my latest favorite example. You will see how the pragmatic F# design makes it easy to integrate with the external world (such as the JavaScript ecosystem and the React library) and how the core functional features make your code elegant and composable.</og:description>
<dc:format>text/html</dc:format>
<dc:identifier>http://tomasp.net/blog/2018/write-your-own-excel/</dc:identifier>
</item>
<item>
<title>Using Backblaze B2 and Cloudflare Workers for free image hosting</title>
<link>https://blog.jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</link>
<guid isPermaLink="true" >https://blog.jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</guid>
<description>&lt;p&gt;When communicating with people online, it’s very common to share images or screenshots of what you’re working on, or even screen recordings, gifs, and other media. Traditionally, you can upload or paste these directly into the applications like Slack or Discord, but if you want to re-share that with another person, the process can be tedious. Alternatively, you could upload the media to a site like Imgur or Gyazo, but these sites are often plagued with advertisements, or compress your content causing quality reduction.&lt;/p&gt;
&lt;p&gt;Setting up your own image hosting is very easy, and by following this tutorial, you can do it for &lt;em&gt;free&lt;/em&gt; (within some very generous limits). Fun fact: every image you see in this post is hosted using this method.&lt;/p&gt;
&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;
&lt;h3 id=&quot;sharex&quot;&gt;ShareX&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://getsharex.com/&quot;&gt;ShareX&lt;/a&gt; is a fantastic tool for Windows that enables screen capture, file sharing, and much more.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/a86e2cc3-7184-4f7d-a3ab-4add4f50b034.png&quot; class=&quot;kg-image&quot;/&gt;ShareX Example
&lt;p&gt;ShareX integrates with many services like the previously mentioned Imgur, standard protocols like SFTP, as well as services like Amazon AWS S3 and Backblaze B2. ShareX’s capabilities are extremely extensive so I won’t go into all of its features today, but it’ll be a large component in this tutorial.&lt;br/&gt;&lt;/p&gt;
&lt;h3 id=&quot;backblaze-b2&quot;&gt;Backblaze B2&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://www.backblaze.com/b2/cloud-storage.html&quot;&gt;Backblaze B2&lt;/a&gt; is a cloud storage solution similar to Amazon AWS S3, but at a fraction of the cost. The first 10GB of storage are entirely free, which is what we’ll be using for this tutorial.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/e362de47-bf9b-4f1b-8007-6018b0ae9849.png&quot; class=&quot;kg-image&quot;/&gt;Backblaze B2 example dashboard
&lt;p&gt;Traditionally, like with a service such as AWS S3, you’d have to pay for bandwidth fees on the content being served which is generally the highest portion of your costs. Thanks to the &lt;a href=&quot;https://www.cloudflare.com/bandwidth-alliance/&quot;&gt;Bandwidth Alliance&lt;/a&gt; though, egress between Backblaze and Cloudflare is entirely free, which we’ll be making heavy use of. If you're interested in learning more about the Bandwidth Alliance, check out Cloudflare's site, or the case studies my company &lt;a href=&quot;https://nodecraft.com/&quot;&gt;Nodecraft&lt;/a&gt; did with both &lt;a href=&quot;https://www.cloudflare.com/case-studies/nodecraft-bandwidth-alliance/&quot;&gt;Cloudflare&lt;/a&gt; and &lt;a href=&quot;https://www.backblaze.com/b2/case-studies/nodecraft.html&quot;&gt;Backblaze&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;cloudflare&quot;&gt;Cloudflare&lt;/h3&gt;
&lt;p&gt;I always have a hard time describing exactly what &lt;a href=&quot;https://www.cloudflare.com/&quot;&gt;Cloudflare&lt;/a&gt; do, but they, as per their website are “one of the world’s largest networks. Today, businesses, non-profits, bloggers, and anyone with an Internet presence boast faster, more secure websites and apps”. Specifically in this tutorial, we’ll be using their CDN product, DNS, and then additionally &lt;a href=&quot;https://www.cloudflare.com/products/cloudflare-workers/&quot;&gt;Cloudflare Workers&lt;/a&gt; for extra cool-ness by rewriting some URLs.&lt;br/&gt;&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/94b5fd5f-ec3e-4b42-9811-32d790d83272.png&quot; class=&quot;kg-image&quot;/&gt;Cloudflare example dashboard
&lt;h2 id=&quot;tutorial&quot;&gt;Tutorial&lt;/h2&gt;
&lt;p&gt;All you need before getting started is an owned domain, and a chosen subdomain you wish to use your file hosting.&lt;/p&gt;
&lt;h3 id=&quot;backblaze-b2-bucket-creation&quot;&gt;Backblaze B2 Bucket Creation&lt;/h3&gt;
&lt;p&gt;Firstly, you’ll want to &lt;a href=&quot;https://www.backblaze.com/b2/sign-up.html&quot;&gt;register an account&lt;/a&gt; for Backblaze’s B2 storage. This will be where we're storing all of our media using their free 10GB of storage. Once registered, from their dashboard's &quot;Buckets&quot; UI, hit &quot;Create a Bucket&quot;.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/64e4d6f3-902b-4810-877a-0827287f8ee2.png&quot; class=&quot;kg-image&quot;/&gt;Create a Backblaze B2 Bucket
&lt;p&gt;Bucket names are unique so you may need to use a little creativity, but for my purposes, I'll be using &lt;code&gt;jross-files&lt;/code&gt;. &lt;em&gt;Be sure to set the bucket to &lt;strong&gt;&lt;em&gt;public&lt;/em&gt;&lt;/strong&gt; - we want people to be able to see our uploaded screenshots and other media!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;With the bucket created, head to the &quot;App keys&quot; section of the UI, and click &quot;Add a New Application Key&quot;. This information is what we'll use in ShareX to authenticate with Backblaze and upload our media.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/5f434051-24a3-4983-bc08-f1c7a5b7509f.png&quot; class=&quot;kg-image&quot;/&gt;Add Application Key for Backblaze B2 Cloud Storage
&lt;p&gt;Give your key a name such as &lt;code&gt;sharex-uploader&lt;/code&gt;, and I'd recommend restricting it to your previously created bucket. This isn't required, but is good practice for security. Leave the type of access as &quot;Read and Write&quot;, and don't fill in the File name prefix, or Duration as these fields aren't relevant for our use-case.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/54b988c9-b664-4056-9236-c09b32c8154a.png&quot; class=&quot;kg-image&quot;/&gt;Successfully generated Backblaze B2 Application Key
&lt;p&gt;With your key successfully generated, note down the &lt;code&gt;keyID&lt;/code&gt; and &lt;code&gt;applicationKey&lt;/code&gt; in a secure place such as your password manager. &lt;em&gt;You won't be able to retrieve the &lt;code&gt;applicationKey&lt;/code&gt; after this point, so make sure it's saved&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Finally on Backblaze's side, head back to the &quot;Buckets&quot; UI, and click &quot;Upload/Download&quot; on the bucket you just created. Upload a temporary test file to your bucket (such as &lt;code&gt;test.txt&lt;/code&gt;) and hit the &quot;i&quot; on the file you just uploaded. This is used to gather some information about where exactly your bucket is hosted for the next steps.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/39f1bb74-eeef-4bff-9cb0-37c3a0b49cee.png&quot; class=&quot;kg-image&quot;/&gt;Example uploaded file information in a Backblaze B2 Bucket
&lt;p&gt;As the screenshot above shows, our file is hosted at &lt;a href=&quot;https://f002.backblazeb2.com/file/jross-files/test.txt&quot;&gt;&lt;code&gt;https://f002.backblazeb2.com/&lt;/code&gt;&lt;/a&gt; - keep note of this domain as it will be useful in just a moment.&lt;/p&gt;
&lt;h3 id=&quot;cloudflare-dns&quot;&gt;Cloudflare DNS&lt;/h3&gt;
&lt;p&gt;Next, head on over to &lt;a href=&quot;https://www.cloudflare.com/&quot;&gt;Cloudflare&lt;/a&gt; and either login to your account, or create a new account. &lt;em&gt;You will need an active domain in your Cloudflare account before continuing, so follow their wizard to get your first domain added to their platform&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;With your chosen domain and subdomain, create a DNS CNAME record pointing at the previously discovered &lt;code&gt;fxxx.backblazeb2.com&lt;/code&gt; URL.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/c6d34af6-870a-45cf-b7e8-d58b09d4e4be.png&quot; class=&quot;kg-image&quot;/&gt;Cloudflare DNS record for Backblaze B2
&lt;p&gt;As per the record above, I've chosen &lt;code&gt;files.jross.me&lt;/code&gt; for my subdomain, and pointed it towards &lt;code&gt;f002.backblazeb2.com&lt;/code&gt;. Ensure that the Cloudflare orange shield is enabled, and the request is proxied. The default Cloudflare auto TTL is fine for our use-case.&lt;/p&gt;
&lt;p&gt;Backblaze have a &lt;a href=&quot;https://help.backblaze.com/hc/en-us/articles/217666928-Using-Backblaze-B2-with-the-Cloudflare-CDN&quot;&gt;help article&lt;/a&gt; on their site which has a few more tips for configuring Cloudflare with Backblaze B2, and some instructions for creating a couple of page rules to ensure your domain can only be used to retrieve files from your bucket. I'd recommend following these instructions before deploying this in production. &lt;em&gt;I'd heavily recommend adding a page-rule to set the &quot;cache level&quot; to &quot;everything&quot;, and &quot;edge cache TTL&quot; to a higher value like 7 days if your files aren't often changing&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Test if you can access the file you previously uploaded by visiting &lt;code&gt;https://subdomain.domain.com/file/&amp;lt;bucket-name&amp;gt;/test.txt&lt;/code&gt;. If you see your file, you're good to continue!&lt;/p&gt;
&lt;h3 id=&quot;sharex-configuration&quot;&gt;ShareX Configuration&lt;/h3&gt;
&lt;p&gt;The following steps will show you how to configure ShareX to upload to your B2 Bucket. As ShareX is Windows only, you may need to find an alternate uploader (or simply use the B2 upload web UI) if you're using another platform.&lt;/p&gt;
&lt;p&gt;After installing &lt;a href=&quot;https://getsharex.com/&quot;&gt;ShareX&lt;/a&gt;, there's a lot of available configuration options that may seem overwhelming initially.&lt;/p&gt;
&lt;p&gt;Firstly, let's configure the Backblaze B2 destination with our credentials. From the main ShareX window, click &quot;Destinations -&amp;gt; Destination Settings&quot;.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/file/jross-files/2019/08/f7ea2af2-725f-4ed2-9110-2237451bfd2a.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Fill in your Application Key ID and Application Key (secret) as we previously saved, and if you didn't specify a specific bucket for your application key, you'll also have to fill in the bucket name.&lt;/p&gt;
&lt;p&gt;For the custom URL, you'll want to set this to your subdomain you previously decided, delimited with &lt;code&gt;/file/&amp;lt;bucket-name&amp;gt;&lt;/code&gt;, like &lt;code&gt;https://subdomain.domain.com/file/&amp;lt;bucket-name&amp;gt;/&lt;/code&gt;. ShareX will fill the rest of the URL as you'll see in the preview box below.&lt;/p&gt;
&lt;p&gt;The &quot;Upload path&quot; dictates exactly where screenshots will be saved in B2. In the example above, I'm using &lt;code&gt;%y/%mo/&lt;/code&gt; which will result in files being saved in folders such as &lt;code&gt;/2019/08&lt;/code&gt; for the year and month. There's many other formatters ShareX supports such as randomised folder names, numbers, more specific time formats, etc. but I find that year and month works well for my use-case.&lt;/p&gt;
&lt;p&gt;After completing your Backblaze B2 credentials, close out the destinations settings and head back to the main ShareX window. Once again, hover over the &quot;Destinations&quot; menu, but this time, set each of the &quot;Image uploader&quot;, &quot;Text uploader&quot;, and &quot;File uploader&quot; options to &quot;Backblaze B2&quot;, if you wish for all of these media types to land in your B2 bucket.&lt;/p&gt;
&lt;h3 id=&quot;testing&quot;&gt;Testing&lt;/h3&gt;
&lt;p&gt;Now it's time to use ShareX and upload an image! From the Windows Task Bar, right click on the ShareX icon, click &quot;Capture&quot;, and then click &quot;Fullscreen&quot;. If you did everything correctly, ShareX should take a few seconds to process your image, and then upload to your B2 Bucket, and return the URL to you.&lt;/p&gt;
&lt;p&gt;You can setup hotkeys from within ShareX via the &quot;Hotkey settings&quot; to caption specific regions, monitors, active windows, etc. as well as screen recordings, gif records, and a lot more. I use &lt;code&gt;CTRL + SHIFT + 2&lt;/code&gt; to do a full-screen capture, &lt;code&gt;CTRL + SHIFT + 4&lt;/code&gt; to do a region capture, and then &lt;code&gt;CTRL + SHIFT + 5&lt;/code&gt; to do a region capture, and then edit the image briefly to add highlights, blurs, etc. ShareX is very powerful if you spend some time navigating its menus, and can become an amazing asset to your workflow... maybe I'll do another blog post in the future about some of the tips and tricks with ShareX I've discovered over the years.&lt;/p&gt;
&lt;h3 id=&quot;cloudflare-workers&quot;&gt;Cloudflare Workers&lt;/h3&gt;
&lt;p&gt;Technically, everything should already be working at this point and you shouldn't need to do anything else if you want a basic image setup. For some extra cool-ness though, we can use Cloudflare Workers to rewrite the upload URLs to something a little more friendly, and strip the unnecessary &lt;code&gt;/file/&amp;lt;bucket-name&amp;gt;/&lt;/code&gt; from the URL. For example, &lt;code&gt;https://subdomain.domain.com/file/&amp;lt;bucket-name&amp;gt;/test.txt&lt;/code&gt; would become &lt;code&gt;https://subdomain.domain.com/test.txt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Cloudflare Workers allow you to run JavaScript code on the edge of Cloudflare's network, enabling developers to build serverless applications that scale. For the worker we want to deploy, our goals are as follows:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Remove the &lt;code&gt;/file/&amp;lt;bucket-name&amp;gt;&lt;/code&gt; part of the URL&lt;/li&gt;
&lt;li&gt;Remove some unecessary headers returned by Backblaze B2 assets&lt;/li&gt;
&lt;li&gt;Add basic CORS headers to allow embedding of images on external sites&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;From your domain in Cloudflare, create a new worker script.&lt;/p&gt;
&lt;p&gt;The following code I use in my worker. Simple tweak the &lt;code&gt;domain&lt;/code&gt; and &lt;code&gt;bucket&lt;/code&gt; variables at the top of the file with the domain this is hosted on, and the bucket name.&lt;/p&gt;
&lt;pre&gt;
&lt;code class=&quot;language-javascript&quot;&gt;const b2Domain = 'files.jross.me';
const b2Bucket = 'jross-files';

const b2UrlPath = `/file/${b2Bucket}/`;
addEventListener('fetch', event =&amp;gt; {
        return event.respondWith(fileReq(event));
});

// define the file extensions we wish to add basic access control headers to
const corsFileTypes = ['png', 'jpg', 'gif', 'jpeg',  'webp'];

// backblaze returns some additional headers that are useful for debugging, but unecessary in production. We can remove these to save some size
const removeHeaders = [
  'x-bz-content-sha1',
  'x-bz-file-id',
  'x-bz-file-name',
  'x-bz-info-src_last_modified_millis',
  'X-Bz-Upload-Timestamp'
];
async function fileReq(event){
        const url = new URL(event.request.url);
        if(url.host === b2Domain &amp;amp;&amp;amp; !url.pathname.startsWith(b2UrlPath)){
                url.pathname = b2UrlPath + url.pathname;
        }
        // fetch image, apply Cloudflare lossless compression
        const response = await fetch(url, {cf: {polish: &quot;lossless&quot;}});
        let newHdrs = new Headers(response.headers);
        if(corsFileTypes.includes(url.pathname.split('.').pop())){
                newHdrs.set('Access-Control-Allow-Origin', '*');
        }
        removeHeaders.forEach((header) =&amp;gt; {
                newHdrs.delete(header);
        });

        return new Response(response.body, {
                status: response.status,
                statusText: response.statusText,
                headers: newHdrs
        });
}&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Using this worker, you can now strip the &lt;code&gt;/file/&amp;lt;bucket-name&amp;gt;/&lt;/code&gt; section of the URL, to produce URLs like &lt;code&gt;https://subdomain.domain.com/test.txt&lt;/code&gt;, rather than &lt;code&gt;https://subdomain.domain.com/file/&amp;lt;bucket-name&amp;gt;/test.txt&lt;/code&gt;. Once you've deployed this worker to your subdomain &lt;code&gt;subdomain.domain.com/*&lt;/code&gt;, test that the new URLs are working, and once you're happy, simply update the B2 destination settings in ShareX to use your new custom URL format.&lt;/p&gt;
&lt;img src=&quot;https://files.jross.me/2019/08/3c653f4a-2298-40b0-a4a9-a2e5bbde685c.png&quot; class=&quot;kg-image&quot;/&gt;ShareX Backblaze B2 Custom URL format
&lt;h2 id=&quot;disclaimer&quot;&gt;Disclaimer&lt;/h2&gt;
&lt;p&gt;Everything I've mentioned in the post is 100% free, assuming you stay within reasonable limits.&lt;/p&gt;
&lt;p&gt;Backblaze has a 10GB free file limit, and then charges $0.005/GB/Month thereafter. It also offers a limited number of Class &quot;B&quot; and &quot;C&quot; transactions, with 2500 free of these per day. You probably won't use any Class C transactions, but Class B transactions are used for &lt;code&gt;b2_download_file_by_name&lt;/code&gt; requests, which is why I'd recommend caching the responses on Cloudflare for as long as you can, to prevent unnecessary B2 API requests. For more information on their transaction pricing, see &lt;a href=&quot;https://www.backblaze.com/b2/b2-transactions-price.html&quot;&gt;their website&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Cloudflare offers a free plan to all users that will almost certainly provide what you need for the DNS and CDN aspects of this tutorial.&lt;/p&gt;
&lt;p&gt;Cloudflare Workers also offers a free tier which includes 100,00 requests every 24 hours, with a maximum of 1,000 requests every 10 minutes. If you're just sharing these images to friends and colleagues, you'll probably be fine. See &lt;a href=&quot;https://support.cloudflare.com/hc/en-us/articles/360001657552-Billing-for-Cloudflare-Workers-and-Workers-KV&quot;&gt;Billing for Cloudflare Workers&lt;/a&gt; for more information.&lt;/p&gt;
&lt;p&gt;If you have any questions, feel free to reach out to me on &lt;a href=&quot;https://twitter.com/cherryjimbo&quot;&gt;Twitter&lt;/a&gt;.&lt;/p&gt;
</description>
<pubDate>Sun, 25 Aug 2019 01:53:29 +0000</pubDate>
<dc:creator>CherryJimbo</dc:creator>
<og:type>article</og:type>
<og:title>Using Backblaze B2 and Cloudflare Workers for free image hosting</og:title>
<og:description>Learn how to setup your own, free image hosting using Backblaze B2 and Cloudflare Workers.</og:description>
<og:url>https://blog.jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</og:url>
<og:image>https://blog.jross.me/content/images/2019/08/backblaze-b2-cloudflare-workers-free-image-hosting-share-6.png</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://blog.jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</dc:identifier>
</item>
<item>
<title>Ha-ha wall</title>
<link>https://en.wikipedia.org/wiki/Ha-ha</link>
<guid isPermaLink="true" >https://en.wikipedia.org/wiki/Ha-ha</guid>
<description>&lt;a class=&quot;mw-jump-link&quot; href=&quot;https://en.wikipedia.org/wiki/Ha-ha#mw-head&quot;&gt;Jump to navigation&lt;/a&gt;
		&lt;a class=&quot;mw-jump-link&quot; href=&quot;https://en.wikipedia.org/wiki/Ha-ha#p-search&quot;&gt;Jump to search&lt;/a&gt;
		&lt;div id=&quot;mw-content-text&quot; lang=&quot;en&quot; dir=&quot;ltr&quot; class=&quot;mw-content-ltr&quot;&gt;&lt;div class=&quot;mw-parser-output&quot;&gt;&lt;div role=&quot;note&quot; class=&quot;hatnote navigation-not-searchable&quot;&gt;For other uses, see &lt;a href=&quot;https://en.wikipedia.org/wiki/Haha_(disambiguation)&quot; class=&quot;mw-redirect mw-disambig&quot; title=&quot;Haha (disambiguation)&quot;&gt;Haha&lt;/a&gt;.&lt;/div&gt;
&lt;div class=&quot;thumb tright&quot;&gt;&lt;div class=&quot;thumbinner&quot; style=&quot;width:222px;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Ha_ha_wall_diagram.jpg&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Ha_ha_wall_diagram.jpg/220px-Ha_ha_wall_diagram.jpg&quot; decoding=&quot;async&quot; width=&quot;220&quot; height=&quot;220&quot; class=&quot;thumbimage&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Ha_ha_wall_diagram.jpg/330px-Ha_ha_wall_diagram.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Ha_ha_wall_diagram.jpg/440px-Ha_ha_wall_diagram.jpg 2x&quot; data-file-width=&quot;845&quot; data-file-height=&quot;846&quot;/&gt;&lt;/a&gt;  &lt;div class=&quot;thumbcaption&quot;&gt;A comparison of a ha-ha and a typical wall&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A &lt;b&gt;ha-ha&lt;/b&gt; (&lt;a href=&quot;https://en.wikipedia.org/wiki/French_language&quot; title=&quot;French language&quot;&gt;French&lt;/a&gt;: &lt;i lang=&quot;fr&quot;&gt;&lt;b&gt;hâ-hâ&lt;/b&gt; or &lt;b&gt;saut de loup&lt;/b&gt;&lt;/i&gt;) is a recessed landscape design element that creates a vertical barrier while preserving an uninterrupted view of the landscape beyond.
&lt;/p&gt;&lt;p&gt;The design includes a &lt;a href=&quot;https://en.wikipedia.org/wiki/Sod&quot; title=&quot;Sod&quot;&gt;turfed&lt;/a&gt; incline which slopes downward to a sharply vertical face (typically a masonry &lt;a href=&quot;https://en.wikipedia.org/wiki/Retaining_wall&quot; title=&quot;Retaining wall&quot;&gt;retaining wall&lt;/a&gt;). Ha-has are used in landscape design to prevent access to a garden, for example by grazing livestock, without obstructing views.  In security design, the element is used to deter vehicular access to a site while minimizing visual obstruction.
&lt;/p&gt;&lt;p&gt;The name &quot;ha-ha&quot; is thought to have stemmed from the exclamations of surprise by those coming across them, as the walls were intentionally designed to be invisible.&lt;sup id=&quot;cite_ref-1&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-1&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;


&lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Origins&quot;&gt;Origins&lt;/span&gt;&lt;/h2&gt;
&lt;div class=&quot;thumb tright&quot;&gt;&lt;div class=&quot;thumbinner&quot; style=&quot;width:222px;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Scotland-2016-West_Lothian-Hopetoun_House_02.jpg&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Scotland-2016-West_Lothian-Hopetoun_House_02.jpg/220px-Scotland-2016-West_Lothian-Hopetoun_House_02.jpg&quot; decoding=&quot;async&quot; width=&quot;220&quot; height=&quot;147&quot; class=&quot;thumbimage&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Scotland-2016-West_Lothian-Hopetoun_House_02.jpg/330px-Scotland-2016-West_Lothian-Hopetoun_House_02.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Scotland-2016-West_Lothian-Hopetoun_House_02.jpg/440px-Scotland-2016-West_Lothian-Hopetoun_House_02.jpg 2x&quot; data-file-width=&quot;6119&quot; data-file-height=&quot;4079&quot;/&gt;&lt;/a&gt;  &lt;div class=&quot;thumbcaption&quot;&gt;Ha-ha protecting the lawn at &lt;a href=&quot;https://en.wikipedia.org/wiki/Hopetoun_House&quot; title=&quot;Hopetoun House&quot;&gt;Hopetoun House&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/West_Lothian&quot; title=&quot;West Lothian&quot;&gt;West Lothian&lt;/a&gt;, Scotland. Note how the wall disappears from view as it curves away to the left of the picture.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Before mechanical lawn mowers, a common way to keep large areas of grassland trimmed was to allow livestock, usually sheep, to graze the grass. A ha-ha prevented grazing animals on large estates from gaining access to the lawn and gardens adjoining the house, giving a continuous vista to create the illusion that the garden and landscape were one and undivided.&lt;sup id=&quot;cite_ref-2&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-2&quot;&gt;[2]&lt;/a&gt;&lt;/sup&gt;&lt;sup id=&quot;cite_ref-3&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-3&quot;&gt;[3]&lt;/a&gt;&lt;/sup&gt;&lt;sup id=&quot;cite_ref-4&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-4&quot;&gt;[4]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The basic design of sunken ditches is of ancient origin, being a feature of &lt;a href=&quot;https://en.wikipedia.org/wiki/Deer_park_(England)&quot; title=&quot;Deer park (England)&quot;&gt;deer parks&lt;/a&gt; in England. The deer-leap or &lt;i&gt;saltatorium&lt;/i&gt; consisted of a ditch with one steep side surmounted by a pale (picket-style fence made of wooden stakes) or hedge, which allowed deer to enter the park but not to leave. Since the time of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Norman_conquest_of_England&quot; title=&quot;Norman conquest of England&quot;&gt;Norman conquest of England&lt;/a&gt; the right to construct a deer-leap was granted by the king, with reservations made as to the depth of the foss or ditch and the height of the pale or hedge.&lt;sup id=&quot;cite_ref-5&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-5&quot;&gt;[5]&lt;/a&gt;&lt;/sup&gt; On Dartmoor the deer-leap was known as a &quot;leapyeat&quot;.&lt;sup id=&quot;cite_ref-6&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-6&quot;&gt;[6]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;div class=&quot;thumb tright&quot;&gt;&lt;div class=&quot;thumbinner&quot; style=&quot;width:172px;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Ha-ha.jpg&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/Ha-ha.jpg/170px-Ha-ha.jpg&quot; decoding=&quot;async&quot; width=&quot;170&quot; height=&quot;231&quot; class=&quot;thumbimage&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/6/68/Ha-ha.jpg/255px-Ha-ha.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/68/Ha-ha.jpg/340px-Ha-ha.jpg 2x&quot; data-file-width=&quot;1872&quot; data-file-height=&quot;2540&quot;/&gt;&lt;/a&gt;  &lt;div class=&quot;thumbcaption&quot;&gt;Ha-ha at the &lt;a href=&quot;https://en.wikipedia.org/wiki/Hameau_de_la_Reine&quot; title=&quot;Hameau de la Reine&quot;&gt;Hameau de la Reine&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/Palace_of_Versailles&quot; title=&quot;Palace of Versailles&quot;&gt;Versailles&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The concept of the ha-ha is of French origin, with the term being attested in toponyms in &lt;a href=&quot;https://en.wikipedia.org/wiki/New_France&quot; title=&quot;New France&quot;&gt;New France&lt;/a&gt; from 1686 (as seen today in &lt;a href=&quot;https://en.wikipedia.org/wiki/Saint-Louis-du-Ha!_Ha!&quot; title=&quot;Saint-Louis-du-Ha! Ha!&quot;&gt;Saint-Louis-du-Ha! Ha!&lt;/a&gt;), and being a feature of the gardens of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Château_de_Meudon&quot; title=&quot;Château de Meudon&quot;&gt;Château de Meudon&lt;/a&gt;, circa 1700. The technical innovation was presented in &lt;a href=&quot;https://en.wikipedia.org/wiki/Dezallier_d%27Argenville&quot; title=&quot;Dezallier d'Argenville&quot;&gt;Dezallier d'Argenville&lt;/a&gt;'s &lt;i&gt;La théorie et la pratique du jardinage&lt;/i&gt; (1709), which the architect &lt;a href=&quot;https://en.wikipedia.org/wiki/John_James_(architect)&quot; title=&quot;John James (architect)&quot;&gt;John James&lt;/a&gt; (1712) translated into English:
&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Grills of iron are very necessary ornaments in the lines of walks, to extend the view, and to show the country to advantage. At present we frequently make thoroughviews, called Ah, Ah, which are openings in the walls, without grills, to the very level of the walks, with a large and deep ditch at the foot of them, lined on both sides to sustain the earth, and prevent the getting over; which surprises the eye upon coming near it, and makes one laugh, Ha! Ha! from where it takes its name. This sort of opening is haha, on some occasions, to be preferred, for that it does not at all interrupt the prospect, as the bars of a grill do.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The etymology of the term is generally given as being an expression of surprise—someone says &quot;ha ha&quot; or &quot;ah! ah!&quot; when they encounter such a feature. This is the explanation given in French, where it is traditionally attributed to &lt;a href=&quot;https://en.wikipedia.org/wiki/Louis,_Grand_Dauphin&quot; title=&quot;Louis, Grand Dauphin&quot;&gt;Louis, Grand Dauphin&lt;/a&gt;, on encountering such features at Meudon, by d'Argenville (trans. James), above, and by Walpole, who surmised that the name is derived from the response of ordinary folk on encountering them and that they were &quot;... then deemed so astonishing, that the common people called them Ha! Has! to express their surprise at finding a sudden and unperceived check to their walk.&quot; &lt;a href=&quot;https://en.wikipedia.org/wiki/Thomas_Jefferson&quot; title=&quot;Thomas Jefferson&quot;&gt;Thomas Jefferson&lt;/a&gt;, describing the garden at &lt;a href=&quot;https://en.wikipedia.org/wiki/Stowe_House&quot; title=&quot;Stowe House&quot;&gt;Stowe&lt;/a&gt; after his visit in April 1786, also uses the term with exclamation marks: &quot;The inclosure is entirely by ha! ha!&quot;&lt;sup id=&quot;cite_ref-7&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-7&quot;&gt;[7]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;In Britain, the ha-ha is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Garden_feature&quot; class=&quot;mw-redirect&quot; title=&quot;Garden feature&quot;&gt;feature&lt;/a&gt; of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Landscape_garden&quot; class=&quot;mw-redirect&quot; title=&quot;Landscape garden&quot;&gt;landscape gardens&lt;/a&gt; laid out by &lt;a href=&quot;https://en.wikipedia.org/wiki/Charles_Bridgeman&quot; title=&quot;Charles Bridgeman&quot;&gt;Charles Bridgeman&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/William_Kent&quot; title=&quot;William Kent&quot;&gt;William Kent&lt;/a&gt; and was an essential component of the &quot;swept&quot; views of &lt;a href=&quot;https://en.wikipedia.org/wiki/Capability_Brown&quot; title=&quot;Capability Brown&quot;&gt;Capability Brown&lt;/a&gt;. &lt;a href=&quot;https://en.wikipedia.org/wiki/Horace_Walpole&quot; title=&quot;Horace Walpole&quot;&gt;Horace Walpole&lt;/a&gt; credits Bridgeman with the invention of the ha-ha but was unaware of the earlier French origins.
&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The contiguous ground of the park without the sunk fence was to be harmonized with the lawn within; and the garden in its turn was to be set free from its prim regularity, that it might assort with the wilder country without.&lt;sup id=&quot;cite_ref-8&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-8&quot;&gt;[8]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;During his excavations at &lt;a href=&quot;https://en.wikipedia.org/wiki/Iona&quot; title=&quot;Iona&quot;&gt;Iona&lt;/a&gt; in the period 1964–1984, Richard Reece discovered an 18th-century ha-ha designed to protect the abbey from cattle.&lt;sup id=&quot;cite_ref-Reece_9-0&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-Reece-9&quot;&gt;[9]&lt;/a&gt;&lt;/sup&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ice_house_(building)&quot; title=&quot;Ice house (building)&quot;&gt;Ice houses&lt;/a&gt; were sometimes built into ha-ha walls because they provide a subtle entrance that makes the ice house a less intrusive structure, and the ground provides additional insulation.&lt;sup id=&quot;cite_ref-10&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-10&quot;&gt;[10]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Examples&quot;&gt;Examples&lt;/span&gt;&lt;/h2&gt;
&lt;div class=&quot;thumb tright&quot;&gt;&lt;div class=&quot;thumbinner&quot; style=&quot;width:222px;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Over_Castle_Ashby_haha.jpg&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Over_Castle_Ashby_haha.jpg/220px-Over_Castle_Ashby_haha.jpg&quot; decoding=&quot;async&quot; width=&quot;220&quot; height=&quot;165&quot; class=&quot;thumbimage&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/0/05/Over_Castle_Ashby_haha.jpg/330px-Over_Castle_Ashby_haha.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/0/05/Over_Castle_Ashby_haha.jpg/440px-Over_Castle_Ashby_haha.jpg 2x&quot; data-file-width=&quot;2048&quot; data-file-height=&quot;1536&quot;/&gt;&lt;/a&gt;  &lt;div class=&quot;thumbcaption&quot;&gt;Seen from the rear, the ha-ha at &lt;a href=&quot;https://en.wikipedia.org/wiki/Castle_Ashby&quot; title=&quot;Castle Ashby&quot;&gt;Castle Ashby&lt;/a&gt; blends into the landscape.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Most typically, ha-has are still found in the grounds of grand country houses and estates. They keep cattle and sheep out of the formal gardens, without the need for obtrusive fencing. They vary in depth from about 0.6 m (2 ft) (&lt;a href=&quot;https://en.wikipedia.org/wiki/Horton,_Northamptonshire#Horton_House_estate&quot; title=&quot;Horton, Northamptonshire&quot;&gt;Horton House&lt;/a&gt;) to 2.7 m (9 ft) (&lt;a href=&quot;https://en.wikipedia.org/wiki/Petworth_House&quot; title=&quot;Petworth House&quot;&gt;Petworth House&lt;/a&gt;).
&lt;/p&gt;&lt;p&gt;An unusually long example is the ha-ha that separates the &lt;a href=&quot;https://en.wikipedia.org/wiki/Royal_Artillery_Barracks&quot; title=&quot;Royal Artillery Barracks&quot;&gt;Royal Artillery Barracks&lt;/a&gt; Field from &lt;a href=&quot;https://en.wikipedia.org/wiki/Woolwich_Common&quot; title=&quot;Woolwich Common&quot;&gt;Woolwich Common&lt;/a&gt; in southeast &lt;a href=&quot;https://en.wikipedia.org/wiki/London&quot; title=&quot;London&quot;&gt;London&lt;/a&gt;. This deep ha-ha was installed around 1774 to prevent sheep and cattle, grazing at a stopover on Woolwich Common on their journey to the London meat markets, from wandering onto the Royal Artillery gunnery range. A rare feature of this east-west ha-ha is that the normally hidden brick wall emerges above ground for its final 75 yards (70 metres) or so as the land falls away to the west, revealing a fine batter to the brickwork face of the wall, thus exposed. This final west section of the ha-ha forms the boundary of the Gatehouse&lt;sup id=&quot;cite_ref-11&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-11&quot;&gt;[11]&lt;/a&gt;&lt;/sup&gt; by &lt;a href=&quot;https://en.wikipedia.org/wiki/James_Wyatt&quot; title=&quot;James Wyatt&quot;&gt;James Wyatt&lt;/a&gt; RA. The Royal Artillery ha-ha is maintained in a good state of preservation by the &lt;a href=&quot;https://en.wikipedia.org/wiki/Ministry_of_Defence_(United_Kingdom)&quot; title=&quot;Ministry of Defence (United Kingdom)&quot;&gt;Ministry of Defence&lt;/a&gt;. It is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Listed_Building&quot; class=&quot;mw-redirect&quot; title=&quot;Listed Building&quot;&gt;Listed Building&lt;/a&gt;, and is accompanied by Ha-Ha Road that runs alongside its full length. There is a shorter ha-ha in the grounds of the nearby &lt;a href=&quot;https://en.wikipedia.org/wiki/Jacobean_architecture&quot; title=&quot;Jacobean architecture&quot;&gt;Jacobean&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Charlton_House&quot; title=&quot;Charlton House&quot;&gt;Charlton House&lt;/a&gt;.
&lt;/p&gt;&lt;p&gt;In Australia, ha-has were also used at Victorian-era lunatic asylums such as &lt;a href=&quot;https://en.wikipedia.org/wiki/Yarra_Bend_Asylum&quot; title=&quot;Yarra Bend Asylum&quot;&gt;Yarra Bend Asylum&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/Beechworth_Asylum&quot; title=&quot;Beechworth Asylum&quot;&gt;Beechworth Asylum&lt;/a&gt;, and &lt;a href=&quot;https://en.wikipedia.org/wiki/Kew_Asylum&quot; title=&quot;Kew Asylum&quot;&gt;Kew Lunatic Asylum&lt;/a&gt;. From the inside, the walls presented a tall face to patients, preventing them from escaping, while from outside they looked low so as not to suggest imprisonment.&lt;sup id=&quot;cite_ref-12&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-12&quot;&gt;[12]&lt;/a&gt;&lt;/sup&gt; For the patients themselves, standing before the trench, it also enabled them to see the wider landscape.&lt;sup id=&quot;cite_ref-13&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-13&quot;&gt;[13]&lt;/a&gt;&lt;/sup&gt; Kew Asylum has been redeveloped as apartments; however some of the ha-has remain, albeit partially filled in.
&lt;/p&gt;
&lt;ul class=&quot;gallery mw-gallery-packed&quot;&gt;&lt;li class=&quot;gallerycaption&quot;&gt;Ha-ha variations used at Australian mental asylums&lt;/li&gt;
		&lt;li class=&quot;gallerybox&quot; style=&quot;width: 162px&quot;&gt;&lt;div style=&quot;width: 162px&quot;&gt;
			&lt;div class=&quot;thumb&quot; style=&quot;width: 160px;&quot;&gt;&lt;div style=&quot;margin:0px auto;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Beechworth_Ha_Ha_from_outside.JPG&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Beechworth_Ha_Ha_from_outside.JPG/240px-Beechworth_Ha_Ha_from_outside.JPG&quot; decoding=&quot;async&quot; width=&quot;160&quot; height=&quot;120&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/1/16/Beechworth_Ha_Ha_from_outside.JPG/360px-Beechworth_Ha_Ha_from_outside.JPG 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/16/Beechworth_Ha_Ha_from_outside.JPG/480px-Beechworth_Ha_Ha_from_outside.JPG 2x&quot; data-file-width=&quot;3968&quot; data-file-height=&quot;2976&quot;/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;div class=&quot;gallerytext&quot;&gt;
&lt;p&gt;Remains of the original ha-ha wall at Beechworth Asylum from the &quot;outside&quot; of the original asylum boundary
&lt;/p&gt;
			&lt;/div&gt;
		&lt;/div&gt;&lt;/li&gt;
		&lt;li class=&quot;gallerybox&quot; style=&quot;width: 92px&quot;&gt;&lt;div style=&quot;width: 92px&quot;&gt;
			&lt;div class=&quot;thumb&quot; style=&quot;width: 90px;&quot;&gt;&lt;div style=&quot;margin:0px auto;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Beechworth_ha-ha_inside_2.JPG&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Beechworth_ha-ha_inside_2.JPG/135px-Beechworth_ha-ha_inside_2.JPG&quot; decoding=&quot;async&quot; width=&quot;90&quot; height=&quot;120&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Beechworth_ha-ha_inside_2.JPG/202px-Beechworth_ha-ha_inside_2.JPG 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Beechworth_ha-ha_inside_2.JPG/270px-Beechworth_ha-ha_inside_2.JPG 2x&quot; data-file-width=&quot;2976&quot; data-file-height=&quot;3968&quot;/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;div class=&quot;gallerytext&quot;&gt;
&lt;p&gt;From the inside, the ha-ha was a barrier to passage
&lt;/p&gt;
			&lt;/div&gt;
		&lt;/div&gt;&lt;/li&gt;
		&lt;li class=&quot;gallerybox&quot; style=&quot;width: 246px&quot;&gt;&lt;div style=&quot;width: 246px&quot;&gt;
			&lt;div class=&quot;thumb&quot; style=&quot;width: 244px;&quot;&gt;&lt;div style=&quot;margin:0px auto;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Beechworth_ha-ha_inside_1.JPG&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Beechworth_ha-ha_inside_1.JPG/366px-Beechworth_ha-ha_inside_1.JPG&quot; decoding=&quot;async&quot; width=&quot;244&quot; height=&quot;120&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/3/37/Beechworth_ha-ha_inside_1.JPG/549px-Beechworth_ha-ha_inside_1.JPG 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/37/Beechworth_ha-ha_inside_1.JPG/731px-Beechworth_ha-ha_inside_1.JPG 2x&quot; data-file-width=&quot;2664&quot; data-file-height=&quot;1312&quot;/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;div class=&quot;gallerytext&quot;&gt;
&lt;p&gt;End view at the beginning of the remains of the ha-ha at Beechworth Asylum, showing the sloping trench
&lt;/p&gt;
			&lt;/div&gt;
		&lt;/div&gt;&lt;/li&gt;
		&lt;li class=&quot;gallerybox&quot; style=&quot;width: 202.66666666667px&quot;&gt;&lt;div style=&quot;width: 202.66666666667px&quot;&gt;
			&lt;div class=&quot;thumb&quot; style=&quot;width: 200.66666666667px;&quot;&gt;&lt;div style=&quot;margin:0px auto;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Yarrabendhaha.jpg&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Yarrabendhaha.jpg/301px-Yarrabendhaha.jpg&quot; decoding=&quot;async&quot; width=&quot;201&quot; height=&quot;120&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Yarrabendhaha.jpg/452px-Yarrabendhaha.jpg 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/f0/Yarrabendhaha.jpg/603px-Yarrabendhaha.jpg 2x&quot; data-file-width=&quot;1007&quot; data-file-height=&quot;602&quot;/&gt;&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;div class=&quot;gallerytext&quot;&gt;
&lt;p&gt;An example of the ha-ha variation used at &lt;a href=&quot;https://en.wikipedia.org/wiki/Yarra_Bend_Asylum&quot; title=&quot;Yarra Bend Asylum&quot;&gt;Yarra Bend Asylum&lt;/a&gt; in &lt;a href=&quot;https://en.wikipedia.org/wiki/Victoria,_Australia&quot; class=&quot;mw-redirect&quot; title=&quot;Victoria, Australia&quot;&gt;Victoria, Australia&lt;/a&gt;, circa 1900
&lt;/p&gt;
			&lt;/div&gt;
		&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Ha-has were also used in North America. Only two historic installations remain in Canada, one of which is on the grounds of Nova Scotia's Uniacke House (1813), a rural estate built by &lt;a href=&quot;https://en.wikipedia.org/wiki/Richard_John_Uniacke&quot; title=&quot;Richard John Uniacke&quot;&gt;Richard John Uniacke&lt;/a&gt;, an Irish-born Attorney-General of Nova Scotia.&lt;sup id=&quot;cite_ref-14&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-14&quot;&gt;[14]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;div class=&quot;thumb tright&quot;&gt;&lt;div class=&quot;thumbinner&quot; style=&quot;width:172px;&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/File:Buildings_in_Washington,_D.C._01907.JPG&quot; class=&quot;image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Buildings_in_Washington%2C_D.C._01907.JPG/170px-Buildings_in_Washington%2C_D.C._01907.JPG&quot; decoding=&quot;async&quot; width=&quot;170&quot; height=&quot;256&quot; class=&quot;thumbimage&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Buildings_in_Washington%2C_D.C._01907.JPG/255px-Buildings_in_Washington%2C_D.C._01907.JPG 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Buildings_in_Washington%2C_D.C._01907.JPG/340px-Buildings_in_Washington%2C_D.C._01907.JPG 2x&quot; data-file-width=&quot;3264&quot; data-file-height=&quot;4912&quot;/&gt;&lt;/a&gt;  &lt;div class=&quot;thumbcaption&quot;&gt;The &lt;a href=&quot;https://en.wikipedia.org/wiki/Washington_Monument&quot; title=&quot;Washington Monument&quot;&gt;Washington Monument&lt;/a&gt; is protected by a low ha-ha wall.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A 21st-century use of a ha-ha is at the &lt;a href=&quot;https://en.wikipedia.org/wiki/Washington_Monument&quot; title=&quot;Washington Monument&quot;&gt;Washington Monument&lt;/a&gt; to minimize the visual impact of security measures. After &lt;a href=&quot;https://en.wikipedia.org/wiki/September_11,_2001_attacks&quot; class=&quot;mw-redirect&quot; title=&quot;September 11, 2001 attacks&quot;&gt;9/11&lt;/a&gt; and another unrelated terror threat at the monument, authorities had put up &lt;a href=&quot;https://en.wikipedia.org/wiki/Jersey_barrier&quot; title=&quot;Jersey barrier&quot;&gt;jersey barriers&lt;/a&gt; to prevent large motor vehicles from approaching the monument. The temporary barriers were later replaced with a new ha-ha, a low 0.76 m (30-inch) granite stone wall that incorporated lighting and doubled as a seating bench. It received the 2005 Park/Landscape Award of Merit.&lt;sup id=&quot;cite_ref-15&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-15&quot;&gt;[15]&lt;/a&gt;&lt;/sup&gt;&lt;sup id=&quot;cite_ref-16&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-16&quot;&gt;[16]&lt;/a&gt;&lt;/sup&gt;&lt;sup id=&quot;cite_ref-17&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-17&quot;&gt;[17]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;h3&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Notable_examples_in_fiction&quot;&gt;Notable examples in fiction&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;In the &lt;a href=&quot;https://en.wikipedia.org/wiki/Terry_Pratchett&quot; title=&quot;Terry Pratchett&quot;&gt;Terry Pratchett&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Discworld&quot; title=&quot;Discworld&quot;&gt;Discworld&lt;/a&gt; novel &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Men_at_Arms&quot; title=&quot;Men at Arms&quot;&gt;Men at Arms&lt;/a&gt;&lt;/i&gt;, a similar landscape boundary is used for a comedic twist: designed by ill-famed engineer &lt;a href=&quot;https://en.wikipedia.org/wiki/Bergholt_Stuttley_Johnson&quot; class=&quot;mw-redirect&quot; title=&quot;Bergholt Stuttley Johnson&quot;&gt;Bergholt Stuttley Johnson&lt;/a&gt;, the ha-ha is accidentally specified as 50 feet deep, is called a hoho, and is reported to have claimed the lives of three gardeners.&lt;sup id=&quot;cite_ref-18&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-18&quot;&gt;[18]&lt;/a&gt;&lt;/sup&gt; In &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Snuff_(Pratchett_novel)&quot; title=&quot;Snuff (Pratchett novel)&quot;&gt;Snuff&lt;/a&gt;&lt;/i&gt;, as Vimes and Willikins go for a walk in the countryside, they &quot;navigate their way around the ha-ha, keep their distance from the ho-ho and completely ignore the he-he.&quot;&lt;sup id=&quot;cite_ref-19&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-19&quot;&gt;[19]&lt;/a&gt;&lt;/sup&gt; In Pratchett's standalone book with &lt;a href=&quot;https://en.wikipedia.org/wiki/Neil_Gaiman&quot; title=&quot;Neil Gaiman&quot;&gt;Neil Gaiman&lt;/a&gt;, &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Good_Omens&quot; title=&quot;Good Omens&quot;&gt;Good Omens&lt;/a&gt;&lt;/i&gt;, during a gun battle at an old &lt;a href=&quot;https://en.wikipedia.org/wiki/English_country_house&quot; title=&quot;English country house&quot;&gt;English country house&lt;/a&gt;, a character lies face down in a ha-ha, but is not very amused by it.&lt;/li&gt;
&lt;li&gt;In &lt;a href=&quot;https://en.wikipedia.org/wiki/Tom_Stoppard&quot; title=&quot;Tom Stoppard&quot;&gt;Tom Stoppard&lt;/a&gt;'s play, &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Arcadia_(play)&quot; title=&quot;Arcadia (play)&quot;&gt;Arcadia&lt;/a&gt;&lt;/i&gt;, the ha-ha is discussed in relation to a Capability Brown garden, and is used as one of the links between the nineteenth and twentieth century characters.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Jennifer_Dawson&quot; title=&quot;Jennifer Dawson&quot;&gt;Jennifer Dawson&lt;/a&gt;'s 1961 novel &lt;i&gt;The Ha-Ha&lt;/i&gt; is named for this landscape feature.&lt;/li&gt;
&lt;li&gt;In &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/The_Island_of_Doctor_Moreau&quot; title=&quot;The Island of Doctor Moreau&quot;&gt;The Island of Doctor Moreau&lt;/a&gt;&lt;/i&gt; by &lt;a href=&quot;https://en.wikipedia.org/wiki/H._G._Wells&quot; title=&quot;H. G. Wells&quot;&gt;H. G. Wells&lt;/a&gt;, a &quot;steep-walled gap&quot; on the island is compared to &quot;the ha-ha of an English park&quot;.&lt;/li&gt;
&lt;li&gt;In &lt;a href=&quot;https://en.wikipedia.org/wiki/Edward_Gorey&quot; title=&quot;Edward Gorey&quot;&gt;Edward Gorey&lt;/a&gt;'s &lt;i&gt;The Awdrey-Gore Legacy&lt;/i&gt;, a satire of overcomplicated murder mysteries, a ha-ha is one of the typical places where the body of a murder victim might be found.&lt;/li&gt;
&lt;li&gt;In Jane Austen's &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Mansfield_Park&quot; title=&quot;Mansfield Park&quot;&gt;Mansfield Park&lt;/a&gt;&lt;/i&gt; a ha-ha prevents the more sensible characters from getting around a locked gate and into the woodland beyond.&lt;/li&gt;
&lt;li&gt;In &lt;a href=&quot;https://en.wikipedia.org/wiki/Diana_Wynne_Jones&quot; title=&quot;Diana Wynne Jones&quot;&gt;Diana Wynne Jones&lt;/a&gt;'s sixth &lt;a href=&quot;https://en.wikipedia.org/wiki/Chrestomanci&quot; title=&quot;Chrestomanci&quot;&gt;Chrestomanci&lt;/a&gt; novel &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Conrad%27s_Fate&quot; title=&quot;Conrad's Fate&quot;&gt;Conrad's Fate&lt;/a&gt;&lt;/i&gt;, Christopher and Conrad both stumble upon a ha-ha while exploring the mansion grounds.  Christopher declares the ditch to actually be a ha-ha, and Conrad mistakenly thinks that he is laughing.&lt;/li&gt;
&lt;li&gt;A ha-ha with spikes at the bottom features in &lt;a href=&quot;https://en.wikipedia.org/wiki/Tom_Sharpe&quot; title=&quot;Tom Sharpe&quot;&gt;Tom Sharpe&lt;/a&gt;'s 1971 black comedy novel &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Riotous_Assembly&quot; title=&quot;Riotous Assembly&quot;&gt;Riotous Assembly&lt;/a&gt;&lt;/i&gt;.&lt;/li&gt;
&lt;li&gt;In the radio soap &lt;i&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/The_Archers&quot; title=&quot;The Archers&quot;&gt;The Archers&lt;/a&gt;&lt;/i&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/List_of_The_Archers_characters#The_Pargetter_family&quot; title=&quot;List of The Archers characters&quot;&gt;Nigel Pargetter&lt;/a&gt; digs a ha-ha at Lower Loxley Hall.&lt;sup id=&quot;cite_ref-20&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-20&quot;&gt;[20]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Legal&quot;&gt;Legal&lt;/span&gt;&lt;/h2&gt;
&lt;h3&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Personal_injury&quot;&gt;Personal injury&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;Due to the hidden nature of ha-has, they can pose potential injury to the public (especially considering their initial designs were to be invisible). 
&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;In 2008, during a nighttime guided walk to watch bats at &lt;a href=&quot;https://en.wikipedia.org/wiki/Hopetoun_House&quot; title=&quot;Hopetoun House&quot;&gt;Hopetoun House&lt;/a&gt;, a participant of the walk attempting to make his way back to the carpark fell off of a ha-ha wall, and suffered a severe fracture to the ankle. A successful personal injury claim of £35,000 was settled upon, as the judge presiding the case deemed the ha-ha to be a dangerous man-made feature, and thus it was up to the groundskeepers to highlight the invisible danger that it presented.&lt;sup id=&quot;cite_ref-21&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-21&quot;&gt;[21]&lt;/a&gt;&lt;/sup&gt; The presiding QC judge, &lt;a href=&quot;https://en.wikipedia.org/wiki/Alastair_Campbell,_Lord_Bracadale&quot; title=&quot;Alastair Campbell, Lord Bracadale&quot;&gt;Alastair Campbell&lt;/a&gt;, deemed a ha-ha wall to be outside the scope of the law regarding obvious dangers, such as cliffs or canals, where an occupier is not required to take precautions against a person being injured. This was due to it being an unusual man-made feature that the public would be very much unaware of, especially across a wide lawn.&lt;sup id=&quot;cite_ref-22&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-22&quot;&gt;[22]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt;&lt;li&gt;In 2014, a wedding guest at a manor house fell off a ha-ha while making her way across the manor garden, displacing her right tibia and fibula bones. She brought a successful personal injury claim that was investigated by the environmental health department, who agreed that the area should have been lit in some way to avoid this kind of accident.&lt;sup id=&quot;cite_ref-auto_23-0&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-auto-23&quot;&gt;[23]&lt;/a&gt;&lt;/sup&gt; The defendants in the litigation case were quick to admit liability for the incident, and settled for about £10,000. This was followed by radical changes to the signposting and lighting around the ha-ha to alert visitors of its presence.&lt;sup id=&quot;cite_ref-auto_23-1&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-auto-23&quot;&gt;[23]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;Preventive_repairs&quot;&gt;Preventive repairs&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;&lt;li&gt;Emergency repairs to the ha-ha wall at Sunbury Park in &lt;a href=&quot;https://en.wikipedia.org/wiki/Borough_of_Spelthorne&quot; title=&quot;Borough of Spelthorne&quot;&gt;Spelthorne&lt;/a&gt; took place in 2009, after the council realised that they would be liable for any injury or death caused by the ha-ha wall. Surrounding vegetation was removed two years before the works opened up the ha-ha to the public. However environmental services were made aware that the ha-ha was in a state of disrepair, and without appropriate warning signs. The total cost of repairs was thought to be around £65,000; environmental services contributed £9,000, and the rest of the funds was taken from capital monies.&lt;sup id=&quot;cite_ref-24&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-24&quot;&gt;[24]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt;&lt;li&gt;In 2016 the ha-ha wall in Dalzell estate was repaired after it became unsafe due to a collapse of the stonework. The council's Environmental Services Committee were concerned about potential liability and personal injury claims and enlisted the help of volunteers and staff from a local charity to repair the ha-ha wall within the estate. The repair project received funding from the environmental key fund and the heritage lottery fund via the Clyde and Avon Valley Landscape Partnership.&lt;sup id=&quot;cite_ref-25&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_note-25&quot;&gt;[25]&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;See_also&quot;&gt;See also&lt;/span&gt;&lt;/h2&gt;
&lt;table role=&quot;presentation&quot; class=&quot;mbox-small plainlinks sistersitebox&quot; style=&quot;background-color:#f9f9f9;border:1px solid #aaa;color:#000&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;mbox-image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Wiktionary-logo-en-v2.svg/40px-Wiktionary-logo-en-v2.svg.png&quot; decoding=&quot;async&quot; width=&quot;40&quot; height=&quot;40&quot; class=&quot;noviewer&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/commons/thumb/9/99/Wiktionary-logo-en-v2.svg/60px-Wiktionary-logo-en-v2.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/99/Wiktionary-logo-en-v2.svg/80px-Wiktionary-logo-en-v2.svg.png 2x&quot; data-file-width=&quot;512&quot; data-file-height=&quot;512&quot;/&gt;&lt;/td&gt;
&lt;td class=&quot;mbox-text plainlist&quot;&gt;Look up &lt;i&gt;&lt;b&gt;&lt;a href=&quot;https://en.wiktionary.org/wiki/haha&quot; class=&quot;extiw&quot; title=&quot;wiktionary:haha&quot;&gt;haha&lt;/a&gt;&lt;/b&gt;&lt;/i&gt; in Wiktionary, the free dictionary.&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table role=&quot;presentation&quot; class=&quot;mbox-small plainlinks sistersitebox&quot; style=&quot;background-color:#f9f9f9;border:1px solid #aaa;color:#000&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;mbox-image&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;https://upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/30px-Commons-logo.svg.png&quot; decoding=&quot;async&quot; width=&quot;30&quot; height=&quot;40&quot; class=&quot;noviewer&quot; srcset=&quot;//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/45px-Commons-logo.svg.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/59px-Commons-logo.svg.png 2x&quot; data-file-width=&quot;1024&quot; data-file-height=&quot;1376&quot;/&gt;&lt;/td&gt;
&lt;td class=&quot;mbox-text plainlist&quot;&gt;Wikimedia Commons has media related to &lt;i&gt;&lt;b&gt;&lt;a href=&quot;https://commons.wikimedia.org/wiki/Category:Ha-has&quot; class=&quot;extiw&quot; title=&quot;commons:Category:Ha-has&quot;&gt;Ha-has&lt;/a&gt;&lt;/b&gt;&lt;/i&gt;.&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Cattle_guard&quot; class=&quot;mw-redirect&quot; title=&quot;Cattle guard&quot;&gt;Cattle guard&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Moat&quot; title=&quot;Moat&quot;&gt;Moat&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Royal_Crescent&quot; title=&quot;Royal Crescent&quot;&gt;Royal Crescent&lt;/a&gt;, Bath, England&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;span class=&quot;mw-headline&quot; id=&quot;References&quot;&gt;References&lt;/span&gt;&lt;/h2&gt;
&lt;div class=&quot;reflist columns references-column-width&quot; style=&quot;-moz-column-width: 30em; -webkit-column-width: 30em; column-width: 30em; list-style-type: decimal;&quot;&gt;
&lt;ol class=&quot;references&quot;&gt;&lt;li id=&quot;cite_note-1&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-1&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.bbc.co.uk/legacies/heritage/england/teesside/article_1.shtml&quot;&gt;&quot;BBC - Legacies - Architectural Heritage - England - Teesside - What's so funny about a ha-ha wall? - Article Page 1&quot;&lt;/a&gt;. &lt;i&gt;www.bbc.co.uk&lt;/i&gt;&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;2017-11-20&lt;/span&gt;&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=www.bbc.co.uk&amp;amp;rft.atitle=BBC+-+Legacies+-+Architectural+Heritage+-+England+-+Teesside+-+What%27s+so+funny+about+a+ha-ha+wall%3F+-+Article+Page+1&amp;amp;rft_id=http%3A%2F%2Fwww.bbc.co.uk%2Flegacies%2Fheritage%2Fengland%2Fteesside%2Farticle_1.shtml&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;style data-mw-deduplicate=&quot;TemplateStyles:r886058088&quot;&gt;&lt;![CDATA[.mw-parser-output cite.citation{font-style:inherit}.mw-parser-output .citation q{quotes:&quot;\&quot;&quot;&quot;\&quot;&quot;&quot;'&quot;&quot;'&quot;}.mw-parser-output .citation .cs1-lock-free a{background:url(&quot;//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png&quot;)no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-limited a,.mw-parser-output .citation .cs1-lock-registration a{background:url(&quot;//upload.wikimedia.org/wikipedia/commons/thumb/d/d6/Lock-gray-alt-2.svg/9px-Lock-gray-alt-2.svg.png&quot;)no-repeat;background-position:right .1em center}.mw-parser-output .citation .cs1-lock-subscription a{background:url(&quot;//upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Lock-red-alt-2.svg/9px-Lock-red-alt-2.svg.png&quot;)no-repeat;background-position:right .1em center}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration{color:#555}.mw-parser-output .cs1-subscription span,.mw-parser-output .cs1-registration span{border-bottom:1px dotted;cursor:help}.mw-parser-output .cs1-ws-icon a{background:url(&quot;//upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Wikisource-logo.svg/12px-Wikisource-logo.svg.png&quot;)no-repeat;background-position:right .1em center}.mw-parser-output code.cs1-code{color:inherit;background:inherit;border:inherit;padding:inherit}.mw-parser-output .cs1-hidden-error{display:none;font-size:100%}.mw-parser-output .cs1-visible-error{font-size:100%}.mw-parser-output .cs1-maint{display:none;color:#33aa33;margin-left:0.3em}.mw-parser-output .cs1-subscription,.mw-parser-output .cs1-registration,.mw-parser-output .cs1-format{font-size:95%}.mw-parser-output .cs1-kern-left,.mw-parser-output .cs1-kern-wl-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right,.mw-parser-output .cs1-kern-wl-right{padding-right:0.2em}]]&gt;&lt;/style&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-2&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-2&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.axyt89.dsl.pipex.com/West%20Dean%20College/west%20dean.html&quot;&gt;West Dean College&lt;/a&gt;: &quot;From the front the parkland landscape appears continuous, but in fact the formal grounds are protected from the grazing sheep and cattle by a ha-ha&quot;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-3&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-3&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://patwelsh.com/wpmu/blog/lawns-grass/lawn-pros-and-cons/&quot;&gt;&quot;Lawn Pros and Cons&quot;&lt;/a&gt;. Pat Welsh&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;2013-04-15&lt;/span&gt;&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=Lawn+Pros+and+Cons&amp;amp;rft.pub=Pat+Welsh&amp;amp;rft_id=http%3A%2F%2Fpatwelsh.com%2Fwpmu%2Fblog%2Flawns-grass%2Flawn-pros-and-cons%2F&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-4&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-4&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.umass.edu/umext/mac/Newsletters/spring2007.htm&quot;&gt;Massachusetts Agriculture&lt;/a&gt; &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://web.archive.org/web/20090116071455/http://www.umass.edu/umext/mac/Newsletters/spring2007.htm&quot;&gt;Archived&lt;/a&gt; 2009-01-16 at the &lt;a href=&quot;https://en.wikipedia.org/wiki/Wayback_Machine&quot; title=&quot;Wayback Machine&quot;&gt;Wayback Machine&lt;/a&gt;: &quot;Early suburbanites relied on hired help to scythe the grass or sheep to graze the lawn. The lawn mower ... made it possible for homeowners to maintain their own lawn. ... The ha-ha provided an invisible barrier ... which kept livestock from wandering ... into gardens. &quot;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-5&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-5&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation book&quot;&gt;Shirley, Evelyn Philip (1867). &quot;1 Deer and deer parks&quot;. &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://books.google.co.uk/books?id=FYdOAAAAMAAJ&amp;amp;printsec=frontcover&amp;amp;dq=deer+leap&amp;amp;hl=en&amp;amp;redir_esc=y#v=onepage&amp;amp;q=deer%20leap&amp;amp;f=false&quot;&gt;&lt;i&gt;Some account of English deer parks: with notes on the management of deer&lt;/i&gt;&lt;/a&gt;. London: John Murray. p. 14&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;2012-11-24&lt;/span&gt;&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=bookitem&amp;amp;rft.atitle=1+Deer+and+deer+parks&amp;amp;rft.btitle=Some+account+of+English+deer+parks%3A+with+notes+on+the+management+of+deer&amp;amp;rft.place=London&amp;amp;rft.pages=14&amp;amp;rft.pub=John+Murray&amp;amp;rft.date=1867&amp;amp;rft.aulast=Shirley&amp;amp;rft.aufirst=Evelyn+Philip&amp;amp;rft_id=https%3A%2F%2Fbooks.google.co.uk%2Fbooks%3Fid%3DFYdOAAAAMAAJ%26printsec%3Dfrontcover%26dq%3Ddeer%2Bleap%26hl%3Den%26redir_esc%3Dy%23v%3Donepage%26q%3Ddeer%2520leap%26f%3Dfalse&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-6&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-6&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;Anon. &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.legendarydartmoor.co.uk/deer_park.htm&quot;&gt;&quot;Okehampton Deer Park&quot;&lt;/a&gt;. &lt;i&gt;Legendary Dartmoor&lt;/i&gt;&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;24 November&lt;/span&gt; 2012&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=Legendary+Dartmoor&amp;amp;rft.atitle=Okehampton+Deer+Park&amp;amp;rft.au=Anon&amp;amp;rft_id=http%3A%2F%2Fwww.legendarydartmoor.co.uk%2Fdeer_park.htm&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-7&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-7&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;The Papers of Thomas Jefferson Digital Edition, ed. Barbara B. Oberg and &lt;a href=&quot;https://en.wikipedia.org/w/index.php?title=J._Jefferson_Looney&amp;amp;action=edit&amp;amp;redlink=1&quot; class=&quot;new&quot; title=&quot;J. Jefferson Looney (page does not exist)&quot;&gt;J. Jefferson Looney&lt;/a&gt;. &lt;a href=&quot;https://en.wikipedia.org/wiki/Charlottesville&quot; class=&quot;mw-redirect&quot; title=&quot;Charlottesville&quot;&gt;Charlottesville&lt;/a&gt;: &lt;a href=&quot;https://en.wikipedia.org/wiki/University_of_Virginia_Press&quot; title=&quot;University of Virginia Press&quot;&gt;University of Virginia Press&lt;/a&gt;, Rotunda, 2008, p. 371. &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://rotunda.upress.virginia.edu/founders/TSJN-01-09-02-0328&quot;&gt;Online edition&lt;/a&gt; accessed 14 Aug 2012.&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-8&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-8&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.gardenvisit.com/t/w9.htm&quot;&gt;Horace Walpole, &lt;i&gt;Essay upon modern gardening&lt;/i&gt;&lt;/a&gt; &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://web.archive.org/web/20070927220051/http://www.gardenvisit.com/t/w9.htm&quot;&gt;Archived&lt;/a&gt; 2007-09-27 at the &lt;a href=&quot;https://en.wikipedia.org/wiki/Wayback_Machine&quot; title=&quot;Wayback Machine&quot;&gt;Wayback Machine&lt;/a&gt;, 1780&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-Reece-9&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-Reece_9-0&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;Hamlin, Ann (1987). Iona: a view from Ireland. Proc Soc Antiq Scot, ISSN 0081-1564, V. 117, P. 17&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-10&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-10&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;Walker, Bruce (1978). &lt;i&gt;Keeping it cool.&lt;/i&gt; Scottish Vernacular buildings Working Group. Edinburgh &amp;amp; Dundee. Pages 564-565&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-11&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-11&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.largeassociates.com/LA%20Information/gatehouse.htm&quot;&gt;Large and Associates website&lt;/a&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-12&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-12&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.asap.unimelb.edu.au/pubs/articles/asa97/gifs/KEWwlk1.jpg&quot;&gt;&quot;Kew Lunatic Asylum - Historic Walk] Australian Science Archives Project, [Kew Lunatic Asylum&quot;&lt;/a&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=Kew+Lunatic+Asylum+-+Historic+Walk%5D+Australian+Science+Archives+Project%2C+%5BKew+Lunatic+Asylum&amp;amp;rft_id=http%3A%2F%2Fwww.asap.unimelb.edu.au%2Fpubs%2Farticles%2Fasa97%2Fgifs%2FKEWwlk1.jpg&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-13&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-13&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation book&quot;&gt;Semple Kerr, James (1988). &lt;i&gt;Out of Sight, Out of Mind: Australia's places of confinement, 1788-1988&lt;/i&gt;. National Trust of Australia. p. 158. &lt;a href=&quot;https://en.wikipedia.org/wiki/International_Standard_Book_Number&quot; title=&quot;International Standard Book Number&quot;&gt;ISBN&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Special:BookSources/0_947137_80_7&quot; title=&quot;Special:BookSources/0 947137 80 7&quot;&gt;&lt;bdi&gt;0 947137 80 7&lt;/bdi&gt;&lt;/a&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=book&amp;amp;rft.btitle=Out+of+Sight%2C+Out+of+Mind%3A+Australia%27s+places+of+confinement%2C+1788-1988.&amp;amp;rft.pages=158&amp;amp;rft.pub=National+Trust+of+Australia&amp;amp;rft.date=1988&amp;amp;rft.isbn=0947137807&amp;amp;rft.aulast=Semple+Kerr&amp;amp;rft.aufirst=James&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-14&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-14&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;Anon. &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://uniacke.novascotia.ca/about-uniacke-estate&quot;&gt;&quot;About Uniacke Estate&quot;&lt;/a&gt;. Nova Scotia Museum&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;14 October&lt;/span&gt; 2015&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=About+Uniacke+Estate&amp;amp;rft.pub=Nova+Scotia+Museum&amp;amp;rft.au=Anon&amp;amp;rft_id=https%3A%2F%2Funiacke.novascotia.ca%2Fabout-uniacke-estate&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-15&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-15&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.theolinstudio.com/flash#/projects/type/washington-monument&quot;&gt;Washington Monument&lt;/a&gt; &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://web.archive.org/web/20160430151505/http://www.theolinstudio.com/flash&quot;&gt;Archived&lt;/a&gt; 2016-04-30 at the &lt;a href=&quot;https://en.wikipedia.org/wiki/Wayback_Machine&quot; title=&quot;Wayback Machine&quot;&gt;Wayback Machine&lt;/a&gt; (from the &lt;a href=&quot;https://en.wikipedia.org/wiki/OLIN&quot; title=&quot;OLIN&quot;&gt;OLIN&lt;/a&gt; website)&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-16&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-16&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.asla.org/land/2006/0410/olin.html&quot;&gt;Monumental Security&lt;/a&gt; (from the &lt;a href=&quot;https://en.wikipedia.org/wiki/American_Society_of_Landscape_Architects&quot; title=&quot;American Society of Landscape Architects&quot;&gt;American Society of Landscape Architects&lt;/a&gt; website, April 10, 2006)&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-17&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-17&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://books.google.com/books?id=Atd4Pg2RXgQC&amp;amp;pg=SA4-PA18&amp;amp;lpg=SA4-PA18&amp;amp;dq=ha-ha+wall+security&amp;amp;source=bl&amp;amp;ots=G0D2HflxZ7&amp;amp;sig=GcyWEMPwq0bjXaDnREGDuMGh5Mk&amp;amp;hl=en&amp;amp;sa=X&amp;amp;ei=QXGTUsrAMtPjoATmo4Bg&amp;amp;ved=0CFAQ6AEwCQ#v=onepage&amp;amp;q=ha-ha%20wall%20security&amp;amp;f=false&quot;&gt;&quot;Risk Management Series: Site and Urban Design for Security, , page 4-17&quot;&lt;/a&gt;. U. S. Department Security, Federal Emergency Agency.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=Risk+Management+Series%3A+Site+and+Urban+Design+for+Security%2C+%2C+page+4-17&amp;amp;rft.pub=U.+S.+Department+Security%2C+Federal+Emergency+Agency&amp;amp;rft_id=https%3A%2F%2Fbooks.google.com%2Fbooks%3Fid%3DAtd4Pg2RXgQC%26pg%3DSA4-PA18%26lpg%3DSA4-PA18%26dq%3Dha-ha%2Bwall%2Bsecurity%26source%3Dbl%26ots%3DG0D2HflxZ7%26sig%3DGcyWEMPwq0bjXaDnREGDuMGh5Mk%26hl%3Den%26sa%3DX%26ei%3DQXGTUsrAMtPjoATmo4Bg%26ved%3D0CFAQ6AEwCQ%23v%3Donepage%26q%3Dha-ha%2520wall%2520security%26f%3Dfalse&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-18&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-18&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.lspace.org/books/apf/men-at-arms.html#p7758&quot;&gt;Annotations from &lt;/a&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Terry_Pratchett&quot; title=&quot;Terry Pratchett&quot;&gt;Terry Pratchett&lt;/a&gt;'s &lt;i&gt;Men at Arms&lt;/i&gt; (from &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.lspace.org/books/apf/index.html&quot;&gt;The Annotated Pratchett File v9.0&lt;/a&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-19&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-19&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;Terry Pratchett - Snuff (2011) page 56. (Corgi Books &lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/International_Standard_Book_Number&quot; title=&quot;International Standard Book Number&quot;&gt;ISBN&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Special:BookSources/978-0-552-16675-1&quot; title=&quot;Special:BookSources/978-0-552-16675-1&quot;&gt;978-0-552-16675-1&lt;/a&gt;)&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-20&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-20&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;Banks-Smith, Nancy (9 March 2009). &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://www.theguardian.com/media/2007/mar/09/radio.broadcasting&quot;&gt;&quot;A month in Ambridge&quot;&lt;/a&gt;. &lt;i&gt;The Guardian&lt;/i&gt;&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;25 August&lt;/span&gt; 2019&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=The+Guardian&amp;amp;rft.atitle=A+month+in+Ambridge&amp;amp;rft.date=2009-03-09&amp;amp;rft.aulast=Banks-Smith&amp;amp;rft.aufirst=Nancy&amp;amp;rft_id=https%3A%2F%2Fwww.theguardian.com%2Fmedia%2F2007%2Fmar%2F09%2Fradio.broadcasting&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-21&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-21&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://www.scotcourts.gov.uk/search-judgments/judgment?id=1f7c86a6-8980-69d2-b500-ff0000d74aa7&quot;&gt;&quot;JOHN COWAN v. THE HOPETOUN HOUSE PRESERVATION TRUST AND OTHERS&quot;&lt;/a&gt;. &lt;i&gt;www.scotcourts.gov.uk&lt;/i&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=www.scotcourts.gov.uk&amp;amp;rft.atitle=JOHN+COWAN+v.+THE+HOPETOUN+HOUSE+PRESERVATION+TRUST+AND+OTHERS&amp;amp;rft_id=https%3A%2F%2Fwww.scotcourts.gov.uk%2Fsearch-judgments%2Fjudgment%3Fid%3D1f7c86a6-8980-69d2-b500-ff0000d74aa7&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-22&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-22&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.heraldscotland.com/news/13088547.Bat_walk_man_wins_damages_after_ditch_fall/&quot;&gt;&quot;Bat walk man wins damages after ditch fall&quot;&lt;/a&gt;. &lt;i&gt;HeraldScotland&lt;/i&gt;&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;24 December&lt;/span&gt; 2017&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=HeraldScotland&amp;amp;rft.atitle=Bat+walk+man+wins+damages+after+ditch+fall&amp;amp;rft_id=http%3A%2F%2Fwww.heraldscotland.com%2Fnews%2F13088547.Bat_walk_man_wins_damages_after_ditch_fall%2F&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-auto-23&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;^ &lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-auto_23-0&quot;&gt;&lt;sup&gt;&lt;i&gt;&lt;b&gt;a&lt;/b&gt;&lt;/i&gt;&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-auto_23-1&quot;&gt;&lt;sup&gt;&lt;i&gt;&lt;b&gt;b&lt;/b&gt;&lt;/i&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;https://www.penningtons.co.uk/news-publications/latest-news/personal-injury-team-secures-compensation-for-manor-house-guest/&quot;&gt;&quot;Personal injury team secures compensation for Manor House guest&quot;&lt;/a&gt;. &lt;i&gt;www.penningtons.co.uk&lt;/i&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;amp;rft.genre=unknown&amp;amp;rft.jtitle=www.penningtons.co.uk&amp;amp;rft.atitle=Personal+injury+team+secures+compensation+for+Manor+House+guest&amp;amp;rft_id=https%3A%2F%2Fwww.penningtons.co.uk%2Fnews-publications%2Flatest-news%2Fpersonal-injury-team-secures-compensation-for-manor-house-guest%2F&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-24&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-24&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;&lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.losra.org/docs/Ha-Ha%20repairs.pdf&quot;&gt;&quot;Ha-Ha Repairs&quot;&lt;/a&gt; &lt;span class=&quot;cs1-format&quot;&gt;(PDF)&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=Ha-Ha+Repairs&amp;amp;rft_id=http%3A%2F%2Fwww.losra.org%2Fdocs%2FHa-Ha%2520repairs.pdf&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;li id=&quot;cite_note-25&quot;&gt;&lt;span class=&quot;mw-cite-backlink&quot;&gt;&lt;b&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Ha-ha#cite_ref-25&quot;&gt;^&lt;/a&gt;&lt;/b&gt;&lt;/span&gt; &lt;span class=&quot;reference-text&quot;&gt;&lt;cite class=&quot;citation web&quot;&gt;Service Manager, Scott House (2016-06-23). &lt;a rel=&quot;nofollow&quot; class=&quot;external text&quot; href=&quot;http://www.northlanarkshire.gov.uk/index.aspx?articleid=32595&quot;&gt;&quot;Volunteers restore historic feature&quot;&lt;/a&gt;&lt;span class=&quot;reference-accessdate&quot;&gt;. Retrieved &lt;span class=&quot;nowrap&quot;&gt;2017-11-29&lt;/span&gt;&lt;/span&gt;.&lt;/cite&gt;&lt;span title=&quot;ctx_ver=Z39.88-2004&amp;amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;amp;rft.genre=unknown&amp;amp;rft.btitle=Volunteers+restore+historic+feature&amp;amp;rft.date=2016-06-23&amp;amp;rft.aulast=Service+Manager&amp;amp;rft.aufirst=Scott+House&amp;amp;rft_id=http%3A%2F%2Fwww.northlanarkshire.gov.uk%2Findex.aspx%3Farticleid%3D32595&amp;amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AHa-ha&quot; class=&quot;Z3988&quot;/&gt;&lt;link rel=&quot;mw-deduplicated-inline-style&quot; href=&quot;mw-data:TemplateStyles:r886058088&quot;/&gt;&lt;/span&gt;
&lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;
&lt;div role=&quot;navigation&quot; class=&quot;navbox&quot; aria-labelledby=&quot;Garden_features&quot; style=&quot;padding:3px&quot;&gt;&lt;table class=&quot;nowraplinks mw-collapsible autocollapse navbox-inner&quot; style=&quot;border-spacing:0;background:transparent;color:inherit&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th scope=&quot;col&quot; class=&quot;navbox-title&quot; colspan=&quot;2&quot;&gt;&lt;div class=&quot;plainlinks hlist navbar mini&quot;&gt;&lt;ul&gt;&lt;li class=&quot;nv-view&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Template:Garden_features&quot; title=&quot;Template:Garden features&quot;&gt;&lt;abbr title=&quot;View this template&quot; style=&quot;;;background:none transparent;border:none;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none; padding:0;&quot;&gt;v&lt;/abbr&gt;&lt;/a&gt;&lt;/li&gt;&lt;li class=&quot;nv-talk&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Template_talk:Garden_features&quot; title=&quot;Template talk:Garden features&quot;&gt;&lt;abbr title=&quot;Discuss this template&quot; style=&quot;;;background:none transparent;border:none;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none; padding:0;&quot;&gt;t&lt;/abbr&gt;&lt;/a&gt;&lt;/li&gt;&lt;li class=&quot;nv-edit&quot;&gt;&lt;a class=&quot;external text&quot; href=&quot;https://en.wikipedia.org/w/index.php?title=Template:Garden_features&amp;amp;action=edit&quot;&gt;&lt;abbr title=&quot;Edit this template&quot; style=&quot;;;background:none transparent;border:none;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none; padding:0;&quot;&gt;e&lt;/abbr&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div id=&quot;Garden_features&quot; style=&quot;font-size:114%;margin:0 4em&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/List_of_garden_features&quot; title=&quot;List of garden features&quot;&gt;Garden features&lt;/a&gt;&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&quot;2&quot; class=&quot;navbox-list navbox-odd hlist&quot; style=&quot;width:100%;padding:0px&quot;&gt;&lt;div style=&quot;padding:0em 0.25em&quot;&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Artificial_waterfall&quot; title=&quot;Artificial waterfall&quot;&gt;Artificial waterfall&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Avenue_(landscape)&quot; title=&quot;Avenue (landscape)&quot;&gt;Avenue&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Aviary&quot; title=&quot;Aviary&quot;&gt;Aviary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Borrowed_scenery&quot; title=&quot;Borrowed scenery&quot;&gt;Borrowed scenery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Bosquet&quot; title=&quot;Bosquet&quot;&gt;Bosquet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Broderie_(garden_feature)&quot; title=&quot;Broderie (garden feature)&quot;&gt;Broderie&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Belvedere_(structure)&quot; title=&quot;Belvedere (structure)&quot;&gt;Belvedere&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Fan_waterfalls&quot; class=&quot;mw-redirect&quot; title=&quot;Fan waterfalls&quot;&gt;Cascade&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Deck_(building)&quot; title=&quot;Deck (building)&quot;&gt;Deck&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Exedra&quot; title=&quot;Exedra&quot;&gt;Exedra&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Folly&quot; title=&quot;Folly&quot;&gt;Folly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Fountain&quot; title=&quot;Fountain&quot;&gt;Fountain&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Garden_buildings&quot; title=&quot;Garden buildings&quot;&gt;Garden buildings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Garden_pond&quot; title=&quot;Garden pond&quot;&gt;Garden pond&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Garden_railway&quot; title=&quot;Garden railway&quot;&gt;Garden railway&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Gazebo&quot; title=&quot;Gazebo&quot;&gt;Gazebo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Gloriette&quot; title=&quot;Gloriette&quot;&gt;Gloriette&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Greenhouse&quot; title=&quot;Greenhouse&quot;&gt;Greenhouse&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Green_wall&quot; title=&quot;Green wall&quot;&gt;Green wall&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Grotto&quot; title=&quot;Grotto&quot;&gt;Grotto&lt;/a&gt;
&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Shell_grotto&quot; title=&quot;Shell grotto&quot;&gt;Shell grotto&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;mw-selflink selflink&quot;&gt;Ha-ha&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Hedge&quot; title=&quot;Hedge&quot;&gt;Hedge&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Hedge_maze&quot; title=&quot;Hedge maze&quot;&gt;Hedge maze&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Herbaceous_border&quot; title=&quot;Herbaceous border&quot;&gt;Herbaceous border&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Horaisan&quot; title=&quot;Horaisan&quot;&gt;Horaisan&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Jeux_d%27eau&quot; title=&quot;Jeux d'eau&quot;&gt;Jeux d'eau&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Lawn&quot; title=&quot;Lawn&quot;&gt;Lawn&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Monopteros&quot; title=&quot;Monopteros&quot;&gt;Monopteros&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Moon_bridge&quot; title=&quot;Moon bridge&quot;&gt;Moon bridge&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Moon_gate&quot; title=&quot;Moon gate&quot;&gt;Moon gate&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Mound&quot; title=&quot;Mound&quot;&gt;Mound&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Nymphaeum&quot; title=&quot;Nymphaeum&quot;&gt;Nymphaeum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Orangery&quot; title=&quot;Orangery&quot;&gt;Orangery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Parterre&quot; title=&quot;Parterre&quot;&gt;Parterre&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Patio&quot; title=&quot;Patio&quot;&gt;Patio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Pavilion&quot; title=&quot;Pavilion&quot;&gt;Pavilion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Pergola&quot; title=&quot;Pergola&quot;&gt;Pergola&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Reflecting_pool&quot; title=&quot;Reflecting pool&quot;&gt;Reflecting pool&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Stepping_stones&quot; title=&quot;Stepping stones&quot;&gt;Stepping stones&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Stumpery&quot; title=&quot;Stumpery&quot;&gt;Stumpery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Sylvan_theater&quot; title=&quot;Sylvan theater&quot;&gt;Sylvan theater&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Terrace_garden&quot; title=&quot;Terrace garden&quot;&gt;Terrace&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Topiary&quot; title=&quot;Topiary&quot;&gt;Topiary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Trellis_(architecture)&quot; title=&quot;Trellis (architecture)&quot;&gt;Trellis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Turf_maze&quot; title=&quot;Turf maze&quot;&gt;Turf maze&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Water_garden&quot; title=&quot;Water garden&quot;&gt;Water garden&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Zig-zag_bridge&quot; title=&quot;Zig-zag bridge&quot;&gt;Zig-zag bridge&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;!-- 
NewPP limit report
Parsed by mw1227
Cached time: 20190825181725
Cache expiry: 2592000
Dynamic content: false
Complications: [vary&amp;#8208;revision&amp;#8208;sha1]
CPU time usage: 0.620 seconds
Real time usage: 0.814 seconds
Preprocessor visited node count: 1541/1000000
Preprocessor generated node count: 0/1500000
Post&amp;#8208;expand include size: 37634/2097152 bytes
Template argument size: 1913/2097152 bytes
Highest expansion depth: 17/40
Expensive parser function count: 2/500
Unstrip recursion depth: 1/20
Unstrip post&amp;#8208;expand size: 51505/5000000 bytes
Number of Wikibase entities loaded: 0/400
Lua time usage: 0.348/10.000 seconds
Lua memory usage: 13.32 MB/50 MB
--&gt;
&lt;!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  722.990      1 -total
 38.89%  281.155      1 Template:Reflist
 25.59%  184.998      1 Template:Lang-fr
 19.93%  144.107     12 Template:Cite_web
 10.18%   73.572      1 Template:Clarifyme
  8.89%   64.282      1 Template:Fix-span
  6.07%   43.881      4 Template:Category_handler
  5.62%   40.650      1 Template:ISBN
  4.65%   33.648      1 Template:Commonscat
  4.64%   33.577      2 Template:Convert
--&gt;

&lt;!-- Saved in parser cache with key enwiki:pcache:idhash:1536068-0!canonical and timestamp 20190825181747 and revision id 912454658
 --&gt;
&lt;/div&gt;&lt;noscript&gt;&lt;img src=&quot;https://en.wikipedia.org/wiki/Special:CentralAutoLogin/start?type=1x1&quot; alt=&quot;&quot; title=&quot;&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border: none; position: absolute;&quot;/&gt;&lt;/noscript&gt;&lt;/div&gt;
		
		&lt;div class=&quot;printfooter&quot;&gt;Retrieved from &quot;&lt;a dir=&quot;ltr&quot; href=&quot;https://en.wikipedia.org/w/index.php?title=Ha-ha&amp;amp;oldid=912454658&quot;&gt;https://en.wikipedia.org/w/index.php?title=Ha-ha&amp;amp;oldid=912454658&lt;/a&gt;&quot;&lt;/div&gt;
		
		
		&lt;div class=&quot;visualClear&quot;/&gt;
		
	</description>
<pubDate>Sat, 24 Aug 2019 23:12:21 +0000</pubDate>
<dc:creator>EndXA</dc:creator>
<og:image>https://upload.wikimedia.org/wikipedia/commons/e/eb/Ha_ha_wall_diagram.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://en.wikipedia.org/wiki/Ha-ha</dc:identifier>
</item>
<item>
<title>Show HN: Sourcery – get a free, self-updating website</title>
<link>https://sourceryapp.com</link>
<guid isPermaLink="true" >https://sourceryapp.com</guid>
<description>&lt;style data-emotion-css=&quot;1n9zv1w&quot;&gt;&lt;![CDATA[.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_375/muffins);background-position:center;background-size:cover;height:87vh;min-height:400px;}@media (min-width:375px){.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_768/muffins);}}@media (min-width:768px){.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_1024/muffins);}}@media (min-width:1024px){.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_1100/muffins);}}@media (min-width:1100px){.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_1280/muffins);}}@media (min-width:1280px){.css-1n9zv1w{background-image:url(https://res.cloudinary.com/sourcery/image/upload/c_scale,f_auto,q_auto:good,w_1440/muffins);}}.css-1n9zv1w:before{content:&quot;&quot;;background-color:rgba(0,0,0,.45);bottom:0;left:0;position:absolute;right:0;top:0;}]]&gt;&lt;/style&gt;&lt;p&gt;&lt;style data-emotion-css=&quot;1a3shvn&quot;&gt;&lt;![CDATA[.css-1a3shvn{margin:0 auto;max-width:1200px;padding-top:60px;padding-bottom:60px;padding-left:5vw;padding-right:5vw;position:relative;width:100%;}.css-1a3shvn::before{border-color:initial;content:&quot;&quot;;display:block;left:0;margin:0 5vw;position:absolute;right:0;top:0;}.css-1a3shvn:not(.standout):not(.standoutBorder) + .css-1a3shvn:not(.standout):not(.standoutBorder){padding-top:0;}.css-1a3shvn.standout:last-of-type,.css-1a3shvn.standoutBorder:last-of-type{margin-bottom:0;}@media (min-width:375px){.css-1a3shvn.standout:last-of-type,.css-1a3shvn.standoutBorder:last-of-type{margin-bottom:0;}}@media (min-width:768px){.css-1a3shvn.standout:last-of-type,.css-1a3shvn.standoutBorder:last-of-type{margin-bottom:0;}}@media (min-width:1024px){.css-1a3shvn.standout:last-of-type,.css-1a3shvn.standoutBorder:last-of-type{margin-bottom:80px;}}]]&gt;&lt;/style&gt;&lt;section class=&quot;css-1a3shvn &quot;&gt;&lt;style data-emotion-css=&quot;pthpg6&quot;&gt;&lt;![CDATA[.css-pthpg6{font-size:44px !important;margin-bottom:8px;text-align:left !important;}@media (min-width:375px){.css-pthpg6{font-size:60px !important;}}@media (min-width:768px){.css-pthpg6{font-size:64px !important;}}]]&gt;&lt;/style&gt;&lt;style data-emotion-css=&quot;15f9jbm&quot;&gt;&lt;![CDATA[.css-15f9jbm{font-size:20px;margin-bottom:32px;margin-top:0;}@media (min-width:375px){.css-15f9jbm{font-size:20px;}}@media (min-width:768px){.css-15f9jbm{font-size:36px;}}]]&gt;&lt;/style&gt;&lt;h4 class=&quot;css-15f9jbm&quot;&gt;In seconds. For free.&lt;/h4&gt;&lt;/section&gt;&lt;/p&gt;</description>
<pubDate>Sat, 24 Aug 2019 22:32:10 +0000</pubDate>
<dc:creator>jarnoux</dc:creator>
<dc:identifier>https://sourceryapp.com/</dc:identifier>
</item>
<item>
<title>Does the Amazon provide 20% of our oxygen?</title>
<link>http://www.yadvindermalhi.org/blog/does-the-amazon-provide-20-of-our-oxygen</link>
<guid isPermaLink="true" >http://www.yadvindermalhi.org/blog/does-the-amazon-provide-20-of-our-oxygen</guid>
<description>&lt;td valign=&quot;top&quot;&gt;
&lt;div id=&quot;322507089942590282-blog&quot; class=&quot;blog-body&quot;&gt;
&lt;div id=&quot;wsite-content&quot;&gt;
&lt;div id=&quot;blog-post-910891241286931651&quot; class=&quot;blog-post&quot; readability=&quot;57.875583722482&quot;&gt;
&lt;div class=&quot;blog-header&quot;&gt;

&lt;p class=&quot;blog-date&quot;&gt;&lt;span class=&quot;date-text&quot;&gt;24/8/2019&lt;/span&gt;&lt;/p&gt;
&lt;p class=&quot;blog-comments&quot;&gt;&lt;a href=&quot;http://www.yadvindermalhi.org/blog/does-the-amazon-provide-20-of-our-oxygen#comments&quot; class=&quot;blog-link&quot;&gt;24 Comments&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;div class=&quot;blog-content&quot; readability=&quot;37&quot;&gt;
&lt;div class=&quot;paragraph&quot; readability=&quot;7&quot;&gt;&lt;span readability=&quot;4&quot;&gt;The news is full of the surge in deforestation and fires in the Amazon rainforest, and and I have been fielding various media enquiries about what is causing this rise and what it means for our atmosphere. The increases fires have major consequences for regional climate, the rich Amazonian biodiversity, air quality and human health, and some consequence for global carbon emissions (though still small compared to the amount being emitted by fossil fuel combustion in industrialised parts of the world). One thing I am often asked on is to comment on the statement that &quot;the Amazon provides 20% of our oxygen&quot;, a statement now being used by, among others, the President of France and the Secretary General of the UN. This statement is basically incorrect and based on a partial understanding of how ecosystems function. There are lots of reasons to be concerned about the Amazon and the current fires, including regional climate, human health affects of pollution, loss of the most biodiversity rich area of the planet and global carbon emissions. But running out of oxygen isn't one of them.&lt;p&gt;​Below  I lay out the science of where this number comes from, and why it is incorrect when you have a whole-ecosystem view of the Amazon.&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;paragraph&quot; readability=&quot;8.5&quot;&gt;&lt;br/&gt;&lt;span readability=&quot;7&quot;&gt;The 20% figure comes from a partial understanding of the global oxygen cycle.&lt;br/&gt;The tropical forests account for about a 34% of global photosynthesis. This is shown in the figure below (Beer et al. 2010, &lt;em&gt;Science&lt;/em&gt;). The figure shows the global land distribution of photosynthesis - the rainforests are the big red patches and the Amazon accounts for about one half of the world's rainforests. Tropical rainforests photosynthesise so much because they have a year-long growing season not constrained by winter or drought. The units in the figure at g of carbon per square metre, and in the summary Table below the units are Pg (petagrams) of carbon. Pg of carbon taken up by photosynthesis but can be converted to Pg of oxygen released  by multiplying by 2.67. One petagram is 10&lt;span&gt;^15&lt;/span&gt; g, or a thousand million million grams, it is also often called a gigatonne, a thousand million tonnes).&lt;p&gt;Photosynthesis takes up carbon dioxide from the air but produces oxygen, as in the famous school textbook equation, which belie a fantastically complex and still incompletely understood marvel of nature:&lt;br/&gt;6CO&lt;span&gt;2&lt;/span&gt; + 6H&lt;span&gt;2&lt;/span&gt;O —&amp;gt; C&lt;span&gt;6&lt;/span&gt;H&lt;span&gt;12&lt;/span&gt;O&lt;span&gt;6&lt;/span&gt; + 6O&lt;span&gt;2&lt;/span&gt;&lt;br/&gt;The 2.67 multiplying factor comes from the molecular weight of O&lt;span&gt;2&lt;/span&gt; (32) divided by that of carbon (12).&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div class=&quot;wsite-image wsite-image-border-none&quot;&gt;&lt;a&gt;&lt;img src=&quot;http://www.yadvindermalhi.org/uploads/1/8/7/6/18767612/screenshot-2019-08-24-at-06-31-02_orig.png&quot; alt=&quot;Picture&quot;/&gt;&lt;/a&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;span&gt;Table 1 from the same paper shows the total photosynthesis (also known as Gross Primary Productivity or GPP) of each major land biome. We need to multiplying by 2.67 to convert to total oxygen production. Hence total oxygen production by photosynthesis on land is around 330 Pg of oxygen per year. The Amazon (just under half of the tropical forests) is around 16% of this, around 54 Pg of oxygen per year. Rounded up, this is where the 20% figure comes from. 16% of the oxygen being produced on land today is from photosynthesis in the Amazon.&lt;/span&gt;&lt;/p&gt;
&lt;div&gt;
&lt;div class=&quot;wsite-image wsite-image-border-none&quot;&gt;&lt;a&gt;&lt;img src=&quot;http://www.yadvindermalhi.org/uploads/1/8/7/6/18767612/screenshot-2019-08-24-at-06-52-47_orig.png&quot; alt=&quot;Picture&quot;/&gt;&lt;/a&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot; readability=&quot;16&quot;&gt;&lt;span readability=&quot;22&quot;&gt;But, rather like the Buddhist parable of the blind monks who each can only feel part of the elephant and therefore disagree on what the animal is, there are (at least) two important additional bits of information needed for a full picture.&lt;p&gt;First, the phytoplankton in the oceans also photosynthesise, generating around 240 Pg of oxygen per year. So total global photosynthesis (land and sea) produces about 570 Pg of oxygen per year. Therefore in terms of TOTAL global photosynthesis, photosynthesis in the Amazon contributes around 9%. This is smaller, but still substantial.&lt;/p&gt;&lt;p&gt;Second, a bigger point that is often missed is that the Amazon consumes about as much oxygen as it produces. This is shown in the diagram below. Plants produce oxygen through photosynthesis (green arrow). However, the the same plants consume the equivalent of over half the oxygen they produce in their own respiration (blue arrows: my own team's research suggests this is more like 60%). Plants metabolise just as animals do, just at a slower rate, and at night when there is no photosynthesis forests are net absorbers of oxygen. The remaining 40% of the Amazon oxygen budget is consumed mainly by microbes breaking down the dead leaves and wood of the rainforest, a natural process called heterotrophic respiration (dark blue arrows).&lt;br/&gt;These process of plant and heterotrophic respiration are effectively the reverse of the photosynthesis equation above.&lt;br/&gt;​&lt;br/&gt;So, in all practical terms, &lt;strong&gt;the net contribution of the Amazon ECOSYSTEM (not just the plants alone) to the world's oxygen is effectively zero&lt;/strong&gt;. The same is pretty much true of any ecosystem on Earth, at least on the timescales that are relevant to humans (less than millions of years).&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;
&lt;div class=&quot;wsite-image wsite-image-border-none&quot;&gt;&lt;a&gt;&lt;img src=&quot;http://www.yadvindermalhi.org/uploads/1/8/7/6/18767612/screenshot-2019-08-24-at-07-17-41_orig.png&quot; alt=&quot;Picture&quot;/&gt;&lt;/a&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot; readability=&quot;9&quot;&gt;&lt;span readability=&quot;8&quot;&gt;The oxygen levels in the atmosphere are set on million year timescales by the subtle balance of geological, chemical and biological processes. They are not set by the short term (short term equals anything less than hundreds of thousands of years) activities or existence of current biomes. &lt;p&gt;A final point to make is that the atmosphere is awash with oxygen, at 20.95% or 209,500 ppm (parts per million). Carbon dioxide, by comparison, is around 405 ppm, &lt;/p&gt;&lt;/span&gt;&lt;span&gt;over 500 times less than oxygen,&lt;/span&gt;&lt;span&gt; and rising by around 2-3 ppm per year. Human activity (around 90% of which being fossil fuel combustion) has caused this oxygen concentration to drop by around 0.005% since 1990, a trivial amount. In parallel, the same activities have caused carbon dioxide concentrations to rise by by 37 ppm since 1990, or 10%. This is a much more substantial percentage because there is so little carbon dioxide in the atmosphere to begin with, so human activities that emit or absorb carbon dioxide can make a major difference. This is why we need to worry about the increase of  carbon dioxide in the atmosphere (and its resulting impact on climate), and why we don't need to worry about running out of oxygen.&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;



&lt;/div&gt;


&lt;/div&gt;
&lt;/div&gt;
&lt;/td&gt;&lt;td class=&quot;blog-sidebar&quot; valign=&quot;top&quot;&gt;

&lt;/td&gt;
</description>
<pubDate>Sat, 24 Aug 2019 21:18:04 +0000</pubDate>
<dc:creator>mchouza</dc:creator>
<og:title>does the amazon provide 20% of our oxygen?</og:title>
<og:description>The news is full of the surge in deforestation and fires in the Amazon rainforest, and and I have been fielding various media enquiries about what is causing this rise and what it means for our...</og:description>
<og:image>http://www.yadvindermalhi.org/uploads/1/8/7/6/18767612/screenshot-2019-08-24-at-06-31-02_orig.png</og:image>
<og:url>http://www.yadvindermalhi.org/1/post/2019/08/does-the-amazon-provide-20-of-our-oxygen.html</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.yadvindermalhi.org/blog/does-the-amazon-provide-20-of-our-oxygen</dc:identifier>
</item>
<item>
<title>Apollo Guidance Computer switching power supply works after 50 years</title>
<link>http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html</link>
<guid isPermaLink="true" >http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html</guid>
<description>&lt;p&gt;We recently restored an Apollo Guidance Computer, the revolutionary computer that helped navigate to the Moon and land on its surface.&lt;span id=&quot;fnref:owner&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:owner&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/span&gt; At a time when most computers filled rooms, the Apollo Guidance Computer (AGC) took up just a cubic foot. This blog post discusses the small but complex switching power supplies that helped make the AGC compact enough to fit onboard the spacecraft.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/opened-agc-table.jpg&quot;&gt;&lt;img alt=&quot;Inside the Apollo Guidance Computer. The power supplies are the tangles of wires on the far left.&quot; class=&quot;hilite&quot; height=&quot;327&quot; src=&quot;http://static.righto.com/images/agc-power/opened-agc-table-w600.jpg&quot; title=&quot;Inside the Apollo Guidance Computer. The power supplies are the tangles of wires on the far left.&quot; width=&quot;600&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;Inside the Apollo Guidance Computer. The power supplies are the tangles of wires on the far left.&lt;/div&gt;
&lt;p&gt;The photo above shows the Apollo Guidance Computer after separating its two trays. Tray A on the left holds the logic and interface modules, while Tray B on the right has the memory circuitry. The AGC has two power supplies in Tray A on the far left: a +4V power supply and a +14V power supply; the power supplies look like a tangle of wires in the photo. The logic circuitry, entirely built from NOR gates, was powered by 4 volts. The interface circuitry and memory used the 14 volt supply.&lt;/p&gt;
&lt;p&gt;The spacecraft generated 28 volts from fuel cells, which combined hydrogen and oxygen to produce both water and electricity.&lt;span id=&quot;fnref:buses&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:buses&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/span&gt; The task of the power supplies was to convert the spacecraft's 28 volts into the 4 and 14 volts required by the computer.&lt;span id=&quot;fnref:blocks&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:blocks&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/span&gt; The 4-volt power supply could output about 10 amps (i.e. 40 watts) while the 14-volt power supply could output about 5 amps (i.e. 70 watts).&lt;span id=&quot;fnref:wattage&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:wattage&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/span&gt; Thus, the power supplies are roughly equivalent to laptop chargers (although a laptop charger deals with more challenging AC line voltages).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/module-in-front-of-agc.jpg&quot;&gt;&lt;img alt=&quot;The power supply module in front of the AGC. The module in position A30 provides +14 volts, while the (identical) module in position A31 provides +4 volts.&quot; class=&quot;hilite&quot; height=&quot;366&quot; src=&quot;http://static.righto.com/images/agc-power/module-in-front-of-agc-w700.jpg&quot; title=&quot;The power supply module in front of the AGC. The module in position A30 provides +14 volts, while the (identical) module in position A31 provides +4 volts.&quot; width=&quot;700&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;The power supply module in front of the AGC. The module in position A30 provides +14 volts, while the (identical) module in position A31 provides +4 volts.&lt;/div&gt;

&lt;p&gt;The power supplies, like the AGC's other non-logic modules, were built with &lt;a href=&quot;https://en.wikipedia.org/wiki/Printed_circuit_board#Cordwood_construction&quot;&gt;cordwood construction&lt;/a&gt;. In this high-density technique, cylindrical components were inserted into holes in the module, passing through the module, with their leads exiting on either side.&lt;span id=&quot;fnref:cordwood&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:cordwood&quot; rel=&quot;footnote&quot;&gt;6&lt;/a&gt;&lt;/span&gt; The left side of the photo below contains resistors, capacitors, and diodes. Because of the cordwood construction, the components are not visible except for the ends of their leads poking through holes. Point-to-point wiring connected the components with welded connections. (The other side of the module is similar, connecting the other ends of the components.) The shiny rectangle on the right is a relay, used to shut off power for standby operation. The ends of large filter capacitors are visible below the relay.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/cordwood.jpg&quot;&gt;&lt;img alt=&quot;Cordwood construction in the power supply. On the left, components are mounted vertically through the module, with welded wiring on both sides. The metallic box on the right is a relay. Underneath the relay, the ends of filter capacitors are visible.&quot; class=&quot;hilite&quot; height=&quot;380&quot; src=&quot;http://static.righto.com/images/agc-power/cordwood-w600.jpg&quot; title=&quot;Cordwood construction in the power supply. On the left, components are mounted vertically through the module, with welded wiring on both sides. The metallic box on the right is a relay. Underneath the relay, the ends of filter capacitors are visible.&quot; width=&quot;600&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;Cordwood construction in the power supply. On the left, components are mounted vertically through the module, with welded wiring on both sides. The metallic box on the right is a relay. Underneath the relay, the ends of filter capacitors are visible.&lt;/div&gt;
&lt;p&gt;Cordwood construction was used for high density in applications from aerospace to &lt;a href=&quot;http://nixiebunny.com/cdc6600/index.html&quot;&gt;Cray's CDC 6600 computer&lt;/a&gt;. For flight, the AGC's cordwood wiring was encased (potted) in epoxy, protecting it from vibration.&lt;/p&gt;

&lt;p&gt;Because the power supplies needed to be lightweight and efficient, they were switching power supplies, an unusual technology for the time. Most computers back then used linear power supplies, which were simpler but much too inefficient for the AGC since excess voltage is turned into waste heat.&lt;span id=&quot;fnref:waste&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:waste&quot; rel=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/span&gt; A switching power supply, on the other hand, switches the input voltage on and off at a high frequency. This yields the desired output voltage with very little wasted energy.&lt;/p&gt;
&lt;p&gt;The AGC's power supplies used a common switching circuit called a &lt;a href=&quot;https://en.wikipedia.org/wiki/Buck_converter&quot;&gt;buck converter&lt;/a&gt;, which converts an input voltage to a lower voltage. The diagram below shows the key components: a switch (transistor), inductor, diode, and capacitor. The key idea is that if the switch is closed for more time, more of the input voltage will appear across the load. Thus, the output voltage is controlled by the switch timing. The inductor stores energy and releases it when the switch is open, producing a relatively stable output.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/Buck_operating.png&quot;&gt;&lt;img alt=&quot;A buck converter rapidly switches between the on state and the off state. When on, current flows from the voltage source (V) through the switch and inductor to the load (right). When the switch is open, stored energy in the inductor continues to provide current to the load, through the diode. (Source: Cyril Buttay, CC BY-SA 2.5).&quot; class=&quot;hilite&quot; height=&quot;300&quot; src=&quot;http://static.righto.com/images/agc-power/Buck_operating-w400.png&quot; title=&quot;A buck converter rapidly switches between the on state and the off state. When on, current flows from the voltage source (V) through the switch and inductor to the load (right). When the switch is open, stored energy in the inductor continues to provide current to the load, through the diode. (Source: Cyril Buttay, CC BY-SA 2.5).&quot; width=&quot;400&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;A buck converter rapidly switches between the on state and the off state. When on, current flows from the voltage source (V) through the switch and inductor to the load (right). When the switch is open, stored energy in the inductor continues to provide current to the load, through the diode. (Source: &lt;a href=&quot;https://commons.wikimedia.org/wiki/File:Buck_operating.svg&quot;&gt;Cyril Buttay&lt;/a&gt;, &lt;a href=&quot;https://creativecommons.org/licenses/by-sa/2.5/deed.en&quot;&gt;CC BY-SA 2.5&lt;/a&gt;).&lt;/div&gt;
&lt;p&gt;A switching power supply requires a complex control mechanism to switch on and off at the right time. The AGC used a technique called PWM (pulse-width modulation), where power is switched on and off at a fixed frequency (e.g. 20 kilohertz), but changing the fraction of the time the power is on to regulate the voltage.&lt;/p&gt;
&lt;p&gt;The schematic below shows the AGC's power supply. (Don't worry about reading the details; click for a larger version.) The buck converter itself (outlined in the lower right) has the expected switching transistor, diode, inductor, and capacitors. However, the power supply has many more components to implement the PWM control circuitry.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/schematic-labeled.jpg&quot;&gt;&lt;img alt=&quot;Schematic of the AGC's power supply. The main signals are highlighted: 28-volt input (red), 4-volt output (orange), reference voltage (green), comparator output to control the PWM (purple), and PWM output (brown). (source)&quot; class=&quot;hilite&quot; height=&quot;439&quot; src=&quot;http://static.righto.com/images/agc-power/schematic-labeled-w1000.jpg&quot; title=&quot;Schematic of the AGC's power supply. The main signals are highlighted: 28-volt input (red), 4-volt output (orange), reference voltage (green), comparator output to control the PWM (purple), and PWM output (brown). (source)&quot; width=&quot;1000&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;Schematic of the AGC's power supply. The main signals are highlighted: 28-volt input (red), 4-volt output (orange), reference voltage (green), comparator output to control the PWM (purple), and PWM output (brown). (&lt;a href=&quot;https://archive.org/details/apollolunarexcuracel/page/n241&quot;&gt;source&lt;/a&gt;)&lt;/div&gt;
&lt;p&gt;To summarize the power supply's operation, 28 volts (red) is supplied at the upper left and filtered. The buck converter in the output circuit (right) reduces the voltage to 4 volts (orange) On the control side (left), the output voltage is used for feedback. A two-transistor comparator (lower left) compares the output voltage with a reference voltage (green) set by a Zener diode and resistor network. The output of the comparator (purple) goes through the PWM control circuit where it modifies the width of the pulses (brown) produced by the PWM circuit. These pulses drive the switching transistor in the buck converter, closing the feedback loop. The computer's clock signal providing timing for the PWM circuit.&lt;span id=&quot;fnref:oscillator&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:oscillator&quot; rel=&quot;footnote&quot;&gt;7&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/ibiblio-dsky.jpg&quot;&gt;&lt;img alt=&quot;Astronauts interacted with the AGC through the Display/Keyboard (DSKY). The STBY button (lower right) put the computer in standby mode, which was indicated via the STBY light (left). Photo from Virtual AGC. &quot; class=&quot;hilite&quot; height=&quot;386&quot; src=&quot;http://static.righto.com/images/agc-power/ibiblio-dsky-w350.jpg&quot; title=&quot;Astronauts interacted with the AGC through the Display/Keyboard (DSKY). The STBY button (lower right) put the computer in standby mode, which was indicated via the STBY light (left). Photo from Virtual AGC. &quot; width=&quot;350&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;Astronauts interacted with the AGC through the Display/Keyboard (DSKY). The STBY button (lower right) put the computer in standby mode, which was indicated via the STBY light (left). Photo from &lt;a href=&quot;https://www.ibiblio.org/apollo/yaDSKY.html&quot;&gt;Virtual AGC&lt;/a&gt;.&lt;/div&gt;
&lt;p&gt;The power supply also included a standby circuit. By pressing the STBY key on the display/keyboard (DSKY), a relay would disconnect most of the computer's power. This reduced energy consumption when the computer wasn't needed.&lt;span id=&quot;fnref:dsky&quot;&gt;&lt;a class=&quot;ref&quot; href=&quot;http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html#fn:dsky&quot; rel=&quot;footnote&quot;&gt;8&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The diagram below shows the top of the power supply module with the major components labeled. Note the large size of the transistors, inductors and filter capacitors compared to the tightly-packed cordwood circuitry on the left. The switching transistor for the buck converter is almost an &lt;a href=&quot;http://www.ibiblio.org/apollo/SCDs/scd_1006317-.pdf&quot;&gt;inch&lt;/a&gt; in diameter.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/labeled-components.jpg&quot;&gt;&lt;img alt=&quot;The major components of the AGC's power supply. The components for the buck converter are much larger than the control circuitry.&quot; class=&quot;hilite&quot; height=&quot;284&quot; src=&quot;http://static.righto.com/images/agc-power/labeled-components-w800.jpg&quot; title=&quot;The major components of the AGC's power supply. The components for the buck converter are much larger than the control circuitry.&quot; width=&quot;800&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;The major components of the AGC's power supply. The components for the buck converter are much larger than the control circuitry.&lt;/div&gt;
&lt;p&gt;The transistors of the 1960s were barely able to support switching power supplies since they required a power transistor that could operate at both high speed and high current, which was difficult at the time. (Modern transistors (MOSFETs) are cheap and can handle much higher voltages, leading to ubiquitous low-cost phone and laptop chargers that run off an AC outlet.) The switching transistor required a high-current control signal, which was provided by three drive transistors (in a &lt;a href=&quot;https://en.wikipedia.org/wiki/Complementary_feedback_pair&quot;&gt;&quot;complementary Darlington&quot;&lt;/a&gt; configuration).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/transistor-closeup.jpg&quot;&gt;&lt;img alt=&quot;Closeup of transistors in the power supply. The large transistor on the right is the high-current switching transistor. Driving it required the three transistors on the left.&quot; class=&quot;hilite&quot; height=&quot;260&quot; src=&quot;http://static.righto.com/images/agc-power/transistor-closeup-w500.jpg&quot; title=&quot;Closeup of transistors in the power supply. The large transistor on the right is the high-current switching transistor. Driving it required the three transistors on the left.&quot; width=&quot;500&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;Closeup of transistors in the power supply. The large transistor on the right is the high-current switching transistor. Driving it required the three transistors on the left.&lt;/div&gt;

&lt;p&gt;We extensively tested the AGC's components before powering up the system. For the power supply, we first checked all the &lt;a href=&quot;http://www.ibiblio.org/apollo/SCDs/scd_1006755-.pdf&quot;&gt;tantalum capacitors&lt;/a&gt; since tantalum capacitors are prone to shorting out. We found that the capacitors were all in good shape with the proper capacitances. This is in contrast to modern capacitors, which often leak or fail after a few years. NASA used expensive aerospace-grade capacitors and X-rayed each one to test for faults, and this made a large difference.&lt;/p&gt;
&lt;p&gt;Wiring up each power supply for testing (below) was more complex than you might expect. The AGC used two identical power supplies that supplied 4 or 14 volts. The output voltage was selected by backplane wiring that connected different resistors in the feedback resistor network. We reproduced these connections on a breadboard, as well as connecting up the input and output. Some high-wattage resistors (lower right) served as the load.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/power-supply-strapping.jpg&quot;&gt;&lt;img alt=&quot;The setup we used to test the power supply. Connections were made to the pins on the bottom of the module. These pins connected the module to the rest of the AGC. In this view you can see the white wires on the side of the module that connected the circuitry on top of the module to the pins on the bottom.&quot; class=&quot;hilite&quot; height=&quot;288&quot; src=&quot;http://static.righto.com/images/agc-power/power-supply-strapping-w400.jpg&quot; title=&quot;The setup we used to test the power supply. Connections were made to the pins on the bottom of the module. These pins connected the module to the rest of the AGC. In this view you can see the white wires on the side of the module that connected the circuitry on top of the module to the pins on the bottom.&quot; width=&quot;400&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;The setup we used to test the power supply. Connections were made to the pins on the bottom of the module. These pins connected the module to the rest of the AGC. In this view you can see the white wires on the side of the module that connected the circuitry on top of the module to the pins on the bottom.&lt;/div&gt;
&lt;p&gt;We powered-up the AGC modules with 28 volts using a current-limited supply to limit potential damage from any faults. We took measurements and found that 4V power supply produced 4.09 volts while the 14V power supply produced 14.02 volts. The quality of the power was good, with about 30mV of ripple. We were somewhat surprised that both power supplies worked flawlessly after 50 years.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The Apollo Guidance Computer used advanced switching power supplies that were lightweight and efficient. While switching power supplies were exotic in the 1960s, improved semiconductors have made them cheap and ubiquitous. Now the switching transistor, a high-precision voltage reference, and the control logic can be combined on a single chip. The modern equivalent of the AGC's power supply is a tiny 5A buck converter for $1.50 on &lt;a href=&quot;https://www.ebay.com/itm/DC-DC-Buck-Step-Down-Adjustable-Volt-Converter-5V-36V-to-3-3V-6V-9V-12V-24V-5A/263198737343&quot;&gt;eBay&lt;/a&gt; (below). While I wouldn't trust this converter to get to the moon, let alone still work 50 years from now, it illustrates the dramatic improvements in switching power supply technology. (I've written more about the &lt;a href=&quot;https://spectrum.ieee.org/computing/hardware/a-half-century-ago-better-transistors-and-switching-regulators-revolutionized-the-design-of-computer-power-supplies&quot;&gt;history of switching power supplies&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.righto.com/images/agc-power/modern-buck.jpg&quot;&gt;&lt;img alt=&quot;A modern 5A buck converter is compact and costs $1.50.&quot; class=&quot;hilite&quot; height=&quot;224&quot; src=&quot;http://static.righto.com/images/agc-power/modern-buck-w350.jpg&quot; title=&quot;A modern 5A buck converter is compact and costs $1.50.&quot; width=&quot;350&quot;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;cite&quot;&gt;A modern 5A buck converter is compact and costs $1.50.&lt;/div&gt;
&lt;p&gt;To learn more about our AGC restoration, see Marc's &lt;a href=&quot;https://www.youtube.com/watch?v=2KSahAoOLdU&quot;&gt;series of AGC videos&lt;/a&gt;; the video below shows us testing the power supplies. I announce my latest blog posts on Twitter, so follow me &lt;a href=&quot;https://twitter.com/kenshirriff&quot;&gt;@kenshirriff&lt;/a&gt; for future articles. I also have an &lt;a href=&quot;http://www.righto.com/feeds/posts/default&quot;&gt;RSS feed&lt;/a&gt;. Thanks to Mike Stewart for photos.&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/9Ys-VshuOLQ?start=649&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;[embedded content]&lt;/iframe&gt;
&lt;h2&gt;Notes and references&lt;/h2&gt;


</description>
<pubDate>Sat, 24 Aug 2019 19:30:34 +0000</pubDate>
<dc:creator>asmithmd1</dc:creator>
<og:url>http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html</og:url>
<og:title>Reliable after 50 years: The Apollo Guidance Computer's switching power supplies</og:title>
<og:description>We recently restored an Apollo Guidance Computer, the revolutionary computer that helped navigate to the Moon and land on its surface. 1 At...</og:description>
<og:image>https://lh6.googleusercontent.com/proxy/pbvXtonVUX5HAglW2j0NDYCKjfH_9WNmNDxUahrr8WfLDm340-lBlyv6uOq6zW6xpjSoHZPEt8N1QIY4qOP36wVDSTnnpCcoAuBQvZ6L8w1MTR9M1nc_=w1200-h630-p-k-no-nu</og:image>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.righto.com/2019/08/reliable-after-50-years-apollo-guidance.html</dc:identifier>
</item>
<item>
<title>NASA said to be investigating first allegation of a crime in space</title>
<link>https://www.bbc.co.uk/news/world-49457912</link>
<guid isPermaLink="true" >https://www.bbc.co.uk/news/world-49457912</guid>
<description>&lt;figure class=&quot;media-landscape has-caption full-width lead&quot;&gt;&lt;span class=&quot;image-and-copyright-container&quot;&gt;
                
                &lt;img class=&quot;js-image-replace&quot; alt=&quot;Ground personnel help NASA astronaut Anne McClain to get out of the Soyuz MS-11 capsule shortly after landing in a remote area outside Zhezkazgan, Kazakhstan June 25, 2019.&quot; src=&quot;https://ichef.bbci.co.uk/news/320/cpsprodpb/6B9C/production/_108484572_mediaitem108484571.jpg&quot; width=&quot;976&quot; height=&quot;549&quot;/&gt;&lt;span class=&quot;off-screen&quot;&gt;Image copyright&lt;/span&gt;
                 &lt;span class=&quot;story-image-copyright&quot;&gt;Reuters&lt;/span&gt;
                
            &lt;/span&gt;
            
            &lt;figcaption class=&quot;media-caption&quot;&gt;&lt;span class=&quot;off-screen&quot;&gt;Image caption&lt;/span&gt;
                &lt;span class=&quot;media-caption__text&quot;&gt;
                    Anne McClain is helped from a space capsule after returning from the ISS in June
                &lt;/span&gt;
            &lt;/figcaption&gt;&lt;/figure&gt;&lt;p class=&quot;story-body__introduction&quot;&gt;Nasa is reported to be investigating a claim that an astronaut accessed the bank account of her estranged spouse from the International Space Station, in what may be the first allegation of a crime committed in space.&lt;/p&gt;&lt;p&gt;Anne McClain acknowledges accessing the account from the ISS but denies any wrongdoing, the &lt;a href=&quot;https://www.nytimes.com/2019/08/23/us/nasa-astronaut-anne-mcclain.html&quot; class=&quot;story-body__link-external&quot;&gt;New York Times&lt;/a&gt; reports.&lt;/p&gt;&lt;p&gt;Her estranged spouse, Summer Worden, reportedly filed a complaint with the Federal Trade Commission.&lt;/p&gt;&lt;p&gt;Ms McClain has since returned to Earth.&lt;/p&gt;&lt;p&gt;The astronaut told the New York Times through a lawyer that she was merely making sure that the family's finances were in order and there was enough money to pay bills and care for Ms Worden's son - who they had been raising together prior to the split.&lt;/p&gt;&lt;p&gt;&quot;She strenuously denies that she did anything improper,&quot; said her lawyer, Rusty Hardin, adding that Ms McClain was &quot;totally co-operating&quot;.&lt;/p&gt;&lt;ul class=&quot;story-body__unordered-list&quot;&gt;&lt;li class=&quot;story-body__list-item&quot;&gt;&lt;a href=&quot;https://www.bbc.co.uk/news/in-pictures-49439999&quot; class=&quot;story-body__link&quot;&gt;In pictures: Astronauts train in underwater space station&lt;/a&gt;&lt;/li&gt;
&lt;li class=&quot;story-body__list-item&quot;&gt;&lt;a href=&quot;https://www.bbc.co.uk/news/science-environment-49381622&quot; class=&quot;story-body__link&quot;&gt;Nasa picks headquarters for Moon lander&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Ms McClain and Ms Worden, who is an Air Force intelligence officer, married in 2014 and Ms Worden filed for divorce in 2018. Investigators from Nasa's Office of Inspector General have contacted both over the allegation, the New York Times reported.&lt;/p&gt;&lt;p&gt;Ms McClain graduated from the prestigious West Point military academy and flew more than 800 combat hours over Iraq as an Army pilot. She went on to qualify as a test pilot and was chosen to fly for Nasa in 2013.&lt;/p&gt;&lt;p&gt;She spent six months aboard the ISS and had been due to feature in the first all-female spacewalk, but her role was &lt;a href=&quot;https://www.bbc.co.uk/news/world-us-canada-47703734&quot; class=&quot;story-body__link&quot;&gt;cancelled at the last minute over what Nasa said was a problem with availability of correct suit sizes&lt;/a&gt;.&lt;/p&gt;&lt;h2 class=&quot;story-body__crosshead&quot;&gt;How does the law work in space?&lt;/h2&gt;&lt;p&gt;There are five national or international space agencies involved in the ISS - from the US, Canada, Japan, Russia and several European countries - and a legal framework sets out that national law applies to any people and possessions in space.&lt;/p&gt;&lt;p&gt;So if a Canadian national were to commit a crime in space, they would be subject to Canadian law, and a Russian citizen to Russian law. &lt;/p&gt;&lt;p&gt;Space law also sets out provisions for extradition back on Earth, should a nation decide it wishes to prosecute a citizen of another nation for misconduct in space.&lt;/p&gt;&lt;p&gt;As space tourism becomes a reality, so might the need to prosecute space crime, but for now the legal framework remains untested. Nasa officials told the New York Times that they were not aware of any crimes committed on the space station.&lt;/p&gt;
            </description>
<pubDate>Sat, 24 Aug 2019 14:06:50 +0000</pubDate>
<dc:creator>OscarCunningham</dc:creator>
<og:title>Nasa 'probing first allegation of space crime'</og:title>
<og:type>article</og:type>
<og:description>The space agency is reportedly looking into an allegation against astronaut Anne McClain.</og:description>
<og:url>https://www.bbc.com/news/world-49457912</og:url>
<og:image>https://ichef.bbci.co.uk/news/1024/branded_news/6B9C/production/_108484572_mediaitem108484571.jpg</og:image>
<dc:language>en-GB</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.bbc.co.uk/news/world-49457912</dc:identifier>
</item>
</channel>
</rss>