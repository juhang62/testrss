<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Google Photos is making photos semi-public</title>
<link>https://medium.com/@robertwiblin/google-photo-is-making-your-photos-semi-public-and-you-probably-dont-realise-6fcc74e40ac6</link>
<guid isPermaLink="true" >https://medium.com/@robertwiblin/google-photo-is-making-your-photos-semi-public-and-you-probably-dont-realise-6fcc74e40ac6</guid>
<description>&lt;div readability=&quot;5.9098360655738&quot;&gt;

&lt;div class=&quot;gw&quot;&gt;
&lt;div class=&quot;ah ag&quot;&gt;
&lt;div&gt;&lt;a href=&quot;https://medium.com/@robertwiblin&quot;&gt;&lt;img alt=&quot;Robert Wiblin&quot; src=&quot;https://miro.medium.com/fit/c/96/96/0*DB7wa-c4eu_UBcWb.jpg&quot; class=&quot;n dv gx gy&quot; width=&quot;48&quot; height=&quot;48&quot;/&gt;&lt;/a&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;em class=&quot;io&quot;&gt;Careful before you click that share button!&lt;/em&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;I’ve noticed something about Google Photos that is really weird. Crazy enough that I’ve told dozens of Google Photos users and none have believed me. They swear I have to be wrong, until I show them otherwise.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Whenever you share a photo with a specific person or account on Google Photos, it creates a link that will allow anyone in the world to view those photos, forever, until you go and manually deactivate that link in an obscure part of the interface.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;You can see it here:&lt;/p&gt;

&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;What have you just watched? If I go and share a photo with a specific other Google account, I can use that link to view it in:&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;i) another Google account it wasn’t shared with (25 seconds in), and;&lt;br/&gt;ii) an incognito window where I’m not logged into any Google Account at all (39 seconds in)!&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;If that ‘secret’’ link is ever revealed, anyone anywhere will be able to see it until I go and delete that specific sharing instance. And I’d have no way to find out that they were viewing it!&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;People constantly tell me I can’t be right about this — it’ll happen in the comments below, I promise — because the &lt;em class=&quot;je&quot;&gt;interface never indicates that this is going on.&lt;/em&gt; Nowhere did “Create shared URL” or anything similar appear in the video.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Furthermore, the interface looks almost identical to Google Drive, which by default only lets people see a file when logged into the specific account it was shared with.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Drive also lists who a file is shared with when you click the share icon — so people using Photos naturally assume their photos are private when they see that nobody is listed when you click the share icon.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;I can only ever find out that I’ve created this permanent semi-public link by going to the ‘Sharing’ tab in Google Photos, which is very easy to miss. Nothing in the interface relating to that particular photo will show me. And even the Sharing page gives zero indication that you’ve made a &lt;em class=&quot;je&quot;&gt;publicly visible link&lt;/em&gt; rather than just shared a photo with an individual:&lt;/p&gt;

&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Albums work the same way. If you create an album and share it with a specific Google Account, it will create a permanent ‘secret’ URL with all those photos visible to anyone with the link, until you go and delete or un-share the Album from anyone.&lt;/p&gt;

&lt;p class=&quot;ip iq eq bh ir b is js iu jt iw ju iy jv ja jw jc&quot;&gt;Firstly it’s unacceptable because most users don’t realise it’s happening. The interface is so poorly designed that the most common reaction I’ve had when I tell Google Photos users about this is literal disbelief. The only way to convince people is to show them with their own eyes. If our private and potentially sensitive data is going to be revealed this way, it should be clear that it’s going on.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;It’s also unacceptable because it creates an excessive risk of sensitive data being exposed. People often take photos of things like private documents, or themselves naked. It’s very important only the right people get to see these things! Google is a data company that has a responsibility to its users to make sure that’s the case.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;How could the ‘secret’ link end up in the wrong hands? Some possibilities:&lt;/p&gt;
&lt;ol class=&quot;&quot;&gt;&lt;li class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc jx jy jz&quot;&gt;An email thread / document with a link to the photo or album is forwarded or shared with the wrong person, or accidentally posted somewhere public.&lt;/li&gt;
&lt;li class=&quot;ip iq eq bh ir b is ka iu kb iw kc iy kd ja ke jc jx jy jz&quot;&gt;The recipient naturally thinks the link is only works for them (as would be the case for Drive) and doesn’t take care to prevent it becoming public.&lt;/li&gt;
&lt;li class=&quot;ip iq eq bh ir b is ka iu kb iw kc iy kd ja ke jc jx jy jz&quot;&gt;Links sent by emails are semi-public because they move across the internet unencrypted, and are simple to intercept, especially for governments. It’s only OK to link to sensitive things by email if the recipient needs to be logged in to view them.&lt;/li&gt;
&lt;li class=&quot;ip iq eq bh ir b is ka iu kb iw kc iy kd ja ke jc jx jy jz&quot;&gt;A database of these links is one day leaked or hacked, or people figure out a pattern in how the ‘secret’ URLs are generated.&lt;/li&gt;
&lt;li class=&quot;ip iq eq bh ir b is ka iu kb iw kc iy kd ja ke jc jx jy jz&quot;&gt;Someone’s emails or other documents are hacked or leaked, with the links to photos contained inside for all to see.&lt;/li&gt;
&lt;/ol&gt;&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Keep in mind the status quo is for these links to persist &lt;em class=&quot;je&quot;&gt;forever&lt;/em&gt;, providing plenty of time for one of the above things to happen.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Furthermore, if you were discussing a topic by email it wouldn’t be that unusual for exactly the wrong person (e.g. someone at another company, or a member of your extended family) to be later added to a thread and gain access to any photos someone has linked to along the way. Most people have terrible information security practices.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Maybe you don’t care. Fair enough. But if you’re a teenager using Photos to share racy photos with your partner, or an immigration lawyer using Photos to receive and send photographs of client documents, you might well care.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;And for political dissidents around the world, clarity about what they are sharing and with who is a literal matter of life and death.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Would Google use this sharing method for their sensitive internal photos or documents? Not a chance! It would be negligent and likely illegal.&lt;/p&gt;

&lt;p class=&quot;ip iq eq bh ir b is js iu jt iw ju iy jv ja jw jc&quot;&gt;Easy: sharing behaviour in Photos should be changed to match that of Google Drive, which is excellent and transparent.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;On Drive, if the person you want to share with has a Google account, it’s shared with that account exclusively. And if they don’t, you have the opportunity to either send them a link they can convert into permanent access for one Google account of their choice, or knowingly make the file public and send them a link to it.&lt;/p&gt;
&lt;p class=&quot;ip iq eq bh ir b is it iu iv iw ix iy iz ja jb jc&quot;&gt;Until this week you could automatically get photos from an Android phone uploaded to Drive and share them using this far superior interface. But that option was just turned off completely, preventing this workaround. You can read about that in my previous post: &lt;a class=&quot;aq cc kf kg kh ki&quot; href=&quot;https://medium.com/@robertwiblin/googles-new-system-for-drive-photos-image-syncing-is-insane-4b63fe03aae7&quot;&gt;&lt;strong class=&quot;ir kj&quot;&gt;Google’s new system for Drive/Photos image syncing is insane&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
</description>
<pubDate>Sat, 13 Jul 2019 14:42:32 +0000</pubDate>
<dc:creator>robertwiblin</dc:creator>
<og:type>article</og:type>
<og:title>Google Photo is making your photos semi-public and you probably don’t realise</og:title>
<og:description>I’ve noticed something about Google Photos that is weird enough that nobody initially believes it.</og:description>
<og:url>https://medium.com/@robertwiblin/google-photo-is-making-your-photos-semi-public-and-you-probably-dont-realise-6fcc74e40ac6</og:url>
<og:image>https://miro.medium.com/max/1200/1*eIjLCojSG9-IcY4ZhjFp4A.png</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://medium.com/@robertwiblin/google-photo-is-making-your-photos-semi-public-and-you-probably-dont-realise-6fcc74e40ac6</dc:identifier>
</item>
<item>
<title>Elsevier cuts off UC’s access to its academic journals</title>
<link>https://www.latimes.com/business/hiltzik/la-fi-uc-elsevier-20190711-story.html</link>
<guid isPermaLink="true" >https://www.latimes.com/business/hiltzik/la-fi-uc-elsevier-20190711-story.html</guid>
<description>&lt;p&gt;In part, that was a reflection of concerns over a continual run-up in journal subscription costs that UC, along with many other academic institutions, consider to be unsustainable. The very idea of placing scientific research behind a subscription paywall, moreover, can’t be reconciled with the idea that research should be made as widely available as possible. That’s especially so when the same institutions that generate research papers are made to pay for access to them.&lt;/p&gt;
</description>
<pubDate>Sat, 13 Jul 2019 11:19:40 +0000</pubDate>
<dc:creator>bookofjoe</dc:creator>
<og:url>https://www.latimes.com/business/hiltzik/la-fi-uc-elsevier-20190711-story.html</og:url>
<og:title>In act of brinkmanship, a big publisher cuts off UC’s access to its academic journals</og:title>
<og:image>https://www.latimes.com/resizer/oodHsbM5ZqEYYo6j0gXIpX5DyR8=/1200x0/arc-anglerfish-arc2-prod-tronc.s3.amazonaws.com/public/S4RDACYEFFAIHN36UE6RNXQETI.jpg</og:image>
<og:description>Elsevier, the world's largest publishers of academic journals, just stepped up its fight with the University of California by cutting off UC's access.</og:description>
<og:type>article</og:type>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.latimes.com/business/hiltzik/la-fi-uc-elsevier-20190711-story.html</dc:identifier>
</item>
<item>
<title>Facebook is embedding tracking data inside the photos you download</title>
<link>https://twitter.com/oasace/status/1149181539000864769</link>
<guid isPermaLink="true" >https://twitter.com/oasace/status/1149181539000864769</guid>
<description>&lt;p&gt;I suppose the more concerning issue here is that there is already a variety of advanced techniques to inject data inside photos using steganography such that it would be impossible to forensically detect.

If weaponized, it could be used for tracking; with zero proof.&lt;/p&gt;
</description>
<pubDate>Sat, 13 Jul 2019 07:47:35 +0000</pubDate>
<dc:creator>meerita</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://mobile.twitter.com/oasace/status/1149181539000864769</dc:identifier>
</item>
<item>
<title>Show HN: Stein – Use Google Sheets as a No-Setup Database</title>
<link>https://steinhq.com/</link>
<guid isPermaLink="true" >https://steinhq.com/</guid>
<description>[unable to retrieve full-text content]
&lt;p&gt;Article URL: &lt;a href=&quot;https://steinhq.com/&quot;&gt;https://steinhq.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=20426682&quot;&gt;https://news.ycombinator.com/item?id=20426682&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Points: 260&lt;/p&gt;
&lt;p&gt;# Comments: 58&lt;/p&gt;
</description>
<pubDate>Sat, 13 Jul 2019 05:45:51 +0000</pubDate>
<dc:creator>shivensinha4</dc:creator>
<og:title>Ship fast and manage your data with ease. Connect to Google Sheets.</og:title>
<og:url>https://steinhq.com</og:url>
<og:type>website</og:type>
<og:description>Use Google Sheets as your no-setup data store. Build fast and get a familiar interface for managing the data, with the open source Stein.</og:description>
<og:image>https://steinhq.com/assets/OG Image.png</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://steinhq.com/</dc:identifier>
</item>
<item>
<title>How much bandwidth does the spinal cord have?</title>
<link>https://www.reddit.com/r/askscience/comments/7l56sb/how_much_bandwidth_does_the_spinal_cord_have/</link>
<guid isPermaLink="true" >https://www.reddit.com/r/askscience/comments/7l56sb/how_much_bandwidth_does_the_spinal_cord_have/</guid>
<description>&lt;p class=&quot;s1wjcqzz-10 lkEbBw&quot;&gt;I was having an EMG test today and started talking with the neurologist about nerves and their capacity to transmit signals. I asked him what a nerve's rest period was before it can signal again, and if a nerve can handle more than one signal simultaneously. He told me that most nerves can handle many signals in both directions each way, depending on how many were bundled together.&lt;/p&gt;
&lt;p class=&quot;s1wjcqzz-10 lkEbBw&quot;&gt;This got me thinking, given some rough parameters on the speed of signal and how many times the nerve can fire in a second, can the bandwidth of the spinal cord be calculated and expressed as Mb/s?&lt;/p&gt;
</description>
<pubDate>Fri, 12 Jul 2019 20:26:09 +0000</pubDate>
<dc:creator>jacobedawson</dc:creator>
<og:title>r/askscience - How much bandwidth does the spinal cord have?</og:title>
<og:type>website</og:type>
<og:url>https://www.reddit.com/r/askscience/comments/7l56sb/how_much_bandwidth_does_the_spinal_cord_have/</og:url>
<og:description>7,146 votes and 463 comments so far on Reddit</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.reddit.com/r/askscience/comments/7l56sb/how_much_bandwidth_does_the_spinal_cord_have/</dc:identifier>
</item>
<item>
<title>A problem worse than Zoom?</title>
<link>https://lapcatsoftware.com/articles/zoom.html</link>
<guid isPermaLink="true" >https://lapcatsoftware.com/articles/zoom.html</guid>
<description>&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;/&gt;&lt;meta name=&quot;twitter:card&quot; content=&quot;summary&quot;/&gt;&lt;meta name=&quot;twitter:site&quot; content=&quot;@lapcatsoftware&quot;/&gt;&lt;meta name=&quot;twitter:title&quot; content=&quot;A problem worse than Zoom&quot;/&gt;&lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1.0&quot;/&gt;&lt;meta name=&quot;generator&quot; content=&quot;BBEdit 10.5&quot;/&gt;&lt;title&gt;A problem worse than Zoom&lt;/title&gt;&lt;/head&gt;&lt;body id=&quot;readabilityBody&quot; readability=&quot;128.46080928127&quot;&gt;
&lt;div class=&quot;articles_index&quot;&gt;&lt;a href=&quot;https://lapcatsoftware.com/articles/index.html&quot; title=&quot;The Desolation of Blog&quot;&gt;Articles index&lt;/a&gt;&lt;/div&gt;

&lt;h3&gt;July 11 2019 by Jeff Johnson&lt;br/&gt;To support this blog please buy my apps &lt;a href=&quot;https://underpassapp.com/StopTheMadness/&quot;&gt;StopTheMadness&lt;/a&gt; and &lt;a href=&quot;https://underpassapp.com/&quot;&gt;Underpass&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;On macOS, an app can register to handle URL schemes. Web browsers such as Safari, Chrome, and Firefox register to handle the schemes for web pages, &lt;code&gt;http&lt;/code&gt; or &lt;code&gt;https&lt;/code&gt;. Non-browser apps may register to handle other URL schemes; for example, an email client may register to handle the well known &lt;code&gt;mailto&lt;/code&gt; scheme. When a URL is opened in a web browser, and the browser itself cannot handle the URL scheme, the browser looks for another app to handle the URL. If there's a handler app for the URL scheme, then the browser will open the app and pass the URL along to that app. Thus, clicking a &lt;code&gt;mailto:tcook@apple.com&lt;/code&gt; link will open your email client with a new email addressed to Tim Cook.&lt;/p&gt;
&lt;p&gt;In many cases, Safari now requires user confirmation every time that Safari opens an app that handles a custom URL scheme. You may have noticed this happen if you use my own free app &lt;a href=&quot;https://github.com/lapcat/StopTheNews&quot;&gt;StopTheNews&lt;/a&gt;, a tool for opening Apple News URLs in Safari instead of News app. Since constantly requiring confirmation is obviously incredibly annoying, Apple has conveniently exempted some of its own apps from the requirement. For example, &lt;code&gt;macappstore&lt;/code&gt; and &lt;code&gt;macappstores&lt;/code&gt; URLs will automatically open App Store app without your confirmation. Ironically, the one case in which you would most want to require confirmation! I believe that Apple also exempts Radar, its internal bug reporting app used by Apple engineers. If you've ever seen an engineer mention a URL with a scheme such as &lt;code&gt;radar&lt;/code&gt; or &lt;code&gt;rdar&lt;/code&gt;, those URLs open in Radar app. So Apple inflicts confirmation dialogs on users outside of Apple, but it relieves its own engineers of having to confirm everything when they're working on Apple software. How thoughtful.&lt;/p&gt;
&lt;p&gt;In order to avoid these annoying Safari confirmation dialogs that pop up not just once but every time, Zoom implemented a little trick. Instead of using a custom URL scheme for their app, they decided to install a localhost web server on the Mac. When a user loaded their web page in Safari, their web page would send a request to the localhost server for a Zoom meeting. The localhost server would receive the request and open the Zoom app to start the meeting. Since there was no custom URL scheme involved, the Safari confirmation requirement was not triggered. Unfortunately, Zoom messed up their implementation in a number of ways. The worst problem was a vulnerability that allowed a maliciously crafted web page to add a Zoom user to a meeting without their consent.&lt;/p&gt;
&lt;p&gt;Zoom is certainly deserving of criticism. But I've seen very few people stop to ask, how was Zoom's little trick even possible in the first place? Why does Safari allow a web page, &lt;code&gt;zoom.us&lt;/code&gt;, to make requests to a localhost server? Is this possibility not surprising to you? It was surprising to me! The problem is actually worse than this. The major browsers I've tested — Safari, Chrome, Firefox — all allow web pages to send requests not only to localhost but also to any IP address on your Local Area Network! Can you believe that? I'm both astonished and horrified.&lt;/p&gt;
&lt;p&gt;There are probably a number of web servers on your LAN. If you have an Apple TV or another AirPlay receiver, that's a web server. Nowadays most routers and modems have a web interface. In other words, they're web servers! You can use my free app &lt;a href=&quot;https://github.com/lapcat/Bonjeff&quot;&gt;Bonjeff&lt;/a&gt; to see the Bonjour services published on your network. Those are all servers. Can you imagine the possibility of a maliciously crafted web page loaded in Safari being able to access your router and modem? Well it's not just a possibility, it's an actuality! I tried creating some little test pages uploaded to my web site that sent requests to my Apple TV and to my router from an &lt;code&gt;iframe&lt;/code&gt;, and they worked! These devices are typically at well known IP addresses on your LAN. Moreover, a web page can even scan your network to find the addresses of your devices. I found a &lt;a href=&quot;https://www.forcepoint.com/sites/default/files/resources/files/report-attacking-internal-network-en_0.pdf&quot;&gt;recent paper by Forcepoint&lt;/a&gt; that discusses in detail these kinds of attacks on your LAN from the web. So security researchers are aware of this possibility, but it seems that the browser vendors are doing nothing to plug the holes in their web browsers! To be clear, browsers do place strict limitations on cross-origin requests. Nonetheless, as we've seen with the case of Zoom, and also as discussed in the linked paper, there are currently ways for attackers to bypass the cross-origin limitations.&lt;/p&gt;
&lt;p&gt;In my opinion, web pages should not be allowed to make requests to LAN addresses unless the user has specifically and intentionally configured the browser to allow this. In general, there's no reason why a page on the internet should be allowed to access devices on your local area network. Of course, if the user enters a LAN IP into the browser location bar, this should be allowed, but that's not a cross-origin request. I personally use a localhost server to test my web sites before I upload them to production, and I'm sure that's a very common practice. However, I don't want non-localhost web sites to be able to make requests to my localhost server. That seems absurd.&lt;/p&gt;
&lt;p&gt;On a related subject, I don't think that web browsers should be allowed open other apps at all unless the user explicitly clicks on a link with the URL scheme handled by the app. Why are web pages allowed to automatically open App Store app? Not only is this kind of behavior annoying, it's also the cause of security vulnerabilities, which is the reason Safari added a confirmation dialog. But confirmation dialogs seem like the wrong approach. They're a workaround for a bad architecture. The app should only open if I click the link, which is itself a signal of confirmation. Otherwise, external apps should not open at all. I'd even be ok with a confirmation dialog the &lt;em&gt;first&lt;/em&gt; time I click on a link that opens a particular app for a particular URL scheme. Even a checkbox option &quot;Don't ask me again&quot; would be fine. This approach seems much more reasonable, perhaps even more secure in actual practice.&lt;/p&gt;
&lt;h2 id=&quot;update1&quot;&gt;Update July 12 2019&lt;/h2&gt;
&lt;p&gt;Dear Hacker News visitors,&lt;/p&gt;
&lt;p&gt;Thank you for visiting!&lt;/p&gt;
&lt;p&gt;If you've read to the end, this may not need to be said, but I urge you to consider carefully these sentences: &quot;To be clear, browsers do place strict limitations on cross-origin requests. Nonetheless, as we've seen with the case of Zoom, and also as discussed in the linked paper, there are currently ways for attackers to bypass the cross-origin limitations.&quot; I also urge you to read to the &lt;a href=&quot;https://www.forcepoint.com/sites/default/files/resources/files/report-attacking-internal-network-en_0.pdf&quot;&gt;paper by Forcepoint&lt;/a&gt;. Some smugly ignorant commenters have suggested that this is all obvious to any web developer. It's not.&lt;/p&gt;
&lt;p&gt;On the issue of Apple granting exceptions to its own apps, I've discovered that they've granted a new exception to the Apple News app in the macOS Catalina beta. The exceptions are specified by URL scheme, but they're enforced by code signing: only apps signed by Apple are allowed to bypass the user confirmation dialogs.&lt;/p&gt;
&lt;h3&gt;To support this blog please buy my apps &lt;a href=&quot;https://underpassapp.com/StopTheMadness/&quot;&gt;StopTheMadness&lt;/a&gt; and &lt;a href=&quot;https://underpassapp.com/&quot;&gt;Underpass&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&quot;articles_index&quot;&gt;&lt;a href=&quot;https://lapcatsoftware.com/articles/index.html&quot; title=&quot;The Desolation of Blog&quot;&gt;Articles index&lt;/a&gt;&lt;/div&gt;
&lt;/body&gt;</description>
<pubDate>Fri, 12 Jul 2019 19:00:33 +0000</pubDate>
<dc:creator>minikites</dc:creator>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://lapcatsoftware.com/articles/zoom.html</dc:identifier>
</item>
<item>
<title>Giant batteries and cheap solar power are shoving fossil fuels off the grid</title>
<link>https://www.sciencemag.org/news/2019/07/giant-batteries-and-cheap-solar-power-are-shoving-fossil-fuels-grid</link>
<guid isPermaLink="true" >https://www.sciencemag.org/news/2019/07/giant-batteries-and-cheap-solar-power-are-shoving-fossil-fuels-grid</guid>
<description>&lt;div class=&quot;entity entity-paragraphs-item paragraphs-item-image&quot;&gt;
&lt;div class=&quot;figure__head&quot;&gt;&lt;img sizes=&quot;&quot; src=&quot;https://www.sciencemag.org/sites/default/files/styles/inline__450w__no_aspect/public/ca_0712NID_Solar_Farm_California_online.jpg?itok=U4vz8uQ9&quot; srcset=&quot;https://www.sciencemag.org/sites/default/files/styles/inline__450w__no_aspect/public/ca_0712NID_Solar_Farm_California_online.jpg?itok=U4vz8uQ9 1w, https://www.sciencemag.org/sites/default/files/styles/inline__699w__no_aspect/public/ca_0712NID_Solar_Farm_California_online.jpg?itok=XGJLOT5H 700w&quot;/&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot; readability=&quot;6&quot;&gt;
&lt;div class=&quot;caption__text&quot; readability=&quot;32&quot;&gt;
&lt;p&gt;A large-scale solar farm in Southern California.&lt;/p&gt;
&lt;/div&gt;
&lt;span class=&quot;credit&quot;&gt;8MINUTE SOLAR ENERGY&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;header class=&quot;article__header article__header--inline&quot; readability=&quot;24.857142857143&quot;&gt;
&lt;p class=&quot;byline byline--article&quot;&gt;By &lt;a href=&quot;https://www.sciencemag.org/author/robert-f-service&quot;&gt;Robert F. Service&lt;/a&gt;&lt;time&gt;Jul. 11, 2019 , 1:40 PM&lt;/time&gt;&lt;/p&gt;
&lt;/header&gt;&lt;p&gt;This month, officials in Los Angeles, California, are expected to approve a deal that would make solar power cheaper than ever while also addressing its chief flaw: It works only when the sun shines. The deal calls for a huge solar farm backed up by one of the world's largest batteries. It would provide 7% of the city's electricity beginning in 2023 at a cost of 1.997 cents per kilowatt hour (kWh) for the solar power and 1.3 cents per kWh for the battery. That's cheaper than any power generated with fossil fuel.&lt;/p&gt;
&lt;p&gt;&quot;Goodnight #naturalgas, goodnight #coal, goodnight #nuclear,&quot; Mark Jacobson, an atmospheric scientist at Stanford University in Palo Alto, California, tweeted after news of the deal surfaced late last month. &quot;Because of growing economies of scale, prices for renewables and batteries keep coming down,&quot; adds Jacobson, who has advised countries around the world on how to shift to 100% renewable electricity. As if on cue, last week a major U.S. coal company—West Virginia–based Revelation Energy LLC—filed for bankruptcy, the second in as many weeks.&lt;/p&gt;
&lt;p&gt;The new solar plus storage effort will be built in Kern County in California by 8minute Solar Energy. The project is expected to create a 400-megawatt solar array, generating roughly 876,000 megawatt hours (MWh) of electricity annually, enough to power more than 65,000 homes during daylight hours. Its 800-MWh battery will store electricity for after the sun sets, reducing the need for natural gas–fired generators.&lt;/p&gt;
&lt;p&gt;Precipitous price declines have already driven a shift toward renewables backed by battery storage. In March, an analysis of more than 7000 global storage projects by Bloomberg New Energy Finance reported that the cost of utility-scale lithium-ion batteries had fallen by 76% since 2012, and by 35% in just the past 18 months, to $187 per MWh. Another market watch firm, Navigant, predicts a further halving by 2030, to a price well below what 8minute has committed to.&lt;/p&gt;
&lt;p&gt;Large-scale battery storage generally relies on lithium-ion batteries—scaled-up versions of the devices that power laptops and most electric vehicles. But Jane Long, an engineer and energy policy expert who recently retired from Lawrence Livermore National Laboratory in California, says batteries are only part of the energy storage answer, because they typically provide power for only a few hours. &quot;You also need to manage for long periods of cloudy weather, or winter conditions,&quot; she says.&lt;/p&gt;
&lt;p&gt;Local commitments to switch to 100% renewables are also propelling the rush toward grid-scale batteries. By Jacobson's count, 54 countries and eight U.S. states have required a transition to 100% renewable electricity. In 2010, California passed a mandate that the state's utilities install electricity storage equivalent to 2% of their peak electricity demand by 2024.&lt;/p&gt;
&lt;p&gt;Although the Los Angeles project may seem cheap, the costs of a fully renewable–powered grid would add up. Last month, the energy research firm Wood Mackenzie estimated the cost to decarbonize the U.S. grid alone would be $4.5 trillion, about half of which would go to installing 900 billion watts, or 900 gigawatts (GW), of batteries and other energy storage technologies. (Today, the world's battery storage capacity is just 5.5 GW.) But as other cities follow the example of Los Angeles, that figure is sure to fall.&lt;/p&gt;
</description>
<pubDate>Fri, 12 Jul 2019 18:03:51 +0000</pubDate>
<dc:creator>rchaudhary</dc:creator>
<og:type>article</og:type>
<og:url>https://www.sciencemag.org/news/2019/07/giant-batteries-and-cheap-solar-power-are-shoving-fossil-fuels-grid</og:url>
<og:title>Giant batteries and cheap solar power are shoving fossil fuels off the grid</og:title>
<og:description>Cost of solar power has dropped by 76% since 2012</og:description>
<og:image>https://www.sciencemag.org/sites/default/files/styles/article_main_large/public/ca_0712NID_Solar_Farm_California_online.jpg?itok=i-kGAMGF</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.sciencemag.org/news/2019/07/giant-batteries-and-cheap-solar-power-are-shoving-fossil-fuels-grid</dc:identifier>
</item>
<item>
<title>Anomalous CPU utilization on Windows build node caused by ads</title>
<link>https://twitter.com/shipilev/status/1149679913974280193</link>
<guid isPermaLink="true" >https://twitter.com/shipilev/status/1149679913974280193</guid>
<description>&lt;p&gt;I remember IE opened up on first boot after updates before. Windows also updates on reboots (e.g. ACPI-requested). This means headful build node could have started IE with MSN without me knowing. Well, okay, big deal: I'll set up the blank home page as simplest mitigation. Peace.&lt;/p&gt;
</description>
<pubDate>Fri, 12 Jul 2019 16:02:10 +0000</pubDate>
<dc:creator>luu</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://mobile.twitter.com/shipilev/status/1149679913974280193</dc:identifier>
</item>
<item>
<title>Strava cuts off Relive</title>
<link>https://www.dcrainmaker.com/2019/07/strava-relive-cc-app-platform-dispute.html</link>
<guid isPermaLink="true" >https://www.dcrainmaker.com/2019/07/strava-relive-cc-app-platform-dispute.html</guid>
<description>&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/IMG_8986.jpg&quot;&gt;
&lt;p&gt;&lt;img title=&quot;IMG_8986&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/IMG_8986_thumb.jpg&quot; alt=&quot;IMG_8986&quot; width=&quot;720&quot; height=&quot;480&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Here I thought yesterday was going to be a peaceful random July Thursday morning. Nothing but Italian chirping birds at the Giro Rosa, and catching the Tour de France later in the afternoon on TV. Turns out, Strava had different plans for it.&lt;/p&gt;
&lt;p&gt;You see, yesterday morning Strava sent out an e-mail to users of &lt;a href=&quot;https://www.relive.cc&quot;&gt;Relive (aka Relive.cc)&lt;/a&gt;. You may have seen this app here or there, but essentially it allowed you to connect your Strava account (or other platform, including Garmin) to Relive and they’d generate a small movie of your workout including photos and such. It was nifty and there were plenty of users (as so evidenced by my packed inbox with upset users this morning).  The company says they have millions of non-Strava users, plus the now non-existent Strava users.&lt;/p&gt;
&lt;p&gt;For those not familiar, here’s basically what it created – using my ride two days ago in the Italian Alps:&lt;/p&gt;
&lt;blockquote class=&quot;embedly-card&quot; data-card-key=&quot;f1631a41cb254ca5b035dc5747a5bd75&quot; data-card-controls=&quot;0&quot;&gt;
&lt;h4 id=&quot;relive-italian-distraction&quot;&gt;&lt;a href=&quot;https://www.relive.cc/view/r10006428572?r=embed-site&quot;&gt;Relive ‘Italian Distraction’&lt;/a&gt;&lt;/h4&gt;
&lt;/blockquote&gt;
&lt;p&gt;Cool stuff, huh?&lt;/p&gt;
&lt;p&gt;Yup – and Strava thought so too, as in fact over the years Strava hosted the company for events, and Strava employees used Relive too. As did other platforms and companies too of course, since it was nifty. Visuals and data go together well, and usually resonate widely on social media. Win-win. Or not, as Relive found out the hard way yesterday.&lt;/p&gt;
&lt;p&gt;After discussing the situation with both sides yesterday and again today, I’ve got a pretty clear picture of what’s going on. Hang on, it’s a wild ride.&lt;/p&gt;
&lt;h3 id=&quot;the-tides-turn&quot;&gt;&lt;span&gt;The Tides Turn:&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;It all started with an early morning (European time) e-mail from Strava to Relive users. While the first few words started off nice, it quickly took a turn for darker sides. It was phrased in such a way that implied Relive had done something horrible, dirty even:&lt;/p&gt;
&lt;blockquote readability=&quot;24&quot;&gt;
&lt;p&gt;“Many of us at Strava have enjoyed using Relive over the last few years, but because of Relive’s recent updates, unfortunately, we have decided to end this integration. The current version of Relive violates several of the terms that we ask of API partners. These terms are in place to safeguard your personal information, to ensure a level playing field for all our partners, and to protect what makes Strava unique. We’ve worked hard with Relive to try to fix this, but they have ultimately chosen not to make the changes needed to honor their agreement. So as of today, Strava will no longer send your activities to Relive for playback.&lt;/p&gt;

&lt;p&gt;Rest assured, nothing’s changed about how your information is stored or the control you have over how it’s accessed by API partners. And we remain deeply committed to helping our many API partners build experiences that make your workouts and races even better.&lt;/p&gt;

&lt;p&gt;As always, thanks for being a part of the Strava community,&lt;br/&gt;The Strava Team&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of course, Relive then &lt;a href=&quot;https://www.relive.cc/strava&quot;&gt;publicly posted a response&lt;/a&gt;– complete with SpongeBob meme. Ultimately a variant of ‘Strava got drunk, and is now ghosting us, help?’.&lt;/p&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-2.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-1.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;539&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;About this point you’re thinking to yourself: OK, so what, Strava and a 3rd party app are having a disagreement. Why do I (or you) care?&lt;/p&gt;
&lt;p&gt;Well, the nuance of what they’re disagreeing about is actually super fascinating. Strava says that Relive violated their &lt;a href=&quot;https://www.strava.com/legal/api&quot;&gt;API terms of service&lt;/a&gt;.  Their API being the development hooks that thousands of developers leverage, including companies likes Garmin, Suunto, Zwift, Trailforks, Polar and many others. There are numerous legal conditions/rules in there – some of them obvious (variants of ‘do no harm’), but some of them less well-meaning and more anti-competitive.&lt;/p&gt;
&lt;p&gt;To begin, the first condition that Strava states Relive has violated is the following:&lt;/p&gt;
&lt;blockquote readability=&quot;11&quot;&gt;
&lt;p&gt;“2b Strava reserves the right to revoke your API Token or terminate or limit any uses of the Strava API Materials if you violate this Agreement or we otherwise object to your use of the Strava API Materials, including but not limited to, uses that enable virtual races or competitions and uses that &lt;strong&gt;replicate Strava sites, services or products&lt;/strong&gt;”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The bold part is the bit Strava’s upset about, and translated to simple human English: Don’t do anything that we already have as a feature.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(I’ll point out the fact that almost every fitness/developer site/app already does that, for things like distance/speed/elevation/etc… all technically Strava features that are being duplicated.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So what Strava feature is that which Strava disagrees with and believes violates their ToS?&lt;strong&gt;  The ability to have a social feed.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Yup, for real.&lt;/p&gt;
&lt;p&gt;But wait – Strava says that Relive actually broke two term items here, with the second one being:&lt;/p&gt;
&lt;blockquote readability=&quot;16&quot;&gt;
&lt;p&gt;“2.k.iv You may not process Strava Data, including in an aggregated or de-identified manner, for the purposes of, including but not limited to, analytics, analyses, customer insights generation, and products or services improvements. &lt;strong&gt;Strava Data may not be combined with other customer data&lt;/strong&gt;, for these or any other purposes.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Now this is where things get whacky.  Basically Strava actually says in their terms of services that you can’t do analytics on their data &lt;em&gt;(side note: It’s not ‘their data’, &lt;strong&gt;it’s your data&lt;/strong&gt;…but we’ll come back to that in a second).&lt;/em&gt; That’s a funny distinction since those are – I kid you not – literally some of the same category names (e.g. Analysis) they use for their &lt;a href=&quot;https://www.strava.com/apps/visualizer&quot;&gt;3rd party app showcase/landing page&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-3.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-2.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;528&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But apparently that’s not actually what got Relive in trouble on this particular bullet point. Rather, it was the last portion of that sentence:&lt;/p&gt;
&lt;blockquote readability=&quot;6&quot;&gt;
&lt;p&gt;“&lt;strong&gt;Strava Data may not be combined with other customer data&lt;/strong&gt;, for these or any other purposes.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;What Strava is saying here is that you can’t take data via the Strava API and then show it (or combine it) with other 3rd party data. In the case of Relive, that means that Strava doesn’t want them also supporting uploads from Garmin, Polar, Suunto, etc, because then that combines the data from other sources.&lt;/p&gt;
&lt;p&gt;Which is somewhat funny – because ironically enough, that’s actually exactly what platform giant Trailforks does (oh, and you can do analytics too):&lt;/p&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-4.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-3.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;269&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The Trailforks Strava API integration allows you to pull in your Strava activities, add them to your profile whereby other users can follow you and your activities, browse them, – even get badges as seen below.&lt;/p&gt;
&lt;p&gt;And what about the requirement for combining with other customer data? Oh, no problem – Trailforks does that too. You can upload routes outside of Strava, as well as activities. And heck, Trailforks even goes a step further violating the API than Relive by making that available for usage stats and analytics (harkening back to the previous item). All while doing so in an &lt;a href=&quot;https://www.trailforks.com/ridelog/stravaguide/&quot;&gt;astoundingly clear flow chart on their own site&lt;/a&gt; (see above).&lt;/p&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-5.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-4.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;384&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Realistically, I could keep finding these examples. After all, I’ve only spent about 45 minutes on this post at this point, and I’ve got a pile of big and small 3rd party apps alike that theoretically broke these same rules.&lt;/p&gt;
&lt;p&gt;The real reason I suspect is that Strava somehow sees Relive as a threat. Perhaps they are, but in reality I suspect they aren’t. They’re just a small 3rd party app that wanted to add some common social features that Strava definitely didn’t pioneer. After all, it’s those specific social features that pushed Strava over the line, once Relive rolled them out last week. All of the rest of the customer data combining and analytic bits have been around for years on Relive without any Strava problem.&lt;/p&gt;
&lt;p&gt;In fact, Strava even hosted Relive at Strava HQ two summers ago for a 3-day event. And their &lt;a href=&quot;https://twitter.com/garethnettleton/status/744621859078037504&quot;&gt;VP of marketing has also called Relive&lt;/a&gt; ‘the best use of Strava’s API to date’. At the time of the HQ visit, Relive already had other 3rd party data connections including Garmin, Endomondo, and Polar.&lt;/p&gt;
&lt;p&gt;As for the back and forth in communications that both sides claim? Well, both are correct, just saying it differently. Strava gave some warnings last week, and Relive offered to rollback functionality. But apparently that wasn’t quite good enough, with Strava requiring additional terms that Relive couldn’t agree too. It’s unclear why Strava required additional terms if Relive rolled back the social functionality for Strava users.&lt;/p&gt;
&lt;h3 id=&quot;no-strava-its-not-your-data&quot;&gt;&lt;span&gt;No Strava, it’s not your data:&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-6.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-5.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;282&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But I want to circle back to something you see over and over again in the Strava API terms of service, which are these two words: “&lt;strong&gt;Strava Data”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;This term ostensibly refers to may things. It can and does include Strava Segments, Leaderboards, shoe types, device types, and of course – activity uploads. In the case of Relive, they weren’t using any of those things except the last, which is ‘Activity Uploads’.&lt;/p&gt;
&lt;p&gt;But the problem is those workout files are actually your data. It’s the data you generate when you upload a workout file to Strava’s platform. In the case of Garmin devices that’s a .FIT file, from Polar a .TCX file, and so on. Ultimately, it’s your data. GDPR enforces that as well, and Strava’s same ToS even notes that too.&lt;/p&gt;
&lt;p&gt;But Strava as a group seems to forget that.&lt;/p&gt;
&lt;p&gt;In the case of Relive, that was my workout upload. I did that on a Garmin device and then would have uploaded it to the Strava platform. Then, using Strava’s API, Relive would have accessed my track data and generated a pretty little video based on my data. See what I did there: It’s not ‘Strava data’, it’s ‘my data’. They didn’t use segments or leaderboards or my shoe type. Just my track, and only my track.&lt;/p&gt;
&lt;p&gt;I say that – because it seems like Strava’s forgetting that. It seems like they’re forgetting that this is ultimately data you create and you authorize these apps to use in ways that you’ve approved. That’s the entire point of the API, and by and large 3rd party apps do fantastic things. Thousands of app developers have created incredible apps – highlighted in their &lt;a href=&quot;https://www.strava.com/apps&quot;&gt;3rd party app directory&lt;/a&gt;. But again – when I sign on to authorize an app (using the standard authorization page you’ve seen countless times), I’m saying that ‘Yes, I want the app to do that’.&lt;/p&gt;
&lt;p&gt;And that’s where it appears Strava seems to misunderstand the definition of ‘Strava data’. At that point I’m saying ‘Yes, I want you to use my data that happens to be on Strava’s platform to create a nifty movie’. Again – it’s my data, and according to GDPR I’m in control of my data. Strava is merely a temporary holder of it, not unlike a bank.&lt;/p&gt;
&lt;h3 id=&quot;going-forward&quot;&gt;&lt;span&gt;Going Forward:&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://media.dcrainmaker.com/images/2019/07/image-7.png&quot;&gt;
&lt;p&gt;&lt;img title=&quot;image&quot; src=&quot;https://media.dcrainmaker.com/images/2019/07/image_thumb-6.png&quot; alt=&quot;image&quot; width=&quot;722&quot; height=&quot;361&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The challenge here for Strava and their apps is really twofold. For app developers, it’s the reality that Strava re-interpret their terms the moment they feel threatened. At least if you’re small. It’s the exact same story that played out last summer with Strava Live Segments, where now smaller GPS device manufacturers (e.g. not Garmin or Wahoo) &lt;a href=&quot;https://twitter.com/dcrainmakerblog/status/1024719190941466626?lang=en&quot;&gt;have to pay Strava a licensing fee&lt;/a&gt; for usage of the Strava Live Segments functionality in their devices. It’s why you’ve seen that feature dry up over the past 12 months in newer devices on the market. Because Strava relies on companies like Garmin to convert paid Strava Summit subscriptions using their devices, Strava can’t actually pressure Garmin. Garmin would laugh in their faces.&lt;/p&gt;
&lt;p&gt;But for Strava itself it’s that they keep tripping on stuff they needn’t trip on. One only need to look at social media yesterday to see how badly &lt;a href=&quot;https://twitter.com/relivecc/status/1149260549231915010&quot;&gt;Strava lost in the social media game&lt;/a&gt;. They may have thrown the first legal punch, but they got badly beaten by meme’s and the reality of frustrated users calling Strava a bully.&lt;/p&gt;
&lt;p&gt;And while &lt;a href=&quot;https://www.dcrainmaker.com/2018/08/strava-renames-premium-to-summit-changes-pricing-model.html&quot;&gt;Strava’s changes a year ago around&lt;/a&gt; renaming Premium to Summit were probably good for the company, they were ridiculed in the comments section for the name, with most users saying a variant of ‘How about developing features instead?’.  Which they did back in January.&lt;/p&gt;
&lt;p&gt;For the first time in years they developed a new &lt;a href=&quot;https://www.dcrainmaker.com/2019/02/strava-rolls-out-new-finger-dragging-route-creation-feature.html&quot;&gt;Strava finger-dragging route creation&lt;/a&gt; feature, only to have reality strike a few days day later when it was learned they actually painstakingly duplicated a 3rd party app (&lt;a href=&quot;https://cyclingtips.com/2019/02/did-strava-copy-its-mobile-route-builder-from-another-app/&quot;&gt;complete with IP logs showing Strava HQ&lt;/a&gt;, Bourne Identity style). And now here we are a year after Strava announced Summit – with yet still no new features. Instead, we’ve just got lawyers from Strava protecting turf that isn’t actually theirs to protect.&lt;/p&gt;
&lt;p&gt;It’s thus somewhat ironic that Strava’s own breakup letter to Relive users actually sums it all up the best: “Rest assured, nothing’s changed about how your information is stored or the control you have over how it’s accessed by API partners.”&lt;/p&gt;
&lt;p&gt;However, it’s missing the next line to complete it and make it more accurate. So I’ll finish it for them: “Ultimately, what’s changed is that we sat down and decided that instead of creating new features for you as Strava users, we’d spend that time on removing functionality from the greater Strava ecosystem.”&lt;/p&gt;
&lt;p&gt;Seems about right.&lt;/p&gt;


</description>
<pubDate>Fri, 12 Jul 2019 15:55:51 +0000</pubDate>
<dc:creator>tomverhoeff</dc:creator>
<og:description>Here I thought yesterday was going to be a peaceful random July Thursday morning. Nothing but Italian chirping birds at the Giro Rosa, and catching the Tour de France later in the afternoon on TV. Turns out, Strava had different</og:description>
<og:title>Strava cuts off Relive: Here’s what actually happened</og:title>
<og:image>https://www.dcrainmaker.com/images/2019/07/IMG_8986.jpg</og:image>
<og:type>article</og:type>
<og:url>https://www.dcrainmaker.com/2019/07/strava-relive-cc-app-platform-dispute.html</og:url>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.dcrainmaker.com/2019/07/strava-relive-cc-app-platform-dispute.html</dc:identifier>
</item>
<item>
<title>Details of the Cloudflare outage on July 2, 2019</title>
<link>https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/</link>
<guid isPermaLink="true" >https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/</guid>
<description>&lt;p&gt;Almost nine years ago, Cloudflare was a tiny company and I was a customer not an employee. Cloudflare had launched a month earlier and one day alerting told me that my little site, &lt;a href=&quot;https://jgc.org/&quot;&gt;jgc.org&lt;/a&gt;, didn’t seem to have working DNS any more. Cloudflare had pushed out a change to its use of &lt;a href=&quot;https://developers.google.com/protocol-buffers/&quot;&gt;Protocol Buffers&lt;/a&gt; and it had broken DNS.&lt;/p&gt;
&lt;p&gt;I wrote to Matthew Prince directly with an email titled “Where’s my dns?” and he replied with a long, detailed, technical response (you can read the &lt;a href=&quot;https://gist.github.com/jgrahamc/6bb02a6f7c3799a1590b3cdb901f8e08&quot;&gt;full email exchange here&lt;/a&gt;) to which I replied:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;From: John Graham-Cumming
Date: Thu, Oct 7, 2010 at 9:14 AM
Subject: Re: Where's my dns?
To: Matthew Prince

Awesome report, thanks. I'll make sure to call you if there's a
problem.  At some point it would probably be good to write this up as
a blog post when you have all the technical details because I think
people really appreciate openness and honesty about these things.
Especially if you couple it with charts showing your post launch
traffic increase.

I have pretty robust monitoring of my sites so I get an SMS when
anything fails.  Monitoring shows I was down from 13:03:07 to
14:04:12.  Tests are made every five minutes.

It was a blip that I'm sure you'll get past.  But are you sure you
don't need someone in Europe? :-)
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;To which he replied:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;From: Matthew Prince
Date: Thu, Oct 7, 2010 at 9:57 AM
Subject: Re: Where's my dns?
To: John Graham-Cumming

Thanks. We've written back to everyone who wrote in. I'm headed in to
the office now and we'll put something on the blog or pin an official
post to the top of our bulletin board system. I agree 100%    
transparency is best.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;And so, today, as an employee of a much, much larger Cloudflare I get to be the one who writes, transparently about a mistake we made, its impact and what we are doing about it.&lt;/p&gt;
&lt;h3 id=&quot;the-events-of-july-2&quot;&gt;The events of July 2&lt;/h3&gt;
&lt;p&gt;On July 2, we deployed a new rule in our WAF Managed Rules that &lt;a href=&quot;https://blog.cloudflare.com/cloudflare-outage/&quot;&gt;caused CPUs to become exhausted&lt;/a&gt; on every CPU core that handles HTTP/HTTPS traffic on the Cloudflare network worldwide. We are constantly improving WAF Managed Rules to respond to new vulnerabilities and threats. In May, for example, we used the speed with which we can update the WAF to &lt;a href=&quot;https://blog.cloudflare.com/stopping-cve-2019-0604/&quot;&gt;push a rule&lt;/a&gt; to protect against a serious SharePoint vulnerability. Being able to deploy rules quickly and globally is a critical feature of our WAF.&lt;/p&gt;
&lt;p&gt;Unfortunately, last Tuesday’s update contained a regular expression that backtracked enormously and exhausted CPU used for HTTP/HTTPS serving. This brought down Cloudflare’s core proxying, CDN and WAF functionality. The following graph shows CPUs dedicated to serving HTTP/HTTPS traffic spiking to nearly 100% usage across the servers in our network.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/cpu-goes-boom.png&quot; class=&quot;kg-image&quot;/&gt;CPU utilization in one of our PoPs during the incident
&lt;p&gt;This resulted in our customers (and their customers) seeing a 502 error page when visiting any Cloudflare domain. The 502 errors were generated by the front line Cloudflare web servers that still had CPU cores available but were unable to reach the processes that serve HTTP/HTTPS traffic.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/502-bad-gateway.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;We know how much this hurt our customers. We’re ashamed it happened. It also had a negative impact on our own operations while we were dealing with the incident.&lt;/p&gt;
&lt;p&gt;It must have been incredibly stressful, frustrating and frightening if you were one of our customers. It was even more upsetting because we haven’t had a &lt;a href=&quot;https://blog.cloudflare.com/todays-outage-post-mortem-82515/&quot;&gt;global outage&lt;/a&gt; for six years.&lt;/p&gt;
&lt;p&gt;The CPU exhaustion was caused by a single WAF rule that contained a poorly written regular expression that ended up creating excessive backtracking. The regular expression that was at the heart of the outage is &lt;code&gt;(?:(?:\&quot;|'|\]|\}|\\|\d|(?:nan|infinity|true|false|null|undefined|symbol|math)|\`|\-|\+)+[)]*;?((?:\s|-|~|!|{}|\|\||\+)*.*(?:.*=.*)))&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Although the regular expression itself is of interest to many people (and is discussed more below), the real story of how the Cloudflare service went down for 27 minutes is much more complex than “a regular expression went bad”. We’ve taken the time to write out the series of events that lead to the outage and kept us from responding quickly. And, if you want to know more about regular expression backtracking and what to do about it, then you’ll find it in an appendix at the end of this post.&lt;/p&gt;
&lt;h3 id=&quot;what-happened&quot;&gt;What happened&lt;/h3&gt;
&lt;p&gt;Let’s begin with the sequence of events. All times in this blog are UTC.&lt;/p&gt;
&lt;p&gt;At 13:42 an engineer working on the firewall team deployed a minor change to the rules for &lt;a href=&quot;https://www.cloudflare.com/learning/security/threats/cross-site-scripting/&quot;&gt;XSS&lt;/a&gt; detection via an automatic process. This generated a Change Request ticket. We use Jira to manage these tickets and a screenshot is below.&lt;/p&gt;
&lt;p&gt;Three minutes later the first PagerDuty page went out indicating a fault with the WAF. This was a synthetic test that checks the functionality of the WAF (we have hundreds of such tests) from outside Cloudflare to ensure that it is working correctly. This was rapidly followed by pages indicating many other end-to-end tests of Cloudflare services failing, a global traffic drop alert, widespread 502 errors and then many reports from our points-of-presence (PoPs) in cities worldwide indicating there was CPU exhaustion.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/pager-duty-1345.png&quot; class=&quot;kg-image&quot;/&gt;&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/pager-duty-1346.jpg&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Some of these alerts hit my watch and I jumped out of the meeting I was in and was on my way back to my desk when a leader in our Solutions Engineering group told me we had lost 80% of our traffic. I ran over to SRE where the team was debugging the situation. In the initial moments of the outage there was speculation it was an attack of some type we’d never seen before.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/pager-duty-1348.jpg&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Cloudflare’s SRE team is distributed around the world, with continuous, around-the-clock coverage. Alerts like these, the vast majority of which are noting very specific issues of limited scopes in localized areas, are monitored in internal dashboards and addressed many times every day. This pattern of pages and alerts, however, indicated that something gravely serious had happened, and SRE immediately declared a P0 incident and escalated to engineering leadership and systems engineering.&lt;/p&gt;
&lt;p&gt;The London engineering team was at that moment in our main event space listening to an internal tech talk. The talk was interrupted and everyone assembled in a large conference room and others dialed-in. This wasn’t a normal problem that SRE could handle alone, it needed every relevant team online at once.&lt;/p&gt;
&lt;p&gt;At 14:00 the WAF was identified as the component causing the problem and an attack dismissed as a possibility. The Performance Team pulled live CPU data from a machine that clearly showed the WAF was responsible. Another team member used strace to confirm. Another team saw error logs indicating the WAF was in trouble. At 14:02 the entire team looked at me when it was proposed that we use a ‘global kill’, a mechanism built into Cloudflare to disable a single component worldwide.&lt;/p&gt;
&lt;p&gt;But getting to the global WAF kill was another story. Things stood in our way. We use our own products and with our &lt;a href=&quot;https://www.cloudflare.com/en-gb/products/cloudflare-access/&quot;&gt;Access&lt;/a&gt; service down we couldn’t authenticate to our internal control panel (and once we were back we’d discover that some members of the team had lost access because of a security feature that disables their credentials if they don’t use the internal control panel frequently).&lt;/p&gt;
&lt;p&gt;And we couldn’t get to other internal services like Jira or the build system. To get to them we had to use a bypass mechanism that wasn’t frequently used (another thing to drill on after the event). Eventually, a team member executed the global WAF kill at 14:07 and by 14:09 traffic levels and CPU were back to expected levels worldwide. The rest of Cloudflare's protection mechanisms continued to operate.&lt;/p&gt;
&lt;p&gt;Then we moved on to restoring the WAF functionality. Because of the sensitivity of the situation we performed both negative tests (asking ourselves “was it really that particular change that caused the problem?”) and positive tests (verifying the rollback worked) in a single city using a subset of traffic after removing our paying customers’ traffic from that location.&lt;/p&gt;
&lt;p&gt;At 14:52 we were 100% satisfied that we understood the cause and had a fix in place and the WAF was re-enabled globally.&lt;/p&gt;
&lt;h3 id=&quot;how-cloudflare-operates&quot;&gt;How Cloudflare operates&lt;/h3&gt;
&lt;p&gt;Cloudflare has a team of engineers who work on our WAF Managed Rules product; they are constantly working to improve detection rates, lower false positives, and respond rapidly to new threats as they emerge. In the last 60 days, 476 change requests have been handled for the WAF Managed Rules (averaging one every 3 hours).&lt;/p&gt;
&lt;p&gt;This particular change was to be deployed in “simulate” mode where real customer traffic passes through the rule but nothing is blocked. We use that mode to test the effectiveness of a rule and measure its false positive and false negative rate. But even in the simulate mode the rules actually need to execute and in this case the rule contained a regular expression that consumed excessive CPU.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/change-request.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;As can be seen from the Change Request above there’s a deployment plan, a rollback plan and a link to the internal Standard Operating Procedure (SOP) for this type of deployment. The SOP for a rule change specifically allows it to be pushed globally. This is very different from all the software we release at Cloudflare where the SOP first pushes software to an internal dogfooding network point of presence (PoP) (which our employees pass through), then to a small number of customers in an isolated location, followed by a push to a large number of customers and finally to the world.&lt;/p&gt;
&lt;p&gt;The process for a software release looks like this: We use git internally via BitBucket. Engineers working on changes push code which is built by TeamCity and when the build passes, reviewers are assigned. Once a pull request is approved the code is built and the test suite runs (again).&lt;/p&gt;
&lt;p&gt;If the build and tests pass then a Change Request Jira is generated and the change has to be approved by the relevant manager or technical lead. Once approved deployment to what we call the “animal PoPs” occurs: DOG, PIG, and the &lt;a href=&quot;https://en.wikipedia.org/wiki/Sentinel_species&quot;&gt;Canaries&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The DOG PoP is a Cloudflare PoP (just like any of our cities worldwide) but it is used only by Cloudflare employees. This dogfooding PoP enables us to catch problems early before any customer traffic has touched the code. And it frequently does.&lt;/p&gt;
&lt;p&gt;If the DOG test passes successfully code goes to PIG (as in “Guinea Pig”). This is a Cloudflare PoP where a small subset of customer traffic from non-paying customers passes through the new code.&lt;/p&gt;
&lt;p&gt;If that is successful the code moves to the Canaries. We have three Canary PoPs spread across the world and run paying and non-paying customer traffic running through them on the new code as a final check for errors.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/animal-deploy-1.png&quot; class=&quot;kg-image&quot;/&gt;Cloudflare software release process
&lt;p&gt;Once successful in Canary the code is allowed to go live. The entire DOG, PIG, Canary, Global process can take hours or days to complete, depending on the type of code change. The diversity of Cloudflare’s network and customers allows us to test code thoroughly before a release is pushed to all our customers globally. But, by design, the WAF doesn’t use this process because of the need to respond rapidly to threats.&lt;/p&gt;
&lt;h3 id=&quot;waf-threats&quot;&gt;WAF Threats&lt;/h3&gt;
&lt;p&gt;In the last few years we have seen a dramatic increase in vulnerabilities in common applications. This has happened due to the increased availability of software testing tools, like fuzzing for example (we just posted a new blog on fuzzing &lt;a href=&quot;https://blog.cloudflare.com/a-gentle-introduction-to-linux-kernel-fuzzing/&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/Number-of-CVEs-per-year.png&quot; class=&quot;kg-image&quot;/&gt;Source: https://cvedetails.com/
&lt;p&gt;What is commonly seen is a Proof of Concept (PoC) is created and often published on Github quickly, so that teams running and maintaining applications can test to make sure they have adequate protections. Because of this, it’s imperative that Cloudflare are able to react as quickly as possible to new attacks to give our customers a chance to patch their software.&lt;/p&gt;
&lt;p&gt;A great example of how Cloudflare proactively provided this protection was through the deployment of our protections against the SharePoint vulnerability in May (&lt;a href=&quot;https://blog.cloudflare.com/stopping-cve-2019-0604/&quot;&gt;blog here&lt;/a&gt;). Within a short space of time from publicised announcements, we saw a huge spike in attempts to exploit our customer’s Sharepoint installations. Our team continuously monitors for new threats and writes rules to mitigate them on behalf of our customers.&lt;/p&gt;
&lt;p&gt;The specific rule that caused last Tuesday’s outage was targeting Cross-site scripting (XSS) attacks. These too have increased dramatically in recent years.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/Number-of-XSS-CVEs-by-year.png&quot; class=&quot;kg-image&quot;/&gt;Source: https://cvedetails.com/
&lt;p&gt;The standard procedure for a WAF Managed Rules change indicates that Continuous Integration (CI) tests must pass prior to a global deploy. That happened normally last Tuesday and the rules were deployed. At 13:31 an engineer on the team had merged a Pull Request containing the change after it was approved.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/change-details.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;At 13:37 TeamCity built the rules and ran the tests, giving it the green light. The WAF test suite tests that the core functionality of the WAF works and consists of a large collection of unit tests for individual matching functions. After the unit tests run the individual WAF rules are tested by executing a huge collection of HTTP requests against the WAF. These HTTP requests are designed to test requests that should be blocked by the WAF (to make sure it catches attacks) and those that should be let through (to make sure it isn’t over-blocking and creating false positives). What it didn’t do was test for runaway CPU utilization by the WAF and examining the log files from previous WAF builds shows that no increase in test suite run time was observed with the rule that would ultimately cause CPU exhaustion on our edge.&lt;/p&gt;
&lt;p&gt;With the tests passing, TeamCity automatically began deploying the change at 13:42.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/build-process.png&quot; class=&quot;kg-image&quot;/&gt;&lt;h3 id=&quot;quicksilver&quot;&gt;Quicksilver&lt;/h3&gt;
&lt;p&gt;Because WAF rules are required to address emergent threats they are deployed using our Quicksilver distributed key-value (KV) store that can push changes globally in seconds. This technology is used by all our customers when making configuration changes in our dashboard or via the API and is the backbone of our service’s ability to respond to changes very, very rapidly.&lt;/p&gt;
&lt;p&gt;We haven’t really talked about Quicksilver much. We previously used &lt;a href=&quot;https://fallabs.com/kyototycoon/&quot;&gt;Kyoto Tycoon&lt;/a&gt; as a globally distributed key-value store, but we ran into operational issues with it and wrote our own KV store that is replicated across our more than 180 cities. Quicksilver is how we push changes to customer configuration, update WAF rules, and distribute JavaScript code written by customers using Cloudflare Workers.&lt;/p&gt;
&lt;p&gt;From clicking a button in the dashboard or making an API call to change configuration to that change coming into effect takes seconds, globally. Customers have come to love this high speed configurability. And with Workers they expect near instant, global software deployment. On average Quicksilver distributes about 350 changes per second.&lt;/p&gt;
&lt;p&gt;And Quicksilver is very fast.  On average we hit a p99 of 2.29s for a change to be distributed to every machine worldwide. Usually, this speed is a great thing. It means that when you enable a feature or purge your cache you know that it’ll be live globally nearly instantly. When you push code with Cloudflare Workers it's pushed out at the same speed. This is part of the promise of Cloudflare fast updates when you need them.&lt;/p&gt;
&lt;p&gt;However, in this case, that speed meant that a change to the rules went global in seconds. You may notice that the WAF code uses Lua. Cloudflare makes use of Lua extensively in production and details of the &lt;a href=&quot;https://blog.cloudflare.com/cloudflares-new-waf-compiling-to-lua/&quot;&gt;Lua in the WAF&lt;/a&gt; have been &lt;a href=&quot;https://www.youtube.com/watch?v=nlt4XKhucS4&quot;&gt;discussed before&lt;/a&gt;. The Lua WAF uses &lt;a href=&quot;https://www.pcre.org/&quot;&gt;PCRE&lt;/a&gt; internally and it uses backtracking for matching and has no mechanism to protect against a runaway expression. More on that and what we're doing about it below.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/rule-deployment.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Everything that occurred up to the point the rules were deployed was done “correctly”: a pull request was raised, it was approved, CI/CD built the code and tested it, a change request was submitted with an SOP detailing rollout and rollback, and the rollout was executed.&lt;br/&gt;&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/WAF-deploy-1.png&quot; class=&quot;kg-image&quot;/&gt;Cloudflare WAF deployment process
&lt;h3 id=&quot;what-went-wrong&quot;/&gt;&lt;p&gt;What went wrong
&lt;/p&gt;&lt;p&gt;As noted, we deploy dozens of new rules to the WAF every week, and we have numerous systems in place to prevent any negative impact of that deployment. So when things do go wrong, it’s generally the unlikely convergence of multiple causes. Getting to a single root cause, while satisfying, may obscure the reality. Here are the multiple vulnerabilities that converged to get to the point where Cloudflare’s service for HTTP/HTTPS went offline.&lt;br/&gt;&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;An engineer wrote a regular expression that could easily &lt;a href=&quot;https://www.regular-expressions.info/catastrophic.html&quot;&gt;backtrack&lt;/a&gt; enormously.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;A protection that would have helped prevent excessive CPU use by a regular expression was removed by mistake during a refactoring of the WAF weeks prior—a refactoring that was part of making the WAF use less CPU.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;The regular expression engine being used didn’t have complexity guarantees.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;The test suite didn’t have a way of identifying excessive CPU consumption.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;The SOP allowed a non-emergency rule change to go globally into production without a staged rollout.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;The rollback plan required running the complete WAF build twice taking too long.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;The first alert for the global traffic drop took too long to fire.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;We didn’t update our status page quickly enough.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;We had difficulty accessing our own systems because of the outage and the bypass procedure wasn’t well trained on.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;SREs had lost access to some systems because their credentials had been timed out for security reasons.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Our customers were unable to access the Cloudflare Dashboard or API because they pass through the Cloudflare edge.&lt;/li&gt;
&lt;/ol&gt;&lt;h3 id=&quot;what-s-happened-since-last-tuesday&quot;&gt;What’s happened since last Tuesday&lt;/h3&gt;
&lt;p&gt;Firstly, we stopped all release work on the WAF completely and are doing the following:&lt;br/&gt;&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Re-introduce the excessive CPU usage protection that got removed. (Done)&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Manually inspecting all 3,868 rules in the WAF Managed Rules to find and correct any other instances of possible excessive backtracking. (Inspection complete)&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Introduce performance profiling for all rules to the test suite. (ETA:  July 19)&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Switching to either the &lt;a href=&quot;https://github.com/google/re2&quot;&gt;re2&lt;/a&gt; or &lt;a href=&quot;https://docs.rs/regex/1.1.9/regex/&quot;&gt;Rust regex engine&lt;/a&gt; which both have run-time guarantees. (ETA: July 31)&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Changing the SOP to do staged rollouts of rules in the same manner used for other software at Cloudflare while retaining the ability to do emergency global deployment for active attacks.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Putting in place an emergency ability to take the Cloudflare Dashboard and API off Cloudflare's edge.&lt;br/&gt;&lt;/li&gt;
&lt;li&gt;Automating update of the &lt;a href=&quot;https://www.cloudflarestatus.com/&quot;&gt;Cloudflare Status&lt;/a&gt; page.&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;In the longer term we are moving away from the Lua WAF that I wrote years ago. We are porting the WAF to use the &lt;a href=&quot;https://blog.cloudflare.com/how-we-made-firewall-rules/&quot;&gt;new firewall engine&lt;/a&gt;. This will make the WAF both faster and add yet another layer of protection.&lt;/p&gt;
&lt;h3 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;This was an upsetting outage for our customers and for the team. We responded quickly to correct the situation and are correcting the process deficiencies that allowed the outage to occur and going deeper to protect against any further possible problems with the way we use regular expressions by replacing the underlying technology used.&lt;/p&gt;
&lt;p&gt;We are ashamed of the outage and sorry for the impact on our customers. We believe the changes we’ve made mean such an outage will never recur.&lt;/p&gt;
&lt;h3 id=&quot;appendix-about-regular-expression-backtracking&quot;&gt;Appendix: About Regular Expression Backtracking&lt;/h3&gt;
&lt;p&gt;To fully understand how &lt;code&gt;(?:(?:\&quot;|'|\]|\}|\\|\d|(?:nan|infinity|true|false|null|undefined|symbol|math)|\`|\-|\+)+[)]*;?((?:\s|-|~|!|{}|\|\||\+)*.*(?:.*=.*)))&lt;/code&gt;  caused CPU exhaustion you need to understand a little about how a standard regular expression engine works. The critical part is &lt;code&gt;.*(?:.*=.*)&lt;/code&gt;. The &lt;code&gt;(?:&lt;/code&gt; and matching &lt;code&gt;)&lt;/code&gt; are a non-capturing group (i.e. the expression inside the parentheses is grouped together as a single expression).&lt;/p&gt;
&lt;p&gt;For the purposes of the discussion of why this pattern causes CPU exhaustion we can safely ignore it and treat the pattern as &lt;a href=&quot;https://www.debuggex.com/r/DpHY-UOB9tRCJ62L&quot;&gt;&lt;code&gt;.*.*=.*&lt;/code&gt;&lt;/a&gt;. When reduced to this, the pattern obviously looks unnecessarily complex; but what's important is any &quot;real-world&quot; expression (like the complex ones in our WAF rules) that ask the engine to &quot;match anything followed by anything&quot; can lead to catastrophic backtracking. Here’s why.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/regex.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;In a regular expression, &lt;code&gt;.&lt;/code&gt; means match a single character, &lt;code&gt;.*&lt;/code&gt; means match zero or more characters greedily (i.e. match as much as possible) so &lt;code&gt;.*.*=.*&lt;/code&gt; means match zero or more characters, then match zero or more characters, then find a literal &lt;code&gt;=&lt;/code&gt; sign, then match zero or more characters.&lt;/p&gt;
&lt;p&gt;Consider the test string &lt;code&gt;x=x&lt;/code&gt;. This will match the expression &lt;code&gt;.*.*=.*&lt;/code&gt;. The &lt;code&gt;.*.*&lt;/code&gt; before the equal can match the first &lt;code&gt;x&lt;/code&gt; (one of the &lt;code&gt;.*&lt;/code&gt; matches the &lt;code&gt;x&lt;/code&gt;, the other matches zero characters). The &lt;code&gt;.*&lt;/code&gt; after the &lt;code&gt;=&lt;/code&gt; matches the final &lt;code&gt;x&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It takes 23 steps for this match to happen. The first &lt;code&gt;.*&lt;/code&gt; in &lt;code&gt;.*.*=.*&lt;/code&gt; acts greedily and matches the entire &lt;code&gt;x=x&lt;/code&gt; string. The engine moves on to consider the next &lt;code&gt;.*&lt;/code&gt;. There are no more characters left to match so the second &lt;code&gt;.*&lt;/code&gt; matches zero characters (that’s allowed). Then the engine moves on to the &lt;code&gt;=&lt;/code&gt;. As there are no characters left to match (the first &lt;code&gt;.*&lt;/code&gt; having consumed all of &lt;code&gt;x=x&lt;/code&gt;) the match fails.&lt;/p&gt;
&lt;p&gt;At this point the regular expression engine backtracks. It returns to the first &lt;code&gt;.*&lt;/code&gt; and matches it against &lt;code&gt;x=&lt;/code&gt; (instead of &lt;code&gt;x=x&lt;/code&gt;) and then moves onto the second &lt;code&gt;.*&lt;/code&gt;. That &lt;code&gt;.*&lt;/code&gt; matches the second &lt;code&gt;x&lt;/code&gt; and now there are no more characters left to match. So when the engine tries to match the &lt;code&gt;=&lt;/code&gt; in &lt;code&gt;.*.*=.*&lt;/code&gt; the match fails. The engine backtracks again.&lt;/p&gt;
&lt;p&gt;This time it backtracks so that the first &lt;code&gt;.*&lt;/code&gt; is still matching &lt;code&gt;x=&lt;/code&gt; but the second &lt;code&gt;.*&lt;/code&gt; no longer matches &lt;code&gt;x&lt;/code&gt;; it matches zero characters. The engine then moves on to try to find the literal &lt;code&gt;=&lt;/code&gt; in the &lt;code&gt;.*.*=.*&lt;/code&gt; pattern but it fails (because it was already matched against the first &lt;code&gt;.*&lt;/code&gt;). The engine backtracks again.&lt;/p&gt;
&lt;p&gt;This time the first &lt;code&gt;.*&lt;/code&gt; matches just the first &lt;code&gt;x&lt;/code&gt;. But the second &lt;code&gt;.*&lt;/code&gt; acts greedily and matches &lt;code&gt;=x&lt;/code&gt;. You can see what’s coming. When it tries to match the literal &lt;code&gt;=&lt;/code&gt; it fails and backtracks again.&lt;/p&gt;
&lt;p&gt;The first &lt;code&gt;.*&lt;/code&gt; still matches just the first &lt;code&gt;x&lt;/code&gt;. Now the second &lt;code&gt;.*&lt;/code&gt; matches just &lt;code&gt;=&lt;/code&gt;. But, you guessed it, the engine can’t match the literal &lt;code&gt;=&lt;/code&gt; because the second &lt;code&gt;.*&lt;/code&gt; matched it. So the engine backtracks again. Remember, this is all to match a three character string.&lt;/p&gt;
&lt;p&gt;Finally, with the first &lt;code&gt;.*&lt;/code&gt; matching just the first &lt;code&gt;x&lt;/code&gt;, the second &lt;code&gt;.*&lt;/code&gt; matching zero characters the engine is able to match the literal &lt;code&gt;=&lt;/code&gt; in the expression with the &lt;code&gt;=&lt;/code&gt; in the string. It moves on and the final &lt;code&gt;.*&lt;/code&gt; matches the final &lt;code&gt;x&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;23 steps to match &lt;code&gt;x=x&lt;/code&gt;. Here’s a short video of that using the Perl &lt;a href=&quot;https://metacpan.org/pod/Regexp::Debugger&quot;&gt;Regexp::Debugger&lt;/a&gt; showing the steps and backtracking as they occur.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/23-steps-1.gif&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;That’s a lot of work but what happens if the string is changed from &lt;code&gt;x=x&lt;/code&gt; to &lt;code&gt;x=xx&lt;/code&gt;? This time is takes 33 steps to match. And if the input is &lt;code&gt;x=xxx&lt;/code&gt; it takes 45. That’s not linear. Here’s a chart showing matching from &lt;code&gt;x=x&lt;/code&gt; to &lt;code&gt;x=xxxxxxxxxxxxxxxxxxxx&lt;/code&gt; (20 &lt;code&gt;x&lt;/code&gt;’s after the &lt;code&gt;=&lt;/code&gt;). With 20 &lt;code&gt;x&lt;/code&gt;’s after the &lt;code&gt;=&lt;/code&gt; the engine takes 555 steps to match! (Worse, if the &lt;code&gt;x=&lt;/code&gt; was missing, so the string was just 20 &lt;code&gt;x&lt;/code&gt;’s, the engine would take 4,067 steps to find the pattern doesn’t match).&lt;br/&gt;&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/matching-x-x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;This video shows all the backtracking necessary to match &lt;code&gt;x=xxxxxxxxxxxxxxxxxxxx&lt;/code&gt;:&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/555-steps.gif&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;That’s bad because as the input size goes up the match time goes up super-linearly. But things could have been even worse with a slightly different regular expression. Suppose it had been &lt;code&gt;.*.*=.*;&lt;/code&gt; (i.e. there’s a literal semicolon at the end of the pattern). This could easily have been written to try to match an expression like &lt;code&gt;foo=bar;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;This time the backtracking would have been catastrophic. To match &lt;code&gt;x=x&lt;/code&gt; takes 90 steps instead of 23. And the number of steps grows very quickly. Matching &lt;code&gt;x=&lt;/code&gt; followed by 20 &lt;code&gt;x&lt;/code&gt;’s takes 5,353 steps. Here’s the corresponding chart. Look carefully at the Y-axis values compared the previous chart.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/failing-x-x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;To complete the picture here are all 5,353 steps of failing to match &lt;code&gt;x=xxxxxxxxxxxxxxxxxxxx&lt;/code&gt; against &lt;code&gt;.*.*=.*;&lt;/code&gt;&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/5353.gif&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;Using lazy rather than greedy matches helps control the amount of backtracking that occurs in this case. If the original expression is changed to &lt;code&gt;.*?.*?=.*?&lt;/code&gt; then matching &lt;code&gt;x=x&lt;/code&gt; takes 11 steps (instead of 23) and so does matching &lt;code&gt;x=xxxxxxxxxxxxxxxxxxxx&lt;/code&gt;. That’s because the &lt;code&gt;?&lt;/code&gt; after the &lt;code&gt;.*&lt;/code&gt; instructs the engine to match the smallest number of characters first before moving on.&lt;/p&gt;
&lt;p&gt;But laziness isn’t the total solution to this backtracking behaviour. Changing the catastrophic example &lt;code&gt;.*.*=.*;&lt;/code&gt; to &lt;code&gt;.*?.*?=.*?;&lt;/code&gt; doesn’t change its run time at all. &lt;code&gt;x=x&lt;/code&gt; still takes 555 steps and &lt;code&gt;x=&lt;/code&gt; followed by 20 &lt;code&gt;x&lt;/code&gt;’s still takes 5,353 steps.&lt;/p&gt;
&lt;p&gt;The only real solution, short of fully re-writing the pattern to be more specific, is to move away from a regular expression engine with this backtracking mechanism. Which we are doing within the next few weeks.&lt;/p&gt;
&lt;p&gt;The solution to this problem has been known since 1968 when Ken Thompson wrote a paper titled “&lt;a href=&quot;https://dl.acm.org/citation.cfm?doid=363347.363387&quot;&gt;Programming Techniques: Regular expression search algorithm&lt;/a&gt;”. The paper describes a mechanism for converting a regular expression into an NFA (non-deterministic finite automata) and then following the state transitions in the NFA using an algorithm that executes in time linear in the size of the string being matched against.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/thompson-1968.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Thompson’s paper doesn’t actually talk about NFA but the linear time algorithm is clearly explained and an ALGOL-60 program that generates assembly language code for the IBM 7094 is presented. The implementation may be arcane but the idea it presents is not.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/nfa.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Here’s what the &lt;code&gt;.*.*=.*&lt;/code&gt; regular expression would look like when diagrammed in a similar manner to the pictures in Thompson’s paper.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/figure-0@1.5x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;Figure 0 has five states starting at 0. There are three loops which begin with the states 1, 2 and 3. These three loops correspond to the three &lt;code&gt;.*&lt;/code&gt; in the regular expression. The three lozenges with dots in them match a single character. The lozenge with an &lt;code&gt;=&lt;/code&gt; sign in it matches the literal &lt;code&gt;=&lt;/code&gt; sign. State 4 is the ending state, if reached then the regular expression has matched.&lt;/p&gt;
&lt;p&gt;To see how such a state diagram can be used to match the regular expression &lt;code&gt;.*.*=.*&lt;/code&gt; we’ll examine matching the string &lt;code&gt;x=x&lt;/code&gt;. The program starts in state 0 as shown in Figure 1.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/figure-1@1.5x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;The key to making this algorithm work is that the state machine is in multiple states at the same time. The NFA will take every transition it can, simultaneously.&lt;/p&gt;
&lt;p&gt;Even before it reads any input, it immediately transitions to &lt;em&gt;both&lt;/em&gt; states 1 and 2 as shown in Figure 2.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/figure-2@1.5x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;&lt;br/&gt;Looking at Figure 2 we can see what happened when it considers  first &lt;code&gt;x&lt;/code&gt; in &lt;code&gt;x=x&lt;/code&gt;. The &lt;code&gt;x&lt;/code&gt; can match the top dot by transitioning from state 1 and back to state 1. Or the &lt;code&gt;x&lt;/code&gt; can match the dot below it by transitioning from state 2 and back to state 2.&lt;/p&gt;
&lt;p&gt;So after matching the first &lt;code&gt;x&lt;/code&gt; in &lt;code&gt;x=x&lt;/code&gt; the states are still 1 and 2. It’s not possible to reach state 3 or 4 because a literal &lt;code&gt;=&lt;/code&gt; sign is needed.&lt;/p&gt;
&lt;p&gt;Next the algorithm considers the &lt;code&gt;=&lt;/code&gt; in &lt;code&gt;x=x&lt;/code&gt;. Much like the &lt;code&gt;x&lt;/code&gt; before it, it can be matched by either of the top two loops transitioning from state 1 to state 1 or state 2 to state 2, but additionally the literal &lt;code&gt;=&lt;/code&gt; can be matched and the algorithm can transition state 2 to state 3 (and immediately state 4). That’s illustrated in Figure 3.&lt;/p&gt;
&lt;img src=&quot;https://blog-cloudflare-com-assets.storage.googleapis.com/2019/07/figure-3@1.5x.png&quot; class=&quot;kg-image&quot;/&gt;&lt;p&gt;Next the algorithm reaches the final &lt;code&gt;x&lt;/code&gt; in &lt;code&gt;x=x&lt;/code&gt;. From states 1 and 2 the same transitions are possible back to states 1 and 2. From state 3 the &lt;code&gt;x&lt;/code&gt; can match the dot on the right and transition back to state 3.&lt;/p&gt;
&lt;p&gt;At that point every character of &lt;code&gt;x=x&lt;/code&gt; has been considered and because state 4 has been reached the regular expression matches that string. Each character was processed once so the algorithm was linear in the length of the input string. And no backtracking was needed.&lt;/p&gt;
&lt;p&gt;It might also be obvious that once state 4 was reached (after &lt;code&gt;x=&lt;/code&gt; was matched) the regular expression had matched and the algorithm could terminate without considering the final &lt;code&gt;x&lt;/code&gt; at all.&lt;/p&gt;
&lt;p&gt;This algorithm is linear in the size of its input.&lt;/p&gt;
</description>
<pubDate>Fri, 12 Jul 2019 15:46:24 +0000</pubDate>
<dc:creator>jgrahamc</dc:creator>
<og:type>article</og:type>
<og:title>Details of the Cloudflare outage on July 2, 2019</og:title>
<og:description>Almost nine years ago, Cloudflare was a tiny company and I was a customer not an employee. Cloudflare had launched a month earlier and one day alerting told me that my little site, jgc.org, didn’t seem to have working DNS any more. Cloudflare had pushed out a change</og:description>
<og:url>https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/</dc:identifier>
</item>
</channel>
</rss>