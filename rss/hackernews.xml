<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Things that are more inequitable than road pricing</title>
<link>http://cityobservatory.org/ten-things-more-inequitable-that-road-pricing/</link>
<guid isPermaLink="true" >http://cityobservatory.org/ten-things-more-inequitable-that-road-pricing/</guid>
<description>&lt;p&gt;&lt;em&gt;Don’t decry congestion pricing as inequitable until after you fix, or at least acknowledge, these ten other things that are even more inequitable about the way we pay for transportation.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;There’s a growing interest in using congestion pricing to help tackle traffic issues in major cities. Putting a price on peak hour road capacity is the only thing that’s been shown to effectively reduce congestion, based on experience in London, Stockholm, Singapore and other cities, high occupancy toll (HOT) lanes in a growing number of US cities.  But proposals to put a price on something that’s widely–&lt;a href=&quot;http://cityobservatory.org/theres-no-such-thing-as-a-free-way/&quot;&gt;if inaccurately&lt;/a&gt;–perceived to be “free” invites all manner of arguments from those who might have to pay. And a favorite argument is that road pricing is somehow punitive to the poor, and inequitable.&lt;/p&gt;
&lt;p&gt;Any time we charge a positive price for anything, the cost of paying that price is a higher burden on the poor than it is on the rich. It takes a special combination of myopia and tunnel vision to look at the prospect of congestion pricing anything other than a minor blip on a system of transportation finance that is systematically unfair to the poor and those who don’t own (or can’t afford) car.&lt;/p&gt;
&lt;p&gt;Here is our list of ten things that are more inequitable that road pricing.&lt;/p&gt;
&lt;p&gt;1. &lt;strong&gt;Flat vehicle registration fees&lt;/strong&gt;. Many states charge the same amount to register a used economy car as they charge to register a new full-sized SUV.  As we demonstrated in our commentary, &lt;a href=&quot;http://cityobservatory.org/transportation-equity-part-2-the-subaru-and-the-suburban/&quot;&gt;the Suburban and the Subaru&lt;/a&gt;, whether based on miles driven (a measure of value received from public roads), income or value (a measure of ability to pay) or weight (a measure of damage done to the roadway, a flat fee is simply unfair to lower income families.  On a per mile basis, the owner of a ten year-old Subaru can easily end up paying registration fees three times higher than the owner of a new Suburban.&lt;/p&gt;
&lt;p&gt;2. &lt;strong&gt;Not pricing road&lt;/strong&gt;s, which results in &lt;a href=&quot;http://cityobservatory.org/why-road-pricing-is-inherently-equitable-faster-buses/&quot;&gt;slower bus speeds&lt;/a&gt;. As we pointed out last year, those who depend on public buses are the victims of congested roadways.  Buses travel more slowly, are a less attractive alternative to car travel, and are less efficient (each bus and driver carry fewer passengers per hour or day). Not pricing roads makes bus travel worse for those who are dependent on it.&lt;/p&gt;
&lt;a href=&quot;https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg&quot;&gt;&lt;img class=&quot;size-large wp-image-7277&quot; src=&quot;https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg?resize=640%2C480&quot; alt=&quot;&quot; width=&quot;640&quot; height=&quot;480&quot; srcset=&quot;https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg?resize=1024%2C768 1024w, https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg?resize=300%2C225 300w, https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg?resize=768%2C576 768w, https://i0.wp.com/cityobservatory.org/wp-content/uploads/2018/10/trimet_bus_pdx.jpg?w=1030 1030w&quot; sizes=&quot;(max-width: 640px) 100vw, 640px&quot; data-recalc-dims=&quot;1&quot;/&gt;&lt;/a&gt;Not pricing roads means these travel more slowly, which is unfair to low income households
&lt;p&gt;3. &lt;strong&gt;The storm sewer subsidy&lt;/strong&gt;. Some of the most expensive infrastructure out there is the massive stormwater systems cities are building to deal with runoff during storms. Impervious surfaces like roadways account for up to half of urban stormwater, and much, if not most of the toxic material in stormwater comes from cars (leaking oil, tire residue, brake material, precipitated air pollutants). But roads (and therefore cars and car users) generally contribute nothing to the cost of collecting or treating stormwater:  the entire cost is usually added to city sewer and water bills.  The result is that city tax and ratepayers pay the cost of dealing with pollution, which comes from those who drive, many of whom are non-residents. It’s a huge burden for economically distressed cities, like Akron, which is spending &lt;a href=&quot;https://www.cleveland.com/akron/index.ssf/2015/06/the_largest_construction_proje.html&quot;&gt;over a billion dollars&lt;/a&gt; for giant new sewers to eliminate storm runoff. Akron city residents tend to be poorer and have low rates of car ownership, so they will pay for storm sewers; suburbanites in commute into Akron, and use the roads and surface parking lots that create the runoff, and who have higher incomes, won’t pay.  It’s inequitable.&lt;/p&gt;
&lt;p&gt;4. &lt;strong&gt;Insurance rates&lt;/strong&gt;. Virtually all states require motorists to purchase liability insurance as a condition of owning or operating a motor vehicle.  While insurance is privately provided, the fact that it is legally mandated makes it much like a tax. And insurance rates are not discounted for the poor.  If anything, there is abundant evidence that both the poor and urban residents &lt;a href=&quot;http://www.michiganradio.org/post/woman-pays-182-more-car-insurance-detroit-she-would-ann-arbor&quot;&gt;pay more for car insurance&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;5. &lt;strong&gt;Gasoline and gas taxes&lt;/strong&gt;. Nearly all vehicles are fueled by gasoline. Gas taxes, the principal user fee for roads, is not pro-rated by income. Low income households pay the same per gallon tax as high income households.  Gas taxes, as a result, tend to be &lt;a href=&quot;https://econreview.berkeley.edu/is-the-california-gas-tax-worth-saving/&quot;&gt;much more regressive&lt;/a&gt; than other forms of taxation. That’s just as inequitable, on its face, as congestion pricing, yet we’ve never seen a serious argument that we ought to discount the price of gasoline for poor households.&lt;/p&gt;
&lt;p&gt;6. &lt;strong&gt;Tax credits for the purchase of new electric vehicles&lt;/strong&gt;.  The federal government and many states offer tax credits for the purchase of electric vehicles.  Poor households both have much lower rates of car ownership, and are far &lt;a href=&quot;https://www.cleveland.com/akron/index.ssf/2015/06/the_largest_construction_proje.html&quot;&gt;less&lt;/a&gt; likely to purchase new vehicles; most can only afford used vehicles, for which tax credits are not available.  Giving &lt;a href=&quot;https://www.energy.gov/eere/electricvehicles/electric-vehicles-tax-credits-and-other-incentives&quot;&gt;$7,500 tax credits&lt;/a&gt; to households who are rich enough to afford a new Tesla (MSRP: $46,000) isn’t equitable. (Some 200,000 Tesla owners have already gotten the credit, which will now be dialed back to $3,750 per car). Doubtful that any poor families qualified.&lt;/p&gt;
&lt;p&gt;7.  &lt;strong&gt;Paid parking&lt;/strong&gt;.  In many locations, particularly dense city centers, you practically can’t use a vehicle for transportation unless you are willing to pay for its parking space either at a metered space on the street, or at an off-street lot or parking structure. While cities do provide free parking for disabled citizens (a perk that is frequently abused), parking meters don’t charge different rates to users based on their income; you have to pay the same amount to park your used Jetta as you do your new Mercedes. Again:  the cost of parking bears more heavily on the poor than on the rich, both as a share of income, and in relation to the value of their vehicles. Plus, we haven’t even said anything about the provisions of the &lt;a href=&quot;http://transitcenter.org/publications/who-pays-for-parking/#executive-summary&quot;&gt;tax code that subsidize parking&lt;/a&gt;, chiefly for high income workers. That’s inequitable.&lt;/p&gt;
&lt;a href=&quot;https://i1.wp.com/cityobservatory.org/wp-content/uploads/2019/01/Parking_295.jpg&quot;&gt;&lt;img class=&quot;wp-image-7434 size-full&quot; src=&quot;https://i1.wp.com/cityobservatory.org/wp-content/uploads/2019/01/Parking_295.jpg?resize=494%2C873&quot; alt=&quot;&quot; width=&quot;494&quot; height=&quot;873&quot; srcset=&quot;https://i1.wp.com/cityobservatory.org/wp-content/uploads/2019/01/Parking_295.jpg?w=494 494w, https://i1.wp.com/cityobservatory.org/wp-content/uploads/2019/01/Parking_295.jpg?resize=170%2C300 170w&quot; sizes=&quot;(max-width: 494px) 100vw, 494px&quot; data-recalc-dims=&quot;1&quot;/&gt;&lt;/a&gt;Is high priced parking fair to the poor?
&lt;p&gt;8.  &lt;strong&gt;“Free” parking.&lt;/strong&gt; As Donald Shoup has demonstrated time and again, &lt;a href=&quot;https://www.vox.com/2014/6/27/5849280/why-free-parking-is-bad-for-everyone&quot;&gt;there’s nothing free about free parking&lt;/a&gt;.  The effective requirement that people have to build new parking as a condition of getting a building permit for a store, office, home or apartment, drives up the cost of new construction and housing. In addition, those who don’t own cars, who walk, cycle and ride buses, end up subsidizing those who get the free parking. One study estimates that carless renters pay almost &lt;a href=&quot;https://www.accessmagazine.org/spring-2017/the-hidden-cost-of-bundled-parking/&quot;&gt;half a billion dollars a yea&lt;/a&gt;r for garage parking that’s bundled in their rent, but which they can’t use, because they don’t own cars. As we wrote in our commentary on the &lt;a href=&quot;http://cityobservatory.org/parking-where-we-embrace-socialism-in-the-us/&quot;&gt;triumph of parking socialism&lt;/a&gt;, the law in its majesty provides free parking to everyone, whether they own a vehicle or not. As a practical matter, “free” parking, like free roads, benefits those with higher incomes who can afford and who use cars extensively.&lt;/p&gt;
&lt;a href=&quot;https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg&quot;&gt;&lt;img class=&quot;wp-image-7432 size-large&quot; src=&quot;https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?resize=640%2C362&quot; alt=&quot;&quot; width=&quot;640&quot; height=&quot;362&quot; srcset=&quot;https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?resize=1024%2C579 1024w, https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?resize=300%2C170 300w, https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?resize=768%2C434 768w, https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?w=1544 1544w, https://i2.wp.com/cityobservatory.org/wp-content/uploads/2019/01/parking_2day.jpg?w=1280 1280w&quot; sizes=&quot;(max-width: 640px) 100vw, 640px&quot; data-recalc-dims=&quot;1&quot;/&gt;&lt;/a&gt;And parking can be so cheap it undercuts transit, and makes cities less walkable.
&lt;p&gt;9. &lt;strong&gt;The property tax exemption for cars&lt;/strong&gt;. Unlike say houses and other forms of real property, cars are seldom charged property taxes. For example, Oregon completely exempts cars from state and local property taxes, a provision that costs local governments &lt;a href=&quot;http://www.oregon.gov/DOR/programs/gov-research/Documents/full-tax-expenditure_2017-19.pdf&quot;&gt;$989 million per biennium in revenue&lt;/a&gt;. And naturally, the exemption is a benefit only for those who own cars, and disproportionately rewards those who own expensive newer cars.  If we extended the property tax to cars–with say an exemption on the first $10,000 of value, so that someone driving a ten-year old clunker would pay nothing, the system would be much more equitable.&lt;/p&gt;
&lt;p&gt;10. &lt;strong&gt;Unfair taxation of greener, safer, less congesting modes of transportation&lt;/strong&gt;. Consider the fiscal conditions imposed on scooter operators as part of Portland’s experiment with fleets of shared electric scooters last year. The city required the scooter companies to pay $1 per scooter per day to cover the cost of streets. As we noted at &lt;a href=&quot;http://cityobservatory.org/e-scooters-and-paying-for-roads/&quot;&gt;City Observatory&lt;/a&gt;, that’s vastly more that the amount charged to cars, considering that cars take up dramatically more road space, cause more congestion and air pollution, and damage roads more. If cars were charged proportionately to scooters relative to their weight or value, cars should be paying $10 or $20 per day to drive in the city. Again:  a transportation finance system that’s not equitable.&lt;/p&gt;
&lt;p&gt;Peak hour congestion pricing actually tends to affect higher income households more because they are the ones who commute by car at the peak hour.  As we documented at City Observatory, peak hour car commuters in Portland earn roughly t&lt;a href=&quot;http://cityobservatory.org/transportation-equity/&quot;&gt;wice as much on average&lt;/a&gt;, as those who commute by car or bus or in non-peak hours. Similarly, unlike flat tolls, congestion pricing can have low or even zero charges during off-peak hours, creating a low-cost or free alternative for those with limited means and flexibility in travel schedules.&lt;/p&gt;
&lt;p&gt;There are plenty of things we can do to ameliorate any of the perceived negative effects of congestion pricing. First, as we noted in number two (above) road pricing actually benefits the poor and transit-dependent by speeding buses.   But beyond that, there are good reasons to believe that we could rebate some of the funds from congestion pricing to offset the negative effect on low income households.  In addition, we can spend congestion pricing revenue on transit and other alternative forms of transportation.&lt;/p&gt;
&lt;p&gt;Playing the “equity” card as an objection to pricing the roads actually turns out to be a way to advance the interests not of the poor, but of those who benefit already from the wealth of subsidies to car ownership. We seem to be perfectly fine with all kinds of inequity in our transportation finance system, so long as it benefits wealthier car owners.&lt;/p&gt;
&lt;p&gt;If we’re going to talk about equity, let’s not apply it to one isolated part of the transportation system. Instead, let’s ask what it takes to create an overall system that is fair to all, considering all aspects of how the system is paid for, who benefits, and who bears the external costs (of things like crashes, air pollution and runoff). If we do, congestion pricing can be at the heart of a system that is both more efficient and fair.&lt;/p&gt;
&lt;p&gt;Note: This commentary has been revised to correct a typo in the headline, h/t to @stevenspinello.&lt;/p&gt;

</description>
<pubDate>Sun, 03 Feb 2019 13:27:55 +0000</pubDate>
<dc:creator>oftenwrong</dc:creator>
<og:title>City Observatory - Ten things more inequitable than road pricing</og:title>
<og:type>website</og:type>
<og:url>http://cityobservatory.org/ten-things-more-inequitable-that-road-pricing/</og:url>
<og:image>http://cityobservatory.org/wp-content/uploads/2019/01/Parking_295.jpg</og:image>
<og:description>The City Observatory is a study of modern-day cities and urban development practices.</og:description>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://cityobservatory.org/ten-things-more-inequitable-that-road-pricing/</dc:identifier>
</item>
<item>
<title>Let Children Get Bored Again</title>
<link>https://www.nytimes.com/2019/02/02/opinion/sunday/children-bored.html</link>
<guid isPermaLink="true" >https://www.nytimes.com/2019/02/02/opinion/sunday/children-bored.html</guid>
<description>&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;“I’m bored.” It’s a puny little phrase, yet it has the power to fill parents with a cascade of dread, annoyance and guilt. If someone around here is bored, someone else must have failed to enlighten or enrich or divert. And how can anyone — child or adult — claim boredom when there’s so much that can and should be done? Immediately.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;But boredom is something to experience rather than hastily swipe away. And not as some kind of cruel Victorian conditioning, recommended because it’s awful and toughens you up. Despite the lesson most adults learned growing up — boredom is for boring people — boredom is useful. It’s good for you.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;If kids don’t figure this out early on, they’re in for a nasty surprise. School, let’s face it, can be dull, and it isn’t actually the teacher’s job to entertain as well as educate. Life isn’t meant to be an endless parade of amusements. “That’s right,” a mother says to her daughter in Maria Semple’s 2012 novel, “&lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.nytimes.com/2012/08/07/books/whered-you-go-bernadette-a-maria-semple-novel.html?module=inline&quot; title=&quot;&quot;&gt;Where’d You Go, Bernadette&lt;/a&gt;.” “You are bored. And I’m going to let you in on a little secret about life. You think it’s boring now? Well, it only gets more boring. The sooner you learn it’s on you to make life interesting, the better off you’ll be.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;People used to accept that much of life was boring. Memoirs of pre-21st-century life are rife with tedium. When not idling in drawing rooms, members of the leisured class took long walks and stared at trees. They went motoring and stared at more trees. Those who had to work had it a lot harder. Agricultural and industrial jobs were often mind-numbing; few people were looking to be fulfilled by paid labor. Children could expect those kinds of futures and they got used to the idea from an early age, left unattended with nothing but bookshelves and tree branches, and later, bad afternoon television.&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Only a few short decades ago, during the lost age of underparenting, grown-ups thought a certain amount of boredom was appropriate. And children came to appreciate their empty agendas. In an &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.gq.com/story/unexpected-lin-manuel-miranda&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;interview with GQ magazine&lt;/a&gt;, Lin-Manuel Miranda credited his unattended afternoons with fostering inspiration. “Because there is nothing better to spur creativity than a blank page or an empty bedroom,” he said.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Nowadays, subjecting a child to such inactivity is viewed as a dereliction of parental duty. In a much-read story in The Times, “&lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.nytimes.com/2018/12/25/upshot/the-relentlessness-of-modern-parenting.html?module=inline&quot; title=&quot;&quot;&gt;The Relentlessness of Modern Parenting&lt;/a&gt;,” Claire Cain Miller cited a &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://academic.oup.com/sf/advance-article/doi/10.1093/sf/soy107/5257458&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;recent study&lt;/a&gt; that found that regardless of class, income or race, parents believed that “children who were bored after school should be enrolled in extracurricular activities, and that parents who were busy should stop their task and draw with their children if asked.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Every spare moment is to be optimized, maximized, driven toward a goal.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;When not being uberparented, kids today are left to their own devices — their own digital devices, that is. Parents preparing for a long car ride or airplane trip are like Army officers plotting a complicated land maneuver. Which movies to load onto the iPad? Should we start a new family-friendly podcast? Is this an O.K. time to let the kids play Fortnite until their brains melt into the back seat? What did parents in the ’70s do when kids were bored in the way-back? Nothing! They let them breathe in gas fumes. Torture their siblings. And since it wasn’t actually for wearing, play with the broken seatbelt.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;If you complained about being bored back then, you were really asking for it. “Go outside,” you might get, or worse, “Clean your room.” Was this fun? No. Was it helpful? Yes.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Because things happen when you’re bored. Some of the most boring jobs I’ve had were also the most creative. Working at an import factory after school, I pasted photos of ugly Peruvian sweaters onto sales sheets. My hands became encrusted with glue as the sweaters blurred into a clumpy sameness. For some reason, everything smelled like molasses. My mind had no choice but to drift into an elaborate fantasy realm. It’s when you are bored that stories set in. Checking out groceries at the supermarket, I invented narratives around people’s purchases. The man buying eggplant and a six-pack of Bud at 9 p.m.: Which was the must-get item and which the impulse purchase? How did my former fifth-grade teacher feel about my observing her weekly purchase of Nutter Butters?&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;
&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Once you’ve truly settled into the anesthetizing effects of boredom, you find yourself en route to discovery. With monotony, small differences begin to emerge, between those trees, those sweaters. This is why so many useful ideas occur in the shower, when you’re held captive to a mundane activity. You let your mind wander and follow it where it goes.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Of course, it’s not really the boredom itself that’s important; it’s what we do with it. When you reach your breaking point, boredom teaches you to respond constructively, to make something happen for yourself. But unless we are faced with a steady diet of stultifying boredom, we never learn how.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;The idea isn’t that you suffer through crushing tedium indefinitely like Neville (“N is for Neville who died of ennui”) of “&lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.independent.co.uk/arts-entertainment/art/great-works/gorey-edward-the-gashlycrumb-tinies-1963-887857.html&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;The Gashlycrumb Tinies&lt;/a&gt;.” It’s that you learn how to vanquish it. This may come in several forms: You might turn inward and use the time to think. You might reach for a book. You might imagine your way to a better job. Boredom leads to &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.tandfonline.com/doi/abs/10.1080/10400419.2014.901073#preview&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;flights of fancy&lt;/a&gt;. But ultimately, to self-discipline. To resourcefulness.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;The ability to handle boredom, not surprisingly, is correlated with the ability to focus and to self-regulate. &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://link.springer.com/article/10.1007/s00221-012-3147-z&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Research has shown&lt;/a&gt; that people with attention disorders are particularly prone to boredom. It makes sense that in a hyperstimulating world, what at first seems captivating now feels less so; what was once mildly diverting may now be flat-out dull.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;It’s especially important that kids get bored — and be allowed to stay bored — when they’re young. That it not be considered “a problem” to be avoided or eradicated by the higher-ups, but instead something kids grapple with on their own.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;We’ve stopped training children to do this. Rather than teach them to absorb material that is slower, duller and decidedly two-dimensional, like a lot of worthwhile information is, schools cave in to what they say children expect: fun. Teachers spend more time concocting ways to “engage” students through visuals and “interactive learning” (read: screens, games) tailored to their Candy Crushed attention spans. Kids won’t listen to long lectures, goes the argument, so it’s on us to serve up learning in easier-to-swallow portions.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;But surely teaching children to endure boredom rather than ratcheting up the entertainment will prepare them for a more realistic future, one that doesn’t raise false expectations of what work or life itself actually entails. One day, even in a job they otherwise love, our kids may have to spend an entire day answering Friday’s leftover email. They may have to check spreadsheets. Or assist robots at a vast internet-ready warehouse.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;This sounds boring, you might conclude. It sounds like work, and it sounds like life. Perhaps we should get used to it again, and use it to our benefit. Perhaps in an incessant, up-the-ante world, we could do with a little less excitement.&lt;/p&gt;
&lt;p class=&quot;css-1psfkbx etfikam0&quot;&gt;&lt;a class=&quot;css-1g7m0tk&quot; href=&quot;http://www.pamelapaul.com/&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Pamela Paul&lt;/a&gt; is the editor of the Book Review and a co-author of the forthcoming book “How to Raise a Reader.&quot;&lt;/p&gt;
&lt;p class=&quot;css-1psfkbx etfikam0&quot;&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;Follow The New York Times Opinion section on&lt;/em&gt; &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.facebook.com/nytopinion&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;Facebook&lt;/em&gt;&lt;/a&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;,&lt;/em&gt; &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;http://twitter.com/NYTOpinion&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;Twitter (@NYTopinion)&lt;/em&gt;&lt;/a&gt; &lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;and&lt;/em&gt; &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.instagram.com/nytopinion/&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;Instagram&lt;/em&gt;&lt;/a&gt;&lt;em class=&quot;css-2fg4z9 e1gzwzxm0&quot;&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;
</description>
<pubDate>Sun, 03 Feb 2019 12:48:46 +0000</pubDate>
<dc:creator>glassworm</dc:creator>
<og:url>https://www.nytimes.com/2019/02/02/opinion/sunday/children-bored.html</og:url>
<og:type>article</og:type>
<og:title>Opinion | Let Children Get Bored Again</og:title>
<og:image>https://static01.nyt.com/images/2019/02/03/opinion/sunday/03paul/03paul-facebookJumbo.jpg</og:image>
<og:description>Boredom teaches us that life isn’t a parade of amusements. More important, it spawns creativity and self-sufficiency.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.nytimes.com/2019/02/02/opinion/sunday/children-bored.html</dc:identifier>
</item>
<item>
<title>React as a UI Runtime</title>
<link>https://overreacted.io/react-as-a-ui-runtime/</link>
<guid isPermaLink="true" >https://overreacted.io/react-as-a-ui-runtime/</guid>
<description>&lt;p&gt;Most tutorials introduce React as a UI library. This makes sense because React &lt;em&gt;is&lt;/em&gt; a UI library. That’s literally what the tagline says!&lt;/p&gt;
&lt;p&gt;&lt;a class=&quot;gatsby-resp-image-link&quot; href=&quot;https://overreacted.io/static/0429fcb4a2f2022852afc698ff8968f1/74bd4/react.png&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;span class=&quot;gatsby-resp-image-wrapper&quot;&gt;&lt;span class=&quot;gatsby-resp-image-background-image&quot;&gt;&lt;img class=&quot;gatsby-resp-image-image&quot; alt=&quot;React homepage screenshot: &quot; a=&quot;&quot; javascript=&quot;&quot; library=&quot;&quot; for=&quot;&quot; building=&quot;&quot; user=&quot;&quot; title=&quot;&quot; src=&quot;https://overreacted.io/static/0429fcb4a2f2022852afc698ff8968f1/74bd4/react.png&quot; srcset=&quot;/static/0429fcb4a2f2022852afc698ff8968f1/309d6/react.png 148w, /static/0429fcb4a2f2022852afc698ff8968f1/fe30e/react.png 295w, /static/0429fcb4a2f2022852afc698ff8968f1/74bd4/react.png 500w&quot; sizes=&quot;(max-width: 500px) 100vw, 500px&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I’ve written about the challenges of creating &lt;a href=&quot;https://overreacted.io/the-elements-of-ui-engineering/&quot;&gt;user interfaces&lt;/a&gt; before. But this post talks about React in a different way — more as a &lt;a href=&quot;https://en.wikipedia.org/wiki/Runtime_system&quot;&gt;programming runtime&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This post won’t teach you anything about creating user interfaces.&lt;/strong&gt; But it might help you understand the React programming model in more depth.&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;&lt;strong&gt;Note: If you’re &lt;em&gt;learning&lt;/em&gt; React, check out &lt;a href=&quot;https://reactjs.org/docs/getting-started.html#learn-react&quot;&gt;the docs&lt;/a&gt; instead.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;⚠️&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This is a deep dive — THIS IS NOT a beginner-friendly post.&lt;/strong&gt; In this post, I’m describing most of the React programming model from first principles. I don’t explain how to use it — just how it works.&lt;/p&gt;
&lt;p&gt;It’s aimed at experienced programmers and folks working on other UI libraries who asked about some tradeoffs chosen in React. I hope you’ll find it useful!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Many people successfully use React for years without thinking about most of these topics.&lt;/strong&gt; This is definitely a programmer-centric view of React rather than, say, a &lt;a href=&quot;http://mrmrs.cc/writing/2016/04/21/developing-ui/&quot;&gt;designer-centric one&lt;/a&gt;. But I don’t think it hurts to have resources for both.&lt;/p&gt;
&lt;p&gt;With that disclaimer out of the way, let’s go!&lt;/p&gt;
&lt;hr/&gt;&lt;h2 id=&quot;host-tree&quot;&gt;Host Tree&lt;/h2&gt;
&lt;p&gt;Some programs output numbers. Other programs output poems. Different languages and their runtimes are often optimized for a particular set of use cases, and React is no exception to that.&lt;/p&gt;
&lt;p&gt;React programs usually output &lt;strong&gt;a tree that may change over time&lt;/strong&gt;. It might be a &lt;a href=&quot;https://www.npmjs.com/package/react-dom&quot;&gt;DOM tree&lt;/a&gt;, an &lt;a href=&quot;https://developer.apple.com/library/archive/documentation/General/Conceptual/Devpedia-CocoaApp/View%20Hierarchy.html&quot;&gt;iOS hierarchy&lt;/a&gt;, a tree of &lt;a href=&quot;https://react-pdf.org/&quot;&gt;PDF primitives&lt;/a&gt;, or even of &lt;a href=&quot;https://reactjs.org/docs/test-renderer.html&quot;&gt;JSON objects&lt;/a&gt;. However, usually we want to represent some UI with it. We’ll call it a “&lt;em&gt;host&lt;/em&gt; tree” because it is a part of the &lt;em&gt;host environment&lt;/em&gt; outside of React — like DOM or iOS. The host tree usually has &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild&quot;&gt;its&lt;/a&gt; &lt;a href=&quot;https://developer.apple.com/documentation/uikit/uiview/1622616-addsubview&quot;&gt;own&lt;/a&gt; imperative API. React is a layer on top of it.&lt;/p&gt;
&lt;p&gt;So what is React useful for? Very abstractly, it helps you write a program that predictably manipulates a complex host tree in response to external events like interactions, network responses, timers, and so on.&lt;/p&gt;
&lt;p&gt;A specialized tool works better than a generic one when it can impose and benefit from particular constraints. React makes a bet on two principles:&lt;/p&gt;
&lt;ul readability=&quot;2&quot;&gt;&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;&lt;strong&gt;Stability.&lt;/strong&gt; The host tree is relatively stable and most updates don’t radically change its overall structure. If an app rearranged all its interactive elements into a completely different combination every second, it would be difficult to use. Where did that button go? Why is my screen dancing?&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;&lt;strong&gt;Regularity.&lt;/strong&gt; The host tree can be broken down into UI patterns that look and behave consistently (such as buttons, lists, avatars) rather than random shapes.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;&lt;strong&gt;These principles happen to be true for most UIs.&lt;/strong&gt; However, React is ill-suited when there are no stable “patterns” in the output. For example, React may help you write a Twitter client but won’t be very useful for a &lt;a href=&quot;https://www.youtube.com/watch?v=Uzx9ArZ7MUU&quot;&gt;3D pipes screensaver&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;host-instances&quot;&gt;Host Instances&lt;/h2&gt;
&lt;p&gt;The host tree consists of nodes. We’ll call them “host instances”.&lt;/p&gt;
&lt;p&gt;In the DOM environment, host instances are regular DOM nodes — like the objects you get when you call &lt;code class=&quot;language-text&quot;&gt;document.createElement('div')&lt;/code&gt;. On iOS, host instances could be values uniquely identifying a native view from JavaScript.&lt;/p&gt;
&lt;p&gt;Host instances have their own properties (e.g. &lt;code class=&quot;language-text&quot;&gt;domNode.className&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;view.tintColor&lt;/code&gt;). They may also contain other host instances as children.&lt;/p&gt;
&lt;p&gt;(This has nothing to do with React — I’m describing the host environments.)&lt;/p&gt;
&lt;p&gt;There is usually an API to manipulate host instances. For example, the DOM provides APIs like &lt;code class=&quot;language-text&quot;&gt;appendChild&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;removeChild&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;setAttribute&lt;/code&gt;, and so on. In React apps, you usually don’t call these APIs. That’s the job of React.&lt;/p&gt;
&lt;h2 id=&quot;renderers&quot;&gt;Renderers&lt;/h2&gt;
&lt;p&gt;A &lt;em&gt;renderer&lt;/em&gt; teaches React to talk to a specific host environment and manage its host instances. React DOM, React Native, and even &lt;a href=&quot;https://mobile.twitter.com/vadimdemedes/status/1089344289102942211&quot;&gt;Ink&lt;/a&gt; are React renderers. You can also &lt;a href=&quot;https://github.com/facebook/react/tree/master/packages/react-reconciler&quot;&gt;create your own React renderer&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;React renderers can work in one of two modes.&lt;/p&gt;
&lt;p&gt;The vast majority of renderers are written to use the “mutating” mode. This mode is how the DOM works: we can create a node, set its properties, and later add or remove children from it. The host instances are completely mutable.&lt;/p&gt;
&lt;p&gt;React can also work in a “persistent” mode. This mode is for host environments that don’t provide methods like &lt;code class=&quot;language-text&quot;&gt;appendChild()&lt;/code&gt; but instead clone the parent tree and always replace the top-level child. Immutability on the host tree level makes multi-threading easier. &lt;a href=&quot;https://facebook.github.io/react-native/blog/2018/06/14/state-of-react-native-2018&quot;&gt;React Fabric&lt;/a&gt; takes advantage of that.&lt;/p&gt;
&lt;p&gt;As a React user, you never need to think about these modes. I only want to highlight that React isn’t just an adapter from one mode to another. Its usefulness is orthogonal to the target low-level view API paradigm.&lt;/p&gt;
&lt;h2 id=&quot;react-elements&quot;&gt;React Elements&lt;/h2&gt;
&lt;p&gt;In the host environment, a host instance (like a DOM node) is the smallest building block. In React, the smallest building block is a &lt;em&gt;React element&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;React element is a plain JavaScript object. It can &lt;em&gt;describe&lt;/em&gt; a host instance.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;

&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'button'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; className&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'blue'&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A React element is lightweight and has no host instance tied to it. Again, it is merely a &lt;em&gt;description&lt;/em&gt; of what you want to see on the screen.&lt;/p&gt;
&lt;p&gt;Like host instances, React elements can form a tree:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;12&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;




&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'dialog'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'button'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; className&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'blue'&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'button'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; className&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'red'&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;(Note: I omitted &lt;a href=&quot;https://overreacted.io/why-do-react-elements-have-typeof-property/&quot;&gt;some properties&lt;/a&gt; that aren’t important to this explanation.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;However, remember that &lt;strong&gt;React elements don’t have their own persistent identity.&lt;/strong&gt; They’re meant to be re-created and thrown away all the time.&lt;/p&gt;
&lt;p&gt;React elements are immutable. For example, you can’t change the children or a property of a React element. If you want to render something different later, you will &lt;em&gt;describe&lt;/em&gt; it with a new React element tree created from scratch.&lt;/p&gt;
&lt;p&gt;I like to think of React elements as being like frames in a movie. They capture what the UI should look like at a specific point in time. They don’t change.&lt;/p&gt;
&lt;h2 id=&quot;entry-point&quot;&gt;Entry Point&lt;/h2&gt;
&lt;p&gt;Each React renderer has an “entry point”. It’s the API that lets us tell React to render a particular React element tree inside a container host instance.&lt;/p&gt;
&lt;p&gt;For example, React DOM entry point is &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;className&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;blue&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When we say &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render(reactElement, domContainer)&lt;/code&gt;, we mean: &lt;strong&gt;“Dear React, make the &lt;code class=&quot;language-text&quot;&gt;domContainer&lt;/code&gt; host tree match my &lt;code class=&quot;language-text&quot;&gt;reactElement&lt;/code&gt;.”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;React will look at the &lt;code class=&quot;language-text&quot;&gt;reactElement.type&lt;/code&gt; (in our example, &lt;code class=&quot;language-text&quot;&gt;'button'&lt;/code&gt;) and ask the React DOM renderer to create a host instance for it and set the properties:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createHostInstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reactElement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; domNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reactElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  domNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; reactElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; domNode&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In our example, effectively React will do this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; domNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'button'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;domNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'blue'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
domContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;domNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the React element has child elements in &lt;code class=&quot;language-text&quot;&gt;reactElement.props.children&lt;/code&gt;, React will recursively create host instances for them too on the first render.&lt;/p&gt;
&lt;h2 id=&quot;reconciliation&quot;&gt;Reconciliation&lt;/h2&gt;
&lt;p&gt;What happens if we call &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render()&lt;/code&gt; twice with the same container?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;className&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;blue&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;





ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;className&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;red&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Again, React’s job is to &lt;em&gt;make the host tree match the provided React element tree&lt;/em&gt;. The process of figuring out &lt;em&gt;what&lt;/em&gt; to do to the host instance tree in response to new information is sometimes called &lt;a href=&quot;https://reactjs.org/docs/reconciliation.html&quot;&gt;reconciliation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are two ways to go about it. A simplified version of React could blow away the existing tree and re-create it from scratch:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; domContainer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

domContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; domNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'button'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
domNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'red'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
domContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;domNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But in DOM, this is slow and loses important information like focus, selection, scroll state, and so on. Instead, we want React to do something like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; domNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; domContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

domNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;className &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'red'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In other words, React needs to decide when to &lt;em&gt;update&lt;/em&gt; an existing host instance to match a new React element, and when to create a &lt;em&gt;new&lt;/em&gt; one.&lt;/p&gt;
&lt;p&gt;This raises a question of &lt;em&gt;identity&lt;/em&gt;. The React element may be different every time, but when does it refer to the same host instance conceptually?&lt;/p&gt;
&lt;p&gt;In our example, it’s simple. We used to render a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;button&amp;gt;&lt;/code&gt; as a first (and only) child, and we want to render a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;button&amp;gt;&lt;/code&gt; in the same place again. We already have a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;button&amp;gt;&lt;/code&gt; host instance there so why re-create it? Let’s just reuse it.&lt;/p&gt;
&lt;p&gt;This is pretty close to how React thinks about it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;If an element type in the same place in the tree “matches up” between the previous and the next renders, React reuses the existing host instance.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here is an example with comments showing roughly what React does:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;14&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;


ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;className&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;blue&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;className&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;red&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;



ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Hello&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Goodbye&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'container'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same heuristic is used for child trees. For example, when we update a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;dialog&amp;gt;&lt;/code&gt; with two &lt;code class=&quot;language-text&quot;&gt;&amp;lt;button&amp;gt;&lt;/code&gt;s inside, React first decides whether to re-use the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;dialog&amp;gt;&lt;/code&gt;, and then repeats this decision procedure for each child.&lt;/p&gt;
&lt;h2 id=&quot;conditions&quot;&gt;Conditions&lt;/h2&gt;
&lt;p&gt;If React only reuses host instances when the element types “match up” between updates, how can we render conditional content?&lt;/p&gt;
&lt;p&gt;Say we want to first show only an input, but later render a message before it:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  domContainer
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;


ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;I was just added here!&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  domContainer
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this example, the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;input&amp;gt;&lt;/code&gt; host instance would get re-created. React would walk the element tree, comparing it with the previous version:&lt;/p&gt;
&lt;p&gt;So effectively the update code executed by React would be like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; oldInputNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;oldInputNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; pNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'p'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
pNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'I was just added here!'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; newInputNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'input'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;newInputNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is not great because &lt;em&gt;conceptually&lt;/em&gt; the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;input&amp;gt;&lt;/code&gt; hasn’t been &lt;em&gt;replaced&lt;/em&gt; with &lt;code class=&quot;language-text&quot;&gt;&amp;lt;p&amp;gt;&lt;/code&gt; — it just moved. We don’t want to lose its selection, focus state, and content due to re-creating the DOM.&lt;/p&gt;
&lt;p&gt;While this problem has an easy fix (which we’ll get to in a minute), it doesn’t occur often in the React applications. It’s interesting to see why.&lt;/p&gt;
&lt;p&gt;In practice, you would rarely call &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render&lt;/code&gt; directly. Instead, React apps tend to be broken down into functions like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; showMessage &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;showMessage&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;I was just added here!&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This example doesn’t suffer from the problem we just described. It might be easier to see why if we use object notation instead of JSX. Look at the &lt;code class=&quot;language-text&quot;&gt;dialog&lt;/code&gt; child element tree:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;13&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; showMessage &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;showMessage&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'p'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'I was just added here!'&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'dialog'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'input'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Regardless of whether &lt;code class=&quot;language-text&quot;&gt;showMessage&lt;/code&gt; is &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;, the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;input&amp;gt;&lt;/code&gt; is the second child and doesn’t change its tree position between renders.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If &lt;code class=&quot;language-text&quot;&gt;showMessage&lt;/code&gt; changes from &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;, React would walk the element tree, comparing it with the previous version:&lt;/p&gt;
&lt;p&gt;And the code executed by React would be similar to this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; inputNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; pNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'p'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
pNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'I was just added here!'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
dialogNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;insertBefore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pNode&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; inputNode&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No input state is lost now.&lt;/p&gt;
&lt;h2 id=&quot;lists&quot;&gt;Lists&lt;/h2&gt;
&lt;p&gt;Comparing the element type at the same position in the tree is usually enough to decide whether reuse or re-create the corresponding host instance.&lt;/p&gt;
&lt;p&gt;But this only works well if children positions are static and don’t re-order. In our example above, even though &lt;code class=&quot;language-text&quot;&gt;message&lt;/code&gt; could be a “hole”, we still knew that there the input goes after the message, and there are no other children.&lt;/p&gt;
&lt;p&gt;With dynamic lists, we can’t be sure the order is ever the same:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ShoppingList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; list &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;list&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
          You bought &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;br&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
          Enter how many do you want: &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the &lt;code class=&quot;language-text&quot;&gt;list&lt;/code&gt; of our shopping items is ever re-ordered, React will see that all &lt;code class=&quot;language-text&quot;&gt;p&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt; elements inside have the same type, and won’t know to move them. (From React’s point of view, the &lt;em&gt;items themselves&lt;/em&gt; changed, not their order.)&lt;/p&gt;
&lt;p&gt;The code executed by React to re-order 10 items would be something like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; pNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; formNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;childNodes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; textNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstChild&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  textNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;textContent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'You bought '&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So instead of &lt;em&gt;re-ordering&lt;/em&gt; them, React would effectively &lt;em&gt;update&lt;/em&gt; each of them. This can create performance issues and possible bugs. For example, the content of the first input would stay reflected in first input &lt;em&gt;after&lt;/em&gt; the sort — even though conceptually they might refer to different products in your shopping list!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This is why React nags you to specify a special property called &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt; every time you include an array of elements in your output:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ShoppingList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; list &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;list&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;productId&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;          You bought &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;          &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;br&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;          Enter how many do you want: &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt; tells React that it should consider an item to be &lt;em&gt;conceptually&lt;/em&gt; the same even if it has different &lt;em&gt;positions&lt;/em&gt; inside its parent element between renders.&lt;/p&gt;
&lt;p&gt;When React sees &lt;code class=&quot;language-text&quot;&gt;&amp;lt;p key=&quot;42&quot;&amp;gt;&lt;/code&gt; inside a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;form&amp;gt;&lt;/code&gt;, it will check if the previous render also contained &lt;code class=&quot;language-text&quot;&gt;&amp;lt;p key=&quot;42&quot;&amp;gt;&lt;/code&gt; inside the same &lt;code class=&quot;language-text&quot;&gt;&amp;lt;form&amp;gt;&lt;/code&gt;. This works even if &lt;code class=&quot;language-text&quot;&gt;&amp;lt;form&amp;gt;&lt;/code&gt; children changed their order. React will reuse the previous host instance with the same key if it exists, and re-order the siblings accordingly.&lt;/p&gt;
&lt;p&gt;Note that the &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt; is only relevant within a particular parent React element, such as a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;form&amp;gt;&lt;/code&gt;. React won’t try to “match up” elements with the same keys between different parents. (React doesn’t have idiomatic support for moving a host instance between different parents without re-creating it.)&lt;/p&gt;
&lt;p&gt;What’s a good value for a &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt;? An easy way to answer this is to ask: &lt;strong&gt;when would &lt;em&gt;you&lt;/em&gt; say an item is the “same” even if the order changed?&lt;/strong&gt; For example, in our shopping list, the product ID uniquely identifies it between siblings.&lt;/p&gt;
&lt;h2 id=&quot;components&quot;&gt;Components&lt;/h2&gt;
&lt;p&gt;We’ve already seen functions that return React elements:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; showMessage &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;showMessage&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;I was just added here!&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;input&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;dialog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;They are called &lt;em&gt;components&lt;/em&gt;. They let us create our own “toolbox” of buttons, avatars, comments, and so on. Components are the bread and butter of React.&lt;/p&gt;
&lt;p&gt;Components take one argument — an object hash. It contains “props” (short for “properties”). Here, &lt;code class=&quot;language-text&quot;&gt;showMessage&lt;/code&gt; is a prop. They’re like named arguments.&lt;/p&gt;
&lt;h2 id=&quot;purity&quot;&gt;Purity&lt;/h2&gt;
&lt;p&gt;React components are assumed to be pure with respect to their props.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  props&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isActive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In general, mutation is not idiomatic in React. (We’ll talk more about the idiomatic way to update the UI in response to events later.)&lt;/p&gt;
&lt;p&gt;However, &lt;em&gt;local mutation&lt;/em&gt; is absolutely fine:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;FriendList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; friends &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; items &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; friends&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; friend &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; friends&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;/span&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Friend&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;friend&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;friend&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;friend&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We created &lt;code class=&quot;language-text&quot;&gt;items&lt;/code&gt; &lt;em&gt;while rendering&lt;/em&gt; and no other component “saw” it so we can mutate it as much as we like before handing it off as part of the render result. There is no need to contort your code to avoid local mutation.&lt;/p&gt;
&lt;p&gt;Similarly, lazy initialization is fine despite not being fully “pure”:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ExpenseForm&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  SuperCalculator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;initializeIfNotReady&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As long as calling a component multiple times is safe and doesn’t affect rendering of other components, React doesn’t care if it’s 100% pure in the strict FP sense of the word. &lt;a href=&quot;https://stackoverflow.com/questions/1077412/what-is-an-idempotent-operation&quot;&gt;Idempotence&lt;/a&gt; is more important to React than purity.&lt;/p&gt;
&lt;p&gt;That said, side effects that are directly visible to the user are not allowed in React components. In other words, merely &lt;em&gt;calling&lt;/em&gt; a component function shouldn’t by itself produce a change on the screen.&lt;/p&gt;
&lt;h2 id=&quot;recursion&quot;&gt;Recursion&lt;/h2&gt;
&lt;p&gt;How do we &lt;em&gt;use&lt;/em&gt; components from other components? Components are functions so we &lt;em&gt;could&lt;/em&gt; call them:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; reactElement &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; showMessage&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reactElement&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; domContainer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, this is &lt;em&gt;not&lt;/em&gt; the idiomatic way to use components in the React runtime.&lt;/p&gt;
&lt;p&gt;Instead, the idiomatic way to use a component is with the same mechanism we’ve already seen before — React elements. &lt;strong&gt;This means that you don’t directly call the component function, but instead let React later do it for you&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; reactElement &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Form&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;showMessage&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reactElement&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; domContainer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And somewhere inside React, your component will be called:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; type &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; reactElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; props &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; reactElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Component function names are by convention capitalized. When the JSX transform sees &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Form&amp;gt;&lt;/code&gt; rather than &lt;code class=&quot;language-text&quot;&gt;&amp;lt;form&amp;gt;&lt;/code&gt;, it makes the object &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; itself an identifier rather than a string:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;form&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Form&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There is no global registration mechanism — we literally refer to &lt;code class=&quot;language-text&quot;&gt;Form&lt;/code&gt; by name when typing &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Form /&amp;gt;&lt;/code&gt;. If &lt;code class=&quot;language-text&quot;&gt;Form&lt;/code&gt; doesn’t exist in local scope, you’ll see a JavaScript error just like you normally would with a bad variable name.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Okay, so what does React do when an element type is a function? It calls your component, and asks what element &lt;em&gt;that&lt;/em&gt; component wants to render.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;This process continues recursively, and is described in more detail &lt;a href=&quot;https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html&quot;&gt;here&lt;/a&gt;. In short, it looks like this:&lt;/p&gt;
&lt;ul readability=&quot;3&quot;&gt;&lt;li&gt;&lt;strong&gt;You:&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render(&amp;lt;App /&amp;gt;, domContainer)&lt;/code&gt;&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;&lt;strong&gt;React:&lt;/strong&gt; Hey &lt;code class=&quot;language-text&quot;&gt;App&lt;/code&gt;, what do you render to?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;App&lt;/code&gt;: I render &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Layout&amp;gt;&lt;/code&gt; with &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Content&amp;gt;&lt;/code&gt; inside.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;&lt;strong&gt;React:&lt;/strong&gt; Hey &lt;code class=&quot;language-text&quot;&gt;Layout&lt;/code&gt;, what do you render to?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Layout&lt;/code&gt;: I render my children in a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;div&amp;gt;&lt;/code&gt;. My child was &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Content&amp;gt;&lt;/code&gt; so I guess that goes into the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;div&amp;gt;&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;&lt;strong&gt;React:&lt;/strong&gt; Hey &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Content&amp;gt;&lt;/code&gt;, what do you render to?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Content&lt;/code&gt;: I render an &lt;code class=&quot;language-text&quot;&gt;&amp;lt;article&amp;gt;&lt;/code&gt; with some text and a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Footer&amp;gt;&lt;/code&gt; inside.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;&lt;strong&gt;React:&lt;/strong&gt; Hey &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Footer&amp;gt;&lt;/code&gt;, what do you render to?&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Footer&lt;/code&gt;: I render a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;footer&amp;gt;&lt;/code&gt; with some more text.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;React:&lt;/strong&gt; Okay, here you go:&lt;/li&gt;
&lt;/ul&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;article&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    Some text
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;footer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;some more text&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;footer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;article&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is why we say reconciliation is recursive. When React walks the element tree, it might meet an element whose &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; is a component. It will call it and keep descending down the tree of returned React elements. Eventually we’ll run out of components, and React will know what to change in the host tree.&lt;/p&gt;
&lt;p&gt;The same reconciliation rules we already discussed apply here too. If the &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; at the same position (as determined by index and optional &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt;) changes, React will throw away the host instances inside, and re-create them.&lt;/p&gt;
&lt;h2 id=&quot;inversion-of-control&quot;&gt;Inversion of Control&lt;/h2&gt;
&lt;p&gt;You might be wondering: why don’t we just call components directly? Why write &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Form /&amp;gt;&lt;/code&gt; rather than &lt;code class=&quot;language-text&quot;&gt;Form()&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;React can do its job better if it “knows” about your components rather than if it only sees the React element tree after recursively calling them.&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;

ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; children&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Article&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  domContainer
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;



ReactDOM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Article&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  domContainer
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is a classic example of &lt;a href=&quot;https://en.wikipedia.org/wiki/Inversion_of_control&quot;&gt;inversion of control&lt;/a&gt;. There’s a few interesting properties we get by letting React take control of calling our components:&lt;/p&gt;
&lt;ul readability=&quot;9.6759847522236&quot;&gt;&lt;li readability=&quot;4&quot;&gt;
&lt;p&gt;&lt;strong&gt;Components become more than functions.&lt;/strong&gt; React can augment component functions with features like &lt;em&gt;local state&lt;/em&gt; that are tied to the component identity in the tree. A good runtime provides fundamental abstractions that match the problem at hand. As we already mentioned, React is oriented specifically at programs that render UI trees and respond to interactions. If you called components directly, you’d have to build these features yourself.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;strong&gt;Component types participate in the reconciliation.&lt;/strong&gt; By letting React call your components, you also tell it more about the conceptual structure of your tree. For example, when you move from rendering &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Feed&amp;gt;&lt;/code&gt; to the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Profile&amp;gt;&lt;/code&gt; page, React won’t attempt to re-use host instances inside them — just like when you replace &lt;code class=&quot;language-text&quot;&gt;&amp;lt;button&amp;gt;&lt;/code&gt; with a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;p&amp;gt;&lt;/code&gt;. All state will be gone — which is usually good when you render a conceptually different view. You wouldn’t want to preserve input state between &lt;code class=&quot;language-text&quot;&gt;&amp;lt;PasswordForm&amp;gt;&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;&amp;lt;MessengerChat&amp;gt;&lt;/code&gt; even if the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;input&amp;gt;&lt;/code&gt; position in the tree accidentally “lines up” between them.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;3.6584022038567&quot;&gt;
&lt;p&gt;&lt;strong&gt;React can delay the reconciliation.&lt;/strong&gt; If React takes control over calling our components, it can do many interesting things. For example, it can let the browser do some work between the component calls so that re-rendering a large component tree &lt;a href=&quot;https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html&quot;&gt;doesn’t block the main thread&lt;/a&gt;. Orchestrating this manually without reimplementing a large part of React is difficult.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;0.87654320987654&quot;&gt;
&lt;p&gt;&lt;strong&gt;A better debugging story.&lt;/strong&gt; If components are first-class citizens that the library is aware of, we can build &lt;a href=&quot;https://github.com/facebook/react-devtools&quot;&gt;rich developer tools&lt;/a&gt; for introspection in development.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;The last benefit to React calling your component functions is &lt;em&gt;lazy evaluation&lt;/em&gt;. Let’s see what this means.&lt;/p&gt;
&lt;h2 id=&quot;lazy-evaluation&quot;&gt;Lazy Evaluation&lt;/h2&gt;
&lt;p&gt;When we call functions in JavaScript, arguments are evaluated before the call:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token function&quot;&gt;eat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  
  &lt;span class=&quot;token function&quot;&gt;prepareMeal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is usually what JavaScript developers expect because JavaScript functions can have implicit side effects. It would be surprising if we called a function, but it wouldn’t execute until its result gets somehow “used” in JavaScript.&lt;/p&gt;
&lt;p&gt;However, React components are &lt;a href=&quot;https://overreacted.io/react-as-a-ui-runtime/#purity&quot;&gt;relatively&lt;/a&gt; pure. There is absolutely no need to execute it if we know its result won’t get rendered on the screen.&lt;/p&gt;
&lt;p&gt;Consider this component putting &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Comments&amp;gt;&lt;/code&gt; inside a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Page&amp;gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Story&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; currentUser &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  
  
  
  
  
  
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Page&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;currentUser&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Comments&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt; component can render the children given to it inside some &lt;code class=&quot;language-text&quot;&gt;Layout&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; currentUser&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; children &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;(&lt;code class=&quot;language-text&quot;&gt;&amp;lt;A&amp;gt;&amp;lt;B /&amp;gt;&amp;lt;/A&amp;gt;&lt;/code&gt; in JSX is the same as &lt;code class=&quot;language-text&quot;&gt;&amp;lt;A children={&amp;lt;B /&amp;gt;} /&amp;gt;&lt;/code&gt;.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;But what if it has an early exit condition?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; currentUser&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; children &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;currentUser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isLoggedIn&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;h1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Please login&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;h1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Layout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we called &lt;code class=&quot;language-text&quot;&gt;Comments()&lt;/code&gt; as a function, it would execute immediately regardless of whether &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt; wants to render them or not:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;


&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;

&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Comments&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But if we pass a React element, we don’t execute &lt;code class=&quot;language-text&quot;&gt;Comments&lt;/code&gt; ourselves at all:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;


&lt;span class=&quot;gatsby-highlight-code-line&quot;/&gt;

&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Comments&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This lets React decide when and &lt;em&gt;whether&lt;/em&gt; to call it. If our &lt;code class=&quot;language-text&quot;&gt;Page&lt;/code&gt; component ignores its &lt;code class=&quot;language-text&quot;&gt;children&lt;/code&gt; prop and renders &lt;code class=&quot;language-text&quot;&gt;&amp;lt;h1&amp;gt;Please login&amp;lt;/h1&amp;gt;&lt;/code&gt; instead, React won’t even attempt to call the &lt;code class=&quot;language-text&quot;&gt;Comments&lt;/code&gt; function. What’s the point?&lt;/p&gt;
&lt;p&gt;This is good because it both lets us avoid unnecessary rendering work that would be thrown away, and makes the code less fragile. (We don’t care if &lt;code class=&quot;language-text&quot;&gt;Comments&lt;/code&gt; throws or not when the user is logged out — it won’t be called.)&lt;/p&gt;
&lt;h2 id=&quot;state&quot;&gt;State&lt;/h2&gt;
&lt;p&gt;We’ve talked &lt;a href=&quot;https://overreacted.io/react-as-a-ui-runtime/#reconciliation&quot;&gt;earlier&lt;/a&gt; about identity and how element’s conceptual “position” in the tree tells React whether to re-use a host instance or create a new one. Host instances can have all kinds of local state: focus, selection, input, etc. We want to preserve this state between updates that conceptually render the same UI. We also want to predictably destroy it when we render something conceptually different (such as moving from &lt;code class=&quot;language-text&quot;&gt;&amp;lt;SignupForm&amp;gt;&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;&amp;lt;MessengerChat&amp;gt;&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Local state is so useful that React lets &lt;em&gt;your own&lt;/em&gt; components have it too.&lt;/strong&gt; Components are still functions but React augments them with features that are useful for UIs. Local state tied to the position in the tree is one of these features.&lt;/p&gt;
&lt;p&gt;We call these features &lt;em&gt;Hooks&lt;/em&gt;. For example, &lt;code class=&quot;language-text&quot;&gt;useState&lt;/code&gt; is a Hook.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;You clicked &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; times&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;        Click me&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It returns a pair of values: the current state and a function that updates it.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring&quot;&gt;array destructuring&lt;/a&gt; syntax lets us give arbitrary names to our state variables. For example, I called this pair &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;setCount&lt;/code&gt;, but it could’ve been a &lt;code class=&quot;language-text&quot;&gt;banana&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;setBanana&lt;/code&gt;. In the text below, I will use &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; to refer to the second value regardless of its actual name in the specific examples.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(You can learn more about &lt;code class=&quot;language-text&quot;&gt;useState&lt;/code&gt; and other Hooks provided by React &lt;a href=&quot;https://reactjs.org/docs/hooks-intro.html&quot;&gt;here&lt;/a&gt;.)&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;consistency&quot;&gt;Consistency&lt;/h2&gt;
&lt;p&gt;Even if we want to split the reconciliation process itself into &lt;a href=&quot;https://www.youtube.com/watch?v=mDdgfyRB5kg&quot;&gt;non-blocking&lt;/a&gt; chunks of work, we should still perform the actual host tree operations in a single synchronous swoop. This way we can ensure that the user doesn’t see a half-updated UI, and that the browser doesn’t perform unnecesssary layout and style recalculation for intermediate states that the user shouldn’t see.&lt;/p&gt;
&lt;p&gt;This is why React splits all work into the “render phase” and the “commit phase”. &lt;em&gt;Render phase&lt;/em&gt; is when React calls your components and performs reconciliation. It is safe to interrupt and &lt;a href=&quot;https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html&quot;&gt;in the future&lt;/a&gt; will be asynchronous. &lt;em&gt;Commit phase&lt;/em&gt; is when React touches the host tree. It is always synchronous.&lt;/p&gt;
&lt;h2 id=&quot;memoization&quot;&gt;Memoization&lt;/h2&gt;
&lt;p&gt;When a parent schedules an update by calling &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;, by default React reconciles its whole child subtree. This is because React can’t know whether an update in the parent would affect the child or not, and by default React opts to be consistent. This may sound very expensive but in practice it’s not a problem for small and medium-sized subtrees.&lt;/p&gt;
&lt;p&gt;When trees get too deep or wide, you can tell React to &lt;a href=&quot;https://en.wikipedia.org/wiki/Memoization&quot;&gt;memoize&lt;/a&gt; a subtree and reuse previous render result during shallowly equal prop changes:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Row&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; item &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;memo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Row&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; in a parent &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Table&amp;gt;&lt;/code&gt; component would skip over reconciling &lt;code class=&quot;language-text&quot;&gt;Row&lt;/code&gt;s whose &lt;code class=&quot;language-text&quot;&gt;item&lt;/code&gt; is referentially equal to the &lt;code class=&quot;language-text&quot;&gt;item&lt;/code&gt; rendered last time.&lt;/p&gt;
&lt;p&gt;You can get fine-grained memoization at the level of individual expressions with the &lt;a href=&quot;https://reactjs.org/docs/hooks-reference.html#usememo&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;useMemo()&lt;/code&gt; Hook&lt;/a&gt;. The cache is local to component tree position and will be destroyed together with its local state. It only holds one last item.&lt;/p&gt;
&lt;p&gt;React intentionally doesn’t memoize components by default. Many components always receive different props so memoizing them would be a net loss.&lt;/p&gt;
&lt;h2 id=&quot;raw-models&quot;&gt;Raw Models&lt;/h2&gt;
&lt;p&gt;Ironically, React doesn’t use a “reactivity” system for fine-grained updates. In other words, any update at the top triggers reconciliation instead of updating just the components affected by changes.&lt;/p&gt;
&lt;p&gt;This is an intenional design decision. &lt;a href=&quot;https://calibreapp.com/blog/time-to-interactive/&quot;&gt;Time to interactive&lt;/a&gt; is a crucial metric in consumer web applications, and traversing models to set up fine-grained listeners spends that precious time. Additionally, in many apps interactions tend to result either in small (button hover) or large (page transition) updates, in which case fine-grained subscriptions are a waste of memory resources.&lt;/p&gt;
&lt;p&gt;One of the core design principles of React is that it works with raw data. If you have a bunch of JavaScript objects received from the network, you can pump them directly into your components with no preprocessing. There are no gotchas about which properties you can access, or unexpected performance cliffs when a structure slightly changes. React rendering is O(&lt;em&gt;view size&lt;/em&gt;) rather than O(&lt;em&gt;model size&lt;/em&gt;), and you can significantly cut the &lt;em&gt;view size&lt;/em&gt; with &lt;a href=&quot;https://react-window.now.sh/#/examples/list/fixed-size&quot;&gt;windowing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are some kinds of applications where fine-grained subscriptions are beneficial — such as stock tickers. This is a rare example of “everything constantly updating at the same time”. While imperative escape hatches can help optimize such code, React might not be the best fit for this use case. Still, you can implement your own fine-grained subscription system on top of React.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note that there are common performance issues that even fine-grained subscriptions and “reactivity” systems can’t solve.&lt;/strong&gt; For example, rendering a &lt;em&gt;new&lt;/em&gt; deep tree (which happens on every page transition) without blocking the browser. Change tracking doesn’t make it faster — it makes it slower because we have to do more work to set up subscriptions. Another problem is that we have to wait for data before we can start rendering the view. In React, we aim to solve both of these problems with &lt;a href=&quot;https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html&quot;&gt;Concurrent Rendering&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;batching&quot;&gt;Batching&lt;/h2&gt;
&lt;p&gt;Several components may want to update state in response to the same event. This example is convoluted but it illustrates a common pattern:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;12&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Parent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;      Parent clicked &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; times&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Child&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Child&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;      Child clicked &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; times&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When an event is dispatched, the child’s &lt;code class=&quot;language-text&quot;&gt;onClick&lt;/code&gt; fires first (triggering its &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;). Then the parent calls &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; in its own &lt;code class=&quot;language-text&quot;&gt;onClick&lt;/code&gt; handler.&lt;/p&gt;
&lt;p&gt;If React immediately re-rendered components in response to &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; calls, we’d end up rendering the child twice:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Entering React's browser click event handler &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Child&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;onClick&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; setState
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; re&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;render Child &lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Parent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;onClick&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; setState
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; re&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;render Parent
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; re&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;render Child&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Exiting React's browser click event handler &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first &lt;code class=&quot;language-text&quot;&gt;Child&lt;/code&gt; render would be wasted. And we couldn’t make React skip rendering &lt;code class=&quot;language-text&quot;&gt;Child&lt;/code&gt; for the second time because the &lt;code class=&quot;language-text&quot;&gt;Parent&lt;/code&gt; might pass some different data to it based on its updated state.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This is why React batches updates inside event handlers:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Entering React's browser click event handler &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Child&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;onClick&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; setState
&lt;span class=&quot;token function&quot;&gt;Parent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;onClick&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; setState
&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Processing state updates                     &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; re&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;render Parent
  &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; re&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;render Child
&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Exiting React's browser click event handler  &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; calls in components wouldn’t immediately cause a re-render. Instead, React would execute all event handlers first, and then trigger a single re-render batching all of those updates together.&lt;/p&gt;
&lt;p&gt;Batching is good for performance but can be surprising if you write code like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCounter&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;setCounter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleClick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we start with &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; set to &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;, these would just be three &lt;code class=&quot;language-text&quot;&gt;setCount(1)&lt;/code&gt; calls. To fix this, &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; provides an overload that accepts an “updater” function:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCounter&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;setCounter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; c &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleClick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;increment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;React would put the updater functions in a queue, and later run them in sequence, resulting in a re-render with &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; set to &lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When state logic gets more complex than a few &lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt; calls, I recommend to express it as a local state reducer with the &lt;a href=&quot;https://reactjs.org/docs/hooks-reference.html#usereducer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;useReducer&lt;/code&gt; Hook&lt;/a&gt;. It’s like an evolution of this “updater” pattern where each update is given a name:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;12&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;counter&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dispatch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useReducer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; action&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;action &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;'increment'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; state &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleClick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;dispatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'increment'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;dispatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'increment'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;dispatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'increment'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;action&lt;/code&gt; argument can be anything, although an object is a common choice.&lt;/p&gt;
&lt;h2 id=&quot;call-tree&quot;&gt;Call Tree&lt;/h2&gt;
&lt;p&gt;A programming language runtime usually has a &lt;a href=&quot;https://medium.freecodecamp.org/understanding-the-javascript-call-stack-861e41ae61d4&quot;&gt;call stack&lt;/a&gt;. When a function &lt;code class=&quot;language-text&quot;&gt;a()&lt;/code&gt; calls &lt;code class=&quot;language-text&quot;&gt;b()&lt;/code&gt; which itself calls &lt;code class=&quot;language-text&quot;&gt;c()&lt;/code&gt;, somewhere in the JavaScript engine there’s a data structure like &lt;code class=&quot;language-text&quot;&gt;[a, b, c]&lt;/code&gt; that “keeps track” of where you are and what code to execute next. Once you exit out of &lt;code class=&quot;language-text&quot;&gt;c&lt;/code&gt;, its call stack frame is gone — poof! It’s not needed anymore. We jump back into &lt;code class=&quot;language-text&quot;&gt;b&lt;/code&gt;. By the time we exit &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt;, the call stack is empty.&lt;/p&gt;
&lt;p&gt;Of course, React itself runs in JavaScript and obeys JavaScript rules. But we can imagine that internally React has some kind of its own call stack to remember which component we are currently rendering, e.g. &lt;code class=&quot;language-text&quot;&gt;[App, Page, Layout, Article /* we're here */]&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;React is different from a general purpose language runtime because it’s aimed at rendering UI trees. These trees need to “stay alive” for us to interact with them. The DOM doesn’t disappear after our first &lt;code class=&quot;language-text&quot;&gt;ReactDOM.render()&lt;/code&gt; call.&lt;/p&gt;
&lt;p&gt;This may be stretching the metaphor but I like to think of React components as being in a “call tree” rather than just a “call stack”. When we go “out” of the &lt;code class=&quot;language-text&quot;&gt;Article&lt;/code&gt; component, its React “call tree” frame doesn’t get destroyed. We need to keep the local state and references to the host instances &lt;a href=&quot;https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7&quot;&gt;somewhere&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;These “call tree” frames &lt;em&gt;are&lt;/em&gt; destroyed along with their local state and host instances, but only when the &lt;a href=&quot;https://overreacted.io/react-as-a-ui-runtime/#reconciliation&quot;&gt;reconciliation&lt;/a&gt; rules say it’s necessary. If you ever read React source, you might have seen these frames being referred to as &lt;a href=&quot;https://en.wikipedia.org/wiki/Fiber_(computer_science)&quot;&gt;Fibers&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Fibers are where the local state actually lives. When state is updated, React marks the Fibers below as needing reconciliation, and calls those components.&lt;/p&gt;
&lt;h2 id=&quot;context&quot;&gt;Context&lt;/h2&gt;
&lt;p&gt;In React, we pass things down to other components as props. Sometimes, the majority of component need the same thing — for example, the currently chosen visual theme. It gets cumbersome to pass it down through every level.&lt;/p&gt;
&lt;p&gt;In React, this is solved by &lt;a href=&quot;https://reactjs.org/docs/context.html&quot;&gt;Context&lt;/a&gt;. It is essentially like &lt;a href=&quot;http://wiki.c2.com/?DynamicScoping&quot;&gt;dynamic scoping&lt;/a&gt; for components. It’s like a wormhole that lets you put something on the top, and have every child at the bottom be able to read it and re-render when it changes.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; ThemeContext &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;'light'&lt;/span&gt; 
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;DarkApp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;ThemeContext.Provider&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;dark&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;MyComponents&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;ThemeContext.Provider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;SomeDeeplyNestedChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; theme &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ThemeContext&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When &lt;code class=&quot;language-text&quot;&gt;SomeDeeplyNestedChild&lt;/code&gt; renders, &lt;code class=&quot;language-text&quot;&gt;useContext(ThemeContext)&lt;/code&gt; will look for the closest &lt;code class=&quot;language-text&quot;&gt;&amp;lt;ThemeContext.Provider&amp;gt;&lt;/code&gt; above it in the tree, and use its &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;(In practice, React maintains a context stack while it renders.)&lt;/p&gt;
&lt;p&gt;If there’s no &lt;code class=&quot;language-text&quot;&gt;ThemeContext.Provider&lt;/code&gt; above, the result of &lt;code class=&quot;language-text&quot;&gt;useContext(ThemeContext)&lt;/code&gt; call will be the default value specified in the &lt;code class=&quot;language-text&quot;&gt;createContext()&lt;/code&gt; call. In our example, it is &lt;code class=&quot;language-text&quot;&gt;'light'&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;effects&quot;&gt;Effects&lt;/h2&gt;
&lt;p&gt;We mentioned earlier that React components shouldn’t have observable side effects during rendering. But side effects are sometimes necessary. We may want to manage focus, draw on a canvas, subscribe to a data source, and so on.&lt;/p&gt;
&lt;p&gt;In React, this is done by declaring an effect:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`You clicked &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;count&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; times`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;You clicked &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; times&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;        Click me&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When possible, React defers executing effects until after the browser re-paints the screen. This is good because code like data source subscriptions shouldn’t hurt &lt;a href=&quot;https://calibreapp.com/blog/time-to-interactive/&quot;&gt;time to interactive&lt;/a&gt; and &lt;a href=&quot;https://developers.google.com/web/tools/lighthouse/audits/first-meaningful-paint&quot;&gt;time to first paint&lt;/a&gt;. (There’s a &lt;a href=&quot;https://reactjs.org/docs/hooks-reference.html#uselayouteffect&quot;&gt;rarely used&lt;/a&gt; Hook that lets you opt out of that behavior and do things synchronously. Avoid it.)&lt;/p&gt;
&lt;p&gt;Effects don’t just run once. They run both after component is shown to the user for the first time, and after it updates. Effects can close over current props and state, such as with &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; in the above example.&lt;/p&gt;
&lt;p&gt;Effects may require cleanup, such as in case of subscriptions. To clean up after itself, an effect can return a function:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;React will execute the returned function before applying this effect the next time, and also before the component is destroyed.&lt;/p&gt;
&lt;p&gt;Sometimes, re-running the effect on every render can be undesirable. You can tell React to &lt;a href=&quot;https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects&quot;&gt;skip&lt;/a&gt; applying an effect if certain variables didn’t change:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;`You clicked &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;count&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; times`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, it is often a premature optimization and can lead to problems if you’re not familiar with how JavaScript closures work.&lt;/p&gt;
&lt;p&gt;For example, this code is buggy:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It is buggy because &lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt; says “don’t ever re-execute this effect”. But the effect closes over &lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt; which is defined outside of it. And &lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt; might reference any props or state:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;7&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleChange&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we never let the effect re-run, &lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt; will keep pointing at the version from the first render, and &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; will always be &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt; inside of it.&lt;/p&gt;
&lt;p&gt;To solve this, make sure that if you specify the dependency array, it includes &lt;strong&gt;all&lt;/strong&gt; things that can change, including the functions:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; DataSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeSubscription&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Depending on your code, you might still see unnecessary resubscriptions because &lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt; itself is different on every render. The &lt;a href=&quot;https://reactjs.org/docs/hooks-reference.html#usecallback&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;useCallback&lt;/code&gt;&lt;/a&gt; Hook can help you with that. Alternatively, you can just let it re-subscribe. For example, browser’s &lt;code class=&quot;language-text&quot;&gt;addEventListener&lt;/code&gt; API is extremely fast, and jumping through hoops to avoid calling it might cause more problems than it’s worth.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(You can learn more about &lt;code class=&quot;language-text&quot;&gt;useEffect&lt;/code&gt; and other Hooks provided by React &lt;a href=&quot;https://reactjs.org/docs/hooks-effect.html&quot;&gt;here&lt;/a&gt;.)&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;custom-hooks&quot;&gt;Custom Hooks&lt;/h2&gt;
&lt;p&gt;Since Hooks like &lt;code class=&quot;language-text&quot;&gt;useState&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;useEffect&lt;/code&gt; are function calls, we can compose them into our own Hooks:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;13&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;MyResponsiveComponent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; width &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useWindowWidth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Window width is &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useWindowWidth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setWidth&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerWidth&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;useEffect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleResize&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setWidth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerWidth&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'resize'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handleResize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;'resize'&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handleResize&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Custom Hooks let different components share reusable stateful logic. Note that the &lt;em&gt;state itself&lt;/em&gt; is not shared. Each call to a Hook declares its own isolated state.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(You can learn more about writing your own Hooks &lt;a href=&quot;https://reactjs.org/docs/hooks-custom.html&quot;&gt;here&lt;/a&gt;.)&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;static-use-order&quot;&gt;Static Use Order&lt;/h2&gt;
&lt;p&gt;You can think of &lt;code class=&quot;language-text&quot;&gt;useState&lt;/code&gt; as a syntax for defining a “React state variable”. It’s not &lt;em&gt;really&lt;/em&gt; a syntax, of course. We’re still writing JavaScript. But we are looking at React as a runtime environment, and because React tailors JavaScript to describing UI trees, its features sometimes live closer to the language space.&lt;/p&gt;
&lt;p&gt;If &lt;code class=&quot;language-text&quot;&gt;use&lt;/code&gt; &lt;em&gt;was&lt;/em&gt; a syntax, it would make sense for it to be be at the top level:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
component &lt;span class=&quot;token function&quot;&gt;Example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;You clicked &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt; times&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;        Click me&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token plain-text&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What would putting it into a condition or a callback or outside a component even mean?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;11&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;


&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

component &lt;span class=&quot;token function&quot;&gt;Example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;condition&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleClick&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
    
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;React state is local to the &lt;em&gt;component&lt;/em&gt; and its identity in the tree. If &lt;code class=&quot;language-text&quot;&gt;use&lt;/code&gt; was a real syntax it would make sense to scope it to the top-level of a component too:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;10&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
component &lt;span class=&quot;token function&quot;&gt;Example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;condition&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; setCount&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; use &lt;span class=&quot;token function&quot;&gt;State&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is similar to how &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; only works at the top level of a module.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Of course, &lt;code class=&quot;language-text&quot;&gt;use&lt;/code&gt; is not actually a syntax.&lt;/strong&gt; (It wouldn’t bring much benefit and would create a lot of friction.)&lt;/p&gt;
&lt;p&gt;However, React &lt;em&gt;does&lt;/em&gt; expect that all calls to Hooks happen only at the top level of a component and unconditionally. These &lt;a href=&quot;https://reactjs.org/docs/hooks-rules.html&quot;&gt;Rules of Hooks&lt;/a&gt; can be enforced with &lt;a href=&quot;https://www.npmjs.com/package/eslint-plugin-react-hooks&quot;&gt;a linter plugin&lt;/a&gt;. There have been heated arguments about this design choice but in practice I haven’t seen it confusing people. I also wrote about why commonly proposed alternative &lt;a href=&quot;https://overreacted.io/why-do-hooks-rely-on-call-order/&quot;&gt;don’t work&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Internally, Hooks are implemented as &lt;a href=&quot;https://dev.to/aspittel/thank-u-next-an-introduction-to-linked-lists-4pph&quot;&gt;linked lists&lt;/a&gt;. When you call &lt;code class=&quot;language-text&quot;&gt;useState&lt;/code&gt;, we move the pointer to the next item. When we exit the component’s &lt;a href=&quot;https://overreacted.io/react-as-a-ui-runtime/#call-tree&quot;&gt;“call tree” frame&lt;/a&gt;, we save the resulting list there until the next render.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e&quot;&gt;This article&lt;/a&gt; provides a simplified explanation for how Hooks work internally. Arrays might be an easier mental model than linked lists:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot; readability=&quot;9&quot;&gt;
&lt;pre class=&quot;language-jsx&quot;&gt;
&lt;code class=&quot;language-jsx&quot;&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; hooks&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;useState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hooks&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; hooks&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  
  hooks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
hooks &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fiber&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hooks &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;YourComponent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

fiber&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hooks &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; hooks&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;(If you’re curious, the real code is &lt;a href=&quot;https://github.com/facebook/react/blob/master/packages/react-reconciler/src/ReactFiberHooks.js&quot;&gt;here&lt;/a&gt;.)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This is roughly how each &lt;code class=&quot;language-text&quot;&gt;useState()&lt;/code&gt; call gets the right state. As we’ve learned &lt;a href=&quot;https://overreacted.io/react-as-a-ui-runtime/#reconciliation&quot;&gt;earlier&lt;/a&gt;, “matching things up” isn’t new to React — reconciliation relies on the elements matching up between renders in a similar way.&lt;/p&gt;
&lt;h2 id=&quot;whats-left-out&quot;&gt;What’s Left Out&lt;/h2&gt;
&lt;p&gt;We’ve touched on pretty much all important aspects of the React runtime environment. If you finished this page, you probably know React in more detail than 90% of its users. And there’s nothing wrong with that!&lt;/p&gt;
&lt;p&gt;There are some parts I left out — mostly because they’re unclear even to us. React doesn’t currently have a good story for multipass rendering, i.e. when the parent render needs information about the children. Also, the &lt;a href=&quot;https://reactjs.org/docs/error-boundaries.html&quot;&gt;error handling API&lt;/a&gt; doesn’t yet have a Hooks version. It’s possible that these two problems can be solved together. Concurrent Mode is not stable yet, and there are interesting questions about how Suspense fits into this picture. Maybe I’ll do a follow-up when they’re fleshed out and Suspense is ready for more than &lt;a href=&quot;https://reactjs.org/blog/2018/10/23/react-v-16-6.html#reactlazy-code-splitting-with-suspense&quot;&gt;lazy loading&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I think it speaks to the success of React’s API that you can get very far without ever thinking about most of these topics.&lt;/strong&gt; Good defaults like the reconciliation heuristics do the right thing in most cases. Warnings like the &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt; warning nudge you when you risk shooting yourself in the foot.&lt;/p&gt;
&lt;p&gt;If you’re a UI library nerd, I hope this post was somewhat entertaining and clarified how React works in more depth. Or maybe you decided React is too complicated and you’ll never look it again. In either case, I’d love to hear from you on Twitter! Thank you for reading.&lt;/p&gt;
</description>
<pubDate>Sun, 03 Feb 2019 02:01:07 +0000</pubDate>
<dc:creator>danabramov</dc:creator>
<og:url>https://overreacted.io/react-as-a-ui-runtime/</og:url>
<og:title>React as a UI Runtime</og:title>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://overreacted.io/react-as-a-ui-runtime/</dc:identifier>
</item>
<item>
<title>Blackmailers use false copyright claims to shut down victims&amp;#039; YouTube accounts</title>
<link>https://boingboing.net/2019/01/30/moderation-at-scale.html</link>
<guid isPermaLink="true" >https://boingboing.net/2019/01/30/moderation-at-scale.html</guid>
<description>&lt;div id=&quot;story&quot; readability=&quot;89.257662560871&quot;&gt;&lt;span id=&quot;metadata&quot;/&gt;
&lt;div class=&quot;featuredimage&quot;&gt;&lt;span id=&quot;metadata&quot;&gt;&lt;img width=&quot;881&quot; height=&quot;616&quot; src=&quot;https://media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg&quot; class=&quot;attachment-post-thumbnail size-post-thumbnail wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg?w=881&amp;amp;ssl=1 881w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg?resize=300%2C210&amp;amp;ssl=1 300w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg?resize=600%2C420&amp;amp;ssl=1 600w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg?resize=768%2C537&amp;amp;ssl=1 768w&quot; sizes=&quot;(max-width: 881px) 100vw, 881px&quot;/&gt;&lt;/span&gt;&lt;/div&gt;
&lt;span id=&quot;metadata&quot;/&gt;
&lt;p&gt;&lt;span id=&quot;metadata&quot;&gt;Youtube's ContentID system allows rightsholders to upload video and audio and block videos that contain their works (or put ads on those videos and take the revenue they generate), and to have the accounts of repeat copyright offenders permanently deleted, along with all their videos.&lt;/span&gt;&lt;/p&gt;
&lt;span id=&quot;metadata&quot;/&gt;

&lt;span id=&quot;metadata&quot;&gt;&lt;span id=&quot;more-698035&quot;/&gt;&lt;/span&gt;
&lt;p&gt;ContentID is badly flawed. On the one hand, it routinely catches things that aren't copyright infringements (like &lt;a href=&quot;https://boingboing.net/2012/02/27/rumblefish-claims-to-own-copyr.html&quot;&gt;birdsong&lt;/a&gt;, &lt;a href=&quot;https://boingboing.net/2018/01/08/a-youtube-video-of-white-noise.html&quot;&gt;white noise&lt;/a&gt;, or &lt;a href=&quot;https://boingboing.net/2018/09/05/mozart-bach-sorta-mach.html&quot;&gt;home-recorded&lt;/a&gt; performances of &lt;a href=&quot;https://boingboing.net/2018/12/18/roll-over-beethoven.html&quot;&gt;classical music&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;On the other hand, the system has few checks and balances. While Youtube requires that people who want to make ContentID claims go through a vetting process, the process is very lightweight and allows all kinds of bad actors in, who can then &lt;a href=&quot;https://boingboing.net/2018/12/26/youtube-let-a-contentid-scamme.html&quot;&gt;steal creators' revenues&lt;/a&gt; by falsely claiming copyright over their videos.&lt;/p&gt;
&lt;p&gt;No one expects Youtube to be perfect, but it also fails with a remarkable lack of grace. The small number of humans available to review contested claims means that people who fall afoul of machine error, sloppiness and criminal mischief are often unable to get a fair hearing or justice. This phenomenon is familiar to anyone who's had a complaint against one of the big platforms: unless your story makes the news, you're likely to get stuck in an email loop where your complaint keeps getting sent back with irrelevant, semi-automated responses that make it seem like no one has even paid enough attention to understand what's going on.&lt;/p&gt;
&lt;p&gt;That lack of human oversight creates the perfect conditions for all kinds of fraud and malice, and criminals have noticed.&lt;/p&gt;
&lt;p&gt;A Youtuber called ObbyRaidz, who makes videos about Minecraft, has found himself having received two copyright &quot;strikes&quot; on Youtube from a blackmailer calling themselves VengefulFlame, who has demanded &quot;$150 PayPal or $75 btc (Bitcoin)&quot; or equivalent &quot;goods/services&quot; to have the strikes removed. If ObbyRaidz doesn't comply, VengefulFlame could send one more complaint to Youtube and have ObbyRaidz's account -- and all the videos he's created -- permanently deleted.&lt;/p&gt;
&lt;p&gt;ObbyRaidz says he's been unable to get any help from Youtube, despite repeated complaints and entreaties.&lt;/p&gt;
&lt;p&gt;The extortion attempt is a timely reminder of what's at stake in the fight over the EU's &lt;a href=&quot;https://boingboing.net/tag/article-13&quot;&gt;Copyright Directive&lt;/a&gt;, which mandates a much broader version of ContentID, but for every service and every type of copyrighted work, from tweets to Minecraft skins. Under the proposal, anyone could add anything to the databases of blocked content, and get anyone else's work censored; while this could be used simply to suppress information that a fraudster doesn't like (say, reports of political corruption or complaints about a scammy business), they could also be used as fuel for extortion.&lt;/p&gt;
&lt;blockquote readability=&quot;14&quot;&gt;
&lt;p&gt;Like many YouTubers, ObbyRaidz says he’s worked “really hard” on his channel but with no help from YouTube, he’s scared he’s going to lose his entire channel due to these bogus complaints.&lt;/p&gt;
&lt;p&gt;“It’s not fun and i’m gonna be really sad to see if my channel gets terminated. Then I have to go through the process of getting in contact with YouTube and stuff. YouTube is very broken and I want to see if they can fix their system so this doesn’t happen to other content creators,” he says.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a href=&quot;https://torrentfreak.com/youtube-strikes-now-being-used-as-scammers-extortion-tool/?utm_source=feedburner&amp;amp;utm_medium=feed&amp;amp;utm_campaign=Feed%3A+Torrentfreak+%28Torrentfreak%29&quot;&gt;YouTube Strikes Now Being Used as Scammers’ Extortion Tool&lt;/a&gt; [Andy/Torrentfreak]
&lt;p&gt;(&lt;em&gt;Image: &lt;a href=&quot;https://www.flickr.com/photos/jeanette4/8461872536&quot;&gt;Valerie Lawson&lt;/a&gt;, CC-BY-SA&lt;/em&gt;)&lt;/p&gt;



&lt;/div&gt;&lt;div id=&quot;next-post-thumbnails&quot; readability=&quot;39.78021978022&quot;&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;28.166666666667&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/31/save-eu-fix-copyright.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;600&quot; height=&quot;300&quot; src=&quot;https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?fit=600%2C300&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?w=1200&amp;amp;ssl=1 1200w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?resize=300%2C150&amp;amp;ssl=1 300w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?resize=600%2C300&amp;amp;ssl=1 600w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?resize=768%2C384&amp;amp;ssl=1 768w, https://i2.wp.com/media.boingboing.net/wp-content/uploads/2019/01/article-13-germany-2.png?resize=930%2C465&amp;amp;ssl=1 930w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;The EU's plan to censor the internet with algorithms that block anything that might be a copyright infringement has only days to go before it will be too late for a vote before the upcoming elections, and so far, progress has been stalled thanks to France's unwillingness to accept tiny, meaningless concessions that Germany feels […]&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/31/save-eu-fix-copyright.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;26.331914893617&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/29/all-textile-armored-transport.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;600&quot; height=&quot;435&quot; src=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?fit=600%2C435&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?w=1500&amp;amp;ssl=1 1500w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?resize=300%2C218&amp;amp;ssl=1 300w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?resize=600%2C435&amp;amp;ssl=1 600w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?resize=768%2C557&amp;amp;ssl=1 768w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/il_fullxfull.1038183068_j663.jpg?resize=930%2C675&amp;amp;ssl=1 930w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;You can make your own perfectly adorable chibi crocheted AT-AT Walker with this $5.90 pattern from Polish textile artist Kamila Krawczyk, AKA Krawka. (via The Stars My Destination)&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/29/all-textile-armored-transport.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;22.979310344828&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/29/fundamentally-wrong-premises.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;600&quot; height=&quot;600&quot; src=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?fit=600%2C600&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?w=1080&amp;amp;ssl=1 1080w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?resize=300%2C300&amp;amp;ssl=1 300w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?resize=600%2C600&amp;amp;ssl=1 600w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?resize=768%2C768&amp;amp;ssl=1 768w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/eu-compliant-meme.png?resize=930%2C930&amp;amp;ssl=1 930w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;After the last-minute collapse of negotiations over the new EU Copyright Directive, things have only gone from bad to worse for the beleaguered (but deadly and far-reaching) internet regulation.&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/29/fundamentally-wrong-premises.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;32.054421768707&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/27/grow-boatloads-of-instagram-fo.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;600&quot; height=&quot;400&quot; src=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/instagramphone-1.jpeg?fit=600%2C400&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/instagramphone-1.jpeg?w=800&amp;amp;ssl=1 800w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/instagramphone-1.jpeg?resize=300%2C200&amp;amp;ssl=1 300w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/instagramphone-1.jpeg?resize=600%2C400&amp;amp;ssl=1 600w, https://i0.wp.com/media.boingboing.net/wp-content/uploads/2019/01/instagramphone-1.jpeg?resize=768%2C512&amp;amp;ssl=1 768w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;Everybody’s on Instagram to be seen, but what separates the average selfies-and-food account from the true influencers? Chances are, it’s not random chance. Check out our favorite online tools geared to get you the kind of visibility advertisers dream of, from educational courses to optimizing apps. PostFly Instagram Automation If you’re looking to get the […]&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/27/grow-boatloads-of-instagram-fo.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;32.304449648712&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/26/these-are-the-last-workout-ear.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;596&quot; height=&quot;447&quot; src=&quot;https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/cresuerearbuds.jpg?fit=596%2C447&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/cresuerearbuds.jpg?w=596&amp;amp;ssl=1 596w, https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/cresuerearbuds.jpg?resize=300%2C225&amp;amp;ssl=1 300w&quot; sizes=&quot;(max-width: 596px) 100vw, 596px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;The wheel. The light bulb. Throughout history, the best technology has always been simple and elegant. That’s especially true for a good pair of earbuds, which should sound like they’re packing an orchestra and feel like they’re not even there. Hitting that sweet spot especially hard are the Cresuer Touchwave True Wireless Bluetooth Earbuds, which […]&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/26/these-are-the-last-workout-ear.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;div class=&quot;nextstory&quot; readability=&quot;31.952494061758&quot;&gt;

&lt;a href=&quot;https://boingboing.net/2019/01/25/learn-piano-the-fun-way-with-t.html?utm_source=moreatbb&amp;amp;utm_medium=nextpost&amp;amp;utm_campaign=nextpostthumbnails&quot; onclick=&quot;clickTrack(this.href, 'Next Post Button', 'Next Post Thumbnails');&quot;&gt;&lt;img width=&quot;600&quot; height=&quot;450&quot; src=&quot;https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/sale_16493_primary_image.jpg?fit=600%2C450&amp;amp;ssl=1&quot; class=&quot;attachment-medium size-medium wp-post-image&quot; alt=&quot;&quot; srcset=&quot;https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/sale_16493_primary_image.jpg?w=630&amp;amp;ssl=1 630w, https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/sale_16493_primary_image.jpg?resize=300%2C225&amp;amp;ssl=1 300w, https://i1.wp.com/media.boingboing.net/wp-content/uploads/2019/01/sale_16493_primary_image.jpg?resize=600%2C450&amp;amp;ssl=1 600w&quot; sizes=&quot;(max-width: 600px) 100vw, 600px&quot;/&gt;&lt;/a&gt;
&lt;p&gt;The keyboard is one of the most universally loved instruments, and it’s relatively easy to learn. So why do so many kids hate their piano lessons? It’s likely they weren’t being taught Pianoforall, an innovative yet simple method that lets students discover what’s great about music right away. Taught by pianist and therapist Robin Hall, […]&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;https://boingboing.net/2019/01/25/learn-piano-the-fun-way-with-t.html&quot;&gt;READ THE REST&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;

&lt;/div&gt;</description>
<pubDate>Sat, 02 Feb 2019 21:31:53 +0000</pubDate>
<dc:creator>Keverw</dc:creator>
<og:type>article</og:type>
<og:title>Blackmailers use false copyright claims to shut down victims' Youtube accounts, offer to lift them in exchange for Bitcoin</og:title>
<og:description>Blackmailers use false copyright claims to shut down victims' Youtube accounts, offer to lift them in exchange for Bitcoin</og:description>
<og:url>https://boingboing.net/2019/01/30/moderation-at-scale.html</og:url>
<og:image>https://media.boingboing.net/wp-content/uploads/2019/01/8461872536_1e790c9e0c_o.jpg</og:image>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://boingboing.net/2019/01/30/moderation-at-scale.html</dc:identifier>
</item>
<item>
<title>I have chosen the wrong flight dates because your date picker is broken</title>
<link>https://twitter.com/pugson/status/1091699189166174208</link>
<guid isPermaLink="true" >https://twitter.com/pugson/status/1091699189166174208</guid>
<description>[unable to retrieve full-text content]
&lt;p&gt;Article URL: &lt;a href=&quot;https://twitter.com/pugson/status/1091699189166174208&quot;&gt;https://twitter.com/pugson/status/1091699189166174208&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=19065635&quot;&gt;https://news.ycombinator.com/item?id=19065635&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Points: 232&lt;/p&gt;
&lt;p&gt;# Comments: 187&lt;/p&gt;
</description>
<pubDate>Sat, 02 Feb 2019 20:51:42 +0000</pubDate>
<dc:creator>bfoks</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://mobile.twitter.com/pugson/status/1091699189166174208</dc:identifier>
</item>
<item>
<title>A Python Interpreter Written in Rust</title>
<link>https://github.com/RustPython/RustPython</link>
<guid isPermaLink="true" >https://github.com/RustPython/RustPython</guid>
<description>&lt;div class=&quot;Box-body p-6&quot;&gt;
&lt;article class=&quot;markdown-body entry-content&quot; itemprop=&quot;text&quot;&gt;
&lt;p&gt;A Python-3 (CPython &amp;gt;= 3.5.0) Interpreter written in Rust 🐍 😱 🤘.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/RustPython/RustPython&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;https://camo.githubusercontent.com/fb7cccfd031d15215ec7bb2b9e31569c557a5a4e/68747470733a2f2f7472617669732d63692e6f72672f52757374507974686f6e2f52757374507974686f6e2e7376673f6272616e63683d6d6173746572&quot; alt=&quot;Build Status&quot; data-canonical-src=&quot;https://travis-ci.org/RustPython/RustPython.svg?branch=master&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://opensource.org/licenses/MIT&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;https://camo.githubusercontent.com/76f0e887c183ccc31c1cb63c33d2dbf48cb2df51/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d677265656e2e737667&quot; alt=&quot;License: MIT&quot; data-canonical-src=&quot;https://img.shields.io/badge/License-MIT-green.svg&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://github.com/RustPython/RustPython/graphs/contributors&quot;&gt;&lt;img src=&quot;https://camo.githubusercontent.com/926ca81f11ceabcbac75cc7ff44d16f14f9b4cca/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f52757374507974686f6e2f52757374507974686f6e2e737667&quot; alt=&quot;Contributors&quot; data-canonical-src=&quot;https://img.shields.io/github/contributors/RustPython/RustPython.svg&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://gitter.im/rustpython/Lobby&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;https://camo.githubusercontent.com/1361bb3b490b72eab5bafeeab1cc871312133c60/68747470733a2f2f6261646765732e6769747465722e696d2f52757374507974686f6e2f4c6f6262792e737667&quot; alt=&quot;Gitter&quot; data-canonical-src=&quot;https://badges.gitter.im/RustPython/Lobby.svg&quot;/&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Check out our &lt;a href=&quot;https://rustpython.github.io/demo/&quot; rel=&quot;nofollow&quot;&gt;online demo&lt;/a&gt; running on WebAssembly.&lt;/h3&gt;
&lt;p&gt;To test RustPython, do the following:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ git clone https://github.com/RustPython/RustPython
$ cd RustPython
$ cargo run demo.py
Hello, RustPython!
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Or use the interactive shell:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;$ cargo run
Welcome to rustpython
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; 2+2
4
&lt;/code&gt;
&lt;/pre&gt;

&lt;ul&gt;&lt;li&gt;Full Python-3 environment entirely in Rust (not CPython bindings)&lt;/li&gt;
&lt;li&gt;A clean implementation without compatibility hacks&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Currently the project is in an early phase, and so is the documentation.&lt;/p&gt;
&lt;p&gt;You can read the &lt;a href=&quot;https://rustpython.github.io/website/rustpython/index.html&quot; rel=&quot;nofollow&quot;&gt;online documentation&lt;/a&gt; for the latest code on master.&lt;/p&gt;
&lt;p&gt;You can also generate documentation locally by running:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell&quot;&gt;
&lt;pre&gt;
$ cargo doc &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;#&lt;/span&gt; Including documentation for all dependencies&lt;/span&gt;
$ cargo doc --no-deps --all &lt;span class=&quot;pl-c&quot;&gt;&lt;span class=&quot;pl-c&quot;&gt;#&lt;/span&gt; Excluding all dependencies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Documentation HTML files can then be found in the &lt;code&gt;target/doc&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;If you wish to update the online documentation. Push directly to the &lt;code&gt;release&lt;/code&gt; branch (or ask a maintainer to do so), this will trigger a Travis build that updates the documentation and WebAssembly demo page.&lt;/p&gt;

&lt;ul&gt;&lt;li&gt;&lt;code&gt;parser/src&lt;/code&gt;: python lexing, parsing and ast&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm/src&lt;/code&gt;: python virtual machine
&lt;ul&gt;&lt;li&gt;&lt;code&gt;builtins.rs&lt;/code&gt;: Builtin functions&lt;/li&gt;
&lt;li&gt;&lt;code&gt;compile.rs&lt;/code&gt;: the python compiler from ast to bytecode&lt;/li&gt;
&lt;li&gt;&lt;code&gt;obj&lt;/code&gt;: python builtin types&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;src&lt;/code&gt;: using the other subcrates to bring rustpython to life.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docs&lt;/code&gt;: documentation (work in progress)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;py_code_object&lt;/code&gt;: CPython bytecode to rustpython bytecode converter (work in progress)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wasm&lt;/code&gt;: Binary crate and resources for WebAssembly build&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tests&lt;/code&gt;: integration test snippets&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To start contributing, there are a lot of things that need to be done.&lt;/p&gt;
&lt;p&gt;Most tasks are listed in the &lt;a href=&quot;https://github.com/RustPython/RustPython/issues&quot;&gt;issue tracker&lt;/a&gt;. Check issues labeled with &lt;code&gt;good first issue&lt;/code&gt; if you wish to start coding.&lt;/p&gt;
&lt;p&gt;Another approach is to checkout the sourcecode: builtin functions and object methods are often the simplest and easiest way to contribute.&lt;/p&gt;
&lt;p&gt;You can also simply run &lt;code&gt;cargo run tests/snippets/whats_left_to_implement.py&lt;/code&gt; to assist in finding any unimplemented method.&lt;/p&gt;

&lt;p&gt;To test rustpython, there is a collection of python snippets located in the &lt;code&gt;tests/snippets&lt;/code&gt; directory. To run those tests do the following:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell&quot;&gt;
&lt;pre&gt;
$ &lt;span class=&quot;pl-c1&quot;&gt;cd&lt;/span&gt; tests
$ pipenv install
$ pipenv run pytest -v
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There also are some unittests, you can run those will cargo:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell&quot;&gt;
&lt;pre&gt;
$ cargo &lt;span class=&quot;pl-c1&quot;&gt;test&lt;/span&gt; --all
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As of now the standard library is under construction.&lt;/p&gt;
&lt;p&gt;You can play around with other standard libraries for python. For example, the &lt;a href=&quot;https://github.com/pybee/ouroboros&quot;&gt;ouroboros library&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To do this, follow this method:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell&quot;&gt;
&lt;pre&gt;
$ &lt;span class=&quot;pl-c1&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;pl-k&quot;&gt;~&lt;/span&gt;/GIT
$ git clone git@github.com:pybee/ouroboros.git
$ &lt;span class=&quot;pl-k&quot;&gt;export&lt;/span&gt; PYTHONPATH=&lt;span class=&quot;pl-k&quot;&gt;~&lt;/span&gt;/GIT/ouroboros/ouroboros
$ &lt;span class=&quot;pl-c1&quot;&gt;cd&lt;/span&gt; RustPython
$ cargo run -- -c &lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;import statistics&lt;span class=&quot;pl-pds&quot;&gt;'&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;At this stage RustPython only has preliminary support for web assembly. The instructions here are intended for developers or those wishing to run a toy example.&lt;/p&gt;
&lt;h2&gt;Setup&lt;/h2&gt;
&lt;p&gt;To get started, install &lt;a href=&quot;https://rustwasm.github.io/wasm-pack/installer/&quot; rel=&quot;nofollow&quot;&gt;wasm-pack&lt;/a&gt; and &lt;code&gt;npm&lt;/code&gt;. (&lt;a href=&quot;https://rustwasm.github.io/wasm-bindgen/whirlwind-tour/basic-usage.html&quot; rel=&quot;nofollow&quot;&gt;wasm-bindgen&lt;/a&gt; should be installed by &lt;code&gt;wasm-pack&lt;/code&gt;. if not, install it yourself)&lt;/p&gt;
&lt;h2&gt;Build&lt;/h2&gt;
&lt;p&gt;Move into the &lt;code&gt;wasm&lt;/code&gt; directory. This directory contains a library crate for interop with python to rust to js and back in &lt;code&gt;wasm/lib&lt;/code&gt;, the demo website found at &lt;a href=&quot;https://rustpython.github.io/demo&quot; rel=&quot;nofollow&quot;&gt;https://rustpython.github.io/demo&lt;/a&gt; in &lt;code&gt;wasm/demo&lt;/code&gt;, and an example of how to use the crate as a library in one's own JS app in &lt;code&gt;wasm/example&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Go to the demo directory. This is the best way of seeing the changes made to either the library or the JS demo, as the &lt;code&gt;rustpython_wasm&lt;/code&gt; module is set to the global JS variable &lt;code&gt;rp&lt;/code&gt; on the website.&lt;/p&gt;

&lt;p&gt;Now, start the webpack development server. It'll compile the crate and then the demo app. This will likely take a long time, both the wasm-pack portion and the webpack portion (from after it says &quot;Your crate has been correctly compiled&quot;), so be patient.&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-shell&quot;&gt;
&lt;pre&gt;
npm run dev
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can now open the webpage on &lt;a href=&quot;https://localhost:8080&quot; rel=&quot;nofollow&quot;&gt;https://localhost:8080&lt;/a&gt; and Python code in either the text box or browser devtools with:&lt;/p&gt;
&lt;div class=&quot;highlight highlight-source-js&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;pl-smi&quot;&gt;rp&lt;/span&gt;.&lt;span class=&quot;pl-en&quot;&gt;pyEval&lt;/span&gt;(
  &lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;`&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;pl-s&quot;&gt;print(js_vars['a'] * 9)&lt;/span&gt;
&lt;span class=&quot;pl-s&quot;&gt;&lt;span class=&quot;pl-pds&quot;&gt;`&lt;/span&gt;&lt;/span&gt;,
  {
    vars&lt;span class=&quot;pl-k&quot;&gt;:&lt;/span&gt; {
      a&lt;span class=&quot;pl-k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pl-c1&quot;&gt;9&lt;/span&gt;
    }
  }
);
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Alternatively, you can run &lt;code&gt;npm run build&lt;/code&gt; to build the app once, without watching for changes, or &lt;code&gt;npm run dist&lt;/code&gt; to build the app in release mode, both for the crate and webpack.&lt;/p&gt;

&lt;p&gt;The code style used is the default rustfmt codestyle. Please format your code accordingly.&lt;/p&gt;

&lt;p&gt;Chat with us on &lt;a href=&quot;https://gitter.im/rustpython/Lobby&quot; rel=&quot;nofollow&quot;&gt;gitter&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The initial work was based on &lt;a href=&quot;https://github.com/windelbouwman/rspython&quot;&gt;windelbouwman/rspython&lt;/a&gt; and &lt;a href=&quot;https://github.com/shinglyu/RustPython&quot;&gt;shinglyu/RustPython&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;These are some useful links to related projects:&lt;/p&gt;
&lt;/article&gt;&lt;/div&gt;
</description>
<pubDate>Sat, 02 Feb 2019 17:01:20 +0000</pubDate>
<dc:creator>rch</dc:creator>
<og:image>https://avatars0.githubusercontent.com/u/39710557?s=400&amp;v=4</og:image>
<og:type>object</og:type>
<og:title>RustPython/RustPython</og:title>
<og:url>https://github.com/RustPython/RustPython</og:url>
<og:description>A Python Interpreter written in Rust. Contribute to RustPython/RustPython development by creating an account on GitHub.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://github.com/RustPython/RustPython</dc:identifier>
</item>
<item>
<title>McKinsey Advised Purdue Pharma How to ‘Turbocharge’ Opioid Sales, Lawsuit Says</title>
<link>https://www.nytimes.com/2019/02/01/business/purdue-pharma-mckinsey-oxycontin-opiods.html</link>
<guid isPermaLink="true" >https://www.nytimes.com/2019/02/01/business/purdue-pharma-mckinsey-oxycontin-opiods.html</guid>
<description>&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;The world’s most prestigious management-consulting firm, McKinsey &amp;amp; Company, has been drawn into a national reckoning over who bears responsibility for the opioid crisis that has devastated families and communities across America.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;In &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.documentcloud.org/documents/5715954-Massachusetts-AGO-Amended-Complaint-2019-01-31.html&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;legal papers&lt;/a&gt; released in unredacted form on Thursday, the Massachusetts attorney general said McKinsey had helped the maker of OxyContin fan the flames of the opioid epidemic. McKinsey’s consultants, the attorney general revealed, had instructed the drug company, Purdue Pharma, on how to “turbocharge” sales of OxyContin, how to counter efforts by drug enforcement agents to reduce opioid use, and were part of a team that looked at how “to counter the emotional messages from mothers with teenagers that overdosed” on the drug.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;The McKinsey disclosures are part of a &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.nytimes.com/2019/01/31/health/opioids-purdue-pharma-sackler.html?module=inline&quot; title=&quot;&quot;&gt;lawsuit&lt;/a&gt; Massachusetts filed against Purdue Pharma, accusing the company of misleading doctors and patients about the safety of opioid use. Even when the company knew patients were addicted and dying, it still tried to boost sales of opioids, the lawsuit alleges, adding, “All the while, Purdue peddled falsehoods to keep patients away from safer alternatives.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Purdue Pharma helped plant the seeds of the opioid epidemic through its aggressive marketing of OxyContin. More than 130 people die each day in the United States — 47,000 in 2017 — after overdosing on opioids, according to the National Institute on Drug Abuse.&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;As the death toll from opioid abuse has climbed, the cast of those who are alleged to have contributed to the crisis — manufacturers, distributors, doctors, pharmacists, hospitals and regulatory agencies — has grown. McKinsey is the newest and perhaps most surprising actor in this drama.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;“From our initial review of the complaint, it appears that some of the references to McKinsey’s work lack context, including references to McKinsey that appear to be second- or third-hand,” McKinsey said in a statement, adding that it was continuing to review the document.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;The suit, filed last year, names several Purdue executives and board members as well as members of the Sackler family, which controls the privately held company. McKinsey is mentioned 71 times in the 275-page complaint. The unredacted version was first &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.propublica.org/article/oxycontin-purdue-pharma-massachusetts-lawsuit-anti-addiction-market&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;reported&lt;/a&gt; by ProPublica and the medical news website Stat.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;In 2009, McKinsey wrote a report for Purdue Pharma saying that new sales tactics would increase sales of OxyContin by $200 million to $400 million annually and “suggested sales ‘drivers’ based on the ideas that opioids reduce stress and make patients more optimistic and less isolated,” according to the lawsuit.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;It was that year that Craig Landau, then Purdue’s chief medical officer and now its chief executive, had an email exchange that included a McKinsey consultant about how to counter mothers whose teenagers had overdosed on OxyContin. The solution: bring in patients to emphasize how the drug helps to relieve pain.&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;
&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;In 2013, amid the rapidly intensifying opioid crisis, the federal Drug Enforcement Administration and the Justice Department reached a settlement with Walgreens, the second-biggest American pharmacy chain. Walgreens agreed to new procedures to crack down on illegal prescriptions. In a report to Purdue Pharma, McKinsey said that “deep examination of Purdue’s available pharmacy purchasing data shows that Walgreens has reduced its units by 18%.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;According to the lawsuit, McKinsey recommended that Purdue “lobby Walgreens’ leaders to loosen up.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;McKinsey also recommended that Purdue redirect its sales force to focus on doctors who were especially prolific prescribers of OxyContin, according to the suit. One slide made public by the attorney general’s office, attributed to McKinsey, focused on one doctor in the town of Wareham, Mass., who almost doubled his annual output of OxyContin prescriptions after a big increase in visits from Purdue sales representatives.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;If doctors resisted, McKinsey recommended that Purdue employ “patient pushback,” getting patients to lobby for OxyContin, according to the suit.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;In a statement, Purdue said that the Massachusetts attorney general’s office “offers little evidence to support its sweeping legal claims.” The company also said that the lawsuit mischaracterized McKinsey’s work with Purdue.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;On a chat site where participants must have a McKinsey email address to register for the company’s discussion room, several expletive-laced expressions of outrage over the revelations of McKinsey’s work with Purdue were mixed with comments about the responsibility to serve the client’s bottom line within moral and ethical boundaries.&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;“Then, of course it’s ok to maximize shareholder value, seek profits!,” one person wrote. “But not at all costs, not at the cost of our moral values and our society’s well being.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;Another person’s post — like all 42 entries about Purdue and McKinsey posted by midday Friday, it was anonymous — reproduced a bullet point from McKinsey’s values statement stating that the company will “observe high ethical standards.”&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;
&lt;div class=&quot;css-1fanzo5 StoryBodyCompanionColumn&quot;&gt;
&lt;div class=&quot;css-4w7y5l&quot;&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;That is the second bullet point printed on the framed poster listing McKinsey’s mission and values that graces the 21st-floor lobby of McKinsey’s home office in Midtown Manhattan. The first reads: “put client interests ahead of the Firm’s.”&lt;/p&gt;
&lt;p class=&quot;css-1ygdjhk evys1bk0&quot;&gt;In 2018, after it spent years advising Purdue Pharma on how to increase sales of OxyContin, McKinsey published &lt;a class=&quot;css-1g7m0tk&quot; href=&quot;https://www.mckinsey.com/industries/healthcare-systems-and-services/our-insights/why-we-need-bolder-action-to-combat-the-opioid-epidemic&quot; title=&quot;&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;a report titled&lt;/a&gt;: “Why we need bolder action to combat the opioid epidemic.”&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;css-o6xoe7&quot;/&gt;&lt;/div&gt;
</description>
<pubDate>Sat, 02 Feb 2019 16:31:07 +0000</pubDate>
<dc:creator>seapunk</dc:creator>
<og:url>https://www.nytimes.com/2019/02/01/business/purdue-pharma-mckinsey-oxycontin-opiods.html</og:url>
<og:type>article</og:type>
<og:title>McKinsey Advised Purdue Pharma How to ‘Turbocharge’ Opioid Sales, Lawsuit Says</og:title>
<og:image>https://static01.nyt.com/images/2019/01/31/business/00purduemckinsey1/merlin_149883558_57e930ff-6348-42d3-a87a-beaa979c7843-facebookJumbo.jpg</og:image>
<og:description>The disclosures about the consulting firm are part of the Massachusetts attorney general’s suit against the pharmaceutical giant, which is accused of misleading doctors and patients about the safety of the medication.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.nytimes.com/2019/02/01/business/purdue-pharma-mckinsey-oxycontin-opiods.html</dc:identifier>
</item>
<item>
<title>Dotfile madness</title>
<link>https://0x46.net/thoughts/2019/02/01/dotfile-madness/</link>
<guid isPermaLink="true" >https://0x46.net/thoughts/2019/02/01/dotfile-madness/</guid>
<description>&lt;p&gt;We are no longer in control of our home directories.&lt;/p&gt;
&lt;p&gt;My own home directory contains 25 ordinary files and 144 hidden files. The dotfiles contain data that doesn't belong to me: it belongs to the programmers whose programs decided to hijack the primary location designed as a storage for my personal files. I can't place those dotfiles anywhere else and they will appear again if I try to delete them. All I can do is sit here knowing that in the darkness, behind the scenes, they are there. Waiting in silence. Some of those programmers decided to additionally place some normal files and directories in the same place. Those are clearly visible every time I execute &lt;code&gt;ls&lt;/code&gt; in my home directory. It is beyond me why my home directory ended up up containing a &lt;code&gt;node_modules&lt;/code&gt; directory, &lt;code&gt;package-lock.json&lt;/code&gt;, a &lt;code&gt;yarn.lock&lt;/code&gt; file (I have never even consciously used yarn!), some 2 strange log files origination from some Java software clearly using an H2 database, and a &lt;code&gt;Desktop&lt;/code&gt; directory. That last one has been created by Steam, which is quite unfortunate as I simply do not have a desktop or a desktop environment on my machine. I dread the day in which I will hear a loud knock on my door and one of those programmers will barge in informing me that he is going to store a piece of his furniture in the middle of my living room, If I don't mind.&lt;/p&gt;
&lt;p&gt;To those of you reading this: I beg you. Avoid creating files or directories of any kind in your user's &lt;code&gt;$HOME&lt;/code&gt; directory in order to store your configuration or data. This practice is bizarre at best and it is time to end it. I am sorry to say that many (if not most) programs are guilty of doing this while there are significantly better places that can be used for storing per-user program data.&lt;/p&gt;
&lt;p&gt;Even if we will never be able to solve this problem - due to the historical baggage, backward compatibility, software no longer receiving updates or programming villains storing the files wherever they want just to see the world burn - we can at least try to follow some sane practices. While the &lt;a href=&quot;https://plus.google.com/+RobPikeTheHuman/posts/R58WgWwN9jp&quot;&gt;mistake of introducing the mere concept of a &quot;hidden&quot; file&lt;/a&gt; can't be undone anymore, we can at least try to mitigate its results.&lt;/p&gt;
&lt;p&gt;This particular problem has been noticed and solved a long time ago with the creation of &lt;a href=&quot;https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html&quot;&gt;XDG Base Directory Specification&lt;/a&gt;. The specification defines a set of environment variables pointing programs to a directory in which their data or configuration should be stored. It is up to the user to set those variables so if the variables are not available the programs are expected to default to a directory defined by the standard and not the user's home directory.&lt;/p&gt;
&lt;h2&gt;User-level variables&lt;/h2&gt;
&lt;h3&gt;&lt;code&gt;$XDG_DATA_HOME&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_DATA_HOME&lt;/code&gt; defines the base directory relative to which user specific data files should be stored. If &lt;code&gt;$XDG_DATA_HOME&lt;/code&gt; is either not set or empty, a default equal to &lt;code&gt;$HOME/.local/share&lt;/code&gt; should be used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Example usage: storing plugins downloaded by the user, databases created by your program, user's input history, bookmarks, emails, and so on.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;$XDG_CONFIG_HOME&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_CONFIG_HOME&lt;/code&gt; defines the base directory relative to which user specific configuration files should be stored. If &lt;code&gt;$XDG_CONFIG_HOME&lt;/code&gt; is either not set or empty, a default equal to &lt;code&gt;$HOME/.config&lt;/code&gt; should be used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You should use this directory to store user-specific configuration files for your program. You will most likely want to create a default configuration file with sane and sensible default values the first time your program is executed.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;$XDG_CACHE_HOME&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_CACHE_HOME&lt;/code&gt; defines the base directory relative to which user specific non-essential data files should be stored. If &lt;code&gt;$XDG_CACHE_HOME&lt;/code&gt; is either not set or empty, a default equal to $HOME/.cache should be used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Example: caching thumbnails generated by your file manager, songs that the user of a music straming software is often listening to, and so on. Your program should continue to function without any problems if this directory is removed by the user. Ensure that the files that are no longer needed are properly removed. Remember that exceeding the sensible amount of storage space used by your files will most likely upset the user who will quickly track down your program as a culprit.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;$XDG_RUNTIME_DIR&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_RUNTIME_DIR&lt;/code&gt; defines the base directory relative to which user-specific non-essential runtime files and other file objects (such as sockets, named pipes, ...) should be stored.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The specification lists a series of requirements that have to be fulfilled by this directory. As described by the specification you should use this directory to store sockets and similar files used for communication.&lt;/p&gt;
&lt;h2&gt;System-level variables&lt;/h2&gt;
&lt;h3&gt;&lt;code&gt;$XDG_CONFIG_DIRS&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;10&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_CONFIG_DIRS&lt;/code&gt; defines the preference-ordered set of base directories to search for configuration files in addition to the &lt;code&gt;$XDG_CONFIG_HOME&lt;/code&gt; base directory. The directories in &lt;code&gt;$XDG_CONFIG_DIRS&lt;/code&gt; should be seperated with a colon ':'.&lt;/p&gt;
&lt;p&gt;If &lt;code&gt;$XDG_CONFIG_DIRS&lt;/code&gt; is either not set or empty, a value equal to &lt;code&gt;/etc/xdg&lt;/code&gt; should be used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This directory should be used for storing system-wide configuration files that can be overwriten by user-specific configuration files. This directory would most likely be populated during the installation process.&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;$XDG_DATA_DIRS&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote readability=&quot;11&quot;&gt;
&lt;p&gt;&lt;code&gt;$XDG_DATA_DIRS&lt;/code&gt; defines the preference-ordered set of base directories to search for data files in addition to the &lt;code&gt;$XDG_DATA_HOME&lt;/code&gt; base directory. The directories in &lt;code&gt;$XDG_DATA_DIRS&lt;/code&gt; should be seperated with a colon ':'.&lt;/p&gt;
&lt;p&gt;If &lt;code&gt;$XDG_DATA_DIRS&lt;/code&gt; is either not set or empty, a value equal to &lt;code&gt;/usr/local/share/:/usr/share/&lt;/code&gt; should be used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Example: storing plugins or themes that can be used by all users of your program. This directory would most likely be populated during the installation process.&lt;/p&gt;
&lt;h2&gt;How does this work in practice?&lt;/h2&gt;
&lt;p&gt;Using the standard is very simple. Read the relevant environment variable and use the default paths defined by the standard if it is missing. You should then append a program-specific directory name to it and create the entire directory tree to store your data.&lt;/p&gt;
&lt;p&gt;As an example if you were to store configuration files you should use &lt;code&gt;$XDG_CONFIG_HOME/your-program&lt;/code&gt; as your base configuraion directory instead of just storing your files directly in &lt;code&gt;$XDG_CONFIG_HOME&lt;/code&gt;. Remember to never hardcode the directories to the default values defined by the standard. Read the environment variable first to allow the user to move those directories if needed.&lt;/p&gt;
&lt;p&gt;You can easily migrate your existing programs to use this standard. In order to do so start using the standard when creating new files but keep also checking the old location of the files when reading them. This will allow you to migrate without breaking the program for the users with the configuration or data files that were created by a previous version of your program.&lt;/p&gt;
&lt;p&gt;Read the standard to find out more and have a look at the directory hierarchy which is almost certain to be already present in your home directory. In reality a cross-platform library allowing you to get a directory for storing your data will be available for your programming language of choice. On Linux and similar systems, this library will surely use the XDG Base Directory Specification.&lt;/p&gt;
&lt;p&gt;2019-02-01&lt;/p&gt;
</description>
<pubDate>Sat, 02 Feb 2019 16:14:41 +0000</pubDate>
<dc:creator>boreq</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://0x46.net/thoughts/2019/02/01/dotfile-madness/</dc:identifier>
</item>
<item>
<title>What Impossible Meant to Feynman</title>
<link>http://nautil.us/issue/68/context/what-impossible-meant-to-feynman</link>
<guid isPermaLink="true" >http://nautil.us/issue/68/context/what-impossible-meant-to-feynman</guid>
<description>&lt;p&gt;&lt;span class=&quot;dropcap&quot;&gt;I&lt;/span&gt;&lt;em&gt;mpossible!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The word resonated throughout the large lecture hall. I had just finished describing a revolutionary concept for a new type of matter that my graduate student, Dov Levine, and I had invented.&lt;/p&gt;
&lt;p&gt;The Caltech lecture room was packed with scientists from every discipline across campus. The discussion had gone remarkably well. But just as the last of the crowd was filing out, there arose a familiar, booming voice and that word: “&lt;em&gt;Impossible!&lt;/em&gt;”&lt;/p&gt;
&lt;p&gt;I could have recognized that distinctive, gravelly voice with the unmistakable New York accent with my eyes closed. Standing before me was my scientific idol, the legendary physicist Richard Feynman, with his shock of graying, shoulder-length hair, wearing his characteristic white shirt, along with a disarming, devilish smile.&lt;/p&gt;
&lt;img src=&quot;http://static.nautil.us/15694_99407a87a33e79517280e0fdacdaa713.png&quot; width=&quot;733&quot; alt=&quot;&quot;/&gt;Richard Feynman
&lt;p&gt;Feynman had won a Nobel Prize for his groundbreaking work developing the first quantum theory of electromagnetism. Within the scientific community, he was already considered one of the greatest theoretical physicists of the 20th century. He would eventually achieve iconic status with the general public, as well, because of his pivotal role identifying the cause of the Challenger space shuttle disaster and his two bestselling books, &lt;em&gt;Surely You’re Joking, Mr. Feynman!&lt;/em&gt; and &lt;em&gt;What Do You Care What Other People Think?&lt;/em&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;He had a wonderfully playful sense of humor, and was notorious for his elaborate practical jokes. But when it came to science, Feynman was always uncompromisingly honest and brutally critical, which made him an especially terrifying presence during scientific seminars. One could anticipate that he would interrupt and publicly challenge a speaker the moment he heard something that was, in his mind, imprecise or inaccurate.&lt;/p&gt;
&lt;p&gt;So I had been keenly aware of Feynman’s presence when he entered the lecture hall just before my presentation began and took his usual seat in the front row. I kept a careful watch on him out of the corner of my eye throughout the presentation, awaiting any potential outburst. But Feynman never interrupted and never raised an objection.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;dropcap&quot;&gt;T&lt;/span&gt;he fact that Feynman came forward to confront me after the talk was something that probably would have petrified many scientists. But this was not our first encounter. I had been lucky enough to work closely with Feynman when I was an undergraduate at Caltech about a decade earlier and had nothing but admiration and affection for him. Feynman changed my life through his writings, lectures, and personal mentoring.&lt;/p&gt;
&lt;p&gt;When I first arrived on campus as a freshman in 1970, my intention was to major in biology or mathematics. I had never been particularly interested in physics in high school. But I knew that every Caltech undergraduate was required to take two years of the subject.&lt;/p&gt;
&lt;p&gt;I quickly discovered that freshman physics was wickedly hard, thanks in large part to the textbook, &lt;em&gt;The Feynman Lectures on Physics, Volume 1&lt;/em&gt;. The book was less of a traditional textbook than a collection of brilliant essays based on a famous series of freshman physics lectures that Feynman delivered in the 1960s.&lt;/p&gt;
&lt;blockquote class=&quot;pull-quote&quot;&gt;
&lt;p&gt;Feynman showed me that it is acceptable to explore a diversity of fields if that is where your curiosity leads.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Unlike any other physics textbook that I have ever encountered, &lt;em&gt;The Feynman Lectures on Physics&lt;/em&gt; never bothers to explain how to solve any problems, which made trying to complete the daunting homework assignments challenging and time-consuming. What the essays did provide, however, was something much more valuable—deep insights into Feynman’s original way of thinking about science. Generations have benefited from the &lt;em&gt;Feynman Lectures&lt;/em&gt;. For me, the experience was an absolute revelation.&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;After a few weeks, I felt like my skull had been pried open and my brain rewired. I began to think like a physicist, and loved it. Like many other scientists of my generation, I was proud to adopt Feynman as my hero. I scuttled my original academic plans about biology and mathematics and decided to pursue physics with a vengeance.&lt;/p&gt;
&lt;p&gt;I can remember a few times during my freshman year when I screwed up enough courage to say hello to Feynman before a seminar. Anything more would have been unimaginable at the time. But in my junior year, my roommate and I somehow summoned the nerve to knock on his office door to ask if he might consider teaching an unofficial course in which he would meet once a week with undergraduates like us to answer questions about anything we might ask. The whole thing would be informal, we told him. No homework, no tests, no grades, and no course credit. We knew he was an iconoclast with no patience for bureaucracy, and were hoping the lack of structure would appeal to him.&lt;/p&gt;
&lt;div class=&quot;reco&quot;&gt;
&lt;article class=&quot;issue-article&quot;&gt;&lt;div&gt;&lt;a href=&quot;http://nautil.us/issue/49/The%20Absurd/what-is-space&quot; class=&quot;obnd_lnk&quot; data-trval=&quot;what-is-space&quot; data-trlbl=&quot;foc_rec&quot; data-tract=&quot;internal_art&quot;&gt;&lt;img src=&quot;http://static.nautil.us/12609_112a8e92dcedcda4237de18e9126b2d2.png&quot; alt=&quot;Sapolsky_TH-F1&quot; width=&quot;314&quot; height=&quot;177&quot;/&gt;&lt;/a&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class=&quot;article-tag&quot;&gt;&lt;span class=&quot;article-tag&quot;&gt;&lt;span class=&quot;article-tag-focus&quot;&gt;&lt;a href=&quot;http://nautil.us/term/f/Physics&quot;&gt;Also in Physics&lt;/a&gt;&lt;/span&gt;  &lt;/span&gt;&lt;/span&gt;
&lt;h4 class=&quot;article-title&quot;&gt;&lt;a href=&quot;http://nautil.us/issue/49/The%20Absurd/what-is-space&quot; class=&quot;obnd_lnk&quot; data-trval=&quot;what-is-space&quot; data-trlbl=&quot;foc_rec&quot; data-tract=&quot;internal_art&quot;&gt;What Is Space?&lt;/a&gt;&lt;/h4&gt;
&lt;p class=&quot;article-author&quot;&gt;By Jorge Cham &amp;amp; Daniel Whiteson&lt;/p&gt;
&lt;p&gt;Ask a group of physicists and philosophers to define “space” and you will likely be stuck in a long discussion that involves deep-sounding but meaningless word combinations such as “the very fabric of space-time itself is a physical manifestation of...&lt;strong&gt;&lt;a href=&quot;http://nautil.us/issue/49/The%20Absurd/what-is-space&quot; class=&quot;obnd_lnk&quot; data-trval=&quot;what-is-space&quot; data-trlbl=&quot;foc_rec&quot; data-tract=&quot;internal_art&quot;&gt;READ MORE&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;/article&gt;&lt;/div&gt;
&lt;p&gt;A decade or so earlier, Feynman had given a similar class, but solely for freshmen and only for one quarter per year. Now we were asking him to do the same thing for a full year and to make it available for all undergraduates, especially third- and fourth-year students like ourselves who were likely to ask more advanced questions. We suggested the new course be called “Physics X,” the same as his earlier one, to make it clear to everyone that it was completely off the books.&lt;/p&gt;
&lt;p&gt;Feynman thought a moment and, much to our surprise, replied “Yes!” So every week for the next two years, my roommate and I joined dozens of other lucky students for a riveting and unforgettable afternoon with Dick Feynman.&lt;/p&gt;
&lt;p&gt;Physics X always began with him entering the lecture hall and asking if anyone had any questions. Occasionally, someone wanted to ask about a topic on which Feynman was expert. Naturally, his answers to those questions were masterful. In other cases, though, it was clear that Feynman had never thought about the question before. I always found those moments especially fascinating because I had the chance to watch how he engaged and struggled with a topic for the first time.&lt;/p&gt;
&lt;p&gt;I vividly recall asking him something I considered intriguing, even though I was afraid he might think it trivial. “What color is a shadow?” I wanted to know.&lt;/p&gt;
&lt;p&gt;After walking back and forth in front of the lecture room for a minute, Feynman grabbed on to the question with gusto. He launched into a discussion of the subtle gradations and variations in a shadow, then the nature of light, then the perception of color, then shadows on the moon, then earthshine on the moon, then the formation of the moon, and so on, and so on, and so on. I was spellbound.&lt;/p&gt;
&lt;p&gt;During my senior year, Dick agreed to be my mentor on a series of research projects. Now I was able to witness his method of attacking problems even more closely. I also experienced his sharp, critical tongue whenever his high expectations were not met. He called out my mistakes using words like “crazy,” “nuts,” “ridiculous,” and “stupid.”&lt;/p&gt;
&lt;p&gt;The harsh words stung at first, and caused me to question whether I belonged in theoretical physics. But I couldn’t help noticing that Dick did not seem to take the critical comments as seriously as I did. In the next breath, he would always be encouraging me to try a different approach and inviting me to return when I made progress.&lt;/p&gt;
&lt;p&gt;One of the most important things Feynman ever taught me was that some of the most exciting scientific surprises can be discovered in everyday phenomena. All you need do is take the time to observe things carefully and ask yourself good questions. He also influenced my belief that there is no reason to succumb to external pressures that try to force you to specialize in a single area of science, as many scientists do. Feynman showed me by example that it is acceptable to explore a diversity of fields if that is where your curiosity leads.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;dropcap&quot;&gt;O&lt;/span&gt;ne of our exchanges during my final term at Caltech was particularly memorable. I was explaining a mathematical scheme that I had developed to predict the behavior of a Super Ball, the rubbery, super-elastic ball that was especially popular at the time.&lt;/p&gt;
&lt;p&gt;It was a challenging problem because a Super Ball changes direction with every bounce. I wanted to add another layer of complexity by trying to predict how the Super Ball would bounce along a sequence of surfaces set at different angles. For example, I calculated the trajectory as it bounced from the floor to the underside of a table to a slanted plane and then off the wall. The seemingly random movements were entirely predictable, according to the laws of physics.&lt;/p&gt;
&lt;blockquote class=&quot;pull-quote&quot;&gt;
&lt;p&gt;Here I was, standing in front of Richard Feynman explaining that these long-standing rules were wrong.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I showed Feynman one of my calculations. It predicted that I could throw the Super Ball and that, after a complicated set of bounces, it would return right back to my hand. I handed him the paper and he took a glance at my equations.&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;“That’s impossible!” he said.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Impossible?&lt;/em&gt; I was taken aback by the word. It was something new from him. Not the “crazy” or “stupid” that I had come to occasionally expect.&lt;/p&gt;
&lt;p&gt;“Why do you think it’s impossible?” I asked nervously.&lt;/p&gt;
&lt;p&gt;Feynman pointed out his concern. According to my formula, if someone were to release the Super Ball from a height with a certain spin, the ball would bounce and careen off nearly sideways at a low angle to the floor.&lt;/p&gt;
&lt;p&gt;“And that’s clearly impossible, Paul,” he said.&lt;/p&gt;
&lt;p&gt;I glanced down to my equations and saw that, indeed, my prediction did imply that the ball would bounce and take off at a low angle. But I wasn’t so sure that was impossible, even if it seemed counterintuitive.&lt;/p&gt;
&lt;p&gt;I was now experienced enough to push back. “Okay, then,” I said. “I have never tried this experiment before, but let’s give it a shot right here in your office.”&lt;/p&gt;
&lt;p&gt;I pulled a Super Ball out of my pocket and Feynman watched me drop it with the prescribed spin. Sure enough, the ball took off in precisely the direction that my equations predicted, scooting sideways at a low angle off the floor, exactly the way Feynman had thought was impossible.&lt;/p&gt;
&lt;p&gt;In a flash, he deduced his mistake. He had not accounted for the extreme stickiness of the Super Ball surface, which affected how the spin influenced the ball’s trajectory.&lt;/p&gt;
&lt;p&gt;“How stupid!” Feynman said out loud, using the same exact tone of voice he sometimes used to criticize me.&lt;/p&gt;
&lt;p&gt;After two years of working together, I finally knew for sure what I had long suspected: “Stupid” was just an expression Feynman applied to everyone, including himself, as a way to focus attention on an error so it was never made again.&lt;/p&gt;
&lt;p&gt;I also learned that “impossible,” when used by Feynman, did not necessarily mean “unachievable” or “ridiculous.” Sometimes it meant, “Wow! Here is something amazing that contradicts what we would normally expect to be true. This is worth understanding!”&lt;/p&gt;
&lt;p&gt;So 11 years later, when Feynman approached me after my lecture with a playful smile and jokingly pronounced my theory “Impossible!” I was pretty sure I knew what he meant. The subject of my talk, a radically new form of matter known as “quasicrystals,” conflicted with principles he thought were true. It was therefore interesting and worth understanding.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;dropcap&quot;&gt;F&lt;/span&gt;eynman walked up to the table where I had set up an experiment to demonstrate the idea. He pointed to it and demanded, “Show me again!”&lt;/p&gt;
&lt;p&gt;I flipped the switch to start the demonstration and Feynman stood motionless. With his own eyes, he was witnessing a clear violation of one of the most well-known principles in science. It was something so basic that he had described it in the &lt;em&gt;Feynman Lectures&lt;/em&gt;. In fact, the principles had been taught to every young scientist for nearly 200 years.&lt;/p&gt;
&lt;p&gt;But now, here I was, standing in front of Richard Feynman explaining that these long-standing rules were wrong.&lt;/p&gt;
&lt;p&gt;Crystals were not the only possible forms of matter with orderly arrangements of atoms and pinpoint diffraction patterns. There was now a vast new world of possibilities with its own set of rules, which we named quasicrystals.&lt;/p&gt;
&lt;p&gt;We chose the name to make clear how the new materials differ from ordinary crystals. Both materials consist of groups of atoms that repeat throughout the entire structure.&lt;/p&gt;
&lt;p&gt;The groups of atoms in crystals repeat at regular intervals, just like the five known patterns. In quasicrystals, however, different groups repeat at distinct intervals. Our inspiration was a two-dimensional pattern known as a Penrose tiling, which is an unusual pattern that contains two different types of tiles that repeat at two incommensurate intervals. Mathematicians call such a pattern quasiperiodic. Hence, we dubbed our theoretical discovery “quasiperiodic crystals” or “quasicrystals,” for short.&lt;/p&gt;
&lt;p&gt;My little demonstration for Feynman was designed to prove my case using a laser and a slide with a photograph of a quasiperiodic pattern. I flipped on the laser, as Feynman had directed, and aimed the beam so that it passed through the slide onto the distant wall. The laser light produced the same effect as X-rays passing through the channels between atoms: It created a diffraction pattern, like the one pictured in the photo below.&lt;/p&gt;
&lt;p&gt;I turned off the overhead lights so that Feynman could get a good look at the signature snowflake pattern of pinpoints on the wall. It was unlike any other diffraction pattern that Feynman had ever seen.&lt;/p&gt;
&lt;div class=&quot;overlap-container&quot;&gt;
&lt;aside class=&quot;overlap-img&quot;&gt;&lt;img src=&quot;http://static.nautil.us/15695_767d3dd25ed652d33fa7743c0c2400fa.png&quot; alt=&quot;Steinhardt_CORNERART&quot;/&gt;&lt;/aside&gt;&lt;div class=&quot;overlap-text&quot;&gt;

&lt;p&gt;I pointed out to him, as I had done during the lecture, that the brightest spots formed rings of ten that were concentric. That was unheard of. One could also see groups of pinpoints that formed pentagons, revealing a symmetry that was thought to be absolutely forbidden in the natural world. A closer look revealed yet more spots between the pinpoints. And spots between those spots. And yet more spots still.&lt;br/&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Feynman asked to look more closely at the slide. I switched the lights back on and removed it from the holder and gave it to him. The image on the slide was so reduced that it was hard to appreciate the detail, so I also handed him an enlargement of the tiling pattern, which he put down on the table in front of the laser.&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;The next few moments passed in silence. I began to feel like a student again, waiting for Feynman to react to the latest cockamamie idea I had come up with. He stared at the enlargement on the table, reinserted the slide in the holder, and switched on the laser himself. His eyes went back and forth between the printed enlargement on the table, up to the laser pattern on the wall, then back down again to the enlargement.&lt;/p&gt;
&lt;p&gt;“Impossible!” Feynman finally said. I nodded in agreement and smiled, because I knew that to be one of his greatest compliments.&lt;/p&gt;
&lt;p&gt;He looked back up at the wall, shaking his head. “Absolutely impossible! That is one of the most amazing things I have ever seen.”&lt;/p&gt;
&lt;p&gt;And then, without saying another word, Dick Feynman looked at me with delight and gave me a huge, devilish smile.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Paul J. Steinhardt is the Albert Einstein Professor in Science at Princeton University, where he is on the faculty of both the departments of physics and astrophysical sciences. He cofounded and directs the Princeton Center for Theoretical Science. He has received the Dirac Medal and other prestigious awards for his work on the early universe and novel forms of matter.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;From &lt;/em&gt;&lt;a href=&quot;https://www.amazon.com/Second-Kind-Impossible-Extraordinary-Matter-dp-1476729921/dp/1476729921/ref=mt_hardcover?_encoding=UTF8&amp;amp;me;=&amp;amp;qid=1548882270&quot; target=&quot;_blank&quot;&gt;The Second Kind of Impossible: The Extraordinary Quest for a New Form of Matter&lt;/a&gt; &lt;em&gt;by Paul J. Steinhardt. Copyright © 2019 by Paul J. Steinhardt. Reprinted by permission of Simon &amp;amp; Schuster, Inc.&lt;/em&gt;&lt;/p&gt;
&lt;section class=&quot;leaderboard-ad-belt&quot;&gt;&lt;div class=&quot;leaderboard-ad-belt-inner adarticle&quot;&gt;&lt;div id=&quot;div-gpt-ad-1380044019755-0&quot; class=&quot;leaderboard-ad&quot;/&gt;
&lt;/div&gt;
&lt;/section&gt;</description>
<pubDate>Sat, 02 Feb 2019 12:31:30 +0000</pubDate>
<dc:creator>dnetesn</dc:creator>
<og:type>website</og:type>
<og:url>http://nautil.us/issue/68/context/what-impossible-meant-to-feynman</og:url>
<og:title>What Impossible Meant to Feynman - Issue 68: Context - Nautilus</og:title>
<og:description>Impossible! The word resonated throughout the large lecture hall. I had just finished describing a revolutionary concept for a new&amp;#8230;</og:description>
<og:image>http://static.nautil.us/15691_a18d17349a19926e1944714f747d330d.png</og:image>
<dc:format>text/html</dc:format>
<dc:identifier>http://nautil.us/issue/68/context/what-impossible-meant-to-feynman</dc:identifier>
</item>
<item>
<title>If San Francisco is so great, why is everyone I love leaving?</title>
<link>https://sf.curbed.com/2019/1/30/18196549/san-francisco-everyone-leaving-first-person-migration-california</link>
<guid isPermaLink="true" >https://sf.curbed.com/2019/1/30/18196549/san-francisco-everyone-leaving-first-person-migration-california</guid>
<description>&lt;p class=&quot;p-dropcap has-dropcap p-large-text&quot; id=&quot;jo0S6j&quot;&gt;I’m driving down the 101 toward San Francisco International Airport. A gray blanket of fog pours over the hills in the distance, smothering what would be a luminous California sunset. Eleanor is sitting next to me in the passenger seat taking deep breaths. She does not like to fly.&lt;/p&gt;
&lt;p id=&quot;ecd7&quot;&gt;I hesitate, then finally ask what’s on her mind, cutting the air between us. “I don’t want to put any pressure on you, but since this is the last time we’ll be hanging out for a while, I feel like we have drifted apart over the last year. Is there something I did wrong? Is there something you want to tell me? You know, before you leave?”&lt;/p&gt;
&lt;p id=&quot;821d&quot;&gt;We are driving to her one-way flight bound for Pittsburgh. She’s moving out of the San Francisco Bay Area, where we have both lived since we were kids. Our parents, who were themselves mixed transplants from New England and other parts of California, settled in the Bay in the ’70s and ’90s. Eleanor and I met in high school—two weirdos who recognized each other’s outsider-looking-in approach to the world. Now on the cusp of 30, we have 16 years of friendship between us. We did a podcast together. She went to work with me the day after my father died. We have gotten lost in the desert together, twice (before smartphones). On separate occasions, we have cleaned up each other’s vomit. We were once referred to as “hetero life mates.” And today she is leaving.&lt;/p&gt;
&lt;p id=&quot;3680&quot;&gt;There are other friends out in Pittsburgh who have made a calm life as artists, cooks, house-cleaners, and creatives: an impossibility in the Bay Area, unless you have family assistance. Eleanor visited them a few months ago, and, charmed by their stability, the brick-paved streets, and the affordable apartments that lined them, it became impossible for her not to see how well she could do there too. Among other talents, she is, first and foremost, an artist.&lt;/p&gt;
&lt;p id=&quot;e778&quot;&gt;I’m not.&lt;/p&gt;
&lt;p id=&quot;ab2a&quot;&gt;I’m telling her “I feel like we’ve drifted apart.” What I really want to say is “What could I have done to make you stay?”&lt;/p&gt;
&lt;p id=&quot;7f8c&quot;&gt;“There’s nothing, really,” she says, “I mean, the political climate has been hard. But also it’s just the Bay. Inviting people out to Stinson is easy; getting people to visit me when I have nowhere to host them is harder.”&lt;/p&gt;
&lt;p id=&quot;d1da&quot;&gt;Several months ago, she had made the difficult decision to move back onto a small corner of her parents beach-town property, after her urban East Bay house became waterlogged during the rainstorms of 2016. We had to move her out over a weekend, after the mold took half the furniture and gave her roommate pneumonia in both lungs. I touched swollen blisters of stagnant rainwater pulsing on her walls. After emailing the landlord about the issues, the housemates abandoned the property. He then successfully sued them in accordance with California tenant laws.&lt;/p&gt;
&lt;p id=&quot;a10b&quot;&gt;Although moving back to your parents’ home is never ideal, Eleanor didn’t have a lot of other options. But Stinson was not the little village she had left behind for college.&lt;/p&gt;
&lt;p id=&quot;4b73&quot;&gt;While only accessible by a narrow 10-mile strip of road lined by falling rocks and perilous sea cliffs, Stinson Beach is nevertheless one of the most popular day trips for San Francisco urbanites. Once a salty refuge for dendrophilic introverts and quiet hippies of means, Stinson spent the last few years transforming into a seaside “simpler times” theme park for San Francisco’s stratospherically wealthy. Eleanor had watched her foggy hometown gorge with tourists in $300 jeans on a mission for an idyllic, sand-weathered NorCal experience.&lt;/p&gt;
&lt;p id=&quot;f053&quot;&gt;But hating rich tourists simply for flooding the place with money is not the reason Eleanor is leaving the Bay.&lt;/p&gt;
&lt;div class=&quot;c-float-right c-float-hang&quot;&gt;
&lt;aside id=&quot;8jL3bq&quot;&gt;&lt;q&gt;“We understand that with our respective shares of the rent, we could be paying mortgages on entire houses in Denver or Austin. But we are here.”&lt;/q&gt;&lt;/aside&gt;&lt;/div&gt;
&lt;p id=&quot;4ca2&quot;&gt;She was a manager at an artisanal goods boutique, which directly served this crowd of fast-culture beneficiaries hungry for slow-culture products. She is also the child of interracial parents, who built their own house in Stinson when she was little more than a baby. The town was essentially her cocoon for over 15 years. As an adult, she quickly got hired at the boutique because, to quote Eleanor, “the owners know the signs of a townie who has returned with swallowed pride and no prospects.” But the tourists did not know these signs. The new deal for living in Stinson—her hometown—was getting used to hearing “Where are you from? Here? No way!” repeatedly from rich white people, who didn’t know how to fit a brown girl in their vision of an authentic seaside experience.&lt;/p&gt;
&lt;p id=&quot;12ac&quot;&gt;She would then go home to an in-law unit, while those people retired to one of the many lavish Airbnbs that have popped up over the last decade. “Imagine working at Disneyland, then going home to your place in the back of the Pirates of the Caribbean ride while drunk frat grads puke into the water,” she told me.&lt;/p&gt;
&lt;p id=&quot;9141&quot;&gt;To be clear, she loved her town and its bearing in the coastal California fantasy. She wanted to share it, brag about it, celebrate it. But selling bourgeoise yogurt crocks and $100 bottles of wine to people who didn’t see her as part of their shabby-chic fantasy was becoming difficult to bear. She was also onboarding other displaced “village kids” who were doing exactly what she was doing: moving back home, into their parents’ offices, in-law units, and backyards. Having only kind words and a dead-end service job to offer them was making her grow thorns.&lt;/p&gt;
&lt;p id=&quot;2506&quot;&gt;She was unhappy. The boutique was becoming a psychological warfare zone. She had tried her hand doing sales at a startup, but the work was soul-fraying. Art made her happy, and she was genuinely talented, but working at a couture costume shop and an internationally acclaimed ceramics studio wasn’t enough to pay the bills. She couldn’t afford to move.&lt;/p&gt;
&lt;p id=&quot;4585&quot;&gt;The muse was not only dead—it couldn’t afford the resuscitation fee.&lt;/p&gt;
&lt;p id=&quot;ad74&quot;&gt;This is why I never doubted her desire to leave the Bay Area. But my guilt came from somewhere else.&lt;/p&gt;
&lt;p id=&quot;c2b0&quot;&gt;I had not been facing these problems. I dabble in dance, but I was too cowardly to ever accept the life of an artist. I work in tech.&lt;/p&gt;
&lt;div class=&quot;c-float-left c-float-hang&quot;&gt;
&lt;aside id=&quot;dmJhIg&quot;&gt;&lt;q&gt;“Leaving the Bay Area is the best thing you can do right now, if you have a dream.”&lt;/q&gt;&lt;/aside&gt;&lt;/div&gt;
&lt;p id=&quot;rpftdd&quot;&gt;To clarify, I am not a programmer. I say I am a “techie” in the sense that I have positioned myself, through a combination of hard work, luck, and privilege, to benefit from the startup bomb that exploded in my backyard 10 years ago. I was handed a sales job by a family friend right out of college, and I took it greedily, not looking back until, well, now. Mostly I have worked in sales, marketing, and user research. For my efforts, I live in a gritty but familial part of the sprawling, controversial metropolis of Oakland. I have my own en suite bathroom and a tiny balcony where I can grow useless amounts of herbs and play at “connecting to the land.” My roommate is a professional journalist with a blue checkmark on Twitter. We’re both in our 30s. We understand that with our respective shares of the rent, we could be paying mortgages on entire houses in Denver or Austin. But we are here. Our friends (what’s left of them) and family are here; my job network is here. Two fully employed middle-class women in their 30s splitting bills on Venmo and figuring out how to most diplomatically accuse the other of eating more of the peanut butter. This is normal in the Bay Area. Only programmers live alone. Only rich programmers own houses.&lt;/p&gt;
&lt;p id=&quot;7f92&quot;&gt;Setting aside for a moment Oakland’s own gentrification culture war (which would be another 20-minute essay), it is a two-hour drive away from Eleanor’s home in Stinson. It should only be an hour, but the traffic on the 580 moved from “rush-hour average” to “perpetual nightmare” sometime in 2014. With a regular work week, you don’t often have four hours to spare for a round-trip drive to see a friend—even the one who wouldn’t leave your side when your dad died.&lt;/p&gt;
&lt;div&gt;&lt;span class=&quot;e-image__inner&quot;&gt;&lt;span class=&quot;e-image__image&quot; data-original=&quot;https://cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg&quot;&gt; &lt;img srcset=&quot;https://cdn.vox-cdn.com/thumbor/EOvom972t-3YQ_yr4_Obu0H18QE=/0x0:2292x1528/320x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 320w, https://cdn.vox-cdn.com/thumbor/Wl1yuy6RFV6cxfGAUoCgciEVOWg=/0x0:2292x1528/520x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 520w, https://cdn.vox-cdn.com/thumbor/BfasQPtQkJz4Yr4-SJqkz_BSA5U=/0x0:2292x1528/720x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 720w, https://cdn.vox-cdn.com/thumbor/4wThTCHnKWtNPaqDraCgdPQtqxM=/0x0:2292x1528/920x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 920w, https://cdn.vox-cdn.com/thumbor/yYA8ZMW38ihaKVFH96bMGaaD79M=/0x0:2292x1528/1120x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 1120w, https://cdn.vox-cdn.com/thumbor/4HM0XcJLBN22rkG-5xEuclyo6Xw=/0x0:2292x1528/1320x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 1320w, https://cdn.vox-cdn.com/thumbor/Anb2pYiGDaIue_PzjrGXnrIMu18=/0x0:2292x1528/1520x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 1520w, https://cdn.vox-cdn.com/thumbor/XeUsawxBiS1z_LbnBWBGwTzo0_g=/0x0:2292x1528/1720x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 1720w, https://cdn.vox-cdn.com/thumbor/IJo2jlvrEZRqNskAwj4WOJtEwSc=/0x0:2292x1528/1920x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg 1920w&quot; sizes=&quot;(min-width: 1221px) 846px, (min-width: 880px) calc(100vw - 334px), 100vw&quot; alt=&quot;&quot; data-upload-width=&quot;2292&quot; src=&quot;https://cdn.vox-cdn.com/thumbor/R99UMwoeBHcDITjWaZtuRPgAzwM=/0x0:2292x1528/1200x0/filters:focal(0x0:2292x1528):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722098/Spot_SF_LeonardPeng.jpg&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p id=&quot;2f2d&quot;&gt;Had we drifted? Of course we had. But it was more than the traffic and geography that was the source of my guilt. I felt I had played into the system that was financially and culturally kicking her out. And I’d realized it for the first time just as she was leaving.&lt;/p&gt;
&lt;p id=&quot;c565&quot;&gt;“I’m scared I haven’t been a good enough friend to you,” I confess to her.&lt;/p&gt;
&lt;p id=&quot;0030&quot;&gt;“I do feel loved and supported,” she says.&lt;/p&gt;
&lt;p id=&quot;8140&quot;&gt;“I’m glad,” I say. And I mean it. I feel greedy for this absolution because I realize beyond the guilt, there’s another feeling: paranoia.&lt;/p&gt;
&lt;p id=&quot;eea8&quot;&gt;For the first time, while sitting in full-stop traffic before the Bay Bridge in the ironically named “fastrak” lane, I count them in my head: 11 people I care about have left California in the past two years. Eleanor is number 12, and apparently the final straw that’s really making me pause and think, “What the hell is going on?”&lt;/p&gt;
&lt;p id=&quot;7cdd&quot;&gt;She shifts next to me in the dead-stop traffic. I know her well enough at this point to know she is teeming with anxiety. “We’ll make the flight. We left early,” I say.&lt;/p&gt;
&lt;p id=&quot;8fdf&quot;&gt;“I know,” she says.&lt;/p&gt;
&lt;p id=&quot;9793&quot;&gt;But we both know this is not why she’s nervous.&lt;/p&gt;
&lt;p id=&quot;8c79&quot;&gt;She’s nervous about the life shift. The constant cloud of “failure” that threatens to downpour on you at any minute if you live in the Bay Area is still looming over her head.&lt;/p&gt;
&lt;p id=&quot;0798&quot;&gt;What she doesn’t know yet is that this cloud, for her, is about to dissipate. Leaving the Bay Area is the best thing you can do right now, if you have a dream. She’s going to be fine. She just doesn’t know it yet.&lt;/p&gt;
&lt;div class=&quot;c-wide-block&quot;&gt;&lt;span class=&quot;e-image__inner&quot;&gt;&lt;span class=&quot;e-image__image&quot; data-original=&quot;https://cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg&quot;&gt; &lt;img srcset=&quot;https://cdn.vox-cdn.com/thumbor/GRwrX4WW0eLb5iO_CgdFwIrz7OQ=/0x0:1800x80/320x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 320w, https://cdn.vox-cdn.com/thumbor/Y-6OrowllPoK3Q1HsCz-Ib_r-rY=/0x0:1800x80/520x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 520w, https://cdn.vox-cdn.com/thumbor/60yj5gTEj9xsc1NLKk7KkkLgNhg=/0x0:1800x80/720x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 720w, https://cdn.vox-cdn.com/thumbor/WFW4inTWqiZJTwvPei-07xD0LSk=/0x0:1800x80/920x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 920w, https://cdn.vox-cdn.com/thumbor/i5qQjTFbMdnQ9zSkYSdclLMVrvI=/0x0:1800x80/1120x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 1120w, https://cdn.vox-cdn.com/thumbor/EdQlUXF29m4w0IWQx7pRLeqqcnQ=/0x0:1800x80/1320x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 1320w, https://cdn.vox-cdn.com/thumbor/oz3iMkuafyyy6IenLPri9u0u438=/0x0:1800x80/1520x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 1520w, https://cdn.vox-cdn.com/thumbor/OaiZV5fTpk7QLZkZIevfYaGesk4=/0x0:1800x80/1720x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 1720w, https://cdn.vox-cdn.com/thumbor/efFifpqezWVXkCFw31jtDUwpuSQ=/0x0:1800x80/1920x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg 1920w&quot; sizes=&quot;90vw&quot; alt=&quot;&quot; data-upload-width=&quot;1800&quot; src=&quot;https://cdn.vox-cdn.com/thumbor/qoriMDmIdthHzKXEyvrOj8ITC_Q=/0x0:1800x80/1200x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722170/HR2_SF_LeonardPeng.jpg&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p id=&quot;0d91&quot;&gt;Moving, especially moving across the country, is an enormous, yet hardly uncommon, life shift. Leaving one’s hometown to forge a better future in a new city is one of the most traditional adult rites of passage that we as Americans have. Eleanor and I had a few friends who left the Bay around 2012 and 2013 for career opportunities, to be with a spouse, or to take a rare internship. We wished them well. It was hard, but normal. We were in our early 20s.&lt;/p&gt;
&lt;p id=&quot;96f3&quot;&gt;There’s something not normal, however, about the number of people who have taken flight out of California in the past year or so.&lt;/p&gt;
&lt;p id=&quot;2269&quot;&gt;If you go to Austin, New Orleans, Kansas City, Pittsburgh, Philadelphia, Portland, Seattle, Chicago, and Denver—to name just a few—you can easily find folks transplanted from other cities and states. You can also easily find a band of locals bemoaning, specifically, the “fucking Californians” who are flooding their home, driving up rents, installing yoga studios, polluting the local vibe with new technology, and &lt;a href=&quot;https://www.sfgate.com/local/article/Why-people-love-to-hate-Californians-11101058.php&quot;&gt;generally making everything suck while sipping kale juice&lt;/a&gt;. We’re threatening Austin’s weirdness and erasing Bozeman’s cowboys. We seem to be everywhere you look, ruining other cities, apparently by not staying where we ought to—back in California.&lt;/p&gt;
&lt;p id=&quot;5265&quot;&gt;It would appear we are fleeing California like it’s on fire (which, actually, it literally is lately); only large quantities of “foreign” people moving into one area typically disrupt culture and incite hatred like that. Yet San Francisco rent continues to lead the nation based on white-hot demand. This doesn’t really make sense.&lt;/p&gt;
&lt;p id=&quot;2ec3&quot;&gt;Let me offer a snapshot of San Francisco in 2018:&lt;/p&gt;
&lt;p id=&quot;f2ff&quot;&gt;A friend is having a birthday party at a funky dive bar in the Mission and has invited you. Despite the ostensibly blue-collar aesthetic, you pay $14 for a cocktail containing house-made lavender syrup and organic gin. You lean against a vintage pinball machine, a shrine to the predigital adolescence half the people in the bar never had, and proceed to make small talk with the other guests, asking, “Where are you from?”&lt;/p&gt;
&lt;p id=&quot;5534&quot;&gt;They reply: “Wisconsin.”&lt;/p&gt;
&lt;p id=&quot;2fc6&quot;&gt;“Texas.”&lt;/p&gt;
&lt;p id=&quot;46cf&quot;&gt;“Washington.”&lt;/p&gt;
&lt;p id=&quot;5b7e&quot;&gt;“Los Angeles.”&lt;/p&gt;
&lt;p id=&quot;540f&quot;&gt;“Illinois.”&lt;/p&gt;
&lt;p id=&quot;44b7&quot;&gt;“Boston.”&lt;/p&gt;
&lt;p id=&quot;4524&quot;&gt;“North Carolina.”&lt;/p&gt;
&lt;p id=&quot;fafb&quot;&gt;And, of course, you encounter several international immigrants from Europe, Latin America, and Asia, who never ever seem to complain about housing costs, traffic, Whole Foods, or you.&lt;/p&gt;
&lt;p id=&quot;611a&quot;&gt;One person says, “I’m a Bay Area native.”&lt;/p&gt;
&lt;p id=&quot;8584&quot;&gt;Being a Bay Area native does not mean this person is Miwok or Ohlone (two Native American tribes who originally lived here). It just means they lived in the Bay before tech took off. It’s like wearing an invisible bachelorette party sash that says: “The startup tsunami basically came to me. I am both riding the wave &lt;em&gt;and&lt;/em&gt; I can complain about it.” (Or, depending on their shoes, it could mean, “My dad founded a venture capital firm and my apartment’s lot is worth more than your entire life.”) This person will proceed to complain about rent and the general loss of culture they have witnessed over the past 10 years.&lt;/p&gt;
&lt;p id=&quot;875a&quot;&gt;But what this “native” Bay Area kid &lt;em&gt;won’t&lt;/em&gt; do is start blaming the guy from North Carolina or Wisconsin or Boston—basically every other person in the bar—for propelling the rents into the sky and inadvertently forcing the “locals” to flee. Someone may disagree with me here, but I just haven’t seen it done. If the conversation actually manages to advance far enough into blaming something for the Bay’s loss of culture and housing woes, the finger falls on the &lt;em&gt;companies&lt;/em&gt; who employ these newcomers: Google, Genentech, Facebook, Twitter, Apple, etc. Even still, this finger of blame rarely gets raised above the hip; we use these companies’ products or benefit from their research every day.&lt;/p&gt;
&lt;p id=&quot;b62e&quot;&gt;There is an apocalyptic amount of people moving into California, and no one blames them for the overcrowding and the shifting culture. But when too many Californians leave California and settle in, say, Portland, &lt;a href=&quot;https://www.mercurynews.com/2017/07/03/go-back-to-california-painted-on-prius-in-portland/&quot;&gt;they are blamed for ruining the place by way of simply being themselves&lt;/a&gt;. I visited Seattle for the first time a month ago and was warned someone might throw a bottle at my car for my California plates. In Portland, I saw “No Californians” signs slapped onto “for sale” signs in yards. In Denver, I read news articles about friendlier locals advising Californians to tell people they were from literally anywhere else. You can Google virtually any city plus the phrase “hate Californians” and find pages of forums and articles giving voice to the hatred of Golden State jerks “ruining” cities. This is not true for other domestic migrants.&lt;/p&gt;
&lt;p id=&quot;98d7&quot;&gt;It is apparently Californians who are unique in their snobbery and ability to ruin other places.&lt;/p&gt;
&lt;p id=&quot;14ec&quot;&gt;Yet I am having trouble feeling snobbish and superior when I’m losing friend after friend after friend to cities that don’t make it impossible to be a teacher, a painter, a bakery owner, or even a damn barista in order to have a full fridge and a fulfilling life.&lt;/p&gt;
&lt;div class=&quot;c-float-right c-float-hang&quot;&gt;
&lt;aside id=&quot;0QAKGZ&quot;&gt;&lt;q&gt;“I don’t want California to stop being a hub of brilliant, ambitious people. What I want is for California to be affordable to more than one kind of life.”&lt;/q&gt;&lt;/aside&gt;&lt;/div&gt;
&lt;p id=&quot;e218&quot;&gt;Also, above all, I don’t want California to stop growing and benefiting from all the international and domestic migrants who flock here for opportunity and/or safety. Despite the fact that my rent makes some people do spit-takes, I am still a beneficiary of an inflated Bay Area salary. On a daily basis, I get to work with freakishly brave, casually brilliant minds, curated and imported not just from across the United States, but from India, China, Canada, Britain, New Zealand, and South America. At a dinner party, I get to sound like a comic book super scientist (“we’re finding the algorithm for love”) or a Bond villain’s understudy (“we’re building a robot army”). I am also proud to be part of a liberal community that is trying to be a safe zone for people who would otherwise be persecuted in other parts of the country or the world. And, to frost the cake, I get to experience all of this while being surrounded by majestic redwood forests, nationally conserved seashores, famous wines, temperate weather, and the entire food, music, and art accessory package that comes with being in a world-class city that international business kings and technology icons call “home.” Holy shit. The Bay Area is fucking awesome, right?&lt;/p&gt;
&lt;p id=&quot;13cf&quot;&gt;Yeah. Except for the part where everyone I love is leaving.&lt;/p&gt;
&lt;p id=&quot;01d4&quot;&gt;I don’t want California to stop being a hub of brilliant, ambitious people. What I want is for California to be affordable to more than one kind of life. And I want the record set straight about who exactly is moving where and, above all, why.&lt;/p&gt;
&lt;p id=&quot;6222&quot;&gt;We are witnessing two migrations. One is the continuation of the Californian dream, where young people flock here for gold and glory, ready to hustle and disrupt, hammering to hit the motherlode and laughing at the odds. The other is the migration of young people &lt;em&gt;out&lt;/em&gt; of California, which seems to have affected everyone I know, but which I rarely hear examined. These people want to be artists, teachers, blacksmiths, therapists, mechanics, and musicians. They want to have children, open bakeries, own a house. But they can’t. There is no room here for those kinds of dreams anymore. They hear about someone’s success in New Orleans, Kansas City, or Pittsburgh, and they leave their families and communities behind on the chance they will, ironically, strike gold.&lt;/p&gt;
&lt;p id=&quot;67cb&quot;&gt;To the angry locals of Portland, Seattle, Denver, New Orleans, Kansas City, Phoenix, Austin, and elsewhere, please hear this defense: The Californians who are coming in and “ruining” your cities are not snobs. They don’t have trust funds. They aren’t entitled. They are the opposite. They have been kicked out of their own backyards for not learning Python fast enough or not having a dad who could introduce them to VC firms or not wanting to live in their family’s in-law unit at age 30 or not being able to afford a $2,000/month studio on a $20/hour paycheck. They aren’t techies; they had the audacity to want something besides tech. They are some of our best, most creative, most hardworking people—and you are getting them. We are losing them.&lt;/p&gt;
&lt;p id=&quot;24a1&quot;&gt;We are kind to your friends who move here to grow, to start things, to feel safe, to dream. So, please, be kind to my friends and their dreams too.&lt;/p&gt;
&lt;div class=&quot;c-wide-block&quot;&gt;&lt;span class=&quot;e-image__inner&quot;&gt;&lt;span class=&quot;e-image__image&quot; data-original=&quot;https://cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg&quot;&gt; &lt;img srcset=&quot;https://cdn.vox-cdn.com/thumbor/k5y1cGiyvNoIxPXl6CHXQaeYSEw=/0x0:1800x80/320x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 320w, https://cdn.vox-cdn.com/thumbor/UTvq6hNe7XZeMz4O8li-3rimYbo=/0x0:1800x80/520x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 520w, https://cdn.vox-cdn.com/thumbor/cSOEpq9bQfzfrIfsMA_q-d8qcVk=/0x0:1800x80/720x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 720w, https://cdn.vox-cdn.com/thumbor/aqJDkTMtv0QbayqhdCgnwbU1sSs=/0x0:1800x80/920x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 920w, https://cdn.vox-cdn.com/thumbor/2eWn3Unoyls7ydc0Ag6NnecQZhQ=/0x0:1800x80/1120x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 1120w, https://cdn.vox-cdn.com/thumbor/sixdEP7_aX8s6uVT_k00KaFAZc0=/0x0:1800x80/1320x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 1320w, https://cdn.vox-cdn.com/thumbor/mA84bNNag34K0h_Z_VRAVw7R-lw=/0x0:1800x80/1520x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 1520w, https://cdn.vox-cdn.com/thumbor/ng83MNwmjmshqeGOXbJ1lhiolBY=/0x0:1800x80/1720x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 1720w, https://cdn.vox-cdn.com/thumbor/CdMDy-9A1ZlUJW0kZkScF-xbMcc=/0x0:1800x80/1920x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg 1920w&quot; sizes=&quot;90vw&quot; alt=&quot;&quot; data-upload-width=&quot;1800&quot; src=&quot;https://cdn.vox-cdn.com/thumbor/OB2gx9-0ObVRXmDxP8pIGzXnoG0=/0x0:1800x80/1200x0/filters:focal(0x0:1800x80):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/13722174/HR2_SF_LeonardPeng.jpg&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p id=&quot;ccef&quot;&gt;At SFO, I watch as Eleanor walks inside the terminal with all her possessions: two trunks and a carry-on full of handmade ceramics. We hug. We tell each other I love you—something I rarely say—promise to keep in touch, and say all the other sentiments humans use to anesthetize loss. She turns the corner and is gone.&lt;/p&gt;
&lt;p id=&quot;67c3&quot;&gt;I get back into my car. I take a breath. Instantly I crumple, like an angry teenager, gasping and wiping tears all over my face. I want to slam the steering wheel and have my own private “it isn’t fair” meltdown. But I don’t. The meter maids at SFO are fierce and will bear down on you if you idle in passenger loading for more than 30 seconds. The airport is a zoo of emergency lights, Ubers competing for space, attendants blaring whistles. At San Francisco’s busy pace, there is no time for examining loss.&lt;/p&gt;
&lt;p id=&quot;f88c&quot;&gt;I take another breath, remembering that I am happy for her. I’m an adult. People move all the time. This is normal. It’s not my fault she’s gone, that all 12 of them are gone. Normal. People move all the time. Nothing I could have done.&lt;/p&gt;
&lt;p class=&quot;c-end-para&quot; id=&quot;f56e&quot;&gt;I can’t change the rent.&lt;/p&gt;
&lt;p id=&quot;bvfJOT&quot;&gt;&lt;em&gt;This article first appeared on&lt;/em&gt; &lt;a href=&quot;https://medium.com/s/story/if-san-francisco-is-so-great-why-is-everyone-i-love-leaving-d2b167471c35&quot;&gt;&lt;em&gt;Medium&lt;/em&gt;&lt;/a&gt;&lt;em&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p id=&quot;ddwqMl&quot;&gt;&lt;em&gt;Correction: The article initially stated that Airbnbs outnumbered permanent housing by about 3:1. In fact, as of January 31, the number is 58 Airbnb rentals in a town with approximately 340 housing units. We have updated the article accordingly.&lt;/em&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 02 Feb 2019 11:41:38 +0000</pubDate>
<dc:creator>ForHackernews</dc:creator>
<og:description>We are witnessing two migrations: One is a continuation of the California dream. The other no one talks about, though it affects nearly everyone I know.</og:description>
<og:image>https://cdn.vox-cdn.com/thumbor/bysBtfFkrtHk_hmg8BbYx-GmdLs=/0x265:3000x1836/fit-in/1200x630/cdn.vox-cdn.com/uploads/chorus_asset/file/13722077/Lead_SF_LeonardPeng.jpg</og:image>
<og:title>If San Francisco is so great, why is everyone I love leaving?</og:title>
<og:type>article</og:type>
<og:url>https://sf.curbed.com/2019/1/30/18196549/san-francisco-everyone-leaving-first-person-migration-california</og:url>
<dc:format>text/html</dc:format>
<dc:identifier>https://sf.curbed.com/2019/1/30/18196549/san-francisco-everyone-leaving-first-person-migration-california</dc:identifier>
</item>
</channel>
</rss>