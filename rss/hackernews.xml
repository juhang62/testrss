<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Medium-hard SQL interview questions</title>
<link>https://quip.com/2gwZArKuWk7W</link>
<guid isPermaLink="true" >https://quip.com/2gwZArKuWk7W</guid>
<description>&lt;p id=&quot;WbZACANIFCi&quot; class=&quot;line&quot;&gt;By Zachary Thomas (&lt;a href=&quot;mailto:zthomas.nc@gmail.com&quot; rel=&quot;nofollow&quot;&gt;zthomas.nc@gmail.com&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/zach_i_thomas&quot; rel=&quot;nofollow&quot;&gt;Twitter&lt;/a&gt;, &lt;a href=&quot;https://www.linkedin.com/in/thomaszi/&quot; rel=&quot;nofollow&quot;&gt;LinkedIn&lt;/a&gt;) &lt;/p&gt;
&lt;p id=&quot;WbZACA7m9Y0&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAYPfwi&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Tip:&lt;/strong&gt; See the Table of Contents (document outline) by hovering over the vertical line on the right side of the page &lt;/p&gt;
&lt;h2 id=&quot;WbZACAvwBuk&quot;&gt;Background &amp;amp; Motivation&lt;/h2&gt;
&lt;blockquote id=&quot;WbZACA2g5er&quot; readability=&quot;5&quot;&gt;
&lt;p&gt;The first 70% of SQL is pretty straightforward but the remaining 30% can be pretty tricky.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p id=&quot;WbZACAZS62y&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAKZa0g&quot; class=&quot;line&quot;&gt;Between the fall of 2015 and the summer of 2019 I interviewed for data analyst and data scientists positions four separate times, getting to onsite interviews at over a dozen companies. After an interview in 2017 went poorly — mostly due to me floundering at the more difficult SQL questions they asked me — I started putting together a study guide of medium and hard SQL questions to better prepare and found it particularly useful during my 2019 interview cycle. Over the past year I have shared that guide with a couple of friends, and with the extra time on my hands due to the coronavirus pandemic, I have polished it up into this doc. &lt;/p&gt;
&lt;p id=&quot;WbZACAwpU54&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAKR7Vk&quot; class=&quot;line&quot;&gt;There are plenty of great beginner SQL guides out there. My favorites are Codecademy’s &lt;a href=&quot;https://www.codecademy.com/learn/learn-sql&quot; rel=&quot;nofollow&quot;&gt;interactive SQL courses&lt;/a&gt; and Zi Chong Kao’s &lt;a href=&quot;https://selectstarsql.com/&quot; rel=&quot;nofollow&quot;&gt;Select Star SQL&lt;/a&gt;. However, like I told a friend, while the first 70% of SQL is pretty straightforward, the remaining 30% can be pretty tricky. Data analyst and data scientist interview questions at technology companies often pull from that 30%.  &lt;/p&gt;
&lt;p id=&quot;WbZACAN63Gz&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACA5gSEb&quot; class=&quot;line&quot;&gt;Strangely, I have never really found a comprehensive source online for those medium-hard SQL questions, which is why I put together this guide. &lt;/p&gt;
&lt;p id=&quot;WbZACAeCXka&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAHVf0I&quot; class=&quot;line&quot;&gt;Working through this guide should improve your performance on data analyst interviews. It should also make you better at your current and future job positions. Personally, I find some of the SQL patterns found in this doc useful for ETLs powering reporting tools featuring trends over time. &lt;/p&gt;
&lt;p id=&quot;WbZACADn68v&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACApH5Ob&quot; class=&quot;line&quot;&gt;To be clear, data analyst and data scientist interviews consist of more than SQL questions. Other common topics include explaining past projects, A/B testing, metric development and open-ended analytical problems. This &lt;a href=&quot;https://qr.ae/pNrdGV&quot; rel=&quot;nofollow&quot;&gt;Quora answer&lt;/a&gt; has Facebook’s product analyst interview guide circa 2017, which discusses this topic in more depth. That said, if improving your SQL skills can make your interviews less stressful than they already are, it could very well be worth your time. &lt;/p&gt;
&lt;p id=&quot;WbZACA2eBOM&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAfeJ9p&quot; class=&quot;line&quot;&gt;In the future, I may transition this doc to a website like &lt;a href=&quot;https://selectstarsql.com/&quot; rel=&quot;nofollow&quot;&gt;Select Star SQL&lt;/a&gt; with an embedded SQL editor so that readers can write SQL statements to questions and get real-time feedback on their code. Another option could be adding these questions as problems on Leetcode. For the time being though I just wanted to publish this doc so that people could find it useful now.  &lt;/p&gt;
&lt;p id=&quot;WbZACABfLdV&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACA3DtQJ&quot; class=&quot;line&quot;&gt;&lt;strong&gt;I would love to get your feedback on this doc. Please drop a note if you find this useful, have improvements/corrections, or encounter other good resources for medium/hard difficulty SQL questions. &lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;WbZACAEjWv1&quot;&gt;Assumptions &amp;amp; How to use this guide &lt;/h2&gt;
&lt;p id=&quot;WbZACAK12Qe&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Assumptions about SQL proficiency: &lt;/strong&gt;This guide assumes you have a working knowledge of SQL. You probably use it frequently at work already but want to sharpen your skills on topics like self-joins and window functions. &lt;/p&gt;
&lt;p id=&quot;WbZACAJ3jAt&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACA6QyaD&quot; class=&quot;line&quot;&gt;&lt;strong&gt;How to use this guide:&lt;/strong&gt; Since interviews usually utilize a whiteboard or a virtual (non-compiling) notepad, my recommendation is to get out a pencil and paper and write out your solutions to each part of the problem, and once complete compare your answers to the answer key. Or, complete these with a friend who can act as the interviewer!&lt;/p&gt;
&lt;div data-section-style=&quot;5&quot; class=&quot;&quot;&gt;
&lt;ul id=&quot;WbZACAheLCp&quot;&gt;&lt;li id=&quot;WbZACA88Aw3&quot; class=&quot;&quot; value=&quot;1&quot;&gt;&lt;span id=&quot;WbZACA88Aw3&quot;&gt;Small SQL syntax errors aren’t a big deal during whiteboard/notepad interviews. However, they can distracting to the interviewer, so ideally practice reducing these so your logic shines through in the interview. &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li id=&quot;WbZACArh2wq&quot; class=&quot;&quot;&gt;&lt;span id=&quot;WbZACArh2wq&quot;&gt;The answers I provide may not be the only way to successfully solve the question. Feel free to message with additional solutions and I can add them to this guide! &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;h2 id=&quot;WbZACA1LBwg&quot;&gt;Tips on solving difficult SQL interview questions &lt;/h2&gt;
&lt;p id=&quot;WbZACAZ1seX&quot; class=&quot;line&quot;&gt;This advice mirrors typical code interview advice ... &lt;/p&gt;
&lt;div data-section-style=&quot;6&quot; class=&quot;&quot;&gt;
&lt;ul id=&quot;WbZACA5xF3S&quot;&gt;&lt;li id=&quot;WbZACA6ooAW&quot; class=&quot;&quot; value=&quot;1&quot;&gt;&lt;span id=&quot;WbZACA6ooAW&quot;&gt;Listen carefully to problem description, repeat back the crux of the problem to the interviewer&lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li id=&quot;WbZACAID8Y6&quot; class=&quot;&quot;&gt;&lt;span id=&quot;WbZACAID8Y6&quot;&gt;Spell out an edge case to demonstrate you actually understand problem (i.e. a row that &lt;em&gt;wouldn’t&lt;/em&gt; be included in the output of the SQL you are about to sketch out) &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li id=&quot;WbZACAZ5SNS&quot; class=&quot;parent&quot;&gt;&lt;span id=&quot;WbZACAZ5SNS&quot;&gt;(If the problem involves a self-join) For your own benefit sketch out what the self-join will look like — this will typically be at least three columns: a column of interest from the main table, the column to join from the main table, and the column to join from the secondary table &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;&lt;li id=&quot;WbZACAW6TaV&quot; class=&quot;&quot;&gt;&lt;span id=&quot;WbZACAW6TaV&quot;&gt;Or, as you get more used to self-join problems, you can explain this step verbally &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li id=&quot;WbZACAJ06ww&quot; class=&quot;&quot;&gt;&lt;span id=&quot;WbZACAJ06ww&quot;&gt;Start writing SQL — err towards writing SQL versus trying to perfectly understand the problem. Verbalize your assumptions as you go so your interviewer can correct you if you go astray. &lt;/span&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;h2 id=&quot;WbZACAc1wRf&quot;&gt;Acknowledgments and Additional Resources &lt;/h2&gt;
&lt;p id=&quot;WbZACAi2vbO&quot; class=&quot;line&quot;&gt;Some of the problems listed here are adapted from old Periscope blog posts (mostly written around 2014 by &lt;a href=&quot;https://www.linkedin.com/in/seangcook/&quot; rel=&quot;nofollow&quot;&gt;Sean Cook&lt;/a&gt;, although his authorship seems to have been removed from the posts following SiSense's &lt;a href=&quot;https://www.sisense.com/blog/sisense-and-periscope-data-merge-2/&quot; rel=&quot;nofollow&quot;&gt;merger with&lt;/a&gt; Periscope) or discussions from Stack Overflow; I've noted them at the start of questions as appropriate. &lt;/p&gt;
&lt;p id=&quot;WbZACAFie7v&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAEWdMv&quot; class=&quot;line&quot;&gt;&lt;a href=&quot;https://selectstarsql.com&quot; rel=&quot;nofollow&quot;&gt;Select Star SQL&lt;/a&gt; has good &lt;a href=&quot;https://selectstarsql.com/questions.html#challenge_questions&quot; rel=&quot;nofollow&quot;&gt;challenge questions&lt;/a&gt; that are complementary to the questions in this doc. &lt;/p&gt;
&lt;p id=&quot;WbZACAvoR6c&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAXRIzN&quot; class=&quot;line&quot;&gt;Please note that these questions are not literal copies of SQL interview questions I have encountered while interviewing nor were they interview questions used at a company I have worked at or work at. &lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;WbZACA9bEW8&quot;&gt;#1: MoM Percent Change &lt;/h2&gt;
&lt;p id=&quot;WbZACAtzLJd&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Oftentimes it's useful to know how much a key metric, such as monthly active users, changes between months. Say we have a table &lt;code&gt;logins&lt;/code&gt; in the form: &lt;/p&gt;
&lt;pre id=&quot;WbZACASjV82&quot; class=&quot;prettyprint&quot;&gt;
| user_id | date       |&lt;br /&gt;|---------|------------|&lt;br /&gt;| 1       | 2018-07-01 |&lt;br /&gt;| 234     | 2018-07-02 |&lt;br /&gt;| 3       | 2018-07-02 |&lt;br /&gt;| 1       | 2018-07-02 |&lt;br /&gt;| ...     | ...        |&lt;br /&gt;| 234     | 2018-10-04 |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAvDVwy&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task&lt;/strong&gt;: Find the month-over-month percentage change for monthly active users (MAU). &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAGPW6k&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p id=&quot;WbZACA9cVvU&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAakdFL&quot; class=&quot;line&quot;&gt;&lt;em&gt;(This solution, like other solution code blocks you will see in this doc, contains comments about SQL syntax that may differ between flavors of SQL or other comments about the solutions as listed) &lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAWqT4w&quot; class=&quot;prettyprint&quot; readability=&quot;14.894736842105&quot;&gt;
WITH mau AS &lt;br /&gt;(&lt;br /&gt;SELECT &lt;br /&gt;/* &lt;br /&gt;* Typically, interviewers allow you to write psuedocode for date functions &lt;br /&gt;* i.e. will NOT be checking if you have memorized date functions. &lt;br /&gt;* Just explain what your function does as you whiteboard &lt;br /&gt;*&lt;br /&gt;* DATE_TRUNC() is available in Postgres, but other SQL date functions or &lt;br /&gt;* combinations of date functions can give you a identical results   &lt;br /&gt;* See &lt;a href=&quot;https://www.postgresql.org/docs/9.0/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC&quot; rel=&quot;nofollow&quot;&gt;https://www.postgresql.org/docs/9.0/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC&lt;/a&gt;&lt;br /&gt;*/ &lt;br /&gt;DATE_TRUNC('month', date) month_timestamp,&lt;br /&gt;COUNT(DISTINCT user_id) mau&lt;br /&gt;FROM &lt;br /&gt;logins &lt;br /&gt;GROUP BY &lt;br /&gt;DATE_TRUNC('month', date)&lt;br /&gt;)&lt;p&gt;SELECT &lt;br /&gt;/*&lt;br /&gt;* You don't literally need to include the previous month in this SELECT statement. &lt;br /&gt;* &lt;br /&gt;* However, as mentioned in the &quot;Tips&quot; section of this guide, it can be helpful &lt;br /&gt;* to at least sketch out self-joins to avoid getting confused which table &lt;br /&gt;* represents the prior month vs current month, etc. &lt;br /&gt;*/ &lt;br /&gt;a.month_timestamp previous_month, &lt;br /&gt;a.mau previous_mau, &lt;br /&gt;b.month_timestamp current_month, &lt;br /&gt;b.mau current_mau, &lt;br /&gt;ROUND(100.0*(a.mau - b.mau)/a.mau,2) AS percent_change &lt;br /&gt;FROM&lt;br /&gt;mau a &lt;br /&gt;JOIN &lt;br /&gt;/*&lt;br /&gt;* Could also have done `ON b.month_timestamp = a.month_timestamp + interval '1 month'` &lt;br /&gt;*/&lt;br /&gt;mau b ON a.month_timestamp = b.month_timestamp - interval '1 month' &lt;br /&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p id=&quot;WbZACAdjDop&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAA6gik&quot;&gt;#2: Tree Structure Labeling   &lt;/h2&gt;
&lt;p id=&quot;WbZACA3O2J0&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say you have a table &lt;code&gt;tree&lt;/code&gt; with a column of nodes and a column corresponding parent nodes &lt;/p&gt;
&lt;pre id=&quot;WbZACAbMRRz&quot; class=&quot;prettyprint&quot;&gt;
node   parent&lt;br /&gt;1       2&lt;br /&gt;2       5&lt;br /&gt;3       5&lt;br /&gt;4       3&lt;br /&gt;5       NULL 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAx6ybe&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write SQL such that we label each node as a “leaf”, “inner” or “Root” node, such that for the nodes above we get: &lt;/p&gt;
&lt;pre id=&quot;WbZACAmrwa5&quot; class=&quot;prettyprint&quot;&gt;
node    label  &lt;br /&gt;1       Leaf&lt;br /&gt;2       Inner&lt;br /&gt;3       Inner&lt;br /&gt;4       Leaf&lt;br /&gt;5       Root
&lt;/pre&gt;
&lt;p id=&quot;WbZACA859Zx&quot; class=&quot;line&quot;&gt;(Side note: &lt;a href=&quot;http://ceadserv1.nku.edu/longa//classes/mat385_resources/docs/trees.html&quot; rel=&quot;nofollow&quot;&gt;this link&lt;/a&gt; has more details on Tree data structure terminology. Not needed to solve the problem though!)&lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAUtFCB&quot; class=&quot;line&quot;&gt;&lt;strong&gt;&lt;em&gt;Solution:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p id=&quot;WbZACAf5NE4&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACARSCx9&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement:&lt;/strong&gt; this more generalizable solution was contributed by Fabian Hofmann on 5/2/20. Thank, FH! &lt;/p&gt;
&lt;pre id=&quot;WbZACALlzxv&quot; class=&quot;prettyprint&quot; readability=&quot;7&quot;&gt;
WITH join_table AS&lt;br /&gt;(&lt;br /&gt;SELECT &lt;br /&gt;cur.node, &lt;br /&gt;cur.parent, &lt;br /&gt;COUNT(next.node) AS num_children&lt;br /&gt;FROM &lt;br /&gt;tree cur&lt;br /&gt;LEFT JOIN &lt;br /&gt;tree next ON (next.parent = cur.node)&lt;br /&gt;GROUP BY &lt;br /&gt;cur.node, &lt;br /&gt;cur.parent&lt;br /&gt;)&lt;p&gt;SELECT&lt;br /&gt;node,&lt;br /&gt;CASE&lt;br /&gt;WHEN parent IS NULL THEN &quot;Root&quot;&lt;br /&gt;WHEN num_children = 0 THEN &quot;Leaf&quot;&lt;br /&gt;ELSE &quot;Inner&quot;&lt;br /&gt;END AS label&lt;br /&gt;FROM &lt;br /&gt;join_table 
&lt;/p&gt;&lt;/pre&gt;
&lt;p id=&quot;WbZACAv9dgl&quot; class=&quot;line&quot;&gt;An alternate solution, without explicit joins: &lt;/p&gt;
&lt;pre id=&quot;WbZACA7eLBd&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;node,&lt;br /&gt;CASE &lt;br /&gt;WHEN parent IS NULL THEN 'Root'&lt;br /&gt;WHEN node NOT IN (SELECT parent FROM tree) THEN 'Leaf'&lt;br /&gt;WHEN node IN (SELECT parent FROM tree) AND parent IS NOT NULL THEN 'Inner'&lt;br /&gt;END AS label &lt;br /&gt;from &lt;br /&gt;tree
&lt;/pre&gt;
&lt;p id=&quot;WbZACAUXNLU&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAAd42s&quot;&gt;#3: Retained Users Per Month (multi-part)&lt;/h2&gt;
&lt;p id=&quot;WbZACAyNsqQ&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement: &lt;/strong&gt;this problem is adapted from SiSense’s &lt;a href=&quot;https://www.sisense.com/blog/use-self-joins-to-calculate-your-retention-churn-and-reactivation-metrics/&quot; rel=&quot;nofollow&quot;&gt;“Using Self Joins to Calculate Your Retention, Churn, and Reactivation Metrics”&lt;/a&gt; blog post&lt;/p&gt;
&lt;h3 id=&quot;WbZACAjgUR7&quot;&gt;Part 1: &lt;/h3&gt;
&lt;p id=&quot;WbZACAPzWAy&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have login data in the table &lt;code&gt;logins&lt;/code&gt;: &lt;/p&gt;
&lt;pre id=&quot;WbZACAw859l&quot; class=&quot;prettyprint&quot;&gt;
| user_id | date       |&lt;br /&gt;|---------|------------|&lt;br /&gt;| 1       | 2018-07-01 |&lt;br /&gt;| 234     | 2018-07-02 |&lt;br /&gt;| 3       | 2018-07-02 |&lt;br /&gt;| 1       | 2018-07-02 |&lt;br /&gt;| ...     | ...        |&lt;br /&gt;| 234     | 2018-10-04 |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAGOHB8&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query that gets the number of retained users per month. In this case, retention for a given month is defined as the number of users who logged in that month who also logged in the immediately previous month. &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAWuRAY&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAxi9oE&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;DATE_TRUNC('month', a.date) month_timestamp, &lt;br /&gt;COUNT(DISTINCT a.user_id) retained_users &lt;br /&gt;FROM &lt;br /&gt;logins a &lt;br /&gt;JOIN &lt;br /&gt;logins b ON a.user_id = b.user_id &lt;br /&gt;AND DATE_TRUNC('month', a.date) = DATE_TRUNC('month', b.date) + &lt;br /&gt;interval '1 month'&lt;br /&gt;GROUP BY &lt;br /&gt;date_trunc('month', a.date)
&lt;/pre&gt;
&lt;p id=&quot;WbZACAq8yXy&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h3 id=&quot;WbZACA9RPd6&quot;&gt;Part 2: &lt;/h3&gt;
&lt;p id=&quot;WbZACAwDPdh&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Now we’ll take retention and turn it on its head: Write a query to find many users last month &lt;em&gt;did not&lt;/em&gt; come back this month. i.e. the number of churned users.  &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAOhqeC&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAChMNf&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;DATE_TRUNC('month', a.date) month_timestamp, &lt;br /&gt;COUNT(DISTINCT b.user_id) churned_users &lt;br /&gt;FROM &lt;br /&gt;logins a &lt;br /&gt;FULL OUTER JOIN &lt;br /&gt;logins b ON a.user_id = b.user_id &lt;br /&gt;AND DATE_TRUNC('month', a.date) = DATE_TRUNC('month', b.date) + &lt;br /&gt;interval '1 month'&lt;br /&gt;WHERE &lt;br /&gt;a.user_id IS NULL &lt;br /&gt;GROUP BY &lt;br /&gt;DATE_TRUNC('month', a.date)
&lt;/pre&gt;
&lt;p id=&quot;WbZACAbkCT2&quot; class=&quot;line&quot;&gt;Note that there are solutions to this problem that can use &lt;code&gt;LEFT&lt;/code&gt; or &lt;code&gt;RIGHT&lt;/code&gt; joins. &lt;/p&gt;
&lt;p id=&quot;WbZACADPwKT&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h3 id=&quot;WbZACARKazL&quot;&gt;Part 3: &lt;/h3&gt;
&lt;p id=&quot;WbZACAQ1jfR&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; this question is probably more complex than the kind you would encounter in an interview. Consider it a challenge problem, or feel free to skip it!&lt;/p&gt;
&lt;p id=&quot;WbZACAkeN7g&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACArmmto&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context&lt;/strong&gt;: Good work on the previous two problems! Data engineering has decided to give you a helping hand by creating a table of churned users per month, &lt;code&gt;user_churns&lt;/code&gt;. If a user is active last month but then not active this month, then that user gets an entry for this month. &lt;code&gt;user_churns&lt;/code&gt; has the form: &lt;/p&gt;
&lt;pre id=&quot;WbZACA6ywjN&quot; class=&quot;prettyprint&quot;&gt;
| user_id | month_date |&lt;br /&gt;|---------|------------|&lt;br /&gt;| 1       | 2018-05-01 |&lt;br /&gt;| 234     | 2018-05-01 |&lt;br /&gt;| 3       | 2018-05-01 |&lt;br /&gt;| 12      | 2018-05-01 |&lt;br /&gt;| ...     | ...        |&lt;br /&gt;| 234     | 2018-10-01 |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAKCozB&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACA3TlrM&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task&lt;/strong&gt;: You now want to do a cohort analysis of active users this month &lt;em&gt;who have been reactivated users in the past&lt;/em&gt;. Create a table that contains these users. You may use the tables &lt;code&gt;user_churns&lt;/code&gt; as well as &lt;code&gt;logins&lt;/code&gt; to create this cohort. In Postgres, the current timestamp is available through &lt;code&gt;current_timestamp&lt;/code&gt;.&lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAVoJNy&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAaoccP&quot; class=&quot;prettyprint&quot;&gt;
WITH user_login_data AS &lt;br /&gt;(&lt;br /&gt;SELECT &lt;br /&gt;DATE_TRUNC('month', a.date) month_timestamp,&lt;br /&gt;a.user_id,&lt;br /&gt;/* &lt;br /&gt;* At least in the flavors of SQL I have used, you don't need to &lt;br /&gt;* include the columns used in HAVING in the SELECT statement.&lt;br /&gt;* I have written them out for clarity here.  &lt;br /&gt;*/ &lt;br /&gt;MAX(b.month_date) as most_recent_churn, &lt;br /&gt;MAX(DATE_TRUNC('month', c.date)) as most_recent_active &lt;br /&gt;FROM &lt;br /&gt;logins a&lt;br /&gt;JOIN &lt;br /&gt;user_churns b &lt;br /&gt;ON a.user_id = b.user_id AND DATE_TRUNC('month', a.date) &amp;gt; b.month_date &lt;br /&gt;JOIN&lt;br /&gt;logins c &lt;br /&gt;ON a.user_id = c.user_id &lt;br /&gt;AND &lt;br /&gt;DATE_TRUNC('month', a.date) &amp;gt; DATE_TRUNC('month', c.date)&lt;br /&gt;WHERE &lt;br /&gt;DATE_TRUNC('month', a.date) = DATE_TRUNC('month', current_timestamp)&lt;br /&gt;GROUP BY &lt;br /&gt;DATE_TRUNC('month', a.date),&lt;br /&gt;a.user_id&lt;br /&gt;HAVING &lt;br /&gt;most_recent_churn &amp;gt; most_recent_active
&lt;/pre&gt;
&lt;p id=&quot;WbZACAOh4wk&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAdSqab&quot;&gt;#4: Cumulative Sums &lt;/h2&gt;
&lt;p id=&quot;WbZACAgc50C&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement:&lt;/strong&gt; This problem was inspired by Sisense’s &lt;a href=&quot;https://www.sisense.com/blog/cash-flow-modeling-in-sql/&quot; rel=&quot;nofollow&quot;&gt;“Cash Flow modeling in SQL”&lt;/a&gt; blog post &lt;/p&gt;
&lt;p id=&quot;WbZACAb0EeT&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAQdgIy&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have a table &lt;code&gt;transactions&lt;/code&gt; in the form:&lt;/p&gt;
&lt;pre id=&quot;WbZACAqPz1F&quot; class=&quot;prettyprint&quot;&gt;
| date       | cash_flow |&lt;br /&gt;|------------|-----------|&lt;br /&gt;| 2018-01-01 | -1000     |&lt;br /&gt;| 2018-01-02 | -100      |&lt;br /&gt;| 2018-01-03 | 50        |&lt;br /&gt;| ...        | ...       |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAQKnVe&quot; class=&quot;line&quot;&gt;Where &lt;code&gt;cash_flow&lt;/code&gt; is the revenues minus costs for each day. &lt;/p&gt;
&lt;p id=&quot;WbZACAm2RSk&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAxYnf4&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query to get &lt;em&gt;cumulative&lt;/em&gt; cash flow for each day such that we end up with a table in the form below: &lt;/p&gt;
&lt;pre id=&quot;WbZACAPy9st&quot; class=&quot;prettyprint&quot;&gt;
| date       | cumulative_cf |&lt;br /&gt;|------------|---------------|&lt;br /&gt;| 2018-01-01 | -1000         |&lt;br /&gt;| 2018-01-02 | -1100         |&lt;br /&gt;| 2018-01-03 | -1050         |&lt;br /&gt;| ...        | ...           |
&lt;/pre&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAx7zQq&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAmZzIp&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;a.date date, &lt;br /&gt;SUM(b.cash_flow) as cumulative_cf &lt;br /&gt;FROM&lt;br /&gt;transactions a&lt;br /&gt;JOIN b &lt;br /&gt;transactions b ON a.date &amp;gt;= b.date &lt;br /&gt;GROUP BY &lt;br /&gt;a.date &lt;br /&gt;ORDER BY &lt;br /&gt;date ASC
&lt;/pre&gt;
&lt;p id=&quot;WbZACAPIxVe&quot; class=&quot;line&quot;&gt;Alternate solution using a window function (more efficient!):  &lt;/p&gt;
&lt;pre id=&quot;WbZACASSFmF&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;date, &lt;br /&gt;SUM(cash_flow) OVER (ORDER BY date ASC) as cumulative_cf &lt;br /&gt;FROM&lt;br /&gt;transactions &lt;br /&gt;ORDER BY &lt;br /&gt;date ASC
&lt;/pre&gt;
&lt;h2 id=&quot;WbZACAlWjP5&quot;&gt;#5: Rolling Averages &lt;/h2&gt;
&lt;p id=&quot;WbZACAiPPm9&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement:&lt;/strong&gt; This problem is adapted from Sisense’s &lt;a href=&quot;https://www.sisense.com/blog/rolling-average/&quot; rel=&quot;nofollow&quot;&gt;“Rolling Averages in MySQL and SQL Server”&lt;/a&gt; blog post &lt;/p&gt;
&lt;p id=&quot;WbZACAzqvSn&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAFRykT&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; there are different ways to compute rolling/moving averages. Here we'll use a preceding average which means that the metric for the 7th day of the month would be the average of the preceding 6 days and that day itself. &lt;/p&gt;
&lt;p id=&quot;WbZACA7ydQB&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACA7Ywn5&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context&lt;/strong&gt;: Say we have table &lt;code&gt;signups&lt;/code&gt; in the form: &lt;/p&gt;
&lt;pre id=&quot;WbZACAWuh21&quot; class=&quot;prettyprint&quot;&gt;
| date       | sign_ups |&lt;br /&gt;|------------|----------|&lt;br /&gt;| 2018-01-01 | 10       |&lt;br /&gt;| 2018-01-02 | 20       |&lt;br /&gt;| 2018-01-03 | 50       |&lt;br /&gt;| ...        | ...      |&lt;br /&gt;| 2018-10-01 | 35       |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAHDmEy&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task&lt;/strong&gt;: Write a query to get 7-day rolling (preceding) average of daily sign ups. &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACA4moE8&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACA36xd8&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;a.date, &lt;br /&gt;AVG(b.sign_ups) average_sign_ups &lt;br /&gt;FROM &lt;br /&gt;signups a &lt;br /&gt;JOIN &lt;br /&gt;signups b ON a.date &amp;lt;= b.date + interval '6 days' AND a.date &amp;gt;= b.date&lt;br /&gt;GROUP BY &lt;br /&gt;a.date
&lt;/pre&gt;
&lt;p id=&quot;WbZACA56Oot&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAKDZyA&quot;&gt;#6: Multiple Join Conditions &lt;/h2&gt;
&lt;p id=&quot;WbZACA0UcqK&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement:&lt;/strong&gt; This problem was inspired by Sisense’s &lt;a href=&quot;https://www.sisense.com/blog/analyzing-your-email-with-sql/&quot; rel=&quot;nofollow&quot;&gt;“Analyzing Your Email with SQL”&lt;/a&gt; blog post &lt;/p&gt;
&lt;p id=&quot;WbZACA1Kdax&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAVbVbs&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have a table &lt;code&gt;emails&lt;/code&gt; that includes emails sent to and from &lt;a href=&quot;mailto:zach@g.com&quot; rel=&quot;nofollow&quot;&gt;&lt;code&gt;zach@g.com&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre id=&quot;WbZACAH4EWP&quot; class=&quot;prettyprint&quot;&gt;
| id | subject  | from         | to           | timestamp           |&lt;br /&gt;|----|----------|--------------|--------------|---------------------|&lt;br /&gt;| 1  | Yosemite | zach@g.com   | thomas@g.com | 2018-01-02 12:45:03 |&lt;br /&gt;| 2  | Big Sur  | sarah@g.com  | thomas@g.com | 2018-01-02 16:30:01 |&lt;br /&gt;| 3  | Yosemite | thomas@g.com | zach@g.com   | 2018-01-02 16:35:04 |&lt;br /&gt;| 4  | Running  | jill@g.com   | zach@g.com   | 2018-01-03 08:12:45 |&lt;br /&gt;| 5  | Yosemite | zach@g.com   | thomas@g.com | 2018-01-03 14:02:01 |&lt;br /&gt;| 6  | Yosemite | thomas@g.com | zach@g.com   | 2018-01-03 15:01:05 |&lt;br /&gt;| .. | ..       | ..           | ..           | ..                  |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAUBDfD&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task: &lt;/strong&gt;Write a query to get the response time per email (&lt;code&gt;id&lt;/code&gt;) sent to &lt;code&gt;zach@g.com&lt;/code&gt; . Do not include &lt;code&gt;id&lt;/code&gt;s that did not receive a response from &lt;a href=&quot;mailto:zach@g.com&quot; rel=&quot;nofollow&quot;&gt;zach@g.com&lt;/a&gt;. Assume each email thread has a unique subject. Keep in mind a thread may have multiple responses back-and-forth between &lt;a href=&quot;mailto:zach@g.com&quot; rel=&quot;nofollow&quot;&gt;zach@g.com&lt;/a&gt; and another email address. &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAV1hNT&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAMuKoa&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;a.id, &lt;br /&gt;MIN(b.timestamp) - a.timestamp as time_to_respond &lt;br /&gt;FROM &lt;br /&gt;emails a &lt;br /&gt;JOIN&lt;br /&gt;emails b &lt;br /&gt;ON &lt;br /&gt;b.subject = a.subject &lt;br /&gt;AND &lt;br /&gt;a.to = b.from&lt;br /&gt;AND &lt;br /&gt;a.from = b.to &lt;br /&gt;AND &lt;br /&gt;a.timestamp &amp;lt; b.timestamp &lt;br /&gt;WHERE &lt;br /&gt;a.to = 'zach@g.com' &lt;br /&gt;GROUP BY &lt;br /&gt;a.id 
&lt;/pre&gt;
&lt;p id=&quot;WbZACANxGDp&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;

&lt;h2 id=&quot;WbZACAhKm2A&quot;&gt;#1: Get the ID with the highest value &lt;/h2&gt;
&lt;p id=&quot;WbZACAjlA4Z&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have a table &lt;code&gt;salaries&lt;/code&gt; with data on employee salary and department in the following format: &lt;/p&gt;
&lt;pre id=&quot;WbZACAyyqOV&quot; class=&quot;prettyprint&quot;&gt;
  depname  | empno | salary |     &lt;br /&gt;-----------+-------+--------+&lt;br /&gt;develop   |    11 |   5200 | &lt;br /&gt;develop   |     7 |   4200 | &lt;br /&gt;develop   |     9 |   4500 | &lt;br /&gt;develop   |     8 |   6000 | &lt;br /&gt;develop   |    10 |   5200 | &lt;br /&gt;personnel |     5 |   3500 | &lt;br /&gt;personnel |     2 |   3900 | &lt;br /&gt;sales     |     3 |   4800 | &lt;br /&gt;sales     |     1 |   5000 | &lt;br /&gt;sales     |     4 |   4800 | 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAxKPaU&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task&lt;/strong&gt;: Write a query to get the &lt;code&gt;empno&lt;/code&gt; with the highest salary. Make sure your solution can handle ties!&lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAksCAJ&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACArL9JY&quot; class=&quot;prettyprint&quot;&gt;
WITH max_salary AS (&lt;br /&gt;SELECT &lt;br /&gt;MAX(salary) max_salary&lt;br /&gt;FROM &lt;br /&gt;&lt;code&gt;salaries&lt;br /&gt;)&lt;br /&gt;SELECT &lt;br /&gt;s.empno&lt;br /&gt;FROM &lt;br /&gt;&lt;code&gt;salaries s&lt;br /&gt;JOIN &lt;br /&gt;max_salary ms ON s.salary = ms.max_salary &lt;/code&gt;&lt;/code&gt;
&lt;/pre&gt;
&lt;p id=&quot;WbZACAY4cPT&quot; class=&quot;line&quot;&gt;Alternate solution using &lt;code&gt;RANK()&lt;/code&gt;:&lt;/p&gt;
&lt;pre id=&quot;WbZACANc5ER&quot; class=&quot;prettyprint&quot;&gt;
WITH sal_rank AS &lt;br /&gt;(SELECT &lt;br /&gt;empno, &lt;br /&gt;RANK() OVER(ORDER BY salary DESC) rnk&lt;br /&gt;FROM &lt;br /&gt;salaries)&lt;br /&gt;SELECT &lt;br /&gt;empno&lt;br /&gt;FROM&lt;br /&gt;sal_rank&lt;br /&gt;WHERE &lt;br /&gt;rnk = 1;
&lt;/pre&gt;
&lt;p id=&quot;WbZACA36njt&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAk945J&quot;&gt;#2: Average and rank with a window function (multi-part)&lt;/h2&gt;
&lt;h3 id=&quot;WbZACArXBcA&quot;&gt;Part 1:&lt;/h3&gt;
&lt;p id=&quot;WbZACAbHXUD&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context&lt;/strong&gt;: Say we have a table &lt;code&gt;salaries&lt;/code&gt; in the format:&lt;/p&gt;
&lt;pre id=&quot;WbZACAN0UN4&quot; class=&quot;prettyprint&quot;&gt;
  depname  | empno | salary |     &lt;br /&gt;-----------+-------+--------+&lt;br /&gt;develop   |    11 |   5200 | &lt;br /&gt;develop   |     7 |   4200 | &lt;br /&gt;develop   |     9 |   4500 | &lt;br /&gt;develop   |     8 |   6000 | &lt;br /&gt;develop   |    10 |   5200 | &lt;br /&gt;personnel |     5 |   3500 | &lt;br /&gt;personnel |     2 |   3900 | &lt;br /&gt;sales     |     3 |   4800 | &lt;br /&gt;sales     |     1 |   5000 | &lt;br /&gt;sales     |     4 |   4800 | 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAJ1gkH&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query that returns the same table, but with a new column that has average salary per &lt;code&gt;depname&lt;/code&gt;. We would expect a table in the form: &lt;/p&gt;
&lt;pre id=&quot;WbZACAGrGMn&quot; class=&quot;prettyprint&quot;&gt;
  depname  | empno | salary | avg_salary |     &lt;br /&gt;-----------+-------+--------+------------+&lt;br /&gt;develop   |    11 |   5200 |       5020 |&lt;br /&gt;develop   |     7 |   4200 |       5020 | &lt;br /&gt;develop   |     9 |   4500 |       5020 |&lt;br /&gt;develop   |     8 |   6000 |       5020 | &lt;br /&gt;develop   |    10 |   5200 |       5020 | &lt;br /&gt;personnel |     5 |   3500 |       3700 |&lt;br /&gt;personnel |     2 |   3900 |       3700 |&lt;br /&gt;sales     |     3 |   4800 |       4867 | &lt;br /&gt;sales     |     1 |   5000 |       4867 | &lt;br /&gt;sales     |     4 |   4800 |       4867 |
&lt;/pre&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAuMBN6&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAt5ovh&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;*, &lt;br /&gt;/*&lt;br /&gt;* AVG() is a Postgres command, but other SQL flavors like BigQuery use &lt;br /&gt;* AVERAGE()&lt;br /&gt;*/ &lt;br /&gt;ROUND(AVG(salary),0) OVER (PARTITION BY depname) avg_salary&lt;br /&gt;FROM&lt;br /&gt;salaries
&lt;/pre&gt;
&lt;h3 id=&quot;WbZACABG8V6&quot;&gt;Part 2:&lt;/h3&gt;
&lt;p id=&quot;WbZACAaqw3U&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query that adds a column with the rank of each employee based on their salary within their department, where the employee with the highest salary gets the rank of &lt;code&gt;1&lt;/code&gt;. We would expect a table in the form: &lt;/p&gt;
&lt;pre id=&quot;WbZACAHjp03&quot; class=&quot;prettyprint&quot;&gt;
  depname  | empno | salary | salary_rank |     &lt;br /&gt;-----------+-------+--------+-------------+&lt;br /&gt;develop   |    11 |   5200 |           2 |&lt;br /&gt;develop   |     7 |   4200 |           5 | &lt;br /&gt;develop   |     9 |   4500 |           4 |&lt;br /&gt;develop   |     8 |   6000 |           1 | &lt;br /&gt;develop   |    10 |   5200 |           2 | &lt;br /&gt;personnel |     5 |   3500 |           2 |&lt;br /&gt;personnel |     2 |   3900 |           1 |&lt;br /&gt;sales     |     3 |   4800 |           2 | &lt;br /&gt;sales     |     1 |   5000 |           1 | &lt;br /&gt;sales     |     4 |   4800 |           2 | 
&lt;/pre&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAhRWoo&quot; class=&quot;line&quot;&gt;&lt;strong&gt;&lt;em&gt;Solution:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAG4vmb&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;*, &lt;br /&gt;RANK() OVER(PARTITION BY depname ORDER BY salary DESC) salary_rank&lt;br /&gt;FROM  &lt;br /&gt;salaries 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAFoM9N&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;

&lt;h2 id=&quot;WbZACAnkw5c&quot;&gt;#1: Histograms &lt;/h2&gt;
&lt;p id=&quot;WbZACAWfACW&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have a table &lt;code&gt;sessions&lt;/code&gt; where each row is a video streaming session with length in seconds: &lt;/p&gt;
&lt;pre id=&quot;WbZACAd28AR&quot; class=&quot;prettyprint&quot;&gt;
| session_id | length_seconds |&lt;br /&gt;|------------|----------------|&lt;br /&gt;| 1          | 23             |&lt;br /&gt;| 2          | 453            |&lt;br /&gt;| 3          | 27             |&lt;br /&gt;| ..         | ..             |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAMrakB&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query to count the number of sessions that fall into bands of size 5, i.e. for the above snippet, produce something akin to: &lt;/p&gt;
&lt;pre id=&quot;WbZACAdYpXc&quot; class=&quot;prettyprint&quot;&gt;
| bucket  | count |&lt;br /&gt;|---------|-------|&lt;br /&gt;| 20-25   | 2     |&lt;br /&gt;| 450-455 | 1     |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAFLowa&quot; class=&quot;line&quot;&gt;Get complete credit for the proper string labels (“5-10”, etc.) but near complete credit for something that is communicable as the bin. &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAcJWFx&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACArexZW&quot; class=&quot;prettyprint&quot;&gt;
WITH bin_label AS &lt;br /&gt;(SELECT &lt;br /&gt;session_id, &lt;br /&gt;FLOOR(length_seconds/5) as bin_label &lt;br /&gt;FROM&lt;br /&gt;sessions &lt;br /&gt;)&lt;br /&gt;SELECT &lt;br /&gt;&lt;code&gt;CONCATENTATE(STR(bin_label*5), '-', STR(&lt;/code&gt;bin_label*5+5)) bucket, &lt;br /&gt;COUNT(DISTINCT session_id) count &lt;br /&gt;GROUP BY &lt;br /&gt;bin_label&lt;br /&gt;ORDER BY &lt;br /&gt;&lt;code&gt;bin_label ASC &lt;/code&gt;
&lt;/pre&gt;
&lt;p id=&quot;WbZACA8jwjO&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACA0JsbB&quot;&gt;#2: CROSS JOIN (multi-part)&lt;/h2&gt;
&lt;h3 id=&quot;WbZACAT1YzD&quot;&gt;Part 1: &lt;/h3&gt;
&lt;p id=&quot;WbZACAxl8X7&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say we have a table &lt;code&gt;state_streams&lt;/code&gt; where each row is a state and the total number of hours of streaming from a video hosting service: &lt;/p&gt;
&lt;pre id=&quot;WbZACAtARuj&quot; class=&quot;prettyprint&quot;&gt;
| state | total_streams |&lt;br /&gt;|-------|---------------|&lt;br /&gt;| NC    | 34569         |&lt;br /&gt;| SC    | 33999         |&lt;br /&gt;| CA    | 98324         |&lt;br /&gt;| MA    | 19345         |&lt;br /&gt;| ..    | ..            |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAaXXip&quot; class=&quot;line&quot;&gt;(In reality these kinds of aggregate tables would normally have a date column, but we’ll exclude that component in this problem) &lt;/p&gt;
&lt;p id=&quot;WbZACAkJvFA&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAUqV1W&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Write a query to get the pairs of states with total streaming amounts within 1000 of each other. For the snippet above, we would want to see something like:&lt;/p&gt;
&lt;pre id=&quot;WbZACAnRsmJ&quot; class=&quot;prettyprint&quot;&gt;
| state_a | state_b |&lt;br /&gt;|---------|---------|&lt;br /&gt;| NC      | SC      |&lt;br /&gt;| SC      | NC      |
&lt;/pre&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACA1Hks1&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAAnMOw&quot; class=&quot;prettyprint&quot;&gt;
SELECT&lt;br /&gt;a.state as state_a, &lt;br /&gt;b.state as state_b &lt;br /&gt;FROM   &lt;br /&gt;state_streams a&lt;br /&gt;CROSS JOIN &lt;br /&gt;state_streams b &lt;br /&gt;WHERE &lt;br /&gt;ABS(a.total_streams - b.total_streams) &amp;lt; 1000&lt;br /&gt;AND &lt;br /&gt;a.state &amp;lt;&amp;gt; b.state 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAFCMoB&quot; class=&quot;line&quot;&gt;FYI, &lt;code&gt;CROSS JOIN&lt;/code&gt; s can also be written without explicitly specifying a join: &lt;/p&gt;
&lt;pre id=&quot;WbZACAbq0yv&quot; class=&quot;prettyprint&quot;&gt;
SELECT&lt;br /&gt;a.state as state_a, &lt;br /&gt;b.state as state_b &lt;br /&gt;FROM   &lt;br /&gt;state_streams a, state_streams b &lt;br /&gt;WHERE &lt;br /&gt;ABS(a.total_streams - b.total_streams) &amp;lt; 1000&lt;br /&gt;AND &lt;br /&gt;a.state &amp;lt;&amp;gt; b.state 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAPZ7B1&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h3 id=&quot;WbZACA8F4Vg&quot;&gt;Part 2: &lt;/h3&gt;
&lt;p id=&quot;WbZACAe56nk&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; This question is considered more of a bonus problem than an actual SQL pattern. Feel free to skip it!&lt;/p&gt;
&lt;p id=&quot;WbZACAy0MA8&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAuWGFB&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; How could you modify the SQL from the solution to Part 1 of this question so that duplicates are removed? For example, if we used the sample table from Part 1, the pair &lt;code&gt;NC&lt;/code&gt; and &lt;code&gt;SC&lt;/code&gt; should only appear in one row instead of two. &lt;/p&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACASijjd&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution: &lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACAxhLHo&quot; class=&quot;prettyprint&quot;&gt;
SELECT&lt;br /&gt;a.state as state_a, &lt;br /&gt;b.state as state_b &lt;br /&gt;FROM   &lt;br /&gt;state_streams a, state_streams b &lt;br /&gt;WHERE &lt;br /&gt;ABS(a.total_streams - b.total_streams) &amp;lt; 1000&lt;br /&gt;AND &lt;br /&gt;a.state &amp;gt; b.state 
&lt;/pre&gt;
&lt;p id=&quot;WbZACAOVMBk&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;h2 id=&quot;WbZACAPLOLs&quot;&gt;#3: Advancing Counting &lt;/h2&gt;
&lt;p id=&quot;WbZACAlh0q7&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Acknowledgement:&lt;/strong&gt; This question is adapted from &lt;a href=&quot;https://stackoverflow.com/questions/54488894/using-case-to-properly-count-items-with-if-else-logic-in-sql&quot; rel=&quot;nofollow&quot;&gt;this Stack Overflow question&lt;/a&gt; by me (zthomas.nc) &lt;/p&gt;
&lt;p id=&quot;WbZACAEcqJN&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAchsMN&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; this question is probably more complex than the kind you would encounter in an interview. Consider it a challenge problem, or feel free to skip it! &lt;/p&gt;
&lt;p id=&quot;WbZACAhqnR8&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAfqLND&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Context:&lt;/strong&gt; Say I have a table &lt;code&gt;table&lt;/code&gt; in the following form, where a &lt;code&gt;user&lt;/code&gt; can be mapped to multiple values of &lt;code&gt;class&lt;/code&gt;:&lt;/p&gt;
&lt;pre id=&quot;WbZACAhJAXL&quot; class=&quot;prettyprint&quot;&gt;
| user | class |&lt;br /&gt;|------|-------|&lt;br /&gt;| 1    | a     |&lt;br /&gt;| 1    | b     |&lt;br /&gt;| 1    | b     |&lt;br /&gt;| 2    | b     |&lt;br /&gt;| 3    | a     |
&lt;/pre&gt;
&lt;p id=&quot;WbZACAQJhCc&quot; class=&quot;line&quot;&gt;&lt;strong&gt;Task:&lt;/strong&gt; Assume there are only two possible values for &lt;code&gt;class&lt;/code&gt;. Write a query to count the number of users in each class such that any user who has label &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; gets sorted into &lt;code&gt;b&lt;/code&gt;, any user with just &lt;code&gt;a&lt;/code&gt; gets sorted into &lt;code&gt;a&lt;/code&gt; and any user with just &lt;code&gt;b&lt;/code&gt; gets into &lt;code&gt;b&lt;/code&gt;. &lt;/p&gt;
&lt;p id=&quot;WbZACAPtHwO&quot; class=&quot;line&quot;&gt;​&lt;/p&gt;
&lt;p id=&quot;WbZACAuMGUI&quot; class=&quot;line&quot;&gt;For &lt;code&gt;table&lt;/code&gt; that would result in the following table: &lt;/p&gt;
&lt;pre id=&quot;WbZACA6bh3P&quot; class=&quot;prettyprint&quot;&gt;
| class | count |&lt;br /&gt;|-------|-------|&lt;br /&gt;| a     | 1     |&lt;br /&gt;| b     | 2     |
&lt;/pre&gt;
&lt;hr /&gt;&lt;p id=&quot;WbZACAno0xU&quot; class=&quot;line&quot;&gt;&lt;em&gt;&lt;strong&gt;Solution: &lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre id=&quot;WbZACA7lfAr&quot; class=&quot;prettyprint&quot; readability=&quot;9&quot;&gt;
WITH usr_b_sum AS &lt;br /&gt;(&lt;br /&gt;SELECT &lt;br /&gt;user, &lt;br /&gt;SUM(CASE WHEN class = 'b' THEN 1 ELSE 0 END) num_b&lt;br /&gt;FROM &lt;br /&gt;table&lt;br /&gt;GROUP BY &lt;br /&gt;user&lt;br /&gt;), &lt;p&gt;usr_class_label AS &lt;br /&gt;(&lt;br /&gt;SELECT &lt;br /&gt;user, &lt;br /&gt;CASE WHEN num_b &amp;gt; 0 THEN 'b' ELSE 'a' END class &lt;br /&gt;FROM &lt;br /&gt;usr_b_sum&lt;br /&gt;)&lt;/p&gt;&lt;p&gt;SELECT &lt;br /&gt;class, &lt;br /&gt;COUNT(DISTINCT user) count &lt;br /&gt;FROM&lt;br /&gt;usr_class_label&lt;br /&gt;GROUP BY &lt;br /&gt;class &lt;br /&gt;ORDER BY &lt;br /&gt;class ASC&lt;/p&gt;&lt;/pre&gt;
&lt;p id=&quot;WbZACA5sSI9&quot; class=&quot;line&quot;&gt;Alternate solution: Using &lt;code&gt;SELECT&lt;/code&gt;s in the &lt;code&gt;SELECT&lt;/code&gt; statement and &lt;code&gt;UNION&lt;/code&gt;: &lt;/p&gt;
&lt;pre id=&quot;WbZACAr1jJf&quot; class=&quot;prettyprint&quot;&gt;
SELECT &lt;br /&gt;&quot;a&quot; class,&lt;br /&gt;COUNT(DISTINCT user_id) - &lt;br /&gt;(SELECT COUNT(DISTINCT user_id) FROM table WHERE class = 'b') count &lt;br /&gt;UNION&lt;br /&gt;SELECT &lt;br /&gt;&quot;b&quot; class,&lt;br /&gt;(SELECT COUNT(DISTINCT user_id) FROM table WHERE class = 'b') count 
&lt;/pre&gt;</description>
<pubDate>Sat, 02 May 2020 18:51:23 +0000</pubDate>
<dc:creator>thomzi12</dc:creator>
<og:title>The Best Medium-Hard Data Analyst SQL Interview Questions</og:title>
<og:description>By Zachary Thomas (zthomas.nc@gmail.com, Twitter, LinkedIn) </og:description>
<og:url>https://quip.com/2gwZArKuWk7W</og:url>
<dc:format>text/html</dc:format>
<dc:identifier>https://quip.com/2gwZArKuWk7W?_escaped_fragment_=</dc:identifier>
</item>
<item>
<title>I shipped a word processor that formatted the hard drive every 1024 saves</title>
<link>https://twitter.com/geepawhill/status/1256342997643526151</link>
<guid isPermaLink="true" >https://twitter.com/geepawhill/status/1256342997643526151</guid>
<description>&lt;p&gt;I was looking at the 2k block about to be filled, and the last 1k was, idunno, *garbage*. That seemed odd, so I investigated it. Of course, it wasn't garbage, it was the 1024 bytes of the drive's master disk block, stashed next to my file master block by the operating system.&lt;/p&gt;
</description>
<pubDate>Sat, 02 May 2020 18:17:09 +0000</pubDate>
<dc:creator>todsacerdoti</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://mobile.twitter.com/GeePawHill/status/1256342997643526151</dc:identifier>
</item>
<item>
<title>Ubuntu 20.04 LTS’ snap obsession has snapped me off of it</title>
<link>https://jatan.blog/2020/05/02/ubuntu-snap-obsession-has-snapped-me-off-of-it/</link>
<guid isPermaLink="true" >https://jatan.blog/2020/05/02/ubuntu-snap-obsession-has-snapped-me-off-of-it/</guid>
<description>&lt;p&gt;Like everyone else, I got excited about the latest Ubuntu LTS release and installed it on day one. A week in, I’m sorry to say that I leave disappointed. The amount of unready &lt;em&gt;snap&lt;/em&gt; features being effectively forced onto users is affecting Ubuntu’s usability and user-friendliness.&lt;/p&gt;
&lt;div class=&quot;wp-block-image&quot;&gt;&lt;img src=&quot;https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg?w=640&quot; alt=&quot;&quot; class=&quot;wp-image-1378&quot; width=&quot;409&quot; height=&quot;230&quot; srcset=&quot;https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg?w=409 409w, https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg?w=200 200w, https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg?w=300 300w, https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg 640w&quot; sizes=&quot;(max-width: 409px) 100vw, 409px&quot;/&gt;&lt;/div&gt;
&lt;h2&gt;&lt;strong&gt;Software center can’t install Flatpak apps&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;In 20.04 LTS, Ubuntu’s Software Center was switched from being a .deb version of GNOME Software to a &lt;em&gt;snap&lt;/em&gt; app. The new snapped store can handle management of &lt;em&gt;snap&lt;/em&gt; applications and traditional .deb ones, but it can’t install or remove Flatpak applications, like the previous .deb version could.&lt;/p&gt;
&lt;p&gt;Users wanting to install Flatpak apps &lt;a href=&quot;https://jatan.blog/2020/04/25/how-to-install-flatpak-apps-on-ubuntu-20-04-lts/&quot;&gt;need to revert to using the .deb version&lt;/a&gt;. It’s not an ideal solution when previous Ubuntu Software releases could handle all three formats by default. In all, the latest Ubuntu Software is a step back.&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;Browsing the Snap Store sucks&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Even without Flatpak apps, I was expecting the snap store to at least do well what it is supposed to. It turns out it prioritizes snap apps over .deb in search results at any cost! So you’ll see a long list of non relevant search results of snap apps above .deb ones, even if your search term exactly matches the latter. -_-&lt;/p&gt;
&lt;p&gt;Needless to say this is a serious issue for discovering software, especially for new users. Given that app discovery is so central to consumer operating systems, I’m gonna say the new Ubuntu isn’t only a step back, but is borderline unreliable.&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;Slow and forced Chromium snap&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;On the latest Ubuntu, if you try to download the .deb version of Chromium using either the Software Store or command line, it acts as an alias to installing the snap version! Essentially, Chromium snap is shoved down your throat even if you explicitly asked for the .deb version. This is not cool Ubuntu – just because Chromium may be easier to maintain as a snap app doesn’t justify this forced behavior.&lt;/p&gt;
&lt;p&gt;Besides, a typical user doesn’t care how the app is managed in the backend, all they care about is how it works – snap apps are slow. I hate that Chromium’s snap takes more than 10 seconds to load on cold boot on a freaking SSD, whereas .deb and Flatpak apps load in 1-2 seconds. Snaps are simply not fast enough to be default anything yet.&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;No control over updates&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Snap applications auto-update and that’s fine if Ubuntu wants to keep systems secure. But it can’t even be turned off manually. Auto-updating of snaps can only be deferred at best, until at some point, like Windows, it auto-updates anyway. Even on metered connections, snaps auto-update anyway after some time.&lt;/p&gt;
&lt;p&gt;This is a deal breaker for people on limited bandwidth connections or who want to know exactly what they’re updating and when they’d like to. I never hold off updating my system for more than seven days in the worst case, but this auto-update snap thing is causing me issues like slowing down my connection abruptly and using a major chunk of my limited data for the day. My &lt;a href=&quot;https://discourse.ubuntu.com/t/is-ubuntu-software-going-to-be-remove-for-snap-snap-store/14542/25?u=uncertainquark&quot;&gt;discussion on the Ubuntu forums&lt;/a&gt; on the topic didn’t go well, read the &lt;em&gt;full thread&lt;/em&gt; if interested.&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;Closing thoughts&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;Ubuntu was my first Linux-based operating system and is what attracted me to the ecosystem. I have a soft spot for it, especially the amazing Unity days. As such, it is disappointing to see this snap obsession that has taken over Ubuntu. An OS once lauded for its sane defaults and user friendliness is actively going against the user’s will. &lt;/p&gt;
&lt;p&gt;What’s especially concerning is that this is the Ubuntu version that millions of people will use for at least two years. I don’t hate snaps but being forced to use it when clearly in a premature state is forcing me to hate it. Snaps simply aren’t ready for system-wide daily usage and Ubuntu should’ve known better. Perhaps Ubuntu should’ve created a separate snap-based OS image, like Fedora’s &lt;a href=&quot;https://fedoramagazine.org/what-is-silverblue/&quot;&gt;Silverblue&lt;/a&gt;, and only swap the default when it’s ready.&lt;/p&gt;
&lt;p&gt;Ubuntu 20.04 LTS’ snap obsession has snapped me off of it. I switched to &lt;a href=&quot;https://elementary.io/&quot;&gt;elementary OS&lt;/a&gt; a year ago as my primary OS but Ubuntu is still the most used by newcomers and so it’s an issue. I installed &lt;a href=&quot;https://blog.system76.com/post/616861064165031936/whats-new-with-popos-2004-lts&quot;&gt;Pop!_OS 20.04 LTS&lt;/a&gt; just yesterday, hoping to get a better out of the box experience. I’ll log back with thoughts about it next week.&lt;/p&gt;

</description>
<pubDate>Sat, 02 May 2020 14:53:55 +0000</pubDate>
<dc:creator>uncertainquark</dc:creator>
<og:type>article</og:type>
<og:title>Ubuntu 20.04 LTS’ snap obsession has snapped me off of it</og:title>
<og:url>https://jatan.blog/2020/05/02/ubuntu-snap-obsession-has-snapped-me-off-of-it/</og:url>
<og:description>Once lauded for its sane defaults, the latest Ubuntu release has usability issues.</og:description>
<og:image>https://uncertainquarkhome.files.wordpress.com/2020/05/ubuntu-snap.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://jatan.blog/2020/05/02/ubuntu-snap-obsession-has-snapped-me-off-of-it/</dc:identifier>
</item>
<item>
<title>How to sell a B2B product</title>
<link>https://calv.info/how-to-sell-b2b</link>
<guid isPermaLink="true" >https://calv.info/how-to-sell-b2b</guid>
<description>&lt;p&gt;Lately, a bunch of early stage founders have emailed me to ask for go-to-market (GTM) advice. They have a real product, it solves a real problem for their handful of customers…&lt;/p&gt;
&lt;p&gt;&lt;em&gt;…so why isn’t it selling?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;It’s a problem faced by nearly every single technical founder I talk to.&lt;/p&gt;
&lt;p&gt;The unfortunate truth is that the first year of sales will tend to make or break the company. Sales provides the initial momentum for a startup to survive. It’s the difference between a Series A, and an &lt;a href=&quot;https://ourincrediblejourney.tumblr.com/&quot;&gt;Our Incredible Journey&lt;/a&gt; Medium post.&lt;/p&gt;
&lt;p&gt;The trouble is… I’ve always felt at a bit of a loss when asked for sales advice.&lt;/p&gt;
&lt;p&gt;I’ve worked way more on the product and tech side. Until recently, I’d never had a strong framework for understanding how sales actually works.&lt;/p&gt;
&lt;p&gt;That changed after I recently attended a two-day sales training. Our CRO hired a consulting firm called &lt;a href=&quot;https://www.forcemanagement.com/&quot;&gt;Force Management&lt;/a&gt; (&lt;em&gt;I know, I know, it sounds like soul-crushing corporate training, but bear with me&lt;/em&gt;) to teach all of our GTM teams about sales. I was fortunate enough to sit in.&lt;/p&gt;
&lt;p&gt;Candidly, I was impressed by everything the instructors taught us. They were handing me the exact answers to the questions these founders were asking me for.&lt;/p&gt;
&lt;p&gt;My goal in this post is to relay all of those learnings as concrete advice for early stage founders. By reading it, you should be armed with the framework you need to sell a SaaS product to other businesses (and have a view into the enterprise).&lt;/p&gt;
&lt;p&gt;We’ve gotten Segment surprisingly far without having any of this sort of framework. But frankly, I wish we’d known this much earlier on. There’s no reason not to be great at this from day one.&lt;/p&gt;
&lt;p&gt;Without further ado; here’s everything I’ve learned when it comes to selling a B2B product.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_YCoBsVolsigzIBTw.png&quot;/&gt;&lt;p&gt;Before getting into tactics, I want to spend a minute on the importance of sales, particularly in the enterprise.&lt;/p&gt;
&lt;p&gt;I used to think that “products just sell themselves”. A great product naturally spreads like wildfire.&lt;/p&gt;
&lt;p&gt;I’ve since realized that I was dead wrong. A great product may be the backbone of a company, but it’s not sufficient all on it’s own. Here’s why.&lt;/p&gt;
&lt;p&gt;Think about all of the products you buy today… food, gas, coffee. For the most part, these products are &lt;em&gt;commodities.&lt;/em&gt; The cost of the good is dictated by the raw ingredients and the competition; maybe there’s some markup for additional quality.&lt;/p&gt;
&lt;p&gt;What that means is that you might encounter a $5 cup of coffee on your morning commute… but a $50 cup of coffee would be unheard of.&lt;/p&gt;
&lt;p&gt;Now in the enterprise, these rules go out the window&lt;em&gt;.&lt;/em&gt; For most SaaS business, the cost to deliver your product rounds down to zero[1]. The infrastructure used to run our Salesforce instance probably costs somewhere on the order of $100 per month. Yet, they charge us tens of thousands of dollars per month… how?&lt;/p&gt;
&lt;p&gt;In enterprise software, customers pay for software based upon the &lt;strong&gt;value that software provides, not the cost to deliver or build that software.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The same product can be sold for $50, or $5,000,000–and the price comes down to &lt;strong&gt;how much value the buyer is getting&lt;/strong&gt; from the software. As long as the buyer sees it as a positive return on investment, it’s worth it to pay the price.&lt;/p&gt;
&lt;p&gt;A great salesperson steers the conversation towards that value. If you’re not anchoring against the value, you are literally leaving money on the table.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_8mefjmplpGdwXy3y.png&quot;/&gt;&lt;p&gt;The first lesson in sales is: don't think of it as sales.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;...wait...what?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;When I think of salespeople… I typically think of people &lt;em&gt;without&lt;/em&gt; my best interests at heart. They’re trying to close the deal. They don’t really know or care about the things I want.&lt;/p&gt;
&lt;p&gt;Honestly, this rule applies to 99% of sales interactions I’ve had. Why shouldn’t this stereotype hold if I’m talking to someone trying to sell me something?&lt;/p&gt;
&lt;p&gt;Don’t be that 99% of my inbox.&lt;/p&gt;
&lt;p&gt;When selling, you have to approach the discussion from a totally different mindset all together. Great sales isn’t about closing the deal… it starts with understanding the customer.&lt;/p&gt;
&lt;p&gt;Don’t think of yourself as constantly trying to pitch them on your company. Instead, think of yourself as a consultant or a trusted advisor. You’re trying to help the customer get the outcome they want &lt;em&gt;(and maybe that’s not buying your product!)&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Getting there requires two key skills: 1) actually listening to the business needs and 2) demonstrating that you’re listening.&lt;/p&gt;
&lt;p&gt;To do this, I’ve seen a few different tactics be effective&lt;/p&gt;
&lt;ul readability=&quot;12.5&quot;&gt;&lt;li readability=&quot;7&quot;&gt;
&lt;p&gt;&lt;strong&gt;Do your homework:&lt;/strong&gt; read 10-Qs, earnings reports, and press briefings. Try out the product or service, and see what customers are saying. Look at reviews on G2Crowd, Capiche, and Yelp. Have an idea of what matters to your customer before that first call. Companies (especially public ones) put out a ton of information on what they want to get done. It’s on you to find it.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;3&quot;&gt;
&lt;p&gt;&lt;strong&gt;Ask “what does success look like?”:&lt;/strong&gt; anyone considering buying a tool will have an idea of what they want to get out of it. There’s likely some quarterly goal that they want to achieve, or some metric that they want to impact. It’s a great idea to understand what matters most to the customer.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;7&quot;&gt;
&lt;p&gt;&lt;strong&gt;Tie back to a business objective:&lt;/strong&gt; at the end of the day, businesses traditionally value just a handful of things: increased revenue, decreased cost, reduced risk, or time to outcome. It’s worth understanding what the overall goals for the business are here, because your product should support one of those top-level goals. Saying “we have a better UI” doesn’t really paint the ROI story that you need.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;&lt;strong&gt;Write it all down:&lt;/strong&gt; there's one big commonality between our best salespeople: they are &lt;em&gt;constantly&lt;/em&gt; taking notes in a notebook. No one will object to you taking notes—and it’s a key way to remember exactly what the customer said. You’ll want to use these notes in follow-up emails and conversations. It’s really easy to do and makes you seem like a pro.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;At the end of the day, selling well means that you are helping the customer actually understand their problem, and the path to evaluate a solution. Don’t sell, consult!&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_XgUd444OzzC437ah.png&quot;/&gt;&lt;p&gt;Okay, once you’ve started learning about what the customer cares about, you need to get a first meeting with them.&lt;/p&gt;
&lt;p&gt;I’ve historically seen two ways work well for this, inbound and outbound.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Inbound&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Getting customers coming to you means that you first have to put something interesting out there.&lt;/p&gt;
&lt;p&gt;When it comes to content, my #1 rule for this is &lt;strong&gt;teach people something they didn’t already know&lt;/strong&gt;. It has to be non-obvious, and combine some set of deep research or your own data.&lt;/p&gt;
&lt;p&gt;A good rule of thumb is asking yourself “do I wish I’d read this post six months ago?” It’s easy to become “too familiar” with content that’s actually really interesting.&lt;/p&gt;
&lt;p&gt;Priceonomics has the definitive guide on building out interesting content, so if you want to go this route, check them out first: &lt;a href=&quot;https://priceonomics.com/the-content-marketing-handbook/&quot;&gt;The Content Marketing Handbook&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I’ll warn you right now that inbound is going to be a slower path. But it’s far more likely to succeed for some audiences (developers in particular).&lt;/p&gt;
&lt;p&gt;In &lt;a href=&quot;https://segment.com/blog/show-hn-to-series-d/&quot;&gt;the early days&lt;/a&gt;, we grew Segment by:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Outbound&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If you need a faster path to getting users (or your market requires it), you may have to rely more on cold emails.&lt;/p&gt;
&lt;p&gt;As a rule, most people &lt;em&gt;hate&lt;/em&gt; getting outbound emails. I certainly do (&lt;em&gt;we actually used to have a rule at Segment that we didn’t send outbound emails ever).&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Most outbound emails I get aren’t personalized. Best case, they feel like spam, worst case, they are downright annoying. I archive almost all of them immediately.&lt;/p&gt;
&lt;p&gt;I’ve since come around a bit, mainly because I’ve realized: &lt;em&gt;outbound emails don't have to suck&lt;/em&gt;. A few ground rules:&lt;/p&gt;
&lt;ul readability=&quot;8.5&quot;&gt;&lt;li readability=&quot;3&quot;&gt;
&lt;p&gt;&lt;strong&gt;Do your homework:&lt;/strong&gt; sound familiar? Make sure that you’ve researched the person you’re emailing. Look at LinkedIn, Twitter, recent talks they’ve given. Make sure you can put yourself in their shoes.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;2&quot;&gt;
&lt;p&gt;&lt;strong&gt;20 emails are better than 1,000:&lt;/strong&gt; I’ve found time-and-time-again that a handful of emails are better than a random blast. If you need early user feedback, focus on those few users you really want.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;5&quot;&gt;
&lt;p&gt;&lt;strong&gt;Answer: Why me? Why now?&lt;/strong&gt; If I'm going to get an email from you, you have to make it clear that you’ve done your homework. You have to mention something that’s both relevant to me, and explain why you’re emailing now. &lt;em&gt;e.g. I saw your talk on handling outages, and it got me thinking about entrypoints. I realized that there should be some sort of tool to make those more apparent. We’ve built a first version that I’d love to show you. It incorporates your feedback of …&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;&lt;strong&gt;Get an intro&lt;/strong&gt; so many of the founders I talk to don’t lean on their investors hard enough for intros. Yet, it makes me 10x more likely to talk to a new startup if someone else recommends them.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&quot;https://assets.contents.io/asset_reCEfKTG2Kx2DoSk.png&quot;/&gt;&lt;p&gt;Now, let’s shift gears to what happens when you’re actually talking to the prospect.&lt;/p&gt;
&lt;p&gt;The truth of the matter is that 99% of salespeople start with the same exact pitch. It’s pre-canned, it’s not personal, and it’s irrelevant. In other words… it’s far less likely to succeed. It’s the dead opposite of what we want to do.&lt;/p&gt;
&lt;p&gt;Remember, let's start the conversation by thinking like a consultant, not a salesperson.&lt;/p&gt;
&lt;p&gt;Before ever talking about “what it is you do”, you need to gain a clear understanding of the problems the &lt;strong&gt;customer is trying to solve&lt;/strong&gt;. And you need to have a crystal clear idea of how they are doing things today.&lt;/p&gt;
&lt;p&gt;That means asking open-ended, illustrative questions. As an example, I’ll share a few that are particularly relevant for Segment:&lt;/p&gt;
&lt;ul readability=&quot;0&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;em&gt;What does success look like? What metrics are you looking to move?&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;em&gt;Tell me how you answer a question about your funnel today?&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;&lt;em&gt;Walk me through the process to gauge the success of a new product launch.&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;These questions help establish the “before” state; it’s the status quo.&lt;/p&gt;
&lt;p&gt;The before state probably has some rough edges… maybe it’s expensive or a waste of time. Go deep here, you need to figure out where the real pain for the customer comes from. You need to be able to articulate that pain later, so ask questions even they may seem obvious.&lt;/p&gt;
&lt;p&gt;Once you understand the status quo… start probing for what the business should look like in a year.&lt;/p&gt;
&lt;p&gt;This is where the “after” state comes into the picture. If the customer could have their dreams fulfilled, what set of things would they want to exist?&lt;/p&gt;
&lt;p&gt;Write down that “after” state diligently. Ideally the after state should have a set of “axioms that are now true” as well as concrete business outcomes and metrics.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_ScHpWmJUyHUxcD8U.png&quot;/&gt;&lt;p&gt;Once you and the customer both have a clear picture of the “before” and “after” states, then there’s the natural question of “how do we get there?”&lt;/p&gt;
&lt;p&gt;That’s where we get into creating &lt;strong&gt;required capabilities&lt;/strong&gt;. These are the list of requirements that need to be true to transform from the before state to the after state.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;What&lt;/em&gt; these are is not nearly as important as &lt;em&gt;how&lt;/em&gt; they are created.&lt;/p&gt;
&lt;p&gt;Crafting the required capabilities should be a collaborative affair. If you’re just listing out a set of requirements, you’re doing it wrong. You’ve stopped listening.&lt;/p&gt;
&lt;p&gt;Imagine it in the same way that you'd build your product. You don’t just go into a room solo and emerge with a list of strict requirements. You’ll whiteboard them, pressure-test them, and give and get feedback from the customer.&lt;/p&gt;
&lt;p&gt;It’s your goal to understand what their list of requirements is. At the end of the day, you want to agree on that list.&lt;/p&gt;
&lt;p&gt;To see what this looks like, suppose I’m trying to sell Datadog, an application monitoring tool.&lt;/p&gt;
&lt;p&gt;My list of required capabilities might look a little like this:&lt;/p&gt;
&lt;ul readability=&quot;0&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;Engineers must be able to create dashboards to monitor their own services&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;Engineers must be able to define alerts which trigger our existing pager system (Pagerduty)&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;We must be able to record our own custom application-level metrics&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;We require SSO support&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Those capabilities are requirements that you and the customer have mutually agreed are important.&lt;/p&gt;
&lt;p&gt;Remember, the customer is the expert on their organization, and the needs it has. You are likely the expert on how companies evaluate and buy your software. The two of you need to strategize together to figure out what makes sense.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_9GAeUsZYIKq9yVFM.png&quot;/&gt;&lt;p&gt;Finally, it’s the moment you’ve been waiting for! The time to tell the customer about all of the great things you’ve built.&lt;/p&gt;
&lt;p&gt;The way &lt;em&gt;not&lt;/em&gt; to do this is to put together a laundry list of features you’ve built. Instead, you want to speak to the value you provide—and that means bucketing the problems your product solves into several different buckets.&lt;/p&gt;
&lt;p&gt;There are only a handful of types of value propositions when it comes to selling to businesses:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;
&lt;p&gt;increased speed&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;increased revenue&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;reduced cost&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;reduced risk&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;At all costs, you should be able to map some part of your product and its features to these four outcomes.&lt;/p&gt;
&lt;p&gt;When I think about the products that we pay for an use at Segment, all of them fall into these different buckets:&lt;/p&gt;
&lt;ul readability=&quot;1&quot;&gt;&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;AWS increases our speed of iteration&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;Salesforce increases our revenue&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;GSuite reduces the fully loaded cost of our email servers&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;Okta reduces the risk of stolen credentials&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Of course, some of these value propositions are correlated (speed often decreases cost), but the key is that they can contribute meaningfully to the business model in some manner.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_lPEGS8u2ehN7YWzW.png&quot;/&gt;&lt;p&gt;Finally, there’s The Mantra.&lt;/p&gt;
&lt;p&gt;If you remember nothing else from this post, just memorize this section. The mantra is a handy tool to use to wrap up conversations, re-affirm what you just talked about, and discuss next steps.&lt;/p&gt;
&lt;p&gt;The mantra should be “happy birthday” level memorized, so that you can repeat it by heart at a moment’s notice.&lt;/p&gt;
&lt;ul readability=&quot;3&quot;&gt;&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;If I understand correctly, you want to achieve the following business outcomes…&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;Which require the capabilities to...&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;And impact the following metrics...&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Here’s how we do it…&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;-1&quot;&gt;
&lt;p&gt;And here’s how we outpace our competition…&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;0&quot;&gt;
&lt;p&gt;For more info, you can check out the following proof points…&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;These six lines help establish mutual understanding. It shows that you’ve actually listened to the customer and their problems, and affirms that your product can really help them.&lt;/p&gt;

&lt;img src=&quot;https://assets.contents.io/asset_lulekJwE5Jex5k1p.png&quot;/&gt;&lt;p&gt;And we’re done! Well, &lt;em&gt;almost&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;No deal is fully complete without a set of qualification criteria.&lt;/p&gt;
&lt;p&gt;Plain and simple, a sales criteria ensures that you’ve covered your bases. It’s a rigorous tool you can use to evaluate a deal and see where you might have blind spots.&lt;/p&gt;
&lt;p&gt;Think of criteria in the same way that you’d think of the checklists that NASA or SpaceX use to launch rockets. If any field isn’t checked… you might be missing a key piece of the picture.&lt;/p&gt;
&lt;p&gt;The one we use is called MEDDPICC. I’ve detailed it out below.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Metrics&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Metrics are one of the most important parts of a sale. You and the buyer should both be agreed on which metrics the product will impact for the business. That’s how you’ll measure the success of the product (and ideally the ROI).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Economic Buyer&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The economic buyer is the person who actually buys a product—the catch is that they may or may not be the person who wants to use it. In every case, you want to know who can actually make the purchasing decisions.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Decision Criteria&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The decision criteria are more or less the “required capabilities” I talked about earlier on in the post. They determine how the customer will evaluate the product you’re selling.&lt;/p&gt;
&lt;p&gt;In every case, a viable option for the customer will be to “do nothing”. They don’t have to buy your product, or any product for that matter.&lt;/p&gt;
&lt;p&gt;The best way to prove the case for your product is with your metrics. Doing nothing should be a very expensive option.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Decision Process&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Of course, the criteria are only a piece of the puzzle. The decision process governs how customers will actually purchase a piece of software.&lt;/p&gt;
&lt;p&gt;This can vary wildly from company to company—so you should take care to understand how your customer actually buys software. Ask questions to confirm:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Paper Process&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The paper process refers to all the forms, paperwork, and contracts as part of a deal. While it sounds similar to the decision process, DO NOT IGNORE THIS STEP. We’ve had a number of deals fail to close over the years just because we weren’t sure of how the paperwork actually got signed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Identified Pain&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Though it’s far down in the acronym, the identified pain is really where you should start with the customer. You should be able to answer in great detail why their life is currently painful, and how they handle the problems you solve today.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Champion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Your champion is the customer who is rooting for you and wants to buy your product. In the early stage, it’s likely that your champion and buyer are the same person. But as you grow and expand your deal size, the champion might need to get permission to buy your product.&lt;/p&gt;
&lt;p&gt;When this happens, you need to be giving your champion firepower! Help them provide collateral to the rest of their organization to teach them why your product is the best!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Competition&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Lastly, you should know your competition. It could be internal efforts, it could be competitors, or it could be doing nothing at all. In each case, make sure you know why the customer is considering your competition.&lt;/p&gt;

&lt;p&gt;At the end of the day, selling well means &lt;strong&gt;understanding your customer.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In some sense, sales is just another form of finding product market fit. Instead of helping a customer use a product, you are helping them make a decision.&lt;/p&gt;
&lt;p&gt;If you take nothing else from this post, remember that your customer is the expert on the problems they want solved. They have an extremely detailed view of what matters to their business, likely crafted over years. It’s your job to help them understand how those problems map to the different products on the market, and how to make the decision to buy your product in particular.&lt;/p&gt;
&lt;p&gt;As a final parting thought, I think most of the lessons here aren’t just applicable for startup founders. They’re useful for anyone who wants to sell an idea within their company, or establish a culture of elite sales from day one.&lt;/p&gt;
&lt;p&gt;Seek to understand first. The rest will tend to follow.&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;[1]: A notable exception to this are Infrastructure-as-a-Service (IAAS) providers.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Thanks to Ivan Lee, Peter Reinhardt, and Kevin Niparko for providing feedback.&lt;/em&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 02 May 2020 14:32:52 +0000</pubDate>
<dc:creator>polote</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://calv.info/how-to-sell-b2b</dc:identifier>
</item>
<item>
<title>Building a patient monitoring system with Go and Vue in 3 days</title>
<link>https://kasvith.me/posts/how-we-created-a-realtime-patient-monitoring-system-with-go-and-vue/</link>
<guid isPermaLink="true" >https://kasvith.me/posts/how-we-created-a-realtime-patient-monitoring-system-with-go-and-vue/</guid>
<description>&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/featured.png&quot;/&gt;&lt;h2 id=&quot;a-pandemic-started&quot;&gt;A Pandemic started&lt;/h2&gt;&lt;p&gt;In the last November in 2019, we heard about the first case of unknown deadly diseases from China. Now everyone knows it as &lt;strong&gt;Covid-19&lt;/strong&gt; Now it seems to change our lives forever. The virus is deadly and it is highly contagious. Still, we know very little about it. I truly hope we will find some cure soon.&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/corona-virus.jpg&quot; alt=&quot;Corona Virus&quot;/&gt;&lt;p&gt;Corona Virus&lt;/p&gt;
&lt;h2 id=&quot;covid-19-attacked-sri-lanka&quot;&gt;Covid-19 attacked Sri Lanka&lt;/h2&gt;
&lt;p&gt;Due to the nature of the virus, it was very hard to stop it from spreading. In Sri Lanka, where I live we faced the same situation as everyone else. And here we talk about how we helped our frontline in the battle by doing a small favour&lt;/p&gt;
&lt;h2 id=&quot;the-risk-of-handling-a-covid-19-ward&quot;&gt;The risk of handling a Covid-19 ward&lt;/h2&gt;
&lt;p&gt;The deadly virus can infect you with a very small mistake. As healthcare workers, our frontline has to wander around the isolation wards to check vital signs of a patient from time to time. This task involves disposing of the protective gear after a visit. All just to check some reading on a device.&lt;/p&gt;
&lt;p&gt;A request from health authorities reached us to develop a remote monitoring system for isolation wards. There are expensive softwares to remotely monitor them. But Sri Lanka might not be that rich to spend such amount of money.&lt;/p&gt;
&lt;h2 id=&quot;journey-began&quot;&gt;Journey began&lt;/h2&gt;
&lt;p&gt;So we (me and &lt;a href=&quot;https://www.facebook.com/kesharaw&quot;&gt;Keshara&lt;/a&gt;) did a bit of background research and found out these devices usually support a common protocol called HL7(Health Level Seven) to exchange medical data such as vital signs.&lt;/p&gt;
&lt;p&gt;We studied the HL7 protocol for a while. It was bit weird. We have never worked with this protcol. It was a new experience.&lt;/p&gt;
&lt;p&gt;HL7 messages are framed as below&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/hl7.png&quot; alt=&quot;HL7 Packet&quot;/&gt;&lt;p&gt;HL7 Packet&lt;/p&gt;
&lt;p&gt;Inside the message section patient medical data is packed like below, &lt;code&gt;&amp;lt;CR&amp;gt;&lt;/code&gt; is &lt;code&gt;\r&lt;/code&gt; carrige return used to seperate messages&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sample HL7 Message&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;
&lt;div class=&quot;chroma&quot;&gt;
&lt;table class=&quot;lntable&quot; readability=&quot;2.5&quot;&gt;&lt;tr readability=&quot;7.5&quot;&gt;&lt;td class=&quot;lntd&quot;&gt;
&lt;pre class=&quot;chroma&quot;&gt;
&lt;code class=&quot;language-hl7&quot; data-lang=&quot;hl7&quot;&gt;&lt;span class=&quot;lnt&quot;&gt; 1
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 2
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 3
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 4
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 5
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 6
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 7
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 8
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 9
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;10
&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;lntd&quot; readability=&quot;8&quot;&gt;
&lt;pre class=&quot;chroma&quot;&gt;
&lt;code class=&quot;language-hl7&quot; data-lang=&quot;hl7&quot;&gt;MSH|^~\&amp;amp;|||||||ORU^R01|103|P|2.3.1|&amp;lt;CR&amp;gt;
PID|||14140f00-7bbc-0478-11122d2d02000000||WEERASINGHE^KESHARA||19960714|M|&amp;lt;CR&amp;gt;
PV1||I|^^ICU&amp;amp;1&amp;amp;3232237756&amp;amp;4601&amp;amp;&amp;amp;1|||||||||||||||A|||&amp;lt;CR&amp;gt;
OBR||||Mindray Monitor|||0|&amp;lt;CR&amp;gt;
OBX||NM|52^||189.0||||||F&amp;lt;CR&amp;gt;
OBX||NM|51^||100.0||||||F&amp;lt;CR&amp;gt;
OBX||ST|2301^||2||||||F&amp;lt;CR&amp;gt;
OBX||CE|2302^Blood||0^N||||||F&amp;lt;CR&amp;gt;
OBX||CE|2303^Paced||2^||||||F&amp;lt;CR&amp;gt;
OBX||ST|2308^BedNoStr||BED-001||||||F&amp;lt;CR&amp;gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Ok this looks weird right? We felt also. This is known as Pipehat format which uses &lt;code&gt;|&lt;/code&gt; to seperate segments. Im not going to talk much about protocol here. You can find plenty of resources in the internet.&lt;/p&gt;
&lt;p&gt;We found out some cool libraries written in different languages to process the HL7 messages.&lt;/p&gt;
&lt;h2 id=&quot;why-go&quot;&gt;Why Go&lt;/h2&gt;
&lt;blockquote readability=&quot;14&quot;&gt;
&lt;p&gt;Go or Golang is a statically-typed language with syntax loosely derived from that of C, with extra features such as garbage collection (like Java), type safety, and some dynamic-typing capabilities. developed at Google in 2007 by a bunch of clever people, Robert Griesemer, Rob Pike, and Ken Thompson.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Go was built for concurrency, it supports them as first-class citizens in the language itself. Go has goroutines and channels which allows programmers to quickly develop highly concurrent programs with minimal effort.&lt;/p&gt;
&lt;p&gt;So we decided to pick up Golang. As for this task, we felt that we would have to deal with a lot of concurrent tasks. Also, Go binaries are statically built, so it makes easy to install the software on the hospital system without adding additional dependencies.&lt;/p&gt;
&lt;p&gt;We kept looking for good libraries written in Go and found this &lt;a href=&quot;https://github.com/deoxxa/hl7&quot;&gt;library&lt;/a&gt; as a good one. Author of it has written a great &lt;a href=&quot;https://www.fknsrs.biz/blog/golang-hl7-library.html&quot;&gt;blog&lt;/a&gt; post about HL7 as well.&lt;/p&gt;
&lt;p&gt;It supports selecting and parsing messages easily.&lt;/p&gt;
&lt;h2 id=&quot;why-vuejs&quot;&gt;Why VueJS&lt;/h2&gt;
&lt;blockquote readability=&quot;8&quot;&gt;
&lt;p&gt;Vue (pronounced /vjuː/, like view) is a progressive framework for building user interfaces. Unlike other monolithic frameworks, Vue is designed from the ground up to be incrementally adoptable.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In VueJS we can easily create beautiful reactive UIs with minimal efforts. We used it as you already know its purely awesome, easy and powerful. We also used Vuetify for a UI library&lt;/p&gt;
&lt;h2 id=&quot;we-got-a-real-device&quot;&gt;We got a real device&lt;/h2&gt;
&lt;p&gt;After playing with &lt;a href=&quot;https://www.mindraynorthamerica.com/cmsAdmin/uploads/h-046-004990-00-1-0_a-series-communication-protocol-interface-guide_003.pdf&quot;&gt;programmer guide for Mindray&lt;/a&gt; Bedside Monitor(it was common in the hospital, so we picked it up) we made a small prototype to decode hl7 messages. It could correctly decode hl7 messages and convert data to JSON correctly. We made this using Unsolisticated Result Interface defined in the Programmer Manual.&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/mindray-bedside-monitor.png&quot; alt=&quot;Mindray uMec10&quot;/&gt;&lt;p&gt;Mindray uMec10&lt;/p&gt;
&lt;p&gt;But when we got hands-on a real device it really did not work. So Keshara and I started analyzing packets in Wireshark to see what device is actually doing. So we find out that it is not talking this protocol at all. Its using Realtime Result Interface which was quite old and out of maintenance by manufacturer.&lt;/p&gt;

&lt;p&gt;Extracting a HL7 message from the device goes as follows. We used &lt;code&gt;bufio.Reader&lt;/code&gt; for the task as it has a efficient way handling streams of inputs. Instead of hitting the network layer everytime, &lt;code&gt;Reader&lt;/code&gt; allowed us to efficiently read from an underlying TCP connection.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;
&lt;div class=&quot;chroma&quot;&gt;
&lt;table class=&quot;lntable&quot; readability=&quot;12.5&quot;&gt;&lt;tr readability=&quot;37.5&quot;&gt;&lt;td class=&quot;lntd&quot; readability=&quot;5&quot;&gt;
&lt;pre class=&quot;chroma&quot;&gt;
&lt;code class=&quot;language-go&quot; data-lang=&quot;go&quot;&gt;&lt;span class=&quot;lnt&quot;&gt; 1
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 2
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 3
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 4
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 5
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 6
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 7
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 8
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt; 9
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;10
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;11
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;12
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;13
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;14
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;15
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;16
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;17
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;18
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;19
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;20
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;21
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;22
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;23
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;24
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;25
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;26
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;27
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;28
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;29
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;30
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;31
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;32
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;33
&lt;/span&gt;&lt;span class=&quot;lnt&quot;&gt;34
&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&quot;lntd&quot; readability=&quot;26&quot;&gt;
&lt;pre class=&quot;chroma&quot;&gt;
&lt;code class=&quot;language-go&quot; data-lang=&quot;go&quot;&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ProcessHL7Packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hl7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// read message start 0x0B
&lt;/span&gt;    &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error reading start byte: %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;invalid header&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// read payload
&lt;/span&gt;    &lt;span class=&quot;nx&quot;&gt;payloadWithDelimiter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error reading payload: %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// just verify and process next byte on the line
&lt;/span&gt;    &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error reading end byte %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;invalid message end&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// skip last two bytes from the hl7 packet
&lt;/span&gt;    &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payloadWithDelimiter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payloadWithDelimiter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Debugf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Length of payload %d\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;hl7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ParseMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Errorf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;error parsing hl7: %s\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;system-architecture&quot;&gt;System Architecture&lt;/h2&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/architecture.png&quot; alt=&quot;System Architecture&quot;/&gt;&lt;p&gt;System Architecture&lt;/p&gt;
&lt;p&gt;The system design was done in a way its reliable for the long run. We carefully selected the best tools for the task.&lt;/p&gt;
&lt;p&gt;The database we selected was &lt;strong&gt;PostgreSQL&lt;/strong&gt; because it was stable and reliable. With HA setup we can create a good reliable database system for the monitoring system. Also, PG supports high throughput data ingestion as well, it was a plus.&lt;/p&gt;
&lt;p&gt;In future with &lt;strong&gt;TimeScaleDB&lt;/strong&gt;, we gonna make this for &lt;em&gt;realtime analytics&lt;/em&gt; as well. So PG was the best overall selection as TimeScale can be installed on top of it in future.&lt;/p&gt;
&lt;p&gt;We separated Gateway and API for management purposes. Gateway is designed to be lightweight and robust. Thanks to GoLang it was a cool experience.&lt;/p&gt;
&lt;h2 id=&quot;going-real-world&quot;&gt;Going real world&lt;/h2&gt;
&lt;p&gt;Bedside monitor broadcasted its existence via UDP protocol. We had to capture the UDP packet and process it to extract necessary details to access the monitoring device.&lt;/p&gt;
&lt;p&gt;We created a separate Go Service to detect the UDP broadcasts and register a new device within the system. Next phase was to connect the Data Server inside the device from the Gateway. We created another service in Go to handle these TCP connections.&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/discovery.png&quot; alt=&quot;Device Discovery&quot;/&gt;&lt;p&gt;Device Discovery&lt;/p&gt;
&lt;p&gt;As our gateway need to connect as a client to the device, we had to coordinate the client disconnections as well. Also, we had to keep tabs on each monitor status in the gateway too.&lt;/p&gt;
&lt;p&gt;Using Go &lt;a href=&quot;https://tour.golang.org/concurrency/2&quot;&gt;Channels&lt;/a&gt;, we could easily save the Alarms to the &lt;strong&gt;PostgreSQL&lt;/strong&gt; database for later analysis purposes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Channels&lt;/strong&gt; allow mutex free communication between goroutines without a pain. It was awesome to use them.&lt;/p&gt;
&lt;p&gt;My experience developing a Redis Compatible In Memory Database known as &lt;a href=&quot;https://github.com/kasvith/kache&quot;&gt;Kache&lt;/a&gt; helped us a lot to solve many critical problems.&lt;/p&gt;
&lt;h2 id=&quot;display-vital-signs-in-realtime&quot;&gt;Display vital signs in realtime&lt;/h2&gt;
&lt;p&gt;We parallelly started developing a good frontend application for displaying realtime results from devices for the medical staff. Keshara did the heavy lifting of the UI part and I feel it is awesome. Within just 3 days we made a really good UI for the task.&lt;/p&gt;
&lt;p&gt;Starting with &lt;a href=&quot;https://vuetifyjs.com&quot;&gt;Vuetify&lt;/a&gt; we worked on a custom layout which is similar to a bedside monitor interface.&lt;/p&gt;
&lt;p&gt;Using &lt;a href=&quot;https://vuex.vuejs.org/&quot;&gt;Vuex&lt;/a&gt; for state management we also developed a priority-based alarm service which alarms the staff on any critical condition.&lt;/p&gt;
&lt;p&gt;We connected API and Frontend using &lt;a href=&quot;https://socket.io/&quot;&gt;Socket.io&lt;/a&gt;, which allowed us to create an effective communication channel to deliver results in realtime.&lt;/p&gt;
&lt;p&gt;I must thank Keshara again for his effort during the UI development.&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/patient-monitoring-ui.jpg&quot; alt=&quot;Realtime Dashboard&quot;/&gt;&lt;p&gt;Realtime Dashboard&lt;/p&gt;
&lt;h2 id=&quot;deployment&quot;&gt;Deployment&lt;/h2&gt;
&lt;p&gt;These devices are sending data at high throughput. We decided to use separate VLAN for devices and another VLAN for the API to handle the traffic without flooding the Hospital Network. We also got help from our University Lecturers &lt;a href=&quot;http://www.ce.pdn.ac.lk/academic-staff/asitha-bandaranayake/&quot;&gt;Dr. Asitha Bandaranayake&lt;/a&gt; and &lt;a href=&quot;http://www.ce.pdn.ac.lk/academic-staff/suneth-namal-karunarathna/&quot;&gt;Dr. Suneth Namal Karunarathna&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;With their support, we were able to set up a solid network. Next, we started an Ubuntu 18.04 box and started deploying the system.&lt;/p&gt;
&lt;p&gt;Keshara did the heavy lifting in here also, risking his own life in a hospital with possible COVID Patients.&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/setting-up-deployment.jpg&quot; alt=&quot;Keshara is deplyoing the system in hospital&quot;/&gt;&lt;p&gt;Keshara is deplyoing the system in hospital&lt;/p&gt;
&lt;h2 id=&quot;going-production&quot;&gt;Going production&lt;/h2&gt;
&lt;p&gt;In the pictures and videos below you can see it in action.&lt;/p&gt;

&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/prod-1.jpg&quot; alt=&quot;Dr. Sudarshana Wickramasinghe is testing the system&quot;/&gt;&lt;p&gt;Dr. Sudarshana Wickramasinghe is testing the system&lt;/p&gt;
&lt;img src=&quot;https://kasvith.me/img/covid19-rpms-go-vue/prod-2.jpg&quot; alt=&quot;Keshara and Dr. Sudarshana after deployment&quot;/&gt;&lt;p&gt;Keshara and Dr. Sudarshana after deployment&lt;/p&gt;
&lt;h2 id=&quot;end-notes&quot;&gt;End Notes&lt;/h2&gt;
&lt;p&gt;We should help each other, our frontline is in the battle against the virus without even taking a rest. We all should help them. As Computer Engineering students, we did our best to support them by developing this system to remotely monitor patients.&lt;/p&gt;
&lt;p&gt;This reduces contacts and helps them to be more effective and safe.&lt;/p&gt;
&lt;p&gt;We thank all Opensource contributors who developed awesome tools/libraries, without them this would be a dream.&lt;/p&gt;
&lt;p&gt;Using &lt;strong&gt;Golang&lt;/strong&gt; was a brillient idea, we wrote a pretty stable system within few days.&lt;/p&gt;
&lt;p&gt;Also &lt;strong&gt;VueJS&lt;/strong&gt; helped us to create truely reactive nice UIs quickly.&lt;/p&gt;
&lt;p&gt;Together We Can ❤️&lt;/p&gt;
&lt;h2 id=&quot;disclaimer&quot;&gt;Disclaimer&lt;/h2&gt;
&lt;p&gt;We created this software on a request from healthcare staffs. It is not a commercial application. Even with this system, we strongly suggest doctors to visit their patients, take real measurements.&lt;/p&gt;
&lt;p&gt;As this software was developed fast due to prevailing pandemic situation, we released it with the most urgent feature &lt;strong&gt;monitoring&lt;/strong&gt;. We tested this for long run, with multiple devices as well. So far it worked out well.&lt;/p&gt;
&lt;p&gt;It does not indicate this is perfect, we are working on improvements and fixing bugs until its very stable.&lt;/p&gt;
&lt;p&gt;Thus we have adviced doctors to use this with &lt;strong&gt;CAUTION&lt;/strong&gt;&lt;/p&gt;
</description>
<pubDate>Sat, 02 May 2020 12:01:44 +0000</pubDate>
<dc:creator>astdb</dc:creator>
<og:title>How We Created a Realtime Patient Monitoring System With Go and Vue in 3 days</og:title>
<og:description>A Pandemic started In the last November in 2019, we heard about the first case of unknown deadly diseases from China. Now everyone knows it as Covid-19 Now it seems to change our lives forever. The virus is deadly and it is highly contagious. Still, we know very little about it. I truly hope we will find some cure soon. Corona Virus Covid-19 attacked Sri Lanka Due to the nature of the virus, it was very hard to stop it from spreading.</og:description>
<og:type>article</og:type>
<og:url>https://kasvith.me/posts/how-we-created-a-realtime-patient-monitoring-system-with-go-and-vue</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://kasvith.me/posts/how-we-created-a-realtime-patient-monitoring-system-with-go-and-vue/</dc:identifier>
</item>
<item>
<title>What Happens Next? Covid-19 Futures, Explained with Playable Simulations</title>
<link>https://ncase.me/covid-19/</link>
<guid isPermaLink="true" >https://ncase.me/covid-19/</guid>
<description>&lt;p&gt;Help this guide get R &amp;gt; 1:&lt;br/&gt;&lt;span id=&quot;share_title&quot;&gt;What Happens Next? COVID-19 Futures, Explained With Playable Simulations&lt;/span&gt; &lt;span id=&quot;share_desc&quot;&gt;🔬 Here's a real deep dive! 30 min read/play:&lt;/span&gt;&lt;/p&gt;&lt;div id=&quot;&quot;&gt;&lt;div class=&quot;section&quot; readability=&quot;5.4906832298137&quot;&gt;
&lt;div readability=&quot;6.7577639751553&quot;&gt;
&lt;p&gt;What Happens Next?&lt;/p&gt;
&lt;p&gt;COVID-19 Futures, Explained With Playable Simulations&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&quot;The only thing to fear is fear itself&quot; was stupid advice.&lt;/p&gt;
&lt;p&gt;Sure, don't hoard toilet paper – but if policymakers fear fear itself, they'll downplay real dangers to avoid &quot;mass panic&quot;. Fear's not the problem, it's how we &lt;em&gt;channel&lt;/em&gt; our fear. Fear gives us energy to deal with dangers now, and prepare for dangers later.&lt;/p&gt;
&lt;p&gt;Honestly, we (Marcel, epidemiologist + Nicky, art/code) are worried. We bet you are, too! That's why we've channelled our fear into making these &lt;strong&gt;playable simulations&lt;/strong&gt;, so that &lt;em&gt;you&lt;/em&gt; can channel your fear into understanding:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;The Last Few Months&lt;/strong&gt; (epidemiology 101, SEIR model, R &amp;amp; R&lt;sub&gt;0&lt;/sub&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Next Few Months&lt;/strong&gt; (lockdowns, contact tracing, masks)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The Next Few Years&lt;/strong&gt; (loss of immunity? no vaccine?)&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;This guide (published May 1st, 2020. click this footnote!→&lt;sup id=&quot;fnref1&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;) is meant to give you hope &lt;em&gt;and&lt;/em&gt; fear. To beat COVID-19 &lt;strong&gt;in a way that also protects our mental &amp;amp; financial health&lt;/strong&gt;, we need optimism to create plans, and pessimism to create backup plans. As Gladys Bronwyn Stern once said, &lt;em&gt;“The optimist invents the airplane and the pessimist the parachute.”&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So, buckle in: we're about to experience some turbulence.&lt;/p&gt;
&lt;div class=&quot;section chapter&quot;&gt;
&lt;div&gt;&lt;img src=&quot;https://ncase.me/covid-19/banners/curve.png&quot; height=&quot;480&quot;/&gt;&lt;p&gt;The Last Few Months&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Pilots use flight simulators to learn how not to crash planes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Epidemiologists use epidemic simulators to learn how not to crash humanity.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, let's make a very, &lt;em&gt;very&lt;/em&gt; simple &quot;epidemic flight simulator&quot;! In this simulation, Infectious people can turn Susceptible people into more Infectious people:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/spread.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;It's estimated that, &lt;em&gt;at the start&lt;/em&gt; of a COVID-19 outbreak, the virus jumps from an to an every 4 days, &lt;em&gt;on average&lt;/em&gt;.&lt;sup id=&quot;fnref2&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; (remember, there's a lot of variation)&lt;/p&gt;
&lt;p&gt;If we simulate &quot;double every 4 days&quot; &lt;em&gt;and nothing else&lt;/em&gt;, on a population starting with just 0.001% , what happens?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Click &quot;Start&quot; to play the simulation! You can re-play it later with different settings:&lt;/strong&gt; (technical caveats: &lt;sup id=&quot;fnref3&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;

&lt;p&gt;This is the &lt;strong&gt;exponential growth curve.&lt;/strong&gt; Starts small, then explodes. &quot;Oh it's just a flu&quot; to &quot;Oh right, flus don't create &lt;em&gt;mass graves in rich cities&lt;/em&gt;&quot;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/exponential.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;But, this simulation is wrong. Exponential growth, thankfully, can't go on forever. One thing that stops a virus from spreading is if others &lt;em&gt;already&lt;/em&gt; have the virus:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/susceptibles.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The more s there are, the faster s become s, &lt;strong&gt;but the fewer s there are, the &lt;em&gt;slower&lt;/em&gt; s become s.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;How's this change the growth of an epidemic? Let's find out:&lt;/p&gt;

&lt;p&gt;This is the &quot;S-shaped&quot; &lt;strong&gt;logistic growth curve.&lt;/strong&gt; Starts small, explodes, then slows down again.&lt;/p&gt;
&lt;p&gt;But, this simulation is &lt;em&gt;still&lt;/em&gt; wrong. We're missing the fact that Infectious people eventually stop being infectious, either by 1) recovering, 2) &quot;recovering&quot; with lung damage, or 3) dying.&lt;/p&gt;
&lt;p&gt;For simplicity's sake, let's pretend that all Infectious people become Recovered. (Just remember that in reality, some are dead.) s can't be infected again, and let's pretend – &lt;em&gt;for now!&lt;/em&gt; – that they stay immune for life.&lt;/p&gt;
&lt;p&gt;With COVID-19, it's estimated you're Infectious for 10 days, &lt;em&gt;on average&lt;/em&gt;.&lt;sup id=&quot;fnref4&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; That means some folks will recover before 10 days, some after. &lt;strong&gt;Here's what that looks like, with a simulation &lt;em&gt;starting&lt;/em&gt; with 100% :&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is the opposite of exponential growth, the &lt;strong&gt;exponential decay curve.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now, what happens if you simulate S-shaped logistic growth &lt;em&gt;with&lt;/em&gt; recovery?&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/graphs_q.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Let's find out.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Red curve&lt;/strong&gt; is &lt;em&gt;current&lt;/em&gt; cases ,&lt;br/&gt;&lt;strong&gt;Gray curve&lt;/strong&gt; is &lt;em&gt;total&lt;/em&gt; cases (current + recovered ), starts at just 0.001% :&lt;/p&gt;

&lt;p&gt;And &lt;em&gt;that's&lt;/em&gt; where that famous curve comes from! It's not a bell curve, it's not even a &quot;log-normal&quot; curve. It has no name. But you've seen it a zillion times, and beseeched to flatten.&lt;/p&gt;
&lt;p&gt;This is the the &lt;strong&gt;SIR Model&lt;/strong&gt;,&lt;sup id=&quot;fnref5&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn5&quot; rel=&quot;footnote&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;br/&gt;(&lt;strong&gt;S&lt;/strong&gt;usceptible &lt;strong&gt;I&lt;/strong&gt;nfectious &lt;strong&gt;R&lt;/strong&gt;ecovered)&lt;br/&gt;the &lt;em&gt;second&lt;/em&gt;-most important idea in Epidemiology 101:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/sir.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE: The simulations that inform policy are way, &lt;em&gt;way&lt;/em&gt; more sophisticated than this!&lt;/strong&gt; But the SIR Model can still explain the same general findings, even if missing the nuances.&lt;/p&gt;
&lt;p&gt;Actually, let's add one more nuance: before an becomes an , they first become Exposed. This is when they have the virus but can't pass it on yet – infect&lt;em&gt;ed&lt;/em&gt; but not yet infect&lt;em&gt;ious&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/seir.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;(This variant is called the &lt;strong&gt;SEIR Model&lt;/strong&gt;&lt;sup id=&quot;fnref6&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn6&quot; rel=&quot;footnote&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;, where the &quot;E&quot; stands for &quot;Exposed&quot;. Note this &lt;em&gt;isn't&lt;/em&gt; the everyday meaning of &quot;exposed&quot;, when you may or may not have the virus. In this technical definition, &quot;Exposed&quot; means you definitely have it. Science terminology is bad.)&lt;/p&gt;
&lt;p&gt;For COVID-19, it's estimated that you're infected-but-not-yet-infectious for 3 days, &lt;em&gt;on average&lt;/em&gt;.&lt;sup id=&quot;fnref7&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn7&quot; rel=&quot;footnote&quot;&gt;7&lt;/a&gt;&lt;/sup&gt; What happens if we add that to the simulation?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Red + Pink curve&lt;/strong&gt; is &lt;em&gt;current&lt;/em&gt; cases (infectious + exposed ),&lt;br/&gt;&lt;strong&gt;Gray curve&lt;/strong&gt; is &lt;em&gt;total&lt;/em&gt; cases (current + recovered ):&lt;/p&gt;

&lt;p&gt;Not much changes! How long you stay Exposed changes the ratio of -to-, and &lt;em&gt;when&lt;/em&gt; current cases peak... but the &lt;em&gt;height&lt;/em&gt; of that peak, and total cases in the end, stays the same.&lt;/p&gt;
&lt;p&gt;Why's that? Because of the &lt;em&gt;first&lt;/em&gt;-most important idea in Epidemiology 101:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/r.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Short for &quot;Reproduction number&quot;. It's the &lt;em&gt;average&lt;/em&gt; number of people an infects &lt;em&gt;before&lt;/em&gt; they recover (or die).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/r2.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;R&lt;/strong&gt; changes over the course of an outbreak, as we get more immunity &amp;amp; interventions.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;R&lt;sub&gt;0&lt;/sub&gt;&lt;/strong&gt; (pronounced R-nought) is what R is &lt;em&gt;at the start of an outbreak, before immunity or interventions&lt;/em&gt;. R&lt;sub&gt;0&lt;/sub&gt; more closely reflects the power of the virus itself, but it still changes from place to place. For example, R&lt;sub&gt;0&lt;/sub&gt; is higher in dense cities than sparse rural areas.&lt;/p&gt;
&lt;p&gt;(Most news articles – and even some research papers! – confuse R and R&lt;sub&gt;0&lt;/sub&gt;. Again, science terminology is bad)&lt;/p&gt;
&lt;p&gt;The R&lt;sub&gt;0&lt;/sub&gt; for &quot;the&quot; seasonal flu is around 1.28&lt;sup id=&quot;fnref8&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn8&quot; rel=&quot;footnote&quot;&gt;8&lt;/a&gt;&lt;/sup&gt;. This means, at the &lt;em&gt;start&lt;/em&gt; of a flu outbreak, each infects 1.28 others &lt;em&gt;on average.&lt;/em&gt; (If it sounds weird that this isn't a whole number, remember that the &quot;average&quot; mom has 2.4 children. This doesn't mean there's half-children running about.)&lt;/p&gt;
&lt;p&gt;The R&lt;sub&gt;0&lt;/sub&gt; for COVID-19 is estimated to be around 2.2,&lt;sup id=&quot;fnref9&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn9&quot; rel=&quot;footnote&quot;&gt;9&lt;/a&gt;&lt;/sup&gt; though one &lt;em&gt;not-yet-finalized&lt;/em&gt; study estimates it was 5.7(!) in Wuhan.&lt;sup id=&quot;fnref10&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn10&quot; rel=&quot;footnote&quot;&gt;10&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;In our simulations – &lt;em&gt;at the start &amp;amp; on average&lt;/em&gt; – an infects someone every 4 days, over 10 days. &quot;4 days&quot; goes into &quot;10 days&quot; two-and-a-half times. This means – &lt;em&gt;at the start &amp;amp; on average&lt;/em&gt; – each infects 2.5 others. Therefore, R&lt;sub&gt;0&lt;/sub&gt; = 2.5. (caveats:&lt;sup id=&quot;fnref11&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn11&quot; rel=&quot;footnote&quot;&gt;11&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Play with this R&lt;sub&gt;0&lt;/sub&gt; calculator, to see how R&lt;sub&gt;0&lt;/sub&gt; depends on recovery time &amp;amp; new-infection time:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;But remember, the fewer s there are, the &lt;em&gt;slower&lt;/em&gt; s become s. The &lt;em&gt;current&lt;/em&gt; reproduction number (R) depends not just on the &lt;em&gt;basic&lt;/em&gt; reproduction number (R&lt;sub&gt;0&lt;/sub&gt;), but &lt;em&gt;also&lt;/em&gt; on how many people are no longer Susceptible. (For example, by recovering &amp;amp; getting natural immunity.)&lt;/p&gt;

&lt;p&gt;When enough people have immunity, R &amp;lt; 1, and the virus is contained! This is called &lt;strong&gt;herd immunity&lt;/strong&gt;. For flus, herd immunity is achieved &lt;em&gt;with a vaccine&lt;/em&gt;. Trying to achieve &quot;natural herd immunity&quot; by letting folks get infected is a &lt;em&gt;terrible&lt;/em&gt; idea. (But not for the reason you may think! We'll explain later.)&lt;/p&gt;
&lt;p&gt;Now, let's play the SEIR Model again, but showing R&lt;sub&gt;0&lt;/sub&gt;, R over time, and the herd immunity threshold:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE: Total cases &lt;em&gt;does not stop&lt;/em&gt; at herd immunity, but overshoots it!&lt;/strong&gt; And it crosses the threshold &lt;em&gt;exactly&lt;/em&gt; when current cases peak. (This happens no matter how you change the settings – try it for yourself!)&lt;/p&gt;
&lt;p&gt;This is because when there are more non-s than the herd immunity threshold, you get R &amp;lt; 1. And when R &amp;lt; 1, new cases stop growing: a peak.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;If there's only one lesson you take away from this guide, here it is&lt;/strong&gt; – it's an extremely complex diagram so please take time to fully absorb it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/r3.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This means: we do NOT need to catch all transmissions, or even nearly all transmissions, to stop COVID-19!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;It's a paradox. COVID-19 is extremely contagious, yet to contain it, we &quot;only&quot; need to stop more than 60% of infections. 60%?! If that was a school grade, that's a D-. But if R&lt;sub&gt;0&lt;/sub&gt; = 2.5, cutting that by 61% gives us R = 0.975, which is R &amp;lt; 1, virus is contained! (exact formula:&lt;sup id=&quot;fnref12&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn12&quot; rel=&quot;footnote&quot;&gt;12&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/r4.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;(If you think R&lt;sub&gt;0&lt;/sub&gt; or the other numbers in our simulations are too low/high, that's good you're challenging our assumptions! There'll be a &quot;Sandbox Mode&quot; at the end of this guide, where you can plug in your &lt;em&gt;own&lt;/em&gt; numbers, and simulate what happens.)&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Every&lt;/em&gt; COVID-19 intervention you've heard of – handwashing, social/physical distancing, lockdowns, self-isolation, contact tracing &amp;amp; quarantining, face masks, even &quot;herd immunity&quot; – they're &lt;em&gt;all&lt;/em&gt; doing the same thing:&lt;/p&gt;
&lt;p&gt;Getting R &amp;lt; 1.&lt;/p&gt;
&lt;p&gt;So now, let's use our &quot;epidemic flight simulator&quot; to figure this out: How can we get R &amp;lt; 1 in a way &lt;strong&gt;that also protects our mental health &lt;em&gt;and&lt;/em&gt; financial health?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Brace yourselves for an emergency landing...&lt;/p&gt;
&lt;div class=&quot;section chapter&quot;&gt;
&lt;div&gt;&lt;img src=&quot;https://ncase.me/covid-19/banners/curve.png&quot; height=&quot;480&quot;/&gt;&lt;p&gt;The Next Few Months&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;...could have been worse. Here's a parallel universe we avoided:&lt;/p&gt;
&lt;h3 id=&quot;toc_0&quot;&gt;Scenario 0: Do Absolutely Nothing&lt;/h3&gt;
&lt;p&gt;Around 1 in 20 people infected with COVID-19 need to go to an ICU (Intensive Care Unit).&lt;sup id=&quot;fnref13&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn13&quot; rel=&quot;footnote&quot;&gt;13&lt;/a&gt;&lt;/sup&gt; In a rich country like the USA, there's 1 ICU bed per 3400 people.&lt;sup id=&quot;fnref14&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn14&quot; rel=&quot;footnote&quot;&gt;14&lt;/a&gt;&lt;/sup&gt; Therefore, the USA can handle 20 out of 3400 people being &lt;em&gt;simultaneously&lt;/em&gt; infected – or, 0.6% of the population.&lt;/p&gt;
&lt;p&gt;Even if we &lt;em&gt;more than tripled&lt;/em&gt; that capacity to 2%, here's what would've happened &lt;em&gt;if we did absolutely nothing:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Not good.&lt;/p&gt;
&lt;p&gt;That's what &lt;a href=&quot;http://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/covid-19/report-9-impact-of-npis-on-covid-19/&quot;&gt;the March 16 Imperial College report&lt;/a&gt; found: do nothing, and we run out of ICUs, with more than 80% of the population getting infected. (remember: total cases &lt;em&gt;overshoots&lt;/em&gt; herd immunity)&lt;/p&gt;
&lt;p&gt;Even if only 0.5% of infected die – a generous assumption when there's no more ICUs – in a large country like the US, with 300 million people, 0.5% of 80% of 300 million = still 1.2 million dead... &lt;em&gt;IF we did nothing.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;(Lots of news &amp;amp; social media reported &quot;80% will be infected&quot; &lt;em&gt;without&lt;/em&gt; &quot;IF WE DO NOTHING&quot;. Fear was channelled into clicks, not understanding. &lt;em&gt;Sigh.&lt;/em&gt;)&lt;/p&gt;
&lt;h3 id=&quot;toc_1&quot;&gt;Scenario 1: Flatten The Curve / Herd Immunity&lt;/h3&gt;
&lt;p&gt;The &quot;Flatten The Curve&quot; plan was touted by every public health organization, while the United Kingdom's original &quot;herd immunity&quot; plan was universally booed. They were &lt;em&gt;the same plan.&lt;/em&gt; The UK just communicated theirs poorly.&lt;sup id=&quot;fnref15&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn15&quot; rel=&quot;footnote&quot;&gt;15&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;Both plans, though, had a literally fatal flaw.&lt;/p&gt;
&lt;p&gt;First, let's look at the two main ways to &quot;flatten the curve&quot;: handwashing &amp;amp; physical distancing.&lt;/p&gt;
&lt;p&gt;Increased handwashing cuts flus &amp;amp; colds in high-income countries by ~25%&lt;sup id=&quot;fnref16&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn16&quot; rel=&quot;footnote&quot;&gt;16&lt;/a&gt;&lt;/sup&gt;, while the city-wide lockdown in London cut close contacts by ~70%&lt;sup id=&quot;fnref17&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn17&quot; rel=&quot;footnote&quot;&gt;17&lt;/a&gt;&lt;/sup&gt;. So, let's assume handwashing can reduce R by &lt;em&gt;up to&lt;/em&gt; 25%, and distancing can reduce R by &lt;em&gt;up to&lt;/em&gt; 70%:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Play with this calculator to see how % of non-, handwashing, and distancing reduce R:&lt;/strong&gt; (this calculator visualizes their &lt;em&gt;relative&lt;/em&gt; effects, which is why increasing one &lt;em&gt;looks&lt;/em&gt; like it decreases the effect of the others.&lt;sup id=&quot;fnref18&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn18&quot; rel=&quot;footnote&quot;&gt;18&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;

&lt;p&gt;Now, let's simulate what happens to a COVID-19 epidemic if, starting March 2020, we had increased handwashing but only &lt;em&gt;mild&lt;/em&gt; physical distancing – so that R is lower, but still above 1:&lt;/p&gt;

&lt;p&gt;Three notes:&lt;/p&gt;
&lt;ol readability=&quot;9&quot;&gt;&lt;li readability=&quot;5&quot;&gt;
&lt;p&gt;This &lt;em&gt;reduces&lt;/em&gt; total cases! &lt;strong&gt;Even if you don't get R &amp;lt; 1, reducing R still saves lives, by reducing the 'overshoot' above herd immunity.&lt;/strong&gt; Lots of folks think &quot;Flatten The Curve&quot; spreads out cases without reducing the total. This is impossible in &lt;em&gt;any&lt;/em&gt; Epidemiology 101 model. But because the news reported &quot;80%+ will be infected&quot; as inevitable, folks thought total cases will be the same no matter what. &lt;em&gt;Sigh.&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;9&quot;&gt;
&lt;p&gt;Due to the extra interventions, current cases peak &lt;em&gt;before&lt;/em&gt; herd immunity is reached. In fact, in this simulation, total cases only overshoots &lt;em&gt;a tiny bit&lt;/em&gt; above herd immunity – the UK's plan! At that point, R &amp;lt; 1, you can let go of all other interventions, and COVID-19 stays contained! Well, except for one problem...&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;1&quot;&gt;
&lt;p&gt;You still run out of ICUs. For several months. (and remember, we &lt;em&gt;already&lt;/em&gt; tripled ICUs for these simulations)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;That was the other finding of the March 16 Imperial College report, which convinced the UK to abandon its original plan. Any attempt at &lt;strong&gt;mitigation&lt;/strong&gt; (reduce R, but R &amp;gt; 1) will fail. The only way out is &lt;strong&gt;suppression&lt;/strong&gt; (reduce R so that R &amp;lt; 1).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/mitigation_vs_suppression.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;That is, don't merely &quot;flatten&quot; the curve, &lt;em&gt;crush&lt;/em&gt; the curve. For example, with a...&lt;/p&gt;
&lt;h3 id=&quot;toc_2&quot;&gt;Scenario 2: Months-Long Lockdown&lt;/h3&gt;
&lt;p&gt;Let's see what happens if we &lt;em&gt;crush&lt;/em&gt; the curve with a 5-month lockdown, reduce to nearly nothing, then finally – &lt;em&gt;finally&lt;/em&gt; – return to normal life:&lt;/p&gt;

&lt;p&gt;Oh.&lt;/p&gt;
&lt;p&gt;This is the &quot;second wave&quot; everyone's talking about. As soon as we remove the lockdown, we get R &amp;gt; 1 again. So, a single leftover (or imported ) can cause a spike in cases that's almost as bad as if we'd done Scenario 0: Absolutely Nothing.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A lockdown isn't a cure, it's just a restart.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, what, do we just lockdown again &amp;amp; again?&lt;/p&gt;
&lt;h3 id=&quot;toc_3&quot;&gt;Scenario 3: Intermittent Lockdown&lt;/h3&gt;
&lt;p&gt;This solution was first suggested by the March 16 Imperial College report, and later again by a Harvard paper.&lt;sup id=&quot;fnref19&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn19&quot; rel=&quot;footnote&quot;&gt;19&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Here's a simulation:&lt;/strong&gt; (After playing the &quot;recorded scenario&quot;, you can try simulating your &lt;em&gt;own&lt;/em&gt; lockdown schedule, by changing the sliders &lt;em&gt;while&lt;/em&gt; the simulation is running! Remember you can pause &amp;amp; continue the sim, and change the simulation speed)&lt;/p&gt;

&lt;p&gt;This &lt;em&gt;would&lt;/em&gt; keep cases below ICU capacity! And it's &lt;em&gt;much&lt;/em&gt; better than an 18-month lockdown until a vaccine is available. We just need to... shut down for a few months, open up for a few months, and repeat until a vaccine is available. (And if there's no vaccine, repeat until herd immunity is reached... in 2022.)&lt;/p&gt;
&lt;p&gt;Look, it's nice to draw a line saying &quot;ICU capacity&quot;, but there's lots of important things we &lt;em&gt;can't&lt;/em&gt; simulate here. Like:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mental Health:&lt;/strong&gt; Loneliness is one of the biggest risk factors for depression, anxiety, and suicide. And it's as associated with an early death as smoking 15 cigarettes a day.&lt;sup id=&quot;fnref20&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn20&quot; rel=&quot;footnote&quot;&gt;20&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Financial Health:&lt;/strong&gt; &quot;What about the economy&quot; sounds like you care more about dollars than lives, but &quot;the economy&quot; isn't just stocks: it's people's ability to provide food &amp;amp; shelter for their loved ones, to invest in their kids' futures, and enjoy arts, foods, videogames – the stuff that makes life worth living. And besides, poverty &lt;em&gt;itself&lt;/em&gt; has horrible impacts on mental and physical health.&lt;/p&gt;
&lt;p&gt;Not saying we &lt;em&gt;shouldn't&lt;/em&gt; lock down again! We'll look at &quot;circuit breaker&quot; lockdowns later. Still, it's not ideal.&lt;/p&gt;
&lt;p&gt;But wait... haven't Taiwan and South Korea &lt;em&gt;already&lt;/em&gt; contained COVID-19? For 4 whole months, &lt;em&gt;without&lt;/em&gt; long-term lockdowns?&lt;/p&gt;
&lt;p&gt;How?&lt;/p&gt;
&lt;h3 id=&quot;toc_4&quot;&gt;Scenario 4: Test, Trace, Isolate&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;&quot;Sure, we *could've* done what Taiwan &amp;amp; South Korea did at the start, but it's too late now. We missed the start.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;But that's exactly it! “A lockdown isn't a cure, it's just a restart”... &lt;strong&gt;and a fresh start is what we need.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;To understand how Taiwan &amp;amp; South Korea contained COVID-19, we need to understand the exact timeline of a typical COVID-19 infection&lt;sup id=&quot;fnref21&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn21&quot; rel=&quot;footnote&quot;&gt;21&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/timeline1.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;If cases only self-isolate when they know they're sick (that is, they feel symptoms), the virus can still spread:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/timeline2.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;And in fact, 44% of all transmissions are like this: &lt;em&gt;pre&lt;/em&gt;-symptomatic! &lt;sup id=&quot;fnref22&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn22&quot; rel=&quot;footnote&quot;&gt;22&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;But, if we find &lt;em&gt;and quarantine&lt;/em&gt; a symptomatic case's recent close contacts... we stop the spread, by staying one step ahead!&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/timeline3.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;This is called &lt;strong&gt;contact tracing&lt;/strong&gt;. It's an old idea, was used at an unprecedented scale to contain Ebola&lt;sup id=&quot;fnref23&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn23&quot; rel=&quot;footnote&quot;&gt;23&lt;/a&gt;&lt;/sup&gt;, and now it's core part of how Taiwan &amp;amp; South Korea are containing COVID-19!&lt;/p&gt;
&lt;p&gt;(It also lets us use our limited tests more efficiently, to find pre-symptomatic s without needing to test almost everyone.)&lt;/p&gt;
&lt;p&gt;Traditionally, contacts are found with in-person interviews, but those &lt;em&gt;alone&lt;/em&gt; are too slow for COVID-19's ~48 hour window. That's why contact tracers need help, and be supported by – &lt;em&gt;NOT&lt;/em&gt; replaced by – contact tracing apps.&lt;/p&gt;
&lt;p&gt;(This idea didn't come from &quot;techies&quot;: using an app to fight COVID-19 was first proposed by &lt;a href=&quot;https://science.sciencemag.org/content/early/2020/04/09/science.abb6936&quot;&gt;a team of Oxford epidemiologists&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;Wait, apps that trace who you've been in contact with?... Does that mean giving up privacy, giving in to Big Brother?&lt;/p&gt;
&lt;p&gt;Heck no! &lt;strong&gt;&lt;a href=&quot;https://github.com/DP-3T/documents#decentralized-privacy-preserving-proximity-tracing&quot;&gt;DP-3T&lt;/a&gt;&lt;/strong&gt;, a team of epidemiologists &amp;amp; cryptographers (including one of us, Marcel Salathé) is &lt;em&gt;already&lt;/em&gt; making a contact tracing app – with code available to the public – that reveals &lt;strong&gt;no info about your identity, location, who your contacts are, or even &lt;em&gt;how many contacts&lt;/em&gt; you've had.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here's how it works:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/dp3t.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;(&amp;amp; &lt;a href=&quot;https://ncase.me/contact-tracing/&quot;&gt;here's the full comic&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Along with similar teams like TCN Protocol&lt;sup id=&quot;fnref24&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn24&quot; rel=&quot;footnote&quot;&gt;24&lt;/a&gt;&lt;/sup&gt; and MIT PACT&lt;sup id=&quot;fnref25&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn25&quot; rel=&quot;footnote&quot;&gt;25&lt;/a&gt;&lt;/sup&gt;, they've inspired Apple &amp;amp; Google to bake privacy-first contact tracing directly into Android/iOS.&lt;sup id=&quot;fnref26&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn26&quot; rel=&quot;footnote&quot;&gt;26&lt;/a&gt;&lt;/sup&gt; (Don't trust Google/Apple? Good! The beauty of this system is it doesn't &lt;em&gt;need&lt;/em&gt; trust!) Soon, your local public health agency may ask you to download an app. If it's privacy-first with publicly-available code, please do!&lt;/p&gt;
&lt;p&gt;But what about folks without smartphones? Or infections through doorknobs? Or &quot;true&quot; asymptomatic cases? Contact tracing apps can't catch all transmissions... &lt;em&gt;and that's okay!&lt;/em&gt; We don't need to catch &lt;em&gt;all&lt;/em&gt; transmissions, just 60%+ to get R &amp;lt; 1.&lt;/p&gt;
&lt;p&gt;(Rant about the confusion about pre-symptomatic vs &quot;true&quot; asymptomatic. &quot;True&quot; asymptomatics are rare:&lt;sup id=&quot;fnref27&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn27&quot; rel=&quot;footnote&quot;&gt;27&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;
&lt;p&gt;Isolating &lt;em&gt;symptomatic&lt;/em&gt; cases would reduce R by up to 40%, and quarantining their &lt;em&gt;pre/a-symptomatic&lt;/em&gt; contacts would reduce R by up to 50%&lt;sup id=&quot;fnref28&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn28&quot; rel=&quot;footnote&quot;&gt;28&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;p&gt;Thus, even without 100% contact quarantining, we can get R &amp;lt; 1 &lt;em&gt;without a lockdown!&lt;/em&gt; Much better for our mental &amp;amp; financial health. (As for the cost to folks who have to self-isolate/quarantine, &lt;em&gt;governments should support them&lt;/em&gt; – pay for the tests, job protection, subsidized paid leave, etc. Still way cheaper than intermittent lockdown.)&lt;/p&gt;
&lt;p&gt;We then keep R &amp;lt; 1 until we have a vaccine, which turns susceptible s into immune s. Herd immunity, the &lt;em&gt;right&lt;/em&gt; way:&lt;/p&gt;

&lt;p&gt;(Note: this calculator pretends the vaccines are 100% effective. Just remember that in reality, you'd have to compensate by vaccinating &lt;em&gt;more&lt;/em&gt; than &quot;herd immunity&quot;, to &lt;em&gt;actually&lt;/em&gt; get herd immunity)&lt;/p&gt;
&lt;p&gt;Okay, enough talk. Here's a simulation of:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;A few-month lockdown, until we can...&lt;/li&gt;
&lt;li&gt;Switch to &quot;Test, Trace, Isolate&quot; until we can...&lt;/li&gt;
&lt;li&gt;Vaccinate enough people, which means...&lt;/li&gt;
&lt;li&gt;We win.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So that's it! That's how we make an emergency landing on this plane.&lt;/p&gt;
&lt;p&gt;That's how we beat COVID-19.&lt;/p&gt;
&lt;p&gt;...&lt;/p&gt;
&lt;p&gt;But what if things &lt;em&gt;still&lt;/em&gt; go wrong? Things have gone horribly wrong already. That's fear, and that's good! Fear gives us energy to create &lt;em&gt;backup plans&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The pessimist invents the parachute.&lt;/p&gt;
&lt;h3 id=&quot;toc_5&quot;&gt;Scenario 4+: Masks For All, Summer, Circuit Breakers&lt;/h3&gt;
&lt;p&gt;What if R&lt;sub&gt;0&lt;/sub&gt; is way higher than we thought, and the above interventions, even with mild distancing, &lt;em&gt;still&lt;/em&gt; aren't enough to get R &amp;lt; 1?&lt;/p&gt;
&lt;p&gt;Remember, even if we can't get R &amp;lt; 1, reducing R still reduces the &quot;overshoot&quot; in total cases, thus saving lives. But still, R &amp;lt; 1 is the ideal, so here's a few other ways to reduce R:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Masks For All:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&quot;Wait,&quot;&lt;/em&gt; you might ask, &lt;em&gt;&quot;I thought face masks don't stop you from getting sick?&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You're right. Masks don't stop you from getting sick&lt;sup id=&quot;fnref29&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn29&quot; rel=&quot;footnote&quot;&gt;29&lt;/a&gt;&lt;/sup&gt;... they stop you from getting &lt;em&gt;others&lt;/em&gt; sick.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/masks.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;To put a number on it: surgical masks &lt;em&gt;on the sick person&lt;/em&gt; reduce cold &amp;amp; flu viruses in aerosols by 70%.&lt;sup id=&quot;fnref30&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn30&quot; rel=&quot;footnote&quot;&gt;30&lt;/a&gt;&lt;/sup&gt; Reducing transmissions by 70% would be as large an impact as a lockdown!&lt;/p&gt;
&lt;p&gt;However, we don't know for sure the impact of masks on COVID-19 &lt;em&gt;specifically&lt;/em&gt;. In science, one should only publish a finding if you're 95% sure of it. (...should.&lt;sup id=&quot;fnref31&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn31&quot; rel=&quot;footnote&quot;&gt;31&lt;/a&gt;&lt;/sup&gt;) Masks, as of May 1st 2020, are less than &quot;95% sure&quot;.&lt;/p&gt;
&lt;p&gt;However, pandemics are like poker. &lt;strong&gt;Make bets only when you're 95% sure, and you'll lose everything at stake.&lt;/strong&gt; As a recent article on masks in the British Medical Journal notes,&lt;sup id=&quot;fnref32&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn32&quot; rel=&quot;footnote&quot;&gt;32&lt;/a&gt;&lt;/sup&gt; we &lt;em&gt;have&lt;/em&gt; to make cost/benefit analyses under uncertainty. Like so:&lt;/p&gt;
&lt;p&gt;Cost: If homemade cloth masks (which are ~2/3 as effective as surgical masks&lt;sup id=&quot;fnref33&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn33&quot; rel=&quot;footnote&quot;&gt;33&lt;/a&gt;&lt;/sup&gt;), super cheap. If surgical masks, more expensive but still pretty cheap.&lt;/p&gt;
&lt;p&gt;Benefit: Even if it's a 50–50 chance of surgical masks reducing transmission by 0% or 70%, the average &quot;expected value&quot; is still 35%, same as a half-lockdown! So let's guess-timate that surgical masks reduce R by up to 35%, discounted for our uncertainty. (Again, you can challenge our assumptions by turning the sliders up/down)&lt;/p&gt;

&lt;p&gt;(other arguments for/against masks:&lt;sup id=&quot;fnref34&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn34&quot; rel=&quot;footnote&quot;&gt;34&lt;/a&gt;&lt;/sup&gt;)&lt;/p&gt;
&lt;p&gt;Masks &lt;em&gt;alone&lt;/em&gt; won't get R &amp;lt; 1. But if handwashing &amp;amp; &quot;Test, Trace, Isolate&quot; only gets us to R = 1.10, having just 1/3 of people wear masks would tip that over to R &amp;lt; 1, virus contained!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summer:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Okay, this isn't an &quot;intervention&quot; we can control, but it will help! Some news outlets report that summer won't do anything to COVID-19. They're half right: summer won't get R &amp;lt; 1, but it &lt;em&gt;will&lt;/em&gt; reduce R.&lt;/p&gt;
&lt;p&gt;For COVID-19, every extra 1° Celsius (2.2° Fahrenheit) makes R drop by 1.2%.&lt;sup id=&quot;fnref35&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn35&quot; rel=&quot;footnote&quot;&gt;35&lt;/a&gt;&lt;/sup&gt; The summer-winter difference in New York City is 15°C (60°F), so summer will make R drop by 18%.&lt;/p&gt;

&lt;p&gt;Summer alone won't make R &amp;lt; 1, but if we have limited resources, we can scale back some interventions in the summer – so we can scale them &lt;em&gt;higher&lt;/em&gt; in the winter.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;A &quot;Circuit Breaker&quot; Lockdown:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;And if all that &lt;em&gt;still&lt;/em&gt; isn't enough to get R &amp;lt; 1... we can do another lockdown.&lt;/p&gt;
&lt;p&gt;But we wouldn't have to be 2-months-closed / 1-month-open over &amp;amp; over! Because R is reduced, we'd only need one or two more &quot;circuit breaker&quot; lockdowns before a vaccine is available. (Singapore had to do this recently, &quot;despite&quot; having controlled COVID-19 for 4 months. That's not failure: this &lt;em&gt;is&lt;/em&gt; what success takes.)&lt;/p&gt;
&lt;p&gt;Here's a simulation a &quot;lazy case&quot; scenario:&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Lockdown, then&lt;/li&gt;
&lt;li&gt;A moderate amount of hygiene &amp;amp; &quot;Test, Trace, Isolate&quot;, with a mild amount of &quot;Masks For All&quot;, then...&lt;/li&gt;
&lt;li&gt;One more &quot;circuit breaker&quot; lockdown before a vaccine's found.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Not to mention all the &lt;em&gt;other&lt;/em&gt; interventions we could do, to further push R down:&lt;/p&gt;
&lt;p&gt;. . .&lt;/p&gt;
&lt;p&gt;We hope these plans give you hope.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Even under a pessimistic scenario, it &lt;em&gt;is&lt;/em&gt; possible to beat COVID-19, while protecting our mental and financial health.&lt;/strong&gt; Use the lockdown as a &quot;reset button&quot;, keep R &amp;lt; 1 with case isolation + privacy-protecting contract tracing + at &lt;em&gt;least&lt;/em&gt; cloth masks for all... and life can get back to a normal-ish!&lt;/p&gt;
&lt;p&gt;Sure, you may have dried-out hands. But you'll get to invite a date out to a comics bookstore! You'll get to go out with friends to watch the latest Hollywood cash-grab. You'll get to people-watch at a library, taking joy in people going about the simple business of &lt;em&gt;being alive.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Even under the worst-case scenario... life perseveres.&lt;/p&gt;
&lt;p&gt;So now, let's plan for some &lt;em&gt;worse&lt;/em&gt; worst-case scenarios. Water landing, get your life jacket, and please follow the lights to the emergency exits:&lt;/p&gt;
&lt;div class=&quot;section chapter&quot;&gt;
&lt;div&gt;&lt;img src=&quot;https://ncase.me/covid-19/banners/curve.png&quot; height=&quot;480&quot;/&gt;&lt;p&gt;The Next Few Years&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;You get COVID-19, and recover. Or you get the COVID-19 vaccine. Either way, you're now immune...&lt;/p&gt;
&lt;p&gt;...&lt;em&gt;for how long?&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;COVID-19 is most closely related to SARS, which gave its survivors 2 years of immunity.&lt;sup id=&quot;fnref36&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn36&quot; rel=&quot;footnote&quot;&gt;36&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;The coronaviruses that cause &quot;the&quot; common cold give you 8 months of immunity.&lt;sup id=&quot;fnref37&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn37&quot; rel=&quot;footnote&quot;&gt;37&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;There's reports of folks recovering from COVID-19, then testing positive again, but it's unclear if these are false positives.&lt;sup id=&quot;fnref38&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn38&quot; rel=&quot;footnote&quot;&gt;38&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;One &lt;em&gt;not-yet-peer-reviewed&lt;/em&gt; study on monkeys showed immunity to the COVID-19 coronavirus for at least 28 days.&lt;sup id=&quot;fnref39&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn39&quot; rel=&quot;footnote&quot;&gt;39&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;But for COVID-19 &lt;em&gt;in humans&lt;/em&gt;, as of May 1st 2020, &quot;how long&quot; is the big unknown.&lt;/p&gt;
&lt;p&gt;For these simulations, let's say it's 1 year. &lt;strong&gt;Here's a simulation starting with 100%&lt;/strong&gt; , exponentially decaying into susceptible, no-immunity s after 1 year, on &lt;em&gt;average&lt;/em&gt;, with variation:&lt;/p&gt;

&lt;p&gt;Return of the exponential decay!&lt;/p&gt;
&lt;p&gt;This is the &lt;strong&gt;SEIRS Model&lt;/strong&gt;. The final &quot;S&quot; stands for Susceptible, again.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/seirs.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Now, let's simulate a COVID-19 outbreak, over 10 years, with no interventions... &lt;em&gt;if immunity only lasts a year:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;In previous simulations, we only had &lt;em&gt;one&lt;/em&gt; ICU-overwhelming spike. Now, we have several, &lt;em&gt;and&lt;/em&gt; cases come to a rest &lt;em&gt;permanently at&lt;/em&gt; ICU capacity. (Which, remember, we &lt;em&gt;tripled&lt;/em&gt; for these simulations)&lt;/p&gt;
&lt;p&gt;R = 1, it's &lt;strong&gt;endemic.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Thankfully, because summer reduces R, it'll make the situation better:&lt;/p&gt;

&lt;p&gt;Oh.&lt;/p&gt;
&lt;p&gt;Counterintuitively, summer makes the spikes worse &lt;em&gt;and&lt;/em&gt; regular! This is because summer reduces new s, but that in turn reduces new immune s. Which means immunity plummets in the summer, &lt;em&gt;creating&lt;/em&gt; large regular spikes in the winter.&lt;/p&gt;
&lt;p&gt;Thankfully, the solution to this is pretty straightforward – just vaccinate people every fall/winter, like we do with flu shots:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(After playing the recording, try simulating your own vaccination campaigns! Remember you can pause/continue the sim at any time)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;But here's the scarier question:&lt;/p&gt;
&lt;p&gt;What if there's no vaccine for &lt;em&gt;years&lt;/em&gt;? Or &lt;em&gt;ever?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;To be clear: this is unlikely.&lt;/strong&gt; Most epidemiologists expect a vaccine in 1 to 2 years. Sure, there's never been a vaccine for any of the other coronaviruses before, but that's because SARS was eradicated quickly, and &quot;the&quot; common cold wasn't worth the investment.&lt;/p&gt;
&lt;p&gt;Still, infectious disease researchers have expressed worries: What if we can't make enough?&lt;sup id=&quot;fnref40&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn40&quot; rel=&quot;footnote&quot;&gt;40&lt;/a&gt;&lt;/sup&gt; What if we rush it, and it's not safe?&lt;sup id=&quot;fnref41&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn41&quot; rel=&quot;footnote&quot;&gt;41&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;Even in the nightmare &quot;no-vaccine&quot; scenario, we still have 3 ways out. From most to least terrible:&lt;/p&gt;
&lt;p&gt;1) Do intermittent or loose R &amp;lt; 1 interventions, to reach &quot;natural herd immunity&quot;. (Warning: this will result in many deaths &amp;amp; damaged lungs. &lt;em&gt;And&lt;/em&gt; won't work if immunity doesn't last.)&lt;/p&gt;
&lt;p&gt;2) Do the R &amp;lt; 1 interventions forever. Contact tracing &amp;amp; wearing masks just becomes a new norm in the post-COVID-19 world, like how STI tests &amp;amp; wearing condoms became a new norm in the post-HIV world.&lt;/p&gt;
&lt;p&gt;3) Do the R &amp;lt; 1 interventions until we develop treatments that make COVID-19 way, way less likely to need critical care. (Which we should be doing &lt;em&gt;anyway!&lt;/em&gt;) Reducing ICU use by 10x is the same as increasing our ICU capacity by 10x:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Here's a simulation of &lt;em&gt;no&lt;/em&gt; lasting immunity, &lt;em&gt;no&lt;/em&gt; vaccine, and not even any interventions – just slowly increasing capacity to survive the long-term spikes:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Even under the &lt;em&gt;worst&lt;/em&gt; worst-case scenario... life perseveres.&lt;/p&gt;
&lt;p&gt;. . .&lt;/p&gt;
&lt;p&gt;Maybe you'd like to challenge our assumptions, and try different R&lt;sub&gt;0&lt;/sub&gt;'s or numbers. Or try simulating your &lt;em&gt;own&lt;/em&gt; combination of intervention plans!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Here's an (optional) Sandbox Mode, with &lt;em&gt;everything&lt;/em&gt; available. (scroll to see all controls) Simulate &amp;amp; play around to your heart's content:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This basic &quot;epidemic flight simulator&quot; has taught us so much. It's let us answer questions about the past few months, next few months, and next few years.&lt;/p&gt;
&lt;p&gt;So finally, let's return to...&lt;/p&gt;
&lt;div class=&quot;section chapter&quot;&gt;
&lt;div&gt;&lt;img src=&quot;https://ncase.me/covid-19/banners/curve.png&quot; height=&quot;480&quot;/&gt;&lt;p&gt;The Now&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Plane's sunk. We've scrambled onto the life rafts. It's time to find dry land.&lt;sup id=&quot;fnref42&quot;&gt;&lt;a href=&quot;https://ncase.me/covid-19/#fn42&quot; rel=&quot;footnote&quot;&gt;42&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;Teams of epidemiologists and policymakers (&lt;a href=&quot;https://www.americanprogress.org/issues/healthcare/news/2020/04/03/482613/national-state-plan-end-coronavirus-crisis/&quot;&gt;left&lt;/a&gt;, &lt;a href=&quot;https://www.aei.org/research-products/report/national-coronavirus-response-a-road-map-to-reopening/&quot;&gt;right&lt;/a&gt;, and &lt;a href=&quot;https://ethics.harvard.edu/covid-roadmap&quot;&gt;multi-partisan&lt;/a&gt;) have come to a consensus on how to beat COVID-19, while protecting our lives &lt;em&gt;and&lt;/em&gt; liberties.&lt;/p&gt;
&lt;p&gt;Here's the rough idea, with some (less-consensus) backup plans:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ncase.me/covid-19/pics/plan.png&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;
&lt;p&gt;So what does this mean for YOU, right now?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For everyone:&lt;/strong&gt; Respect the lockdown so we can get out of Phase I asap. Keep washing those hands. Make your own masks. Download a &lt;em&gt;privacy-protecting&lt;/em&gt; contact tracing app when those are available next month. Stay healthy, physically &amp;amp; mentally! And write your local policymaker to get off their butt and...&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For policymakers:&lt;/strong&gt; Make laws to support folks who have to self-isolate/quarantine. Hire more manual contact tracers, &lt;em&gt;supported&lt;/em&gt; by privacy-protecting contact tracing apps. Direct more funds into the stuff we should be building, like...&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;For builders:&lt;/strong&gt; Build tests. Build ventilators. Build personal protective equipment for hospitals. Build tests. Build masks. Build apps. Build antivirals, prophylactics, and other treatments that aren't vaccines. Build vaccines. Build tests. Build tests. Build tests. Build hope.&lt;/p&gt;
&lt;p&gt;Don't downplay fear to build up hope. Our fear should &lt;em&gt;team up&lt;/em&gt; with our hope, like the inventors of airplanes &amp;amp; parachutes. Preparing for horrible futures is how we &lt;em&gt;create&lt;/em&gt; a hopeful future.&lt;/p&gt;
&lt;p&gt;The only thing to fear is the idea that the only thing to fear is fear itself.&lt;/p&gt;

&lt;/div&gt;</description>
<pubDate>Sat, 02 May 2020 09:35:44 +0000</pubDate>
<dc:creator>blopeur</dc:creator>
<og:title>What Happens Next? COVID-19 Futures, Explained With Playable Simulations</og:title>
<og:type>website</og:type>
<og:url>https://ncase.me/covid-19/</og:url>
<og:image>https://ncase.me/covid-19/sharing/thumbnail.png</og:image>
<og:description>an interactive guide</og:description>
<dc:format>text/html</dc:format>
<dc:identifier>https://ncase.me/covid-19/</dc:identifier>
</item>
<item>
<title>India orders coronavirus tracing app for all workers</title>
<link>https://www.reuters.com/article/us-health-coronavirus-india-app/india-makes-government-tracing-app-mandatory-for-all-workers-idUSKBN22E07K</link>
<guid isPermaLink="true" >https://www.reuters.com/article/us-health-coronavirus-india-app/india-makes-government-tracing-app-mandatory-for-all-workers-idUSKBN22E07K</guid>
<description>&lt;p&gt;NEW DELHI (Reuters) - India has ordered all public and private sector employees use a government-backed contact tracing app and maintain social distancing in offices as it begins easing some of its lockdown measures in districts less affected by the coronavirus.&lt;/p&gt;
&lt;div class=&quot;PrimaryAsset_container&quot; readability=&quot;8.5&quot;&gt;
&lt;div class=&quot;Image_container&quot; tabindex=&quot;-1&quot; readability=&quot;12&quot;&gt;
&lt;div class=&quot;LazyImage_container LazyImage_dark&quot;&gt;&lt;img src=&quot;https://s4.reutersmedia.net/resources/r/?m=02&amp;amp;d=20200502&amp;amp;t=2&amp;amp;i=1517233148&amp;amp;r=LYNXMPEG4105V&amp;amp;w=20&quot; aria-label=&quot;FILE PHOTO: Employees wearing protective masks work inside a call centre run by Uttar Pradesh state police during an extended lockdown to slow the spreading of coronavirus disease (COVID-19) in Lucknow, India, April 21, 2020. REUTERS/ Pawan Kumar&quot;/&gt;
&lt;/div&gt;

&lt;p&gt;&lt;span&gt;FILE PHOTO: Employees wearing protective masks work inside a call centre run by Uttar Pradesh state police during an extended lockdown to slow the spreading of coronavirus disease (COVID-19) in Lucknow, India, April 21, 2020. REUTERS/ Pawan Kumar&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Prime Minister Narendra Modi’s government said on Friday India, with the world’s second-largest population after China, would extend nationwide curbs for another two weeks from Monday, but allow “considerable relaxations” in lower-risk areas.&lt;/p&gt;
&lt;p&gt;India last month launched the Aarogya Setu (Health Bridge) app, a Bluetooth and GPS-based system that alerts users who may have come in contact with people who later test positive for COVID-19.&lt;/p&gt;
&lt;p&gt;“Use of Aarogya Setu shall be made mandatory for all employees, both private and public,” the Ministry of Home Affairs said late on Friday.&lt;/p&gt;
&lt;p&gt;Company heads will be held responsible “to ensure 100% coverage” among employees.&lt;/p&gt;
&lt;p&gt;Officials at the technology ministry and a lawyer who framed the privacy policy for Aarogya Setu told Reuters the app needed to be on at least 200 million phones for it to be effective in a population of 1.3 billion.&lt;/p&gt;
&lt;p&gt;The app has been downloaded around 83 million times in total in a country with a smartphone user base of about 500 million, according to the technology ministry.&lt;/p&gt;
&lt;p&gt;The app’s compulsory use is raising concerns among privacy advocates, who say it is unclear how the data will be used and who stress that India lacks privacy laws to govern the app.&lt;/p&gt;
&lt;p&gt;“Such a move should be backed by a dedicated law which provides strong data protection cover and is under the oversight of an independent body,” said Udbhav Tiwari, Public Policy Advisor for internet browser company Mozilla.&lt;/p&gt;
&lt;p&gt;New Delhi has said the app will not infringe on privacy as all data is collected anonymously.&lt;/p&gt;
&lt;p&gt;The app can help authorities identify virus hotspots and better target health efforts, the tech ministry told Reuters in late April, adding information would be used “only for administering necessary medical interventions”.&lt;/p&gt;
&lt;p&gt;Critics also note that about 400 million of India’s population do not possess smartphones and would not be covered.&lt;/p&gt;
&lt;p&gt;The government on Friday said that re-opening offices would also have to ensure gaps between shifts and staggered lunch breaks to contain spread of the coronavirus that has infected 3.3 million worldwide and caused more than 230,000 deaths.&lt;/p&gt;
&lt;p&gt;India has reported more than 37,000 cases and 1,218 deaths.&lt;/p&gt;
&lt;p&gt;India is set to allow some factories to re-open and companies are scrambling to piece together their plans.&lt;/p&gt;
&lt;p&gt;Smartphone maker Lava is likely to open its plants in Noida, on the outskirts of New Delhi, next week, said co-founder S.N. Rai.&lt;/p&gt;
&lt;p&gt;Lava is asking its workers to temporarily move to a neighbouring village, where it has leased dormitories for about 800 workers and is proving food and transport, said Rai.&lt;/p&gt;
&lt;p&gt;“But even if we start production immediately, we will start with a maximum of 40% capacity,” said Rai.&lt;/p&gt;
&lt;p&gt;Other sectors such as the automobile industry are calling on the government to allow them to re-open.&lt;/p&gt;
&lt;p&gt;The automotive sector is losing revenue of 23 billion rupees ($304 million) a day, three lobby groups said in a letter to the home ministry, urging the government to allow component makers and dealers to begin operations.&lt;/p&gt;
&lt;div class=&quot;Attribution_container&quot; readability=&quot;6.5&quot;&gt;
&lt;div class=&quot;Attribution_attribution&quot; readability=&quot;8&quot;&gt;
&lt;p class=&quot;Attribution_content&quot;&gt;Reporting by Sankalp Phartiyal; Additional reporting by Aditi Shah; Editing by Alexandra Ulmer and Nick Macfie&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;StandardArticleBody_trustBadgeContainer&quot;&gt;&lt;span class=&quot;StandardArticleBody_trustBadgeTitle&quot;&gt;Our Standards:&lt;/span&gt;&lt;span class=&quot;trustBadgeUrl&quot;&gt;&lt;a href=&quot;http://thomsonreuters.com/en/about-us/trust-principles.html&quot;&gt;The Thomson Reuters Trust Principles.&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;
</description>
<pubDate>Sat, 02 May 2020 08:35:44 +0000</pubDate>
<dc:creator>caution</dc:creator>
<og:title>India orders coronavirus tracing app for all workers</og:title>
<og:url>https://www.reuters.com/article/us-health-coronavirus-india-app-idUSKBN22E07K</og:url>
<og:type>article</og:type>
<og:description>India has ordered all public and private sector employees use a government-backed contact tracing app and maintain social distancing in offices as it begins easing some of its lockdown measures in districts less affected by the coronavirus.</og:description>
<og:image>https://s4.reutersmedia.net/resources/r/?m=02&amp;d=20200502&amp;t=2&amp;i=1517233148&amp;w=1200&amp;r=LYNXMPEG4105V</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.reuters.com/article/us-health-coronavirus-india-app/india-makes-government-tracing-app-mandatory-for-all-workers-idUSKBN22E07K</dc:identifier>
</item>
<item>
<title>My First Year as a Freelance AI Engineer</title>
<link>http://masatohagiwara.net/202002-my-first-year-as-a-freelance-ai-engineer.html</link>
<guid isPermaLink="true" >http://masatohagiwara.net/202002-my-first-year-as-a-freelance-ai-engineer.html</guid>
<description>&lt;img src=&quot;http://masatohagiwara.net/img/wework.jpg&quot; alt=&quot;WeWork Labs in Seattle&quot;/&gt; WeWork Labs in Seattle
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;This week marks my one-year anniversary of quitting my full-time job and becoming an independent NLP/ML engineer and researcher (which I just call “freelance AI engineer” below). My experience so far has been very positive, and the past year was probably one of the most productive years in my entire career. My “achievements” in the past year include:&lt;/p&gt;
&lt;p&gt;Now, I believe that becoming a freelance AI engineer is a totally viable career choice (but only for those who are cut out for it—see below). A number of friends and people that I know asked what it’s like to be a freelancer. Many of them haven’t even heard of any “freelance researchers” before (yeah, me neither). That’s why I’m writing down my thoughts and experience here so that this might be useful if you are even vaguely interested.&lt;/p&gt;
&lt;h2&gt;Should you be a freelancer?&lt;/h2&gt;
&lt;p&gt;The answer is probably “no” for the vast majority of people. Being a freelancer is not for everyone. You need to be a type of person who enjoys being a freelancer. More on this later.&lt;/p&gt;
&lt;p&gt;You also have to be really good at what you do. Put yourself in the client’s shoes and think of this as hiring a contractor, be it a plumber or an attorney. You hire them because, by paying them, you expect that they can almost certainly solve your problem, not because you want them to be “part of your team” and work on the problem together, offering them opportunities for learning and growing, along with plenty of PTO days and free lunch.&lt;/p&gt;
&lt;p&gt;As a freelance AI engineer, you are expected to, for example, start with a client, familiarize yourself with the product and the codebase, submit the first PR within a couple of days, and complete your first business-metric impacting ML prototype or pipeline within the first couple of weeks. If you are just starting out in the AI field, I think your best bet is to go work at a large company (e.g., FAANG) with plenty of resources and growing opportunities, or at a fast-growing start-up (if you are not sure which one, I’ve heard good things about &lt;a href=&quot;https://www.duolingo.com/&quot;&gt;Duolingo&lt;/a&gt;) and build your experience as a full-time employee.&lt;/p&gt;
&lt;h2&gt;Getting paid&lt;/h2&gt;
&lt;p&gt;I charge hourly. I’ve never done project-based billing. I think AI projects are better suited for hourly billing, because it’s simply too hard to define the scope of work based on the deliverables.&lt;/p&gt;
&lt;p&gt;My current rate is $200/hour for short-term commitments (e.g., a couple hours per month) and $150/hour longer-term commitments (e.g., 10+ hours per week). There’s only one time when I was told my rate is too expensive, but most clients just take these rates as fixed. When clients can’t afford my rates, we usually negotiate in terms of the scope of work (e.g., hours per week) instead of the rate. The rates of an average US-based AI engineer with my skills are probably higher. I probably should increase my rates. I probably should have long ago...&lt;/p&gt;
&lt;p&gt;Thanks to the “AI boom” of recent years, it's completely a seller's market for freelance AI engineers (again, if you are good). You will never run out of client leads and inbound requests. I think a good rule of thumb is to keep increasing your rates until you start getting “no”s with a 50% chance. You are still left with the other 50%, which tend to be better clients anyways. As a side effect, you’ll get very good at saying no. My default answer is always no, and my schedule is always full (except when it’s not, as my current clients know).&lt;/p&gt;
&lt;h2&gt;Making a living&lt;/h2&gt;
&lt;a href=&quot;https://en.wikipedia.org/wiki/Prospect_theory&quot;&gt;&lt;img src=&quot;http://masatohagiwara.net/img/prospect_theory.png&quot; alt=&quot;The prospect theory is real&quot;/&gt; The prospect theory is real&lt;/a&gt;
&lt;p&gt;We have enough savings to keep us from being hungry for a couple of years even if I didn’t work at all, and my wife works full time, which was really helpful when I made the leap. Even with enough savings, though, cash flow fluctuation can have a noticeable impact on your sense of financial security. If you work with &lt;a href=&quot;https://en.wikipedia.org/wiki/Net_D&quot;&gt;net 30&lt;/a&gt; clients, for example, it takes two months to get paid after you start working for them. I had some short periods of time when we had negative cash flow (especially when we moved from Pittsburgh to Seattle last summer) that ate our savings, and I really felt the impact of loss aversion. You feel a lot worse losing a certain amount of money than you feel better gaining the same amount. If financial security is your priority, you should probably get a full-time job.&lt;/p&gt;
&lt;p&gt;Compared to when I was working full-time, I made less money but also worked fewer hours in the past year. I could totally have worked more to make more, but having small kids, spending time with my family is important.&lt;/p&gt;
&lt;h2&gt;Finding clients&lt;/h2&gt;
&lt;img src=&quot;http://masatohagiwara.net/img/wcnlp2019.jpg&quot; alt=&quot;West Coast NLP 2019&quot;/&gt; West Coast NLP 2019
&lt;p&gt;I found most of my current and past clients through my network. Conferences and workshops are also good sources of potential leads, especially when you give talks instead of just listening to them. When I find a potential client that I really want to work with, I apply directly from the “careers” page. A surprisingly large number of employees, especially start-ups, are open to remote and/or part-time commitments for the right candidates if you are upfront about it.&lt;/p&gt;
&lt;p&gt;As a freelancer, you are always on the lookout for potential clients, since most contracts don’t last more than several months. This is a big difference between being a full-time employee and a freelancer. At least when I was working full time, my “job search” was very bimodal—I was either not looking at all or looking actively. If you just want a stable job and a paycheck, freelancing is probably not a good idea.&lt;/p&gt;
&lt;h2&gt;Freedom&lt;/h2&gt;
&lt;img src=&quot;http://masatohagiwara.net/files/Seoul1.jpg&quot; alt=&quot;Seoul, 2018&quot;/&gt; Seoul, 2018
&lt;p&gt;People say the biggest perk of being a freelancer is freedom—you can work anywhere you like, anytime you want. This is probably not the most important factor, at least for me. Especially in the tech industry, many employers are already fine with employees working from anywhere and at anytime as long as they get things done. Even before becoming a freelancer I was able to work from home whenever necessary (for example, my kid getting sick), and in 2018, I even spent a month in South Korea working remotely while learning Korean. If you are thinking about becoming a freelancer just because of freedom of location or time, you should probably consider finding a better employer first.&lt;/p&gt;
&lt;p&gt;Being a freelancer, you have full control over how much you work. On the other hand, working full time, especially for a start-up, is very “binary”—basically you go all in or you are out. You are expected to work at your full potential. You can’t usually, say, work 20 hours per week to collect half the paycheck. Freelancers can do this fairly easily, which is one of the biggest perks of being independent.&lt;/p&gt;
&lt;p&gt;I’m also a type of person who always has tons of project ideas that I want to work on which may or may not be relevant to what I do for the employer that I happen to work for at that time. I’ve always considered myself more of an artist than an engineer/researcher, and being a freelancer is a natural consequence of this. If you work full time for a demanding job, good luck working on a side hustle or even finding energy for one at all. As a freelancer, everything becomes a side hustle. All the clients I work with know that I work with other people and on my own things and nobody cares (although some clients want to put a non-compete clause in the contract, which I fully respect).&lt;/p&gt;
&lt;h2&gt;Time management&lt;/h2&gt;
&lt;p&gt;As a freelancer, you need to be good at managing your time, which equals your clients’ money. I’m a huge fan of &lt;a href=&quot;https://en.wikipedia.org/wiki/Pomodoro_Technique&quot;&gt;the Pomodoro technique&lt;/a&gt; and manage all my work with pomodoros (oops, I meant &lt;em&gt;pomodori&lt;/em&gt;). I can reliably do about 80 pomodori (= 40 hours) in a typical work week. If you’ve ever used the Pomodoro technique, you’d probably know how hard that would be and how much work that is. If you haven’t, you should seriously consider giving it a try—you’d realize how hard it is to actually “work” for 8 hours in a day (i.e., no web surfing, no phone checking, no useless Slack chats, etc.). I use &lt;a href=&quot;https://freedom.to/&quot;&gt;Freedom&lt;/a&gt; on my laptop and &lt;a href=&quot;https://play.google.com/store/apps/details?id=com.stayfocused&amp;amp;hl=en_US&quot;&gt;Stay Focused&lt;/a&gt; on my phone to block distracting sites during the day. I can’t even imagine how I’d possibly be working without them.&lt;/p&gt;
&lt;p&gt;Not all of these 40 hours are billable, though. These include personal and work-related overhead such as learning (see below), sending invoices, managing your budget, etc. Also, if you work on research, you need to take into account the time you spend for academic activities. If you take on paper reviews for a conference, count that in. If you are an organizer of a workshop, count that in as well. This helps you be realistic about your “quota” you can use for each one of your activities. Before starting a week, I lay out the plan in a form of bullet points and the expected number of pomodori associated with each activity. This works a lot better than having a kitchen sink “TODO list” and always lamenting your lack of time.&lt;/p&gt;
&lt;p&gt;Many of my clients don’t require regular “check-ins,” and currently I spend only 2–3 hours in meetings in a typical week. Meetings have huge spillover effects and really take their toll on me. For example, if I even have a single meeting in the afternoon, I tend to start vaguely thinking what I’d talk about, if there’s any preparation necessary (including booking a room), etc. After the meeting, I would recall what we talked about and any necessary follow-ups. All these spillover effects, albeit small, fragment the state of the flow and significantly lower my productivity. Because I spend so little time in meetings, most days I find huge consecutive chunks of time I can spend working, which really helps keep my sanity.&lt;/p&gt;
&lt;h2&gt;Work&lt;/h2&gt;
&lt;a href=&quot;https://xkcd.com/1425/&quot;&gt;&lt;img src=&quot;https://imgs.xkcd.com/comics/tasks.png&quot; alt=&quot;Obligatory xkcd reference&quot;/&gt; Obligatory xkcd reference&lt;/a&gt;
&lt;p&gt;So far, this article has had very little to do with the “AI” part. What do I actually &lt;em&gt;do&lt;/em&gt;? In the past year, I wore many different hats—consultant, engineer, and researcher. For some clients, I have meetings and offer advice on how they should go about implementing AI projects. For others, I write code as a contract software engineer. For yet others, I work on research and co-author papers. For many, however, it’s a mix of all of these.&lt;/p&gt;
&lt;p&gt;I think modern machine learning work is suitable for part-time commitments. If you are working on large models, it is not uncommon that training takes hours, if not days. Machine learning researchers and practitioners alike know how much time they spend training models and tuning hyperparameters. If you work full time, you have no option but to wait until the training is done or switch to other projects, if you have any. As a freelancer, you just switch between clients.&lt;/p&gt;
&lt;p&gt;As an ML freelancer, you need to have a strategy for securing GPU resources for training models. Some clients are kind enough that they just let me use their own infrastructure, but others may not (usually contractors’ access is very limited for security reasons). For my personal and small client projects, I just spawn AWS spot instances (usually a p3.2xlarge) as needed, using my own custom AMI. I also have a smaller GPU instance on GCP that I start and stop as needed. I don’t train huge 128-layer Transformer models on TPUs (not just yet) or use GPUs 24/7, so this on-demand solution has sufficed so far.&lt;/p&gt;
&lt;p&gt;If you work in AI, it is critical that you allocate time for learning and personal development. If you are working full time, it’s usually part of your day job, and you usually spend time reading papers and having “reading groups” during work hours. As a freelancer, these hours are usually not billable. You can’t usually bill a client for three hours just because you spent this much time reading papers last week (if you know such a client, or if you &lt;em&gt;are&lt;/em&gt; such a client, do let me know). Remember, you are a professional who was hired to solve client’s problems, not to learn about AI, and everyone expects that you are already well read about and caught up with the latest AI development (I know, I know... has anyone ever been caught up with even a single domain of AI these days?) I think this is a price you need to pay in exchange for the higher rates you can enjoy as an AI freelancer.&lt;/p&gt;
&lt;p&gt;I live in Seattle, but I’m not sure if it helps with being a freelancer at all. I work remotely and rarely travel for work, except when I present at conferences. I work with &lt;a href=&quot;https://allenai.org/&quot;&gt;Allen AI&lt;/a&gt;, and it’s nice that I can simply drop by on short notice and have lunch with the team, although I would be able to do my work even if I was on the other side of the earth. If you work remotely, I think you’d be better off if you lived in a cheaper city and work with clients in other large tech hubs.&lt;/p&gt;
&lt;h2&gt;Career development&lt;/h2&gt;
&lt;a href=&quot;https://codeandsupply.co/&quot;&gt;&lt;img src=&quot;http://masatohagiwara.net/img/codeandsupply.jpg&quot; alt=&quot;Code &amp;amp; Supply, a co-working space in Pittsburgh&quot;/&gt; Code &amp;amp; Supply, a co-working space in Pittsburgh&lt;/a&gt;
&lt;p&gt;There are definitely ways to develop your career and become more experienced as a freelancer, but these look very different from full-time jobs. I’m just starting out, so I might have different opinions next year.&lt;/p&gt;
&lt;p&gt;There are usually no pay raises baked into the contracts, unless you negotiate. But you can gradually raise your rates (say, twice a year) until people start to say no. For this reason, I think it is probably easier to make more as a freelancer than as a full-time employee who needs to rely on performance reviews and promotions that are often out of your control.&lt;/p&gt;
&lt;p&gt;Speaking of promotions—as a freelancer, you can stay immune to office politics. You either get the job done or you don’t. You don’t need to be constantly thinking which boss you should be brown-nosing in order to get your next promotion. The flip side of this is you usually don’t gain management experience as a freelancer, although I do mentor junior devs and researchers who work for my clients.&lt;/p&gt;
&lt;p&gt;I think it helps to think of yourself as a specialist, not a generalist. For example, if you have a serious health issue that requires a very complicated surgery, you probably don’t want your family doctor to work on it. If you have a complicated lawsuit that involves millions of dollars at stake, you probably don’t ask your personal tax accountant to give you advice. It’d be your best interest if you don’t just “do AI.” If you are an AI generalist who just does “predictive modeling” and “text analytics” using scikit-learn, you’d probably attract desperate start-ups or product teams that simply want to have the word “AI” on their PowerPoint slides, and you’d need to compete with tons of other generalist “AI devs” on Upwork who live in countries where wages are way cheaper than yours. Narrowing your niche down attracts specific types of clients who have specific needs that few people in the world can solve.&lt;/p&gt;
&lt;p&gt;My expertise is NLP/ML for Asian language processing and language education. When defining your specialty, I think it helps if you define it in terms of the industry, not in terms of an ML stack. People look for, e.g., “AI solutions for healthcare” and “text analytics for finance,” not for “GANs” or “Seq2Seq models.” You need to be willing to learn a very wide range of ML techniques and models, from simple regression to GANs and RL, no matter what industry you work in.&lt;/p&gt;
&lt;p&gt;If you are even vaguely interested in starting your own business, especially a B-to-B SaaS business, I think working as a freelancer for a year or so is a great way to learn about the market demands and transition into the entrepreneurial endeavor. If you work with multiple clients and projects in your field, you will surely notice some common patterns and needs. These are great seeds of product ideas. Some of my open-source projects (e.g., &lt;a href=&quot;https://github.com/mhagiwara/nanigonet&quot;&gt;NanigoNet&lt;/a&gt; and &lt;a href=&quot;https://www.openlanguageprofiles.org/&quot;&gt;Open Language Profiles&lt;/a&gt;) were born this way.&lt;/p&gt;
&lt;h2&gt;Making it legit&lt;/h2&gt;
&lt;img src=&quot;http://masatohagiwara.net/img/seattle.jpg&quot; alt=&quot;Seattle&quot;/&gt;&lt;p&gt;I incorporated a single-member LLC just for freelancing (and filed a foreign entity after I moved to Washington). I sign all the contracts as an owner of my LLC. Some of my non-US clients prefer it if I have “a company.” I’m not a lawyer so you need to take everything written here with a huge grain of salt, but I don’t think there’s any huge difference between being a sole proprietor and being a single-member LLC, unless you screw something up (e.g., being sued by your client) or you are hugely successful (e.g., being acquired by a company, making millions of dollars per year, or you grow a team of a dozen employees).&lt;/p&gt;
&lt;p&gt;I think the US is a great place to be a freelancer, even for an immigrant non-native English speaker like me. Being a legal permanent resident makes it easier to work with US-based clients, who usually pay better. The legal system is at least decent. Filing an LLC is just a matter of going to the state secretary’s website and filling out a form, if you know what you are doing. On the contrary, even thinking about incorporating in Japan, for example, makes me shudder, even though I am from Japan. You need to hand in a certificate of your corporate seal, a copy of your corporate bank passbook, along with the company registration in a floppy disk or a CD-R. I think their government has some work to do before they even think about their “national AI strategies.”&lt;/p&gt;
&lt;p&gt;A downside of being a US-based freelancer is medical insurance. I continued my previous employer’s health plan using COBRA and switched over to a plan that I bought on the state marketplace when I moved. Be prepared to pay at least a couple hundred dollars more per month on premiums than you’d pay as a full-time employee.&lt;/p&gt;
&lt;p&gt;Read &lt;a href=&quot;https://store.nolo.com/products/working-for-yourself-wage.html&quot;&gt;Working for Yourself—Law &amp;amp; Taxes for Independent Contractors, Freelancers &amp;amp; Gig Workers of All Types&lt;/a&gt; from Nolo before you start. I read this book literally cover to cover before I got started, which was worth every single penny. Check out &lt;a href=&quot;https://store.nolo.com/products/nolos-guide-to-single-member-llcs-smllc.html&quot;&gt;some of their&lt;/a&gt; &lt;a href=&quot;https://store.nolo.com/products/your-limited-liability-company-lop.html&quot;&gt;related books&lt;/a&gt;, too. They are also good.&lt;/p&gt;
&lt;p&gt;I can’t say much about taxes, because this April will be the first tax filing season since I became independent. I discussed my options thoroughly with my CPA before I took the jump. I keep track of my business income and expenses on a Google Spreadsheet. I’m not sure if this is a good idea. At the least, don’t forget to pay quarterly estimated taxes.&lt;/p&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;In this post, I showed that a freelance AI engineer can be a viable career path. You need to understand that this is a very qualified statement and your mileage may vary. Don’t get mad at me even if you go independent and go broke. If you are interested in knowing more, have any questions or feedback, &lt;a href=&quot;mailto:hagisan@gmail.com&quot;&gt;shoot me an email&lt;/a&gt;. I’m happy to share my experience!&lt;/p&gt;
</description>
<pubDate>Sat, 02 May 2020 06:24:45 +0000</pubDate>
<dc:creator>polm23</dc:creator>
<og:title>My First Year as a Freelance AI Engineer</og:title>
<og:description>This week marks my one-year anniversary of quitting my full-time job and becoming a freelance AI engineer. I’m writing down my thoughts and experience here so that this might be useful if you are even vaguely interested.</og:description>
<og:url>http://masatohagiwara.net/202002-my-first-year-as-a-freelance-ai-engineer.html</og:url>
<og:type>article</og:type>
<og:image>http://masatohagiwara.net/img/wework.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://masatohagiwara.net/202002-my-first-year-as-a-freelance-ai-engineer.html</dc:identifier>
</item>
<item>
<title>Why does `True == False is False` evaluate to False in Python? (2013)</title>
<link>http://stackoverflow.com/questions/17202207/why-does-true-false-is-false-evaluate-to-false</link>
<guid isPermaLink="true" >http://stackoverflow.com/questions/17202207/why-does-true-false-is-false-evaluate-to-false</guid>
<description>&lt;p&gt;From the &lt;a href=&quot;http://docs.python.org/2/reference/expressions.html#not-in&quot; rel=&quot;noreferrer&quot;&gt;docs&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote readability=&quot;7&quot;&gt;
&lt;p&gt;x &amp;lt; y &amp;lt;= z is equivalent to x &amp;lt; y and y &amp;lt;= z, except that y is evaluated only once (but in both cases z is not evaluated at all when x &amp;lt; y is found to be false).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In your case &lt;code&gt;True == False is False&lt;/code&gt; is equivalent to &lt;code&gt;True == False and False is False&lt;/code&gt; as the first condition is &lt;code&gt;False&lt;/code&gt; so it short-circuits and return &lt;code&gt;False&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; dis.dis(lambda : True == False is False)
  1           0 LOAD_GLOBAL              0 (True)
              3 LOAD_GLOBAL              1 (False)
              6 DUP_TOP             
              7 ROT_THREE           
              8 COMPARE_OP               2 (==)
             11 JUMP_IF_FALSE_OR_POP    21          &amp;lt;---------this step
             14 LOAD_GLOBAL              1 (False)
             17 COMPARE_OP               8 (is)
             20 RETURN_VALUE        
        &amp;gt;&amp;gt;   21 ROT_TWO             
             22 POP_TOP             
             23 RETURN_VALUE  
&lt;/code&gt;
&lt;/pre&gt;</description>
<pubDate>Sat, 02 May 2020 02:23:33 +0000</pubDate>
<dc:creator>2arrs2ells</dc:creator>
<og:type>website</og:type>
<og:url>https://stackoverflow.com/questions/17202207/why-does-true-false-is-false-evaluate-to-false</og:url>
<og:image>https://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon@2.png?v=73d79a89bded</og:image>
<og:title>Why does `True == False is False` evaluate to False?</og:title>
<og:description>I get some rather unexpected behavior on an expression that works with == but not with is:  &amp;gt;&amp;gt;&amp;gt; (True == False) is False True &amp;gt;&amp;gt;&amp;gt; True == (False is False) True &amp;gt;&amp;gt;&amp;gt; True ==</og:description>
<dc:format>text/html</dc:format>
<dc:identifier>https://stackoverflow.com/questions/17202207/why-does-true-false-is-false-evaluate-to-false</dc:identifier>
</item>
<item>
<title>Awk in 20 Minutes (2015)</title>
<link>https://ferd.ca/awk-in-20-minutes.html</link>
<guid isPermaLink="true" >https://ferd.ca/awk-in-20-minutes.html</guid>
<description>&lt;span class=&quot;date&quot;&gt;2015/01/15&lt;/span&gt;&lt;h2&gt;Awk in 20 Minutes&lt;/h2&gt;
&lt;h3&gt;What's Awk&lt;/h3&gt;
&lt;p&gt;Awk is a tiny programming language and a command line tool. It's particularly appropriate for log parsing on servers, mostly because Awk will operate on files, usually structured in lines of human-readable text.&lt;/p&gt;
&lt;p&gt;I say it's useful on servers because log files, dump files, or whatever text format servers end up dumping to disk will tend to grow large, and you'll have many of them per server. If you ever get into the situation where you have to analyze gigabytes of files from 50 different servers without tools like &lt;a href=&quot;http://www.splunk.com/&quot;&gt;Splunk&lt;/a&gt; or its equivalents, it would feel fairly bad to have and download all these files locally to then drive some forensics on them.&lt;/p&gt;
&lt;p&gt;This personally happens to me when some Erlang nodes tend to die and leave a &lt;a href=&quot;http://www.erlang.org/doc/apps/erts/crash_dump.html&quot;&gt;crash dump&lt;/a&gt; of 700MB to 4GB behind, or on smaller individual servers (say a VPS) where I need to quickly go through logs, looking for a common pattern.&lt;/p&gt;
&lt;p&gt;In any case, Awk does more than finding data (otherwise, &lt;code&gt;grep&lt;/code&gt; or &lt;code&gt;ack&lt;/code&gt; would be enough) — it also lets you process the data and transform it.&lt;/p&gt;
&lt;h3&gt;Code Structure&lt;/h3&gt;
&lt;p&gt;An Awk script is structured simply, as a sequence of patterns and actions:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;8&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;c1&quot;&gt;# comment&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Pattern1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# comment&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Pattern2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# comment&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Pattern3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# comment&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Pattern4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Every line of the document to scan will have to go through each of the patterns, one at a time. So if I pass in a file that contains the following content:&lt;/p&gt;
&lt;pre&gt;
this is line 1
this is line 2
&lt;/pre&gt;
&lt;p&gt;Then the content &lt;samp&gt;this is line 1&lt;/samp&gt; will match against &lt;code&gt;Pattern1&lt;/code&gt;. If it matches, &lt;code&gt;ACTIONS&lt;/code&gt; will be executed. Then &lt;samp&gt;this is line 1&lt;/samp&gt; will match against &lt;code&gt;Pattern2&lt;/code&gt;. If it doesn't match, it skips to &lt;code&gt;Pattern3&lt;/code&gt;, and so on.&lt;/p&gt;
&lt;p&gt;Once all patterns have been cleared, &lt;samp&gt;this is line 2&lt;/samp&gt; will go through the same process, and so on for other lines, until the input has been read entirely.&lt;/p&gt;
&lt;p&gt;This, in short, is Awk's execution model.&lt;/p&gt;
&lt;h3&gt;Data Types&lt;/h3&gt;
&lt;p&gt;Awk only has two main data types: strings and numbers. And even then, Awk likes to convert them into each other. Strings can be interpreted as numerals to convert their values to numbers. If the string doesn't look like a numeral, it's &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Both can be assigned to variables in &lt;code&gt;ACTIONS&lt;/code&gt; parts of your code with the &lt;code&gt;=&lt;/code&gt; operator. Variables can be declared anywhere, at any time, and used even if they're not initialized: their default value is &lt;code&gt;&quot;&quot;&lt;/code&gt;, the empty string.&lt;/p&gt;
&lt;p&gt;Finally, Awk has arrays. They're unidimensional associative arrays that can be started dynamically. Their syntax is just &lt;code&gt;var[key] = value&lt;/code&gt;. Awk can &lt;a href=&quot;http://www.staff.science.uu.nl/~oostr102/docs/nawk/nawk_87.html#SEC90&quot;&gt;simulate multidimensional arrays&lt;/a&gt;, but it's all a big hack anyway.&lt;/p&gt;
&lt;h3&gt;Patterns&lt;/h3&gt;
&lt;p&gt;The patterns that can be used will fall into three broad categories: regular expressions, Boolean expressions, and special patterns.&lt;/p&gt;
&lt;h4&gt;Regular and Boolean Expressions&lt;/h4&gt;
&lt;p&gt;The Awk regular expressions are your run of the mill regexes. They're not PCRE under &lt;code&gt;awk&lt;/code&gt; (but &lt;code&gt;gawk&lt;/code&gt; will support the fancier stuff — it depends on the implementation! See with &lt;code&gt;awk --version&lt;/code&gt;), though for most usages they'll do plenty:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;9&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;sr&quot;&gt;/admin/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;# any line that contains 'admin'&lt;/span&gt;
&lt;span class=&quot;sr&quot;&gt;/^admin/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# lines that begin with 'admin'&lt;/span&gt;
&lt;span class=&quot;sr&quot;&gt;/admin$/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# lines that end with 'admin'&lt;/span&gt;
&lt;span class=&quot;sr&quot;&gt;/^[0-9.]+ /&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# lines beginning with series of numbers and periods&lt;/span&gt;
&lt;span class=&quot;sr&quot;&gt;/(POST|PUT|DELETE)/&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# lines that contain specific HTTP verbs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And so on. Note that the patterns &lt;em&gt;cannot&lt;/em&gt; &lt;a href=&quot;http://www.regular-expressions.info/named.html&quot;&gt;capture&lt;/a&gt; specific groups to make them available in the &lt;code&gt;ACTIONS&lt;/code&gt; part of the code. They are specifically to match content.&lt;/p&gt;
&lt;p&gt;Boolean expressions are similar to what you would find in PHP or Javascript. Specifically, the operators &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; (&quot;and&quot;), &lt;code&gt;||&lt;/code&gt; (&quot;or&quot;), and &lt;code&gt;!&lt;/code&gt; (&quot;not&quot;) are available. This is also what you'll find in pretty much all C-like languages. They'll operate on any regular data type.&lt;/p&gt;
&lt;p&gt;What's specifically more like PHP and Javascript is the comparison operator, &lt;code&gt;==&lt;/code&gt;, which will do fuzzy matching, so that the string &lt;code&gt;&quot;23&quot;&lt;/code&gt; compares equal to the number &lt;code&gt;23&lt;/code&gt;, such that &lt;code&gt;&quot;23&quot; == 23&lt;/code&gt; is &lt;em&gt;true&lt;/em&gt;. The operator &lt;code&gt;!=&lt;/code&gt; is also available, without forgetting the other common ones: &lt;code&gt;&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;&lt;/code&gt;, &lt;code&gt;&amp;gt;=&lt;/code&gt;, and &lt;code&gt;&amp;lt;=&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;You can also mix up the patterns: Boolean expressions can be used along with regular expressions. The pattern &lt;code&gt;/admin/ || debug == true&lt;/code&gt; is valid and will match when a line that contains either the word 'admin' is met, or whenever the variable &lt;code&gt;debug&lt;/code&gt; is set to &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Note that if you have a specific string or variable you'd want to match against a regex, the operators &lt;code&gt;~&lt;/code&gt; and &lt;code&gt;!~&lt;/code&gt; are what you want, to be used as &lt;code&gt;string ~ /regex/&lt;/code&gt; and &lt;code&gt;string !~ /regex/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Also note that all patterns are &lt;em&gt;optional&lt;/em&gt;. An Awk script that contains the following:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Would simply run &lt;code&gt;ACTIONS&lt;/code&gt; for every line of input.&lt;/p&gt;
&lt;h4&gt;Special Patterns&lt;/h4&gt;
&lt;p&gt;There are a few special patterns in Awk, but not that many.&lt;/p&gt;
&lt;p&gt;The first one is &lt;code&gt;BEGIN&lt;/code&gt;, which matches only &lt;em&gt;before&lt;/em&gt; any line has been input to the file. This is basically where you can initiate variables and all other kinds of state in your script.&lt;/p&gt;
&lt;p&gt;There is also &lt;code&gt;END&lt;/code&gt;, which as you may have guessed, will match &lt;em&gt;after&lt;/em&gt; the whole input has been handled. This lets you clean up or do some final output before exiting.&lt;/p&gt;
&lt;p&gt;Finally, the last kind of pattern is a bit hard to classify. It's halfway between variables and special values, and they're called &lt;em&gt;Fields&lt;/em&gt;, which deserve a section of their own.&lt;/p&gt;
&lt;h4&gt;Fields&lt;/h4&gt;
&lt;p&gt;Fields are best explained with a visual example:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;8&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;c1&quot;&gt;# According to the following line&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# $1         $2    $3&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 00:34:23   GET   /foo/bar.html&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# \_____________  _____________/&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#               $0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Hack attempt?&lt;/span&gt;
&lt;span class=&quot;sr&quot;&gt;/admin.html$/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DELETE&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hacker Alert!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The fields are (by default) separated by white space. The field &lt;code&gt;$0&lt;/code&gt; represents the entire line on its own, as a string. The field &lt;code&gt;$1&lt;/code&gt; is then the first bit (before any white space), &lt;code&gt;$2&lt;/code&gt; is the one after, and so on.&lt;/p&gt;
&lt;p&gt;A fun fact (and a thing to avoid in most cases) is that you can &lt;em&gt;modify the line&lt;/em&gt; by assigning to its field. For example, if you go &lt;code&gt;$0 = &quot;HAHA THE LINE IS GONE&quot;&lt;/code&gt; in one block, the next patterns will now operate on that line instead of the original one, and similarly for any other field variable!&lt;/p&gt;
&lt;h3&gt;Actions&lt;/h3&gt;
&lt;p&gt;There's a bunch of possible actions, but the most common and useful ones (in my experience) are:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;11&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# prints $0. In this case, equivalent to 'print' alone&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;# ends the program&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;      &lt;span class=&quot;c1&quot;&gt;# skips to the next line of input&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# variable assignment&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# variable assignment (array)&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BOOLEAN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BOOLEAN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ACTION&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This alone will contain a major part of your Awk toolbox for casual usage when dealing with logs and whatnot.&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;variables are all global&lt;/em&gt;. Whatever variables you declare in a given block will be visible to other blocks, for each line. This severely limits how large your Awk scripts can become before they're unmaintainable horrors. Keep it minimal.&lt;/p&gt;
&lt;h3&gt;Functions&lt;/h3&gt;
&lt;p&gt;Functions can be called with the following syntax:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;somecall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There is a somewhat restricted set of built-in functions available, so I like to point to &lt;a href=&quot;https://www.gnu.org/software/gawk/manual/html_node/Built_002din.html#Built_002din&quot;&gt;regular documentation&lt;/a&gt; for these.&lt;/p&gt;
&lt;p&gt;User-defined functions are also fairly simple:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;8&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;c1&quot;&gt;# function arguments are call-by-value&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;nx&quot;&gt;ACTIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# same actions as usual&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# return is a valid keyword&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Special Variables&lt;/h3&gt;
&lt;p&gt;Outside of regular variables (global, instantiated anywhere), there is a set of special variables acting a bit like configuration entries:&lt;/p&gt;
&lt;div class=&quot;highlight&quot; readability=&quot;11&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;nb&quot;&gt;BEGIN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Can be modified by the user&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;FS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;,&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# Field Separator&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;RS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Record Separator (lines)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;OFS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Output Field Separator&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;ORS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Output Record Separator (lines)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Can't be modified by the user&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;NF&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;# Number of Fields in the current Record (line)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;NR&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;# Number of Records seen so far&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;ARGV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ARGC&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Script Arguments&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I put the modifiable variables in &lt;code&gt;BEGIN&lt;/code&gt; because that's where I tend to override them, but that can be done anywhere in the script to then take effect on follow-up lines.&lt;/p&gt;
&lt;h3&gt;Examples&lt;/h3&gt;
&lt;p&gt;That's it for the core of the language. I don't have a whole lot of examples there because I tend to use Awk for quick one-off tasks.&lt;/p&gt;
&lt;p&gt;I still have a few files I carry around for some usage and metrics, my favorite one being a script used to parse Erlang crash dumps shaped like this:&lt;/p&gt;
&lt;pre&gt;
=erl_crash_dump:0.3
Tue Nov 18 02:52:44 2014
Slogan: init terminating in do_boot ()
System version: Erlang/OTP 17 [erts-6.2] [source] [64-bit] [smp:8:8] [async-threads:10] [hipe] [kernel-poll:false]
Compiled: Fri Sep 19 03:23:19 2014
Taints:
Atoms: 12167
=memory
total: 19012936
processes: 4327912
processes_used: 4319928
system: 14685024
atom: 339441
atom_used: 331087
binary: 1367680
code: 8384804
ets: 382552
=hash_table:atom_tab
size: 9643
used: 6949
...
=allocator:instr
option m: false
option s: false
option t: false
=proc:&amp;lt;0.0.0&amp;gt;
State: Running
Name: init
Spawned as: otp_ring0:start/2
Run queue: 0
Spawned by: []
Started: Tue Nov 18 02:52:35 2014
Message queue length: 0
Number of heap fragments: 0
Heap fragment data: 0
Link list: [&amp;lt;0.3.0&amp;gt;, &amp;lt;0.7.0&amp;gt;, &amp;lt;0.6.0&amp;gt;]
Reductions: 29265
Stack+heap: 1598
OldHeap: 610
Heap unused: 656
OldHeap unused: 468
Memory: 18584
Program counter: 0x00007f42f9566200 (init:boot_loop/2 + 64)
CP: 0x0000000000000000 (invalid)
=proc:&amp;lt;0.3.0&amp;gt;
State: Waiting
...
=port:#Port&amp;lt;0.0&amp;gt;
Slot: 0
Connected: &amp;lt;0.3.0&amp;gt;
Links: &amp;lt;0.3.0&amp;gt;
Port controls linked-in driver: efile
=port:#Port&amp;lt;0.14&amp;gt;
Slot: 112
Connected: &amp;lt;0.3.0&amp;gt;
...
&lt;/pre&gt;
&lt;p&gt;To yield the following result:&lt;/p&gt;
&lt;pre&gt;
$ awk -f queue_fun.awk $PATH_TO_DUMP
MESSAGE QUEUE LENGTH: CURRENT FUNCTION
======================================
10641: io:wait_io_mon_reply/2
12646: io:wait_io_mon_reply/2
32991: io:wait_io_mon_reply/2
2183837: io:wait_io_mon_reply/2
730790: io:wait_io_mon_reply/2
80194: io:wait_io_mon_reply/2
...
&lt;/pre&gt;
&lt;p&gt;Which is a list of functions running in Erlang processes that caused mailboxes to be too large. Here's the &lt;a href=&quot;https://github.com/ferd/recon/blob/master/script/queue_fun.awk&quot;&gt;script&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;Can you follow along? If so, you can understand Awk. Congratulations.&lt;/p&gt;
</description>
<pubDate>Sat, 02 May 2020 00:47:17 +0000</pubDate>
<dc:creator>jessaustin</dc:creator>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://ferd.ca/awk-in-20-minutes.html</dc:identifier>
</item>
</channel>
</rss>