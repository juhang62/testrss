<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>Moving efficiently in the CLI</title>
<link>https://clementc.github.io/blog/2018/01/25/moving_cli/</link>
<guid isPermaLink="true" >https://clementc.github.io/blog/2018/01/25/moving_cli/</guid>
<description>&lt;p&gt;I found a useful table with most of those in the &lt;strong&gt;&lt;a href=&quot;https://nostarch.com/howlinuxworks2&quot;&gt;How Linux Works&lt;/a&gt;&lt;/strong&gt; book that I'm currently reading, and some more on Stack Overflow.&lt;/p&gt;
&lt;p&gt;If you plan on using them, please bear in mind that these keyboard shorcuts depend on quite a number of things: the Unix distribution that you're using, your shell, your own configuration quirks... so YMMV.&lt;/p&gt;
</description>
<pubDate>Fri, 26 Jan 2018 21:15:27 +0000</pubDate>
<dc:creator>okket</dc:creator>
<og:title>Cl√©ment Chastagnol ~ Moving efficiently in the CLI</og:title>
<og:description>A cheatsheet for moving efficiently in the CLI!</og:description>
<og:image></og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://clementc.github.io/blog/2018/01/25/moving_cli/</dc:identifier>
</item>
<item>
<title>Extensions in Firefox 59</title>
<link>https://blog.mozilla.org/addons/2018/01/26/extensions-firefox-59/</link>
<guid isPermaLink="true" >https://blog.mozilla.org/addons/2018/01/26/extensions-firefox-59/</guid>
<description>&lt;p&gt;&lt;a href=&quot;https://www.mozilla.org/firefox/&quot;&gt;Fire&lt;img class=&quot;alignleft size-thumbnail wp-image-8370&quot; src=&quot;https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/addons/files/2018/01/firefox-logo-beta-160x160.png&quot; alt=&quot;&quot; width=&quot;160&quot; height=&quot;160&quot;/&gt;fox Quantum&lt;/a&gt; continues to make &lt;a href=&quot;https://arstechnica.com/gadgets/2018/01/firefoxs-continued-quantum-transformation-more-multithreading-tracking-protection/&quot;&gt;news&lt;/a&gt; as Mozilla incorporates even more &lt;a href=&quot;https://hacks.mozilla.org/2018/01/making-webassembly-even-faster-firefoxs-new-streaming-and-tiering-compiler/&quot;&gt;innovative technology&lt;/a&gt; into the platform. The development team behind the WebExtensions architecture is no exception, landing a slew of new API and improvements that can now be found in Firefox 59 (just released to &lt;a href=&quot;https://www.mozilla.org/firefox/channel/desktop/&quot;&gt;the Beta channel&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;As always, documentation for the API discussed here can be found on &lt;a href=&quot;https://developer.mozilla.org/en-US/Add-ons/WebExtensions&quot;&gt;MDN Web Docs&lt;/a&gt; (some of the features below are just hitting the main branch as of this post, so if you don‚Äôt find the documentation on MDN, check back in a few days).&lt;/p&gt;
&lt;h2&gt;Experimental Tab Hiding&lt;/h2&gt;
&lt;p&gt;Tab hiding is back! Since the deprecation of the legacy extension architecture, one of the most requested features has been the ability to hide tabs with the WebExtensions API. It was a key element of some very popular legacy add-ons that provided the ability to manage tab groups. Firefox 59 brings this capability back in an initial, experimental form.&lt;/p&gt;
&lt;p&gt;The API is very straightforward:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Include the ‚ÄútabHide‚Äù permission in your manifest file.&lt;/li&gt;
&lt;li&gt;Use tabs.hide() with the tab ID (or list of tab IDs) to hide tabs.&lt;/li&gt;
&lt;li&gt;Use tabs.show() with the tab ID (or list of tab IDs) to show hidden tabs.&lt;/li&gt;
&lt;li&gt;Examine the tabs.Tab.hidden field to determine if a tab is currently hidden.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Note that the visible state of a tab is completely independent from its discarded state. While it may make sense to keep certain tabs active and loaded in memory while hidden, we encourage you to use tabs.discard() in combination with tabs.hide() to help manage memory and resource usage.&lt;/p&gt;
&lt;p&gt;There are certain restrictions when hiding tabs:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Tabs that are pinned cannot be hidden&lt;/li&gt;
&lt;li&gt;Tabs that are sharing their screen, microphone or camera cannot be hidden&lt;/li&gt;
&lt;li&gt;The current active tab cannot be hidden&lt;/li&gt;
&lt;li&gt;Tabs that are in the process of being closed cannot be hidden&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;The reintroduction of hidden tabs to Firefox does not come without some concern. A primary motivation for moving to the WebExtensions framework is to offer users a safer extension ecosystem that can be trusted to protect their security and privacy. Obviously, tab hiding opens the door for malicious extensions to hide tabs, doing things in the background without a user‚Äôs knowledge.&lt;/p&gt;
&lt;p&gt;To make sure we get things right, tab hiding is disabled by default. To enable the API, you must manually go to the about:config page and set extensions.webextensions.tabhide.enabled to true. This restriction will remain in place until:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Additional user interface features are added to Firefox that allow users to see all of their hidden tabs and/or show those tabs independent of any extension. This user interface work is currently active and on-going.&lt;/li&gt;
&lt;li&gt;Developers (internal and external) have had some time to try the API and understand its strengths and weaknesses. In particular, we want some time to gather input on the potential for abuse.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;To be clear, this API is currently &lt;strong&gt;experimental&lt;/strong&gt;. It could change, or even go away entirely if we can‚Äôt provide it in a secure manner. ¬†Nevertheless, Firefox has a long, proud history of customization and the team is committed to upholding that tradition with tab hiding. So please give the API a try and see what you think. With your help, we will work to make tab hiding as fully functional as possible while still maintaining the security of the WebExtensions architecture.&lt;/p&gt;
&lt;p&gt;Want to jump right in a see what it‚Äôs like? Give the &lt;a href=&quot;https://addons.mozilla.org/en-US/firefox/addon/tab-hider/&quot;&gt;Tab Hider&lt;/a&gt; extension a try.&lt;/p&gt;
&lt;h2&gt;Additional Tab Features&lt;/h2&gt;
&lt;p&gt;While tab hiding is the big feature to land in Firefox 59, it isn‚Äôt the only thing related to tabs.&lt;/p&gt;
&lt;h2&gt;Even More Theme API&lt;/h2&gt;
&lt;p&gt;Continuing the ‚Äútheme‚Äù of previous releases, Firefox 59 includes a number of additions to the Theme API that allow you to customize even more of the browser‚Äôs appearance, including:&lt;/p&gt;
&lt;h2&gt;Improvements to the webRequest API&lt;/h2&gt;
&lt;p&gt;The webRequest API now &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1377689&quot;&gt;merges multiple headers with the same name&lt;/a&gt; rather than using only the last one. In addition, &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1149250&quot;&gt;a couple&lt;/a&gt; &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1418275&quot;&gt;of mechanisms&lt;/a&gt; were added to the webRequest API to allow for requests to be upgraded from HTTP to HTTPS.&lt;/p&gt;
&lt;p&gt;Finally, to make debugging a lot easier, exceptions raised from a webRequest blocking listener now &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1428094&quot;&gt;report the original error message and filename&lt;/a&gt;. Below is an example:&lt;/p&gt;
&lt;div id=&quot;attachment_8371&quot; class=&quot;wp-caption aligncenter&quot;&gt;&lt;img class=&quot;size-full wp-image-8371&quot; src=&quot;https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-BEFORE.png&quot; alt=&quot;Before Firefox 59&quot; width=&quot;811&quot; height=&quot;67&quot; srcset=&quot;https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-BEFORE.png 811w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-BEFORE-252x21.png 252w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-BEFORE-768x63.png 768w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-BEFORE-600x50.png 600w&quot; sizes=&quot;(max-width: 811px) 100vw, 811px&quot;/&gt;&lt;p class=&quot;wp-caption-text&quot;&gt;Before Firefox 59&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&quot;attachment_8372&quot; class=&quot;wp-caption aligncenter&quot;&gt;&lt;img class=&quot;size-full wp-image-8372&quot; src=&quot;https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-AFTER.png&quot; alt=&quot;Starting With Firefox 59&quot; width=&quot;817&quot; height=&quot;62&quot; srcset=&quot;https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-AFTER.png 817w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-AFTER-252x19.png 252w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-AFTER-768x58.png 768w, https://blog.mozilla.org/addons/files/2018/01/Screenshot-2018-1-24-1428094-Exception-raised-from-a-webRequest-blocking-listener-AFTER-600x46.png 600w&quot; sizes=&quot;(max-width: 817px) 100vw, 817px&quot;/&gt;&lt;p class=&quot;wp-caption-text&quot;&gt;Starting With Firefox 59&lt;/p&gt;
&lt;/div&gt;
&lt;h2&gt;Register Content Scripts at Runtime&lt;/h2&gt;
&lt;p&gt;Another big feature landing with Firefox 59 is the ability to &lt;a href=&quot;https://developer.mozilla.org/Add-ons/WebExtensions/API/contentScripts&quot;&gt;register content scripts&lt;/a&gt; at runtime. This is an important feature for extensions that want to support user scripting.&lt;/p&gt;
&lt;p&gt;Using the contentScripts.register() API, extensions can dynamically associate content scripts with different URLs, lifting the previous limitation that all content scripts had to be listed statically in the manifest file.&lt;/p&gt;
&lt;h2&gt;Support for Decentralization Protocols&lt;/h2&gt;
&lt;p&gt;Mozilla has always been a &lt;a href=&quot;https://www.mozilla.org/en-US/internet-health/decentralization/&quot;&gt;proponent of decentralization&lt;/a&gt;, recognizing that it is a key ingredient of a healthy Internet. Starting with Firefox 59, several protocols that support decentralized architectures are available for use by extensions. ¬†The newly approved protocols are:&lt;/p&gt;
&lt;h2&gt;browserAction and pageAction Improvements&lt;/h2&gt;
&lt;p&gt;Browser Actions and Page Actions are two of the most popular types of extensions that we see submitted to the Firefox &lt;a href=&quot;https://addons.mozilla.org/&quot;&gt;Add-Ons website&lt;/a&gt;. ¬†Accordingly, the team behind WebExtensions continues to expand and improve the API for those types of extensions.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;pageActions can now be &lt;a href=&quot;https://developer.mozilla.org/Add-ons/WebExtensions/manifest.json/page_action&quot;&gt;shown and/or hidden automatically&lt;/a&gt; for specific pages via pattern matching using the ‚Äúhide_matches‚Äù and ‚Äúshow_matches‚Äù manifest properties. This is a nice performance win for users.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/Add-ons/WebExtensions/API/browserAction#Functions&quot;&gt;browserAction set* methods can now accept a null value&lt;/a&gt; which removes the property from the browserAction.&lt;/li&gt;
&lt;li&gt;Invalid badge background colors are &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1427107&quot;&gt;now rejected&lt;/a&gt; (provides more Chrome compatibility).&lt;/li&gt;
&lt;li&gt;An extension can now &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1427431&quot;&gt;determine&lt;/a&gt; if its browserAction is enabled or disabled (browserAction.isEnabled), a pageAction is currently shown for a tab ( pageActions.isShown), and if its sidebarAction is currently open (sidebarAction.isOpen).&lt;/li&gt;
&lt;/ul&gt;&lt;h2&gt;Enhancement to Cookies&lt;/h2&gt;
&lt;p&gt;The ability for extensions to control cookies in the browser expanded in Firefox 59, including:&lt;/p&gt;
&lt;h2&gt;Proxy Settings&lt;/h2&gt;
&lt;p&gt;Extensions can now &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1425535&quot;&gt;override the proxy settings&lt;/a&gt; in the browser which has been another highly requested feature. ¬†Using the browserSettings.proxyConfig.set() API, the following proxy settings can be controlled:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;proxyType: The type of proxy to use.&lt;/li&gt;
&lt;li&gt;http: The address of the http proxy, can include a port.&lt;/li&gt;
&lt;li&gt;httpProxyAll: Use the http proxy server for all protocols.&lt;/li&gt;
&lt;li&gt;ftp: The address of the ftp proxy, can include a port.&lt;/li&gt;
&lt;li&gt;ssl: The address of the ssl proxy, can include a port.&lt;/li&gt;
&lt;li&gt;socks: The address of the socks proxy, can include a port.&lt;/li&gt;
&lt;li&gt;socksVersion: The version of the socks proxy.&lt;/li&gt;
&lt;li&gt;passthrough: A list of hosts which should not be proxied.&lt;/li&gt;
&lt;li&gt;autoConfigUrl: A URL to use to configure the proxy.&lt;/li&gt;
&lt;li&gt;autoLogin: Do not prompt for authentication if password is saved.&lt;/li&gt;
&lt;li&gt;proxyDNS: Proxy DNS when using SOCKS v5.&lt;/li&gt;
&lt;/ul&gt;&lt;h2&gt;User Notification of Extensions Overrides&lt;/h2&gt;
&lt;p&gt;As with previous releases, when functionality is provided via WebExtensions that allows extensions to control some aspect of the browser, Firefox will inform the user which extension controls that aspect and provide a way for them to regain control.&lt;/p&gt;
&lt;p&gt;The ability for an extension to control the browser‚Äôs tracking protection setting was added back in Firefox 57 via the websites.trackingProtectionMode API. Firefox 59 now shows when an extension controls tracking protection.&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;aligncenter size-full wp-image-8373&quot; src=&quot;https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/addons/files/2018/01/tracking-protection.gif&quot; alt=&quot;Tracking Protection Notification&quot; width=&quot;1261&quot; height=&quot;926&quot;/&gt;&lt;/p&gt;
&lt;p&gt;In the above image, notice that a &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1403751&quot;&gt;message is now displayed&lt;/a&gt; after a user disables an extension reminding them how to re-enable it, also a new feature of Firefox 59.&lt;/p&gt;
&lt;p&gt;One of the most popular browser defaults to override is the new tab page. Firefox already shows the user when an extension has overridden that page, but starting with Firefox 59 it also informs the user of the override on the first appearance of the new tab page itself. Plus, it is smart enough to &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1414018&quot;&gt;revert back to the previous new tab&lt;/a&gt; if the new override is declined.&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;aligncenter size-full wp-image-8374&quot; src=&quot;https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/addons/files/2018/01/restore-settings-multiple.mov.gif&quot; alt=&quot;Restore New Tab&quot; width=&quot;600&quot; height=&quot;402&quot;/&gt;&lt;/p&gt;
&lt;h2&gt;Additional Browser Controls&lt;/h2&gt;
&lt;p&gt;To better support mouse gestures, browserSettings.contextMenuShowEvent() has been added in this version. &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1419426&quot;&gt;This new API&lt;/a&gt; can be set to ‚Äúmouseup‚Äù or ‚Äúmousedown‚Äù by extensions to determine when context menus should be shown. Note that this is not supported on Android, and also calling it with a value of ‚Äúmousedown‚Äù on Windows is a no-op.&lt;/p&gt;
&lt;p&gt;Also in Firefox 59, read-only browserSettings now &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1408472&quot;&gt;return false when calling set or clear&lt;/a&gt; and also report an accurate levelofControl.&lt;/p&gt;
&lt;h2&gt;Context Menus for Bookmarks&lt;/h2&gt;
&lt;p&gt;Speaking of context menus, you can now set &lt;a href=&quot;https://developer.mozilla.org/en-US/Add-ons/WebExtensions/API/menus/ContextType#Type&quot;&gt;custom context menus for bookmarks&lt;/a&gt;. ¬†This will work on the bookmarks toolbar, the library menu, the bookmarks subview, and the bookmarks menu.&lt;/p&gt;
&lt;h2&gt;Development and Debugging&lt;/h2&gt;
&lt;p&gt;One of the best ways to suggest a new WebExtension API is to prototype it via an official experiment. Two major changes landed for WebExtension experiments that makes this significantly easier:&lt;/p&gt;
&lt;p&gt;Also in Firefox 59, &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1429567&quot;&gt;more detail has been added to sandbox names&lt;/a&gt; to aid in debugging.&lt;/p&gt;
&lt;h2&gt;Miscellaneous Changes and Fixes&lt;/h2&gt;
&lt;p&gt;A number of smaller items were also landed in the new Firefox 59 Beta, including:&lt;/p&gt;
&lt;h2&gt;More to Come&lt;/h2&gt;
&lt;p&gt;Firefox 59 landed a total of &lt;a href=&quot;https://mzl.la/2CJN9gE&quot;&gt;69 items&lt;/a&gt; for WebExtensions, the most important of which are discussed above. Thank you to everyone who had a part in getting it to Beta, especially volunteer contributors &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=andre%40andregarzia.com&quot;&gt;Andre Garzia&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=ntim.bugs%40gmail.com&quot;&gt;Tim Nguyen&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=oriol-bugzilla%40hotmail.com&quot;&gt;Oriol Brufau&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=javier--Lx3u0NnX4Eug3hq7uRufuMOjDIwrH7%40jasp.net&quot;&gt;Javier Serrano Polo&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=kevinhowjones%40gmail.com&quot;&gt;Kevin Jones&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=tushararora.cs%40gmail.com&quot;&gt;Tushar Arora&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=martin%40humanoids.be&quot;&gt;Martin Giger&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=psnyde2%40uic.edu&quot;&gt;Peter Snyder&lt;/a&gt;, &lt;a href=&quot;https://bugzilla.mozilla.org/user_profile?login=lukas.jung%40mailbox.org&quot;&gt;Lukas Jung&lt;/a&gt;. Additional changes and improvements to the WebExtensions API are already in progress for Firefox 60, so please continue to send us your feedback. And as always, thank you for using Firefox and helping ensure that individuals have the ability to shape the Internet and their own experiences on it.&lt;/p&gt;
</description>
<pubDate>Fri, 26 Jan 2018 19:53:13 +0000</pubDate>
<dc:creator>ac29</dc:creator>
<og:title>Extensions in Firefox 59</og:title>
<og:url>https://blog.mozilla.org/addons/2018/01/26/extensions-firefox-59/</og:url>
<og:description>Firefox Quantum continues to make news as Mozilla incorporates even more innovative technology into the platform. The development team behind the WebExtensions architecture is no ...</og:description>
<og:image>https://blog.mozilla.org/addons/files/2018/01/firefox-logo-beta-252x258.png</og:image>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://blog.mozilla.org/addons/2018/01/26/extensions-firefox-59/</dc:identifier>
</item>
<item>
<title>Ad campaign runs cryptocurrency miners while unwitting users watch videos</title>
<link>https://arstechnica.com/information-technology/2018/01/now-even-youtube-serves-ads-with-cpu-draining-cryptocurrency-miners</link>
<guid isPermaLink="true" >https://arstechnica.com/information-technology/2018/01/now-even-youtube-serves-ads-with-cpu-draining-cryptocurrency-miners</guid>
<description>&lt;img src=&quot;https://cdn.arstechnica.net/wp-content/uploads/2018/01/youtube-cryptocurrency-mining-800x425.jpg&quot;/&gt;&lt;aside id=&quot;social-left&quot;&gt;&lt;a title=&quot;117 posters participating&quot; class=&quot;comment-count icon-comment-bubble-down&quot; href=&quot;https://arstechnica.com/information-technology/2018/01/now-even-youtube-serves-ads-with-cpu-draining-cryptocurrency-miners/?comments=1&quot;&gt;&lt;span class=&quot;comment-count-before&quot;&gt;reader comments&lt;/span&gt; &lt;span class=&quot;comment-count-number&quot;&gt;170&lt;/span&gt;&lt;/a&gt;
&lt;div class=&quot;share-links&quot;&gt;&lt;span&gt;Share this story&lt;/span&gt;    &lt;/div&gt;
&lt;/aside&gt;&lt;p&gt;YouTube was recently caught displaying ads that covertly leach off visitors' CPUs and electricity to generate digital currency on behalf of anonymous attackers, it was widely reported.&lt;/p&gt;
&lt;p&gt;Word of the abusive ads started no later than Tuesday, as people took to social media sites to &lt;a href=&quot;https://twitter.com/ArungLaksmana/status/955865114866888704&quot;&gt;complain their antivirus programs were detecting cryptocurrency mining code&lt;/a&gt; when they visited YouTube. The warnings came even when people changed the browser they were using, and the warnings seemed to be limited to times when users were on YouTube.&lt;/p&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;
&lt;p dir=&quot;ltr&quot; lang=&quot;en&quot;&gt;Great now my browser everytime I watch youtube... my anti virus always blocking coinhive because malware . Idk much about it but this is getting annoying and I need a solution please T n T&lt;/p&gt;
&lt;p&gt;‚Äî Arung (@ArungLaksmana) &lt;a href=&quot;https://twitter.com/ArungLaksmana/status/955865114866888704?ref_src=twsrc%5Etfw&quot;&gt;January 23, 2018&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;
&lt;p dir=&quot;ltr&quot; lang=&quot;en&quot;&gt;Hey &lt;a href=&quot;https://twitter.com/avast_antivirus?ref_src=twsrc%5Etfw&quot;&gt;@avast_antivirus&lt;/a&gt; seems that you are blocking crypto miners (&lt;a href=&quot;https://twitter.com/hashtag/coinhive?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#coinhive&lt;/a&gt;) in &lt;a href=&quot;https://twitter.com/YouTube?ref_src=twsrc%5Etfw&quot;&gt;@YouTube&lt;/a&gt; &lt;a href=&quot;https://twitter.com/hashtag/ads?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#ads&lt;/a&gt;&lt;br/&gt;Thank you :)&lt;a href=&quot;https://t.co/p2JjwnQyxz&quot;&gt;https://t.co/p2JjwnQyxz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;‚Äî Diego Betto (@diegobetto) &lt;a href=&quot;https://twitter.com/diegobetto/status/956552277413777408?ref_src=twsrc%5Etfw&quot;&gt;January 25, 2018&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote class=&quot;twitter-tweet&quot;&gt;
&lt;p dir=&quot;ltr&quot; lang=&quot;es&quot;&gt;Por lo visto &lt;a href=&quot;https://twitter.com/YouTube?ref_src=twsrc%5Etfw&quot;&gt;@YouTube&lt;/a&gt; es muy gracioso y no le bastaba con bajarnos la audiencia, ahora van y nos meten el JavaScript de Coinhive para utilizar nuestros dispositivos para minar Monero! De verdad, &lt;a href=&quot;https://twitter.com/Google?ref_src=twsrc%5Etfw&quot;&gt;@Google&lt;/a&gt;! Que leeches est√°is haciendo con YouTube?? &lt;a href=&quot;https://t.co/NzMUMlArJs&quot;&gt;pic.twitter.com/NzMUMlArJs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;‚Äî ·õóü¶ä·õüErvo·õüü¶ä·õó (@Mystic_Ervo) &lt;a href=&quot;https://twitter.com/Mystic_Ervo/status/956237422391709696?ref_src=twsrc%5Etfw&quot;&gt;January 24, 2018&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;On Friday, researchers with antivirus provider Trend Micro said the ads helped drive a more than three-fold spike in Web miner detections. They said the attackers behind the ads were abusing Google's DoubleClick ad platform to display them to YouTube visitors in select countries, including Japan, France, Taiwan, Italy, and Spain.&lt;/p&gt;
&lt;p&gt;The ads contain JavaScript that mines the digital coin known as Monero. In nine out of 10 cases, the ads will use publicly available JavaScript provided by Coinhive, a cryptocurrency-mining service that's controversial because it allows subscribers to profit by surreptitiously using other people's computers. The remaining 10 percent of the time, the YouTube ads use private mining JavaScript that saves the attackers the 30 percent cut Coinhive takes. Both scripts are programmed to consume 80 percent of a visitor's CPU, leaving just barely enough resources for it to function.&lt;/p&gt;
&lt;p&gt;&quot;YouTube was likely targeted because users are typically on the site for an extended period of time,&quot; independent security researcher &lt;a href=&quot;https://twitter.com/bad_packets&quot;&gt;Troy Mursch&lt;/a&gt; told Ars. &quot;This is a prime target for cryptojacking malware, because the longer the users are mining for cryptocurrency the more money is made.&quot; Mursch said a &lt;a href=&quot;https://badpackets.net/coinhive-miner-found-on-official-showtime-network-websites-in-latest-case-of-cryptojacking//&quot;&gt;campaign from September&lt;/a&gt; that used the Showtime website to deliver cryptocurrency-mining ads is another example of attackers targeting a video site.&lt;/p&gt;
&lt;p&gt;To add insult to injury, the malicious JavaScript in at least some cases was accompanied by graphics that displayed ads for fake AV programs, which scam people out of money and often install malware when they are run.&lt;/p&gt;
&lt;img src=&quot;https://cdn.arstechnica.net/wp-content/uploads/2018/01/ad.jpg&quot; width=&quot;300&quot; height=&quot;250&quot;/&gt;
&lt;p&gt;The above ad was posted¬†&lt;a href=&quot;https://vozforums.com/showpost.php?p=135399393&amp;amp;postcount=31&quot;&gt;on Tuesday&lt;/a&gt;. Like the ads analyzed by Trend Micro and posted on social media, it mined Monero coins on behalf of someone with the Coinhive site key of &quot;h7axC8ytzLJhIxxvIHMeC0Iw0SPoDwCK.&quot; It's not possible to know how many coins the user has generated so far. Trend Micro said the campaign started January 18. In an e-mail sent as this post was going live, a Google representative wrote:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Mining cryptocurrency through ads is a relatively new form of abuse that violates our &lt;a href=&quot;https://support.google.com/adwordspolicy/answer/6020954?hl=en&quot;&gt;policies&lt;/a&gt; and one that we‚Äôve been monitoring actively. We enforce our policies through a multi-layered detection system across our platforms which we update as new threats emerge. In this case, the ads were blocked in less than two hours and the malicious actors were quickly removed from our platforms.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It wasn't clear what the representative meant when saying the ads were blocked in less than two hours. Evidence supplied by Trend Micro and on social media showed various ads containing substantially the same JavaScript ran for as long as a week. The representative didn't respond to follow-up questions seeking a timeline of when the abusive ads started and ended.&lt;/p&gt;
&lt;aside class=&quot;pullbox sidebar story-sidebar right&quot;&gt;
&lt;/aside&gt;
As the &lt;a href=&quot;https://arstechnica.com/information-technology/2017/11/drive-by-cryptomining-that-drains-cpus-picks-up-steam-with-aid-of-2500-sites/&quot;&gt;problem of Web-based cryptomining has surged&lt;/a&gt; to almost epidemic proportions, a variety of AV programs have started warning of cryptocurrency-mining scripts hosted on websites and giving users the option of blocking the activity. While drive-by cryptocurrency mining is an abuse that drains visitors' electricity and computing resources, there's no indication that it installs ransomware or other types of malware, as long as people don't click on malicious downloads.
&lt;p&gt;&lt;em&gt;This post was updated to add comment from Google.&lt;/em&gt;&lt;/p&gt;
</description>
<pubDate>Fri, 26 Jan 2018 19:49:33 +0000</pubDate>
<dc:creator>spystath</dc:creator>
<og:url>https://arstechnica.com/information-technology/2018/01/now-even-youtube-serves-ads-with-cpu-draining-cryptocurrency-miners/</og:url>
<og:title>Now even YouTube serves ads with CPU-draining cryptocurrency miners</og:title>
<og:image>https://cdn.arstechnica.net/wp-content/uploads/2018/01/youtube-cryptocurrency-mining-760x380.jpg</og:image>
<og:description>Ad campaign lets attackers profit while unwitting users watch videos.</og:description>
<og:type>article</og:type>
<dc:language>en-us</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://arstechnica.com/information-technology/2018/01/now-even-youtube-serves-ads-with-cpu-draining-cryptocurrency-miners/</dc:identifier>
</item>
<item>
<title>Mozilla Is Hiring a Developer to Work on Thunderbird Full-Time</title>
<link>https://blog.mozilla.org/thunderbird/2018/01/were-hiring-a-developer-to-work-on-thunderbird-full-time/</link>
<guid isPermaLink="true" >https://blog.mozilla.org/thunderbird/2018/01/were-hiring-a-developer-to-work-on-thunderbird-full-time/</guid>
<description>&lt;p&gt;The Thunderbird Project is hiring for a software engineer! We‚Äôre looking for an amazing developer to come on board to help make Thunderbird the best Email client on the planet! If you are interested you can apply via the link below, following the job description.&lt;/p&gt;
&lt;p&gt;Here‚Äôs the job description:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Title: Thunderbird Software Engineer&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;About Thunderbird&lt;/strong&gt;&lt;br/&gt;Thunderbird is a email client depended on daily by 25 million people on&lt;br/&gt;three platforms: Windows, Mac and Linux (and other *nix). It was developed by the Mozilla Corporation until 2014 when development was handed over to the community. The Mozilla Foundation is now the fiscal home of Thunderbird. The Thunderbird Council, who lead the community effort, has begun hiring contractors through Mozilla in support of this venture and to guarantee that all vital services are provided in a reliable fashion.&lt;/p&gt;
&lt;p&gt;You will join the team that is leading Thunderbird into a bright future. As a software engineer you will be maintaining and improving the existing Gecko-based Thunderbird but also pave the way for its transition to being based on web technologies.&lt;/p&gt;
&lt;p&gt;The Thunderbird team works openly using public bug trackers and repositories, providing you with a premier chance to showcase your work to the world.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;About the Contract&lt;/strong&gt;&lt;br/&gt;The Thunderbird project is looking to hire software engineers to help maintain Thunderbird. You‚Äôll be expected to work with community volunteers, the Thunderbird Council, and other employees to maintain and improve the Thunderbird product.&lt;/p&gt;
&lt;p&gt;This is a remote, hourly 6-month contract. Hours will be up to 40 a week. You will be expected to have excellent written communication skills and coordinate your work over email, IRC, and Bugzilla.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;As a software engineer for Thunderbird you will&lt;/strong&gt;&lt;br/&gt;* Fix bugs and regressions and address technical debt.&lt;br/&gt;* In collaboration with Thunderbird‚Äôs Engineering Steering Committee,&lt;br/&gt;replace/rewrite modules to prepare Thunderbird for the transition to a&lt;br/&gt;new platform.&lt;br/&gt;* Maintain and improve Thunderbird to ensure that both nightly builds&lt;br/&gt;and releases are always possible.&lt;br/&gt;* Follow improvements made by Mozilla engineers for the Firefox platform&lt;br/&gt;process and implement those for Thunderbird.&lt;br/&gt;* Be a self-starter. In a large code-base it‚Äôs inevitable that you&lt;br/&gt;conduct your own research, investigation and debugging, although others&lt;br/&gt;in the project will of course share their knowledge.&lt;br/&gt;* Work with both volunteers and employees across the world to fix issues.&lt;br/&gt;* Collaborate with QA, Security, Localization, and Release Engineering&lt;br/&gt;for coordinated code releases.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Your Previous Experience&lt;/strong&gt;&lt;br/&gt;Since we are looking to fill one or more positions, we are interested to&lt;br/&gt;hear from junior and senior candidates who can offer the following:&lt;br/&gt;* Solid knowledge and experience developing a large software system (7+&lt;br/&gt;million lines of code).&lt;br/&gt;* Solid knowledge of C++ as well as JavaScript, HTML and CSS.&lt;br/&gt;* Ideally exposure to the Mozilla platform as a voluntary contributor or&lt;br/&gt;add-on author with knowledge of XPCOM, XUL, etc.&lt;br/&gt;* Some experience using distributed version control systems (preferably&lt;br/&gt;Mercurial, Git would be acceptable).&lt;br/&gt;* Some prior exposure to Python and build systems (preferably make)&lt;br/&gt;would be beneficial.&lt;br/&gt;* Experience developing software cross-platform applications is a plus.&lt;br/&gt;* B.S. in Computer Science would be lovely, but real-world experience is&lt;br/&gt;preferred.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Next Steps&lt;/strong&gt;&lt;br/&gt;If this position sounds like a good fit for you, please send us your resume with a cover letter to &lt;a href=&quot;mailto:apply@mozillafoundation.org&quot;&gt;apply@mozillafoundation.org&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A cover letter is essential to your application, as it shows us how you envision Thunderbird‚Äôs technical future. Tell us about why you‚Äôre passionate about Thunderbird and this position. Also include samples of your work as a programmer, either directly or a link. If you contribute to any open source software, or maintain a blog we‚Äôd love to hear about it.&lt;/p&gt;
&lt;p&gt;Please note that while the Thunderbird project is a group of individuals separate from the Mozilla Foundation that works to further the Thunderbird email client, the Mozilla Foundation is the Project‚Äôs fiscal home. The Thunderbird Council, separate from Mozilla, manages the Project and will direct the software engineer‚Äôs work.&lt;/p&gt;
&lt;p&gt;The successful applicant will be hired as freelancer (independent contractor) through the Mozilla Foundation‚Äôs third-party service Upwork (www.upwork.com). By applying to this job, you are agreeing to have your applications reviewed by Thunderbird contractors and volunteers who are a part of the hiring committee as well as by staff members of the Mozilla Foundation.&lt;/p&gt;
&lt;p&gt;Mozilla values diversity. We do not discriminate on the basis of race, religion, color, national origin, gender, sexual orientation, age, marital status, veteran status, or disability status.&lt;/p&gt;



</description>
<pubDate>Fri, 26 Jan 2018 17:31:47 +0000</pubDate>
<dc:creator>azdle</dc:creator>
<og:title>We‚Äôre Hiring a Developer to Work on Thunderbird Full-Time!</og:title>
<og:url>https://blog.mozilla.org/thunderbird/2018/01/were-hiring-a-developer-to-work-on-thunderbird-full-time/</og:url>
<og:description>The Thunderbird Project is hiring for a software engineer! We‚Äôre looking for an amazing developer to come on board to help make Thunderbird the best ...</og:description>
<og:image>https://blog.mozilla.org/thunderbird/wp-content/themes/OneMozilla/img/mozilla-wordmark.png</og:image>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://blog.mozilla.org/thunderbird/2018/01/were-hiring-a-developer-to-work-on-thunderbird-full-time/</dc:identifier>
</item>
<item>
<title>How to Slice a Bagel into Two Linked Halves (2009)</title>
<link>http://www.georgehart.com/bagel/bagel.html</link>
<guid isPermaLink="true" >http://www.georgehart.com/bagel/bagel.html</guid>
<description>It is not hard to cut a bagel into two equal halves which are linked like two links of a chain.&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel1.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;To start, you must visualize four key points.¬† Center the bagel at the origin, circling the Z axis.¬†&lt;br /&gt;A is the highest point above the +X axis.¬† B is where the +Y axis enters the bagel.&lt;br /&gt;C is the lowest point below the -X axis.¬† D is where the -Y axis exits the bagel.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel2.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;These sharpie markings on the bagel are just to help visualize the geometry&lt;br /&gt;and the points.¬† You &lt;span&gt;don't&lt;/span&gt; need to actually write on the bagel to cut it properly.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel3.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;The line ABCDA, which goes smoothly through all four key points, is the cut line.¬†&lt;br /&gt;As it goes 360 degrees around the Z axis, it also goes 360 degrees around the bagel.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel4.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;The red line is like the black line but is rotated 180 degrees (around Z or through the hole).&lt;br /&gt;An ideal knife could enter on the black line and come out exactly opposite, on the red line.&lt;br /&gt;But in practice, it is easier to cut in halfway on both the black line and the red line.&lt;br /&gt;The cutting surface is a two-twist Mobius strip; it has two sides, one for each half.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel5.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;After being cut, the two halves can be moved but are still linked together, each passing through&lt;br /&gt;the hole of the other.¬†¬† (So when you buy your bagels, pick ones with the biggest holes.)&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel7.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;If you visualize the key points and a smooth curve connecting them, you do&lt;br /&gt;not need to draw on the bagel.¬† Here the two parts are pulled slightly apart.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel8.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;If your cut is neat, the two halves are congruent. They are of the same handedness.&lt;br /&gt;(You can make both be the opposite handedness if you follow these instructions in a mirror.)&lt;br /&gt;You can toast them in a toaster oven while linked together, but move them around every&lt;br /&gt;minute or so, otherwise some parts will cook much more than others, as shown in this half.&lt;/p&gt;&lt;p&gt;&lt;img alt=&quot;&quot; src=&quot;http://www.georgehart.com/bagel/bagel9.jpg&quot; /&gt;&lt;/p&gt;&lt;p&gt;It is much more fun to put cream cheese on these bagels than on an ordinary bagel. In additional to&lt;br /&gt;the intellectual stimulation, you get more cream cheese, because there is slightly more surface area.&lt;/p&gt;&lt;p&gt;Topology problem: &lt;span&gt;Modify the cut so the cutting surface is a one-twist Mobius strip.¬†&lt;/span&gt;&lt;br /&gt;&lt;span&gt;(You can still get cream cheese into the cut, but it doesn't separate into two parts.)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Calculus problem: &lt;span&gt;What is the ratio of the surface area of this linked cut&lt;/span&gt;&lt;br /&gt;&lt;span&gt;to the surface area of the usual planar bagel slice?&lt;/span&gt;&lt;/p&gt;&lt;p&gt; For future research: &lt;span&gt;How to make Mobius lox...&lt;/span&gt;&lt;/p&gt;&lt;hr /&gt;&lt;span&gt;&lt;br /&gt;&lt;/span&gt;&lt;div readability=&quot;17.456603773585&quot;&gt;Note: I have had my students do this activity in my &lt;span&gt;Computers and Sculpture&lt;/span&gt; class.¬† It is very successful if the students work in pairs, with two bagels per team.¬† For the first bagel, I have them draw the indicated lines with a &quot;sharpie&quot;.¬† Then they can do the second bagel without the lines. (We omit the schmear of cream cheese.) After doing this, one can better appreciate the stone carving of &lt;a href=&quot;http://www2.memenet.or.jp/%7Ekeizo/0005.htm&quot;&gt;Keizo Ushio&lt;/a&gt;, who makes analogous cuts in granite to produce monumental sculpture.&lt;hr /&gt;&lt;br /&gt;&lt;div&gt;&lt;big&gt;&lt;big&gt;&lt;span&gt;Addendum:&lt;/span&gt; I made a &lt;a href=&quot;http://www.youtube.com/watch?v=dN8AwGUaqDA&quot;&gt;video&lt;/a&gt; showing how to do this.&lt;br /&gt;&lt;/big&gt;&lt;/big&gt;&lt;/div&gt;
&lt;br /&gt;&lt;hr /&gt;&lt;br /&gt;&lt;/div&gt;
</description>
<pubDate>Fri, 26 Jan 2018 17:30:08 +0000</pubDate>
<dc:creator>jakegarelick</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.georgehart.com/bagel/bagel.html</dc:identifier>
</item>
<item>
<title>Dark Site Finder: tracking light pollution to find locations for stargazing</title>
<link>http://darksitefinder.com/maps/world.html</link>
<guid isPermaLink="true" >http://darksitefinder.com/maps/world.html</guid>
<description>[unable to retrieve full-text content]&lt;p&gt;Article URL: &lt;a href=&quot;http://darksitefinder.com/maps/world.html&quot;&gt;http://darksitefinder.com/maps/world.html&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=16240911&quot;&gt;https://news.ycombinator.com/item?id=16240911&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Points: 240&lt;/p&gt;&lt;p&gt;# Comments: 70&lt;/p&gt;</description>
<pubDate>Fri, 26 Jan 2018 17:18:28 +0000</pubDate>
<dc:creator>kibwen</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>http://darksitefinder.com/maps/world.html</dc:identifier>
</item>
<item>
<title>Tokyo-based cryptocurrency exchange hacked, losing $530M: NHK</title>
<link>https://www.reuters.com/article/us-japan-cryptocurrency/tokyo-based-cryptocurrency-exchange-hacked-losing-530-million-nhk-idUSKBN1FF29C</link>
<guid isPermaLink="true" >https://www.reuters.com/article/us-japan-cryptocurrency/tokyo-based-cryptocurrency-exchange-hacked-losing-530-million-nhk-idUSKBN1FF29C</guid>
<description>&lt;p&gt;TOKYO (Reuters) - Coincheck, a major cryptocurrency trading exchange in Tokyo, has been hacked into and has lost about 58 billion yen ($534 million) worth of virtual money, national broadcaster NHK reported on Friday.&lt;/p&gt;
&lt;p&gt;Coincheck posted on its website on Friday afternoon that it had suspended withdrawals of almost all cryptocurrencies.&lt;/p&gt;
&lt;p&gt;The exchange has already reported the incident to the police and to Japan‚Äôs Financial Services Agency, NHK said.&lt;/p&gt;
&lt;p&gt;In 2014, Tokyo-based Mt. Gox, which once handled 80 percent of the world‚Äôs bitcoin trades, filed for bankruptcy after losing some 850,000 bitcoins - then worth around half a billion U.S. dollars - and $28 million in cash from its bank accounts.&lt;/p&gt;
&lt;div class=&quot;Attribution_attribution_o4ojT&quot; readability=&quot;7&quot;&gt;
&lt;p class=&quot;Attribution_content_27_rw&quot;&gt;Reporting by Makiko Yamazaki; Editing by Hugh Lawson&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;StandardArticleBody_trustBadgeContainer_1gqgJ&quot;&gt;&lt;span class=&quot;StandardArticleBody_trustBadgeTitle_7sKLj&quot;&gt;Our Standards:&lt;/span&gt;&lt;span class=&quot;trustBadgeUrl&quot;&gt;&lt;a href=&quot;http://thomsonreuters.com/en/about-us/trust-principles.html&quot;&gt;The Thomson Reuters Trust Principles.&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;
</description>
<pubDate>Fri, 26 Jan 2018 17:14:09 +0000</pubDate>
<dc:creator>RmDen</dc:creator>
<og:title>Tokyo-based cryptocurrency exchange hacked, losing $530 million: NHK</og:title>
<og:url>https://www.reuters.com/article/us-japan-cryptocurrency/tokyo-based-cryptocurrency-exchange-hacked-losing-530-million-nhk-idUSKBN1FF29C</og:url>
<og:type>article</og:type>
<og:description>Coincheck, a major cryptocurrency trading exchange in Tokyo, has been hacked into and has lost about 58 billion yen ($534 million) worth of virtual money, national broadcaster NHK reported on Friday.</og:description>
<og:image>https://s4.reutersmedia.net/resources/r/?m=02&amp;d=20180126&amp;t=2&amp;i=1225619829&amp;w=1200&amp;r=LYNXMPEE0P1F9</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.reuters.com/article/us-japan-cryptocurrency/tokyo-based-cryptocurrency-exchange-hacked-losing-530-million-nhk-idUSKBN1FF29C</dc:identifier>
</item>
<item>
<title>3,500 Occult Manuscripts Will Be Digitized and Made Freely Available Online</title>
<link>http://www.openculture.com/2017/12/3500-occult-manuscripts-will-be-digitized-made-freely-available-online.html</link>
<guid isPermaLink="true" >http://www.openculture.com/2017/12/3500-occult-manuscripts-will-be-digitized-made-freely-available-online.html</guid>
<description>&lt;div class=&quot;oc-video-wrapper&quot;&gt;
&lt;p&gt;&lt;span class=&quot;youtube&quot;&gt;&lt;iframe title=&quot;YouTube video player&quot; class=&quot;youtube-player&quot; type=&quot;text/html&quot; width=&quot;640&quot; height=&quot;505&quot; src=&quot;//www.youtube.com/embed/X9P97Zx4FOs?wmode=transparent&amp;amp;fs=1&amp;amp;hl=en&amp;amp;showsearch=0&amp;amp;rel=0&amp;amp;theme=dark&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;[embedded content]&lt;/iframe&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;If there‚Äôs one thing &lt;a href=&quot;http://amzn.to/2CIlPMj&quot;&gt;&lt;em&gt;The Da Vinci Code&lt;/em&gt;&lt;/a&gt;‚Äôs Dan Brown and ‚ÄúThe Library of Babel‚Äù‚Äôs Jorge Luis Borges have in common it is a love for obscure religious and occult books and artifacts. But why do I compare Borges‚Äîone of the most highly-regarded, but difficult, of Latin American poets and writers‚Äîto a famous American writer of entertaining paperback thrillers? One reason only: despite the vast differences in their styles and registers, Borges would be deeply moved by Brown‚Äôs recent act of philanthropy, a donation of¬†‚Ç¨300,000 to Amsterdam‚Äôs &lt;a href=&quot;http://www.ritmanlibrary.com/&quot;&gt;Ritman Library,&lt;/a&gt; also known as the &lt;em&gt;Bibliotheca Philosophica Hermetica&lt;/em&gt; House of Living Books.&lt;/p&gt;
&lt;p&gt;The generous gift will &lt;a href=&quot;http://www.ritmanlibrary.com/digitization-project/&quot;&gt;enable the Ritman to digitize&lt;/a&gt; thousands of ‚Äúpre-1900 texts on alchemy, astrology, magic, and theosophy,‚Äù reports &lt;a href=&quot;https://qz.com/713503/the-ancient-occult-texts-that-dan-brown-is-paying-to-digitize-and-make-free-for-all/&quot;&gt;Thu-Huong Ha at Quartz&lt;/a&gt;, including the &lt;em&gt;Corpus Hermeticum&lt;/em&gt; (1472), ‚Äúthe source work on Hermetic wisdom‚Äù; Giordano Bruno‚Äôs &lt;em&gt;Spaccio de la bestia trionfante&lt;/em&gt; (1584); and ‚Äúthe first printed version of the tree of life (1516): A graphic representation of the sefirot, the 10 virtues of God according to the Kabbalah.‚Äù&lt;/p&gt;
&lt;center/&gt;
&lt;p&gt;Brown, the Ritman notes, ‚Äúis a great admirer of the library and visited on several occasions while writing his novels &lt;a href=&quot;http://amzn.to/2CLHvqG&quot;&gt;&lt;em&gt;The Lost Symbol&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://amzn.to/2CImqO3&quot;&gt;&lt;em&gt;Inferno&lt;/em&gt;&lt;/a&gt;.‚Äù Now he's giving back. Some of the revenue generated by his bestselling novels, along with a ‚Ç¨15,000 contribution from the Dutch Prins Bernhard Cultuurfonds, will allow the library‚Äôs core collection, ‚Äúsome 3,500 ancient books,‚Äù to come online soon in an archive called ‚Äú&lt;a href=&quot;http://www.ritmanlibrary.com/hermetically-open/&quot;&gt;Hermetically Open&lt;/a&gt;.‚Äù&lt;/p&gt;
&lt;div class=&quot;oc-video-wrapper&quot;&gt;
&lt;p&gt;&lt;iframe src=&quot;http://player.vimeo.com/video/179329765&quot; width=&quot;640&quot; height=&quot;385&quot; frameborder=&quot;0&quot;&gt;[embedded content]&lt;/iframe&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;For now, the curious can download the &lt;a href=&quot;http://www.ritmanlibrary.com/books/special-publications-e-books/bph/hermetically-open-guide-to-the-bibliotheca-philosophica-hermetica-ebook/&quot;&gt;44-page guide to the collection as a free ebook&lt;/a&gt;, and watch the animated video at the top, a breezy explainer of how the books will be transported, digitized, and uploaded. Just above, see a trailer for a documentary about the Ritman, founded by businessman Joost R. Ritman in 1984. The library holds over 20,000 volumes on mysticism, spirituality, religion, alchemy, Gnosticism, and more.&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;alignleft size-full wp-image-1046113&quot; src=&quot;https://cdn8.openculture.com/2017/12/19223707/boekje-6-totaal.jpg&quot; alt=&quot;&quot; width=&quot;898&quot; height=&quot;669&quot; srcset=&quot;http://cdn8.openculture.com/2017/12/19223707/boekje-6-totaal.jpg 898w, http://cdn8.openculture.com/2017/12/19223707/boekje-6-totaal-150x112.jpg 150w, http://cdn8.openculture.com/2017/12/19223707/boekje-6-totaal-300x223.jpg 300w, http://cdn8.openculture.com/2017/12/19223707/boekje-6-totaal-768x572.jpg 768w&quot; sizes=&quot;(max-width: 898px) 100vw, 898px&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Many a writer, like Brown, has found inspiration among the Ritman's more accessible works (though, sadly, Borges, who was blind in 1984 and died two years later, could not have appreciated it). Now, thanks to the &lt;em&gt;Da Vinci Code&lt;/em&gt; author‚Äôs magnanimity, a new generation of scholars will be able to virtually access, for example, the first English translation of the works of 17-century German mystic &lt;a href=&quot;https://en.wikipedia.org/wiki/Jakob_B%C3%B6hme&quot;&gt;Jakob B√∂hme&lt;/a&gt;, which librarian and director Esther Ritman describes as ‚Äútravelling in an entire new world.‚Äù&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;alignnone size-full wp-image-1046102&quot; src=&quot;https://cdn8.openculture.com/2017/12/19213206/9-bocc88hme-jacob_s_ill_law-editie_c-e1466606891898.jpg&quot; alt=&quot;&quot; width=&quot;640&quot; height=&quot;974&quot; srcset=&quot;http://cdn8.openculture.com/2017/12/19213206/9-bocc88hme-jacob_s_ill_law-editie_c-e1466606891898.jpg 640w, http://cdn8.openculture.com/2017/12/19213206/9-bocc88hme-jacob_s_ill_law-editie_c-e1466606891898-99x150.jpg 99w, http://cdn8.openculture.com/2017/12/19213206/9-bocc88hme-jacob_s_ill_law-editie_c-e1466606891898-197x300.jpg 197w, http://cdn8.openculture.com/2017/12/19213206/9-bocc88hme-jacob_s_ill_law-editie_c-e1466606891898-300x457.jpg 300w&quot; sizes=&quot;(max-width: 640px) 100vw, 640px&quot;/&gt;&lt;/p&gt;
&lt;p&gt;In an &lt;a href=&quot;http://www.ritmanlibrary.com/2012/09/blog-hermetically-open/&quot;&gt;introductory essay&lt;/a&gt;, the Ritman notes that academic interest in occult and hermetic writing has increased lately among scholars like W.J. Hanegraaff, who &lt;a href=&quot;https://www.amazon.com/dp/B0070TTHXU/ref=dp-kindle-redirect?_encoding=UTF8&amp;amp;btkr=1&quot;&gt;tells&lt;/a&gt; ‚Äúthe ‚Äòneglected‚Äô story of how the intellectual community since the Renaissance has tried to come to terms with ‚Äòesoteric‚Äô and ‚Äòoccult‚Äô currents present in Western culture.‚Äù That those currents are as much a part of the culture as the scientific or industrial revolutions need not be in doubt. &lt;a href=&quot;http://www.ritmanlibrary.com/hermetically-open/&quot;&gt;The Hermetically Open&lt;/a&gt; &lt;a href=&quot;http://www.ritmanlibrary.com/hermetically-open/&quot;&gt;project&lt;/a&gt; opens up that history with ‚Äúan invitation to anyone wishing to consult or study sources belonging to the field of Christian-Hermetic Gnosis for personal, academic or other purposes.‚Äù Look for the digitization project to hit the web in the coming months.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Related Content:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.openculture.com/2017/09/1000-year-old-illustrated-guide-to-the-medicinal-use-of-plants-now-digitized-put-online.html&quot;&gt;1,000-Year-Old Illustrated Guide to the Medicinal Use of Plants Now Digitized &amp;amp; Put Online&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.openculture.com/2013/12/british-library-puts-1000000-images-into-public-domain.html&quot;&gt;The British Library Puts 1,000,000 Images into the Public Domain, Making Them Free to Reuse &amp;amp; Remix&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.openculture.com/2016/10/aleister-crowley-reads-occult-poetry-in-the-only-known-recordings-of-his-voice-1920.html&quot;&gt;Aleister Crowley Reads Occult Poetry in the Only Known Recordings of His Voice (1920)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://about.me/jonesjoshua&quot;&gt;&lt;em&gt;Josh Jones&lt;/em&gt;&lt;/a&gt;&lt;em&gt;¬†is a writer and musician based in Durham, NC. Follow him at¬†&lt;a href=&quot;https://twitter.com/jdmagness&quot;&gt;@jdmagness&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;br/&gt;</description>
<pubDate>Fri, 26 Jan 2018 16:46:20 +0000</pubDate>
<dc:creator>RmDen</dc:creator>
<og:type>article</og:type>
<og:url>http://www.openculture.com/2017/12/3500-occult-manuscripts-will-be-digitized-made-freely-available-online.html</og:url>
<og:title>3,500 Occult Manuscripts Will Be Digitized &amp; Made Freely Available Online, Thanks to Da Vinci Code Author Dan Brown</og:title>
<og:image>https://cdn8.openculture.com/2017/12/19225744/hermetically-open-fb.png</og:image>
<og:description> If there‚Äôs one thing The Da Vinci Code‚Äôs Dan Brown and ‚ÄúThe Library of Babel‚Äù‚Äôs Jorge Luis Borges have in common it is a love for obscure religious and occult books and artifacts.</og:description>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>http://www.openculture.com/2017/12/3500-occult-manuscripts-will-be-digitized-made-freely-available-online.html</dc:identifier>
</item>
<item>
<title>Building an AlphaZero AI using Python and Keras</title>
<link>https://applied-data.science/blog/how-to-build-your-own-alphazero-ai-using-python-and-keras/</link>
<guid isPermaLink="true" >https://applied-data.science/blog/how-to-build-your-own-alphazero-ai-using-python-and-keras/</guid>
<description>[unable to retrieve full-text content]&lt;p&gt;Article URL: &lt;a href=&quot;https://applied-data.science/blog/how-to-build-your-own-alphazero-ai-using-python-and-keras/&quot;&gt;https://applied-data.science/blog/how-to-build-your-own-alphazero-ai-using-python-and-keras/&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=16240234&quot;&gt;https://news.ycombinator.com/item?id=16240234&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Points: 329&lt;/p&gt;&lt;p&gt;# Comments: 49&lt;/p&gt;</description>
<pubDate>Fri, 26 Jan 2018 16:10:21 +0000</pubDate>
<dc:creator>davidfoster</dc:creator>
<og:title>How to build your own AlphaZero AI using Python and Keras</og:title>
<og:description>Replicates the AlphaZero methodology to learn Connect4 strategy through self-play and deep learning.</og:description>
<og:image>https://cdn-images-1.medium.com/max/1600/1*8IbnDy2YhICNHTsZlsldWw.png</og:image>
<og:url>https://medium.com/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188</og:url>
<dc:format>text/html</dc:format>
<dc:identifier>https://applied-data.science/blog/how-to-build-your-own-alphazero-ai-using-python-and-keras/</dc:identifier>
</item>
<item>
<title>How to Run Your Own Mail Server (2017)</title>
<link>https://www.c0ffee.net/blog/mail-server-guide</link>
<guid isPermaLink="true" >https://www.c0ffee.net/blog/mail-server-guide</guid>
<description>&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;/&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;/&gt;&lt;meta name=&quot;description&quot; content=&quot;A guide to self-hosting your email on FreeBSD using Postfix, Dovecot, Rspamd, and LDAP.&quot;/&gt;&lt;meta name=&quot;author&quot; content=&quot;Cullum Smith&quot;/&gt;&lt;meta name=&quot;date&quot; content=&quot;2017-08-20&quot;/&gt;&lt;link rel=&quot;apple-touch-icon&quot; sizes=&quot;180x180&quot; href=&quot;/apple-touch-icon.png&quot;/&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;32x32&quot; href=&quot;/favicon-32x32.png&quot;/&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; href=&quot;/favicon-16x16.png&quot;/&gt;&lt;link rel=&quot;manifest&quot; href=&quot;/manifest.json&quot;/&gt;&lt;link rel=&quot;mask-icon&quot; href=&quot;/safari-pinned-tab.svg&quot; color=&quot;#5BBAD5&quot;/&gt;&lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;c0ffee.net&quot;/&gt;&lt;meta name=&quot;application-name&quot; content=&quot;c0ffee.net&quot;/&gt;&lt;meta name=&quot;msapplication-TileColor&quot; content=&quot;#da532c&quot;/&gt;&lt;meta name=&quot;msapplication-TileImage&quot; content=&quot;/mstile-144x144.png&quot;/&gt;&lt;meta name=&quot;theme-color&quot; content=&quot;#ffffff&quot;/&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/css/style.css&quot;/&gt;&lt;title&gt;How To Run Your Own Mail Server&lt;/title&gt;&lt;/head&gt;&lt;body id=&quot;readabilityBody&quot; readability=&quot;570.35193157358&quot;&gt;
&lt;nav&gt;&lt;a href=&quot;https://www.c0ffee.net/&quot;&gt;Home&lt;/a&gt; &lt;a href=&quot;https://www.c0ffee.net/blog&quot;&gt;Blog&lt;/a&gt;&lt;/nav&gt;&lt;p&gt;&lt;span class=&quot;posted-on&quot;&gt;20 Aug 2017&lt;/span&gt;&lt;/p&gt;
&lt;header readability=&quot;5&quot;&gt;
&lt;p class=&quot;subtitle&quot;&gt;A guide to self-hosting your email on FreeBSD using Postfix, Dovecot, Rspamd, and LDAP.&lt;/p&gt;
&lt;/header&gt;&lt;p&gt;Getting off GMail is one of the best ways to &lt;a href=&quot;https://www.c0ffee.net/blog/self-hosting-guide&quot;&gt;take back your data&lt;/a&gt; in the face of dragnet surveillance. Unfortunately, it's also one of the most difficult. If you search for &quot;how to run your own mail server,&quot; many of the results will tell you it's simply too difficult to reliably do it yourself.&lt;/p&gt;
&lt;p&gt;Luckily, running your own mail server is not as daunting as many would have you believe. After all, that is how email is &lt;em&gt;designed to work&lt;/em&gt;. Email is perhaps the most successful federated, decentralized protocol to ever exist. It's a shame we've allowed a centralized, monolithic advertising company to obtain a near monopoly on such a great technology. Luckily, I've spent the last few years tweaking my mail server setup, and I'm willing to enable your laziness in the spirit of a more free and open internet.&lt;/p&gt;
&lt;p&gt;Before we dive in, an important caveat: You will become a sysadmin of your own mail server. &lt;em&gt;If you screw something up, you might not be able to send or receive email.&lt;/em&gt; Sure, if all else fails, you can admit defeat and point your MX records at a Google Apps account and carry on. However, you run the risk of losing emails in the interim. I'm going to try to make this guide as foolproof as possible, but if you're not comfortable assuming this responsibility, it might be best to leave it to the experts.&lt;/p&gt;
&lt;p&gt;With that out of the way, here's what this guide will get you:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Opportunistic TLS for sending/receiving email with &lt;a href=&quot;http://www.postfix.org&quot;&gt;Postfix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Access to your email anywhere using IMAP with &lt;a href=&quot;https://dovecot.org&quot;&gt;Dovecot&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Fast, modern spam filtering with &lt;a href=&quot;https://rspamd.com&quot;&gt;Rspamd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Full-text search of your mailbox with &lt;a href=&quot;https://lucene.apache.org/solr/&quot;&gt;Apache Solr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;DKIM, SPF, and DMARC records to ensure your outgoing mail is not spam-filtered&lt;/li&gt;
&lt;li&gt;Statistical training of your spam filter based on what you move in/out of the Junk folder&lt;/li&gt;
&lt;li&gt;Custom email sorting/filtering using &lt;a href=&quot;http://sieve.info&quot;&gt;sieve&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;After running this setup for year or so, I have found many aspects to be &lt;em&gt;better&lt;/em&gt; than GMail. I think the spam filtering works better, and being able to write a sieve script to sort your inbox is a godsend compared to GMail's convoluted filter system. And as Google occasionally seems to &lt;a href=&quot;http://www.washingtontimes.com/news/2017/aug/1/jordan-b-petersons-youtube-account-locked-during-b/&quot;&gt;suspend the accounts of those with opinions they don't like&lt;/a&gt;, you'll have peace of mind with all your mail on a system &lt;em&gt;you&lt;/em&gt; control.&lt;/p&gt;
&lt;p&gt;A final note: I run everything on &lt;a href=&quot;https://www.freebsd.org/&quot;&gt;FreeBSD&lt;/a&gt;, so you may have to massage some of the commands to work on your Linux flavor of choice, if that's your thing. All the software used is open source, and should run equally well on any Unix-like OS.&lt;/p&gt;
&lt;hr/&gt;&lt;ol&gt;&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#overview&quot;&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dns&quot;&gt;DNS Records&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#postfix&quot;&gt;Postfix: The Mail Transfer Agent&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dovecot&quot;&gt;Dovecot: The Mail Delivery Agent&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#solr&quot;&gt;Solr: Full-Text Search&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#rspamd&quot;&gt;Rspamd: Spam Filtering&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dkim&quot;&gt;DKIM: Validation for Your Outgoing Mail&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#sieve&quot;&gt;Sieve: Scripting Your Mailbox&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;hr/&gt;&lt;section readability=&quot;89.862877762742&quot;&gt;&lt;h2 id=&quot;overview&quot;&gt;Overview&lt;/h2&gt;
&lt;p&gt;Now, take a deep breath, and feast your eyes on this convoluted Rube Goldberg machine of an email system which you will soon bring lumbering to life. (Apologies, Firefox users. I'm unable to figure out why this SVG doesn't render properly.) &lt;img alt=&quot;architecture diagram&quot; src=&quot;https://www.c0ffee.net/img/mail_server_diagram.svg&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Let's walk through the architecture. All email (whether sent or received) first goes through &lt;a href=&quot;http://www.postfix.org&quot;&gt;Postfix&lt;/a&gt; - the Mail Transfer Agent (MTA). Postfix is responsible for transferring email to wherever it's supposed to go. If the recipient domain's mailbox is on our own server, Postfix will accept the message for delivery. Otherwise, Postfix will relay the message to the recipient's mail server.&lt;/p&gt;
&lt;p&gt;If you are &lt;em&gt;sending&lt;/em&gt; an email to someone, you connect to Postfix over SMTP with mandatory STARTTLS encryption on port 587. After successfully validating your username and password, Postfix will accept your message to relay to the recipient's mail server over SMTP using opportunistic TLS. (&quot;Opportunistic&quot; means that we will use encryption if the other side supports it, and fall back to plaintext if they don't.)&lt;/p&gt;
&lt;p&gt;If you are &lt;em&gt;receiving&lt;/em&gt; an email from someone, the sender's mail server will connect to Postfix over SMTP with opportunistic TLS on port 25. After doing some basic security and spam checks (like prohibiting unauthorized relaying and ensuring the other side has valid DNS records in place), Postfix will accept the message for delivery.&lt;/p&gt;
&lt;p&gt;Whether a message is relayed (you sent an email to someone) or accepted for delivery (someone sent an email to you), it is first filtered through the &lt;a href=&quot;https://rspamd.com&quot;&gt;rspamd&lt;/a&gt; milter. (&lt;em&gt;&lt;a href=&quot;http://www.postfix.org/MILTER_README.html&quot;&gt;milter&lt;/a&gt;&lt;/em&gt; is just a term for a Postfix mail filter.) For incoming mail, rspamd does some spam checking and may flag the message as spam or reject it altogether. For outgoing mail, rspamd just takes care of the &lt;a href=&quot;http://www.dkim.org&quot;&gt;DKIM&lt;/a&gt; signing (discussed in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dkim&quot;&gt;DKIM section&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;If an accepted email makes it through the rspamd milter, it is delivered to &lt;a href=&quot;https://www.dovecot.org&quot;&gt;Dovecot&lt;/a&gt; - the Mail Delivery Agent (MDA) - using a local unix domain socket. Dovecot takes the emails from Postfix and stores them in the user's mailbox. The mailbox can be stored on the filesystem in a few different formats - with Maildir and mbox being commonly used. Dovecot provides remote access to your mailbox using the POP3 and IMAP protocols. In addition, it supports automatic mail filtering using custom &lt;a href=&quot;http://sieve.info&quot;&gt;sieve&lt;/a&gt; scripts.&lt;/p&gt;
&lt;p&gt;When Dovecot receives a message, it first passes it to the &lt;a href=&quot;http://lucene.apache.org/solr/&quot;&gt;Solr&lt;/a&gt; server, which indexes it for future full-text searches. Then, a sieve script will run which automatically places mail with the &lt;span class=&quot;monospace&quot;&gt;X-SPAM&lt;/span&gt; header into the user's Junk folder. In addition, when a user moves a message in or out of their Junk folder, Dovecot will inform rspamd to re-train a message as spam or ham. POP3 is ancient history, so in our setup we'll only expose our emails over SSL-secured IMAP.&lt;/p&gt;
&lt;p&gt;I run a local &lt;a href=&quot;https://www.ldap.com/getting-started-with-ldap&quot;&gt;LDAP server&lt;/a&gt;, which allows me to use a single username and password for all my self-hosted apps. In this guide, I'll describe how to store your mail credentials and email aliases in LDAP. However, it's just as easy to store this information in a relational database or flat files.&lt;/p&gt;
&lt;p&gt;A quick note: Dovecot supports &lt;a href=&quot;https://tools.ietf.org/html/rfc2177&quot;&gt;IMAP IDLE&lt;/a&gt;, which provides a pseudo-push functionality to get notified of new mail &quot;instantly.&quot; While this works for most desktop mail clients, such as &lt;span class=&quot;monospace&quot;&gt;&lt;a href=&quot;http://www.mutt.org&quot;&gt;mutt&lt;/a&gt;&lt;/span&gt; and OS X's Mail.app, it isn't supported by mobile clients (with Android's &lt;a href=&quot;https://k9mail.github.io&quot;&gt;K-9 Mail&lt;/a&gt; being a notable exception). There is an open-source implementation of the Exchange ActiveSync protocol called &lt;a href=&quot;http://z-push.org&quot;&gt;Z-Push&lt;/a&gt;, which integrates with your IMAP server to provide push notifications to iOS and Android devices.&lt;/p&gt;
&lt;p&gt;I ran Z-Push for a few months, but there were enough small bugs (along with the hassle of running PHP in production) to make me uninstall it. Setting my iPhone to check for new mail every 15 minutes is plenty fast for me, and I still have about 40% battery left at the end of the day. However, if you are dead set on having &lt;em&gt;instant&lt;/em&gt; email notifications, it might be something to look into. It works well enough, I just didn't find it worth the trouble.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;EDIT (20 Sep 2017): I've got native push notifications working on iOS.&lt;/strong&gt; See &lt;a href=&quot;https://www.c0ffee.net/blog/dovecot-push-notifications&quot;&gt;this blog post&lt;/a&gt; for a step-by-step guide.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Finally, all the examples in this guide will use the &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt; domain and non-routable IP addresses. Obviously, you'll need to acquire your own domain name and public IP address for your mail server, and modify my examples accordingly. All commands in this guide should be run as root unless otherwise specified.&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;62.974428912376&quot;&gt;&lt;h2 id=&quot;dns&quot;&gt;DNS Records&lt;/h2&gt;
&lt;p&gt;First, you will need to set some DNS records so that other mail servers know where to send your email. If you use a &lt;a href=&quot;https://www.c0ffee.net/blog/dns-hidden-master&quot;&gt;hidden master server to host your DNS&lt;/a&gt; like I do, you can just edit your zone file and reload BIND. Otherwise, you can set these records in your DNS provider's management portal.&lt;/p&gt;
&lt;p&gt;You probably want to set a low TTL (around 60 seconds) until you've verified everything is working correctly. It's very annoying to realize you typed the wrong IP address and then have to wait 3 hours for the TTL to expire in order to test again.&lt;/p&gt;
&lt;p&gt;The first thing you'll need is an MX record. MX records tell other mail servers which hosts are running mail servers for a given domain. You can specify multiple MX records, each with their own priority, to use as fallback mail servers when your primary one is down. For my &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt; domain, I only have a single mail server, &lt;span class=&quot;monospace&quot;&gt;mail.example.com&lt;/span&gt;, so in my zone file I have a single MX record. Of course, you will need to substitute your own IP address and domain name.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/named/master/example.com.db&lt;/p&gt;
&lt;pre&gt;
$TTL    10800
$ORIGIN example.com.
@  1D  IN  SOA ns1.example.com.  root.example.com. (
            2017080802 
            1d 
            3m 
            1w 
            3h 
           )
       IN  MX  10 mail.example.com.

@      IN  A      203.0.113.41
@      IN  AAAA   2001:db8::2
mail   IN  A      203.0.113.42
mail   IN  AAAA   2001:db8::3
&lt;/pre&gt;
&lt;p&gt;It is &lt;strong&gt;critically important&lt;/strong&gt; that you have &lt;strong&gt;reverse&lt;/strong&gt; DNS records for your mail server host. If your reverse DNS records do not point back to your mail server, other mail servers may reject your email as spam. Normally, you can set reverse DNS records in your hosting provider's web portal. Make sure to set reverse DNS for both the IPv4 and IPv6 address of your mail server.&lt;/p&gt;
&lt;p&gt;Your mail server's reverse DNS and fully qualified domain name don't have to match exactly, but your hostname in reverse DNS should probably resolve to the same IP as your MX record. Your best bet is to have it point straight back to your mail server's hostname. You can verify your reverse DNS record using the &lt;span class=&quot;monospace&quot;&gt;dig&lt;/span&gt; command:&lt;/p&gt;
&lt;pre&gt;
dig +short -x 203.0.113.42

&lt;/pre&gt;
&lt;p&gt;However, just having any reverse DNS record in place is enough for most mail servers to accept your mail.&lt;/p&gt;
&lt;p&gt;You will also need to set an &lt;a href=&quot;http://www.openspf.org&quot;&gt;SPF record&lt;/a&gt; for your mail server. While an SPF record is not technically required for your mail server to work, having one in place significantly reduces the likelihood of your mail being rejected as spam. An SPF record tells other mail servers which hosts are allowed to send mail on behalf of your domain. In my case, I have a single mail server, and I want others to accept mail from that server only. So my SPF record looks like this:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/named/master/example.com.db&lt;/p&gt;
&lt;pre&gt;
@  IN  TXT  &quot;v=spf1 mx -all&quot;
&lt;/pre&gt;
&lt;p&gt;This indicates that only my MX records (&lt;span class=&quot;monospace&quot;&gt;mail.example.com&lt;/span&gt;) are allowed to send mail for &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt;, and mail coming from anywhere else should be assumed to be spam and rejected. You can add your SPF definition as a TXT record in your DNS provider's web portal (without the quotes).&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;201.17375922369&quot;&gt;&lt;h2 id=&quot;postfix&quot;&gt;Postfix: The Mail Transfer Agent&lt;/h2&gt;
&lt;p&gt;Now we're ready to install and configure some software. I install my packages from FreeBSD ports, so substitute the appropriate commands for your package manager of choice. First, bring everything up to date:&lt;/p&gt;
&lt;pre&gt;
portsnap fetch &amp;amp;&amp;amp; portsnap update
portmaster -aBd
&lt;/pre&gt;
&lt;p&gt;Postfix will be responsible for sending and receiving mail for our domain over SMTP. Install it from ports:&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/mail/postfix
make install clean
&lt;/pre&gt;
&lt;p&gt;For my setup, I use the following build options: &lt;span class=&quot;monospace&quot;&gt;LDAP PCRE PGSQL TLS&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Once you've watched the magic text scroll for a few minutes, postfix should be installed. Navigate to it's configuration directory and edit the config file. (On FreeBSD, software packages from ports are always installed under the &lt;span class=&quot;monospace&quot;&gt;/usr/local&lt;/span&gt; prefix. It should be under &lt;span class=&quot;monospace&quot;&gt;/etc/postfix&lt;/span&gt; if you're on Linux.)&lt;/p&gt;
&lt;pre&gt;
cd /usr/local/etc/postfix
vim main.cf
&lt;/pre&gt;
&lt;p&gt;Below is what I have in my &lt;span class=&quot;monospace&quot;&gt;main.cf&lt;/span&gt;. I've given you some brief commentary on what all the config options do, but you can always check &lt;a href=&quot;http://www.postfix.org/postconf.5.html&quot;&gt;the man page&lt;/a&gt; if you need more details on something. This is a pretty standard &lt;em&gt;virtual users&lt;/em&gt; setup. Rather than host mail for actual unix accounts on the server, postfix will use an external database (LDAP, in my case) to determine which email addresses it should accept mail for.&lt;/p&gt;
&lt;p&gt;When a message is accepted for delivery, postfix hands it off to Dovecot. Postfix will also use Dovecot's &lt;span class=&quot;monospace&quot;&gt;auth&lt;/span&gt; mechanism to authenticate SMTP users. We'll configure the LDAP authentication in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dovecot&quot;&gt;Dovecot section&lt;/a&gt; and let postfix just re-use it.&lt;/p&gt;
&lt;p&gt;We'll set some standard spam-proofing and security options here as well, but we'll be coming back to this file when we set up rspamd in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#rspamd&quot;&gt;section below&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/main.cf&lt;/p&gt;
&lt;pre&gt;

compatibility_level = 2


biff = no


mail_spool_directory = /var/mail/local



myhostname = mail.example.com





mydestination = awesomebox.example.com, localhost.example.com, localhost



myorigin = awesomebox.example.com


disable_vrfy_command = yes


strict_rfc821_envelopes = yes


show_user_unknown_table_name = no




message_size_limit = 51200000
mailbox_size_limit = 51200000


allow_percent_hack = no
swap_bangpath = no


recipient_delimiter = +


smtpd_tls_cert_file = /usr/local/etc/ssl/certs/mail.example.com.rsa.crt
smtpd_tls_key_file = /usr/local/etc/ssl/certs/mail.example.com.rsa.key





smtpd_tls_eccert_file = /usr/local/etc/ssl/certs/mail.example.com.ecc.crt
smtpd_tls_eckey_file = /usr/local/etc/ssl/certs/mail.example.com.ecc.key
smtpd_tls_eecdh_grade = ultra



smtp_tls_CAfile=/etc/ssl/cert.pem




smtp_tls_security_level = dane
smtp_dns_support_level = dnssec







smtp_bind_address = 203.0.113.42
smtp_bind_address6 = 2001:db8::3










smtpd_tls_mandatory_protocols = !SSLv2, !SSLv3, !TLSv1, !TLSv1.1, TLSv1.2
smtpd_tls_mandatory_ciphers = high
tls_high_cipherlist = ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256


smtpd_tls_security_level = may


tls_ssl_options = no_ticket, no_compression


smtpd_tls_dh512_param_file  = /usr/local/etc/ssl/dh512.pem
smtpd_tls_dh1024_param_file = /usr/local/etc/ssl/dh2048.pem


smtpd_tls_session_cache_database = btree:${data_directory}/smtpd_tlscache
smtp_tls_session_cache_database  = btree:${data_directory}/smtp_tlscache



smtpd_sasl_auth_enable = yes
smtpd_sasl_path = private/auth
smtpd_sasl_type = dovecot


smtpd_tls_auth_only = yes


smtpd_sasl_security_options = noanonymous, noplaintext

smtpd_sasl_tls_security_options = noanonymous


smtpd_tls_received_header = yes



smtpd_helo_required = yes








smtpd_client_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  reject_unknown_reverse_client_hostname,
  
  
  
  
  
  reject_unauth_pipelining
smtpd_helo_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  reject_invalid_helo_hostname,
  reject_non_fqdn_helo_hostname,
  
  
  
  
  
  reject_unauth_pipelining
smtpd_sender_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  reject_non_fqdn_sender,
  reject_unknown_sender_domain,
  reject_unauth_pipelining
smtpd_relay_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  
  reject_unauth_destination
  
smtpd_recipient_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  reject_non_fqdn_recipient,
  reject_unknown_recipient_domain,
  reject_unauth_pipelining,
  reject_unverified_recipient
smtpd_data_restrictions =
  permit_mynetworks,
  permit_sasl_authenticated,
  reject_multi_recipient_bounce,
  reject_unauth_pipelining


virtual_transport = lmtp:unix:private/dovecot-lmtp


virtual_mailbox_domains = ldap:/usr/local/etc/postfix/ldap-virtual-mailbox-domains.cf

virtual_mailbox_maps = ldap:/usr/local/etc/postfix/ldap-virtual-mailbox-maps.cf, hash:/usr/local/etc/postfix/system-virtual-mailboxes

virtual_alias_maps = ldap:/usr/local/etc/postfix/ldap-virtual-alias-maps.cf






&lt;/pre&gt;
&lt;p&gt;We'll need to create some of the files and directories we specified in this file:&lt;/p&gt;
&lt;pre&gt;

mkdir /var/mail/local
chown root:mail /var/mail/local
chmod 775 /var/mail/local


openssl dhparam -out /usr/local/etc/ssl/dh512.pem 512
openssl dhparam -out /usr/local/etc/ssl/dh2048.pem 2048
chmod 644 /usr/local/etc/ssl/dh{512,2048}.pem
&lt;/pre&gt;
&lt;p&gt;In &lt;span class=&quot;monospace&quot;&gt;master.cf&lt;/span&gt;, you can set service-specific overrides for the options you set in &lt;span class=&quot;monospace&quot;&gt;main.cf&lt;/span&gt;. We'll use this file to make encryption mandatory on the submission port (587). You can just change the lines below the &lt;span class=&quot;monospace&quot;&gt;smtp&lt;/span&gt; and &lt;span class=&quot;monospace&quot;&gt;submission&lt;/span&gt; declarations - no need to change anything else in this file.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/master.cf&lt;/p&gt;
&lt;pre&gt;


smtp      inet  n       -       n       -       -       smtpd
  -o smtpd_sasl_auth_enable=no



submission inet n       -       n       -       -       smtpd
  -o smtpd_tls_security_level=encrypt
  -o tls_preempt_cipherlist=yes
&lt;/pre&gt;
&lt;p&gt;Now we need to tell postfix which users and domains we want to accept mail for. I use LDAP, so the files below just tell postfix which queries to run to get the neccessary information. You can check out how I setup OpenLDAP &lt;a class=&quot;disabled&quot;&gt;here&lt;/a&gt; (another blog post I need to write). If you want to use flat files instead, you can use &lt;span class=&quot;monospace&quot;&gt;hash:&lt;/span&gt; instead of &lt;span class=&quot;monospace&quot;&gt;ldap:&lt;/span&gt; in the last three lines of &lt;span class=&quot;monospace&quot;&gt;main.cf&lt;/span&gt; shown above. You can then enter your users, domains, and aliases in plain text directly in those files, and &quot;compile&quot; them with the &lt;span class=&quot;monospace&quot;&gt;postmap&lt;/span&gt; command. Or you could put the information in a PostgreSQL database - there's plenty of online tutorials for that as well. You can read more details on the &lt;a href=&quot;http://www.postfix.org/VIRTUAL_README.html&quot;&gt;postfix virtual readme&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Anyway, if you're using LDAP, read on. I haven't spent much time perfecting my LDAP schema‚ÄîI got a personal &quot;single sign on&quot; system working with it, and left it at that. If you have a more robust LDAP setup, you'll probably need to tweak these queries. The first file specifies which domains this server will accept mail for:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/ldap-virtual-mailbox-domains.cf&lt;/p&gt;
&lt;pre&gt;
server_host = ldapi://%2fvar%2frun%2fopenldap%2fldapi/
search_base = ou=domains,dc=example,dc=com
version = 3
bind = no
query_filter = (&amp;amp;(ObjectClass=dNSDomain)(dc=%s))
result_attribute = dc
&lt;/pre&gt;
&lt;p&gt;The next file specifies the mailboxes (email addresses) this server will accept mail for:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/ldap-virtual-mailbox-maps.cf&lt;/p&gt;
&lt;pre&gt;
server_host = ldapi://%2fvar%2frun%2fopenldap%2fldapi/
search_base = ou=users,dc=example,dc=com
version = 3
bind = no
query_filter = (&amp;amp;(objectclass=inetLocalMailRecipient)(mail=%s))
result_attribute = mail
&lt;/pre&gt;
&lt;p&gt;The last file specifies the aliases for those email addresses:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/ldap-virtual-mailbox-alias-maps.cf&lt;/p&gt;
&lt;pre&gt;
server_host = ldapi://%2fvar%2frun%2fopenldap%2fldapi/
search_base = ou=users,dc=example,dc=com
version = 3
bind = no
query_filter = (&amp;amp;(objectclass=inetLocalMailRecipient)(mailLocalAddress=%s))
result_attribute = mail
&lt;/pre&gt;
&lt;p&gt;The easiest way to set up your users and domains in LDAP is to set up an SSH tunnel to your server and run &lt;a href=&quot;http://directory.apache.org/studio/&quot;&gt;Apache Directory Studio&lt;/a&gt;. You can see how I have my domains set up in the query below:&lt;/p&gt;
&lt;pre&gt;
&lt;strong&gt;$ ldapsearch -b dc=example.com,ou=domains,dc=example,dc=com&lt;/strong&gt;
# extended LDIF
#
# LDAPv3
# base &amp;lt;dc=example.com,ou=domains,dc=example,dc=com&amp;gt; with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# example.com, domains, example.com
dn: dc=example.com,ou=domains,dc=example,dc=com
dc: example.com
objectClass: dNSDomain
objectClass: top

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
&lt;/pre&gt;
&lt;p&gt;The next query shows how I have users configured. The username is specified by the &lt;span class=&quot;monospace&quot;&gt;uid&lt;/span&gt; parameter. &lt;span class=&quot;monospace&quot;&gt;mail&lt;/span&gt; contains the user's primary mailbox, and each &lt;span class=&quot;monospace&quot;&gt;mailLocalAddress&lt;/span&gt; entry specifies an email alias for the user.&lt;/p&gt;
&lt;pre&gt;
&lt;strong&gt;$ ldapsearch -b uid=alphonsus,ou=users,dc=example,dc=com&lt;/strong&gt;
# extended LDIF
#
# LDAPv3
# base &amp;lt;uid=alphonsus,ou=users,dc=example,dc=com&amp;gt; with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# alphonsus, users, example.com
dn: uid=alphonsus,ou=users,dc=example,dc=com
cn: Alphonsus Liguori
givenName: Alphonsus
mail: alphonsus@example.com
mailLocalAddress: administrator@example.com
mailLocalAddress: root@example.com
mailLocalAddress: postmaster@example.com
o: The Church Triumphant
objectClass: person
objectClass: organizationalPerson
objectClass: inetOrgPerson
objectClass: inetLocalMailRecipient
sn: Liguori
uid: alphonsus
displayName: Alphonsus Liguori
userPassword: e0HEfj4uiQyYSQxMCRTbHVTYXJshYf4aS4udX...

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
&lt;/pre&gt;
&lt;p&gt;With those files in place, you can now start postfix! On FreeBSD, you will need to disable the &lt;span class=&quot;monospace&quot;&gt;sendmail&lt;/span&gt; daemon included by default in base and enable postfix to start on boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
sendmail_enable=&quot;NONE&quot;
postfix_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Now, you can kill sendmail and start postfix:&lt;/p&gt;
&lt;pre&gt;
service sendmail onestop
service postfix start
&lt;/pre&gt;
&lt;p&gt;Check the output of &lt;span class=&quot;monospace&quot;&gt;/var/log/maillog&lt;/span&gt; for any errors. Also, be sure to enable TCP traffic to ports 25 and 587 in your firewall.&lt;/p&gt;
&lt;p&gt;You should now have almost everything you need you need for a working postfix installation. We just need to get Dovecot running so postfix has somewhere to deliver the mail. Luckily, Dovecot is a little less arcane to set up.&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;192.19769053118&quot;&gt;&lt;h2 id=&quot;dovecot&quot;&gt;Dovecot: The Mail Delivery Agent&lt;/h2&gt;
&lt;p&gt;Dovecot will provide IMAP access to your mailbox, so you can access your email remotely from multiple devices. It can be easily installed from ports on FreeBSD:&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/mail/dovecot
make install clean
&lt;/pre&gt;
&lt;p&gt;I use the following build options on my server: &lt;span class=&quot;monospace&quot;&gt;KQUEUE LZ4 LDAP PGSQL ICU SOLR&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Be sure to install &lt;span class=&quot;monospace&quot;&gt;dovecot-piegeonhole&lt;/span&gt; as well in order to get sieve filtering.&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/mail/dovecot-pigeonhole
make install clean
&lt;/pre&gt;
&lt;p&gt;I use the &lt;span class=&quot;monospace&quot;&gt;LDAP&lt;/span&gt; and &lt;span class=&quot;monospace&quot;&gt;MANAGESIEVE&lt;/span&gt; options on my server. The &lt;span class=&quot;monospace&quot;&gt;managesieve&lt;/span&gt; protocol allows you to edit your sieve scripts from your email client. Unfortunately, the only client I know of that supports this functionality is &lt;a href=&quot;https://www.kde.org/applications/internet/kmail/&quot;&gt;KMail&lt;/a&gt;, so I haven't messed with it yet.&lt;/p&gt;
&lt;p&gt;After Dovecot is installed, you will need to create a &lt;span class=&quot;monospace&quot;&gt;vmail&lt;/span&gt; user to handle mail for the virtual users. You will also need to create the directories to store the virtual mail. We will use a separate attachments directory, so Dovecot will never waste disk space by storing the same attachment twice. Pretty neat!&lt;/p&gt;
&lt;pre&gt;
pw useradd -u 145 -n vmail -c &quot;Virtual Mail Handler&quot; -d /var/mail/vhosts -s /usr/sbin/nologin
mkdir /var/mail/{vhosts,attachments}
chown vmail:vmail /var/mail/{vhosts,attachments}
chmod 770 /var/mail/{vhosts,attachments}
&lt;/pre&gt;
&lt;p&gt;Then, you can navigate to Dovecot's configuration directory.&lt;/p&gt;
&lt;pre&gt;
cd /usr/local/etc/dovecot
&lt;/pre&gt;
&lt;p&gt;Here you should find a &lt;span class=&quot;monospace&quot;&gt;README&lt;/span&gt; and an &lt;span class=&quot;monospace&quot;&gt;example-config&lt;/span&gt; directory. Feel free to read over them, or you can just dive into my configs. First, create some additional directories:&lt;/p&gt;
&lt;pre&gt;
mkdir /usr/local/etc/dovecot/{conf.d,sieve,sieve-before.d,sieve-after.d}
chown root:dovecot /usr/local/etc/dovecot/{sieve,sieve-before.d,sieve-after.d}
&lt;/pre&gt;
&lt;p&gt;Open &lt;span class=&quot;monospace&quot;&gt;dovecot.conf&lt;/span&gt; first. Here, we will set some generic options and include the rest of the config files.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/dovecot.conf&lt;/p&gt;
&lt;pre&gt;

protocols = imap lmtp


first_valid_uid = 145
last_valid_uid = 145

!include conf.d/*.conf
!include_try local.conf
&lt;/pre&gt;
&lt;p&gt;The remaining config files live in the &lt;span class=&quot;monospace&quot;&gt;conf.d&lt;/span&gt; directory. Each file from my configuration is reproduced in its entirety below, with some helpful comments where appropriate.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/10-auth.conf&lt;/p&gt;
&lt;pre&gt;

auth_cache_size = 10M
auth_cache_ttl = 1 hour
auth_cache_negative_ttl = 1 hour


auth_mechanisms = plain


passdb {
  driver = ldap
  args = /usr/local/etc/dovecot/ldap.conf.ext
}




userdb {
  driver = static
  args = uid=vmail gid=vmail home=/var/mail/vhosts/%d/%n
}
&lt;/pre&gt;
&lt;p&gt;The file specified by &lt;span class=&quot;monospace&quot;&gt;passdb&lt;/span&gt; provides the LDAP query information necessary to authenticate usernames and passwords. Note that in my setup, I authenticate with the &lt;em&gt;user&lt;/em&gt; part only. Some other mail providers like to use the entire email address as the username‚Äînot so in this case.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/ldap.conf.ext&lt;/p&gt;
&lt;pre&gt;
hosts = localhost
auth_bind = no
ldap_version = 3
base = ou=users,dc=example,dc=com
deref = never
scope = subtree
user_attrs =
user_filter = (&amp;amp;(objectclass=inetOrgPerson)(uid=%n)
pass_attrs = mail=user,userPassword=password
pass_filter = (&amp;amp;(objectclass=inetOrgPerson)(uid=%n))
default_pass_scheme = CRYPT
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/10-mail.conf&lt;/p&gt;
&lt;pre&gt;

mail_home = /var/mail/vhosts/%d/%n







mail_location = mdbox:~/mdbox



namespace inbox {
  separator = /
  inbox = yes
}


mail_privileged_group = vmail



mail_attachment_dir = /var/mail/attachments
mail_attachment_min_size = 64k



&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/10-master.conf&lt;/p&gt;
&lt;pre&gt;


mail_fsync = never

service imap-login {
  
  inet_listener imap {
    address = 127.0.0.1, ::1
  }

  
  
  service_count = 0
  
  process_min_avail = 3
  vsz_limit = 1G
}


service pop3-login {
  inet_listener pop3 {
    port = 0
  }
  inet_listener pop3s {
    port = 0
  }
}


service imap {
  service_count = 256
  
  process_min_avail = 3
}


service lmtp {
 unix_listener /var/spool/postfix/private/dovecot-lmtp {
   group = postfix
   mode = 0600
   user = postfix
  }
}


service auth {
  unix_listener /var/spool/postfix/private/auth {
    mode = 0660
    user = postfix
    group = postfix
  }
}


service auth-worker {
  user = vmail
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/10-ssl.conf&lt;/p&gt;
&lt;pre&gt;

ssl = required

ssl_cert = &amp;lt;/usr/local/etc/ssl/certs/mail.example.com.ecc.crt
ssl_key = &amp;lt;/usr/local/etc/ssl/certs/mail.example.com.ecc.key


ssl_dh_parameters_length = 2048
ssl_protocols = !SSLv2 !SSLv3 !TLSv1 !TLSv1.1 TLSv1.2
ssl_cipher_list = ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256
ssl_prefer_server_ciphers = yes
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/15-lda.conf&lt;/p&gt;
&lt;pre&gt;


protocol lda {
  
  mail_fsync = optimized
  mail_plugins = $mail_plugins sieve
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/15-mailboxes.conf&lt;/p&gt;
&lt;pre&gt;


namespace inbox {
  mailbox Drafts {
    auto = subscribe
    special_use = \Drafts
  }
  mailbox Junk {
    auto = create
    special_use = \Junk
  }
  mailbox Trash {
    auto = create
    special_use = \Trash
  }
  mailbox Archive {
    auto = subscribe
    special_use = \Archive
  }
  mailbox Sent {
    auto = subscribe
    special_use = \Sent
  }
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/20-imap.conf&lt;/p&gt;
&lt;pre&gt;


imap_idle_notify_interval = 29 mins

protocol imap {
  
  mail_max_userip_connections = 50
  
  mail_plugins = $mail_plugins imap_sieve
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/20-lmtp.conf&lt;/p&gt;
&lt;pre&gt;
protocol lmtp {
  
  mail_fsync = optimized
  mail_plugins = $mail_plugins sieve
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/20-managesieve.conf&lt;/p&gt;
&lt;pre&gt;
protocols = $protocols sieve













&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/90-fts.conf&lt;/p&gt;
&lt;pre&gt;






&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/90-sieve.conf&lt;/p&gt;
&lt;pre&gt;
plugin {
  
  sieve = file:~/sieve;active=~/.dovecot.sieve

  
  
  sieve_before = /usr/local/etc/dovecot/sieve-before.d
  sieve_after  = /usr/local/etc/dovecot/sieve-after.d

  
  recipient_delimiter = +

  
  sieve_quota_max_storage = 50M
}
&lt;/pre&gt;
&lt;p&gt;You should now have a fully functional IMAP server. Enable Dovecot to start on boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
dovecot_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Then you can start Dovecot:&lt;/p&gt;
&lt;pre&gt;
service dovecot start
&lt;/pre&gt;
&lt;p&gt;Make sure to check &lt;span class=&quot;monospace&quot;&gt;/var/log/maillog&lt;/span&gt; for any errors. Congratulations! You should now have a fully functional mail server! Make sure TCP traffic to port 993 is enabled in your firewall.&lt;/p&gt;
&lt;p&gt;The remaining sections‚Äîfull-text search, spam filtering, etc‚Äîare just extras. Now is a good time to stop and make sure everything works before you go any further.&lt;/p&gt;
&lt;section readability=&quot;88.773824650572&quot;&gt;&lt;h3 id=&quot;mail-test&quot;&gt;Testing Your Mail Server&lt;/h3&gt;
&lt;p&gt;First, get a separate terminal open and tail your mail log while you are testing everything:&lt;/p&gt;
&lt;pre&gt;
tail -f /var/log/maillog
&lt;/pre&gt;
&lt;p&gt;Start by checking your MX records in DNS using the &lt;span class=&quot;monospace&quot;&gt;dig&lt;/span&gt; command. If your DNS is configured correctly, you should see results like the following:&lt;/p&gt;
&lt;pre&gt;
dig example.com MX +short

dig mail.example.com +short

&lt;/pre&gt;
&lt;p&gt;Now we can test your ability to send and receive mail. Don't worry if you can't connect to your server over port 25‚Äîalmost all residential ISPs block all traffic on this port to deter spammers. From your local machine, you can use an email client to connect to your mail server. Your connectivity details will be the following:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Incoming Mail: IMAP&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;username:&lt;/strong&gt; ldap username&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;password:&lt;/strong&gt; ldap password&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;server:&lt;/strong&gt; &lt;span class=&quot;monospace&quot;&gt;mail.example.com&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;port:&lt;/strong&gt; 993&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSL:&lt;/strong&gt; yes&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Outgoing Mail: SMTP&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;username:&lt;/strong&gt; ldap username&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;password:&lt;/strong&gt; ldap password&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;email address:&lt;/strong&gt; &lt;span class=&quot;monospace&quot;&gt;username@example.com&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;server:&lt;/strong&gt; &lt;span class=&quot;monospace&quot;&gt;mail.example.com&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;port:&lt;/strong&gt; 587&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSL:&lt;/strong&gt; STARTTLS&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;If you can log in, you should see an empty mailbox with default folders (Inbox, Drafts, Junk, etc). If not, you'll need to check your mail log and troubleshoot Dovecot.&lt;/p&gt;
&lt;p&gt;Next, you'll need to test outgoing mail. Hopefully you have a spare GMail account or another working email address you can test with. When you send an email through your mail client, you should see something like this in your mail log:&lt;/p&gt;
&lt;pre&gt;
postfix/smtpd[39231]: connect from SOME-IP-ADDRESS
postfix/smtpd[39231]: AA752DDA7D8: client=SOME-IP_ADDRESS, sasl_method=PLAIN, sasl_username=user@example.com
postfix/cleanup[39248]: AA752DDA7D8: message-id=&amp;lt;EE3CDE5B-9A46-405D-A74A-E409769F791D@example.com&amp;gt;
postfix/qmgr[39210]: AA752DDA7D8: from=&amp;lt;user@example.com&amp;gt;, size=762, nrcpt=1 (queue active)
postfix/smtp[39251]: AA752DDA7D8: to=&amp;lt;YOUR-OTHER-EMAIL@gmail.com&amp;gt;, relay=gmail-smtp-in.l.google.com[74.125.130.27]:25, delay=8.9, delays=4.9/0.03/3/1, dsn=2.0.0, status=sent (250 2.0.0 OK 1502808287 y15si6196590pli.453 - gsmtp)
postfix/qmgr[39210]: AA752DDA7D8: removed
postfix/smtpd[39231]: disconnect from SOME-IP-ADDRESS ehlo=2 starttls=1 auth=1 mail=1 rcpt=1 data=1 quit=1 commands=8
&lt;/pre&gt;
&lt;p&gt;If you don't see any errors in the log, you should find the email you just sent in your other email account's inbox. If it's not there, be sure to check your spam folder. (If it got flagged as spam, the testing steps in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dkim&quot;&gt;DKIM section&lt;/a&gt; should help determine why.)&lt;/p&gt;
&lt;p&gt;Now, you can test incoming mail. In your other email account, reply to the message you just sent yourself. This should be the first email ever sent to your new, personal email server. Fingers crossed! If the other side successfully finds your mail server and delivers the message, you should see something like this in your mail log:&lt;/p&gt;
&lt;pre&gt;
postfix/smtpd[39448]: connect from mail-yw0-x22b.google.com[2607:f8b0:4002:c05::22b]
postfix/verify[39459]: cache btree:/var/db/postfix/verify_cache full cleanup: retained=9 dropped=0 entries
postfix/smtpd[39448]: 98DA9DDA7D8: client=mail-yw0-x22b.google.com[2607:f8b0:4002:c05::22b]
postfix/cleanup[39460]: 98DA9DDA7D8: message-id=&amp;lt;CALM7EhMmCkzpex5pKu0TXh0z3+iYeLCGpw5VO9Sv_RanqgohYQ@mail.gmail.com&amp;gt;
postfix/qmgr[39210]: 98DA9DDA7D8: from=&amp;lt;YOUR-OTHER-EMAIL@gmail.com&amp;gt;, size=3449, nrcpt=1 (queue active)
dovecot: lmtp(39462): Connect from local
dovecot: lmtp(user@example.com): MMb/MfoPk1kmmgAA/gk8FQ: sieve: msgid=&amp;lt;CALM7EhMmCkzpex5pKu0TXh0z3+iYeLCGpw5VO9Sv_RanqgohYQ@mail.gmail.com&amp;gt;: stored mail into mailbox 'INBOX'
postfix/lmtp[39461]: 98DA9DDA7D8: to=&amp;lt;user@example.com&amp;gt;, relay=mail.example.com[private/dovecot-lmtp], delay=0.26, delays=0.21/0.01/0.01/0.03, dsn=2.0.0, status=sent (250 2.0.0 &amp;lt;user@example.com&amp;gt; MMb/MfoPk1kmmgAA/gk8FQ Saved)
dovecot: lmtp(39462): Disconnect from local: Successful quit
postfix/qmgr[39210]: 98DA9DDA7D8: removed
postfix/smtpd[39448]: disconnect from mail-yw0-x22b.google.com[2607:f8b0:4002:c05::22b] ehlo=2 starttls=1 mail=1 rcpt=1 data=1 quit=1 commands=7
postfix/smtpd[39471]: connect from unknown[181.49.241.194]
postfix/smtpd[39471]: disconnect from unknown[181.49.241.194] helo=1 auth=0/1 quit=1 commands=2/3
&lt;/pre&gt;
&lt;p&gt;If there were no errors, you should see the very first message in your new IMAP inbox! If there was a failure logged, you'll have to investigate postfix. Most likely there was problem finding your virtual mailbox, or postfix had some issue handing the mail off to Dovecot.&lt;/p&gt;
&lt;p&gt;If you didn't receive the email, and you don't see anything logged &lt;em&gt;at all&lt;/em&gt;, then you probably have a firewall issue or some problem with your MX records in DNS. Also, make sure your hosting provider allows traffic on port 25‚Äìsome of them are paranoid.&lt;/p&gt;
&lt;p&gt;Once you're able to send and receive emails from your new mail server, you're ready to get the rest of the goodies like full-text searching and spam filtering. Read on.&lt;/p&gt;
&lt;/section&gt;&lt;/section&gt;&lt;section readability=&quot;92.248767123288&quot;&gt;&lt;h2 id=&quot;solr&quot;&gt;Solr: Full-Text Search&lt;/h2&gt;
&lt;p&gt;Solr is a standalone full-text search platform from Apache the Apache Foundation. It's heavyweight and based on Java, but currently it's your best bet if you want open source full-text search with Dovecot. It's easily installed from ports on FreeBSD:&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/textproc/apache-solr
make install clean
&lt;/pre&gt;
&lt;p&gt;This will pull in Java as a dependency, so you may want to grab a coffee or something while the JVM compiles. The defaults in &lt;span class=&quot;monospace&quot;&gt;/usr/local/etc/solr.in.sh&lt;/span&gt; are fine. Enable solr to start on boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
solr_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Finally, start the solr server:&lt;/p&gt;
&lt;pre&gt;
service solr start
&lt;/pre&gt;
&lt;p&gt;Now we need to create a collection for Dovecot to use.&lt;/p&gt;
&lt;pre&gt;
su -m solr -c &quot;/usr/local/solr/bin/solr create -c dovecot -n dovecot&quot;
&lt;/pre&gt;
&lt;p&gt;This will create a Solr collection for Dovecot in &lt;span class=&quot;monospace&quot;&gt;/var/db/solr/dovecot&lt;/span&gt;. Navigate to the configuration directory‚Äîwe'll need to include some magic incantations I found on &lt;a href=&quot;http://mor-pah.net/2016/08/15/dovecot-2-2-with-solr-6-or-5/&quot;&gt;this guy's blog&lt;/a&gt; to get Solr working with Dovecot.&lt;/p&gt;
&lt;pre&gt;
cd /var/db/solr/dovecot/conf
&lt;/pre&gt;
&lt;p&gt;Delete the &lt;span class=&quot;monospace&quot;&gt;managed-schema&lt;/span&gt; file:&lt;/p&gt;
&lt;pre&gt;
rm /var/db/solr/dovecot/conf/managed-schema
&lt;/pre&gt;
&lt;p&gt;Create a file called &lt;span class=&quot;monospace&quot;&gt;schema.xml&lt;/span&gt; with the contents &lt;a href=&quot;https://www.c0ffee.net/files/schema.xml&quot;&gt;here&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;
curl -o /var/db/solr/dovecot/conf/schema.xml https://www.c0ffee.net/files/schema.xml
&lt;/pre&gt;
&lt;p&gt;Then, replace the entire contents of &lt;span class=&quot;monospace&quot;&gt;solrconfig.xml&lt;/span&gt; with the version &lt;a href=&quot;https://www.c0ffee.net/files/solrconfig.xml&quot;&gt;here&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;
curl -o /var/db/solr/dovecot/conf/solrconfig.xml https://www.c0ffee.net/files/solrconfig.xml
&lt;/pre&gt;
&lt;p&gt;Finally, make sure the &lt;span class=&quot;monospace&quot;&gt;solr&lt;/span&gt; user still owns those files:&lt;/p&gt;
&lt;pre&gt;
chown solr:solr /var/db/solr/dovecot/conf/{schema,solrconfig}.xml
&lt;/pre&gt;
&lt;p&gt;Solr should now be ready to index email for Dovecot. Restart the server for your changes to take effect.&lt;/p&gt;
&lt;pre&gt;
service solr restart
&lt;/pre&gt;
&lt;p&gt;Now you just need to configure Dovecot to use the Solr server. All you have to do is uncomment some lines in the files from &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dovecot&quot;&gt;the previous section&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/10-mail.conf&lt;/p&gt;
&lt;pre&gt;
mail_plugins = $mail_plugins fts fts_solr
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/90-fts.conf&lt;/p&gt;
&lt;pre&gt;
plugin {
  fts_autoindex = yes
  fts = solr
  fts_solr = url=http://127.0.0.1:8983/solr/dovecot/
}
&lt;/pre&gt;
&lt;p&gt;Reload Dovecot for your changes to take effect:&lt;/p&gt;
&lt;pre&gt;
service dovecot reload
&lt;/pre&gt;
&lt;p&gt;Now, whenever you receive an email or move a message from one IMAP folder to another, you should see something like this in your mail log:&lt;/p&gt;
&lt;pre&gt;
dovecot: indexer-worker(user@example.com): Indexed 1 messages in INBOX
&lt;/pre&gt;
&lt;p&gt;Indexing only occurs when a new message arrives in a folder. To index the entire inbox of all your mail users, run the following command:&lt;/p&gt;
&lt;pre&gt;
doveadm index -A inbox
&lt;/pre&gt;
&lt;p&gt;Finally, according to &lt;a href=&quot;https://wiki.dovecot.org/Plugins/FTS/Solr&quot;&gt;the Dovecot documentation&lt;/a&gt;, the Solr database needs to be issued a &lt;span class=&quot;monospace&quot;&gt;commit&lt;/span&gt; and &lt;span class=&quot;monospace&quot;&gt;optimize&lt;/span&gt; command every so often. This is easily accomplished by adding the following cron jobs (make sure you get the path to &lt;span class=&quot;monospace&quot;&gt;curl&lt;/span&gt; correct if you're using Linux):&lt;/p&gt;
&lt;p&gt;/etc/crontab&lt;/p&gt;
&lt;pre&gt;
15 2 * * *  solr /usr/local/bin/curl -s 'http://localhost:8983/solr/dovecot/update?optimize=true' &amp;gt; /dev/null
*/5 * * * * solr /usr/local/bin/curl -s 'http://localhost:8983/solr/dovecot/update?commit=true' &amp;gt; /dev/null
&lt;/pre&gt;
&lt;p&gt;You should now have full-text search of your mailbox over IMAP. You can test it out by searching for some text on your mobile IMAP client (often desktop mail clients will perform searches using local cached data). Or, you can test it yourself from your server using &lt;span class=&quot;monospace&quot;&gt;telnet&lt;/span&gt;. Type the following lines (including the preceding numbers) into the prompt:&lt;/p&gt;
&lt;pre&gt;
telnet localhost imap
* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR...] I am ready.
1 login your_username your_password
2 select Inbox
3 SEARCH text &quot;test&quot;
&lt;/pre&gt;
&lt;p&gt;If you encounter any issues, Solr provides a web interface on localhost port 8983. You can set up an SSH tunnel to your server and forward the port to your local machine to check its status. You can also view the logs in &lt;span class=&quot;monospace&quot;&gt;/var/log/solr&lt;/span&gt;.&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;224.00023696682&quot;&gt;&lt;h2 id=&quot;rspamd&quot;&gt;Rspamd: Spam Filtering&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://rspamd.com&quot;&gt;Rspamd&lt;/a&gt; is a fast, open source spam filtering system which utilizes multiple techniques to prevent spam from reaching your mailbox. I was a happy user of &lt;a href=&quot;https://sourceforge.net/projects/dspam/&quot;&gt;dspam&lt;/a&gt; for years, but it has been &lt;a href=&quot;https://sourceforge.net/p/dspam/mailman/message/32585111/&quot;&gt;offically abandoned since 2014&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Rspamd is actively developed and appears to be a much more modern project. Written in C, it is quite fast and integrates directly into postfix as a milter. Like dspam, it uses bayesian filtering to learn what users consider to be spam and ham. However, it also incorporates many other anti-spam measures: &lt;a href=&quot;https://rspamd.com/doc/modules/rbl.html&quot;&gt;RBL checks&lt;/a&gt;, &lt;a href=&quot;https://rspamd.com/doc/modules/spf.html&quot;&gt;SPF&lt;/a&gt;/&lt;a href=&quot;https://rspamd.com/doc/modules/dkim.html&quot;&gt;DKIM&lt;/a&gt;/&lt;a href=&quot;https://dmarc.org&quot;&gt;DMARC&lt;/a&gt; validation, &lt;a href=&quot;https://www.rhyolite.com/dcc/&quot;&gt;DCC bulk mail checks&lt;/a&gt;, and &lt;a href=&quot;https://rspamd.com/doc/modules/greylisting.html&quot;&gt;greylisting&lt;/a&gt;, to name a few. In addition, it has some other useful features like &lt;a href=&quot;https://rspamd.com/doc/modules/dkim_signing.html&quot;&gt;DKIM signing of outgoing mail&lt;/a&gt;, &lt;a href=&quot;https://rspamd.com/doc/modules/replies.html&quot;&gt;automatic whitelisting when you reply to someone&lt;/a&gt;, and a &lt;a href=&quot;https://www.rspamd.com/webui/&quot;&gt;web interface&lt;/a&gt; where you can see spam checking results in real time.&lt;/p&gt;
&lt;p&gt;Sold yet? Let's get rspamd installed. It's available in FreeBSD ports:&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/mail/rspamd
make install clean
&lt;/pre&gt;
&lt;p&gt;I use the following build options: &lt;span class=&quot;monospace&quot;&gt;GD HYPERSCAN&lt;/span&gt;. The &lt;a href=&quot;https://01.org/hyperscan&quot;&gt;hyperscan&lt;/a&gt; option is especially cool‚Äîit enables high performance regex matching.&lt;/p&gt;
&lt;p&gt;Enable rspamd to start at boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
rspamd_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Finally, start rspamd:&lt;/p&gt;
&lt;pre&gt;
service rspamd start
&lt;/pre&gt;
&lt;p&gt;Many rspamd modules require a &lt;a href=&quot;https://redis.io&quot;&gt;redis&lt;/a&gt; instance to work, so install that as well. The default build options are fine.&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/databases/redis
make install clean
&lt;/pre&gt;
&lt;p&gt;You'll want to set some redis options recommended by the &lt;a href=&quot;https://rspamd.com/doc/quickstart.html#caching-setup&quot;&gt;official rspamd tutorial&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/redis.conf&lt;/p&gt;
&lt;pre&gt;

bind 127.0.0.1 ::1



maxmemory 512mb
maxmemory-policy volatile-lru
&lt;/pre&gt;
&lt;p&gt;Enable redis to start at boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
redis_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Finally, start the redis daemon:&lt;/p&gt;
&lt;pre&gt;
service redis start
&lt;/pre&gt;
&lt;p&gt;One of the rspamd modules we will use depends on the &lt;a href=&quot;https://www.dcc-servers.net/dcc/&quot;&gt;DCC daemon&lt;/a&gt; to check mails for bulkiness. You can install it from ports as well. The default build options are fine.&lt;/p&gt;
&lt;pre&gt;
cd /usr/ports/mail/dcc-dccd
make install clean
&lt;/pre&gt;
&lt;p&gt;Uncomment the following options in &lt;span class=&quot;monospace&quot;&gt;/usr/local/dcc/dcc_conf&lt;/span&gt;. We'll be using the DCC service to detect spam, but won't be actively reporting anything.&lt;/p&gt;
&lt;p&gt;/usr/local/dcc/dcc_conf&lt;/p&gt;
&lt;pre&gt;
DCCM_LOG_AT=NEVER
DCCM_REJECT_AT=MANY
DCCIFD_ENABLE=on
&lt;/pre&gt;
&lt;p&gt;DCC is rather arcane and doesn't seem to log to syslog like modern software. I haven't figured out a nice way of rotating its logs with &lt;span class=&quot;monospace&quot;&gt;newsyslogd&lt;/span&gt; yet, so for now I just have a cronjob to delete them every day:&lt;/p&gt;
&lt;p&gt;/etc/crontab&lt;/p&gt;
&lt;pre&gt;
0 2 * * * /usr/bin/find /usr/local/dcc/log/ -not -newermt '1 days ago' -delete
&lt;/pre&gt;
&lt;p&gt;Enable DCC to start at boot:&lt;/p&gt;
&lt;p&gt;/etc/rc.conf&lt;/p&gt;
&lt;pre&gt;
dccifd_enable=&quot;YES&quot;
&lt;/pre&gt;
&lt;p&gt;Finally, start the DCC daemon:&lt;/p&gt;
&lt;pre&gt;
service dccifd start
&lt;/pre&gt;
&lt;p&gt;Now, your're ready to configure rspamd itself. Rspamd's default configuration files live in &lt;span class=&quot;monospace&quot;&gt;/usr/local/etc/rspamd&lt;/span&gt;. Don't edit these files directly, as they will be overwritten when the rspamd package is updated. Instead, create a local configuration directory. All your custom configuration will go here:&lt;/p&gt;
&lt;pre&gt;
mkdir /usr/local/etc/rspamd/local.d
&lt;/pre&gt;
&lt;p&gt;On the rspamd website, you'll find the &lt;a href=&quot;https://www.rspamd.com/doc/quickstart.html&quot;&gt;rspamd quick start guide&lt;/a&gt;, along with the &lt;a href=&quot;https://www.rspamd.com/doc/modules/&quot;&gt;documentation for all the modules&lt;/a&gt;. Feel free design your own setup, or you can just copy what I've done in the files below. I've enabled most of the useful modules and provided some commentary where appropriate.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/worker-controller.inc&lt;/p&gt;
&lt;pre&gt;


password = &quot;$2$or9n9ffj4qsogh7i8d9qi5u1hxt53q6o$ntp4kj...&quot;;



bind_socket = &quot;/var/run/rspamd/rspamd.sock mode=0666 owner=nobody&quot;;


bind_socket = &quot;127.0.0.1:11334&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/worker-normal.inc&lt;/p&gt;
&lt;pre&gt;


enabled = false;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/worker-proxy.inc&lt;/p&gt;
&lt;pre&gt;

milter = yes;


bind_socket = &quot;/var/run/rspamd/milter.sock mode=0666 owner=nobody&quot;;



timeout = 120s;
upstream &quot;local&quot; {
  default = yes;
  self_scan = yes;
}
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/redis.conf&lt;/p&gt;
&lt;pre&gt;

servers = &quot;127.0.0.1&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/classifier-bayes.conf&lt;/p&gt;
&lt;pre&gt;
autolearn = true;
backend = &quot;redis&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/dcc.conf&lt;/p&gt;
&lt;pre&gt;

host = &quot;/usr/local/dcc/dccifd&quot;;
timeout = 5.0;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/dkim_signing.conf&lt;/p&gt;
&lt;pre&gt;

path = &quot;/var/db/rspamd/dkim/$domain.$selector.key&quot;;
selector = &quot;dkim&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/mx_check.conf&lt;/p&gt;
&lt;pre&gt;

enabled = true;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/phishing.conf&lt;/p&gt;
&lt;pre&gt;

openphish_enabled = true;
phishtank_enabled = true;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/replies.conf&lt;/p&gt;
&lt;pre&gt;

action = &quot;no action&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/surbl.conf&lt;/p&gt;
&lt;pre&gt;

redirector_hosts_map = &quot;/usr/local/etc/rspamd/redirectors.inc&quot;;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/url_reputation.conf&lt;/p&gt;
&lt;pre&gt;

enabled = true;
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/url_tags.conf&lt;/p&gt;
&lt;pre&gt;

enabled = true;
&lt;/pre&gt;
&lt;p&gt;Restart rspamd for all these changes to take effect:&lt;/p&gt;
&lt;pre&gt;
service rspamd restart
&lt;/pre&gt;
&lt;p&gt;Now, you'll need to configure postfix to use rspamd as a milter. Open &lt;span class=&quot;monospace&quot;&gt;/usr/local/etc/postfix/main.cf&lt;/span&gt; and uncomment the lines you added in &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#postfix&quot;&gt;the postfix section&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/postfix/main.cf&lt;/p&gt;
&lt;pre&gt;
milter_protocol = 6

milter_default_action = accept
smtpd_milters = unix:/var/run/rspamd/milter.sock
milter_mail_macros = i {mail_addr} {client_addr} {client_name} {auth_authen}
&lt;/pre&gt;
&lt;p&gt;Reload postfix for your changes to take effect:&lt;/p&gt;
&lt;pre&gt;
service postfix reload
&lt;/pre&gt;
&lt;p&gt;At this point, rspamd should be filtering your incoming email as it arrives through postfix. To verify, send yourself a test email and check the output of your mail log, along with &lt;span class=&quot;monospace&quot;&gt;/var/log/rspamd/rspamd.log&lt;/span&gt;. You also can view real-time filtering stats in the rspamd web interface. Just set up an SSH tunnel to your server, forward port 11334 to localhost, and point your web browser there.&lt;/p&gt;
&lt;p&gt;Once you've verified rspamd and postfix are working together, all that's left is to configure Dovecot to train rspamd when you move messages in and out of your Junk folder. The steps for achieving this were derived from &lt;a href=&quot;https://wiki2.dovecot.org/HowTo/AntispamWithSieve&quot;&gt;this Dovecot guide&lt;/a&gt;. Add a new file, &lt;span class=&quot;monospace&quot;&gt;90-imapsieve.conf&lt;/span&gt;, under Dovecot's &lt;span class=&quot;monospace&quot;&gt;conf.d&lt;/span&gt; directory with the following contents:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/conf.d/90-imapsieve.conf&lt;/p&gt;
&lt;pre&gt;
plugin {
  sieve_plugins = sieve_imapsieve sieve_extprograms

  
  imapsieve_mailbox1_name = Junk
  imapsieve_mailbox1_causes = COPY
  imapsieve_mailbox1_before = file:/usr/local/etc/dovecot/sieve/report-spam.sieve

  
  imapsieve_mailbox2_name = *
  imapsieve_mailbox2_from = Junk
  imapsieve_mailbox2_causes = COPY
  imapsieve_mailbox2_before = file:/usr/local/etc/dovecot/sieve/report-ham.sieve

  sieve_pipe_bin_dir = /usr/local/etc/dovecot/sieve

  sieve_global_extensions = +vnd.dovecot.pipe
}
&lt;/pre&gt;
&lt;p&gt;Restart Dovecot to load the necessary sieve plugins:&lt;/p&gt;
&lt;pre&gt;
service dovecot restart
&lt;/pre&gt;
&lt;p&gt;Create the following sieve scripts in the &lt;span class=&quot;monospace&quot;&gt;/usr/local/etc/dovecot/sieve&lt;/span&gt; directory:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/sieve/report-spam.sieve&lt;/p&gt;
&lt;pre&gt;
require [&quot;vnd.dovecot.pipe&quot;, &quot;copy&quot;, &quot;imapsieve&quot;, &quot;environment&quot;, &quot;variables&quot;];

if environment :matches &quot;imap.email&quot; &quot;*&quot; {
  set &quot;email&quot; &quot;${1}&quot;;
}

pipe :copy &quot;train-spam.sh&quot; [ &quot;${email}&quot; ];
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/sieve/report-ham.sieve&lt;/p&gt;
&lt;pre&gt;
require [&quot;vnd.dovecot.pipe&quot;, &quot;copy&quot;, &quot;imapsieve&quot;, &quot;environment&quot;, &quot;variables&quot;];

if environment :matches &quot;imap.mailbox&quot; &quot;*&quot; {
  set &quot;mailbox&quot; &quot;${1}&quot;;
}

if string &quot;${mailbox}&quot; &quot;Trash&quot; {
  stop;
}

if environment :matches &quot;imap.email&quot; &quot;*&quot; {
  set &quot;email&quot; &quot;${1}&quot;;
}

pipe :copy &quot;train-ham.sh&quot; [ &quot;${email}&quot; ];
&lt;/pre&gt;
&lt;p&gt;These sieve scripts will be triggered whenever email gets moved in or out of your Junk folder. You will need to manually compile them, since Dovecot doesn't have write permission to this directory.&lt;/p&gt;
&lt;pre&gt;
cd /usr/local/etc/dovecot/sieve
sievec report-spam.sieve
sievec report-ham.sieve
&lt;/pre&gt;
&lt;p&gt;Now you need to create the shell scripts that the sieve scripts will execute. Create &lt;span class=&quot;monospace&quot;&gt;train-spam.sh&lt;/span&gt; and &lt;span class=&quot;monospace&quot;&gt;train-ham.sh&lt;/span&gt; in the same directory:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/sieve/train-spam.sh&lt;/p&gt;
&lt;pre&gt;
exec /usr/local/bin/rspamc -h /var/run/rspamd/rspamd.sock learn_spam
&lt;/pre&gt;
&lt;p&gt;/usr/local/etc/dovecot/sieve/train-ham.sh&lt;/p&gt;
&lt;pre&gt;
exec /usr/local/bin/rspamc -h /var/run/rspamd/rspamd.sock learn_ham
&lt;/pre&gt;
&lt;p&gt;Make sure they are executable.&lt;/p&gt;
&lt;pre&gt;
chmod +x /usr/local/etc/dovecot/sieve/train-{spam,ham}.sh
&lt;/pre&gt;
&lt;p&gt;Finally, we need to tell Dovecot to automatically move emails that rspamd tagged as spam to your Junk folder. We do this using a global filter on the &lt;span class=&quot;monospace&quot;&gt;X-SPAM&lt;/span&gt; header.&lt;/p&gt;
&lt;p&gt;/usr/local/etc/dovecot/sieve-before.d/10-rspamd.sieve&lt;/p&gt;
&lt;pre&gt;
require [&quot;fileinto&quot;];

if header :is &quot;X-Spam&quot; &quot;Yes&quot; {
  fileinto &quot;Junk&quot;;
}
&lt;/pre&gt;
&lt;p&gt;You'll need to pre-compile this script:&lt;/p&gt;
&lt;pre&gt;
cd /usr/local/etc/dovecot/sieve-before.d
sievec 10-rspamd.sieve
&lt;/pre&gt;
&lt;p&gt;Reload Dovecot for your changes to take effect.&lt;/p&gt;
&lt;pre&gt;
service dovecot reload
&lt;/pre&gt;
&lt;p&gt;Dovecot should now inform the rspamd daemon to retrain a messages as spam or ham when you move it in or out of your Junk folder. To test, move a message in and out of Junk from mail client, and check your mail and rspamd logs. You should a message in &lt;span class=&quot;monospace&quot;&gt;/var/log/rspamd/rspamd.log&lt;/span&gt; whenever a message is retrained.&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;78.114819890368&quot;&gt;&lt;h2 id=&quot;dkim&quot;&gt;DKIM: Validation for Your Outgoing Mail&lt;/h2&gt;
&lt;a href=&quot;http://www.dkim.org&quot;&gt;DKIM&lt;/a&gt;, or DomainKeys Identified Mail, is a standard by which mail servers can cryptographically verify that an email claiming to originate from a given domain did indeed originate from a server within that domain's control. The general idea is that the sender's mail server signs outgoing messages with a private key, and the recipient's mail server retrieves the public key from a TXT record hosted in the sender's DNS zone to verify the authenticity of the message. Using DKIM, a recipient can be certain that a message really did come from the sender's authorized mail server, and that it wasn't tampered with in transit.
&lt;p&gt;Luckily, rspamd provides &lt;a href=&quot;https://rspamd.com/doc/modules/dkim_signing.html&quot;&gt;built-in support for DKIM signing&lt;/a&gt; using the postfix milter we already configured in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#rspamd&quot;&gt;previous section&lt;/a&gt;. That means there's no additional software to configure! All you need to do is generate your private key, and create a DKIM record containing your public key in DNS.&lt;/p&gt;
&lt;p&gt;Recall the following file we created in the &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#rspamd&quot;&gt;rspamd section&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/rspamd/local.d/dkim_signing.conf&lt;/p&gt;
&lt;pre&gt;
path = &quot;/var/db/rspamd/dkim/$domain.$selector.key&quot;;
selector = &quot;dkim&quot;;
&lt;/pre&gt;
&lt;p&gt;The &lt;span class=&quot;monospace&quot;&gt;$domain&lt;/span&gt; variable does what you'd expect: an outgoing email from an &lt;span class=&quot;monospace&quot;&gt;@example.com&lt;/span&gt; email address will be signed using the corresponding &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt; private key file. The &lt;span class=&quot;monospace&quot;&gt;$selector&lt;/span&gt; variable bears further explanation: The DKIM specification allows you to use multiple keys for a single domain, and distinguish between them using a &lt;em&gt;selector&lt;/em&gt; value in the DKIM header of the message. In our case, we'll keep it simple and just use a single selector called &quot;dkim&quot; for everything.&lt;/p&gt;
&lt;p&gt;You can generate a DKIM keypair using the &lt;span class=&quot;monospace&quot;&gt;rspamadm&lt;/span&gt; command:&lt;/p&gt;
&lt;pre&gt;
rspamadm dkim_keygen -k /var/db/rspamd/dkim/example.com.dkim.key -b 2048 -s dkim -d example.com
&lt;/pre&gt;
&lt;p&gt;This will save a private key file for &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt; in rspamd's DKIM directory, and print a DNS record for the DKIM public key to standard output. You should see something like this:&lt;/p&gt;
&lt;pre&gt;
dkim._domainkey IN TXT ( &quot;v=DKIM1; k=rsa; &quot;
        &quot;p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzGdxkFW0tIDYdNrGyj/J2Hff7N/9BEWE2qxMw6PBW5FhJRullZT9WNZOVrrXk1TsiBHRq8YQrSS1TfLbNV9PE7sE0vGx0eLgkiqnqLMwTy5Y9+jEbiNrddNR6v+TGHuMckYJO3JMjiROhMi/86Lv6P/rv2R/lxFldCeYQxa41/8LH+b3ZXWTLYRM6y2/2UpGz/wtknvA+DtO0rn+Y&quot;
        &quot;uLuPrh+ftzmJb6i3g01XFgAO8ZzMLMdO/k7UJDX/Q6himKxVv2t3vSvS1MGqiWThXiU3WxhQED0zZUlkC5Lfx4BCo1h0v7fwZeMdu2NPOzlDBMDq5HRYgbwuFXTAmxSM7WRqQIDAQAB&quot;
) ;
&lt;/pre&gt;
&lt;p&gt;If you are running your own DNS server, you can just paste that directly into your zone file. If you are using a DNS provider's web interface, there's a small caveat: the 2048-bit public key is too large to fit in a single DNS record. In a zone file, the parenthetical syntax above causes your DNS server to split the key into separate records. When you add it to your provder's web interface, you'll need to create a TXT record at &lt;span class=&quot;monospace&quot;&gt;dkim._domainkey.example.com&lt;/span&gt; and generate the value by contatenating all three lines together (removing the quotes).&lt;/p&gt;
&lt;p&gt;You'll also want to tighten up the permissions on your private key file.&lt;/p&gt;
&lt;pre&gt;
chmod 640 /var/db/rspamd/dkim/example.com.dkim.key
&lt;/pre&gt;
&lt;p&gt;At this point, you should have both SPF and DKIM properly configured. However, you haven't informed other mail servers what to &lt;em&gt;do&lt;/em&gt; if either of those safeguards should fail. That's where &lt;a href=&quot;https://dmarc.org&quot;&gt;DMARC&lt;/a&gt; comes in. DMARC uses a special DNS record to declare how other mail servers should treat mail from your domain when validations fail.&lt;/p&gt;
&lt;p&gt;Create a TXT record at &lt;span class=&quot;monospace&quot;&gt;_dmarc.example.com&lt;/span&gt; like the following:&lt;/p&gt;
&lt;p&gt;/usr/local/etc/named/master/example.com.db&lt;/p&gt;
&lt;pre&gt;
_dmarc  IN  TXT  &quot;v=DMARC1; p=reject; adkim=r; aspf=r; sp=reject&quot;
&lt;/pre&gt;
&lt;p&gt;The &lt;span class=&quot;monospace&quot;&gt;p=reject&lt;/span&gt; field indicates that any emails from our domain which do not pass SPF and DKIM checks should be assumed to be spam and rejected. The &lt;span class=&quot;monospace&quot;&gt;adkim=r&lt;/span&gt; and &lt;span class=&quot;monospace&quot;&gt;aspf=r&lt;/span&gt; fields indicate that we are using &lt;span class=&quot;monospace&quot;&gt;relaxed&lt;/span&gt; validation, which is the default. Finally, the &lt;span class=&quot;monospace&quot;&gt;sp=reject&lt;/span&gt; field indicates that this policy should apply to all subdomains of &lt;span class=&quot;monospace&quot;&gt;example.com&lt;/span&gt;.&lt;/p&gt;
&lt;section readability=&quot;28.588824020017&quot;&gt;&lt;h3 id=&quot;testing-dkim&quot;&gt;Testing DKIM, DMARC, and SPF&lt;/h3&gt;
&lt;p&gt;Once your public key and DMARC records are in DNS, you're ready to test DKIM signing. You can check whether your records have propagated using &lt;span class=&quot;monospace&quot;&gt;dig&lt;/span&gt;:&lt;/p&gt;
&lt;pre&gt;
dig +short TXT dkim._domainkey.example.com

dig +short TXT _dmarc.example.com

&lt;/pre&gt;
&lt;p&gt;There are lots of online tools you can use to test whether or not DKIM signing is working for your domain. My favorite is &lt;a href=&quot;http://dkimvalidator.com&quot;&gt;DKIMValidator.com&lt;/a&gt;. The site provides you a randomized email address. Simply send a test email from your mail server to the provided email address, wait a few seconds, and hit &quot;View Results.&quot; You will be presented with a report describing whether or not DKIM and SPF validation passed for your domain.&lt;/p&gt;
&lt;p&gt;You can also test DKIM, DMARC, and SPF by sending a test email to a GMail account. In your GMail inbox, click the arrow next to the reply button and choose &quot;Show Original.&quot; You will be presented with a table containing pass/fail results for SPF, DKIM, and DMARC.&lt;/p&gt;
&lt;p&gt;If any of the validations fail, check the message headers for clues, as well as your rspamd and mail logs for errors. If they all passed, then congratulations‚Äîyour mail server is more professionally configured than half the mail I get from &quot;real&quot; companies.&lt;/p&gt;
&lt;/section&gt;&lt;/section&gt;&lt;section readability=&quot;71.155975252361&quot;&gt;&lt;h2 id=&quot;sieve&quot;&gt;Sieve: Scripting Your Mailbox&lt;/h2&gt;
&lt;p&gt;Once of the best things about running your own mail server is being able to script your inbox. Instead of creating filters using a kludgy synax through a web interface, you can literally write programs to determine how to sort your mail. With sieve, regular expressions, if/else control structures, and full message metadata (including headers) are at your disposal.&lt;/p&gt;
&lt;p&gt;Recall in &lt;a href=&quot;https://www.c0ffee.net/blog/mail-server-guide#dovecot&quot;&gt;the Dovecot section&lt;/a&gt; that sieve scripts live in the &lt;em&gt;virtual home directory&lt;/em&gt; of each IMAP user. Dovecot's sieve functionality allows a user to have multiple sieve scripts stored on the server, but only one of them can be &quot;active&quot; at any given time. In our configuration, the active sieve script for the user &lt;span class=&quot;monospace&quot;&gt;alphonsus&lt;/span&gt; would be located at &lt;span class=&quot;monospace&quot;&gt;/var/mail/vhosts/example.com/alphonsus/.dovecot.sieve&lt;/span&gt;. The &lt;span class=&quot;monospace&quot;&gt;.dovecot.sieve&lt;/span&gt; file should be a symlink to a script in the &lt;span class=&quot;monospace&quot;&gt;sieve&lt;/span&gt; directory:&lt;/p&gt;
&lt;pre&gt;
&lt;strong&gt;root@awesomebox:/var/mail/vhosts/example.com/alphonsus # ls -l&lt;/strong&gt;
total 12
lrwxr-xr-x  1 vmail  vmail   18 Mar  4 07:35 .dovecot.sieve@ -&amp;gt; sieve/my_cool_script.sieve
-rw-rw-r--  1 vmail  vmail  472 Mar  4 07:38 .dovecot.svbin
drwx------  4 vmail  vmail  512 Aug 15 04:45 mdbox/
drwxrwxr-x  2 vmail  vmail  512 Mar  4 07:35 sieve/
&lt;/pre&gt;
&lt;p&gt;If you use a mail client with ManageSieve support (like KMail), these details are handled for you automatically. You can also use &lt;a href=&quot;https://github.com/philpennock/sieve-connect&quot;&gt;sieve-connect&lt;/a&gt;, a command-line ManageSieve client. I rarely modify my sieve script, so when I need to make a change I just SSH to my server and edit it in &lt;span class=&quot;monospace&quot;&gt;vim&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Let's make a basic sieve script. Open up a root shell and navigate to your IMAP user's virtual home directory under &lt;span class=&quot;monospace&quot;&gt;/var/mail/vhosts&lt;/span&gt;.&lt;/p&gt;
&lt;pre&gt;
cd /var/mail/vhosts/example.com/user
&lt;/pre&gt;
&lt;p&gt;Create the &lt;span class=&quot;monospace&quot;&gt;sieve&lt;/span&gt; directory if it doesn't already exist:&lt;/p&gt;
&lt;pre&gt;
mkdir sieve
&lt;/pre&gt;
&lt;p&gt;Then, create a sieve script. You can name this file whatever you like:&lt;/p&gt;
&lt;pre&gt;
vim sieve/my_awesome_script.sieve
&lt;/pre&gt;
&lt;p&gt;Now you're ready to write your script. You can check out some example sieve scripts on the Dovecot wiki &lt;a href=&quot;https://wiki2.dovecot.org/Pigeonhole/Sieve/Examples&quot;&gt;here&lt;/a&gt;. We'll keep it simple for now.&lt;/p&gt;
&lt;p&gt;/var/mail/vhosts/example.com/user/sieve/my_awesome_script.sieve&lt;/p&gt;
&lt;pre&gt;
require [&quot;regex&quot;, &quot;fileinto&quot;, &quot;imap4flags&quot;];


if allof (address :is &quot;from&quot; &quot;root@awesomebox.example.com&quot;, header :contains &quot;subject&quot; &quot;run output&quot;) {
    fileinto &quot;Logs&quot;;
    stop;
}


if anyof (address :is         &quot;from&quot; &quot;auto-confirm@amazon.com&quot;,
          address :is :domain &quot;from&quot; &quot;earthfare.com&quot;) {
   fileinto &quot;Shopping&quot;;
   stop;
}
&lt;/pre&gt;
&lt;p&gt;I don't believe the sieve script will create any new IMAP folders for you, so be sure to create any folders you need in your mail client first. Now you need to create a symlink so Dovecot knows that this is your &quot;active&quot; script:&lt;/p&gt;
&lt;pre&gt;
ln -s sieve/my_awesome_script.sieve .dovecot.sieve
&lt;/pre&gt;
&lt;p&gt;Make sure your script actually compiles:&lt;/p&gt;
&lt;pre&gt;
sievec .dovecot.sieve
&lt;/pre&gt;
&lt;p&gt;Finally, make sure everything is still owned by the &lt;span class=&quot;monospace&quot;&gt;vmail&lt;/span&gt; user:&lt;/p&gt;
&lt;pre&gt;
chown -R vmail:vmail .dovecot.sieve .dovecot.svbin sieve
&lt;/pre&gt;
&lt;p&gt;Check your mail log the next time you receive an email to verify that Dovecot didn't have any trouble executing your script. You can get as convoluted as you want with sieve‚ÄîI've seen some cool setups where people call external shell scripts when certain emails are receieved.&lt;/p&gt;
&lt;/section&gt;&lt;section readability=&quot;44.978345363687&quot;&gt;&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;If you made it this far, you should have a pretty decent personal email server. I've been hosting my family's email on a VPS with this setup for a year or so with great results. I've yet to have a spammer make it past rspamd, and sync and search work great with all of our iDevices. Also, despite the warnings of various online naysayers, I've never had an issue with others not receieving my mail, and tech recruiters, for better or worse, seem to have no trouble reaching my inbox.&lt;/p&gt;
&lt;p&gt;One thing I didn't cover in this guide was a webmail setup‚Äîmostly because I've never felt the need for one. Mutt, Mail.app, and the iOS mail client have served me quite well, and I honestly hate dealing with the additional attack vector of some PHP/Ruby-off-the-Rails web application. However, if that's something you need, I have heard good things about &lt;a href=&quot;https://roundcube.net&quot;&gt;Roundcube&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also, and I can't stress this enough, &lt;strong&gt;back up your mail directory regularly!!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;No doubt, it's a lot of work to get a mail server up and running. But once you get it working, it's very set-and-forget. Just keep your system updated, rotate your SSL certificates before they expire, and use good DevOps practices, and it will serve you well as long as you keep paying your hosting provider.&lt;/p&gt;
&lt;p&gt;I'm sure many will argue that this is too much work for too little gain, because the NSA can probably crack all our encryption, most mail goes through GMail anyway, tons of email is still plain text, etc. However, my &lt;a href=&quot;https://www.c0ffee.net/blog/self-hosting-guide&quot;&gt;reasons for self-hosting things&lt;/a&gt; are more philosophical than technical. The net neutrality debate is moot if all of our online communication is controlled by a handful of monolothic advertising companies. The internet's greatest strength has always been in the free exchange of ideas and information. Let's make sure it stays that way.&lt;/p&gt;
&lt;/section&gt;&lt;/body&gt;</description>
<pubDate>Fri, 26 Jan 2018 13:29:18 +0000</pubDate>
<dc:creator>j_s</dc:creator>
<dc:language>en-US</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.c0ffee.net/blog/mail-server-guide</dc:identifier>
</item>
</channel>
</rss>