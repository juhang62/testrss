<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="css/feed.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:media="http://search.yahoo.com/mrss/" xmlns:og="http://ogp.me/ns#">
<channel>
<atom:link rel="self" href="http://192.168.1.4/fivefilters/makefulltextfeed.php?url=hnrss.org%2Fnewest%3Fpoints%3D200&amp;max=10&amp;links=preserve&amp;exc=" />
<atom:link rel="alternate" title="Source URL" href="http://hnrss.org/newest?points=200" />
<atom:link rel="related" title="Subscribe to feed" href="http://www.subtome.com/#/subscribe?feeds=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D&amp;back=http%3A%2F%2F192.168.1.4%2Ffivefilters%2Fmakefulltextfeed.php%3Furl%3Dhnrss.org%252Fnewest%253Fpoints%253D200%26max%3D10%26links%3Dpreserve%26exc%3D" />
<title>Hacker News: Newest</title>
<link>https://news.ycombinator.com/newest</link>
<description>Hacker News RSS</description>
<item>
<title>81% of &amp;#039;suspects&amp;#039; flagged by Met&amp;#039;s police facial recognition technology innocent</title>
<link>https://news.sky.com/story/met-polices-facial-recognition-tech-has-81-error-rate-independent-report-says-11755941</link>
<guid isPermaLink="true" >https://news.sky.com/story/met-polices-facial-recognition-tech-has-81-error-rate-independent-report-says-11755941</guid>
<description>&lt;p&gt;Four out of five people identified by the Metropolitan Police's facial recognition technology as possible suspects are innocent, according to an independent report.&lt;/p&gt;
&lt;p&gt;Researchers found that the controversial system is 81% inaccurate - meaning that, in the vast majority of cases, it flagged up faces to police when they were not on a wanted list.&lt;/p&gt;

&lt;p&gt;The force maintains its technology only makes a mistake in one in 1,000 cases - but it uses a different measurement to arrive at this conclusion.&lt;/p&gt;
&lt;p&gt;The report, exclusively revealed by Sky News and The Guardian, raises &quot;significant concerns&quot; about Scotland Yard's use of the technology, and calls for the facial recognition programme to be halted.&lt;/p&gt;
&lt;p&gt;Citing a range of technical, operational and legal issues, the report concludes that it is &quot;highly possible&quot; the Met's usage of the system would be found unlawful if challenged in court.&lt;/p&gt;
&lt;div class=&quot;sdc-site-au site-component-vertical-margin&quot; data-ad-format=&quot;mpu-1&quot; data-type=&quot;&quot; aria-hidden=&quot;true&quot;&gt;

&lt;p&gt;&lt;span class=&quot;sdc-site-au__label-text&quot; data-label-text=&quot;Advertisement&quot;&gt;Advertisement&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-image&quot;&gt;
&lt;div class=&quot;sdc-article-image__wrapper&quot; data-aspect-ratio=&quot;16/9&quot;&gt;&lt;img class=&quot;sdc-article-image__item&quot; src=&quot;https://e3.365dm.com/19/07/768x432/skynews-police-london-met-mps_4708870.jpg?20190703132039&quot; srcset=&quot;https://e3.365dm.com/19/07/384x216/skynews-police-london-met-mps_4708870.jpg?20190703132039 380w, https://e3.365dm.com/19/07/768x432/skynews-police-london-met-mps_4708870.jpg?20190703132039 760w, https://e3.365dm.com/19/07/1600x900/skynews-police-london-met-mps_4708870.jpg?20190703132039 1024w, https://e3.365dm.com/19/07/2048x1152/skynews-police-london-met-mps_4708870.jpg?20190703132039 2048w&quot; sizes=&quot;(min-width: 1024px) 1024px, 100vw&quot; alt=&quot;LONDON, ENGLAND - MARCH 24: Police officers patrol on Westminster Bridge on March 24, 2017 in London, England. A fourth person has died after Khalid Masood drove a car into pedestrians on Westminster Bridge before going on to fatally stab PC Keith Palmer on March 22. (Photo by Carl Court/Getty Images) &quot;/&gt;&lt;/div&gt;
&lt;span class=&quot;sdc-article-image__visually-hidden&quot;&gt;Image:&lt;/span&gt; &lt;span class=&quot;sdc-article-image__caption-text&quot;&gt;An independent report calls for Scotland Yard to halt its use of facial recognition technology&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;The Met has been monitoring crowds with live facial recognition (LFR) since August 2016, when it used the technology at Notting Hill Carnival.&lt;/p&gt;
&lt;p&gt;Since then, it has conducted 10 trials at locations including Leicester Square, Westfield Stratford, and Whitehall during the 2017 Remembrance Sunday commemorations.&lt;/p&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-related-stories&quot; data-component-name=&quot;sdc-article-related-stories&quot;&gt;
&lt;div class=&quot;sdc-article-related-stories__content&quot;&gt;
&lt;h3 class=&quot;sdc-article-related-stories__title&quot;&gt;More from London&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The first independent evaluation of the scheme was commissioned by Scotland Yard and conducted by academics from the University of Essex.&lt;/p&gt;
&lt;p&gt;Professor Pete Fussey and Dr Daragh Murray evaluated the technology's accuracy at six of the 10 police trials. They found that, of 42 matches, only eight were verified as correct - an error rate of 81%. Four of the 42 were people who were never found because they were absorbed into the crowd, so a match could not be verified.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;:: Listen to the New Lines podcast on &lt;a href=&quot;https://podcasts.apple.com/gb/podcast/computer-says-no-predictive-algorithms-that-are-changing/id1451058509?i=1000430856156&quot; target=&quot;_blank&quot;&gt;Apple podcasts&lt;/a&gt;, &lt;a href=&quot;https://podcasts.google.com/?feed=aHR0cHM6Ly93d3cuc3ByZWFrZXIuY29tL3Nob3cvMzI4NzI3NS9lcGlzb2Rlcy9mZWVk&amp;amp;episode=aHR0cHM6Ly9hcGkuc3ByZWFrZXIuY29tL2VwaXNvZGUvMTcxODEwNTQ%3D&quot; target=&quot;_blank&quot;&gt;Google Podcasts&lt;/a&gt;, &lt;a href=&quot;https://open.spotify.com/episode/6oWDFA2yqMXZcVFP55rHP0&quot; target=&quot;_blank&quot;&gt;Spotify&lt;/a&gt;, &lt;a href=&quot;https://www.spreaker.com/user/skynews/computer-says-no-the-predictive-algorith&quot; target=&quot;_blank&quot;&gt;Spreaker&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The Met prefers to measure accuracy by comparing successful and unsuccessful matches with the total number of faces processed by the facial recognition system. According to this metric, the error rate was just 0.1%.&lt;/p&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-video callfn&quot; data-component-name=&quot;sdc-article-video&quot; data-provider=&quot;ooyala&quot; data-video-blacklisted-originator-ids=&quot;&quot; data-video-id=&quot;4709022&quot; data-sdc-video-id=&quot;MwMDA0aTE6ZMTFne7M6XZgPEZUvL8Ya4&quot; data-package=&quot;&quot; data-originator-id=&quot;&quot; data-fn=&quot;sdc-article-video&quot; data-lite=&quot;true&quot; data-role=&quot;roadblock-success&quot; data-clip-type=&quot;&quot; data-competition=&quot;&quot; data-sport-category=&quot;&quot;&gt;
&lt;div class=&quot;sdc-article-video__inner&quot;&gt;&lt;span class=&quot;sdc-article-video__media-container&quot;&gt;&lt;span class=&quot;sdc-article-video__preload-poster&quot; data-role=&quot;preload-poster&quot;&gt;&lt;img class=&quot;sdc-article-video__media&quot; src=&quot;https://e3.365dm.com/19/07/768x432/skynews-nick-hurd-policing_4709035.jpg?20190703161531&quot; srcset=&quot;https://e3.365dm.com/19/07/384x216/skynews-nick-hurd-policing_4709035.jpg?20190703161531 380w, https://e3.365dm.com/19/07/768x432/skynews-nick-hurd-policing_4709035.jpg?20190703161531 760w, https://e3.365dm.com/19/07/1600x900/skynews-nick-hurd-policing_4709035.jpg?20190703161531 1024w, https://e3.365dm.com/19/07/2048x1152/skynews-nick-hurd-policing_4709035.jpg?20190703161531 2048w&quot; sizes=&quot;(min-width: 1024px) 1024px, 100vw&quot; alt=&quot;Policing minister delivers incorrect figures to parliament&quot;/&gt;&lt;span class=&quot;sdc-article-video__media-icon&quot;&gt;&lt;span class=&quot;sdc-article-video__media-icon-body&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;sdc-article-video__caption-text&quot; data-role=&quot;caption-text&quot;&gt;Policing minister tells incorrect figures to parliament&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Duncan Ball, the Met's deputy assistant commissioner, said: &quot;We are extremely disappointed with the negative and unbalanced tone of this report... We have a legal basis for this pilot period and have taken legal advice throughout.&lt;/p&gt;
&lt;p&gt;&quot;We believe the public would absolutely expect us to try innovative methods of crime fighting in order to make London safer.&quot;&lt;/p&gt;
&lt;p&gt;Professor Fussey and Dr Murray claimed the Met's use of facial recognition during these trials lacked &quot;an explicit legal basis&quot; and failed to take into account how this technology infringed fundamental human rights.&lt;/p&gt;
&lt;p&gt;&quot;Our report conducted a detailed, academic, legal analysis of the documentation the Met Police used as a basis for the face recognition trials,&quot; Professor Fussey told Sky News. &quot;There are some shortcomings and if [the Met] was taken to court there is a good chance that would be successfully challenged.&quot;&lt;/p&gt;
&lt;p&gt;The co-authors also found &quot;significant&quot; operational problems - with obtaining the consent of those affected a particular issue.&lt;/p&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-strapline sdc-article-strapline--default-layout&quot; data-component-name=&quot;sdc-article-strapline&quot;&gt;
&lt;div class=&quot;sdc-article-strapline__image-wrap&quot;&gt;&lt;img src=&quot;https://e3.365dm.com/17/08/512x512/a186da049b931eb042710f39c5319dea4b8df95223fe74987a99865b358f92f9_4080662.jpg&quot; alt=&quot;Are police illegally using facial recognition technology?&quot; class=&quot;sdc-article-strapline__image&quot;/&gt;&lt;/div&gt;
&lt;div class=&quot;sdc-article-strapline__body&quot;&gt;
&lt;h3 class=&quot;sdc-article-strapline__title&quot;&gt;Are police illegally using facial recognition technology?&lt;/h3&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;When live facial recognition is used in public places, everyone who comes within range of the cameras is considered to be under overt surveillance.&lt;/p&gt;
&lt;p&gt;The Met did make an effort to notify passers-by about their trials by putting out signs and tweeting about the event.&lt;/p&gt;
&lt;p&gt;But the researchers observed &quot;significant shortcomings&quot; in this process - and said this created difficulty in gaining meaningful consent.&lt;/p&gt;
&lt;p&gt;A recent BBC documentary captured an incident where a man was fined after refusing to take part in a facial recognition trial.&lt;/p&gt;
&lt;p&gt;Professor Fussey and Dr Murray wrote: &quot;Treating LFR camera avoidance as suspicious behaviour undermines the premise of informed consent.&lt;/p&gt;
&lt;p&gt;&quot;The arrest of LFR camera-avoiding individuals for more minor offences than those used to justify the test deployments raise clear issues regarding the extension of police powers and of 'surveillance creep'.&quot;&lt;/p&gt;
&lt;p&gt;Their report also criticised the Met's use of &quot;watch lists&quot; - the registers of &quot;wanted&quot; people that facial recognition is supposed to help locate.&lt;/p&gt;
&lt;p&gt;According to the report, the data used to create watch lists was not current, so people were stopped even though their case had already been addressed. In other cases, there were no clear reasons why people were put on watch lists, leaving &quot;significant ambiguity&quot; about the intended purpose of facial recognition.&lt;/p&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-image&quot;&gt;
&lt;div class=&quot;sdc-article-image__wrapper&quot; data-aspect-ratio=&quot;16/9&quot;&gt;&lt;img class=&quot;sdc-article-image__item&quot; src=&quot;https://e3.365dm.com/19/07/768x432/skynews-rowland-manthorpe-facial_4708857.jpg?20190703130859&quot; srcset=&quot;https://e3.365dm.com/19/07/384x216/skynews-rowland-manthorpe-facial_4708857.jpg?20190703130859 380w, https://e3.365dm.com/19/07/768x432/skynews-rowland-manthorpe-facial_4708857.jpg?20190703130859 760w, https://e3.365dm.com/19/07/1600x900/skynews-rowland-manthorpe-facial_4708857.jpg?20190703130859 1024w, https://e3.365dm.com/19/07/2048x1152/skynews-rowland-manthorpe-facial_4708857.jpg?20190703130859 2048w&quot; sizes=&quot;(min-width: 1024px) 1024px, 100vw&quot; alt=&quot;Facial recognition systems can see through some disguises&quot;/&gt;&lt;/div&gt;
&lt;span class=&quot;sdc-article-image__visually-hidden&quot;&gt;Image:&lt;/span&gt; &lt;span class=&quot;sdc-article-image__caption-text&quot;&gt;Facial recognition systems can see through some disguises&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;Earlier this year, the Met's senior technologist Johanna Morley told Sky News that &lt;strong&gt;&lt;a href=&quot;https://news.sky.com/story/met-police-need-huge-it-upgrade-to-ensure-legal-facial-recognition-11732082&quot; target=&quot;_blank&quot;&gt;huge investment would be needed&lt;/a&gt;&lt;/strong&gt; to upgrade police IT systems in order to ensure that the people on these watch lists were there legally.&lt;/p&gt;
&lt;p&gt;The Met's use of facial recognition is being challenged in court by Big Brother Watch, an anti-surveillance campaign group.&lt;/p&gt;
&lt;p&gt;The group's director, Silkie Carlo, told Sky News: &quot;(This report) is absolutely definitive and I think there is really no recovery from this point.&lt;/p&gt;
&lt;p&gt;&quot;The only question now is when is the Met finally going to commit to stop using facial recognition.&quot;&lt;/p&gt;
&lt;p&gt;The Home Office defended the Met, telling Sky News: &quot;We support the police as they trial new technologies to protect the public, including facial recognition, which can help them identity criminals.&lt;/p&gt;
&lt;p&gt;&quot;The government believes that there is a legal framework for the use of live facial recognition technology, although that is being challenged in the courts and we would not want to pre-empt the outcome of this case.&quot;&lt;/p&gt;
&lt;div class=&quot;sdc-article-widget sdc-article-image&quot;&gt;
&lt;div class=&quot;sdc-article-image__wrapper&quot; data-aspect-ratio=&quot;16/9&quot;&gt;&lt;img class=&quot;sdc-article-image__item&quot; src=&quot;https://e3.365dm.com/19/07/768x432/skynews-silkie-carlo-big-brother_4708856.jpg?20190703130643&quot; srcset=&quot;https://e3.365dm.com/19/07/384x216/skynews-silkie-carlo-big-brother_4708856.jpg?20190703130643 380w, https://e3.365dm.com/19/07/768x432/skynews-silkie-carlo-big-brother_4708856.jpg?20190703130643 760w, https://e3.365dm.com/19/07/1600x900/skynews-silkie-carlo-big-brother_4708856.jpg?20190703130643 1024w, https://e3.365dm.com/19/07/2048x1152/skynews-silkie-carlo-big-brother_4708856.jpg?20190703130643 2048w&quot; sizes=&quot;(min-width: 1024px) 1024px, 100vw&quot; alt=&quot;Silkie Carlo&quot;/&gt;&lt;/div&gt;
&lt;span class=&quot;sdc-article-image__visually-hidden&quot;&gt;Image:&lt;/span&gt; &lt;span class=&quot;sdc-article-image__caption-text&quot;&gt;Silkie Carlo told Sky News that there was 'no recovery' for the police's programme&lt;/span&gt;&lt;/div&gt;
&lt;p&gt;The first court case against police use of facial recognition began in May in Cardiff.&lt;/p&gt;
&lt;p&gt;Human rights group Liberty is bringing &lt;strong&gt;&lt;a href=&quot;https://news.sky.com/story/facial-recognition-technology-who-watches-the-watchers-11725536&quot; target=&quot;_blank&quot;&gt;a judicial challenge&lt;/a&gt;&lt;/strong&gt; against South Wales Police, which is undertaking a Home Office-funded programme of live facial recognition.&lt;/p&gt;
&lt;p&gt;According to Liberty, the force will use facial recognition at the Wales National Airshow this Saturday in Swansea. In 2016, an estimated 200,000 people attended the event.&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 18:13:27 +0000</pubDate>
<dc:creator>howard941</dc:creator>
<og:title>81% of 'suspects' flagged by Met's police facial recognition technology innocent, independent report says</og:title>
<og:description>The force maintains its technology only makes a mistake in one in 1,000 cases, but it uses a different metric for gauging success.</og:description>
<og:url>https://news.sky.com/story/met-polices-facial-recognition-tech-has-81-error-rate-independent-report-says-11755941</og:url>
<og:type>article</og:type>
<og:image>https://e3.365dm.com/19/07/1600x900/skynews-facial-recognition_4709130.jpg?20190703181850</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://news.sky.com/story/met-polices-facial-recognition-tech-has-81-error-rate-independent-report-says-11755941</dc:identifier>
</item>
<item>
<title>How the Dat Protocol Works</title>
<link>https://datprotocol.github.io/how-dat-works/</link>
<guid isPermaLink="true" >https://datprotocol.github.io/how-dat-works/</guid>
<description>&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;/&gt;&lt;title&gt;How Dat Works&lt;/title&gt;&lt;link rel=&quot;icon&quot; href=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAdhwAAHYcBj+XxZQAAAL1QTFRFKspLKT1IKY9KKrBLKTtIKnFJKsNLKTZIKUJIKr5LKsVLKWxJKVBIKbJKKZJKKk5JKUVJKVdJKshLKTdIKsZLKqdKKp1KKUVIKrhKKZ5KKT9IKpRKKWdJKqRLKsBLKTpIKqlKKqpLKWtJKrtKKXlJKUtJKnhJKr1LKpdKKW9JKaxLKT1JKrtLKpBKKV5JKThIKWRJKWFJKrVLKUBIKq1KKqpKKVJIKmJJKUNJKXJKKr1KKbpLKU5IKTxIKslLaAjFnAAAAMFJREFUOMvt0scSgjAQBuAfRBZFESvYe++9+/6PZeLIqGMSbp7c4+ZL2d2AQgK/BkanmQMaLhl6WROAVhss9DqlIkAyIb/CNjmMR6UAz/gA2Uq1FqRFoFTEKy0ARh5qoEMN0pkQUIAauOyAfq9rSMscAr6natQUmJE1eKQxSdNXqzfI03wUHJxjOzXHeR+WjyPZfC2yHAvHbeLyKGS1lvyHG650ZiBK+9hCBHhBcQZ2tIUnA/wJBzohqwIWxUB/IAR3R/0bogFXueAAAAAASUVORK5CYII=&quot;/&gt;&lt;/head&gt;&lt;body id=&quot;readabilityBody&quot; readability=&quot;324.29276659697&quot;&gt;
&lt;header&gt;
&lt;nav&gt;&lt;a href=&quot;https://datproject.org&quot;&gt;&lt;span&gt;Dat Homepage&lt;/span&gt;&lt;/a&gt; &lt;a href=&quot;https://github.com/datprotocol/how-dat-works&quot;&gt;&lt;span&gt;Repo&lt;/span&gt;&lt;/a&gt;&lt;/nav&gt;&lt;/header&gt;
&lt;p&gt;v1 • January 2019&lt;/p&gt;
&lt;p id=&quot;introduction&quot;&gt;&lt;strong&gt;Dat is a protocol for sharing data between computers.&lt;/strong&gt; Dat’s strengths are that data is hosted and distributed by many computers on the network, that it can work offline or with poor connectivity, that the original uploader can add or modify data while keeping a full history and that it can handle large amounts of data.&lt;/p&gt;
&lt;div readability=&quot;22&quot;&gt;
&lt;p&gt;Dat is compelling because the people working on it have a dedication to user experience and ease-of-use. The software around Dat brings publishing within reach for people with a wide range of skills, not just technical. Although first designed with scientific data in mind, the Dat community is testing the waters and has begun to use it for websites, art, music releases, peer-to-peer chat programs and many other experiments.&lt;/p&gt;
&lt;p&gt;This guide is an in-depth tour through the bits and bytes of the Dat protocol, starting from a blank slate and ending with being able to download and share files with other peers running Dat. There will be enough detail for readers who are considering writing their own implementation of Dat, but if you are just curious how it works or want to learn from Dat’s design then I hope you will find this guide useful too!&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;basealign&quot;&gt;&lt;h2&gt;More documentation about Dat&lt;/h2&gt;
&lt;/aside&gt;
&lt;p&gt;To fetch a file in Dat you need to know its URL. Here is an example:&lt;/p&gt;
&lt;p&gt;dat://778f8d955175c92e4ced5e4f5563f69bfec0c86cc6f670352c457943666fe639/dat_intro.gif protocolidentifier ed25519 public key(hexadecimal) optional suffixpath to data within Dat&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Protocol identifier.&lt;/strong&gt; Makes Dat URLs easily recognizable. Dat-capable applications can register with the operating system to handle &lt;code&gt;dat://&lt;/code&gt; links, like &lt;a href=&quot;https://beakerbrowser.com/&quot;&gt;Beaker&lt;/a&gt; does. In Dat-specific applications the protocol identifier can be left off.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Public key.&lt;/strong&gt; An &lt;a href=&quot;https://ed25519.cr.yp.to/&quot;&gt;ed25519 public key&lt;/a&gt; unique to this Dat, used by the author to create and update data within it. The public key enables you to discover other peers who have the data and verify that the data was not corrupted or tampered with as it passed through the network.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Suffix.&lt;/strong&gt; Identifies specific data within this Dat. For most Dats which contain a directory of files, the suffix is a slash-separated file path. Dats can also contain data in structures that don’t use the concept of files or directories, in which case the suffix would use some other format as understood by the applications that handle that sort of data.&lt;/li&gt;
&lt;/ul&gt;&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;
&lt;p&gt;Dat clients use several different methods for discovering peers who they can download data from. Each discovery method has strengths and weaknesses, but combined they form a reasonably robust way of finding peers.&lt;/p&gt;
&lt;h2 id=&quot;discovery-keys&quot;&gt;Discovery keys&lt;/h2&gt;
&lt;div readability=&quot;13&quot;&gt;
&lt;p&gt;Discovery keys are used for finding other peers who are interested in the same Dat as you.&lt;/p&gt;
&lt;p&gt;If you know a Dat’s public key then you can calculate the discovery key easily, however if you only know a discovery key you cannot work backwards to find the corresponding public key. This prevents eavesdroppers learning of Dat URLs (and therefore being able to read their contents) by observing network traffic.&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;However eavesdroppers can confirm that peers are talking about a specific Dat and read all communications between those peers if they know its public key already. Eavesdroppers who do not know the public key can still get an idea of how many Dats are popular on the network, their approximate sizes, which IP addresses are interested in them and potentially the IP address of the creator by observing handshakes, traffic timing and volumes. Dat makes no attempt to hide IP addresses.&lt;/p&gt;
&lt;p&gt;Calculate a Dat’s discovery key using the &lt;a href=&quot;https://blake2.net/&quot;&gt;BLAKE2b&lt;/a&gt; hashing function, keyed with the public key (as 32 bytes, not 64 hexadecimal characters), to hash the word “hypercore”:&lt;/p&gt;
&lt;aside class=&quot;basealign&quot;&gt;Dat uses the BLAKE2b variant that accepts both a key and input to be hashed, returning 256 bits (32 bytes) of output.&lt;/aside&gt;&lt;p&gt;&lt;img id=&quot;blake2b&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/blake2b.png&quot; width=&quot;704&quot; height=&quot;465&quot;/&gt;&lt;/p&gt;
&lt;aside readability=&quot;3&quot;&gt;&lt;h3&gt;Byte notation&lt;/h3&gt;
&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/notation_byte.png&quot; width=&quot;336&quot; height=&quot;40&quot;/&gt;&lt;p&gt;Throughout this guide bytes are shown as a number inside a square. The number is always in decimal (base‑10) and can range from 0 to 255.&lt;/p&gt;
&lt;/aside&gt;&lt;h2 id=&quot;local-network-discovery&quot;&gt;Local network discovery&lt;/h2&gt;
&lt;div readability=&quot;6.7552447552448&quot;&gt;
&lt;p&gt;Peers broadcast which Dats they are interested in via their local network.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Strengths.&lt;/strong&gt; Fast, finds physically nearby peers, doesn’t need special infrastructure, works offline.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Weaknesses.&lt;/strong&gt; Limited reach.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deployment status.&lt;/strong&gt; Currently in use, will be replaced by &lt;a href=&quot;https://pfrazee.hashbase.io/blog/hyperswarm&quot;&gt;Hyperswarm&lt;/a&gt; in the future.&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;Local network discovery uses multicast DNS, which is like a regular DNS query except instead of sending queries to a nameserver they are broadcast to the local network with the hope that someone else on the network sees it and responds.&lt;/p&gt;
&lt;p&gt;Client asking for peers &lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/mdns_request.png&quot; width=&quot;1072&quot; height=&quot;420&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Multicast DNS packets are sent to the special broadcast MAC and IP addresses shown above. Both the source and destination ports are 5353.&lt;/p&gt;
&lt;p&gt;Essentially the computer is asking “Does anybody have any TXT records for the domain name &lt;em&gt;25a78aa81615847eba00995df29dd41d7ee30f3b.dat.local&lt;/em&gt;?” Other Dat clients on the network will recognize requests following this pattern and know that the client who sent it is looking for peers.&lt;/p&gt;
&lt;p&gt;Peer reporting that they are also interested in this Dat &lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/mdns_response.png&quot; width=&quot;1072&quot; height=&quot;920&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;mdns-peers-record&quot;&gt;Responses contain two TXT records:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;The &lt;strong&gt;token&lt;/strong&gt; record is a random value that makes it easier for clients to avoid connecting to themselves. If a client sees a response with the same token as a response they just sent out, they will know it came from them and ignore it.&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;peers&lt;/strong&gt; record is a base64-encoded list of IP addresses and ports of peers interested in this Dat:&lt;/li&gt;
&lt;/ul&gt;&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;div readability=&quot;9&quot;&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/mdns_peers_record.png&quot; width=&quot;704&quot; height=&quot;290&quot;/&gt;&lt;p&gt;The special IP address 0.0.0.0 means “use the address this mDNS response came from”. When discovering peers on the local network all mDNS responses will contain only one peer and will use the 0.0.0.0 address.&lt;/p&gt;
&lt;/div&gt;
&lt;aside readability=&quot;15&quot;&gt;&lt;p&gt;Base64 encoding in Dat uses the variant with plus &lt;code&gt;+&lt;/code&gt; and slash &lt;code&gt;/&lt;/code&gt; characters. Padding equals &lt;code&gt;=&lt;/code&gt; characters are required.&lt;/p&gt;
&lt;p&gt;Only IPv4 addresses are supported by this discovery mechanism.&lt;/p&gt;
&lt;h3&gt;Multi-byte numbers&lt;/h3&gt;
&lt;p&gt;Port numbers go from 0 to 65,535 which is larger than can fit inside a single byte, so in this case two bytes are used.&lt;/p&gt;
&lt;p&gt;The first byte is how many 256’s there are and the second byte is how many ones there are:&lt;/p&gt;
&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/notation_multi_byte_number.png&quot; width=&quot;336&quot; height=&quot;60&quot;/&gt;&lt;p&gt;In the Dat protocol multi-byte numbers are big-endian meaning the most significant byte comes first.&lt;/p&gt;
&lt;/aside&gt;&lt;h2 id=&quot;centralized-dns-discovery&quot;&gt;Centralized DNS discovery&lt;/h2&gt;
&lt;p&gt;Peers ask a server on the internet for other peers using a DNS-based protocol.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Strengths.&lt;/strong&gt; Fast, global reach.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Weaknesses.&lt;/strong&gt; Must be online, centralized point of failure, one server sees everyone’s metadata.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deployment status.&lt;/strong&gt; Currently in use, will be replaced by &lt;a href=&quot;https://pfrazee.hashbase.io/blog/hyperswarm&quot;&gt;Hyperswarm&lt;/a&gt; in the future.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Currently the server running this is &lt;strong&gt;discovery1.datprotocol.com&lt;/strong&gt;. If that goes offline then &lt;strong&gt;discovery2.datprotocol.com&lt;/strong&gt; can be used as a fallback.&lt;/p&gt;
&lt;p&gt;Here is a typical message flow between a Dat peer and the DNS discovery server:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/centralized_dns_conversation.png&quot; width=&quot;1072&quot; height=&quot;1170&quot;/&gt;&lt;/p&gt;
&lt;p&gt;To stay subscribed, peers should re-announce themselves every 60 seconds. The discovery server will also cycle its tokens periodically so peers should remember the token they last received and update it when they receive a new one.&lt;/p&gt;
&lt;p id=&quot;centralized-dns-peers-record&quot;&gt;The &lt;em&gt;peers&lt;/em&gt; record returned by the discovery server uses the same structure as in mDNS:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/mdns_peers_record_multi.png&quot; width=&quot;704&quot; height=&quot;520&quot;/&gt;&lt;/p&gt;
&lt;aside&gt;In this case the server sent back a list of five peers. DNS TXT records are limited to 255 characters so the server is limited to sending back 31 peers at a time. If the server knows more than this it will have to choose which to send, for example the most recent, longest lived or by picking at random.&lt;/aside&gt;&lt;p&gt;Following are three examples showing how these DNS requests appear as bytes sent over the network:&lt;/p&gt;
&lt;p&gt;Peer announce request to discovery server &lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/centralized_dns_request.png&quot; width=&quot;1072&quot; height=&quot;1000&quot;/&gt; Discovery server response to announce &lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/centralized_dns_response.png&quot; width=&quot;1072&quot; height=&quot;1000&quot;/&gt; Discovery server SRV push notification &lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/centralized_dns_srv.png&quot; width=&quot;1072&quot; height=&quot;620&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Once a peer has discovered another peer’s IP address and port number it will open a TCP connection to the other peer. Each half of the conversation has this structure which repeats until the end of the connection:&lt;/p&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/wire_protocol_structure.png&quot; width=&quot;1072&quot; height=&quot;110&quot;/&gt;&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Length.&lt;/strong&gt; Number of bytes until the start of the next length field.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Channel and type.&lt;/strong&gt; A single number (up to 11 bits long) that encodes two sub-fields as:&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/channel_type_field.png&quot; width=&quot;275&quot; height=&quot;225&quot;/&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Channel.&lt;/strong&gt; Peers can talk about multiple Dats using the same TCP connection. The channel number is 0 for the first Dat talked about, 1 for the next Dat and so on.&lt;/li&gt;
&lt;li id=&quot;message-type&quot;&gt;&lt;strong&gt;Type.&lt;/strong&gt; Number that says what the purpose of the message is.&lt;/li&gt;
&lt;li&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Meaning&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;11.5&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Feed&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I want to talk to you about this particular Dat&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Handshake&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I want to negotiate how we will communicate on this TCP connection&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Info&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I am either starting or stopping uploading or downloading&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Have&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I have some data that you said you wanted&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Unhave&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I no longer have some data that I previously said I had (alternatively: I didn’t store that data you just sent, please stop sending me data preemptively)&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Want&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;This is what data I want&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Unwant&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;I no longer want this data&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Request&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Please send me this data now&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Cancel&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Actually, don’t send me that data&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Data&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Here is the data you requested&lt;/td&gt;
&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;10–14&lt;/td&gt;
&lt;td/&gt;
&lt;td&gt;&lt;em&gt;(Unused)&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Extension&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Some other message that is not part of the core protocol&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Body.&lt;/strong&gt; Contents of the message.&lt;/li&gt;
&lt;/ul&gt;&lt;aside readability=&quot;12&quot;&gt;&lt;h3&gt;Bit notation&lt;/h3&gt;
&lt;p&gt;In several parts of the Dat protocol multiple fields are packed into a single number. It helps to look at the number as a sequence of bits because this makes the fields visible.&lt;/p&gt;
&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/notation_bits.png&quot; width=&quot;336&quot; height=&quot;110&quot;/&gt;&lt;p&gt;Throughout this guide bit sequences are shown as 1’s and 0’s in a box, grouped into fields. The most significant bit is always on the left.&lt;/p&gt;
&lt;p&gt;Eight bits make up a byte, however this number and many others are varints which can be up to 64 bits long. The fields on the right are always a fixed number of bits but the leftmost field can take up as many of the remaining 64 bits as it needs.&lt;/p&gt;
&lt;/aside&gt;&lt;h2 id=&quot;varints&quot;&gt;Varints&lt;/h2&gt;
&lt;div readability=&quot;14&quot;&gt;
&lt;p&gt;The first two fields are encoded as variable-length integers and therefore do not have a fixed size. You must read each field starting from the beginning to determine how long the field is and where the next field starts.&lt;/p&gt;
&lt;p&gt;The advantage of varints is that they only require a few bytes to represent small numbers, while still being able to represent large numbers by using more bytes. The disadvantage of varints is that they take more work to encode and decode compared to regular integers.&lt;/p&gt;
&lt;/div&gt;
&lt;aside readability=&quot;3.1157894736842&quot;&gt;&lt;div class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;


&lt;p&gt;Rust&lt;/p&gt;

&lt;/div&gt;
&lt;p&gt;In Dat, varints are between 1 and 10 bytes long and represent integers from 0 to 2&lt;sup&gt;64&lt;/sup&gt; - 1. Negative numbers aren’t used.&lt;/p&gt;
&lt;/aside&gt;&lt;p&gt;Here’s how to decode a varint:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/varint.png&quot; width=&quot;1072&quot; height=&quot;610&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;keepalive&quot;&gt;Keepalive&lt;/h2&gt;
&lt;p&gt;Keepalive messages are empty messages containing no channel number, type or body. They are discarded upon being received. Sending keepalives is necessary when there is a network middlebox that kills TCP connections which haven’t sent any data in a while. In these cases each peer periodically sends keepalive messages when no other data is being sent.&lt;/p&gt;
&lt;aside&gt;How frequently to send keepalive messages is essentially a guess based on what types of middleboxes are commonly used on the internet today. Other TCP-based protocols typically send keepalives every 30 to 120 seconds.&lt;/aside&gt;&lt;p&gt;Here’s an example of several keepalive messages interleaved with messages containing actual data. Each keepalive message is a single byte of zero:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/wire_protocol_keepalive.png&quot; width=&quot;1072&quot; height=&quot;140&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;message-structure&quot;&gt;Message structure&lt;/h2&gt;
&lt;p&gt;Within each message body is a series of field tags and values:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/wire_protocol_field_value_structure.png&quot; width=&quot;1072&quot; height=&quot;255&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;message-structure-field-tag&quot;&gt;The field tag is a varint. The most significant bits indicate which field within the message this is, for example: 1 = &lt;em&gt;discovery key&lt;/em&gt;, 2 = &lt;em&gt;nonce&lt;/em&gt;. This is needed because messages can have missing or repeated fields. The 3 least significant bits are the type of field.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/field_type_field.png&quot; width=&quot;704&quot; height=&quot;265&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;message-field-types&quot;&gt;The two types of field are:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Varint.&lt;/strong&gt; The field tag followed by a varint value. Used for simple numeric values and booleans.&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/field_structure_varint.png&quot; width=&quot;160&quot; height=&quot;100&quot;/&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Length-prefixed.&lt;/strong&gt; The field tag followed by a varint to say how many bytes the field contains, followed by the bytes themselves. Used for strings, bytes and embedded messages.&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/field_structure_length_prefixed.png&quot; width=&quot;440&quot; height=&quot;130&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;aside class=&quot;basealign&quot; readability=&quot;9.2089552238806&quot;&gt;&lt;p&gt;If you are familiar with the &lt;a href=&quot;https://developers.google.com/protocol-buffers/&quot;&gt;Protocol Buffers&lt;/a&gt; data serialization format you might recognize that this message structure adheres to it. Dat only uses a small subset of the features available with Protocol Buffers, however if you are writing an implementation you may be interested in the &lt;a href=&quot;https://github.com/mafintosh/hypercore-protocol/blob/master/schema.proto&quot;&gt;.proto file&lt;/a&gt; that describes the wire protocol.&lt;/p&gt;
&lt;p&gt;Over time new fields could be added to messages in the wire protocol. Field tags enable this to happen in a backwards-compatible way. If your implementation sees a field number that it doesn’t know about it can use the field type to find out how long the unknown field is and skip over it.&lt;/p&gt;
&lt;div class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/div&gt;
&lt;/aside&gt;&lt;h2 id=&quot;feed-message&quot;&gt;Feed message&lt;/h2&gt;
&lt;p&gt;After opening the TCP connection the first message is always a &lt;strong&gt;feed&lt;/strong&gt; message.&lt;/p&gt;
&lt;p&gt;Feed messages have two fields:&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;2&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Discovery key&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;32-byte discovery key for this Dat.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Nonce&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;24-byte random nonce generated for this TCP connection. Only present for the first feed message.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;Putting everything together, this is how each side of the TCP connection begins:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/feed_message.png&quot; width=&quot;1072&quot; height=&quot;460&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Or, as the bytes actually sent over the wire:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;feed-message-bytes&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/feed_message_bytes.png&quot; width=&quot;1072&quot; height=&quot;460&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;encryption&quot;&gt;Encryption&lt;/h2&gt;
&lt;div readability=&quot;13&quot;&gt;
&lt;p&gt;Each side of the TCP connection is encrypted starting from the second message and continuing until the end of the connection. This prevents network eavesdroppers from finding out what data a Dat contains unless they already know its public key.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;XSalsa20&lt;/strong&gt; is the encryption cipher used. Given a 32-byte key and a 24-byte nonce, XSalsa20 produces a never-ending stream of pseudorandom bytes called the keystream.&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;basealign&quot;&gt;The encryption scheme is not authenticated, meaning a man-in-the-middle can flip bits to disrupt the connection. This is mitigated because data integrity in a Dat is verified using a separate mechanism. If there is an attacker who is in a position to modify bits on the network they have lots of other options for disrupting connections, for example by simply dropping packets.&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/encryption.png&quot; width=&quot;1072&quot; height=&quot;250&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;encryption-sender&quot;&gt;The &lt;strong&gt;sender&lt;/strong&gt; generates a random 24-byte value for the nonce and includes it in their first message (which is always a feed message). The Dat’s 32-byte public key is used as the XSalsa20 key. From the second message onwards all bytes they send are XORed with the keystream.&lt;/p&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/encryption_send.png&quot; width=&quot;1072&quot; height=&quot;410&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;encryption-receiver&quot;&gt;The &lt;strong&gt;receiver&lt;/strong&gt; reads the nonce from the sender’s first message and uses this with their knowledge of the Dat’s public key to set up an identical XSalsa20 keystream. Then they XOR the keystream with the bytes received to decrypt the stream.&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/encryption_receive.png&quot; width=&quot;1072&quot; height=&quot;460&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;handshake-message&quot;&gt;Handshake message&lt;/h2&gt;
&lt;p&gt;After the initial feed message, the second message sent on each side of the TCP connection is always a &lt;strong&gt;handshake&lt;/strong&gt; message.&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;11.5&quot;&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Random ID generated by this peer upon starting, 32 bytes long. Used to detect multiple connections to the same peer or accidental connections to itself.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Live&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;0 = End the connection when neither peer is downloading, 1 = Keep the connection open indefinitely (only takes effect if both peers set to 1).&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;5&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;User data&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Arbitrary bytes that can be used by higher-level applications for any purpose. Remember that any data put in here is not protected from tampering as it passes through the network. Additionally, any eavesdropper who knows the Dat’s public key can read this.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;6&quot;&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Extensions&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Names of any extensions the peer wants to use, for example: “session-data”. This field can appear multiple times, one for each extension. Both peers need to request an extension in their handshake messages for it to become active.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Acknowledge&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;0 = No need to acknowledge each chunk of data received, 1 = Must acknowledge each chunk of data received.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;After completing the handshake peers begin requesting data from each other. Dats contain a list of variable-sized chunks of bytes. New chunks can be added to the end by the Dat’s author, but existing chunks can’t be deleted or modified.&lt;/p&gt;
&lt;aside&gt;Boundaries between chunks are preserved. This can be useful for dividing up the Dat into a series of messages, for example one message per chunk.&lt;/aside&gt;&lt;p&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/chunk_structure.png&quot; width=&quot;704&quot; height=&quot;65&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Hashes are used to verify the integrity of data within a Dat. Each chunk of data has a corresponding hash. There are also parent hashes which verify the integrity of two other hashes. Parent hashes form a tree structure. In this example the integrity of all the data can be verified if you know hash number 3:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;chunk-structure-hashes&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/chunk_structure_hashes.png&quot; width=&quot;704&quot; height=&quot;195&quot;/&gt;&lt;/p&gt;
&lt;aside readability=&quot;5&quot;&gt;&lt;p&gt;Chunk hashes are even-numbered. Parent hashes are odd-numbered.&lt;/p&gt;
&lt;p&gt;Hash trees allow downloaders to download and verify a specific chunk without needing to also download hashes of every other chunk.&lt;/p&gt;
&lt;/aside&gt;&lt;p&gt;Each time the author adds new chunks they calculate a root hash and sign it with the Dat’s secret key. Downloaders can use the Dat’s public key to verify the signature, which in turn verifies the integrity of all the other hashes and chunks.&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;chunk-structure-signature&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/chunk_structure_signature.png&quot; width=&quot;704&quot; height=&quot;300&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Depending on the number of chunks, the root hash can have more than one input. The root hash combines as many parent or chunk hashes as necessary to cover all the chunks. Here is how the hash tree looks with different numbers of chunks:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;hash-tree-1&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/hash_tree_1.png&quot; width=&quot;1072&quot; height=&quot;1723&quot;/&gt;&lt;img id=&quot;hash-tree-2&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/hash_tree_2.png&quot; width=&quot;1072&quot; height=&quot;1535&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;hashes-and-signatures&quot;&gt;Hashes and signatures&lt;/h2&gt;
&lt;div readability=&quot;7&quot;&gt;
&lt;p&gt;The three types of hash seen in the hash tree are:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Chunk hashes&lt;/strong&gt;, which hash the contents of a single chunk.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Parent hashes&lt;/strong&gt;, which hash two other hashes forming a tree structure.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Root hashes&lt;/strong&gt;, which sit at the root of the tree and are signed by the Dat’s author.&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;p&gt;Rust&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;Each type of hash has a specific way to construct it:&lt;/p&gt;


&lt;p&gt;Peers exchange chunks in multi-step process where the downloader and uploader negotiate what chunks they want and have:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/chunk_conversation.png&quot; width=&quot;704&quot; height=&quot;730&quot;/&gt;&lt;/p&gt;
&lt;aside readability=&quot;8&quot;&gt;&lt;p&gt;In this example one peer is a downloader and the other is an uploader. In other cases both peers will be uploading and downloading at the same time as they each have some of the chunks but not all of them.&lt;/p&gt;
&lt;p&gt;Each request message can only request a single chunk per message. Downloaders may want to queue up several request messages at a time. When the uploader finishes sending a chunk this lets them immediately start sending the next one without waiting for a round-trip.&lt;/p&gt;
&lt;/aside&gt;&lt;h2 id=&quot;want-and-have&quot;&gt;Want and have&lt;/h2&gt;
&lt;p&gt;Each peer remembers which chunks the other peer wants and has.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Wanting&lt;/strong&gt; a chunk means “I want to download this chunk, please tell me if you have it”.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Having&lt;/strong&gt; a chunk means “I know you want this chunk and I will send it if you ask for it”. If a peer tells you they are only interested in a small range of chunks then you only have to tell them about chunks within that range.&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;As peers download (or even delete) data, the list of chunks they want and have will change. This state is communicated with four message types: &lt;strong&gt;want&lt;/strong&gt;, &lt;strong&gt;unwant&lt;/strong&gt;, &lt;strong&gt;have&lt;/strong&gt; and &lt;strong&gt;unhave&lt;/strong&gt;. Each of these four messages has the same structure which indicates a contiguous range of chunks:&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Start&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Number of the first chunk you want/unwant/have/unhave. Chunk numbering starts at 0.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;6&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Length&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;1 = Just the &lt;em&gt;start&lt;/em&gt; chunk, 2 = The &lt;em&gt;start&lt;/em&gt; chunk and the next one, and so on. Omit this field to select all following chunks to the end of the Dat, including new chunks as they are added.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;Here is an example showing typical use of have and want messages between two peers:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;want-have-conversation-1&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/want_have_1.png&quot; width=&quot;1072&quot; height=&quot;1025&quot;/&gt;&lt;img id=&quot;want-have-conversation-2&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/want_have_2.png&quot; width=&quot;1072&quot; height=&quot;1070&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;have-bitfield&quot;&gt;Have bitfield&lt;/h2&gt;
&lt;div readability=&quot;12&quot;&gt;
&lt;p&gt;If you have lots of little, non-contiguous ranges of data it can take a lot of have messages to tell your peer exactly what you have. There is an alternate form of the have message for this purpose. It is efficient at representing both contiguous and non-contiguous ranges of data.&lt;/p&gt;
&lt;p&gt;This form of the have message only has one field:&lt;/p&gt;
&lt;/div&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;p&gt;Rust&lt;/p&gt;

&lt;/aside&gt;&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;1&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Bitfield&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;A sequence of contiguous and non-contiguous chunk ranges.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;For example, let’s look at the chunks this peer has. Normally this would take 11 messages to represent:&lt;/p&gt;
&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/run_length_encoding_bitfield.png&quot; width=&quot;1072&quot; height=&quot;60&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Instead, divide the chunks into ranges where each range is either contiguous (all chunks present or none present), or non-contiguous (some chunks present). The ranges must be multiples of 8 chunks long.&lt;/p&gt;
&lt;aside&gt;In this case the ranges alternate between contiguous and non-contiguous, but this does not always happen. It is possible for contiguous ranges to be next to each other if one has all chunks present and the other has no chunks present.&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/run_length_encoding_bitfield_segment.png&quot; width=&quot;1072&quot; height=&quot;110&quot;/&gt;&lt;/p&gt;
&lt;p id=&quot;have-bitfield-range-types&quot;&gt;Ranges are encoded as:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;strong&gt;Contiguous.&lt;/strong&gt; A single varint that contains sub-fields saying how many 8-chunk spans there are and whether all the chunks are present or absent.&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/run_length_encoding_contiguous_range.png&quot; width=&quot;260&quot; height=&quot;260&quot;/&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-contiguous.&lt;/strong&gt; A varint saying how many 8-chunk spans the following bitfield represents (which is also its length in bytes), followed by the bitfield.&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/run_length_encoding_non_contiguous_range.png&quot; width=&quot;445&quot; height=&quot;220&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;aside&gt;The first byte in the bitfield represents the first 8-chunk span. The most significant bit of each byte represents the first chunk of each 8-chunk span.&lt;/aside&gt;&lt;p&gt;Putting everything together, here are the bits used to encode the chunks this peer has:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;have-bitfield-bits&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/run_length_encoding_bitfield_bits.png&quot; width=&quot;1072&quot; height=&quot;595&quot;/&gt;&lt;/p&gt;
&lt;p&gt;And here is how the final have message would appear on the wire:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;have-bitfield-bytes&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/have_message_bytes.png&quot; width=&quot;1072&quot; height=&quot;195&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;requesting-data&quot;&gt;Requesting data&lt;/h2&gt;
&lt;p&gt;Once your peer has told you that they have a chunk you want, send a &lt;strong&gt;request&lt;/strong&gt; message to ask them for it:&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;8.6892583120205&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Index&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Number of the chunk to send back. This field must be present even when using the &lt;em&gt;bytes&lt;/em&gt; field below.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Bytes&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;If this field is present, ignore the &lt;em&gt;index&lt;/em&gt; field and send back the chunk containing this byte. Useful if you don’t know how big each chunk is but you want to seek to a specific byte.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;5&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Hash&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;0 = Send back the data in this chunk as well as hashes needed to verify it, 1 = Don’t send back the data in this chunk, only send the hashes.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;6.3803278688525&quot;&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Nodes&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Used to request additional hashes needed to verify the integrity of this chunk. 0 = Send back all hashes needed to verify this chunk, 1 = Just send the data, no hashes. For other values that can be used to request specific hashes from the hash tree, see the &lt;a href=&quot;https://github.com/pfrazee/DEPs/blob/dep-wire-protocol/proposals/0000-wire-protocol.md#block-tree-digest&quot;&gt;Wire Protocol specification&lt;/a&gt;.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p id=&quot;cancel-message&quot;&gt;If you no longer want a chunk you requested, send a &lt;strong&gt;cancel&lt;/strong&gt; message:&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;4&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Index&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Number of the chunk to cancel. This field must be present even when using the &lt;em&gt;bytes&lt;/em&gt; field below.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Bytes&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;If this field is present, ignore the &lt;em&gt;index&lt;/em&gt; field and cancel the request for the chunk containing this byte.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Hash&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Set to the same value as the &lt;em&gt;hash&lt;/em&gt; field of the request you want to cancel.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;Cancel messages can be used if you preemptively requested a chunk from multiple peers at the same time. Upon receiving the chunk from the fastest peer, send cancel messages to the others.&lt;/p&gt;
&lt;p id=&quot;data-message&quot;&gt;When a peer has requested a chunk from you, send it to them with a &lt;strong&gt;data&lt;/strong&gt; message:&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;3.8403041825095&quot;&gt;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Index&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Chunk number.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Value&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Contents of the chunk. Do not set this field if the request had &lt;em&gt;hash&lt;/em&gt; = 1.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;4.6488294314381&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Nodes&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td readability=&quot;4.6181818181818&quot;&gt;
&lt;p&gt;This field is repeated for each hash that the requester needs to verify the chunk’s integrity.&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;1.7236842105263&quot;&gt;&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Index&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Hash number.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;1.2631578947368&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Hash&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;32-byte &lt;a href=&quot;https://datprotocol.github.io/how-dat-works/#chunk-hash&quot;&gt;chunk hash&lt;/a&gt; or &lt;a href=&quot;https://datprotocol.github.io/how-dat-works/#parent-hash&quot;&gt;parent hash&lt;/a&gt;.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Size&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Total length of data in chunks covered by this hash.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Signature&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;64-byte ed25519 signature of the root hash corresponding to this chunk.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Dat uses two coupled feeds to represent files and folders. The &lt;strong&gt;metadata&lt;/strong&gt; feed contains the names, sizes and other metadata for each file, and its typically quite small even when the Dat contains a lot of data. The &lt;strong&gt;content&lt;/strong&gt; feed contains the actual file contents. The metadata feed points to where in the content feed each file is located, so you only need to fetch the contents of files you are interested in.&lt;/p&gt;
&lt;aside&gt;Folders aren’t created explicitly. Instead, files have slash-separated names and all but the last path segment represents the folders that file is inside. Dat can’t represent an empty folder or remember UIDs, permission modes or modification dates on folders.&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/files_folders_overview.png&quot; width=&quot;1072&quot; height=&quot;200&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The first chunk of the metadata feed is always an &lt;strong&gt;index&lt;/strong&gt; chunk. Check that the &lt;em&gt;type&lt;/em&gt; field contains the word “hyperdrive”. If so, the &lt;em&gt;content&lt;/em&gt; field is the public key of the content feed.&lt;/p&gt;
&lt;div class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;2.5&quot;&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Type&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;What sort of data is contained in this Dat. For Dats using the concept of files and folders this is “hyperdrive”.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Content&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;32-byte public key of the content feed.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;After the index all following chunks in the metadata feed are &lt;strong&gt;nodes&lt;/strong&gt;, which store file metadata. Nodes have these fields:&lt;/p&gt;
&lt;div id=&quot;node-fields&quot; class=&quot;pagewidth msgfields&quot;&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;5.4665991902834&quot;&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Slash-separated path and filename. Always begins with a slash. For example: “/src/main.c”&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;10&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Value&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td readability=&quot;9&quot;&gt;
&lt;p&gt;If this field is present the file is being created or updated. These sub-fields give the details of the new or updated file:&lt;/p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;No.&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;&lt;tbody readability=&quot;11&quot;&gt;&lt;tr readability=&quot;7&quot;&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Mode&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td readability=&quot;9&quot;&gt;
&lt;p&gt;Unix permissions. In practice one of these two common values depending on whether the file is executable or not:&lt;/p&gt;
&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/files_folders_mode_flags.png&quot; width=&quot;390&quot; height=&quot;90&quot;/&gt;&lt;p&gt;Security-sensitive bits such as setuid and setgid might also be set. When extracting files from a Dat to the filesystem you might consider not honoring these bits.&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;UID&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Unix user ID. Alternatively, set to 0 to not expose the user’s ID.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;3&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;GID&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Unix group ID. Alternatively, set to 0 to not expose the user’s group ID.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Size&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Size of the file in bytes.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Blocks&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Number of chunks the file occupies in the content feed.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Offset&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Chunk number of the first chunk in the content feed.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Byte offset&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Size in bytes of all chunks in the content feed before this file. 0 for the first file.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Mtime&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Time the file was last modified. Number of milliseconds since 1 January 1970 00:00:00 UTC.&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;2&quot;&gt;&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Ctime&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Varint&lt;/td&gt;
&lt;td&gt;Time the file was created. Number of milliseconds since 1 January 1970 00:00:00 UTC.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;If the &lt;em&gt;value&lt;/em&gt; field is absent (and therefore none of the sub-fields above are set) the file previously existing with this &lt;em&gt;name&lt;/em&gt; is now deleted.&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;&lt;tr readability=&quot;1.7977528089888&quot;&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Paths&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Length-prefixed&lt;/td&gt;
&lt;td&gt;Index that helps to traverse folders more efficiently. &lt;a href=&quot;https://datprotocol.github.io/how-dat-works/#paths-index&quot;&gt;See below&lt;/a&gt;.&lt;/td&gt;
&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;To find the latest version of a file, start from the end of the metadata feed and work backwards until you find a node with that file’s name. Even though files can be modified and deleted, previous versions can still be retrieved by searching back in the metadata feed.&lt;/p&gt;
&lt;p&gt;Here is an example showing how the &lt;em&gt;offset&lt;/em&gt; and &lt;em&gt;blocks&lt;/em&gt; fields refer to chunks in the content feed:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;files-folders-feeds&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/files_folders_feeds.png&quot; width=&quot;1072&quot; height=&quot;385&quot;/&gt;&lt;/p&gt;
&lt;h2 id=&quot;paths-index&quot;&gt;Paths index&lt;/h2&gt;
&lt;p&gt;Scanning through the list of all files added, modified or deleted would be slow for Dats that contain lots of files or a long history. To make this faster, every node in the metadata feed contains extra information in the &lt;strong&gt;paths&lt;/strong&gt; field to help traverse folders.&lt;/p&gt;
&lt;aside class=&quot;impl&quot;&gt;&lt;img class=&quot;icon&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/spanner_icon.png&quot;/&gt;&lt;h3&gt;Implementations&lt;/h3&gt;
&lt;p&gt;JS&lt;/p&gt;

&lt;/aside&gt;&lt;p&gt;&lt;img class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_storage.png&quot; width=&quot;1072&quot; height=&quot;210&quot;/&gt;&lt;/p&gt;
&lt;p&gt;To calculate a &lt;em&gt;paths&lt;/em&gt; field, start by constructing a file hierarchy from the metadata feed:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;paths-index-tree&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_tree.png&quot; width=&quot;704&quot; height=&quot;340&quot;/&gt;&lt;/p&gt;
&lt;aside readability=&quot;5&quot;&gt;&lt;p&gt;The first node is called node 0, which is stored in chunk 1 of the metadata feed.&lt;/p&gt;
&lt;p&gt;Node number = chunk number - 1&lt;/p&gt;
&lt;/aside&gt;&lt;p&gt;For each file in the hierarchy, find the most recent entry for it in the metadata feed and remember the node number. For each folder, remember the highest node number among its children:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;paths-index-versions&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_versions.png&quot; width=&quot;704&quot; height=&quot;340&quot;/&gt;&lt;/p&gt;
&lt;p&gt;Locate the file that was just added. Select that file and all its parent folders up to the root folder. Also select files and folders within those folders, but not their descendants. Ignore everything else.&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;paths-index-select&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_select.png&quot; width=&quot;704&quot; height=&quot;340&quot;/&gt;&lt;/p&gt;
&lt;aside&gt;In this example we are calculating the &lt;em&gt;paths&lt;/em&gt; field for &lt;strong&gt;node 8&lt;/strong&gt;, however the same calculation will have already been done for all the previous nodes as they were added.&lt;/aside&gt;&lt;p&gt;Next, follow these steps to process the node numbers into bytes:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;paths-index-encode&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_encode.png&quot; width=&quot;1072&quot; height=&quot;260&quot;/&gt;&lt;/p&gt;
&lt;p&gt;So node 8 would appear in the metadata feed as:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_result.png&quot; width=&quot;704&quot; height=&quot;165&quot;/&gt;&lt;/p&gt;
&lt;p&gt;The process for calculating the &lt;em&gt;paths&lt;/em&gt; field after deleting a file is mostly the same as when adding a file:&lt;/p&gt;
&lt;p&gt;&lt;img id=&quot;paths-index-delete&quot; class=&quot;pagewidth&quot; src=&quot;https://datprotocol.github.io/how-dat-works/png/paths_index_delete.png&quot; width=&quot;1072&quot; height=&quot;850&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Dat was first released in 2013, which in terms of internet infrastructure is very recent. Parts of the protocol are still changing today to enable Dat to handle bigger datasets, more hostile network conditions and support new types of applications.&lt;/p&gt;
&lt;p&gt;This guide has described the Dat protocol as of January 2019. Here’s a brief summary of upcoming proposals to modify the Dat protocol in the near future:&lt;/p&gt;
&lt;ul readability=&quot;9.2412670219065&quot;&gt;&lt;li readability=&quot;1.9449035812672&quot;&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/datproject/planning#protocol-performance-and-features&quot;&gt;Hyperdrive&lt;/a&gt;&lt;/strong&gt; is the technical name of the files and folders system. Hyperdrive is going to be completely overhauled to make it faster for datasets containing millions of files. The new version will use a data structure called a prefix tree. There will also be refactoring changes so that files/folders and key/value databases use the same underlying storage system.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;4.9067164179104&quot;&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://pfrazee.hashbase.io/blog/hyperswarm&quot;&gt;Hyperswarm&lt;/a&gt;&lt;/strong&gt; is a new set of discovery mechanisms for finding other peers. It will replace the local network discovery and centralized DNS discovery mechanisms. It will also replace the BitTorrent distributed hash table mechanism that is in use today (but not documented in this guide).&lt;/p&gt;
&lt;p&gt;Hyperswarm is able to hole-punch through NAT devices on networks. This helps users on residential or mobile internet connections directly connect to each other despite not having dedicated IP addresses or being able to accept incoming TCP connections.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;1.9205298013245&quot;&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.datprotocol.com/deps/0008-multiwriter/&quot;&gt;Multi-writer&lt;/a&gt;&lt;/strong&gt; will allow Dats to be modified by multiple devices and multiple authors at the same time. Each author will have their own secret key and publish a Dat with their data in it. Multi-writer fuses all of these separate Dats into one “meta-Dat” that is a view of everyone’s data combined.&lt;/p&gt;
&lt;/li&gt;
&lt;li readability=&quot;3.8845360824742&quot;&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://noiseprotocol.org/&quot;&gt;NOISE protocol&lt;/a&gt;&lt;/strong&gt; is a cryptographic framework for setting up secure connections between computers on the internet. This will replace how handshakes and encryption currently work in the wire protocol.&lt;/p&gt;
&lt;p&gt;NOISE will fix weaknesses such as connections being readable by any eavesdropper who knows the Dat’s public key. It will allow connections to be authenticated to prevent tampering and also support forward secrecy so that past connections cannot be decrypted if the key is later stolen.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;hr/&gt;&lt;p id=&quot;conclusion&quot;&gt;This is the end of &lt;em&gt;How Dat Works&lt;/em&gt;. We’ve seen all the steps necessary to download and share files using Dat. If you’d like to write an implementation then check out the &lt;em&gt;&lt;a href=&quot;https://datprotocol.github.io/book/&quot;&gt;Dat Protocol Book&lt;/a&gt;&lt;/em&gt; which offers guidance about implementation details.&lt;/p&gt;
&lt;p&gt;The focus of this guide has been on storing files, but this is just one use of Dat. The protocol is flexible enough to store arbitrary data that does not use the concept of files or folders. One example is &lt;a href=&quot;https://www.datprotocol.com/deps/0004-hyperdb/&quot;&gt;Hyperdb&lt;/a&gt; which is a key/value database, but Dat can be extended to support completely different use cases too. Take a look at the formal &lt;a href=&quot;https://www.datprotocol.com/deps/&quot;&gt;protocol specifications&lt;/a&gt; for more information.&lt;/p&gt;
&lt;hr/&gt;
&lt;footer readability=&quot;1.6382978723404&quot;&gt;&lt;p&gt;&lt;em&gt;How Dat Works&lt;/em&gt; is written by Duncan Keall and dedicated to the public domain.&lt;/p&gt;

&lt;/footer&gt;&lt;/body&gt;</description>
<pubDate>Fri, 05 Jul 2019 16:36:09 +0000</pubDate>
<dc:creator>nanomonkey</dc:creator>
<dc:format>text/html</dc:format>
<dc:identifier>https://datprotocol.github.io/how-dat-works/</dc:identifier>
</item>
<item>
<title>Bladder cancer &amp;#039;attacked and killed by common cold virus&amp;#039;</title>
<link>https://www.bbc.com/news/health-48868261</link>
<guid isPermaLink="true" >https://www.bbc.com/news/health-48868261</guid>
<description>&lt;figure class=&quot;media-landscape has-caption full-width lead&quot;&gt;&lt;span class=&quot;image-and-copyright-container&quot;&gt;
                
                &lt;img class=&quot;js-image-replace&quot; alt=&quot;Dividing bladder cancer cells&quot; src=&quot;https://ichef.bbci.co.uk/news/320/cpsprodpb/B2A6/production/_107743754_c0309017-dividing_bladder_cancer_cells_sem-spl.jpg&quot; width=&quot;976&quot; height=&quot;549&quot;/&gt;&lt;span class=&quot;off-screen&quot;&gt;Image copyright&lt;/span&gt;
                 &lt;span class=&quot;story-image-copyright&quot;&gt;Science Photo Library&lt;/span&gt;
                
            &lt;/span&gt;
            
            &lt;figcaption class=&quot;media-caption&quot;&gt;&lt;span class=&quot;off-screen&quot;&gt;Image caption&lt;/span&gt;
                &lt;span class=&quot;media-caption__text&quot;&gt;
                    A virus of the common cold infected and killed bladder cancer cells in the study
                &lt;/span&gt;
            &lt;/figcaption&gt;&lt;/figure&gt;&lt;p class=&quot;story-body__introduction&quot;&gt;A strain of the common cold virus can infect and kill bladder cancer cells, a small study suggests.&lt;/p&gt;&lt;p&gt;All signs of the disease disappeared in one patient, and in 14 others there was evidence that cancer cells had died.&lt;/p&gt;&lt;p&gt;University of Surrey researchers said the virus could &quot;help revolutionise treatment&quot; for the cancer and reduce the risk of it recurring.&lt;/p&gt;&lt;p&gt;A bladder cancer charity called the study &quot;very exciting&quot; if larger studies confirmed the findings.&lt;/p&gt;&lt;p&gt;Non-muscle invasive bladder is the 10th most common cancer in the UK, with around 10,000 new cases each year.&lt;/p&gt;&lt;p&gt;Current treatments for this type of bladder cancer are invasive or can cause serious, toxic side effects.&lt;/p&gt;&lt;p&gt;And constant, costly monitoring is needed to check that the cancer has not returned after treatment.&lt;/p&gt;&lt;h2 class=&quot;story-body__crosshead&quot;&gt;'Join the party'&lt;/h2&gt;&lt;p&gt;In &lt;a href=&quot;http://clincancerres.aacrjournals.org/content/early/2019/06/29/1078-0432.CCR-18-4022&quot; class=&quot;story-body__link-external&quot;&gt;this study&lt;/a&gt;, 15 patients with the disease were given the cancer-killing coxsackievirus (CVA21) through a catheter one week before surgery to remove their tumours.&lt;/p&gt;&lt;p&gt;When tissues samples were analysed after surgery, there were signs the virus had targeted and killed cancer cells in the bladder. &lt;/p&gt;&lt;p&gt;Once these cells had died, the virus had then reproduced and infected other cancerous cells - but all other healthy cells were left intact.&lt;/p&gt;&lt;p&gt;What the virus does is special, says study leader Prof Hardev Pandha, from the University of Surrey and Royal Surrey County Hospital.&lt;/p&gt;&lt;p&gt;&quot;The virus gets inside cancer cells and kills them by triggering an immune protein - and that leads to signalling of other immune cells to come and join the party,&quot; he said.&lt;/p&gt;&lt;figure class=&quot;media-landscape has-caption full-width&quot;&gt;&lt;span class=&quot;image-and-copyright-container&quot;&gt;
                
                
                
                
                
                 &lt;span class=&quot;off-screen&quot;&gt;Image copyright&lt;/span&gt;
                 &lt;span class=&quot;story-image-copyright&quot;&gt;Science Photo Library&lt;/span&gt;
                
            &lt;/span&gt;
            
            &lt;figcaption class=&quot;media-caption&quot;&gt;&lt;span class=&quot;off-screen&quot;&gt;Image caption&lt;/span&gt;
                &lt;span class=&quot;media-caption__text&quot;&gt;
                    No side effects were found in patients treated with the virus via a catheter to the bladder
                &lt;/span&gt;
            &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;Normally, the tumours in the bladder are &quot;cold&quot; because they do not have immune cells to fight off the cancer.&lt;/p&gt;&lt;p&gt;But the actions of the virus turn them &quot;hot&quot;, making the body's immune system react.&lt;/p&gt;&lt;p&gt;Prof Pandha said the same virus had also been tested on skin cancer, but this was the first time it had been studied in a clinical trial on bladder cancer.&lt;/p&gt;&lt;p&gt;&quot;Reduction of tumour burden and increased cancer cell death was observed in all patients, and removed all trace of the disease in one patient following just one week of treatment, showing its potential effectiveness,&quot; he said. &lt;/p&gt;&lt;p&gt;&quot;Notably, no significant side effects were observed in any patient.&quot; &lt;/p&gt;&lt;h2 class=&quot;story-body__crosshead&quot;&gt;'New era in treatment'&lt;/h2&gt;&lt;p&gt;The plan is now to use the common cold virus with a targeted immunotherapy drug treatment, called a checkpoint inhibitor, in a future trial in more patients.&lt;/p&gt;&lt;p&gt;Dr Nicola Annels, research fellow at the University of Surrey, said viruses like the coxsackievirus &quot;could signal a move away from more established treatments such as chemotherapy&quot;. &lt;/p&gt;&lt;p&gt;Allen Knight, chairman of Action Bladder Cancer UK, said the study findings were &quot;very exciting&quot;.&lt;/p&gt;&lt;p&gt;Bladder cancer costs the NHS more per patient than nearly every other cancer, because of the high recurrence rate, he said.&lt;/p&gt;&lt;p&gt;&quot;If the safety, tolerability, and efficacy data can be confirmed in larger clinical studies and trials, then it could herald a new era in the treatment for non-muscle-invasive bladder cancer patients, like me, who often feel that innovations in cancer therapies pass us by.&quot; &lt;/p&gt;&lt;p&gt;Dr Mark Linch, a bladder cancer expert at the Cancer Research UK Cancer Institute at University College London, said the initial results were &quot;encouraging&quot;.&lt;/p&gt;&lt;p&gt;&quot;It will be really interesting to see how this new virus-based therapy fares in larger trials in people with non-muscle invasive bladder cancer, particularly in combination with newer immunotherapies,&quot; he said.&lt;/p&gt;
            </description>
<pubDate>Fri, 05 Jul 2019 16:35:48 +0000</pubDate>
<dc:creator>cpncrunch</dc:creator>
<og:title>Common cold virus 'helps destroy' bladder cancer</og:title>
<og:type>article</og:type>
<og:description>A small UK study found promising signs of a kinder, less invasive treatment for the disease.</og:description>
<og:url>https://www.bbc.com/news/health-48868261</og:url>
<og:image>https://ichef.bbci.co.uk/news/1024/branded_news/B2A6/production/_107743754_c0309017-dividing_bladder_cancer_cells_sem-spl.jpg</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.bbc.com/news/health-48868261</dc:identifier>
</item>
<item>
<title>Safer Nuclear Reactors Are on the Way</title>
<link>https://www.scientificamerican.com/article/safer-nuclear-reactors-are-on-the-way/</link>
<guid isPermaLink="true" >https://www.scientificamerican.com/article/safer-nuclear-reactors-are-on-the-way/</guid>
<description>&lt;div class=&quot;mura-region mura-region-loose&quot;&gt;
&lt;div class=&quot;mura-region-local&quot;&gt;
&lt;p&gt;Controlling carbon in the atmosphere will require a mix of energy technologies—potentially including nuclear reactors, which emit no carbon but are seen as risky because of a few major accidents. That risk could be greatly reduced.&lt;/p&gt;
&lt;p&gt;Commercial reactors have used the same fuel for decades: small pellets of uranium dioxide stacked inside long cylindrical rods made of a zirconium alloy. Zirconium allows the neutrons generated from fission in the pellets to readily pass among the many rods submerged in water inside a reactor core, supporting a self-sustaining, heat-producing nuclear reaction.&lt;/p&gt;
&lt;p&gt;Trouble is, if the zirconium overheats, it can react with water and produce hydrogen, which can explode. That scenario fed two of the world’s worst reactor accidents: the 1979 potential explosion and partial meltdown at Three Mile Island in the U.S. and the 2011 explosions and radiation release at Fukushima Daiichi in Japan. (The 1986 Chernobyl accident was caused by faulty reactor design and operation.)&lt;/p&gt;
&lt;p&gt;Manufacturers such as Westinghouse Electric Company and Framatome are hastening development of so-called accident-tolerant fuels that are less likely to overheat—and if they do, will produce very little or no hydrogen. In some of the variations, the zirconium cladding is coated to minimize reactions. In others, zirconium and even the uranium dioxide are replaced with different materials. The new configurations could be slipped into existing reactors with little modification, so they could be phased in during the 2020s. Thorough in-core testing, which has begun, would have to prove successful, and regulators would have to be satisfied. In a bonus, the new fuels could help plants run more efficiently, making nuclear power more cost-competitive—a significant motivation for manufacturers and electric utilities because natural gas, solar and wind energy are less expensive.&lt;/p&gt;
&lt;p&gt;Although nuclear power has stalled in the U.S. and is being phased out in Germany and elsewhere, Russia and China are building aggressively. These markets could be lucrative for the manufacturers of these new fuels.&lt;/p&gt;
&lt;p&gt;Russia is also deploying other safety measures; recent installations at home and abroad by the state-run company Rosatom have newer “passive” safety systems that can squelch overheating even if electrical power at the plant is lost and coolant cannot be actively circulated. Westinghouse and other companies have incorporated passive safety features into their updated designs as well.&lt;/p&gt;
&lt;p&gt;Manufacturers are also experimenting with “fourth generation” models that use liquid sodium or molten salt instead of water to transfer heat from fission, removing the possibility of dangerous hydrogen production. China reportedly intends to connect a demonstration helium-cooled reactor to its grid this year.&lt;/p&gt;
&lt;p&gt;In the U.S., lack of a permanent, deep geological repository for spent nuclear fuel has long put a brake on expanding the industry. Political sentiment may be changing. This spring, surprisingly, more than a dozen U.S. legislators proposed measures to restart licensing for the Yucca Mountain nuclear waste repository in Nevada, touted since 1987 as the country’s leading storage site. Meanwhile Senator Lisa Murkowski of Alaska is advocating for very small, modular reactors being developed at Idaho National Laboratory. (Rosatom is making small reactors, too.) And a group of Western states has entered a tentative deal with NuScale Power in Oregon for a dozen of its modular reactors. Improved fuels and growth in small reactors could be a big part of a nuclear power rebirth.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
<pubDate>Fri, 05 Jul 2019 13:28:16 +0000</pubDate>
<dc:creator>tshannon</dc:creator>
<og:type>article</og:type>
<og:title>Safer Nuclear Reactors Are on the Way</og:title>
<og:description>Resilient fuels and innovative reactors could enable a resurgence of nuclear power</og:description>
<og:image>https://static.scientificamerican.com/sciam/cache/file/EB6427F9-7B08-4D66-9297947F8F369BE7.jpg</og:image>
<og:url>https://www.scientificamerican.com/article/safer-nuclear-reactors-are-on-the-way/</og:url>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.scientificamerican.com/article/safer-nuclear-reactors-are-on-the-way/</dc:identifier>
</item>
<item>
<title>Run Your Own Website</title>
<link>https://zacs.site/blog/own-your-platform.html</link>
<guid isPermaLink="true" >https://zacs.site/blog/own-your-platform.html</guid>
<description>&lt;time datetime=&quot;2019-07-05&quot; pubdate=&quot;pubdate&quot;&gt;By Zac J. Szewczyk on &lt;a href=&quot;https://zacs.site/blog/2019.html&quot;&gt;2019&lt;/a&gt;/&lt;a href=&quot;https://zacs.site/blog/2019-07.html&quot;&gt;07&lt;/a&gt;/05 09:24:09 EST&lt;/time&gt;&lt;p&gt;I go back and forth on running my own website. I love &lt;a href=&quot;https://zacs.site/blog/re-introducing-first-crack.html&quot;&gt;working&lt;/a&gt; &lt;a href=&quot;https://zacs.site/blog/first-crack-release-notes-0619.html&quot;&gt;on&lt;/a&gt; &lt;a href=&quot;https://zacs.site/projects.html#firstCrack&quot;&gt;First Crack&lt;/a&gt;, but that work can become trying. I have little time for &lt;a href=&quot;https://zacs.site/projects.html&quot;&gt;projects&lt;/a&gt;, and the more I spend coding, the less I &lt;a href=&quot;https://zacs.site/blog/my-morning-reads.html&quot;&gt;read&lt;/a&gt; and write. On net, though, I consider this &lt;a href=&quot;http://blairreeves.me/2019/01/10/yes-you-should-blog/&quot;&gt;a worthy pursuit&lt;/a&gt;, and so I do not plan to move away from my setup any time soon. Many feel the same, and over the last few months in particular, I have seen a lot &lt;a href=&quot;http://blairreeves.me/2019/03/08/taking-control-of-your-internet/&quot;&gt;more people&lt;/a&gt; express this on &lt;a href=&quot;http://john.ankarstrom.se/html/&quot;&gt;websites of their own&lt;/a&gt;. I would like to add my voice to theirs today.&lt;/p&gt;
&lt;p&gt;I started thinking about this a few months ago, after reading a since-deleted article on Medium. Its author had a few reasons for leaving the platform, a lack of control over his work primary amongst them. His piece reminded of the reasons I went this route a long time ago, and the reasons I stick with it today. I have touched on them a &lt;a href=&quot;https://zacs.site/blog/why-i-write-in-plain-text.html&quot;&gt;couple&lt;/a&gt; &lt;a href=&quot;https://zacs.site/blog/my-setup-2019.html&quot;&gt;times&lt;/a&gt; before, but today I want to spend an entire article on the subject.&lt;/p&gt;
&lt;p&gt;First, let me clarify what “run your own website” means. Under my definition, you must have 1) total control over your content, and 2) the ability to make it public or private at any time. This excludes Medium, for example, because the company owns all the content you publish there. It can also exclude hosted engines like Blogger: if you come back to writing &lt;a href=&quot;https://zacs.site/blog/the-last-four-years.html&quot;&gt;after a four year break&lt;/a&gt; to find your host shuttered, you may no longer have the ability to manage that work. Good backups can mitigate this risk, though, so you do not have to start from zero. Of course, you may go to the other extreme and &lt;a href=&quot;https://zacs.site/blog/re-introducing-first-crack.html&quot;&gt;write your own blogging engine&lt;/a&gt; that &lt;a href=&quot;https://zacs.site/blog/first-crack-release-notes-0619.html&quot;&gt;builds a site&lt;/a&gt; you can &lt;a href=&quot;https://zacs.site/blog/dont-use-amazon-web-services.html&quot;&gt;upload to any web server&lt;/a&gt;, but you do not have to.&lt;/p&gt;
&lt;p&gt;No matter how you go about it, you should run your own website. You should have total control over your content and the ability to make it public or private at any time, for these reasons in particular:&lt;/p&gt;

&lt;p&gt;At a high level, I think of my website as a resume. Anyone who wants to know more about me, or wants to see &lt;a href=&quot;https://zacs.site/projects.html&quot;&gt;examples of my work&lt;/a&gt;, can come &lt;a href=&quot;https://zacs.site/&quot;&gt;here&lt;/a&gt;. Use your website to give potential employers and new acquaintances a polished first impression. You can also use it to streamline information sharing: when CADD came up with my boss, I wrote down &lt;a href=&quot;https://zacs.site/projects.html&quot;&gt;the URL to my projects page&lt;/a&gt;. He can check it out, or not, and neither of us has to deal with the awkward hassle of emailing models or pictures back and forth.&lt;/p&gt;
&lt;p&gt;I could just have a public Facebook profile, and post all my projects on Medium. The idea of telling my boss to “Just look me up on Facebook”, though, or of seeing a company bundle my hard work into a package for profit, does not appeal to me.&lt;/p&gt;

&lt;p&gt;I also like to think of my website as a record. When I read something interesting, I write about it — some times in great detail, other times with a simple note about the part that made it worth reading. Some posts just have &lt;a href=&quot;https://zacs.site/blog/git-home.html&quot;&gt;handy snippets that I can pull out to use on other machines&lt;/a&gt;. I may also write about complex subjects to clarify, condense, and record my thoughts on a topic, or to teach me something new. I can then refer back to these documents, and point others to them as well.&lt;/p&gt;
&lt;p&gt;This has proven more useful than I thought possible. In particular, a record of my thoughts on complex topics has come in handy. When those subjects come up, rather than re-hash a messy thought process, I can use these well-structured, well-reasoned, and — perhaps most important — well-researched documents to guide the conversation.&lt;/p&gt;
&lt;p&gt;When I started writing this, I planned to have more reasons for running your own website. In broad strokes, though, this about covers it: run your own website to make a great first impression, and to streamline information sharing. Whether talking to a new boss or trying to show off one a cool project, this will make your life much easier. You will find a whole host of other, &lt;a href=&quot;http://blairreeves.me/2019/01/10/yes-you-should-blog/&quot;&gt;less tangible benefits&lt;/a&gt; in this hobby, but I will leave them for you to discover on your own.&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 13:26:14 +0000</pubDate>
<dc:creator>zacssite</dc:creator>
<og:image>favicon.ico</og:image>
<og:title>Run Your Own Website -</og:title>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://zacs.site/blog/own-your-platform.html</dc:identifier>
</item>
<item>
<title>Understanding Kafka with Factorio</title>
<link>https://hackernoon.com/understanding-kafka-with-factorio-74e8fc9bf181</link>
<guid isPermaLink="true" >https://hackernoon.com/understanding-kafka-with-factorio-74e8fc9bf181</guid>
<description>&lt;div class=&quot;uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup&quot;&gt;
&lt;div class=&quot;u-flex0&quot;&gt;&lt;a class=&quot;link u-baseColor--link avatar&quot; href=&quot;https://hackernoon.com/@ruurtjan?source=post_header_lockup&quot; data-action=&quot;show-user-card&quot; data-action-source=&quot;post_header_lockup&quot; data-action-value=&quot;ee6f5293f7&quot; data-action-type=&quot;hover&quot; data-user-id=&quot;ee6f5293f7&quot; data-collection-slug=&quot;hacker-daily&quot; dir=&quot;auto&quot;&gt;&lt;img src=&quot;https://cdn-images-1.medium.com/fit/c/100/100/1*uLt7KmAcmllD88BlXmYfnQ.jpeg&quot; class=&quot;avatar-image u-size50x50&quot; alt=&quot;Go to the profile of Ruurtjan Pul&quot;/&gt;&lt;/a&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;p name=&quot;4d72&quot; id=&quot;4d72&quot; class=&quot;graf graf--p graf-after--h3&quot;&gt;&lt;em class=&quot;markup--em markup--p-em&quot;&gt;Thanks to&lt;/em&gt; &lt;a href=&quot;https://medium.com/@tomderuijter&quot; data-href=&quot;https://medium.com/@tomderuijter&quot; data-anchor-type=&quot;2&quot; data-user-id=&quot;ac5a5df4d1a6&quot; data-action-value=&quot;ac5a5df4d1a6&quot; data-action=&quot;show-user-card&quot; data-action-type=&quot;hover&quot; class=&quot;markup--user markup--p-user&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;markup--em markup--p-em&quot;&gt;Tom de Ruijter,&lt;/em&gt;&lt;/a&gt; &lt;a href=&quot;https://medium.com/@steven.reitsma&quot; data-href=&quot;https://medium.com/@steven.reitsma&quot; data-anchor-type=&quot;2&quot; data-user-id=&quot;9fdf9ae0d8fd&quot; data-action-value=&quot;9fdf9ae0d8fd&quot; data-action=&quot;show-user-card&quot; data-action-type=&quot;hover&quot; class=&quot;markup--user markup--p-user&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;markup--em markup--p-em&quot;&gt;Steven Reitsma&lt;/em&gt;&lt;/a&gt; &lt;em class=&quot;markup--em markup--p-em&quot;&gt;and&lt;/em&gt; &lt;a href=&quot;https://twitter.com/laurenskoppenol&quot; data-href=&quot;https://twitter.com/laurenskoppenol&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;&lt;em class=&quot;markup--em markup--p-em&quot;&gt;Laurens Koppenol&lt;/em&gt;&lt;/a&gt; &lt;em class=&quot;markup--em markup--p-em&quot;&gt;for proof reading this post.&lt;/em&gt;&lt;/p&gt;
&lt;p name=&quot;a0ee&quot; id=&quot;a0ee&quot; class=&quot;graf graf--p graf-after--p&quot;&gt;While playing &lt;a href=&quot;https://www.factorio.com/&quot; data-href=&quot;https://www.factorio.com/&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;Factorio&lt;/a&gt; the other day, I was struck by the many similarities with &lt;a href=&quot;https://kafka.apache.org/&quot; data-href=&quot;https://kafka.apache.org/&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;Apache Kafka&lt;/a&gt;. If you aren’t familiar with them: Factorio is an open-world RTS where you build and optimize supply chains in order to launch a satellite and restore communications with your home planet, and Kafka is a distributed streaming platform, which handles asynchronous communication in a durable way.&lt;/p&gt;
&lt;p name=&quot;7dd5&quot; id=&quot;7dd5&quot; class=&quot;graf graf--p graf-after--p&quot;&gt;I wonder how far we can take the analogy between Factorio and Kafka before it starts to break down. Let’s start from scratch, explore the core Kafka concepts through Factorio visualizations, and have some fun along the way.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;0*4pqsIxKItolPfHRT.jpg&quot; data-width=&quot;851&quot; data-height=&quot;314&quot; data-is-featured=&quot;true&quot; data-action=&quot;zoom&quot; data-action-value=&quot;0*4pqsIxKItolPfHRT.jpg&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/0*4pqsIxKItolPfHRT.jpg&quot;/&gt;&lt;/div&gt;
If you don’t have a lot of time to spare, don’t download Factorio.
&lt;h4 name=&quot;e1ae&quot; id=&quot;e1ae&quot; class=&quot;graf graf--h4 graf-after--figure&quot;&gt;Why bother with async messaging?&lt;/h4&gt;
&lt;p name=&quot;8292&quot; id=&quot;8292&quot; class=&quot;graf graf--p graf-after--h4&quot;&gt;Let’s say we have three microservices. One for mining iron ore, one for smelting iron ore into iron plates, and one for producing iron gear wheels from these plates. We can chain these services with synchronous HTTP calls. Whenever our mining drill has new iron ore, it does a POST call on the smelting furnace, which in turn POSTs to the factory.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*VxPctzCiJHYH0H_UWAE6Mw.gif&quot; data-width=&quot;700&quot; data-height=&quot;248&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*VxPctzCiJHYH0H_UWAE6Mw.gif&quot;/&gt;&lt;/div&gt;
From left to right: mining, smelting and producing — tightly coupled via synchronous communication
&lt;p name=&quot;c2d1&quot; id=&quot;c2d1&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;This setup served us well, until there was a power outage in the factory. The furnace’s HTTP calls failed, causing the mining drill’s calls to fail as well. We can implement &lt;a href=&quot;https://martinfowler.com/bliki/CircuitBreaker.html&quot; data-href=&quot;https://martinfowler.com/bliki/CircuitBreaker.html&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;circuit breakers&lt;/a&gt; and retries to prevent cascading failures and message loss, but at some point we’ll have to stop trying, or we’ll run out of memory.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*ybhZGVD1oWfxT_QfFIeGCA.gif&quot; data-width=&quot;700&quot; data-height=&quot;250&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*ybhZGVD1oWfxT_QfFIeGCA.gif&quot;/&gt;&lt;/div&gt;
Power outage at the factory
&lt;p name=&quot;b3c9&quot; id=&quot;b3c9&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;If only there was a way to decouple these microservices... This is, of course, where Kafka comes in. With Kafka, you can store streams of records in a fault-tolerant and durable way. In Kafka terminology, these streams are called &lt;em class=&quot;markup--em markup--p-em&quot;&gt;topics&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*XUZUg7DlOZy5fItePjYgPg.gif&quot; data-width=&quot;700&quot; data-height=&quot;183&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*XUZUg7DlOZy5fItePjYgPg.gif&quot;/&gt;&lt;/div&gt;
Microservices decoupled by asynchronous messaging
&lt;p name=&quot;1cf3&quot; id=&quot;1cf3&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;With asynchronous topics between services, messages, or &lt;em class=&quot;markup--em markup--p-em&quot;&gt;records&lt;/em&gt;, are buffered during peak loads, and when there is an outage. These buffers obviously have limited capacity, so let’s talk about scalability.&lt;/p&gt;
&lt;p name=&quot;4521&quot; id=&quot;4521&quot; class=&quot;graf graf--p graf-after--p&quot;&gt;We can increase storage capacity and throughput by adding Kafka servers to the cluster. Another way is to increase disk size (for storage), or CPU and network speed (for throughput). Which of these options give you the best value for money is use-case specific, but buying &lt;em class=&quot;markup--em markup--p-em&quot;&gt;bigger&lt;/em&gt; servers — unlike buying &lt;em class=&quot;markup--em markup--p-em&quot;&gt;more&lt;/em&gt; servers — is subject to &lt;a href=&quot;https://en.wikipedia.org/wiki/Diminishing_returns&quot; data-href=&quot;https://en.wikipedia.org/wiki/Diminishing_returns&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;the law of diminishing returns&lt;/a&gt;. Kafka’s capacity scales linearly with each node added, so that’s usually the way to go.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*pVoHlF2FfMoHw0WOuUoZmg.gif&quot; data-width=&quot;700&quot; data-height=&quot;248&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*pVoHlF2FfMoHw0WOuUoZmg.gif&quot;/&gt;&lt;/div&gt;
Vertical scaling — a bigger, exponentially more expensive server
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*kZe05DbF2yYm43INu07Ecw.gif&quot; data-width=&quot;700&quot; data-height=&quot;248&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*kZe05DbF2yYm43INu07Ecw.gif&quot;/&gt;&lt;/div&gt;
Horizontal scaling — distribute the load over more servers
&lt;p name=&quot;cba8&quot; id=&quot;cba8&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;To divide a topic between multiple servers, we need a way to split a topic into smaller substreams. These substreams are called &lt;em class=&quot;markup--em markup--p-em&quot;&gt;partitions.&lt;/em&gt; Whenever a service &lt;em class=&quot;markup--em markup--p-em&quot;&gt;produces&lt;/em&gt; a new record, this service gets to decide which partition the record should land on.&lt;/p&gt;
&lt;div class=&quot;aspectRatioPlaceholder is-locked&quot;&gt;

&lt;img class=&quot;graf-image&quot; data-image-id=&quot;1*Qe4n06aC_PxpbS6s9MoiMw.gif&quot; data-width=&quot;275&quot; data-height=&quot;456&quot; src=&quot;https://cdn-images-1.medium.com/max/1600/1*Qe4n06aC_PxpbS6s9MoiMw.gif&quot;/&gt;&lt;/div&gt;
A wagon producing records, a partitioner that puts messages on the right partition, and a topic with four partitions.
&lt;p name=&quot;07ee&quot; id=&quot;07ee&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;The &lt;a href=&quot;https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/producer/internals/DefaultPartitioner.java#L69&quot; data-href=&quot;https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/producer/internals/DefaultPartitioner.java#L69&quot; class=&quot;markup--anchor markup--p-anchor&quot; rel=&quot;noopener&quot; target=&quot;_blank&quot;&gt;default &lt;em class=&quot;markup--em markup--p-em&quot;&gt;partitioner&lt;/em&gt;&lt;/a&gt; hashes the message key and modulos that over the number of partitions:&lt;/p&gt;

&lt;p name=&quot;44f4&quot; id=&quot;44f4&quot; class=&quot;graf graf--p graf-after--figure&quot;&gt;That way messages with the same key always end up on the same partition.&lt;/p&gt;
&lt;p name=&quot;8c62&quot; id=&quot;8c62&quot; class=&quot;graf graf--p graf-after--p graf--trailing&quot;&gt;Note that messages are only guaranteed to be ordered within the context of a producer and partition. Records from multiple producers, or from a single producer on multiple partitions, can interleave.&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 12:59:18 +0000</pubDate>
<dc:creator>DonHopkins</dc:creator>
<og:title>Understanding Kafka with Factorio</og:title>
<og:url>https://hackernoon.com/understanding-kafka-with-factorio-74e8fc9bf181</og:url>
<og:image>https://cdn-images-1.medium.com/max/1200/0*4pqsIxKItolPfHRT.jpg</og:image>
<og:description>While playing Factorio the other day, I was struck by the many similarities with Apache Kafka.</og:description>
<og:type>article</og:type>
<dc:format>text/html</dc:format>
<dc:identifier>https://hackernoon.com/understanding-kafka-with-factorio-74e8fc9bf181?gi=6dedf45ffb9a</dc:identifier>
</item>
<item>
<title>Raspberry Pi 4 not working with some chargers</title>
<link>https://www.scorpia.co.uk/2019/06/28/pi4-not-working-with-some-chargers-or-why-you-need-two-cc-resistors/</link>
<guid isPermaLink="true" >https://www.scorpia.co.uk/2019/06/28/pi4-not-working-with-some-chargers-or-why-you-need-two-cc-resistors/</guid>
<description>&lt;p&gt;The new pi has been released and it has a USB Type-C connector for power however people are finding some chargers are not working with it (notably macbook chargers). Some have speculated that this is due to a manufacturer limitation on the power supplies however it is actually due to the incorrect detection circuitry on the Pi end of the USB connection.&lt;/p&gt;
&lt;p&gt;For those looking for a solution for the problem and and aren’t interested in the technical details a set of potential solutions are given at the end of this post&lt;/p&gt;
&lt;p&gt;The root cause of the problem is the shared cc pull down resistor on the USB Type-C connector. looking at the &lt;a href=&quot;https://www.raspberrypi.org/documentation/hardware/raspberrypi/schematics/rpi_SCH_4b_4p0_reduced.pdf&quot;&gt;reduced pi schematics&lt;/a&gt; we can see it as R79 which connects to both the CC lines in the connector.&lt;/p&gt;
&lt;div class=&quot;wp-block-image&quot;&gt;&lt;img src=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image.png&quot; alt=&quot;&quot; class=&quot;wp-image-44&quot; width=&quot;288&quot; height=&quot;279&quot; srcset=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image.png 647w, https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-300x292.png 300w&quot; sizes=&quot;(max-width: 288px) 100vw, 288px&quot;/&gt;Excerpt from the reduced Pi4 Model B schematics.&lt;/div&gt;
&lt;div class=&quot;wp-block-image&quot;&gt;&lt;img src=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/07/Pi_CC_resistors.png&quot; alt=&quot;&quot; class=&quot;wp-image-61&quot;/&gt;Pi CC resistor locations&lt;/div&gt;
&lt;p&gt;With most chargers this wont be an issue as basic cables only use one CC line which is connected through the cable and as a result the pi will be detected correctly and receive power. The problem comes in with e-marked cables which use both CC connections. To understand this lets look at the &lt;a href=&quot;https://www.usb.org/document-library/usb-type-ctm-cable-and-connector-specification-revision-14-march-29-2019&quot;&gt;Type C specification document&lt;/a&gt;.&lt;/p&gt;
&lt;img src=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-1.png&quot; alt=&quot;&quot; class=&quot;wp-image-45&quot; srcset=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-1.png 694w, https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-1-300x134.png 300w, https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-1-660x296.png 660w&quot; sizes=&quot;(max-width: 694px) 100vw, 694px&quot;/&gt;Excerpt from the Type-C spec (Figure 4-5)
&lt;p&gt;Per the spec the source device doesn’t provide power on the connector until it detects a sink device being attached. which is done by the presence of the Rd resistor (5.1K ohms) to ground. Active cables also signal their presence using another value or resistor Ra (800 ohms – 1200 ohms). The Type-C specification has a table for looking up what is connected based on the state of the CC lines.&lt;/p&gt;
&lt;div class=&quot;wp-block-image&quot;&gt;&lt;img src=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-2.png&quot; alt=&quot;&quot; class=&quot;wp-image-46&quot; srcset=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-2.png 736w, https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-2-300x185.png 300w, https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-2-660x406.png 660w&quot; sizes=&quot;(max-width: 736px) 100vw, 736px&quot;/&gt;&lt;br/&gt;Excerpt from the Type-C spec (Figure 4-10)&lt;/div&gt;
&lt;p&gt;In the correct operation the charger will sense the Rd resistor (Or Rd Ra cobination) and turn on the power. The problem comes when an active cable which presents an Ra at both ends is used. On the source side one CC pin will be connected to the Ra resistor in the cable and the other to the CC line to the Pi. The Pi has connected both lines together so presents the combination of the Ra at the pi end of the cable and the Rd pulldown. Calculating the presented resistance assuming a average value of Ra still gives a value well within the Ra range (also note Ra resistances are permitted to go below 800 when cable electronics are drawing power so a resistance lower than 800 will also likely be detected as Ra).&lt;/p&gt;
&lt;div class=&quot;wp-block-image&quot;&gt;&lt;img src=&quot;https://www.scorpia.co.uk/wp-content/uploads/2019/06/image-5.png&quot; alt=&quot;&quot; class=&quot;wp-image-55&quot;/&gt;&lt;br/&gt;Pi’s presented resistance&lt;/div&gt;
&lt;p&gt;With effectively two Ra values presented to the Source end it will detect the Pi as an “Audio Adaptor Accessory”. These are analogue audio interfaces to allow for headphones to be connected to phones for example (although some phones use headphones/adaptors with inbuilt sound-cards which appear as USB devices). The audio adaptor accessory also allows the phone to be charged through the adaptor. This means the the device should not provide power on the Vbus pins which means no power for the Pi.&lt;/p&gt;
&lt;p&gt;In order to test this I attempted to power the pi with a macbook charger and its e-marked cable and it didn’t receive power. Two other chargers (a pixel 3 charger and an office electrics desk charger) where tested with the macbooks active cable and none powered the pi. When tested with a non a couple of non e-marked cables the pi was powered by all the chargers. This lines up with what is expected.&lt;/p&gt;
&lt;p&gt;With regards to manufacturer limitations it is possible for chargers and devices to &lt;a href=&quot;https://thenextweb.com/plugged/2019/01/03/new-usb-c-protocol-could-save-your-devices-from-faulty-chargers/&quot;&gt;limit which devices they will use&lt;/a&gt; however this is only applicable for power deliver modes (higher voltages and currents) as the basic detection doesn’t give scope for such communication to occur.&lt;/p&gt;
&lt;p&gt;While this write-up focuses on units with detachable e marked cables as this has a clear set of detection steps when the CC lines are shorted. the problem could also happen with integrated cables if they are interfacing with both CC lines and dislike them being connected.&lt;/p&gt;
&lt;p&gt;Now onto some solutions. Assuming the issue you are having is caused by the problem discussed above, using a non e-marked cable (most USB-C phone charger cables are likely this type) rather than an e-marked cable (many laptop charger/thunderbolt cables and any 5A capable cable will be in this category) will allow for the pi to be powered. In addition using older chargers with A-C cables or micro B to C adaptors will also work if they provide enough power as these don’t require CC detection to provide power. Ultimately though the best solution in the long run will be for there to be a board revision for the pi 4 which adds the 2nd CC resistor and fixes the problem.&lt;/p&gt;
&lt;p&gt;In conclusion. If you want your USB Type-C devices to work correctly then you need to have two independent CC resistors. If you are interested in adding Type-C connector to your project and don’t want to read the whole spec to do so I have previously written &lt;a href=&quot;https://www.scorpia.co.uk/2016/03/17/using-usb-type-c-on-hobyist-projects/&quot;&gt;a guide&lt;/a&gt; on how to do so&lt;/p&gt;
&lt;p&gt;updates&lt;br/&gt;* 2019/06/28: Added additional information on solutions.&lt;br/&gt;* 2019/07/04: Added test results and checked details on a pi.&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 12:20:44 +0000</pubDate>
<dc:creator>styx31</dc:creator>
<dc:language>en-GB</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://www.scorpia.co.uk/2019/06/28/pi4-not-working-with-some-chargers-or-why-you-need-two-cc-resistors/</dc:identifier>
</item>
<item>
<title>Is this Paypal experience customary?</title>
<link>https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</link>
<guid isPermaLink="true" >https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</guid>
<description>&lt;p&gt;Here is a succinct timeline of the events.&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;I received a Paypal notification that 600 USD were deposited on my account.&lt;/li&gt;
&lt;li&gt;I was not expecting any money, so I logged in to see what this is about.&lt;/li&gt;
&lt;li&gt;Apparently someone paid me for an item they bought on Ebay.&lt;/li&gt;
&lt;li&gt;The information contained on my Paypal account about the transaction, did NOT contain any information on what this is about.&lt;/li&gt;
&lt;li&gt;I am NOT an Ebay seller, so I have nothing else to follow this up.&lt;/li&gt;
&lt;li&gt;My first thought (apart from quickly spending the money) was that some poor soul after thinking that they have paid for an item they would wait for ever for an item they thought they purchased, only to never receive it.&lt;/li&gt;
&lt;li&gt;So I spent some considerable amount of time trying to locate the seller from their name only (did not have an email) by googling around, to clarify the issue&lt;/li&gt;
&lt;li&gt;As it was getting late, I left the issue to continue the next day.&lt;/li&gt;
&lt;li&gt;The next day, I logged in to Paypal to lookup for any additional details to help me locate the person, only to see that the Payment had been refunded.&lt;/li&gt;
&lt;li&gt;But I had not received ANY notification from Paypal that a refund was issued from my account.&lt;/li&gt;
&lt;li&gt;I'm kind of sensitive of &quot;secret&quot; transactions taking place, especially when by balance is being decreased WITHOUT me being notified.&lt;/li&gt;
&lt;li&gt;So I opened an issue with Paypal, requesting why I was not notified about the refund taking place.&lt;/li&gt;
&lt;li&gt;After waiting for some days, I got a reply from Payal that mentioned verbatim: &quot;After reviewing carefully your account again, I am afraid to confirm to you that you accessed to the account and actioned the refund to your buyer.&quot;&lt;/li&gt;
&lt;li&gt;That got me going, since I did NO such thing, and I considered it very rude that they will insinuate that &lt;em&gt;I&lt;/em&gt; performed the refund. And the authority by which the insisted &lt;em&gt;I&lt;/em&gt; performed the action was really infuriating.&lt;/li&gt;
&lt;li&gt;They also closed my issue NOT allowing me to reply.&lt;/li&gt;
&lt;li&gt;I opened another issue explaining that this is NOT the case and to further investigate what happened.&lt;/li&gt;
&lt;li&gt;After another maount of days I received a call on my phone trying to resolve the issue.&lt;/li&gt;
&lt;li&gt;The lady refused to discuss what kind of information they had online about ME performing the refund, but insisted that the refund was rightfully did so, since this was an erroneous deposit by the buyer.&lt;/li&gt;
&lt;li&gt;I tried very politely to explaing the issue was NOT regarding the refund itself but rather on the lack of notification from Paypal that a refund HAD taken place.&lt;/li&gt;
&lt;li&gt;I was simply unable to explain this concept to the lady, that she danced around the issue and putting the whole blame on Ebay that THEY should have been the ones to notify me, since Paypal was not aware of any refunds taking place on my account!!!&lt;/li&gt;
&lt;li&gt;After trying countless (and admittedly getting really frustrated from the stubborness of the Paypal representative to speak in straight terms) times to explain that I am expecting from Paypal to notify me every time my balance is modified (something that they do when you receive money, but not when money is removed, as in my case) she refused to accept the fact that the responsibility falls within Paypal and she put the responsibility on the third party Paypal partners that initiated the refund, as, once again, &quot;Paypal is not aware of these refund transactions&quot;&lt;/li&gt;
&lt;li&gt;After telling her, that I was not satisfied with the resolution of the issue, we ended the phone call with her suggestion to take the issue to another organization &quot;outside&quot; Paypal as Paypal had not considered this to be a real issue.&lt;/li&gt;
&lt;li&gt;I requested to receive an official reply from Paypal stating all the things we discused about (I was hearing her type while we were discussing) and I recieved an email immediately after, that JUST mentioned: &quot;I am sorry for this inconvenience; however, PayPal did not proceed the refund. Please contact eBay directly about this matter. All complaints against PayPal can be further referred for independent arbitration to the following bodies:&quot; listing some consumer protection organizations&lt;/li&gt;
&lt;li&gt;Apart from the mispelled &quot;proceed&quot; that I guess means, &quot;process&quot; the issue was once again locked, without ability to reply in order to clarify it.&lt;/li&gt;
&lt;li&gt;To top it of, the next day, and after almost two weeks since the refund to place (but only one day after the long phone discussion) my account was blocked as &quot;suspicious&quot; activity and in order to unblock it I will have to provide original product receipts of the product I was &quot;selling&quot;, something that I do not have as I do not even know what I was selling!&lt;/li&gt;
&lt;li&gt;At this point I give up trying to put a resolution to this issue and more likely I will be closing my Paypal acount (it's not like Paypal will miss me, I know, I would just feel too &quot;dirty&quot; to keep it open after all that happened)&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Is treatment like this something common in Paypal...?&lt;/p&gt;
&lt;p&gt;I am so happy that I do NOT really use or depend on Paypal for anyting important, apart from an occasional purchase (I must have done like 4-5 in the last 20 years I have the account)&lt;/p&gt;
&lt;p&gt;I feel so offended being treated as a criminal, when I am obviously in open communication with them since day one, and I was always cooperating to resolve the issue, without actually making any actual demands from them, apart from asking for proper communication on their part to know when and where my money are going while in their system.&lt;/p&gt;
&lt;p&gt;It seems this is the least amount of work they are willing to do, starting with sloppy investigation that I was the one performing the refund, to the fact that they go after their own customers (easy to find, they have all the required info), and actually customers that actively participate in discussion with them. I guess it's easier to pretend they fight crime when they just target the easier target they can find.&lt;/p&gt;
&lt;p&gt;For whoever read that far, thanks for letting me vent this out!&lt;/p&gt;
&lt;p&gt;[EDIT]:&lt;/p&gt;
&lt;p&gt;I got a reply from Paypal why they treat me like I'm the criminal.&lt;/p&gt;
&lt;p&gt;It reads (a very polite):&lt;/p&gt;
&lt;hr/&gt;&lt;blockquote&gt;
&lt;p&gt;Dear MyName,&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Thank you for your contacting us. We understand your frustration however, for us to be able to fully restore your PayPal account we need you to complete the below step. Please follow the instructions below:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;You need to verify your identity by providing us with a copy of a government-issued photo ID, such as a passport or driver's licence (the plastic card, not the official letter).&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;It must show your date of birth, as well as the issue date and expiry date. The full document needs to be visible. We cannot accept partial documents.&lt;/p&gt;
&lt;p&gt;To upload:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt; 1. Log in to your PayPal account at www.paypal.co.uk
 2. Click 'Tools' at the top of the page and select 'Resolution Centre' from the drop-down menu.
 3. Under 'Steps to Remove Limitation', click 'Resolve'.
&lt;/code&gt;
&lt;/pre&gt;
&lt;p&gt;Yours sincerely,&lt;/p&gt;
&lt;p&gt;Maria&lt;/p&gt;
&lt;p&gt;PayPal Account Review Department&lt;/p&gt;
&lt;hr/&gt;&lt;p&gt;I've had that account since 1997, 1998ish...? I am also Greek, and our IDs do NOT have expiration dates. I do not want to even consider the case of explaining this to them.&lt;/p&gt;
&lt;p&gt;I went the polite way and told them to go fondle themselves (didn't want to be labeled vulgar, too) and I closed the account. I deeply regret for being proud having a Paypal account for that long!&lt;/p&gt;
&lt;p&gt;[EDIT #2]:&lt;/p&gt;
&lt;p&gt;After the &quot;fondle yourselves&quot; reply I tried to close my account, but apparently I'm not allowed to do that as I get a:&lt;/p&gt;
&lt;pre&gt;
&lt;code&gt;Before you close your account

It seems that there's a problem. Please try again later.
&lt;/code&gt;
&lt;/pre&gt;</description>
<pubDate>Fri, 05 Jul 2019 09:36:04 +0000</pubDate>
<dc:creator>stratosgear</dc:creator>
<og:image>https://avatars2.githubusercontent.com/u/193463?s=400&amp;v=4</og:image>
<og:type>article</og:type>
<og:title>Ask HN: Is this Paypal experience customary?</og:title>
<og:url>https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</og:url>
<og:description>Ask HN: Is this Paypal experience customary? GitHub Gist: instantly share code, notes, and snippets.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</dc:identifier>
</item>
<item>
<title>The most effective way to tackle climate change? Plant a trillion trees</title>
<link>https://edition.cnn.com/2019/04/17/world/trillion-trees-climate-change-intl-scn/index.html</link>
<guid isPermaLink="true" >https://edition.cnn.com/2019/04/17/world/trillion-trees-climate-change-intl-scn/index.html</guid>
<description>[unable to retrieve full-text content]
&lt;p&gt;Article URL: &lt;a href=&quot;https://edition.cnn.com/2019/04/17/world/trillion-trees-climate-change-intl-scn/index.html&quot;&gt;https://edition.cnn.com/2019/04/17/world/trillion-trees-climate-change-intl-scn/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comments URL: &lt;a href=&quot;https://news.ycombinator.com/item?id=20360513&quot;&gt;https://news.ycombinator.com/item?id=20360513&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Points: 203&lt;/p&gt;
&lt;p&gt;# Comments: 178&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 07:22:36 +0000</pubDate>
<dc:creator>woutgaze</dc:creator>
<og:image>https://avatars2.githubusercontent.com/u/193463?s=400&amp;v=4</og:image>
<og:type>article</og:type>
<og:title>Ask HN: Is this Paypal experience customary?</og:title>
<og:url>https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</og:url>
<og:description>Ask HN: Is this Paypal experience customary? GitHub Gist: instantly share code, notes, and snippets.</og:description>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://gist.github.com/stratosgear/6923623321adacd368e965ff193fe2ce</dc:identifier>
</item>
<item>
<title>How FZF and ripgrep improved my workflow</title>
<link>https://medium.com/@sidneyliebrand/how-fzf-and-ripgrep-improved-my-workflow-61c7ca212861</link>
<guid isPermaLink="true" >https://medium.com/@sidneyliebrand/how-fzf-and-ripgrep-improved-my-workflow-61c7ca212861</guid>
<description>&lt;div readability=&quot;4.9&quot;&gt;

&lt;div class=&quot;gx&quot;&gt;
&lt;div class=&quot;ah ag&quot;&gt;
&lt;div&gt;
&lt;div class=&quot;cu gy gz&quot;&gt;&lt;img alt=&quot;Sidney Liebrand&quot; src=&quot;https://miro.medium.com/fit/c/96/96/0*m3clG2o3r6Z156PY.&quot; class=&quot;n dv gz gy&quot; width=&quot;48&quot; height=&quot;48&quot;/&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Today I want to talk about &lt;a href=&quot;https://github.com/junegunn/fzf&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fzf&lt;/a&gt; and &lt;a href=&quot;https://github.com/BurntSushi/ripgrep&quot; class=&quot;aq cc if ig ih ii&quot;&gt;ripgrep&lt;/a&gt;, two tools I use all the time when working in Vim and the terminal. They have become an absolutely &lt;strong class=&quot;ht ij&quot;&gt;vital&lt;/strong&gt; part of my workflow. Ever since I started using them I can’t imagine myself functioning without them anymore.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;FZF is a fuzzy finder for your terminal, it is a command line application that filters each line from given input with a query that the user types. When the query changes, the results update in realtime.&lt;/p&gt;

FZF + LS example
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;After finding the file you’re looking for, hitting &lt;code class=&quot;jl ju jv jw b&quot;&gt;enter&lt;/code&gt; prints the highlighted entry. You can combine this with your &lt;code class=&quot;jl ju jv jw b&quot;&gt;$EDITOR&lt;/code&gt; variable to search for- and edit a file for example.&lt;/p&gt;

Open CHANGELOG.md in NeoVim
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Of course this is only a simple example. The possibilities with FZF are endless. There are countless ways in which you can use it filter input and use that in another command. We’ll dive more into that later.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;As it already says in the name, it is another &lt;code class=&quot;jl ju jv jw b&quot;&gt;grep&lt;/code&gt; program. Ripgrep is written in rust and one of its primary goals is to be the &lt;em class=&quot;jx&quot;&gt;fastest&lt;/em&gt; &lt;code class=&quot;jl ju jv jw b&quot;&gt;grep&lt;/code&gt; of them all. It performs amazing even in a larger code base.&lt;/p&gt;

Ripgrep list files with FZF
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Ripgrep has many options to explore, there are way to many to list here.&lt;br/&gt;Some of the options I use most often with ripgrep are:&lt;br/&gt;&lt;/p&gt;
&lt;ul class=&quot;&quot;&gt;&lt;li class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;--files&lt;/code&gt; — List files which ripgrep will search instead of searching them&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;--hidden&lt;/code&gt; — Show hidden (&lt;code class=&quot;jl ju jv jw b&quot;&gt;.file&lt;/code&gt;) files&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;--no-ignore-vcs&lt;/code&gt; — Show files ignored by your VCS&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;--vimgrep&lt;/code&gt; — Results are returned on a single line in vimgrep format&lt;/li&gt;
&lt;/ul&gt;
&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Both these tools can be combined in various scenario’s that would have otherwise taken multiple long commands to execute. This ranges from killing processes to managing plugins to being able to find (in) files.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;These actions are usually involved when I try to do something more complex:&lt;/p&gt;
&lt;ul class=&quot;&quot;&gt;&lt;li class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie jy jz ka&quot;&gt;googling the right command&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;look around for the right line in the output&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;refine grep pattern&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;retrying the command&lt;/li&gt;
&lt;/ul&gt;&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;At this point you’ll realize that you’re not actually searching for something anymore. You find yourself looking for ways to perform your search instead :/ This is only one of many scenarios however. Another common one is:&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;One example is stopping an out of control process. First you have to find the process ID by issuing some command like:&lt;/p&gt;
&lt;pre class=&quot;jc jd je jf jg gb do kg&quot;&gt;
&lt;span class=&quot;kh il eq bh jw b df ki kj n kk&quot;&gt;$ ps -ef &lt;br/&gt;grep [PROCESS NAME]&lt;br/&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Which is then followed by a &lt;code class=&quot;jl ju jv jw b&quot;&gt;kill&lt;/code&gt; command with one of the process IDs you want to kill. The downsides to this are that I have to use two commands. Filter the output before seeing it or knowing how it looks and issuing an extra command to actually stop the process.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;To make this easier, I wrote a small wrapper (first in &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/kp&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, later migrated to &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/kp.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;) called &lt;code class=&quot;jl ju jv jw b&quot;&gt;kp&lt;/code&gt;. It lists processes using &lt;code class=&quot;jl ju jv jw b&quot;&gt;ps -ef&lt;/code&gt; and pipes it to &lt;code class=&quot;jl ju jv jw b&quot;&gt;fzf&lt;/code&gt;.&lt;/p&gt;

Kill something with kp command
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;This command opens an FZF window with your processes. FZF has an option to allow selecting multiple entries (&lt;code class=&quot;jl ju jv jw b&quot;&gt;-m&lt;/code&gt; flag). When &lt;code class=&quot;jl ju jv jw b&quot;&gt;enter&lt;/code&gt; is pressed, both marked (light red &lt;code class=&quot;jl ju jv jw b&quot;&gt;&amp;gt;&lt;/code&gt; symbols) processes will be shut down. When changing your query, selected entries will stay selected. This is convenient for killing different processes in a single run.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;After killing some processes, the command will rerun itself. I can use &lt;code class=&quot;jl ju jv jw b&quot;&gt;escape&lt;/code&gt; to exit from this specific window.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Another use case is to install, update or purge &lt;a href=&quot;https://github.com/Homebrew&quot; class=&quot;aq cc if ig ih ii&quot;&gt;brew&lt;/a&gt; plugins from your system. When you are looking for a brew package, a common pattern is to use &lt;code class=&quot;jl ju jv jw b&quot;&gt;brew search&lt;/code&gt; together with &lt;code class=&quot;jl ju jv jw b&quot;&gt;grep&lt;/code&gt; to find out if it exists.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;After that you’ll most likely run a command like: &lt;code class=&quot;jl ju jv jw b&quot;&gt;brew install [PACKAGE]&lt;/code&gt; to install it. Another pattern is to use the &lt;code class=&quot;jl ju jv jw b&quot;&gt;brew leaves&lt;/code&gt; command to list installed packages which can be updated or removed.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;I created a small wrapper for each of these actions. One for installing, another for updating and one for deleting brew packages:&lt;/p&gt;
&lt;ul class=&quot;&quot;&gt;&lt;li class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;bip&lt;/code&gt; — &lt;strong class=&quot;ht ij&quot;&gt;B&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;rew&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;I&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;nstall&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;P&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;lugin,&lt;/em&gt; install one or more plugins (&lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/bip&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/bip.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;)&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;bup&lt;/code&gt; — &lt;strong class=&quot;ht ij&quot;&gt;B&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;rew&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;U&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;pdate&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;P&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;lugin,&lt;/em&gt; update multiple installed plugins (&lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/bup&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/bup.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;)&lt;/li&gt;
&lt;li class=&quot;hr hs eq bh ht b hu kb hw kc hy kd ia ke ic kf ie jy jz ka&quot;&gt;&lt;code class=&quot;jl ju jv jw b&quot;&gt;bcp&lt;/code&gt; — &lt;strong class=&quot;ht ij&quot;&gt;B&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;rew&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;C&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;lean&lt;/em&gt; &lt;strong class=&quot;ht ij&quot;&gt;P&lt;/strong&gt;&lt;em class=&quot;jx&quot;&gt;lugin,&lt;/em&gt; delete multiple installed plugins (&lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/bcp&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/bcp.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Whenever I have to do anything with brew, it is completely painless and it works quite well for package discovery too.&lt;/p&gt;

Brew Install Plugin interface

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;One mythical beast known to anyone who has ever worked in a terminal is the &lt;code class=&quot;jl ju jv jw b&quot;&gt;$PATH&lt;/code&gt; variable. Often, a shell script will tell you to “Add me to your $PATH” so that the script will become available in your shell. This makes sense but can leave you with a messed up shell path or duplicate entries. It could cause all kinds of weirdness and slowness in your terminal.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;My solution to this is a simple path explorer called &lt;code class=&quot;jl ju jv jw b&quot;&gt;fp&lt;/code&gt; (&lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/fp&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/fp.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;). It invokes FZF with a list of folders populated using &lt;code class=&quot;jl ju jv jw b&quot;&gt;$PATH&lt;/code&gt;.&lt;/p&gt;

Directories present in $PATH
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Of course there are more than 3 paths in my list but I cropped the gif for brevity here. When I press &lt;code class=&quot;jl ju jv jw b&quot;&gt;enter&lt;/code&gt; on the&lt;code class=&quot;jl ju jv jw b&quot;&gt;/bin&lt;/code&gt; entry, I see a list of executables inside that folder. Either find what you’re looking for or go back.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Going back to the overview is as easy as pressing &lt;code class=&quot;jl ju jv jw b&quot;&gt;escape&lt;/code&gt;. This will take you back to the directory listing. Pressing &lt;code class=&quot;jl ju jv jw b&quot;&gt;escape&lt;/code&gt; in the overview will exit the command completely.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Additionally, I’ve written a post before on how to &lt;a class=&quot;aq cc if ig ih ii&quot; href=&quot;https://medium.com/@sidneyliebrand/combining-caniuse-with-fzf-fb93ad235bae&quot;&gt;combine Caniuse with FZF&lt;/a&gt;. It allows me to quickly find out wether I should stay away from some Web API or not. this small tool also allows me to query features that have been added or deprecated recently.&lt;/p&gt;

An example of looking for features using caniuse
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;The &lt;code class=&quot;jl ju jv jw b&quot;&gt;cani&lt;/code&gt; command (&lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/d07fa3862ed065c2a5a7f1160ae98416bfe2e1ee/zsh/cani&quot; class=&quot;aq cc if ig ih ii&quot;&gt;zsh&lt;/a&gt;, &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/.config/fish/functions/cani.fish&quot; class=&quot;aq cc if ig ih ii&quot;&gt;fish&lt;/a&gt;) itself uses another &lt;a href=&quot;https://github.com/SidOfc/dotfiles/blob/master/bin/ciu&quot; class=&quot;aq cc if ig ih ii&quot;&gt;ruby script&lt;/a&gt; (&lt;code class=&quot;jl ju jv jw b&quot;&gt;ciu&lt;/code&gt;) I wrote to actually provide the data and format it properly. The data is fetched once then cached for a day. So you’ll have fresh data on a daily basis :)&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;&lt;em class=&quot;jx&quot;&gt;This mixture of shell + ruby has since been&lt;/em&gt; &lt;a href=&quot;https://github.com/SidOfc/cani&quot; class=&quot;aq cc if ig ih ii&quot;&gt;&lt;em class=&quot;jx&quot;&gt;ported&lt;/em&gt;&lt;/a&gt; &lt;em class=&quot;jx&quot;&gt;to a&lt;/em&gt; &lt;a href=&quot;https://rubygems.org/gems/cani&quot; class=&quot;aq cc if ig ih ii&quot;&gt;&lt;em class=&quot;jx&quot;&gt;Ruby Gem&lt;/em&gt;&lt;/a&gt; &lt;em class=&quot;jx&quot;&gt;:)&lt;/em&gt;&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Since I spend a lot of my time in Vim trying to find a file either by name, or by some code &lt;em class=&quot;jx&quot;&gt;inside&lt;/em&gt; a certain file. Streamlining that process is very important. Every context switch you have to make adds overhead and the possibility of losing focus of what you are trying to find. Therefore it should be as mindless as possible, e.g: press a key, type query, press enter to go to matching file.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Finding files wasn’t too much of an issue here. There is a long list of Vim plugins that offer file searching using fuzzy matching or &lt;a href=&quot;https://en.wikipedia.org/wiki/Most_Recently_Used&quot; class=&quot;aq cc if ig ih ii&quot;&gt;MRU&lt;/a&gt; algorithms. Two examples of this are &lt;a href=&quot;https://github.com/ctrlpvim/ctrlp.vim&quot; class=&quot;aq cc if ig ih ii&quot;&gt;CtrlP&lt;/a&gt; and &lt;a href=&quot;https://github.com/wincent/command-t&quot; class=&quot;aq cc if ig ih ii&quot;&gt;Command-T&lt;/a&gt;. I used CtrlP which always managed to do the job. But after playing around with FZF in the terminal I wondered if it could be applied to Vim as well.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;FZF has a small builtin Vim interface that already works, but it comes without any existing functionality. The author of FZF also wrote this plugin. It is a small wrapper that provides common functionality. This includes listing files, buffers, tags, git logs and much more!&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Coming from CtrlP the first thing I needed was a replacement for fuzzy-finding files. The solution was to use the &lt;code class=&quot;jl ju jv jw b&quot;&gt;:Files&lt;/code&gt; command provided by FZF.vim. This lists files using your &lt;code class=&quot;jl ju jv jw b&quot;&gt;$FZF_DEFAULT_COMMAND&lt;/code&gt; environment variable. It opens the currently highlighted file on &lt;code class=&quot;jl ju jv jw b&quot;&gt;enter&lt;/code&gt;.&lt;/p&gt;

FZF :Files demo
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Since I was already so used to the &lt;code class=&quot;jl ju jv jw b&quot;&gt;ctrl-p&lt;/code&gt; mapping from the CtrlP plugin, I mapped the &lt;code class=&quot;jl ju jv jw b&quot;&gt;:Files&lt;/code&gt; command to it like this:&lt;/p&gt;
&lt;pre class=&quot;jc jd je jf jg gb do kg&quot;&gt;
&lt;span class=&quot;kh il eq bh jw b df ki kj n kk&quot;&gt;nnoremap &amp;lt;C-p&amp;gt; :Files&amp;lt;Cr&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;FZF will not use ripgrep by default so you’ll have to modify &lt;code class=&quot;jl ju jv jw b&quot;&gt;$FZF_DEFAULT_COMMAND&lt;/code&gt; if you want FZF to use ripgrep. Of course this is exactly what I wanted! After some tweaking I ended up with the following command (in fish syntax):&lt;/p&gt;
&lt;pre class=&quot;jc jd je jf jg gb do kg&quot;&gt;
&lt;span class=&quot;kh il eq bh jw b df ki kj n kk&quot;&gt;set -gx FZF_DEFAULT_COMMAND  'rg --files --no-ignore-vcs --hidden'&lt;/span&gt;&lt;span class=&quot;kh il eq bh jw b df ks kt ku kv kw kj n kk&quot;&gt;# equivalent bash / zsh:&lt;br/&gt;# export FZF_DEFAULT_COMMAND='rg --files --no-ignore-vcs --hidden'&lt;br/&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;In my case it happens that I do want to edit or search for something in a file that is ignored by my VCS or in a hidden file. The options ensure that all files inside the directory are listed (except those ignored in a &lt;code class=&quot;jl ju jv jw b&quot;&gt;~/.rgignore&lt;/code&gt; file).&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;Last but not least I wanted to find files based on what was inside of a file. This is useful to see where a class or function is used for example.&lt;/p&gt;

FZF :Rg demo
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;The name of this command is &lt;code class=&quot;jl ju jv jw b&quot;&gt;:Ag&lt;/code&gt; and as you can guess, it relies on &lt;code class=&quot;jl ju jv jw b&quot;&gt;ag&lt;/code&gt; to grep inside files. &lt;code class=&quot;jl ju jv jw b&quot;&gt;ag&lt;/code&gt; is a nice and fast tool too but since I am already using ripgrep, I’d rather use that over installing another dependency. &lt;em class=&quot;jx&quot;&gt;T̵h̵i̵s̵ ̵m̵e̵a̵n̵s̵ ̵w̵e̵’̵l̵l̵ ̵h̵a̵v̵e̵ ̵t̵o̵ ̵d̵o̵ ̵s̵o̵m̵e̵ ̵&lt;/em&gt;&lt;a href=&quot;https://github.com/junegunn/fzf.vim#advanced-customization&quot; class=&quot;aq cc if ig ih ii&quot;&gt;&lt;em class=&quot;jx&quot;&gt;m̵a̵n̵u̵a̵l̵ ̵t̵w̵e̵a̵k̵i̵n̵g̵&lt;/em&gt;&lt;/a&gt;&lt;em class=&quot;jx&quot;&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;&lt;strong class=&quot;ht ij&quot;&gt;UPDATE 27–09–2018&lt;/strong&gt;&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;As pointed out by &lt;a href=&quot;https://medium.com/u/e84154332385&quot; class=&quot;kx bo cc&quot;&gt;Casey McGinty&lt;/a&gt; in the comments, FZF.vim now has the command &lt;code class=&quot;jl ju jv jw b&quot;&gt;:Rg&lt;/code&gt; built-in (see &lt;code class=&quot;jl ju jv jw b&quot;&gt;:h fzf-vim-commands&lt;/code&gt;). The &lt;a href=&quot;https://github.com/junegunn/fzf.vim#advanced-customization&quot; class=&quot;aq cc if ig ih ii&quot;&gt;old section&lt;/a&gt; on how to do it still exists but is now irrelevant.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Despite the update to the plugin, I’ll leave the code snippet here for reference:&lt;/p&gt;

Legacy FZF.vim :Rg command implementation
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;This one I mapped to &lt;code class=&quot;jl ju jv jw b&quot;&gt;ctrl-g&lt;/code&gt;, right next to &lt;code class=&quot;jl ju jv jw b&quot;&gt;ctrl-f&lt;/code&gt; for the &lt;code class=&quot;jl ju jv jw b&quot;&gt;:Files&lt;/code&gt; command.&lt;/p&gt;
&lt;pre class=&quot;jc jd je jf jg gb do kg&quot;&gt;
&lt;span class=&quot;kh il eq bh jw b df ki kj n kk&quot;&gt;nnoremap &amp;lt;C-g&amp;gt; :Rg&amp;lt;Cr&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;The nice thing about this command is that you can select multiple files. When selecting multiple files, pressing &lt;code class=&quot;jl ju jv jw b&quot;&gt;enter&lt;/code&gt; will load the files in a quickfix list for batch editing using &lt;code class=&quot;jl ju jv jw b&quot;&gt;cdo&lt;/code&gt; for example.&lt;/p&gt;

&lt;p class=&quot;hr hs eq bh ht b hu ix hw iy hy iz ia ja ic jb ie&quot;&gt;As I mentioned at the start of my post, these tools have become a &lt;strong class=&quot;ht ij&quot;&gt;vital&lt;/strong&gt; part of my workflow. I use them while barely noticing their presence and they take a lot of complexity away from the task at hand. This allows me to focus on what matters instead of finding out how to do something which should be trivial.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Wether it be killing services / processes, installing brew packages, finding a glitch in my path or a feature set in caniuse, I can do it in fewer keystrokes with more fine-grained control. I even use FZF as a standalone filter sometimes when I have to find something in line-based command output, skipping (rip)grep all together :)&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Hopefully you are also able to reduce some of the strain in your workflow with FZF using some of the tips above. If you are using FZF in another way, leave a comment! I’d love to hear about it and learn what others are doing with these two fantastic tools.&lt;/p&gt;
&lt;p class=&quot;hr hs eq bh ht b hu hv hw hx hy hz ia ib ic id ie&quot;&gt;Happy fuzzy finding :)&lt;/p&gt;
</description>
<pubDate>Fri, 05 Jul 2019 06:08:32 +0000</pubDate>
<dc:creator>daddy_drank</dc:creator>
<og:type>article</og:type>
<og:title>How FZF and ripgrep improved my workflow - Sidney Liebrand - Medium</og:title>
<og:description>Today I want to talk about fzf and ripgrep, two tools I use all the time when working in Vim and the terminal. They have become an…</og:description>
<og:url>https://medium.com/@sidneyliebrand/how-fzf-and-ripgrep-improved-my-workflow-61c7ca212861</og:url>
<og:image>https://miro.medium.com/freeze/max/1200/1*Uqo4PaKxcfaso48g532WpQ.gif</og:image>
<dc:language>en</dc:language>
<dc:format>text/html</dc:format>
<dc:identifier>https://medium.com/@sidneyliebrand/how-fzf-and-ripgrep-improved-my-workflow-61c7ca212861</dc:identifier>
</item>
</channel>
</rss>